
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 14
DI Scenario: LD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed14.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.107', '1.226'] (k=0.251)
  Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
  Product 2: ['1.000', '1.114', '1.241'] (k=0.266)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1032, max=1646
  DC capacity (MC): min=410, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=9.47, max=34.92, count=80
  Deviation (μ̂): min=4.04, max=9.84

Costs:
  Plant fixed cost: min=5479, max=9697
  DC fixed cost: min=3301, max=5734
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.352', '1.828'] (k=0.744)
    Product 1: ['1.000', '1.441', '2.076'] (k=0.901)
    Product 2: ['1.000', '1.370', '1.878'] (k=0.777)
  MD:
    Product 0: ['1.000', '1.159', '1.343'] (k=0.364)
    Product 1: ['1.000', '1.262', '1.592'] (k=0.574)
    Product 2: ['1.000', '1.299', '1.687'] (k=0.645)
  LD:
    Product 0: ['1.000', '1.107', '1.226'] (k=0.251)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.114', '1.241'] (k=0.266)
  Mixed:
    Product 0: ['1.000', '1.352', '1.828'] (k=0.744)
    Product 1: ['1.000', '1.262', '1.592'] (k=0.574)
    Product 2: ['1.000', '1.114', '1.241'] (k=0.266)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x1f1ead03
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -332547.2612
Found heuristic solution: objective -191190.9899

Root relaxation: objective 7.071153e+04, 4706 iterations, 0.26 seconds (0.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 70711.5285    0  692 -191190.99 70711.5285   137%     -    0s
H    0     0                    -152421.6200 70711.5285   146%     -    0s
     0     0 64964.4828    0  779 -152421.62 64964.4828   143%     -    1s
H    0     0                    -146941.2177 64960.4591   144%     -    1s
H    0     0                    -141462.4181 64960.4591   146%     -    1s
     0     0 64853.7182    0  772 -141462.42 64853.7182   146%     -    1s
     0     0 64853.4648    0  772 -141462.42 64853.4648   146%     -    1s
     0     0 60939.1098    0 1147 -141462.42 60939.1098   143%     -    3s
     0     0 60815.3559    0  973 -141462.42 60815.3559   143%     -    3s
     0     0 60806.4163    0 1077 -141462.42 60806.4163   143%     -    3s
     0     0 60806.0232    0  994 -141462.42 60806.0232   143%     -    3s
H    0     0                    -99468.74316 60806.0232   161%     -    4s
H    0     0                    -99311.79316 60806.0232   161%     -    4s
H    0     0                    -99121.69822 60806.0232   161%     -    4s
H    0     0                    -99049.77729 60806.0232   161%     -    4s
     0     0 58263.7706    0 1211 -99049.777 58263.7706   159%     -    6s
     0     0 58014.1552    0 1231 -99049.777 58014.1552   159%     -    6s
     0     0 57971.4190    0 1232 -99049.777 57971.4190   159%     -    6s
     0     0 57968.3139    0 1237 -99049.777 57968.3139   159%     -    6s
H    0     0                    -75617.83492 57968.3139   177%     -    7s
H    0     0                    -41117.10846 57968.3139   241%     -    7s
H    0     0                    -1523.810419 57968.3139  3904%     -    7s
H    0     0                    -602.2208961 55499.3775  9316%     -   10s
H    0     0                    -576.2973937 55499.3775  9730%     -   10s
H    0     0                    -406.1208693 55499.3775      -     -   10s
H    0     0                    -353.0994581 55499.3775      -     -   10s
H    0     0                      40.5461073 55499.3775      -     -   10s
H    0     0                     339.4042083 55499.3775      -     -   10s
H    0     0                     404.7876828 55499.3775      -     -   10s
H    0     0                     811.1919588 55499.3775  6742%     -   10s
H    0     0                    2602.4239869 55499.3775  2033%     -   10s
H    0     0                    2749.7706151 55499.3775  1918%     -   10s
H    0     0                    2822.6401131 55499.3775  1866%     -   10s
H    0     0                    2895.1390814 55499.3775  1817%     -   10s
H    0     0                    2902.6661826 55499.3775  1812%     -   10s
H    0     0                    2981.6236634 55499.3775  1761%     -   10s
H    0     0                    3239.4253018 55499.3775  1613%     -   10s
H    0     0                    3545.3433985 55499.3775  1465%     -   10s
H    0     0                    3607.1642685 55499.3775  1439%     -   10s
H    0     0                    3792.4447595 55499.3775  1363%     -   10s
H    0     0                    4426.1240536 55499.3775  1154%     -   10s
H    0     0                    4452.1534223 55499.3775  1147%     -   10s
H    0     0                    4464.9692140 55499.3775  1143%     -   10s
H    0     0                    4472.6651765 55499.3775  1141%     -   10s
H    0     0                    4475.4742381 55499.3775  1140%     -   10s
H    0     0                    4478.0855408 55499.3775  1139%     -   10s
     0     0 55499.3775    0 1283 4478.08554 55499.3775  1139%     -   10s
H    0     0                    8891.1926105 55234.5743   521%     -   11s
H    0     0                    9831.5109627 55234.5743   462%     -   11s
H    0     0                    9881.3847094 55234.5743   459%     -   11s
     0     0 55234.5743    0 1314 9881.38471 55234.5743   459%     -   11s
H    0     0                    9883.9962580 55168.6462   458%     -   11s
H    0     0                    9966.7287011 55168.6462   454%     -   11s
H    0     0                    10050.621829 55168.6462   449%     -   11s
H    0     0                    10061.850321 55168.6462   448%     -   11s
H    0     0                    10099.408749 55168.6462   446%     -   11s
     0     0 55168.6462    0 1336 10099.4087 55168.6462   446%     -   11s
     0     0 55160.4609    0 1336 10099.4087 55160.4609   446%     -   11s
     0     0 55159.8951    0 1337 10099.4087 55159.8951   446%     -   11s
H    0     0                    12908.916823 53039.5148   311%     -   13s
H    0     0                    13502.666671 53039.5148   293%     -   13s
H    0     0                    13516.970004 53039.5148   292%     -   13s
H    0     0                    13670.309653 53039.5148   288%     -   13s
H    0     0                    13679.899580 53039.5148   288%     -   13s
     0     0 53039.5148    0 1202 13679.8996 53039.5148   288%     -   13s
H    0     0                    13698.978011 52791.1081   285%     -   15s
H    0     0                    13701.315780 52791.1081   285%     -   15s
H    0     0                    13761.997030 52791.1081   284%     -   15s
H    0     0                    14267.782463 52791.1081   270%     -   15s
H    0     0                    14406.970996 52791.1081   266%     -   15s
H    0     0                    14481.921900 52791.1081   265%     -   15s
H    0     0                    14489.364963 52791.1081   264%     -   15s
H    0     0                    14504.589113 52791.1081   264%     -   15s
H    0     0                    14562.221583 52791.1081   263%     -   15s
H    0     0                    14606.042147 52791.1081   261%     -   15s
H    0     0                    14635.624047 52791.1081   261%     -   15s
     0     0 52791.1081    0 1236 14635.6240 52791.1081   261%     -   15s
     0     0 52758.8772    0 1252 14635.6240 52758.8772   260%     -   15s
     0     0 52753.4012    0 1233 14635.6240 52753.4012   260%     -   15s
     0     0 51136.1829    0 1322 14635.6240 51136.1829   249%     -   17s
     0     0 50819.5479    0 1392 14635.6240 50819.5479   247%     -   18s
     0     0 50746.8301    0 1389 14635.6240 50746.8301   247%     -   19s
     0     0 50729.6673    0 1398 14635.6240 50729.6673   247%     -   19s
H    0     0                    14698.123839 50727.4943   245%     -   19s
     0     0 50727.4943    0 1396 14698.1238 50727.4943   245%     -   19s
H    0     0                    15122.845500 49379.2062   227%     -   22s
H    0     0                    15529.836386 49379.2062   218%     -   22s
H    0     0                    15644.809734 49379.2062   216%     -   22s
H    0     0                    15749.958290 49379.2062   214%     -   22s
H    0     0                    15767.870633 49379.2062   213%     -   22s
H    0     0                    15768.446936 49379.2062   213%     -   22s
H    0     0                    15844.716269 49379.2062   212%     -   22s
H    0     0                    15856.625694 49379.2062   211%     -   22s
H    0     0                    15863.612565 49379.2062   211%     -   22s
H    0     0                    15868.750915 49379.2062   211%     -   22s
H    0     0                    15874.053850 49379.2062   211%     -   22s
H    0     0                    15882.415592 49379.2062   211%     -   22s
H    0     0                    15900.413848 49379.2062   211%     -   22s
H    0     0                    18651.073054 49379.2062   165%     -   22s
H    0     0                    18756.488592 49379.2062   163%     -   22s
H    0     0                    18766.014988 49379.2062   163%     -   22s
H    0     0                    18819.520120 49379.2062   162%     -   22s
H    0     0                    18829.325475 49379.2062   162%     -   22s
H    0     0                    19037.568597 49379.2062   159%     -   22s
H    0     0                    19051.335651 49379.2062   159%     -   22s
     0     0 49379.2062    0 1232 19051.3357 49379.2062   159%     -   22s
H    0     0                    20139.207928 49069.9036   144%     -   24s
H    0     0                    20749.399607 49069.9036   136%     -   24s
H    0     0                    20754.535342 49069.9036   136%     -   24s
H    0     0                    20966.010681 49069.9036   134%     -   24s
H    0     0                    20983.841753 49069.9036   134%     -   24s
H    0     0                    20985.345649 49069.9036   134%     -   24s
H    0     0                    20997.922804 49069.9036   134%     -   24s
H    0     0                    21059.789565 49069.9036   133%     -   24s
H    0     0                    21078.514898 49069.9036   133%     -   24s
H    0     0                    21092.184548 49069.9036   133%     -   24s
H    0     0                    21103.764737 49069.9036   133%     -   24s
H    0     0                    21104.307751 49069.9036   133%     -   24s
H    0     0                    21109.533674 49069.9036   132%     -   24s
H    0     0                    21111.686650 49069.9036   132%     -   24s
H    0     0                    21137.864823 49069.9036   132%     -   24s
H    0     0                    21281.795692 49069.9036   131%     -   24s
H    0     0                    21289.176619 49069.9036   130%     -   24s
     0     0 49069.9036    0 1286 21289.1766 49069.9036   130%     -   24s
     0     0 49035.1653    0 1286 21289.1766 49035.1653   130%     -   24s
     0     0 49027.9144    0 1297 21289.1766 49027.9144   130%     -   24s
H    0     0                    21306.878609 48079.4496   126%     -   27s
H    0     0                    21345.505446 48079.4496   125%     -   27s
     0     0 48079.4496    0 1340 21345.5054 48079.4496   125%     -   27s
     0     0 47856.4630    0 1376 21345.5054 47856.4630   124%     -   29s
     0     0 47807.6660    0 1378 21345.5054 47807.6660   124%     -   29s
     0     0 47793.6526    0 1384 21345.5054 47793.6526   124%     -   30s
     0     0 47002.8387    0 1267 21345.5054 47002.8387   120%     -   32s
     0     0 46831.9089    0 1391 21345.5054 46831.9089   119%     -   34s
     0     0 46797.2283    0 1324 21345.5054 46797.2283   119%     -   34s
     0     0 46789.6767    0 1319 21345.5054 46789.6767   119%     -   35s
     0     0 46126.5067    0 1386 21345.5054 46126.5067   116%     -   38s
     0     0 46005.0335    0 1409 21345.5054 46005.0335   116%     -   39s
     0     0 45982.9749    0 1402 21345.5054 45982.9749   115%     -   39s
     0     0 45551.5875    0 1245 21345.5054 45551.5875   113%     -   42s
     0     0 45439.3159    0 1378 21345.5054 45439.3159   113%     -   43s
     0     0 45414.6751    0 1264 21345.5054 45414.6751   113%     -   43s
     0     0 45007.3264    0 1375 21345.5054 45007.3264   111%     -   46s
     0     0 44870.8069    0 1405 21345.5054 44870.8069   110%     -   47s
     0     0 44836.1214    0 1417 21345.5054 44836.1214   110%     -   48s
     0     0 44828.5972    0 1417 21345.5054 44828.5972   110%     -   49s
     0     0 44485.8591    0 1366 21345.5054 44485.8591   108%     -   52s
     0     0 44372.9933    0 1394 21345.5054 44372.9933   108%     -   53s
     0     0 44347.3690    0 1396 21345.5054 44347.3690   108%     -   54s
     0     0 43980.9771    0 1346 21345.5054 43980.9771   106%     -   56s
     0     0 43897.6090    0 1381 21345.5054 43897.6090   106%     -   58s
     0     0 43887.4878    0 1374 21345.5054 43887.4878   106%     -   58s
     0     0 43618.8022    0 1348 21345.5054 43618.8022   104%     -   61s
     0     0 43553.3735    0 1378 21345.5054 43553.3735   104%     -   62s
     0     0 43532.1062    0 1398 21345.5054 43532.1062   104%     -   62s
     0     0 43256.2878    0 1365 21345.5054 43256.2878   103%     -   65s
     0     0 43190.3701    0 1363 21345.5054 43190.3701   102%     -   66s
     0     0 43178.0308    0 1377 21345.5054 43178.0308   102%     -   66s
     0     0 42998.3870    0 1347 21345.5054 42998.3870   101%     -   68s
     0     0 42998.1711    0 1347 21345.5054 42998.1711   101%     -   68s
     0     2 42998.1711    0 1347 21345.5054 42998.1711   101%     -   71s
     1     4 42707.7047    1 1219 21345.5054 42997.8042   101%  3852   76s
     3     8 42433.5181    2 1099 21345.5054 42707.6066   100%  4695   83s
     7    16 42092.4781    3 1116 21345.5054 42433.3986  98.8%  5086   89s
    15    30 40507.4961    4 1121 21345.5054 42091.0410  97.2%  5473   94s
    31    58 39890.1390    5  970 21345.5054 40662.3386  90.5%  6334   98s
H   39    58                    21373.313341 40662.3386  90.2%  6564   98s
    61    90 37631.0805    6  870 21373.3133 40114.8967  87.7%  7223  100s
H  106   169                    21480.461155 39890.0482  85.7%  4818  103s
   172   303 37082.5260    9  863 21480.4612 39890.0482  85.7%  3193  105s
H  452   434                    21503.593404 39890.0482  85.5%  1652  109s
   465   528 27835.1552   12  474 21503.5934 39890.0482  85.5%  1629  111s
   846   698 27147.0696   15  494 21503.5934 39660.5430  84.4%  1086  116s
  1263  1047 30148.1436   13  360 21503.5934 39657.2716  84.4%   842  121s
  1567  1142 28793.1667   19  178 21503.5934 38760.1426  80.2%   740  125s
  2225  1628 33706.2268   11  389 21503.5934 38469.4890  78.9%   583  131s
  3186  2234 31442.2613   19  222 21503.5934 38115.7700  77.3%   465  135s
  3883  2440 25281.6211   18  206 21503.5934 36328.9442  68.9%   419  140s
  4571  2693 23074.0147   34 1347 21503.5934 35714.4665  66.1%   388  173s
  4574  2695 23673.0257   16  328 21503.5934 35031.1898  62.9%   388  175s
  4591  2706 23480.1291   22  459 21503.5934 28948.5741  34.6%   386  181s
  4829  2811 26290.0300   20  409 21503.5934 27497.9743  27.9%   385  185s
H 4984  2683                    21552.906727 26592.8661  23.4%   379  186s
H 5296  2460                    21553.167511 26100.1223  21.1%   369  187s
H 5492  2307                    21553.246879 25752.6793  19.5%   363  189s
H 5493  2191                    21571.049858 25752.6793  19.4%   363  189s
H 5503  2077                    21580.338918 25656.3691  18.9%   363  189s
H 5515  1968                    21601.983548 25656.3691  18.8%   363  189s
H 5682  1803                    21607.406195 25656.3691  18.7%   358  189s
  5700  1787     cutoff   25      21607.4062 25656.3691  18.7%   357  190s
H 5795  1663                    21614.259017 25542.2624  18.2%   354  190s
H 5810  1568                    21637.081887 25542.2624  18.0%   354  190s
H 5832  1475                    21652.049012 25542.2624  18.0%   353  190s
H 5976  1319                    21673.634253 25241.1817  16.5%   350  191s
H 6202  1135                    21676.551123 25241.1817  16.4%   343  192s
  7440   562 21746.1972   30   14 21676.5511 21746.1972  0.32%   300  195s
* 7616   427              58    21678.823136 21729.0139  0.23%   293  195s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 4
  MIR: 204
  Flow cover: 328
  Zero half: 1
  RLT: 9
  Relax-and-lift: 101

Explored 8074 nodes (2355147 simplex iterations) in 195.64 seconds (259.94 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 21678.8 21676.6 21673.6 ... 21571

Optimal solution found (tolerance 1.00e-06)
Best objective 2.167882313557e+04, best bound 2.167882313557e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 195.65s
  Master Objective (UB) = 21678.82, θ = 147124.72
  Upper Bound (UB) = 21678.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147124.72
  [DEBUG]   ✓ Scenario 0: θ = 147124.72 ≤ Q = 147124.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3161bf39
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3161bf39
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368031e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6604762.4808
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.351529e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135152.86    0  124 6604762.48 -135152.86   102%     -    0s
H    0     0                    -101546.0480 -135152.86  33.1%     -    0s
H    0     0                    -102696.8845 -135152.86  31.6%     -    0s
H    0     0                    -104299.2973 -104299.30  0.00%     -    0s
     0     0          -    0      -104299.30 -104299.30  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 204

Explored 1 nodes (369 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -104299 -102697 -101546 ... 1.36803e+13
No other solutions better than -104299

Optimal solution found (tolerance 1.00e-06)
Best objective -1.042992972832e+05, best bound -1.042992972832e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 116119.36
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104299.30
  [DEBUG]   S×d_nominal = 220418.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 220418.66 + -104299.30 = 116119.36
  [DEBUG]   Current θ from Master = 147124.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31005.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9326.54
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 31005.3599, Absolute Gap = 31005.3599, Relative Gap = 1.430214
  Not converged yet (gap = 31005.36 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x9a01b8bb
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -9326.54 (0.02s)
Loaded MIP start from previous solve with objective -9326.54

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.46s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.744313e+04, 10572 iterations, 1.99 seconds (2.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 27443.1346    0  372 -9326.5367 27443.1346   394%     -    2s
H    0     0                    -4793.907739 27443.1346   672%     -    2s
H    0     0                    -4595.559933 27443.1346   697%     -    2s
     0     0 19491.2038    0  458 -4595.5599 19491.2038   524%     -    4s
H    0     0                    -4577.533042 19487.7332   526%     -    5s
     0     0 19270.9390    0  545 -4577.5330 19270.9390   521%     -    5s
     0     0 13608.5127    0  681 -4577.5330 13608.5127   397%     -    7s
H    0     0                    -4346.718685 12870.7791   396%     -    8s
H    0     0                    -4249.379322 12870.7791   403%     -    8s
H    0     0                    -4157.910570 12870.7791   410%     -    8s
H    0     0                    -4155.796228 12870.7791   410%     -    8s
     0     0 12870.7791    0  700 -4155.7962 12870.7791   410%     -    8s
     0     0 12707.6641    0  760 -4155.7962 12707.6641   406%     -    9s
     0     0 12698.7179    0  763 -4155.7962 12698.7179   406%     -    9s
     0     0 12696.7434    0  759 -4155.7962 12696.7434   406%     -    9s
H    0     0                    -4140.165252 12696.7434   407%     -   10s
H    0     0                    -4126.924306 12696.7434   408%     -   10s
     0     0 8866.64215    0  458 -4126.9243 8866.64215   315%     -   12s
     0     0 8255.27911    0  617 -4126.9243 8255.27911   300%     -   14s
     0     0 8149.74050    0  478 -4126.9243 8149.74050   297%     -   15s
     0     0 8131.05769    0  494 -4126.9243 8131.05769   297%     -   15s
     0     0 8126.71524    0  491 -4126.9243 8126.71524   297%     -   15s
H    0     0                    -4058.865289 8126.71524   300%     -   17s
H    0     0                    -4039.324885 8126.71524   301%     -   17s
H    0     0                    -4028.194409 8126.71524   302%     -   17s
H    0     0                    -4008.654005 8126.71524   303%     -   17s
     0     0 6631.04254    0  722 -4008.6540 6631.04254   265%     -   19s
     0     0 6344.82955    0  824 -4008.6540 6344.82955   258%     -   21s
     0     0 6308.52356    0  740 -4008.6540 6308.52356   257%     -   21s
     0     0 6294.84063    0  734 -4008.6540 6294.84063   257%     -   21s
     0     0 6289.61831    0  738 -4008.6540 6289.61831   257%     -   22s
     0     0 5758.84968    0  472 -4008.6540 5758.84968   244%     -   24s
     0     0 5603.34866    0  555 -4008.6540 5603.34866   240%     -   25s
     0     0 5569.89364    0  475 -4008.6540 5569.89364   239%     -   25s
     0     0 5558.39020    0  483 -4008.6540 5558.39020   239%     -   25s
     0     0 5557.20898    0  486 -4008.6540 5557.20898   239%     -   25s
     0     0 5322.13840    0  629 -4008.6540 5322.13840   233%     -   27s
     0     0 5210.49287    0  551 -4008.6540 5210.49287   230%     -   28s
     0     0 5180.28434    0  551 -4008.6540 5180.28434   229%     -   28s
     0     0 5157.62046    0  695 -4008.6540 5157.62046   229%     -   29s
     0     0 5154.62267    0  554 -4008.6540 5154.62267   229%     -   29s
     0     0 5002.64867    0  541 -4008.6540 5002.64867   225%     -   30s
     0     0 4965.01782    0  619 -4008.6540 4965.01782   224%     -   31s
     0     0 4937.00436    0  698 -4008.6540 4937.00436   223%     -   32s
     0     0 4933.52214    0  482 -4008.6540 4933.52214   223%     -   32s
     0     0 4844.26381    0  471 -4008.6540 4844.26381   221%     -   33s
H    0     0                    -3911.471148 4833.58622   224%     -   34s
     0     0 4833.58622    0  483 -3911.4711 4833.58622   224%     -   34s
     0     0 4828.93578    0  484 -3911.4711 4828.93578   223%     -   34s
     0     0 4746.03653    0  480 -3911.4711 4746.03653   221%     -   35s
     0     0 4719.88465    0  639 -3911.4711 4719.88465   221%     -   35s
     0     0 4707.46533    0  633 -3911.4711 4707.46533   220%     -   36s
     0     0 4702.41481    0  634 -3911.4711 4702.41481   220%     -   36s
     0     0 4686.93683    0  715 -3911.4711 4686.93683   220%     -   37s
     0     0 4679.69296    0  739 -3911.4711 4679.69296   220%     -   37s
     0     0 4663.32828    0  580 -3911.4711 4663.32828   219%     -   38s
     0     0 4663.01568    0  580 -3911.4711 4663.01568   219%     -   39s
     0     2 4663.01568    0  580 -3911.4711 4663.01568   219%     -   44s
     1     4 4603.32330    1  421 -3911.4711 4660.42778   219%   622   45s
    31    64 2632.03151    5  603 -3911.4711 4394.06453   212%  1116   50s
   153   194 1772.33593    9  404 -3911.4711 3811.73464   197%   942   55s
   286   266  855.59785   12  477 -3911.4711 3811.73464   197%   896   60s
   433   340 -1947.1990   14  298 -3911.4711 3768.41160   196%   852   66s
   617   421 -1861.1728   15  329 -3911.4711 3628.41698   193%   720   72s
   802   505 1277.21641    9  427 -3911.4711 3628.41698   193%   648   77s
   956   550  500.79280   11  313 -3911.4711 3177.33216   181%   604   80s
  1187   656     cutoff   13      -3911.4711 3177.33216   181%   553   86s
  1367   750     cutoff   13      -3911.4711 3177.33216   181%   519   90s
  1630   940 -1339.8893   13  289 -3911.4711 1657.64831   142%   481   96s
  1992  1027     cutoff   14      -3911.4711 1481.08427   138%   436  101s
  2143  1041     cutoff   16      -3911.4711 1457.04240   137%   428  105s
  2191  1053     cutoff   17      -3911.4711 1349.57658   135%   429  112s
  2245  1067     cutoff   17      -3911.4711 1349.57658   135%   430  118s
  2315  1100 -3418.2214   39   89 -3911.4711 1349.57658   135%   429  120s
  2500  1175 -3587.6596   41   71 -3911.4711 1349.57658   135%   418  125s
  2775  1225 -2916.4345   11  209 -3911.4711  959.50188   125%   407  130s
  3154  1389 -3406.1409   14  200 -3911.4711  840.66023   121%   390  136s
  3415  1469 -3581.3019   16  187 -3911.4711  803.19442   121%   380  142s
  3725  1556     cutoff   18      -3911.4711  672.02724   117%   369  146s
  4111  1654 -1189.6500   10  253 -3911.4711  613.25405   116%   359  151s
  4634  1822 -2247.0422   13  282 -3911.4711  513.02438   113%   344  157s
  5350  1976     cutoff   11      -3911.4711  151.60192   104%   327  161s
  6408  2184 -2014.2281   11  491 -3911.4711 -294.68200  92.5%   309  168s
  6863  2358 -2463.9770   12  423 -3911.4711 -432.08614  89.0%   300  170s
  7453  2359 -2146.7805   13  580 -3911.4711 -568.40902  85.5%   290  183s
  7455  2360 -2948.0581   18  113 -3911.4711 -568.40902  85.5%   290  185s
  7459  2363 -1695.6688   14  444 -3911.4711 -568.40902  85.5%   290  190s
  7465  2367 -2014.9653   17  524 -3911.4711 -568.40902  85.5%   289  195s
  7470  2370 -1893.8393   25  482 -3911.4711 -568.40902  85.5%   289  200s
  7476  2374 -3221.5428   30  513 -3911.4711 -568.40902  85.5%   289  207s
  7477  2375 -897.53479   13  513 -3911.4711 -568.40902  85.5%   289  210s
  7484  2389 -568.40902   14  387 -3911.4711 -568.40902  85.5%   293  215s
  7540  2444 -568.40902   17  328 -3911.4711 -568.40902  85.5%   299  220s
  7720  2498 -568.40902   21  257 -3911.4711 -568.40902  85.5%   305  225s
  7974  2431 -1594.6529   20  386 -3911.4711 -568.40902  85.5%   311  230s
  8263  2313     cutoff   23      -3911.4711 -568.40902  85.5%   315  236s
  8550  2160     cutoff   21      -3911.4711 -568.40902  85.5%   318  241s
  8828  1932 -3105.1260   18  437 -3911.4711 -1515.8329  61.2%   319  245s

Cutting planes:
  MIR: 211
  Flow cover: 304
  Zero half: 4
  RLT: 3
  Relax-and-lift: 21

Explored 8881 nodes (2868311 simplex iterations) in 247.96 seconds (388.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3911.47 -4008.65 -4028.19 ... -4249.38
No other solutions better than -3911.47

Optimal solution found (tolerance 1.00e-06)
Best objective -3.911471147875e+03, best bound -3.911471147875e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 247.97s
  Master Objective (UB) = -3911.47, θ = 121877.98
  Upper Bound (UB) = -3911.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 121877.98
  [DEBUG]   ✓ Scenario 0: θ = 121877.98 ≤ Q = 121877.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 121877.98 ≤ Q = 121877.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xd038351
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0d038351
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.357781e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6392077.5737
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.483880e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148387.96    0  129 6392077.57 -148387.96   102%     -    0s
H    0     0                    -108322.8636 -148387.96  37.0%     -    0s
H    0     0                    -109790.8759 -148387.96  35.2%     -    0s
H    0     0                    -114845.2068 -148387.96  29.2%     -    0s
H    0     0                    -130699.6526 -148387.96  13.5%     -    0s
     0     0 -136889.28    0   84 -130699.65 -136889.28  4.74%     -    0s
H    0     0                    -133308.8181 -136736.61  2.57%     -    0s
H    0     0                    -133573.0229 -136736.61  2.37%     -    0s
     0     0 -136565.49    0   86 -133573.02 -136565.49  2.24%     -    0s
     0     0 -135714.85    0   86 -133573.02 -135714.85  1.60%     -    0s
     0     0 -135637.31    0   84 -133573.02 -135637.31  1.55%     -    0s
H    0     0                    -133709.0479 -135637.31  1.44%     -    0s
     0     0 -134801.17    0   42 -133709.05 -134801.17  0.82%     -    0s
     0     0 -134684.52    0   37 -133709.05 -134684.52  0.73%     -    0s
     0     0 -134423.04    0   22 -133709.05 -134423.04  0.53%     -    0s
H    0     0                    -133714.6282 -134402.52  0.51%     -    0s
     0     0 -134402.52    0   33 -133714.63 -134402.52  0.51%     -    0s
     0     0 -134402.10    0   22 -133714.63 -134402.10  0.51%     -    0s
     0     0 -134206.60    0   25 -133714.63 -134206.60  0.37%     -    0s
     0     0 -134190.51    0   25 -133714.63 -134190.51  0.36%     -    0s
     0     0 -134113.65    0   25 -133714.63 -134113.65  0.30%     -    0s
     0     0 -134105.88    0   25 -133714.63 -134105.88  0.29%     -    0s
     0     0 -134105.88    0   70 -133714.63 -134105.88  0.29%     -    0s
     0     0 -134105.88    0   33 -133714.63 -134105.88  0.29%     -    0s
     0     0 -133981.65    0   19 -133714.63 -133981.65  0.20%     -    0s
     0     0 -133970.30    0   17 -133714.63 -133970.30  0.19%     -    0s
H    0     0                    -133754.3530 -133868.96  0.09%     -    0s
     0     0 -133868.96    0    6 -133754.35 -133868.96  0.09%     -    0s
H    0     0                    -133863.7909 -133868.71  0.00%     -    0s
     0     0 -133863.87    0    2 -133863.79 -133863.87  0.00%     -    0s

Cutting planes:
  Gomory: 28
  Implied bound: 30
  MIR: 12
  Flow cover: 17
  RLT: 14
  Relax-and-lift: 3

Explored 1 nodes (1256 simplex iterations) in 0.19 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133864 -133754 -133715 ... -108323

Optimal solution found (tolerance 1.00e-06)
Best objective -1.338637909308e+05, best bound -1.338638730575e+05, gap 0.0001%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 100574.80
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133863.79
  [DEBUG]   S×d_nominal = 234438.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234438.60 + -133863.79 = 100574.80
  [DEBUG]   Current θ from Master = 121877.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21303.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25214.65
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 5415.0656, Absolute Gap = 5415.0656, Relative Gap = 1.384406
  Not converged yet (gap = 5415.07 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x58cff944
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -25214.6 (0.03s)
MIP start from previous solve produced solution with objective -25214.6 (0.03s)
Loaded MIP start from previous solve with objective -25214.6

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.66s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28425   -2.8441121e+03   0.000000e+00   7.936916e+07      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   14878    1.3812974e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.381297e+04, 14878 iterations, 5.83 seconds (7.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13812.9741    0  143 -25214.649 13812.9741   155%     -    6s
H    0     0                    -18753.82918 13812.9741   174%     -    6s
H    0     0                    -6569.613777 13812.9741   310%     -    6s
H    0     0                    -5115.440457 13812.9741   370%     -    7s
H    0     0                    -5113.742963 13812.9741   370%     -    7s
H    0     0                    -5112.837634 10669.0021   309%     -    9s
     0     0 10669.0021    0  298 -5112.8376 10669.0021   309%     -   10s
     0     0 10520.2204    0  308 -5112.8376 10520.2204   306%     -   10s
     0     0 10520.2204    0  314 -5112.8376 10520.2204   306%     -   10s
     0     0 10520.2204    0  314 -5112.8376 10520.2204   306%     -   10s
     0     0 8022.19440    0  364 -5112.8376 8022.19440   257%     -   14s
     0     0 7627.34057    0  365 -5112.8376 7627.34057   249%     -   16s
     0     0 7103.37413    0  361 -5112.8376 7103.37413   239%     -   17s
     0     0 7015.88363    0  382 -5112.8376 7015.88363   237%     -   18s
     0     0 7009.77168    0  378 -5112.8376 7009.77168   237%     -   18s
     0     0 7009.41836    0  378 -5112.8376 7009.41836   237%     -   18s
     0     0 5999.53106    0  392 -5112.8376 5999.53106   217%     -   22s
     0     0 5568.72256    0  427 -5112.8376 5568.72256   209%     -   23s
     0     0 5347.18640    0  423 -5112.8376 5347.18640   205%     -   25s
     0     0 5308.64781    0  439 -5112.8376 5308.64781   204%     -   25s
     0     0 5283.87455    0  429 -5112.8376 5283.87455   203%     -   25s
     0     0 5283.33483    0  435 -5112.8376 5283.33483   203%     -   26s
     0     0 4413.42320    0  437 -5112.8376 4413.42320   186%     -   31s
     0     0 4180.15600    0  451 -5112.8376 4180.15600   182%     -   32s
     0     0 4080.72339    0  451 -5112.8376 4080.72339   180%     -   33s
     0     0 4022.11358    0  462 -5112.8376 4022.11358   179%     -   34s
     0     0 3979.00738    0  449 -5112.8376 3979.00738   178%     -   35s
     0     0 3967.17109    0  452 -5112.8376 3967.17109   178%     -   35s
     0     0 3962.95284    0  448 -5112.8376 3962.95284   178%     -   35s
     0     0 3960.57049    0  450 -5112.8376 3960.57049   177%     -   35s
     0     0 3960.36806    0  449 -5112.8376 3960.36806   177%     -   35s
     0     0 3820.73549    0  453 -5112.8376 3820.73549   175%     -   37s
     0     0 3753.63701    0  462 -5112.8376 3753.63701   173%     -   38s
     0     0 3732.33192    0  467 -5112.8376 3732.33192   173%     -   39s
     0     0 3727.24583    0  473 -5112.8376 3727.24583   173%     -   39s
     0     0 3725.58998    0  477 -5112.8376 3725.58998   173%     -   39s
     0     0 3725.58998    0  477 -5112.8376 3725.58998   173%     -   39s
     0     0 3597.36303    0  465 -5112.8376 3597.36303   170%     -   41s
     0     0 3569.31245    0  481 -5112.8376 3569.31245   170%     -   43s
     0     0 3555.72414    0  487 -5112.8376 3555.72414   170%     -   43s
     0     0 3549.83667    0  483 -5112.8376 3549.83667   169%     -   43s
     0     0 3548.46187    0  486 -5112.8376 3548.46187   169%     -   43s
     0     0 3453.18286    0  468 -5112.8376 3453.18286   168%     -   45s
     0     0 3442.13307    0  473 -5112.8376 3442.13307   167%     -   45s
     0     0 3439.84895    0  467 -5112.8376 3439.84895   167%     -   45s
     0     0 3439.25299    0  472 -5112.8376 3439.25299   167%     -   45s
     0     0 3415.54252    0  486 -5112.8376 3415.54252   167%     -   46s
     0     0 3412.26960    0  490 -5112.8376 3412.26960   167%     -   48s
     0     0 3409.54459    0  484 -5112.8376 3409.54459   167%     -   48s
     0     0 3407.76758    0  493 -5112.8376 3407.76758   167%     -   48s
     0     0 3407.34810    0  492 -5112.8376 3407.34810   167%     -   49s
     0     0 3377.59994    0  489 -5112.8376 3377.59994   166%     -   50s
     0     0 3371.47001    0  499 -5112.8376 3371.47001   166%     -   50s
     0     0 3368.96517    0  496 -5112.8376 3368.96517   166%     -   50s
     0     0 3368.04570    0  499 -5112.8376 3368.04570   166%     -   50s
     0     0 3350.25754    0  504 -5112.8376 3350.25754   166%     -   51s
     0     0 3344.96198    0  514 -5112.8376 3344.96198   165%     -   52s
     0     0 3344.14589    0  521 -5112.8376 3344.14589   165%     -   52s
     0     0 3326.18395    0  503 -5112.8376 3326.18395   165%     -   53s
     0     0 3323.25926    0  505 -5112.8376 3323.25926   165%     -   53s
     0     0 3321.10326    0  510 -5112.8376 3321.10326   165%     -   53s
     0     0 3320.69792    0  516 -5112.8376 3320.69792   165%     -   54s
     0     0 3310.23103    0  507 -5112.8376 3310.23103   165%     -   55s
     0     0 3308.07180    0  512 -5112.8376 3308.07180   165%     -   55s
     0     0 3307.10709    0  505 -5112.8376 3307.10709   165%     -   55s
     0     0 3302.49943    0  504 -5112.8376 3302.49943   165%     -   56s
     0     0 3301.55398    0  510 -5112.8376 3301.55398   165%     -   56s
     0     0 3294.86915    0  506 -5112.8376 3294.86915   164%     -   57s
     0     0 3291.12337    0  504 -5112.8376 3291.12337   164%     -   57s
     0     0 3289.61932    0  503 -5112.8376 3289.61932   164%     -   57s
     0     0 3273.67650    0  512 -5112.8376 3273.67650   164%     -   58s
     0     0 3271.41374    0  509 -5112.8376 3271.41374   164%     -   59s
     0     0 3270.81186    0  511 -5112.8376 3270.81186   164%     -   59s
     0     0 3259.44900    0  513 -5112.8376 3259.44900   164%     -   60s
     0     0 3258.84159    0  516 -5112.8376 3258.84159   164%     -   60s
     0     0 3257.13410    0  521 -5112.8376 3257.13410   164%     -   61s
     0     0 3255.96283    0  523 -5112.8376 3255.96283   164%     -   61s
     0     0 3254.58759    0  514 -5112.8376 3254.58759   164%     -   62s
     0     0 3254.14005    0  514 -5112.8376 3254.14005   164%     -   62s
     0     2 3253.88412    0  514 -5112.8376 3253.88412   164%     -   70s
     7    16 2546.30795    3  485 -5112.8376 2666.73560   152%  1939   78s
    15    32 1908.52613    4  485 -5112.8376 2545.63327   150%  2858   81s
    31    64 1631.33529    5  484 -5112.8376 2520.75780   149%  3035   85s
    63    96 1165.27428    6  526 -5112.8376 2192.58149   143%  2767   90s
   127   184 1043.99945    8  511 -5112.8376 2191.96421   143%  2050   95s
   265   305  426.30841    9  439 -5112.8376 2191.96421   143%  1416  102s
   340   362  632.89966   10  382 -5112.8376 2191.96421   143%  1307  105s
   498   451   59.42916   11  391 -5112.8376 2191.96421   143%  1184  112s
   564   488 -1527.7191   12  461 -5112.8376 2191.96421   143%  1179  117s
   613   539 -462.89218   12  257 -5112.8376 2191.96421   143%  1171  122s
   692   581 -727.49842   13  247 -5112.8376 2041.40727   140%  1153  125s
   837   685 -2233.3277   17  238 -5112.8376 2041.40727   140%  1112  132s
   913   745 -2957.1430   19  224 -5112.8376 2041.40727   140%  1093  135s
  1072   826 -4485.3863   22  224 -5112.8376 1401.90303   127%  1049  144s
  1143   864 -3770.3689   23  215 -5112.8376 1401.90303   127%  1047  148s
  1233   887     cutoff   25      -5112.8376 1348.02303   126%  1038  151s
  1329   917 -3797.6490    7  170 -5112.8376 1341.46283   126%  1031  156s
  1414   951 -4285.7562    8  188 -5112.8376 1211.13748   124%  1035  161s
  1518   993  606.56941   12  347 -5112.8376 1211.13748   124%  1037  166s
  1614  1052  175.52560   14  254 -5112.8376 1211.13748   124%  1041  170s
  1896  1157 infeasible   16      -5112.8376 1209.94338   124%   998  178s
  2066  1180 -3029.5112   16  156 -5112.8376 1143.13424   122%   966  183s
  2139  1259 -2268.1558   17  221 -5112.8376 1086.53911   121%   963  188s
  2258  1316 -3148.2905   21  185 -5112.8376 1040.16451   120%   950  192s
  2393  1370     cutoff   20      -5112.8376 1021.85718   120%   940  196s
  2538  1421 -4505.0109   24  272 -5112.8376 1009.00589   120%   930  200s
  2683  1457 infeasible    8      -5112.8376  890.40382   117%   933  206s
  2830  1532 -1558.5768   12  403 -5112.8376  804.21280   116%   939  211s
  3023  1626 -3734.3011   14  362 -5112.8376  770.76812   115%   929  216s
  3278  1676     cutoff   16      -5112.8376  770.76812   115%   902  221s
  3489  1745 -4540.9058   16  310 -5112.8376  727.71056   114%   892  227s
  3639  1780     cutoff   16      -5112.8376  644.81540   113%   887  233s
  3806  1848 -1720.6847   18  305 -5112.8376  644.81540   113%   889  237s
  3994  1906 -2554.5574   24  404 -5112.8376  644.81540   113%   888  242s
  4183  1930 -3340.8674   29  167 -5112.8376  413.44063   108%   882  246s
  4223  1958 infeasible   30      -5112.8376  413.44063   108%   885  250s
  4421  2091 -1696.0640   10  277 -5112.8376  265.60698   105%   883  260s
  4614  2151 -1915.7889   13  454 -5112.8376  265.60698   105%   884  266s
  4864  2245 -3854.6609   15  476 -5112.8376  160.59428   103%   873  272s
  5162  2341 infeasible   17      -5112.8376   73.09210   101%   864  278s
  5458  2430     cutoff   18      -5112.8376   73.09210   101%   859  286s
  5813  2472 -4466.0741   13  304 -5112.8376 -197.91671  96.1%   848  295s
  6059  2546 -2351.1353   15  294 -5112.8376 -197.91671  96.1%   848  302s
  6346  2547 -2269.9618   12  514 -5112.8376 -208.99078  95.9%   849  317s
  6348  2548 -2334.0714   15  143 -5112.8376 -208.99078  95.9%   849  327s
  6349  2549 -869.61789   10  384 -5112.8376 -208.99078  95.9%   849  332s
  6350  2550 -3041.2084   22  458 -5112.8376 -208.99078  95.9%   848  337s
  6352  2551 -2430.1355   16  469 -5112.8376 -208.99078  95.9%   848  341s
  6354  2552 -3027.8643   12  529 -5112.8376 -208.99078  95.9%   848  345s
  6358  2555 -387.61220   17  477 -5112.8376 -208.99078  95.9%   847  350s
  6363  2558 -1313.5454   18  486 -5112.8376 -208.99078  95.9%   847  356s
  6366  2560 -1673.1045   13  500 -5112.8376 -208.99078  95.9%   846  360s
  6370  2563 -4427.4295   14  511 -5112.8376 -208.99078  95.9%   846  366s
  6372  2564 -4205.5077   19  528 -5112.8376 -208.99078  95.9%   845  378s
  6373  2565 -2591.5888   26  528 -5112.8376 -208.99078  95.9%   845  384s
  6374  2569 -208.99078   15  437 -5112.8376 -208.99078  95.9%   857  387s
  6376  2572 -208.99078   16  456 -5112.8376 -208.99078  95.9%   857  392s
  6380  2579 -208.99078   17  432 -5112.8376 -208.99078  95.9%   858  395s
  6388  2592 -208.99078   18  444 -5112.8376 -208.99078  95.9%   861  400s
  6436  2631 -1144.6864   20  487 -5112.8376 -208.99078  95.9%   877  409s
  6468  2656 -1365.6729   21  478 -5112.8376 -208.99078  95.9%   888  413s
  6515  2687 -2351.1358   22  374 -5112.8376 -208.99078  95.9%   891  418s
  6589  2697 -1614.4967   23  487 -5112.8376 -208.99078  95.9%   897  422s
  6682  2680 -2449.1204   25  421 -5112.8376 -208.99078  95.9%   897  427s
  6767  2658 -3210.9422   26  257 -5112.8376 -208.99078  95.9%   898  432s
  6843  2651 -3855.6841   27  392 -5112.8376 -208.99078  95.9%   900  436s
  6983  2632 -3894.1881   28  403 -5112.8376 -208.99078  95.9%   905  444s
  7058  2618     cutoff   29      -5112.8376 -208.99078  95.9%   906  449s
  7124  2593     cutoff   30      -5112.8376 -208.99078  95.9%   908  454s
  7190  2585     cutoff   21      -5112.8376 -208.99078  95.9%   911  458s
  7252  2580 -4271.7889   22  179 -5112.8376 -208.99078  95.9%   912  461s
  7327  2566     cutoff   28      -5112.8376 -208.99078  95.9%   913  466s
  7468  2539 -3760.7563   23  329 -5112.8376 -1418.7522  72.3%   915  472s
  7543  2503     cutoff   24      -5112.8376 -1418.7522  72.3%   915  476s
  7734  2395 -4097.8525   24  371 -5112.8376 -1732.3663  66.1%   916  483s
  7839  2348     cutoff   26      -5112.8376 -1732.3663  66.1%   917  487s
  7901  2313 -4512.0806   25  315 -5112.8376 -2001.1748  60.9%   920  491s
  7993  2269     cutoff   25      -5112.8376 -2001.1748  60.9%   919  495s
  8063  2206     cutoff   26      -5112.8376 -2001.1748  60.9%   919  500s
  8331  1982 -4109.6114   32  434 -5112.8376 -2996.9641  41.4%   911  508s
  8463  1892     cutoff   33      -5112.8376 -3205.0835  37.3%   905  510s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 258
  Flow cover: 566
  Zero half: 2
  RLT: 11
  Relax-and-lift: 40

Explored 8584 nodes (7774769 simplex iterations) in 513.24 seconds (943.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -5112.84 -5113.74 -5115.44 ... -25214.6
No other solutions better than -5112.84

Optimal solution found (tolerance 1.00e-06)
Best objective -5.112837634499e+03, best bound -5.112837634499e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 513.26s
  Master Objective (UB) = -5112.84, θ = 121210.92
  Upper Bound (UB) = -5112.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 121210.92
  [DEBUG]   ✓ Scenario 0: θ = 121210.92 ≤ Q = 121210.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 121210.92 ≤ Q = 121210.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 121210.92 ≤ Q = 121210.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x506e8bac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaf917454
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352127e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6346407.0542
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.493672e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149367.18    0  129 6346407.05 -149367.18   102%     -    0s
H    0     0                    -109646.5994 -149367.18  36.2%     -    0s
H    0     0                    -111113.3023 -149367.18  34.4%     -    0s
H    0     0                    -114567.1387 -149367.18  30.4%     -    0s
     0     0 -128130.12    0   34 -114567.14 -128130.12  11.8%     -    0s
H    0     0                    -127550.3897 -128060.79  0.40%     -    0s
H    0     0                    -127628.6650 -127800.21  0.13%     -    0s
     0     0 -127800.21    0   24 -127628.67 -127800.21  0.13%     -    0s
     0     0 -127773.74    0   14 -127628.67 -127773.74  0.11%     -    0s
     0     0 -127763.40    0   13 -127628.67 -127763.40  0.11%     -    0s
     0     0 -127755.03    0   10 -127628.67 -127755.03  0.10%     -    0s
     0     0 -127753.16    0   11 -127628.67 -127753.16  0.10%     -    0s
     0     0 -127724.91    0    3 -127628.67 -127724.91  0.08%     -    0s
     0     0 -127724.91    0   15 -127628.67 -127724.91  0.08%     -    0s
H    0     0                    -127652.4783 -127724.91  0.06%     -    0s
H    0     0                    -127652.5717 -127724.91  0.06%     -    0s
     0     0 -127717.92    0    4 -127652.57 -127717.92  0.05%     -    0s
H    0     0                    -127717.5111 -127717.54  0.00%     -    0s

Cutting planes:
  MIR: 14
  Flow cover: 2
  RLT: 1

Explored 1 nodes (548 simplex iterations) in 0.18 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -127718 -127653 -127652 ... 1.35213e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -1.277175110965e+05, best bound -1.277175385187e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 106781.74
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127717.51
  [DEBUG]   S×d_nominal = 234499.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234499.25 + -127717.51 = 106781.74
  [DEBUG]   Current θ from Master = 121210.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14429.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19542.01
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 4213.6991, Absolute Gap = 4213.6991, Relative Gap = 0.824141
  Not converged yet (gap = 4213.70 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x6dce8fd5
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -19542 (0.04s)
MIP start from previous solve produced solution with objective -19542 (0.04s)
Loaded MIP start from previous solve with objective -19542

Presolve removed 28280 rows and 11480 columns
Presolve time: 1.66s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27604   -3.6522236e+03   0.000000e+00   1.561100e+06      5s
   38263    1.0826436e+04   0.000000e+00   4.559297e+05     10s
Concurrent spin time: 3.57s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.351305e+04, 27507 iterations, 14.82 seconds (18.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13513.0501    0  245 -19542.009 13513.0501   169%     -   16s
H    0     0                    -6132.908009 13513.0501   320%     -   17s
H    0     0                    -5767.617121 13513.0501   334%     -   17s
H    0     0                    -5759.278822 13513.0501   335%     -   17s
H    0     0                    -5752.257321 13513.0501   335%     -   17s
H    0     0                    -5705.359681 13513.0501   337%     -   17s
H    0     0                    -5595.063087 13513.0501   342%     -   17s
H    0     0                    -5448.783095 13513.0501   348%     -   17s
H    0     0                    -5443.915006 13513.0501   348%     -   17s
H    0     0                    -5435.338779 13513.0501   349%     -   17s
H    0     0                    -5428.555207 13513.0501   349%     -   17s
     0     0 10001.1382    0  317 -5428.5552 10001.1382   284%     -   22s
H    0     0                    -5368.858105 10000.3544   286%     -   22s
H    0     0                    -5362.197360 10000.3544   286%     -   22s
H    0     0                    -5361.231654 9419.99784   276%     -   24s
H    0     0                    -5319.089512 9419.99784   277%     -   24s
     0     0 9419.99784    0  316 -5319.0895 9419.99784   277%     -   24s
     0     0 9360.24803    0  324 -5319.0895 9360.24803   276%     -   25s
     0     0 9302.31082    0  341 -5319.0895 9302.31082   275%     -   26s
     0     0 9302.31082    0  341 -5319.0895 9302.31082   275%     -   26s
H    0     0                    -5276.147697 7701.14758   246%     -   31s
     0     0 7701.14758    0  382 -5276.1477 7701.14758   246%     -   31s
     0     0 7296.45799    0  399 -5276.1477 7296.45799   238%     -   33s
     0     0 7145.58820    0  422 -5276.1477 7145.58820   235%     -   35s
     0     0 6879.91460    0  395 -5276.1477 6879.91460   230%     -   37s
     0     0 6769.30986    0  408 -5276.1477 6769.30986   228%     -   38s
     0     0 6726.37548    0  401 -5276.1477 6726.37548   227%     -   39s
     0     0 6720.26010    0  410 -5276.1477 6720.26010   227%     -   39s
     0     0 6719.98008    0  410 -5276.1477 6719.98008   227%     -   39s
H    0     0                    -5251.978207 5615.12707   207%     -   47s
H    0     0                    -5237.783560 5615.12707   207%     -   47s
     0     0 5615.12707    0  423 -5237.7836 5615.12707   207%     -   47s
     0     0 4952.53702    0  427 -5237.7836 4952.53702   195%     -   50s
     0     0 4827.76380    0  448 -5237.7836 4827.76380   192%     -   51s
     0     0 4777.17741    0  451 -5237.7836 4777.17741   191%     -   52s
     0     0 4761.44128    0  456 -5237.7836 4761.44128   191%     -   53s
     0     0 4743.44956    0  458 -5237.7836 4743.44956   191%     -   53s
     0     0 4738.56377    0  454 -5237.7836 4738.56377   190%     -   53s
     0     0 4732.75895    0  458 -5237.7836 4732.75895   190%     -   53s
     0     0 4732.11619    0  457 -5237.7836 4732.11619   190%     -   54s
     0     0 4148.67284    0  451 -5237.7836 4148.67284   179%     -   62s
     0     0 3918.62916    0  454 -5237.7836 3918.62916   175%     -   64s
     0     0 3792.51400    0  464 -5237.7836 3792.51400   172%     -   67s
     0     0 3728.07933    0  446 -5237.7836 3728.07933   171%     -   68s
     0     0 3691.48941    0  463 -5237.7836 3691.48941   170%     -   69s
     0     0 3659.38288    0  454 -5237.7836 3659.38288   170%     -   70s
     0     0 3644.65046    0  456 -5237.7836 3644.65046   170%     -   71s
     0     0 3622.09397    0  463 -5237.7836 3622.09397   169%     -   71s
     0     0 3621.22818    0  467 -5237.7836 3621.22818   169%     -   72s
     0     0 3561.65797    0  471 -5237.7836 3561.65797   168%     -   74s
     0     0 3537.44471    0  463 -5237.7836 3537.44471   168%     -   75s
     0     0 3530.21259    0  474 -5237.7836 3530.21259   167%     -   76s
     0     0 3525.27216    0  470 -5237.7836 3525.27216   167%     -   76s
     0     0 3523.53026    0  476 -5237.7836 3523.53026   167%     -   77s
     0     0 3523.25817    0  478 -5237.7836 3523.25817   167%     -   77s
     0     0 3469.64452    0  525 -5237.7836 3469.64452   166%     -   79s
     0     0 3463.59996    0  522 -5237.7836 3463.59996   166%     -   80s
     0     0 3461.89550    0  529 -5237.7836 3461.89550   166%     -   81s
     0     0 3458.82242    0  528 -5237.7836 3458.82242   166%     -   81s
     0     0 3454.26859    0  523 -5237.7836 3454.26859   166%     -   81s
     0     0 3454.15046    0  522 -5237.7836 3454.15046   166%     -   82s
     0     0 3413.85610    0  513 -5237.7836 3413.85610   165%     -   84s
     0     0 3407.77733    0  465 -5237.7836 3407.77733   165%     -   85s
     0     0 3405.46999    0  514 -5237.7836 3405.46999   165%     -   85s
     0     0 3404.03638    0  531 -5237.7836 3404.03638   165%     -   85s
     0     0 3403.98917    0  480 -5237.7836 3403.98917   165%     -   85s
     0     0 3388.09083    0  526 -5237.7836 3388.09083   165%     -   87s
     0     0 3382.63415    0  532 -5237.7836 3382.63415   165%     -   88s
     0     0 3380.81219    0  535 -5237.7836 3380.81219   165%     -   88s
     0     0 3380.39080    0  538 -5237.7836 3380.39080   165%     -   88s
     0     0 3365.53221    0  541 -5237.7836 3365.53221   164%     -   90s
     0     0 3354.50401    0  527 -5237.7836 3354.50401   164%     -   90s
     0     0 3348.24992    0  480 -5237.7836 3348.24992   164%     -   91s
     0     0 3345.19222    0  543 -5237.7836 3345.19222   164%     -   91s
     0     0 3344.08876    0  540 -5237.7836 3344.08876   164%     -   91s
     0     0 3335.83702    0  557 -5237.7836 3335.83702   164%     -   93s
     0     0 3329.99747    0  547 -5237.7836 3329.99747   164%     -   93s
     0     0 3329.99747    0  552 -5237.7836 3329.99747   164%     -   94s
     0     0 3323.90468    0  490 -5237.7836 3323.90468   163%     -   95s
     0     0 3321.49335    0  497 -5237.7836 3321.49335   163%     -   96s
     0     0 3321.43956    0  551 -5237.7836 3321.43956   163%     -   96s
     0     0 3317.79679    0  503 -5237.7836 3317.79679   163%     -   97s
     0     0 3315.94284    0  504 -5237.7836 3315.94284   163%     -   97s
     0     0 3313.79820    0  499 -5237.7836 3313.79820   163%     -   98s
     0     0 3307.89671    0  501 -5237.7836 3307.89671   163%     -   99s
     0     0 3307.89671    0  502 -5237.7836 3307.89671   163%     -  100s
     0     0 3307.89671    0  502 -5237.7836 3307.89671   163%     -  100s
     0     2 3307.84014    0  502 -5237.7836 3307.84014   163%     -  124s
     1     4 3139.20579    1  485 -5237.7836 3304.91563   163%   935  127s
     3     8 2739.56505    2  468 -5237.7836 3138.69487   160%  2482  132s
     7    16 2444.09544    3  462 -5237.7836 2739.13097   152%  3174  135s
    31    64 1829.61325    5  537 -5237.7836 2225.75565   142%  4160  146s
    63    96 1807.48360    6  541 -5237.7836 1949.30537   137%  3409  150s
    95   179 1652.12533    7  481 -5237.7836 1949.30537   137%  2813  155s
   178   262 1276.22471    8  420 -5237.7836 1949.30537   137%  2007  161s
   269   295 1156.54544    8  530 -5237.7836 1949.30537   137%  1641  166s
   310   355  847.05925    9  454 -5237.7836 1912.85549   137%  1604  172s
   383   382  839.01549    9  423 -5237.7836 1912.85549   137%  1504  177s
   455   420  403.71203   10  465 -5237.7836 1912.85549   137%  1467  184s
   519   467 -776.35294   11  459 -5237.7836 1425.29594   127%  1469  190s
   656   564 -1073.8644   13  454 -5237.7836 1425.29594   127%  1418  199s
   711   580 -1317.6873   14  441 -5237.7836 1425.29594   127%  1380  204s
   787   601 -1367.5193   15  437 -5237.7836 1425.29594   127%  1333  210s
   900   671 -3342.9399   16  417 -5237.7836 1403.75178   127%  1338  221s
   970   706 -3502.6993   17  396 -5237.7836 1361.99304   126%  1319  228s
  1047   738 -4827.2237   17  307 -5237.7836 1361.99304   126%  1298  233s
  1113   763 -4777.2992   18  316 -5237.7836 1361.99304   126%  1282  240s
  1182   776 -4778.5244   18  417 -5237.7836 1361.99304   126%  1284  245s
  1254   823 -5019.8276   19  382 -5237.7836 1265.87711   124%  1285  250s
  1339   847     cutoff   19      -5237.7836  992.11373   119%  1273  256s
  1423   899  221.04596   10  467 -5237.7836  889.18519   117%  1267  261s
  1522   922 -1021.2215   13  412 -5237.7836  889.18519   117%  1259  268s
  1663   954 -2618.3775   15  216 -5237.7836  815.74355   116%  1233  275s
  1783   994     cutoff   17      -5237.7836  815.74355   116%  1219  284s
  1901  1059 -4255.8122   20  326 -5237.7836  585.15631   111%  1216  292s
  2035  1078     cutoff   25      -5237.7836  585.15631   111%  1209  300s
  2100  1130 -327.62833   10  336 -5237.7836  552.30513   111%  1210  308s
  2206  1164 -886.81727   11  297 -5237.7836  552.30513   111%  1208  319s
  2331  1209 -2288.2030   12  291 -5237.7836  552.30513   111%  1195  327s
  2471  1245     cutoff   15      -5237.7836  552.30513   111%  1189  335s
  2606  1313 -4532.1939   19  224 -5237.7836  256.20467   105%  1184  342s
  2735  1373     cutoff   22      -5237.7836  256.20467   105%  1182  352s
  2882  1435 -707.16659    9  334 -5237.7836  160.88250   103%  1180  362s
  3083  1501 -2212.8228   11  293 -5237.7836  160.88250   103%  1170  370s
  3255  1563     cutoff   18      -5237.7836  160.88250   103%  1168  381s
  3480  1582     cutoff   11      -5237.7836   69.60832   101%  1152  390s
  3702  1591 -4249.6832   12  298 -5237.7836   -2.47775   100%  1143  400s
  3771  1619 -4286.1200   13  308 -5237.7836 -113.06283  97.8%  1151  412s
  3901  1653 -4634.1784   14  293 -5237.7836 -113.06283  97.8%  1151  423s
  4094  1713     cutoff   22      -5237.7836 -387.32314  92.6%  1154  431s
  4292  1773     cutoff   12      -5237.7836 -387.32314  92.6%  1154  444s
  4524  1813     cutoff   23      -5237.7836 -503.75269  90.4%  1154  455s
  4780  1840 -4759.2915   12  123 -5237.7836 -553.68074  89.4%  1146  465s
  4994  1845 -4656.5384   14  302 -5237.7836 -627.55403  88.0%  1143  477s
  5096  1893     cutoff   15      -5237.7836 -627.55403  88.0%  1147  493s
  5333  1897 -3402.3876   12  326 -5237.7836 -685.39433  86.9%  1147  506s
  5610  1922 -4019.8644   15  248 -5237.7836 -769.81551  85.3%  1147  518s
  5865  1945     cutoff   22      -5237.7836 -781.87207  85.1%  1148  535s
  6249  1940     cutoff   14      -5237.7836 -1170.7873  77.6%  1139  547s
  6535  1939 -4125.6509   16  238 -5237.7836 -1301.5526  75.2%  1135  561s
  7070  1912     cutoff   13      -5237.7836 -1666.7222  68.2%  1104  576s
  7558  1888     cutoff   12      -5237.7836 -1793.7273  65.8%  1089  589s
  8014  1903 -3957.3819   15  280 -5237.7836 -1808.7954  65.5%  1075  601s
  8505  1890 -4982.6425   21  258 -5237.7836 -1975.1855  62.3%  1059  617s
  9115  1842     cutoff   26      -5237.7836 -2227.1665  57.5%  1042  632s
  9621  1736 -5113.0704   17  242 -5237.7836 -2258.4037  56.9%  1030  648s
 10178  1589 infeasible   19      -5237.7836 -2473.5835  52.8%  1023  664s
 10689  1448     cutoff   19      -5237.7836 -2611.0101  50.2%  1022  682s
 11281  1291     cutoff   16      -5237.7836 -2878.4495  45.0%  1014  702s
 11901   965     cutoff   22      -5237.7836 -3192.2367  39.1%  1007  719s
 12584   476     cutoff   17      -5237.7836 -3465.5505  33.8%   996  736s
 13368     9     cutoff   22      -5237.7836 -4033.6361  23.0%   978  750s

Cutting planes:
  Gomory: 1
  Implied bound: 34
  MIR: 587
  Flow cover: 909
  RLT: 29
  Relax-and-lift: 38

Explored 14108 nodes (13456881 simplex iterations) in 750.51 seconds (1475.64 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5237.78 -5251.98 -5276.15 ... -5443.92
No other solutions better than -5237.78

Optimal solution found (tolerance 1.00e-06)
Best objective -5.237783560166e+03, best bound -5.237783560166e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 750.53s
  Master Objective (UB) = -5237.78, θ = 121400.18
  Upper Bound (UB) = -5237.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 121400.18
  [DEBUG]   ✓ Scenario 0: θ = 121400.18 ≤ Q = 121400.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 121400.18 ≤ Q = 121400.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 121400.18 ≤ Q = 121400.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 121400.18 ≤ Q = 121400.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x20690b9a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x20690b9a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6455428.4945
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.438081e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143808.11    0  124 6455428.49 -143808.11   102%     -    0s
H    0     0                    -109998.0748 -143808.11  30.7%     -    0s
H    0     0                    -110983.8101 -143808.11  29.6%     -    0s
     0     0 -122580.66    0   85 -110983.81 -122580.66  10.4%     -    0s
H    0     0                    -117691.1034 -122526.59  4.11%     -    0s
H    0     0                    -118244.4550 -122526.59  3.62%     -    0s
H    0     0                    -118526.6007 -122526.59  3.37%     -    0s
H    0     0                    -119079.9523 -122526.59  2.89%     -    0s
     0     0 -121689.65    0   84 -119079.95 -121689.65  2.19%     -    0s
H    0     0                    -119200.6721 -120766.77  1.31%     -    0s
     0     0 -120766.77    0   78 -119200.67 -120766.77  1.31%     -    0s
     0     0 -120737.59    0   71 -119200.67 -120737.59  1.29%     -    0s
     0     0 -120734.57    0   75 -119200.67 -120734.57  1.29%     -    0s
     0     0 -120261.78    0   58 -119200.67 -120261.78  0.89%     -    0s
     0     0 -120177.79    0   57 -119200.67 -120177.79  0.82%     -    0s
     0     0 -120177.79    0   58 -119200.67 -120177.79  0.82%     -    0s
     0     0 -120048.68    0   48 -119200.67 -120048.68  0.71%     -    0s
     0     0 -119993.14    0   49 -119200.67 -119993.14  0.66%     -    0s
     0     0 -119907.41    0   24 -119200.67 -119907.41  0.59%     -    0s
     0     0 -119876.50    0   22 -119200.67 -119876.50  0.57%     -    0s
     0     0 -119866.58    0   33 -119200.67 -119866.58  0.56%     -    0s
     0     0 -119807.14    0   21 -119200.67 -119807.14  0.51%     -    0s
     0     0 -119800.35    0   23 -119200.67 -119800.35  0.50%     -    0s
     0     0 -119786.59    0   23 -119200.67 -119786.59  0.49%     -    0s
     0     0 -119778.95    0   23 -119200.67 -119778.95  0.49%     -    0s
H    0     0                    -119263.0465 -119778.95  0.43%     -    0s
     0     2 -119778.95    0   23 -119263.05 -119778.95  0.43%     -    0s
H  440   234                    -119279.7504 -119475.29  0.16%   4.1    0s
H  445   234                    -119286.8857 -119475.29  0.16%   4.1    0s
H  450   234                    -119292.4863 -119475.29  0.15%   4.0    0s
H  465   234                    -119313.6852 -119475.29  0.14%   4.0    0s
H  580   168                    -119335.3641 -119423.29  0.07%   3.9    0s

Cutting planes:
  Gomory: 16
  Implied bound: 6
  MIR: 137
  Flow cover: 6
  RLT: 57
  Relax-and-lift: 3
  BQP: 1

Explored 1036 nodes (3893 simplex iterations) in 0.24 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -119335 -119314 -119292 ... -110984
No other solutions better than -119335

Optimal solution found (tolerance 1.00e-06)
Best objective -1.193353641460e+05, best bound -1.193353641460e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 114688.18
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119335.36
  [DEBUG]   S×d_nominal = 234023.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234023.54 + -119335.36 = 114688.18
  [DEBUG]   Current θ from Master = 121400.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6712.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11949.78
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 4088.7532, Absolute Gap = 4088.7532, Relative Gap = 0.780627
  Not converged yet (gap = 4088.75 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x5a092d5e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.33s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21089   -3.1509763e+04   0.000000e+00   4.240983e+07      5s
   31702   -5.9091650e+03   0.000000e+00   1.040296e+06     10s
   39786    7.1016844e+03   0.000000e+00   2.550357e+06     15s
   46661    1.0270462e+04   0.000000e+00   1.549799e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.348779e+04, 35272 iterations, 21.43 seconds (28.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13487.7927    0  251 -177247.82 13487.7927   108%     -   23s
H    0     0                    -171592.8935 13487.7927   108%     -   23s
H    0     0                    -58191.37709 13487.7927   123%     -   23s
H    0     0                    -58180.73897 13487.7927   123%     -   23s
H    0     0                    -55738.73293 13487.7927   124%     -   23s
H    0     0                    -40561.68453 13487.7927   133%     -   23s
H    0     0                    -15965.88278 13487.7927   184%     -   23s
H    0     0                    -14316.80016 13487.7927   194%     -   23s
H    0     0                    -14303.35584 13487.7927   194%     -   23s
H    0     0                    -14281.90146 13487.7927   194%     -   23s
H    0     0                    -6763.800022 13487.7927   299%     -   24s
H    0     0                    -6370.429698 13487.7927   312%     -   24s
H    0     0                    -6358.459700 13487.7927   312%     -   24s
H    0     0                    -6350.934595 13486.1878   312%     -   24s
H    0     0                    -6317.370639 13486.1878   313%     -   24s
H    0     0                    -6041.884608 13486.1878   323%     -   24s
H    0     0                    -6005.712143 13486.1878   325%     -   24s
H    0     0                    -6005.229490 13486.1878   325%     -   24s
H    0     0                    -5956.575439 13486.1878   326%     -   24s
H    0     0                    -5868.386098 13486.1878   330%     -   24s
H    0     0                    -5847.625696 9739.09455   267%     -   32s
H    0     0                    -5761.071028 9739.09455   269%     -   32s
H    0     0                    -5708.823910 9739.09455   271%     -   32s
     0     0 9739.09455    0  287 -5708.8239 9739.09455   271%     -   32s
     0     0 9531.12446    0  299 -5708.8239 9531.12446   267%     -   35s
     0     0 9531.12446    0  297 -5708.8239 9531.12446   267%     -   35s
     0     0 9095.34656    0  327 -5708.8239 9095.34656   259%     -   38s
     0     0 9095.34656    0  338 -5708.8239 9095.34656   259%     -   40s
     0     0 9095.34656    0  335 -5708.8239 9095.34656   259%     -   40s
     0     0 9095.34656    0  335 -5708.8239 9095.34656   259%     -   40s
H    0     0                    -5616.190897 7532.49819   234%     -   49s
H    0     0                    -5585.806712 7532.49819   235%     -   49s
     0     0 7504.06082    0  371 -5585.8067 7504.06082   234%     -   49s
H    0     0                    -5553.590982 7504.06082   235%     -   49s
     0     0 7380.10539    0  373 -5553.5910 7380.10539   233%     -   52s
     0     0 7151.45339    0  403 -5553.5910 7151.45339   229%     -   55s
     0     0 6901.82025    0  395 -5553.5910 6901.82025   224%     -   57s
     0     0 6738.78481    0  404 -5553.5910 6738.78481   221%     -   59s
     0     0 6649.00352    0  400 -5553.5910 6649.00352   220%     -   61s
     0     0 6645.29117    0  403 -5553.5910 6645.29117   220%     -   61s
     0     0 6645.06747    0  403 -5553.5910 6645.06747   220%     -   61s
H    0     0                    -5437.208522 6645.06747   222%     -   66s
H    0     0                    -5344.868044 5190.74807   197%     -   75s
     0     0 5190.74807    0  426 -5344.8680 5190.74807   197%     -   75s
H    0     0                    -5342.061852 4966.45791   193%     -   80s
     0     0 4966.45791    0  432 -5342.0619 4966.45791   193%     -   80s
     0     0 4723.02878    0  426 -5342.0619 4723.02878   188%     -   82s
     0     0 4592.84984    0  443 -5342.0619 4592.84984   186%     -   85s
     0     0 4570.51286    0  441 -5342.0619 4570.51286   186%     -   85s
     0     0 4545.86129    0  447 -5342.0619 4545.86129   185%     -   86s
     0     0 4520.34683    0  449 -5342.0619 4520.34683   185%     -   87s
     0     0 4513.51439    0  448 -5342.0619 4513.51439   184%     -   87s
     0     0 4512.85693    0  447 -5342.0619 4512.85693   184%     -   88s
     0     0 3813.14527    0  526 -5342.0619 3813.14527   171%     -   97s
     0     0 3635.38436    0  521 -5342.0619 3635.38436   168%     -  101s
     0     0 3576.96947    0  520 -5342.0619 3576.96947   167%     -  103s
     0     0 3533.06835    0  465 -5342.0619 3533.06835   166%     -  106s
     0     0 3500.96679    0  463 -5342.0619 3500.96679   166%     -  108s
     0     0 3487.13009    0  509 -5342.0619 3487.13009   165%     -  109s
     0     0 3464.24204    0  461 -5342.0619 3464.24204   165%     -  111s
     0     0 3460.48046    0  459 -5342.0619 3460.48046   165%     -  112s
     0     0 3452.20294    0  459 -5342.0619 3452.20294   165%     -  112s
     0     0 3444.71884    0  463 -5342.0619 3444.71884   164%     -  113s
     0     0 3443.84998    0  466 -5342.0619 3443.84998   164%     -  113s
     0     0 3393.24165    0  522 -5342.0619 3393.24165   164%     -  117s
     0     0 3374.60193    0  529 -5342.0619 3374.60193   163%     -  118s
     0     0 3368.23693    0  524 -5342.0619 3368.23693   163%     -  119s
     0     0 3367.51420    0  530 -5342.0619 3367.51420   163%     -  119s
     0     0 3312.30709    0  525 -5342.0619 3312.30709   162%     -  122s
     0     0 3303.21427    0  536 -5342.0619 3303.21427   162%     -  123s
     0     0 3296.77962    0  536 -5342.0619 3296.77962   162%     -  124s
     0     0 3294.15956    0  538 -5342.0619 3294.15956   162%     -  124s
     0     0 3292.08082    0  541 -5342.0619 3292.08082   162%     -  125s
     0     0 3290.61298    0  539 -5342.0619 3290.61298   162%     -  125s
     0     0 3289.86194    0  545 -5342.0619 3289.86194   162%     -  125s
     0     0 3237.96202    0  549 -5342.0619 3237.96202   161%     -  128s
     0     0 3231.87391    0  563 -5342.0619 3231.87391   160%     -  128s
     0     0 3229.93980    0  558 -5342.0619 3229.93980   160%     -  129s
     0     0 3229.46980    0  563 -5342.0619 3229.46980   160%     -  129s
     0     0 3209.07227    0  552 -5342.0619 3209.07227   160%     -  131s
     0     0 3206.10744    0  561 -5342.0619 3206.10744   160%     -  132s
     0     0 3205.44787    0  556 -5342.0619 3205.44787   160%     -  133s
     0     0 3180.10972    0  498 -5342.0619 3180.10972   160%     -  135s
     0     0 3173.53307    0  496 -5342.0619 3173.53307   159%     -  137s
     0     0 3166.98139    0  560 -5342.0619 3166.98139   159%     -  139s
     0     0 3165.81952    0  510 -5342.0619 3165.81952   159%     -  140s
     0     0 3091.26896    0  494 -5342.0619 3091.26896   158%     -  142s
     0     0 3080.98819    0  554 -5342.0619 3080.98819   158%     -  144s
     0     0 3076.55742    0  501 -5342.0619 3076.55742   158%     -  145s
     0     0 3072.88702    0  561 -5342.0619 3072.88702   158%     -  146s
     0     0 3071.45927    0  567 -5342.0619 3071.45927   157%     -  146s
     0     0 3071.12949    0  568 -5342.0619 3071.12949   157%     -  146s
     0     0 3063.39450    0  566 -5342.0619 3063.39450   157%     -  148s
     0     0 3060.63195    0  560 -5342.0619 3060.63195   157%     -  149s
     0     0 3059.95031    0  560 -5342.0619 3059.95031   157%     -  150s
     0     0 3047.80481    0  566 -5342.0619 3047.80481   157%     -  152s
     0     0 3046.75781    0  497 -5342.0619 3046.75781   157%     -  152s
     0     0 3042.13818    0  495 -5342.0619 3042.13818   157%     -  154s
     0     0 3039.69418    0  508 -5342.0619 3039.69418   157%     -  155s
     0     0 3038.72210    0  517 -5342.0619 3038.72210   157%     -  156s
     0     0 3030.59487    0  505 -5342.0619 3030.59487   157%     -  158s
     0     0 3030.32852    0  511 -5342.0619 3030.32852   157%     -  159s
     0     0 3023.59456    0  569 -5342.0619 3023.59456   157%     -  161s
     0     0 3022.06229    0  579 -5342.0619 3022.06229   157%     -  162s
     0     0 3021.50266    0  577 -5342.0619 3021.50266   157%     -  162s
     0     0 3011.95169    0  564 -5342.0619 3011.95169   156%     -  164s
     0     0 3011.91851    0  564 -5342.0619 3011.91851   156%     -  166s
     0     2 3011.69336    0  564 -5342.0619 3011.69336   156%     -  179s
     1     4 2658.02548    1  471 -5342.0619 3011.60222   156%  5817  184s
     3     8 2574.11023    2  549 -5342.0619 2657.55862   150%  3750  188s
     7    16 2499.54452    3  549 -5342.0619 2573.73538   148%  3660  193s
    15    32 2333.86723    4  550 -5342.0619 2499.37761   147%  3615  202s
    31    64 2093.55634    5  548 -5342.0619 2327.33553   144%  6985  210s
    95   153 1783.61772    7  552 -5342.0619 2092.99701   139%  4040  225s
   168   231  952.85875    8  538 -5342.0619 2092.99701   139%  3049  233s
   254   257 1650.54445    8  544 -5342.0619 2092.99701   139%  2560  239s
   293   295  921.35825    9  536 -5342.0619 2092.99701   139%  2400  245s
   341   330  652.94623   10  528 -5342.0619 2092.99701   139%  2325  252s
   412   371  -94.31691   10  542 -5342.0619 2092.99701   139%  2186  260s
   482   401  493.67778   11  531 -5342.0619 1671.20477   131%  2122  268s
   548   427   -1.13310   11  455 -5342.0619 1650.26334   131%  2100  276s
   607   456  230.37381   12  532 -5342.0619 1650.26334   131%  2110  284s
   657   504 -192.47300   12  515 -5342.0619 1650.26334   131%  2172  293s
   725   534 -148.86120   13  463 -5342.0619 1650.26334   131%  2172  299s
   772   567 -734.15304   14  469 -5342.0619 1650.26334   131%  2169  307s
   833   619 -3415.2822   15  231 -5342.0619 1517.79736   128%  2153  314s
   908   652 -1544.2912   15  500 -5342.0619 1347.23312   125%  2095  322s
   975   693 -2158.2135   16  392 -5342.0619 1347.23312   125%  2065  329s
  1044   722 -2690.7426   17  389 -5342.0619 1139.46039   121%  2058  335s
  1085   749 -3194.3809   18  330 -5342.0619 1139.46039   121%  2055  341s
  1123   798 infeasible   19      -5342.0619 1051.84518   120%  2071  348s
  1190   864 -3518.1088   20  357 -5342.0619 1051.84518   120%  2036  353s
  1286   917 -3570.5568   21  357 -5342.0619 1051.84518   120%  1959  361s
  1378   971 -3997.6870   25  376 -5342.0619  974.42646   118%  1916  368s
  1508  1027 -4443.2974   30  314 -5342.0619  974.42646   118%  1846  378s
  1629  1096 -4766.6499   32  341 -5342.0619  969.23218   118%  1808  386s
  1717  1154 -4958.9443   33  327 -5342.0619  969.23218   118%  1790  395s
  1826  1178 -5178.1850   35  319 -5342.0619  885.54405   117%  1763  403s
  1865  1199 -5138.6403   35  331 -5342.0619  885.54405   117%  1763  412s
  1930  1234     cutoff   36      -5342.0619  885.54405   117%  1753  421s
  2013  1272 -706.97490   13  490 -5342.0619  885.54405   117%  1740  431s
  2122  1295 -1304.6318   14  491 -5342.0619  885.54405   117%  1717  437s
  2160  1333 -1312.1872   15  488 -5342.0619  807.25261   115%  1724  448s
  2249  1389 -1869.0412   16  371 -5342.0619  807.25261   115%  1706  457s
  2349  1463 -2237.0130   17  427 -5342.0619  683.33116   113%  1691  467s
  2494  1526 -3130.6809   19  293 -5342.0619  609.76600   111%  1657  477s
  2625  1602 -4821.6290   25  293 -5342.0619  544.84868   110%  1656  490s
  2810  1680 -1385.0011   13  432 -5342.0619  432.34202   108%  1636  501s
  2998  1757 -2866.7246   16  391 -5342.0619  357.21954   107%  1617  515s
  3199  1840 -4700.6254   23  292 -5342.0619  257.20247   105%  1600  529s
  3372  1931     cutoff   16      -5342.0619  257.20247   105%  1595  542s
  3552  1993 -3151.1681   10  165 -5342.0619  155.58452   103%  1596  558s
  3760  2065 -1978.6914   14  347 -5342.0619  155.58452   103%  1591  571s
  3976  2124 -4176.6691   17  255 -5342.0619  155.58452   103%  1579  588s
  4200  2146     cutoff   19      -5342.0619    4.61472   100%  1565  603s
  4391  2218 infeasible   10      -5342.0619 -101.63941  98.1%  1553  620s
  4630  2244 -4411.3769   16  206 -5342.0619 -250.75935  95.3%  1546  637s
  4860  2280 -4611.1555   13  160 -5342.0619 -319.47746  94.0%  1550  655s
  5072  2308     cutoff   13      -5342.0619 -497.12888  90.7%  1559  675s
  5288  2346     cutoff   14      -5342.0619 -536.92423  89.9%  1572  694s
  5564  2345 -5002.4964   17  282 -5342.0619 -567.27232  89.4%  1575  716s
  5766  2377 -5122.1412   29  318 -5342.0619 -718.04740  86.6%  1584  738s
  6055  2381 -2951.9439   15  436 -5342.0619 -795.62765  85.1%  1586  761s
  6318  2369 -3961.6749   20  372 -5342.0619 -937.90413  82.4%  1599  785s
  6624  2389 -4813.5419   25  380 -5342.0619 -973.37449  81.8%  1605  807s
  6915  2384 infeasible   14      -5342.0619 -1026.0003  80.8%  1616  829s
  7194  2366 -3623.5223   17  279 -5342.0619 -1150.9447  78.5%  1619  846s
  7275  2383 -4348.1956   18  251 -5342.0619 -1150.9447  78.5%  1626  869s
  7520  2359 -5039.1474   21  327 -5342.0619 -1150.9447  78.5%  1621  895s
  7884  2332     cutoff    9      -5342.0619 -1413.9866  73.5%  1621  919s
  8312  2340 -3618.9885   18  216 -5342.0619 -1624.6305  69.6%  1613  943s
  8755  2320 -3270.8445   13  175 -5342.0619 -1802.7725  66.3%  1593  969s
  9191  2275 infeasible   15      -5342.0619 -1915.6782  64.1%  1583  996s
  9735  2252 infeasible   23      -5342.0619 -2159.2851  59.6%  1570 1024s
 10325  2205     cutoff   20      -5342.0619 -2322.1432  56.5%  1554 1051s
 10934  2205     cutoff   23      -5342.0619 -2541.3276  52.4%  1537 1082s
 11638  2124 -4149.3956   13  333 -5342.0619 -2736.2738  48.8%  1512 1114s
 12381  2082 -3664.7458   17  354 -5342.0619 -2907.1315  45.6%  1488 1144s
 13224  2056     cutoff   21      -5342.0619 -3152.9657  41.0%  1457 1172s
 13467  1974 -5297.7535   23  322 -5342.0619 -3248.1564  39.2%  1450 1204s
 14343  1844 -4605.9743   16  167 -5342.0619 -3455.6648  35.3%  1420 1237s
 15361  1751 -4781.4568   26  310 -5342.0619 -3784.0451  29.2%  1386 1268s
 16634  1500 -5098.7838   38  281 -5342.0619 -4007.3297  25.0%  1337 1299s
 18164  1015     cutoff   28      -5342.0619 -4301.9180  19.5%  1278 1329s
 19849   113 -5270.9462   35  255 -5342.0619 -4579.7690  14.3%  1218 1355s

Cutting planes:
  Learned: 2
  Gomory: 9
  Cover: 1
  Implied bound: 33
  MIR: 836
  Flow cover: 1257
  Zero half: 4
  RLT: 27
  Relax-and-lift: 52

Explored 22044 nodes (25122084 simplex iterations) in 1357.69 seconds (2806.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5342.06 -5344.87 -5437.21 ... -5868.39
No other solutions better than -5342.06

Optimal solution found (tolerance 1.00e-06)
Best objective -5.342061851598e+03, best bound -5.342061851598e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1357.75s
  Master Objective (UB) = -5342.06, θ = 120854.51
  Upper Bound (UB) = -5342.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120854.51
  [DEBUG]   ✓ Scenario 0: θ = 120854.51 ≤ Q = 120854.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120854.51 ≤ Q = 120854.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120854.51 ≤ Q = 120854.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120854.51 ≤ Q = 120854.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120854.51 ≤ Q = 120854.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3a16db0e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3a16db0e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6436072.3519
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.449608e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144960.77    0  124 6436072.35 -144960.77   102%     -    0s
H    0     0                    -111083.0567 -144960.77  30.5%     -    0s
H    0     0                    -112042.7732 -144960.77  29.4%     -    0s
     0     0 -122364.01    0  128 -112042.77 -122364.01  9.21%     -    0s
H    0     0                    -116669.4656 -122312.47  4.84%     -    0s
     0     0 -121383.29    0  129 -116669.47 -121383.29  4.04%     -    0s
H    0     0                    -117123.0020 -121299.62  3.57%     -    0s
     0     0 -120693.90    0   88 -117123.00 -120693.90  3.05%     -    0s
     0     0 -120553.33    0  135 -117123.00 -120553.33  2.93%     -    0s
     0     0 -120526.42    0  133 -117123.00 -120526.42  2.91%     -    0s
     0     0 -120284.10    0  135 -117123.00 -120284.10  2.70%     -    0s
H    0     0                    -117356.6193 -120251.94  2.47%     -    0s
     0     0 -120251.94    0  130 -117356.62 -120251.94  2.47%     -    0s
     0     0 -119930.09    0  136 -117356.62 -119930.09  2.19%     -    0s
     0     0 -119869.14    0  134 -117356.62 -119869.14  2.14%     -    0s
     0     0 -119337.70    0  127 -117356.62 -119337.70  1.69%     -    0s
     0     0 -119328.29    0  128 -117356.62 -119328.29  1.68%     -    0s
     0     0 -118948.67    0   77 -117356.62 -118948.67  1.36%     -    0s
H    0     0                    -117920.1956 -118849.65  0.79%     -    0s
     0     0 -118849.65    0   76 -117920.20 -118849.65  0.79%     -    0s
     0     0 -118849.65    0   76 -117920.20 -118849.65  0.79%     -    0s
     0     0 -118841.09    0   76 -117920.20 -118841.09  0.78%     -    0s
     0     0 -118656.02    0   58 -117920.20 -118656.02  0.62%     -    0s
     0     0 -118585.50    0   60 -117920.20 -118585.50  0.56%     -    0s
     0     0 -118582.85    0   59 -117920.20 -118582.85  0.56%     -    0s
     0     0 -118547.39    0   59 -117920.20 -118547.39  0.53%     -    0s
     0     0 -118532.65    0   59 -117920.20 -118532.65  0.52%     -    0s
H    0     0                    -117948.3803 -118532.65  0.50%     -    0s
     0     2 -118532.65    0   59 -117948.38 -118532.65  0.50%     -    0s
H  413   335                    -117989.3804 -118209.71  0.19%   6.0    0s
H  473   335                    -118036.8956 -118195.05  0.13%   5.6    0s
H  548   335                    -118068.7268 -118195.05  0.11%   5.4    0s
H 1016   300                    -118075.0723 -118163.93  0.08%   4.5    0s
* 1086   247              25    -118077.6674 -118163.93  0.07%   4.5    0s
H 1088   247                    -118107.6628 -118163.93  0.05%   4.5    0s

Cutting planes:
  Gomory: 24
  Implied bound: 5
  MIR: 183
  Flow cover: 7
  RLT: 49
  Relax-and-lift: 1

Explored 1469 nodes (6427 simplex iterations) in 0.62 seconds (0.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -118108 -118078 -118075 ... -117123
No other solutions better than -118108

Optimal solution found (tolerance 1.00e-06)
Best objective -1.181076627895e+05, best bound -1.181076627895e+05, gap 0.0000%
  Subproblem solved in 0.66s
  Worst-case operational profit (Z_SP) = 116391.59
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118107.66
  [DEBUG]   S×d_nominal = 234499.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234499.25 + -118107.66 = 116391.59
  [DEBUG]   Current θ from Master = 120854.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4462.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9804.98
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 3984.4749, Absolute Gap = 3984.4749, Relative Gap = 0.745868
  Not converged yet (gap = 3984.47 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x3f4e0a27
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.92s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23728   -8.1087277e+04   0.000000e+00   3.120458e+09      5s
   36827   -2.1042695e+04   0.000000e+00   9.683426e+07     10s
   45500   -6.1028365e+03   0.000000e+00   2.326436e+06     15s
   52444   -4.6618513e+03   0.000000e+00   6.949679e+06     20s
   58792    8.2548393e+02   0.000000e+00   2.819639e+07     25s
   64063    2.2436428e+03   0.000000e+00   1.141030e+07     30s
   69205    3.0258599e+03   0.000000e+00   1.950760e+06     35s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.348779e+04, 46917 iterations, 34.71 seconds (45.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13487.7927    0  251 -177247.82 13487.7927   108%     -   37s
H    0     0                    -79931.61352 13487.7927   117%     -   37s
H    0     0                    -74253.89911 13487.7927   118%     -   37s
H    0     0                    -38627.94224 13487.7927   135%     -   37s
H    0     0                    -38446.22107 13487.7927   135%     -   37s
H    0     0                    -6406.883371 13487.7927   311%     -   38s
H    0     0                    -6376.404280 13487.7927   312%     -   38s
H    0     0                    -6052.749798 13487.7927   323%     -   38s
H    0     0                    -6031.475119 13487.7927   324%     -   38s
H    0     0                    -6029.777625 13487.7927   324%     -   38s
     0     0 9411.41521    0  313 -6029.7776 9411.41521   256%     -   51s
H    0     0                    -5924.182257 9411.41521   259%     -   52s
H    0     0                    -5907.233980 9411.41521   259%     -   52s
H    0     0                    -5886.021989 9411.41521   260%     -   52s
H    0     0                    -5858.991050 9411.41521   261%     -   52s
H    0     0                    -5845.546734 9411.41521   261%     -   52s
H    0     0                    -5840.718606 9411.41521   261%     -   52s
H    0     0                    -5817.478595 9411.41521   262%     -   52s
     0     0 9103.67535    0  318 -5817.4786 9103.67535   256%     -   56s
     0     0 9103.67535    0  309 -5817.4786 9103.67535   256%     -   57s
     0     0 9103.67535    0  319 -5817.4786 9103.67535   256%     -   59s
     0     0 9103.67535    0  339 -5817.4786 9103.67535   256%     -   61s
     0     0 9103.67535    0  340 -5817.4786 9103.67535   256%     -   62s
     0     0 9103.67535    0  337 -5817.4786 9103.67535   256%     -   62s
     0     0 7854.67249    0  392 -5817.4786 7854.67249   235%     -   71s
H    0     0                    -5786.807715 7854.67249   236%     -   71s
H    0     0                    -5738.511617 7518.90266   231%     -   78s
H    0     0                    -5725.657116 7518.90266   231%     -   78s
H    0     0                    -5714.180615 7518.90266   232%     -   78s
H    0     0                    -5710.078723 7518.90266   232%     -   78s
H    0     0                    -5700.438760 7518.90266   232%     -   78s
H    0     0                    -5616.691540 7518.90266   234%     -   78s
H    0     0                    -5603.267693 7518.90266   234%     -   78s
     0     0 7518.90266    0  391 -5603.2677 7518.90266   234%     -   78s
     0     0 7302.82594    0  409 -5603.2677 7302.82594   230%     -   81s
     0     0 7067.08290    0  401 -5603.2677 7067.08290   226%     -   86s
     0     0 6912.46571    0  398 -5603.2677 6912.46571   223%     -   89s
     0     0 6824.99866    0  404 -5603.2677 6824.99866   222%     -   92s
     0     0 6710.77930    0  399 -5603.2677 6710.77930   220%     -   94s
     0     0 6697.87509    0  404 -5603.2677 6697.87509   220%     -   95s
     0     0 6692.74732    0  400 -5603.2677 6692.74732   219%     -   95s
     0     0 6689.59736    0  407 -5603.2677 6689.59736   219%     -   96s
     0     0 6682.95584    0  406 -5603.2677 6682.95584   219%     -   96s
     0     0 6682.79115    0  409 -5603.2677 6682.79115   219%     -   96s
     0     0 5312.31209    0  417 -5603.2677 5312.31209   195%     -  109s
H    0     0                    -5583.727288 4892.47362   188%     -  116s
H    0     0                    -5466.435909 4892.47362   190%     -  116s
     0     0 4892.47362    0  433 -5466.4359 4892.47362   190%     -  116s
     0     0 4656.98725    0  449 -5466.4359 4656.98725   185%     -  120s
     0     0 4580.50732    0  454 -5466.4359 4580.50732   184%     -  123s
     0     0 4436.51852    0  459 -5466.4359 4436.51852   181%     -  127s
H    0     0                    -5449.209345 4384.00653   180%     -  129s
H    0     0                    -5435.765029 4384.00653   181%     -  129s
     0     0 4384.00653    0  463 -5435.7650 4384.00653   181%     -  129s
     0     0 4366.77450    0  468 -5435.7650 4366.77450   180%     -  131s
     0     0 4359.15565    0  480 -5435.7650 4359.15565   180%     -  132s
     0     0 4356.95828    0  475 -5435.7650 4356.95828   180%     -  133s
     0     0 4353.69272    0  479 -5435.7650 4353.69272   180%     -  133s
     0     0 4353.57013    0  475 -5435.7650 4353.57013   180%     -  134s
H    0     0                    -5408.849389 3770.52570   170%     -  145s
     0     0 3770.52570    0  459 -5408.8494 3770.52570   170%     -  145s
     0     0 3654.21819    0  462 -5408.8494 3654.21819   168%     -  148s
     0     0 3580.39905    0  466 -5408.8494 3580.39905   166%     -  150s
     0     0 3547.47494    0  452 -5408.8494 3547.47494   166%     -  152s
     0     0 3528.83973    0  467 -5408.8494 3528.83973   165%     -  157s
     0     0 3523.60924    0  454 -5408.8494 3523.60924   165%     -  158s
     0     0 3505.81968    0  460 -5408.8494 3505.81968   165%     -  159s
     0     0 3499.61106    0  472 -5408.8494 3499.61106   165%     -  160s
     0     0 3497.76718    0  471 -5408.8494 3497.76718   165%     -  160s
     0     0 3496.73437    0  474 -5408.8494 3496.73437   165%     -  161s
     0     0 3387.78276    0  471 -5408.8494 3387.78276   163%     -  166s
     0     0 3366.37152    0  465 -5408.8494 3366.37152   162%     -  169s
     0     0 3352.45991    0  464 -5408.8494 3352.45991   162%     -  170s
     0     0 3342.98746    0  460 -5408.8494 3342.98746   162%     -  171s
     0     0 3341.30967    0  463 -5408.8494 3341.30967   162%     -  171s
     0     0 3338.13980    0  472 -5408.8494 3338.13980   162%     -  172s
     0     0 3338.12973    0  472 -5408.8494 3338.12973   162%     -  172s
     0     0 3303.44805    0  468 -5408.8494 3303.44805   161%     -  174s
     0     0 3289.49649    0  475 -5408.8494 3289.49649   161%     -  176s
     0     0 3277.28308    0  481 -5408.8494 3277.28308   161%     -  178s
     0     0 3274.06205    0  482 -5408.8494 3274.06205   161%     -  178s
     0     0 3270.56223    0  481 -5408.8494 3270.56223   160%     -  179s
     0     0 3257.24815    0  470 -5408.8494 3257.24815   160%     -  180s
     0     0 3254.96159    0  481 -5408.8494 3254.96159   160%     -  180s
     0     0 3254.68039    0  481 -5408.8494 3254.68039   160%     -  180s
     0     0 3238.27277    0  483 -5408.8494 3238.27277   160%     -  183s
     0     0 3219.32723    0  481 -5408.8494 3219.32723   160%     -  185s
     0     0 3216.01293    0  487 -5408.8494 3216.01293   159%     -  186s
     0     0 3214.74731    0  481 -5408.8494 3214.74731   159%     -  187s
     0     0 3197.69982    0  476 -5408.8494 3197.69982   159%     -  190s
     0     0 3197.09531    0  482 -5408.8494 3197.09531   159%     -  191s
     0     0 3190.08768    0  490 -5408.8494 3190.08768   159%     -  193s
     0     0 3188.31293    0  489 -5408.8494 3188.31293   159%     -  194s
     0     0 3187.51902    0  490 -5408.8494 3187.51902   159%     -  195s
     0     0 3182.80728    0  481 -5408.8494 3182.80728   159%     -  197s
     0     0 3180.86954    0  478 -5408.8494 3180.86954   159%     -  199s
     0     0 3179.44129    0  491 -5408.8494 3179.44129   159%     -  199s
     0     0 3178.37281    0  499 -5408.8494 3178.37281   159%     -  199s
     0     0 3172.00083    0  482 -5408.8494 3172.00083   159%     -  201s
     0     0 3170.66838    0  482 -5408.8494 3170.66838   159%     -  203s
     0     2 3169.12071    0  482 -5408.8494 3169.12071   159%     -  231s
     1     4 2707.99476    1  465 -5408.8494 3169.12071   159%  2874  236s
     3     8 2617.89805    2  471 -5408.8494 2706.18170   150%  3368  245s
     7    16 2387.05533    3  454 -5408.8494 2617.86879   148%  4759  251s
    15    32 2205.07502    4  474 -5408.8494 2384.89552   144%  5371  259s
    31    49 -3452.9516    5  179 -5408.8494 2204.78760   141%  6699  276s
    48    81 -1383.2427    6  253 -5408.8494 2204.78760   141%  6736  289s
    80   131 -1556.9675    7  241 -5408.8494 2204.78760   141%  5062  303s
   132   163 -1869.7804   10  246 -5408.8494 2204.78760   141%  3585  311s
   164   191 -1967.4227   10  239 -5408.8494 2204.78760   141%  3233  320s
   200   219 -2951.7269   11  185 -5408.8494 2204.78760   141%  3138  329s
   236   246 -2060.6508   10  253 -5408.8494 2204.78760   141%  2995  343s
   277   281 -2060.3777   11  226 -5408.8494 2204.78760   141%  2898  352s
   328   298 -2203.1306   11  260 -5408.8494 2204.78760   141%  2639  367s
   382   318 -2035.5315   11  225 -5408.8494 2204.78760   141%  2481  380s
   438   355 -3149.1208   12  158 -5408.8494 2204.78760   141%  2466  391s
   497   388 -3557.8728   14  156 -5408.8494 2204.78760   141%  2451  406s
   556   413 -4399.1584   14  140 -5408.8494 2204.78760   141%  2417  420s
   626   440     cutoff   17      -5408.8494 2204.78760   141%  2367  434s
   701   462 -2618.4565   13  344 -5408.8494 2204.78760   141%  2450  447s
   740   482 -2660.8247   14  337 -5408.8494 2204.78760   141%  2510  455s
   787   494 -3992.6396   17  404 -5408.8494 2204.78760   141%  2506  468s
   838   515     cutoff   18      -5408.8494 2204.78760   141%  2536  479s
   899   546 -2909.1150   16  392 -5408.8494 2204.78760   141%  2485  491s
   964   590 -4768.8171   18  301 -5408.8494 2204.78760   141%  2413  500s
  1029   619     cutoff   21      -5408.8494 2126.00289   139%  2361  512s
  1100   674 -672.67320   12  374 -5408.8494 2126.00289   139%  2329  527s
  1185   723 -4866.6474   14  239 -5408.8494 1656.32916   131%  2277  537s
  1291   777 -5373.5039   14  229 -5408.8494 1656.32916   131%  2192  549s
  1390   844     cutoff   34      -5408.8494 1611.11758   130%  2138  563s
  1497   916  648.11049    7  450 -5408.8494 1611.11758   130%  2090  575s
  1623  1023  343.97109    9  432 -5408.8494 1611.11758   130%  2042  588s
  1772  1165  -23.02921   11  478 -5408.8494 1271.20556   124%  1977  602s
  1958  1246 -396.97508   13  483 -5408.8494 1271.20556   124%  1871  618s
  2139  1317 -1257.7601   17  461 -5408.8494 1271.20556   124%  1810  634s
  2322  1346 -2291.6372   21  396 -5408.8494 1271.20556   124%  1769  649s
  2412  1439 -2444.7894   22  395 -5408.8494 1271.20556   124%  1772  665s
  2577  1520 -2538.6539   24  387 -5408.8494 1271.20556   124%  1745  681s
  2801  1609 -3288.2195   30  441 -5408.8494 1116.14438   121%  1708  697s
  3017  1675 -4627.2829   34  248 -5408.8494 1116.14438   121%  1684  714s
  3229  1764  -14.70880    9  515 -5408.8494  842.22774   116%  1680  731s
  3366  1904 -621.71665   11  522 -5408.8494  842.22774   116%  1710  749s
  3600  1977 -1096.6440   14  487 -5408.8494  842.22774   116%  1692  767s
  3757  2074 -1145.2357   15  480 -5408.8494  584.14738   111%  1680  785s
  3971  2108 -1791.2705   17  455 -5408.8494  553.54099   110%  1671  808s
  4167  2157 -3018.9194   20  455 -5408.8494  553.54099   110%  1693  829s
  4364  2227     cutoff   24      -5408.8494  398.35855   107%  1712  852s
  4568  2277     cutoff   64      -5408.8494  292.87543   105%  1728  876s
  4759  2338 -2451.1000   15  306 -5408.8494  267.10754   105%  1747  901s
  4989  2380 -4683.7882   16  275 -5408.8494  136.68254   103%  1763  926s
  5223  2432 -1105.7647    8  333 -5408.8494   77.65218   101%  1778  951s
  5395  2472 -2214.7379   12  320 -5408.8494  -24.64122   100%  1792  975s
  5616  2544 -4941.4836   13  189 -5408.8494  -24.64122   100%  1818 1001s
  5880  2626     cutoff   14      -5408.8494 -203.34865  96.2%  1833 1030s
  6151  2683 -3439.8695   15  247 -5408.8494 -242.21217  95.5%  1845 1061s
  6422  2735     cutoff   17      -5408.8494 -368.38165  93.2%  1859 1087s
  6652  2736 -4224.7050   30  482 -5408.8494 -449.65594  91.7%  1867 1135s
  6654  2737 -3475.2355   24  251 -5408.8494 -449.65594  91.7%  1866 1160s
  6655  2738 -4445.8184   14  400 -5408.8494 -449.65594  91.7%  1866 1182s
  6656  2739 -4139.0787   23  485 -5408.8494 -449.65594  91.7%  1865 1194s
  6657  2739 -5156.1385   25  476 -5408.8494 -449.65594  91.7%  1865 1201s
  6658  2740 -3391.3923   23  506 -5408.8494 -449.65594  91.7%  1865 1207s
  6659  2741 -2937.7178   17  453 -5408.8494 -449.65594  91.7%  1865 1212s
  6660  2741 -646.36771   10  465 -5408.8494 -449.65594  91.7%  1864 1218s
  6661  2742 -4097.7881   10  466 -5408.8494 -449.65594  91.7%  1864 1221s
  6662  2743 -1532.2877   13  473 -5408.8494 -449.65594  91.7%  1864 1225s
  6665  2745 -4398.2614   26  467 -5408.8494 -449.65594  91.7%  1863 1234s
  6666  2745 -4975.7599   32  486 -5408.8494 -449.65594  91.7%  1863 1237s
  6668  2747 -2179.0748   17  475 -5408.8494 -449.65594  91.7%  1862 1246s
  6669  2747 -2482.0253   14  464 -5408.8494 -449.65594  91.7%  1862 1250s
  6671  2749 -4024.4481   29  478 -5408.8494 -449.65594  91.7%  1861 1257s
  6673  2750 -2730.8065   15  493 -5408.8494 -449.65594  91.7%  1861 1264s
  6674  2751 -2444.9073   15  485 -5408.8494 -449.65594  91.7%  1860 1267s
  6675  2751 -564.28120   18  491 -5408.8494 -449.65594  91.7%  1860 1271s
  6676  2752 -2918.8278   11  595 -5408.8494 -449.65594  91.7%  1860 1278s
  6677  2753 -2988.4275   15  598 -5408.8494 -449.65594  91.7%  1860 1282s
  6678  2753 -2061.6325   12  601 -5408.8494 -449.65594  91.7%  1859 1285s
  6679  2754 -1974.8967   11  505 -5408.8494 -449.65594  91.7%  1859 1293s
  6680  2755 -1816.0828   15  498 -5408.8494 -449.65594  91.7%  1859 1295s
  6682  2756 -2815.3325   21  502 -5408.8494 -449.65594  91.7%  1858 1305s
  6684  2757 -4787.9490   28  509 -5408.8494 -449.65594  91.7%  1858 1311s
  6686  2759 -1499.6963   12  557 -5408.8494 -449.65594  91.7%  1857 1319s
  6687  2759 -3931.8279   17  557 -5408.8494 -449.65594  91.7%  1857 1345s
  6688  2760 -5097.0109   39  557 -5408.8494 -449.65594  91.7%  1856 1364s
  6689  2764 -449.65594   12  580 -5408.8494 -449.65594  91.7%  1884 1381s
  6691  2767 -449.65594   13  535 -5408.8494 -449.65594  91.7%  1885 1393s
  6695  2774 -449.65594   14  525 -5408.8494 -449.65594  91.7%  1887 1407s
  6703  2787 -449.65594   15  538 -5408.8494 -449.65594  91.7%  1894 1418s
  6719  2799 -2661.1254   16  193 -5408.8494 -449.65594  91.7%  1914 1441s
  6736  2825 -2644.5765   17  265 -5408.8494 -449.65594  91.7%  1929 1455s
  6768  2882 -3346.5868   18  232 -5408.8494 -449.65594  91.7%  1944 1472s
  6857  2868 -4912.7122   23  185 -5408.8494 -449.65594  91.7%  1948 1486s
  6963  2841 -4944.3016   24  184 -5408.8494 -449.65594  91.7%  1939 1502s
  7041  2831 -2992.4414   23  386 -5408.8494 -449.65594  91.7%  1937 1515s
  7104  2828 -3042.5460   24  379 -5408.8494 -449.65594  91.7%  1942 1527s
  7141  2841 -3334.1418   25  340 -5408.8494 -449.65594  91.7%  1948 1542s
  7187  2841     cutoff   26      -5408.8494 -449.65594  91.7%  1953 1557s
  7224  2848 -4311.7862   27  332 -5408.8494 -449.65594  91.7%  1958 1570s
  7280  2843 -4387.1994   28  387 -5408.8494 -449.65594  91.7%  1961 1583s
  7335  2849 -4394.0139   29  387 -5408.8494 -449.65594  91.7%  1963 1594s
  7370  2859 -4734.5090   31  332 -5408.8494 -449.65594  91.7%  1971 1606s
  7417  2850     cutoff   33      -5408.8494 -449.65594  91.7%  1975 1617s
  7474  2830 -2715.1526   20  394 -5408.8494 -449.65594  91.7%  1980 1630s
  7535  2832 -2804.6418   21  388 -5408.8494 -449.65594  91.7%  1987 1644s
  7577  2819 infeasible   23      -5408.8494 -449.65594  91.7%  1995 1657s
  7650  2797     cutoff   24      -5408.8494 -531.01678  90.2%  1996 1669s
  7710  2777 -4071.8416   23  341 -5408.8494 -531.01678  90.2%  2006 1683s
  7782  2760 -4618.4359   24  320 -5408.8494 -531.01678  90.2%  2012 1697s
  7839  2758     cutoff   25      -5408.8494 -531.01678  90.2%  2016 1710s
  7902  2741     cutoff   26      -5408.8494 -535.67199  90.1%  2025 1724s
  7981  2718     cutoff   24      -5408.8494 -1186.0351  78.1%  2029 1737s
  8067  2692 -2258.2186   19  390 -5408.8494 -1186.0351  78.1%  2035 1753s
  8139  2673 -2352.0514   20  396 -5408.8494 -1186.0351  78.1%  2036 1772s
  8189  2638 -2474.6292   21  377 -5408.8494 -1245.6167  77.0%  2040 1790s
  8275  2624 -4340.9491   22  390 -5408.8494 -1321.7108  75.6%  2047 1810s
  8334  2611     cutoff   23      -5408.8494 -1321.7108  75.6%  2054 1825s
  8413  2595 infeasible   22      -5408.8494 -1614.9870  70.1%  2078 1842s
  8508  2558     cutoff   21      -5408.8494 -1721.1232  68.2%  2089 1859s
  8610  2513 -4850.1297   22  318 -5408.8494 -2014.5102  62.8%  2096 1879s
  8745  2464 -3544.3482   22  243 -5408.8494 -2014.5102  62.8%  2098 1897s
  8886  2409     cutoff   24      -5408.8494 -2348.6774  56.6%  2102 1915s
  9029  2330 -4847.4792   22  355 -5408.8494 -2348.6774  56.6%  2107 1933s
  9175  2260     cutoff   24      -5408.8494 -2560.8832  52.7%  2115 1951s
  9303  2197 -5270.7313   25  348 -5408.8494 -2775.9990  48.7%  2117 1972s
  9472  2061 -4428.8339   22  294 -5408.8494 -2775.9990  48.7%  2118 1992s
  9646  1908     cutoff   19      -5408.8494 -3225.5423  40.4%  2121 2016s
  9851  1736 -3991.5923   22  304 -5408.8494 -3387.6650  37.4%  2120 2031s
 10045  1648     cutoff   23      -5408.8494 -3539.3767  34.6%  2101 2043s
 10113  1618 -5151.3661   25  164 -5408.8494 -4714.0025  12.8%  2095 2052s

Cutting planes:
  Gomory: 1
  MIR: 424
  Mixing: 1
  Flow cover: 1017
  Zero half: 1
  RLT: 5
  Relax-and-lift: 40

Explored 10129 nodes (21417202 simplex iterations) in 2052.53 seconds (3883.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5408.85 -5435.77 -5449.21 ... -5714.18
No other solutions better than -5408.85

Optimal solution found (tolerance 1.00e-06)
Best objective -5.408849389275e+03, best bound -5.408849389275e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2052.54s
  Master Objective (UB) = -5408.85, θ = 120506.62
  Upper Bound (UB) = -5408.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120506.62
  [DEBUG]   ✓ Scenario 0: θ = 120506.62 ≤ Q = 123260.06 (slack: 2753.44)
  [DEBUG]   ✓ Scenario 1: θ = 120506.62 ≤ Q = 120506.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120506.62 ≤ Q = 120506.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120506.62 ≤ Q = 120506.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120506.62 ≤ Q = 120506.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120506.62 ≤ Q = 120506.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34d09fff
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34d09fff
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368031e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6433475.1424
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.438901e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143890.11    0  124 6433475.14 -143890.11   102%     -    0s
H    0     0                    -110179.6748 -143890.11  30.6%     -    0s
H    0     0                    -111165.4101 -143890.11  29.4%     -    0s
     0     0 -120280.58    0  127 -111165.41 -120280.58  8.20%     -    0s
H    0     0                    -114556.0426 -120129.48  4.87%     -    0s
     0     0 -119030.82    0   86 -114556.04 -119030.82  3.91%     -    0s
H    0     0                    -116462.3901 -118969.66  2.15%     -    0s
H    0     0                    -116726.5948 -118969.66  1.92%     -    0s
     0     0 -118944.61    0   85 -116726.59 -118944.61  1.90%     -    0s
H    0     0                    -116749.4244 -118944.61  1.88%     -    0s
     0     0 -118692.44    0   88 -116749.42 -118692.44  1.66%     -    0s
     0     0 -118643.46    0   88 -116749.42 -118643.46  1.62%     -    0s
     0     0 -118563.51    0   81 -116749.42 -118563.51  1.55%     -    0s
     0     0 -118536.32    0   81 -116749.42 -118536.32  1.53%     -    0s
     0     2 -118536.32    0   81 -116749.42 -118536.32  1.53%     -    0s
H   47    64                    -116931.4371 -118164.64  1.05%  17.4    0s
H   63    96                    -117511.6232 -118065.27  0.47%  17.0    0s
H   95    56                    -117557.7871 -118023.27  0.40%  13.3    0s
H  181    56                    -117561.0849 -118023.27  0.39%  10.3    0s
*  298    15              13    -117564.7614 -117784.99  0.19%   8.9    0s
*  349     2              14    -117567.1231 -117591.22  0.02%   8.2    0s

Cutting planes:
  Gomory: 72
  Implied bound: 2
  MIR: 227
  RLT: 7
  BQP: 1

Explored 379 nodes (3499 simplex iterations) in 0.27 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117567 -117565 -117561 ... -114556
No other solutions better than -117567

Optimal solution found (tolerance 1.00e-06)
Best objective -1.175671231279e+05, best bound -1.175671231279e+05, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 115595.13
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117567.12
  [DEBUG]   S×d_nominal = 233162.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233162.25 + -117567.12 = 115595.13
  [DEBUG]   Current θ from Master = 120506.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4911.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10320.34
  Lower Bound (LB) = -9326.54
  Gap (UB-LB) = 3917.6873, Absolute Gap = 3917.6873, Relative Gap = 0.724311
  Not converged yet (gap = 3917.69 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xbacaccea
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 1.74s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24913   -1.1757167e+05   0.000000e+00   5.097836e+08      5s
   37477   -1.9162572e+04   0.000000e+00   1.904946e+07     10s
   45772   -1.6750007e+03   0.000000e+00   1.459893e+06     15s
   52509    1.1872244e+03   0.000000e+00   8.455223e+08     20s
   58943    4.6945451e+03   0.000000e+00   1.853838e+07     25s
   64674    7.3392460e+03   0.000000e+00   7.537844e+06     30s
   69835    8.2358166e+03   0.000000e+00   6.983970e+05     35s
   74629    8.4901586e+03   0.000000e+00   2.147747e+08     40s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.348566e+04, 48996 iterations, 39.69 seconds (52.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13485.6595    0  251 -177247.82 13485.6595   108%     -   42s
H    0     0                    -171592.8935 13485.6595   108%     -   42s
H    0     0                    -100051.4993 13485.6595   113%     -   42s
H    0     0                    -100040.8612 13485.6595   113%     -   42s
H    0     0                    -78193.95659 13485.6595   117%     -   42s
H    0     0                    -40174.34699 13485.6595   134%     -   43s
H    0     0                    -40107.85266 13485.6595   134%     -   43s
H    0     0                    -22567.62220 13485.6595   160%     -   43s
H    0     0                    -14861.59235 13485.6595   191%     -   43s
H    0     0                    -14654.06816 13485.6595   192%     -   43s
H    0     0                    -14652.37066 13485.6595   192%     -   43s
H    0     0                    -14392.80819 13485.6595   194%     -   43s
H    0     0                    -14281.44400 13485.6595   194%     -   43s
H    0     0                    -14277.98740 13485.6595   194%     -   43s
H    0     0                    -14276.28991 13485.6595   194%     -   43s
H    0     0                    -14264.54308 13485.6595   195%     -   43s
H    0     0                    -13956.12432 9812.06427   170%     -   58s
H    0     0                    -13786.76156 9812.06427   171%     -   58s
H    0     0                    -13777.46432 9812.06427   171%     -   58s
H    0     0                    -13704.62129 9812.06427   172%     -   58s
H    0     0                    -13691.90368 9812.06427   172%     -   58s
H    0     0                    -13673.10270 9812.06427   172%     -   58s
     0     0 9471.79142    0  323 -13673.103 9471.79142   169%     -   58s
     0     0 9379.34249    0  316 -13673.103 9379.34249   169%     -   63s
     0     0 9209.00398    0  311 -13673.103 9209.00398   167%     -   65s
     0     0 9136.44245    0  315 -13673.103 9136.44245   167%     -   66s
     0     0 9136.44245    0  341 -13673.103 9136.44245   167%     -   70s
     0     0 9136.44245    0  342 -13673.103 9136.44245   167%     -   71s
     0     0 9136.44245    0  342 -13673.103 9136.44245   167%     -   71s
     0     0 9136.44245    0  342 -13673.103 9136.44245   167%     -   72s
     0     0 7895.06577    0  386 -13673.103 7895.06577   158%     -   83s
H    0     0                    -5954.307533 7895.06577   233%     -   83s
H    0     0                    -5850.901871 7895.06577   235%     -   83s
H    0     0                    -5840.343110 7895.06577   235%     -   83s
H    0     0                    -5822.961084 7895.06577   236%     -   83s
     0     0 7330.07299    0  380 -5822.9611 7330.07299   226%     -   92s
     0     0 7199.73528    0  389 -5822.9611 7199.73528   224%     -   96s
     0     0 6915.47009    0  391 -5822.9611 6915.47009   219%     -  101s
     0     0 6818.69618    0  395 -5822.9611 6818.69618   217%     -  106s
     0     0 6773.23247    0  383 -5822.9611 6773.23247   216%     -  108s
     0     0 6767.19782    0  399 -5822.9611 6767.19782   216%     -  109s
     0     0 6766.39373    0  402 -5822.9611 6766.39373   216%     -  109s
     0     0 6752.19813    0  397 -5822.9611 6752.19813   216%     -  110s
     0     0 6750.68936    0  392 -5822.9611 6750.68936   216%     -  110s
     0     0 6750.26640    0  393 -5822.9611 6750.26640   216%     -  111s
H    0     0                    -5808.959444 6750.26640   216%     -  119s
H    0     0                    -5782.485210 6750.26640   217%     -  119s
     0     0 5529.73821    0  426 -5782.4852 5529.73821   196%     -  130s
     0     0 5081.10591    0  428 -5782.4852 5081.10591   188%     -  140s
     0     0 4997.84069    0  425 -5782.4852 4997.84069   186%     -  144s
     0     0 4928.90651    0  420 -5782.4852 4928.90651   185%     -  147s
     0     0 4856.29665    0  422 -5782.4852 4856.29665   184%     -  151s
     0     0 4847.38519    0  426 -5782.4852 4847.38519   184%     -  152s
H    0     0                    -5557.228398 4808.65895   187%     -  153s
H    0     0                    -5546.590274 4808.65895   187%     -  153s
     0     0 4808.65895    0  428 -5546.5903 4808.65895   187%     -  153s
     0     0 4794.57602    0  424 -5546.5903 4794.57602   186%     -  155s
     0     0 4789.73111    0  423 -5546.5903 4789.73111   186%     -  155s
     0     0 4786.57750    0  426 -5546.5903 4786.57750   186%     -  156s
     0     0 4780.08377    0  425 -5546.5903 4780.08377   186%     -  157s
     0     0 4779.95916    0  427 -5546.5903 4779.95916   186%     -  158s
H    0     0                    -5513.943647 4079.22394   174%     -  174s
     0     0 4079.22394    0  458 -5513.9436 4079.22394   174%     -  174s
     0     0 3936.56137    0  465 -5513.9436 3936.56137   171%     -  180s
H    0     0                    -5496.152121 3845.37611   170%     -  188s
H    0     0                    -5485.513997 3845.37611   170%     -  188s
H    0     0                    -5482.707804 3845.37611   170%     -  188s
H    0     0                    -5440.227318 3845.37611   171%     -  188s
     0     0 3845.37611    0  461 -5440.2273 3845.37611   171%     -  188s
     0     0 3831.85230    0  465 -5440.2273 3831.85230   170%     -  190s
     0     0 3807.22512    0  465 -5440.2273 3807.22512   170%     -  193s
     0     0 3771.64391    0  460 -5440.2273 3771.64391   169%     -  198s
     0     0 3747.45861    0  466 -5440.2273 3747.45861   169%     -  199s
     0     0 3734.63243    0  467 -5440.2273 3734.63243   169%     -  201s
     0     0 3733.14821    0  468 -5440.2273 3733.14821   169%     -  202s
     0     0 3732.93224    0  467 -5440.2273 3732.93224   169%     -  202s
     0     0 3547.34614    0  468 -5440.2273 3547.34614   165%     -  209s
     0     0 3518.87420    0  467 -5440.2273 3518.87420   165%     -  212s
     0     0 3509.54209    0  476 -5440.2273 3509.54209   165%     -  214s
     0     0 3501.64679    0  473 -5440.2273 3501.64679   164%     -  215s
     0     0 3493.90341    0  475 -5440.2273 3493.90341   164%     -  216s
     0     0 3491.95327    0  478 -5440.2273 3491.95327   164%     -  216s
     0     0 3489.75918    0  484 -5440.2273 3489.75918   164%     -  217s
     0     0 3482.44718    0  488 -5440.2273 3482.44718   164%     -  218s
     0     0 3480.87397    0  492 -5440.2273 3480.87397   164%     -  218s
     0     0 3480.15416    0  494 -5440.2273 3480.15416   164%     -  219s
     0     0 3421.89239    0  515 -5440.2273 3421.89239   163%     -  225s
     0     0 3405.52492    0  532 -5440.2273 3405.52492   163%     -  229s
     0     0 3396.47211    0  541 -5440.2273 3396.47211   162%     -  232s
H    0     0                    -5437.627276 3393.43075   162%     -  235s
     0     0 3393.43075    0  539 -5437.6273 3393.43075   162%     -  235s
     0     0 3389.83173    0  544 -5437.6273 3389.83173   162%     -  236s
     0     0 3389.05276    0  539 -5437.6273 3389.05276   162%     -  236s
     0     0 3345.85209    0  494 -5437.6273 3345.85209   162%     -  242s
     0     0 3340.89068    0  501 -5437.6273 3340.89068   161%     -  244s
     0     0 3339.71183    0  498 -5437.6273 3339.71183   161%     -  244s
     0     0 3324.47218    0  506 -5437.6273 3324.47218   161%     -  247s
     0     0 3318.97106    0  501 -5437.6273 3318.97106   161%     -  249s
     0     0 3318.12627    0  502 -5437.6273 3318.12627   161%     -  250s
     0     0 3304.20029    0  503 -5437.6273 3304.20029   161%     -  254s
     0     0 3291.74815    0  505 -5437.6273 3291.74815   161%     -  256s
     0     0 3291.08658    0  509 -5437.6273 3291.08658   161%     -  257s
     0     0 3261.85390    0  502 -5437.6273 3261.85390   160%     -  261s
     0     0 3251.58366    0  506 -5437.6273 3251.58366   160%     -  263s
     0     0 3249.90830    0  503 -5437.6273 3249.90830   160%     -  264s
     0     0 3249.59105    0  504 -5437.6273 3249.59105   160%     -  264s
     0     0 3229.92310    0  518 -5437.6273 3229.92310   159%     -  268s
     0     0 3184.42948    0  530 -5437.6273 3184.42948   159%     -  274s
     0     0 3173.28765    0  544 -5437.6273 3173.28765   158%     -  277s
     0     0 3171.73819    0  498 -5437.6273 3171.73819   158%     -  278s
     0     0 3171.03785    0  499 -5437.6273 3171.03785   158%     -  279s
     0     0 3155.81633    0  494 -5437.6273 3155.81633   158%     -  283s
     0     0 3148.43829    0  493 -5437.6273 3148.43829   158%     -  286s
     0     0 3147.87414    0  499 -5437.6273 3147.87414   158%     -  287s
     0     0 3141.95065    0  506 -5437.6273 3141.95065   158%     -  289s
     0     0 3140.64267    0  504 -5437.6273 3140.64267   158%     -  290s
     0     0 3136.85066    0  504 -5437.6273 3136.85066   158%     -  293s
     0     0 3135.85671    0  511 -5437.6273 3135.85671   158%     -  294s
     0     0 3131.27710    0  508 -5437.6273 3131.27710   158%     -  297s
     0     0 3130.67950    0  508 -5437.6273 3130.67950   158%     -  297s
     0     0 3126.89521    0  512 -5437.6273 3126.89521   158%     -  299s
     0     0 3125.38054    0  512 -5437.6273 3125.38054   157%     -  302s
H    0     0                    -5435.765029 3125.22344   157%     -  340s
     0     2 3125.22344    0  512 -5435.7650 3125.22344   157%     -  353s
     1     4 3094.54063    1  498 -5435.7650 3125.22344   157%  1629  361s
     3     8 3027.41553    2  488 -5435.7650 3094.50110   157%  4398  366s
     7    16 2921.72187    3  491 -5435.7650 3067.45804   156%  3597  377s
    15    32 2755.71067    4  489 -5435.7650 2920.80467   154%  5115  397s
    31    47 -1101.7978    5  299 -5435.7650 2787.65892   151%  9072  470s
    48    79  358.32225    6  369 -5435.7650 2787.65892   151%  8526  500s
    80   217  306.19954    7  365 -5435.7650 2787.65892   151%  7223  522s
   222   249  212.12633    9  269 -5435.7650 2787.65892   151%  3954  529s
   254   277   53.45543   10  350 -5435.7650 2787.65892   151%  3680  540s
   293   310  135.90875    9  318 -5435.7650 2787.65892   151%  3451  551s
   347   341  -62.71457   10  340 -5435.7650 2787.65892   151%  3239  563s
   406   379 -1367.2859   10  201 -5435.7650 2787.65892   151%  3076  575s
   463   431   69.84673   10  324 -5435.7650 2787.65892   151%  2944  587s
   547   453 -123.99293   11  402 -5435.7650 2787.65892   151%  2731  600s
   585   496 -537.32332   11  329 -5435.7650 2787.65892   151%  2695  607s
   632   546 -319.61013   11  240 -5435.7650 2787.65892   151%  2648  615s
   692   591 -541.73914   12  225 -5435.7650 2787.65892   151%  2522  624s
   747   647 -722.13455   13  225 -5435.7650 2787.65892   151%  2462  635s
   819   710 -1060.2611   13  223 -5435.7650 2787.65892   151%  2341  644s
   910   720 -778.10326   14  220 -5435.7650 2787.65892   151%  2190  654s
  1008   726 -1279.6106   14  217 -5435.7650 2787.65892   151%  2073  664s
  1075   745 -3021.4392   14  152 -5435.7650 2787.65892   151%  2062  677s
  1133   767 -2885.1571   14  355 -5435.7650 2787.65892   151%  2094  690s
  1193   797 -2427.7343   15  254 -5435.7650 2787.65892   151%  2099  702s
  1258   818 -1413.1695   15  287 -5435.7650 2787.65892   151%  2116  715s
  1311   855 -1198.1516   15  240 -5435.7650 2753.91859   151%  2129  727s
  1382   900 -3150.4263   16  268 -5435.7650 2753.91859   151%  2132  740s
  1469   943 -2512.2212   16  185 -5435.7650 2753.91859   151%  2107  754s
  1573   985 -2804.4374   17  190 -5435.7650 2753.91859   151%  2070  770s
  1666  1019 -2826.7152   18  182 -5435.7650 2753.91859   151%  2056  785s
  1777  1058 -3264.6687   18  259 -5435.7650 2707.30542   150%  2043  799s
  1884  1090 -4889.5251   20   98 -5435.7650 2707.30542   150%  2036  817s
  1994  1159 -3489.0488   19  353 -5435.7650 2588.25378   148%  2027  834s
  2121  1200 -3815.7797   22  345 -5435.7650 2588.25378   148%  2016  852s
  2239  1275 -4433.8013   25  317 -5435.7650 2588.25378   148%  2011  870s
  2356  1341 -4437.5548   26  374 -5435.7650 2588.25378   148%  2041  887s
  2492  1399 -4684.5266   29  349 -5435.7650 2588.25378   148%  2042  906s
  2630  1433 -2006.5536   13  313 -5435.7650 1990.91822   137%  2055  924s
  2720  1471 -1674.4778   13  248 -5435.7650 1990.91822   137%  2047  944s
  2808  1527 -3435.7111   14  166 -5435.7650 1990.91822   137%  2060  964s
  2906  1589 -2568.5288   15  226 -5435.7650 1990.91822   137%  2089  985s
  3050  1639 -5102.1965   17  118 -5435.7650 1990.91822   137%  2090 1007s
  3200  1694 -3899.0628   16  292 -5435.7650 1990.91822   137%  2108 1031s
  3359  1730 -5105.6806   18  356 -5435.7650 1140.78341   121%  2117 1055s
  3485  1780 -1087.5694   12  230 -5435.7650 1071.62976   120%  2151 1078s
  3631  1849 -4991.9229   15  247 -5435.7650 1071.62976   120%  2179 1101s
  3803  1912     cutoff   17      -5435.7650  939.62606   117%  2184 1126s
  4051  1981 -3315.3141   14  226 -5435.7650  836.51217   115%  2161 1156s
  4244  2015 -3955.0796   15  362 -5435.7650  836.51217   115%  2170 1181s
  4398  2097 -2695.4322   16  391 -5435.7650  836.51217   115%  2173 1211s
  4606  2179 -3698.4189   20  388 -5435.7650  290.08687   105%  2183 1242s
  4860  2227 -4487.1735   26  398 -5435.7650  282.60746   105%  2184 1270s
  5108  2308     cutoff   12      -5435.7650  224.66003   104%  2191 1302s
  5365  2381 -4254.7767   18  345 -5435.7650  149.13518   103%  2199 1335s
  5633  2469     cutoff   24      -5435.7650  109.68208   102%  2210 1366s
  5927  2540 -1931.6595    9  319 -5435.7650   16.74278   100%  2204 1400s
  6274  2549 -3035.3032   14  329 -5435.7650   16.74278   100%  2194 1427s
  6328  2565 -3581.4074   15  391 -5435.7650  -65.94182  98.8%  2198 1452s
  6376  2570 -3760.0711   16  263 -5435.7650  -73.51565  98.6%  2204 1482s
  6435  2604 -3996.4574   17  252 -5435.7650 -164.80989  97.0%  2213 1511s
  6512  2605 -2171.0702   22  512 -5435.7650 -164.80989  97.0%  2217 1584s
  6514  2606 -2386.2071   20  251 -5435.7650 -164.80989  97.0%  2217 1630s
  6515  2607 -3344.9103   16  405 -5435.7650 -164.80989  97.0%  2216 1655s
  6516  2608 -164.80989   19  460 -5435.7650 -164.80989  97.0%  2216 1670s
  6517  2608 -2845.2742   23  457 -5435.7650 -164.80989  97.0%  2215 1689s
  6518  2609 -1374.1302   15  478 -5435.7650 -164.80989  97.0%  2215 1701s
  6519  2610 -3664.2813   21  534 -5435.7650 -164.80989  97.0%  2215 1710s
  6520  2610 -1067.7309   12  485 -5435.7650 -164.80989  97.0%  2214 1719s
  6521  2611 -4172.8729   19  492 -5435.7650 -164.80989  97.0%  2214 1723s
  6522  2612 -3790.3374   13  531 -5435.7650 -164.80989  97.0%  2214 1727s
  6523  2612 -2364.6317   12  489 -5435.7650 -164.80989  97.0%  2213 1731s
  6525  2614 -4431.7062   23  484 -5435.7650 -164.80989  97.0%  2213 1735s
  6526  2614 -3038.4930   13  536 -5435.7650 -164.80989  97.0%  2212 1749s
  6527  2615 -2115.7559   17  545 -5435.7650 -164.80989  97.0%  2212 1752s
  6528  2616 -3392.3151   18  548 -5435.7650 -164.80989  97.0%  2212 1756s
  6529  2616 -4635.9856   25  500 -5435.7650 -164.80989  97.0%  2211 1766s
  6531  2618 -3102.2424   21  480 -5435.7650 -164.80989  97.0%  2211 1771s
  6533  2619 -4624.3794   31  478 -5435.7650 -164.80989  97.0%  2210 1777s
  6534  2620 -3346.8894   20  478 -5435.7650 -164.80989  97.0%  2210 1783s
  6535  2620 -3575.6406   17  545 -5435.7650 -164.80989  97.0%  2209 1787s
  6536  2621 -4314.8228   16  485 -5435.7650 -164.80989  97.0%  2209 1796s
  6538  2622 -5091.5297   37  560 -5435.7650 -164.80989  97.0%  2208 1809s
  6539  2623 -5299.6658   25  563 -5435.7650 -164.80989  97.0%  2208 1812s
  6540  2624 -2312.7536   14  558 -5435.7650 -164.80989  97.0%  2208 1816s
  6541  2624 -5105.9798   17  509 -5435.7650 -164.80989  97.0%  2207 1823s
  6542  2625 -4569.9729   21  550 -5435.7650 -164.80989  97.0%  2207 1825s
  6544  2626 -1272.1778   11  492 -5435.7650 -164.80989  97.0%  2206 1833s
  6545  2627 -1889.7139   17  492 -5435.7650 -164.80989  97.0%  2206 1877s
  6546  2628 -2094.2377   12  492 -5435.7650 -164.80989  97.0%  2206 1904s
  6547  2631 -164.80989   14  531 -5435.7650 -164.80989  97.0%  2237 1916s
  6549  2635 -164.80989   15  538 -5435.7650 -164.80989  97.0%  2238 1936s
  6553  2641 -164.80989   16  536 -5435.7650 -164.80989  97.0%  2241 1951s
  6561  2655 -164.80989   17  537 -5435.7650 -164.80989  97.0%  2246 1978s
  6577  2663 -164.80989   18  477 -5435.7650 -164.80989  97.0%  2257 2010s
  6593  2688 -2341.3507   19  514 -5435.7650 -164.80989  97.0%  2282 2039s
  6624  2754 -2523.1657   20  513 -5435.7650 -164.80989  97.0%  2290 2067s
  6723  2758 -3553.7175   21  487 -5435.7650 -164.80989  97.0%  2308 2091s
  6819  2743 -3325.9702   21  501 -5435.7650 -164.80989  97.0%  2313 2119s
  6898  2738 -4050.3175   22  497 -5435.7650 -164.80989  97.0%  2322 2135s
  6966  2724     cutoff   22      -5435.7650 -164.80989  97.0%  2336 2154s
  7032  2704 -3694.9460   22  498 -5435.7650 -164.80989  97.0%  2342 2166s
  7082  2704     cutoff   22      -5435.7650 -164.80989  97.0%  2358 2183s
  7137  2690 -4806.9223   23  389 -5435.7650 -164.80989  97.0%  2374 2202s
  7185  2688     cutoff   24      -5435.7650 -164.80989  97.0%  2380 2219s
  7243  2671     cutoff   24      -5435.7650 -164.80989  97.0%  2409 2233s
  7312  2660     cutoff   24      -5435.7650 -164.80989  97.0%  2413 2248s
  7367  2660 -909.89977   19  430 -5435.7650 -164.80989  97.0%  2422 2264s
  7426  2661 -1186.9031   20  451 -5435.7650 -164.80989  97.0%  2429 2278s
  7486  2668 -2073.2683   21  434 -5435.7650 -164.80989  97.0%  2439 2292s
  7562  2657 -3004.1750   22  452 -5435.7650 -164.80989  97.0%  2451 2308s
  7629  2626 -3146.2698   23  448 -5435.7650 -164.80989  97.0%  2462 2325s
  7709  2610 -3215.3940   24  405 -5435.7650 -164.80989  97.0%  2480 2343s
  7778  2599 -3915.2716   25  460 -5435.7650 -164.80989  97.0%  2499 2360s
  7854  2582     cutoff   26      -5435.7650 -164.80989  97.0%  2513 2378s
  7933  2564 -2613.6295   22  355 -5435.7650 -164.80989  97.0%  2532 2396s
  8011  2557 -3966.3883   23  384 -5435.7650 -164.80989  97.0%  2558 2416s
  8088  2540     cutoff   24      -5435.7650 -164.80989  97.0%  2573 2433s
  8132  2549 -4616.1134   25  261 -5435.7650 -164.80989  97.0%  2586 2453s
  8183  2537 -5257.8342   26  237 -5435.7650 -164.80989  97.0%  2603 2471s
  8265  2510 -5260.1711   27  236 -5435.7650 -164.80989  97.0%  2615 2491s
  8351  2506 -5284.1542   28  239 -5435.7650 -939.58741  82.7%  2637 2510s
  8451  2490 -3245.4739   22  275 -5435.7650 -1112.5849  79.5%  2661 2532s
  8581  2425 -4246.0864   26  238 -5435.7650 -1112.5849  79.5%  2680 2555s
  8747  2345     cutoff   29      -5435.7650 -1112.5849  79.5%  2699 2579s
  8906  2296     cutoff   22      -5435.7650 -1705.5314  68.6%  2724 2603s
  9049  2257     cutoff   27      -5435.7650 -1728.9086  68.2%  2752 2632s
  9233  2181 -3755.4490   22  223 -5435.7650 -2345.0438  56.9%  2782 2656s
  9431  2083 -5166.4089   23  327 -5435.7650 -2345.0438  56.9%  2804 2682s
  9627  1976 -5226.7273   26  289 -5435.7650 -2366.0231  56.5%  2834 2708s
  9851  1866     cutoff   27      -5435.7650 -2366.0231  56.5%  2853 2735s
 10059  1768 -5317.7473   26  318 -5435.7650 -3081.4540  43.3%  2882 2763s
 10322  1549     cutoff   24      -5435.7650 -3408.9143  37.3%  2893 2788s
 10658  1301 -4664.3022   29  368 -5435.7650 -3820.4175  29.7%  2877 2820s
 10936  1167 infeasible   26      -5435.7650 -4221.7713  22.3%  2851 2833s

Cutting planes:
  Gomory: 2
  MIR: 480
  Mixing: 1
  Flow cover: 1072
  RLT: 6
  Relax-and-lift: 55

Explored 11028 nodes (31549433 simplex iterations) in 2833.53 seconds (5098.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5435.77 -5437.63 -5440.23 ... -5782.49
No other solutions better than -5435.77

Optimal solution found (tolerance 1.00e-06)
Best objective -5.435765028743e+03, best bound -5.435765028743e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2833.59s
  Master Objective (UB) = -5435.77, θ = 120490.16
  Upper Bound (UB) = -5435.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120490.16
  [DEBUG]   ✓ Scenario 0: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120490.16 ≤ Q = 120490.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4d6cfd5b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb29302a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6443486.6110
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.445430e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144542.98    0  124 6443486.61 -144542.98   102%     -    0s
H    0     0                    -110762.3967 -144542.98  30.5%     -    0s
H    0     0                    -111879.5919 -144542.98  29.2%     -    0s
     0     0 -121133.39    0  128 -111879.59 -121133.39  8.27%     -    0s
H    0     0                    -115499.9308 -121129.70  4.87%     -    0s
     0     0 -120109.97    0  131 -115499.93 -120109.97  3.99%     -    0s
H    0     0                    -115953.4672 -120020.18  3.51%     -    0s
     0     0 -120020.18    0  131 -115953.47 -120020.18  3.51%     -    0s
     0     0 -119467.06    0   91 -115953.47 -119467.06  3.03%     -    0s
     0     0 -119289.99    0  137 -115953.47 -119289.99  2.88%     -    0s
     0     0 -118864.91    0   86 -115953.47 -118864.91  2.51%     -    0s
H    0     0                    -116112.4397 -118830.65  2.34%     -    0s
     0     0 -118753.70    0  130 -116112.44 -118753.70  2.27%     -    0s
     0     0 -118753.65    0  130 -116112.44 -118753.65  2.27%     -    0s
     0     0 -118320.53    0  131 -116112.44 -118320.53  1.90%     -    0s
     0     0 -118303.38    0  130 -116112.44 -118303.38  1.89%     -    0s
     0     0 -118013.15    0   82 -116112.44 -118013.15  1.64%     -    0s
H    0     0                    -116185.6888 -117975.07  1.54%     -    0s
H    0     0                    -116449.8936 -117975.07  1.31%     -    0s
     0     0 -117975.07    0   81 -116449.89 -117975.07  1.31%     -    0s
     0     0 -117856.19    0   82 -116449.89 -117856.19  1.21%     -    0s
     0     0 -117839.91    0   82 -116449.89 -117839.91  1.19%     -    0s
     0     2 -117839.91    0   82 -116449.89 -117839.91  1.19%     -    0s
H   28    46                    -116612.5246 -117681.59  0.92%  14.4    0s
H   29    46                    -116685.5886 -117681.59  0.85%  14.4    0s
H   31    46                    -116757.0769 -117681.59  0.79%  14.4    0s
H   38    46                    -116775.9075 -117681.59  0.78%  15.4    0s
H 1112   728                    -116817.6700 -117379.03  0.48%   5.5    0s
* 1624   969              26    -116873.6703 -117347.48  0.41%   5.5    0s
H 2338  1204                    -116893.3266 -117310.31  0.36%   5.5    0s
H 2820  1353                    -116915.2182 -117291.99  0.32%   5.8    0s

Cutting planes:
  Gomory: 45
  Implied bound: 2
  MIR: 251
  RLT: 8

Explored 18887 nodes (106902 simplex iterations) in 0.92 seconds (0.58 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -116915 -116893 -116874 ... -116186
No other solutions better than -116915

Optimal solution found (tolerance 1.00e-06)
Best objective -1.169152182401e+05, best bound -1.169152182401e+05, gap 0.0000%
  Subproblem solved in 0.95s
  Worst-case operational profit (Z_SP) = 116812.43
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116915.22
  [DEBUG]   S×d_nominal = 233727.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233727.65 + -116915.22 = 116812.43
  [DEBUG]   Current θ from Master = 120490.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3677.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9113.49
  Lower Bound (LB) = -9113.49
  Gap (UB-LB) = 3677.7299, Absolute Gap = 3677.7299, Relative Gap = 0.676580
  Not converged yet (gap = 3677.73 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x2624b267
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 2.51s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25279   -1.8803916e+05   0.000000e+00   1.914510e+07      5s
   39525   -4.8884348e+04   0.000000e+00   3.959691e+06     10s
   48450   -3.3016376e+04   0.000000e+00   2.874948e+08     15s
   55987   -1.7602178e+04   0.000000e+00   6.252077e+06     20s
   61963   -1.5508055e+04   0.000000e+00   4.471958e+06     25s
   66622   -1.3848117e+04   0.000000e+00   3.393821e+06     30s
   71107   -1.2531619e+04   0.000000e+00   1.649741e+07     35s
Concurrent spin time: 1.22s

Solved with dual simplex

Root relaxation: objective 1.347390e+04, 43609 iterations, 35.00 seconds (46.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13473.8962    0  252 -177247.82 13473.8962   108%     -   38s
H    0     0                    -171592.8935 13473.8962   108%     -   38s
H    0     0                    -107021.4247 13473.8962   113%     -   38s
H    0     0                    -104968.4462 13473.8962   113%     -   39s
H    0     0                    -78182.87640 13473.8962   117%     -   39s
H    0     0                    -21939.32787 13473.8962   161%     -   39s
H    0     0                    -17262.42455 13473.8962   178%     -   39s
H    0     0                    -16183.47162 13473.8962   183%     -   39s
H    0     0                    -15101.69463 13473.8962   189%     -   39s
H    0     0                    -14700.32189 13473.8962   192%     -   39s
H    0     0                    -14517.03949 13473.8962   193%     -   39s
H    0     0                    -14355.63173 13473.8962   194%     -   39s
H    0     0                    -14349.49886 13473.8962   194%     -   39s
H    0     0                    -14343.88490 13473.8962   194%     -   39s
H    0     0                    -13855.49619 9291.83185   167%     -   59s
H    0     0                    -13838.76531 9291.83185   167%     -   59s
H    0     0                    -13766.89354 9291.83185   167%     -   59s
     0     0 9078.35706    0  305 -13766.894 9078.35706   166%     -   59s
     0     0 8883.48194    0  214 -13766.894 8883.48194   165%     -   62s
     0     0 8798.02510    0  296 -13766.894 8798.02510   164%     -   65s
     0     0 8798.02510    0  296 -13766.894 8798.02510   164%     -   66s
     0     0 8798.02510    0  306 -13766.894 8798.02510   164%     -   66s
     0     0 8798.02510    0  318 -13766.894 8798.02510   164%     -   70s
     0     0 8798.02510    0  332 -13766.894 8798.02510   164%     -   72s
     0     0 8796.74647    0  322 -13766.894 8796.74647   164%     -   72s
     0     0 7752.77265    0  258 -13766.894 7752.77265   156%     -   73s
     0     0 7752.77265    0  258 -13766.894 7752.77265   156%     -   73s
     0     0 7736.70850    0  357 -13766.894 7736.70850   156%     -   84s
H    0     0                    -5905.065057 7735.42859   231%     -   84s
H    0     0                    -5848.274534 7735.42859   232%     -   85s
H    0     0                    -5828.682755 7735.42859   233%     -   85s
H    0     0                    -5816.180523 7735.42859   233%     -   85s
H    0     0                    -5809.142351 7735.42859   233%     -   85s
     0     0 7456.60888    0  377 -5809.1424 7456.60888   228%     -   91s
     0     0 7207.92679    0  369 -5809.1424 7207.92679   224%     -   98s
     0     0 7185.95595    0  373 -5809.1424 7185.95595   224%     -   99s
     0     0 7051.12203    0  377 -5809.1424 7051.12203   221%     -  103s
     0     0 7043.83261    0  390 -5809.1424 7043.83261   221%     -  104s
     0     0 7043.64364    0  383 -5809.1424 7043.64364   221%     -  104s
     0     0 5681.93506    0  411 -5809.1424 5681.93506   198%     -  126s
H    0     0                    -5794.905844 5412.76652   193%     -  135s
H    0     0                    -5792.303021 5412.76652   193%     -  135s
H    0     0                    -5781.664898 5412.76652   194%     -  135s
     0     0 5412.76652    0  429 -5781.6649 5412.76652   194%     -  135s
     0     0 5281.04490    0  426 -5781.6649 5281.04490   191%     -  144s
     0     0 5218.76329    0  445 -5781.6649 5218.76329   190%     -  152s
     0     0 5203.11602    0  440 -5781.6649 5203.11602   190%     -  154s
     0     0 5170.60653    0  441 -5781.6649 5170.60653   189%     -  157s
     0     0 5160.09156    0  463 -5781.6649 5160.09156   189%     -  158s
     0     0 5141.22511    0  441 -5781.6649 5141.22511   189%     -  159s
     0     0 5138.77389    0  451 -5781.6649 5138.77389   189%     -  160s
     0     0 5131.32000    0  443 -5781.6649 5131.32000   189%     -  162s
     0     0 5116.87240    0  446 -5781.6649 5116.87240   189%     -  164s
     0     0 5063.85372    0  439 -5781.6649 5063.85372   188%     -  168s
     0     0 5057.78867    0  438 -5781.6649 5057.78867   187%     -  169s
     0     0 5056.55893    0  440 -5781.6649 5056.55893   187%     -  170s
     0     0 5056.43020    0  438 -5781.6649 5056.43020   187%     -  170s
     0     0 4468.94193    0  465 -5781.6649 4468.94193   177%     -  189s
     0     0 4162.63147    0  460 -5781.6649 4162.63147   172%     -  199s
     0     0 4015.64879    0  453 -5781.6649 4015.64879   169%     -  206s
     0     0 3950.87371    0  456 -5781.6649 3950.87371   168%     -  211s
     0     0 3890.98359    0  465 -5781.6649 3890.98359   167%     -  215s
     0     0 3852.06166    0  459 -5781.6649 3852.06166   167%     -  219s
     0     0 3801.48845    0  464 -5781.6649 3801.48845   166%     -  222s
     0     0 3784.01313    0  465 -5781.6649 3784.01313   165%     -  225s
     0     0 3782.12630    0  466 -5781.6649 3782.12630   165%     -  225s
     0     0 3779.88773    0  462 -5781.6649 3779.88773   165%     -  226s
     0     0 3777.64797    0  470 -5781.6649 3777.64797   165%     -  227s
     0     0 3775.49145    0  470 -5781.6649 3775.49145   165%     -  228s
     0     0 3774.26732    0  473 -5781.6649 3774.26732   165%     -  228s
     0     0 3773.91519    0  471 -5781.6649 3773.91519   165%     -  229s
H    0     0                    -5538.329563 3594.57254   165%     -  236s
H    0     0                    -5512.205721 3594.57254   165%     -  236s
H    0     0                    -5510.742308 3594.57254   165%     -  236s
H    0     0                    -5507.936116 3594.57254   165%     -  236s
     0     0 3594.57254    0  463 -5507.9361 3594.57254   165%     -  237s
     0     0 3528.62377    0  478 -5507.9361 3528.62377   164%     -  243s
     0     0 3519.74439    0  480 -5507.9361 3519.74439   164%     -  245s
     0     0 3512.82249    0  480 -5507.9361 3512.82249   164%     -  246s
     0     0 3503.56111    0  487 -5507.9361 3503.56111   164%     -  248s
     0     0 3497.90262    0  479 -5507.9361 3497.90262   164%     -  248s
     0     0 3495.04490    0  483 -5507.9361 3495.04490   163%     -  249s
     0     0 3492.53706    0  485 -5507.9361 3492.53706   163%     -  250s
     0     0 3490.73794    0  484 -5507.9361 3490.73794   163%     -  251s
     0     0 3480.42799    0  479 -5507.9361 3480.42799   163%     -  252s
     0     0 3479.88644    0  490 -5507.9361 3479.88644   163%     -  252s
     0     0 3408.91960    0  487 -5507.9361 3408.91960   162%     -  259s
H    0     0                    -5503.982484 3408.87688   162%     -  261s
     0     0 3382.19375    0  485 -5503.9825 3382.19375   161%     -  264s
     0     0 3377.03740    0  485 -5503.9825 3377.03740   161%     -  265s
     0     0 3372.79038    0  485 -5503.9825 3372.79038   161%     -  267s
     0     0 3370.92392    0  479 -5503.9825 3370.92392   161%     -  268s
     0     0 3368.34621    0  475 -5503.9825 3368.34621   161%     -  269s
     0     0 3367.75541    0  480 -5503.9825 3367.75541   161%     -  270s
     0     0 3321.62366    0  473 -5503.9825 3321.62366   160%     -  275s
     0     0 3314.59127    0  479 -5503.9825 3314.59127   160%     -  277s
     0     0 3311.82825    0  474 -5503.9825 3311.82825   160%     -  278s
     0     0 3310.13511    0  476 -5503.9825 3310.13511   160%     -  279s
     0     0 3308.36541    0  472 -5503.9825 3308.36541   160%     -  279s
     0     0 3305.38558    0  474 -5503.9825 3305.38558   160%     -  280s
     0     0 3302.50644    0  473 -5503.9825 3302.50644   160%     -  282s
     0     0 3294.75965    0  473 -5503.9825 3294.75965   160%     -  283s
     0     0 3293.31551    0  476 -5503.9825 3293.31551   160%     -  284s
     0     0 3291.45404    0  482 -5503.9825 3291.45404   160%     -  285s
     0     0 3290.94832    0  483 -5503.9825 3290.94832   160%     -  286s
     0     0 3261.28154    0  468 -5503.9825 3261.28154   159%     -  291s
H    0     0                    -5493.344360 3260.40382   159%     -  292s
     0     0 3252.19984    0  468 -5493.3444 3252.19984   159%     -  294s
     0     0 3244.30700    0  474 -5493.3444 3244.30700   159%     -  295s
     0     0 3218.79059    0  473 -5493.3444 3218.79059   159%     -  298s
     0     0 3215.68773    0  485 -5493.3444 3215.68773   159%     -  299s
     0     0 3214.85932    0  486 -5493.3444 3214.85932   159%     -  300s
     0     0 3194.00649    0  484 -5493.3444 3194.00649   158%     -  303s
     0     0 3186.16834    0  486 -5493.3444 3186.16834   158%     -  305s
     0     0 3182.58632    0  478 -5493.3444 3182.58632   158%     -  306s
     0     0 3181.92519    0  482 -5493.3444 3181.92519   158%     -  308s
     0     0 3127.51530    0  481 -5493.3444 3127.51530   157%     -  314s
     0     0 3111.30604    0  494 -5493.3444 3111.30604   157%     -  321s
     0     0 3105.96859    0  478 -5493.3444 3105.96859   157%     -  323s
     0     0 3103.54246    0  488 -5493.3444 3103.54246   156%     -  324s
     0     0 3103.23443    0  489 -5493.3444 3103.23443   156%     -  325s
     0     0 3054.80402    0  486 -5493.3444 3054.80402   156%     -  333s
     0     0 3048.00397    0  490 -5493.3444 3048.00397   155%     -  335s
     0     0 3045.17289    0  492 -5493.3444 3045.17289   155%     -  336s
     0     0 3044.74773    0  492 -5493.3444 3044.74773   155%     -  337s
     0     0 3034.28116    0  497 -5493.3444 3034.28116   155%     -  340s
     0     0 3024.08514    0  492 -5493.3444 3024.08514   155%     -  344s
     0     0 3015.95610    0  493 -5493.3444 3015.95610   155%     -  345s
     0     0 3013.73691    0  491 -5493.3444 3013.73691   155%     -  347s
     0     0 3012.26248    0  500 -5493.3444 3012.26248   155%     -  347s
     0     0 3011.96156    0  501 -5493.3444 3011.96156   155%     -  348s
     0     0 2994.78529    0  500 -5493.3444 2994.78529   155%     -  352s
     0     0 2992.51770    0  505 -5493.3444 2992.51770   154%     -  353s
     0     0 2990.86888    0  504 -5493.3444 2990.86888   154%     -  354s
     0     0 2990.46449    0  509 -5493.3444 2990.46449   154%     -  354s
     0     0 2978.32392    0  495 -5493.3444 2978.32392   154%     -  358s
     0     0 2976.53421    0  498 -5493.3444 2976.53421   154%     -  360s
     0     0 2975.18115    0  486 -5493.3444 2975.18115   154%     -  362s
     0     0 2974.10966    0  484 -5493.3444 2974.10966   154%     -  363s
     0     0 2961.12367    0  498 -5493.3444 2961.12367   154%     -  365s
     0     0 2959.72664    0  508 -5493.3444 2959.72664   154%     -  367s
     0     0 2959.30837    0  505 -5493.3444 2959.30837   154%     -  368s
     0     0 2956.51826    0  480 -5493.3444 2956.51826   154%     -  370s
     0     0 2954.49891    0  487 -5493.3444 2954.49891   154%     -  381s
     0     0 2954.27465    0  489 -5493.3444 2954.27465   154%     -  382s
     0     0 2952.97920    0  493 -5493.3444 2952.97920   154%     -  384s
     0     0 2952.18891    0  502 -5493.3444 2952.18891   154%     -  385s
     0     0 2950.36649    0  492 -5493.3444 2950.36649   154%     -  388s
     0     0 2949.92903    0  492 -5493.3444 2949.92903   154%     -  391s
     0     2 2949.86645    0  492 -5493.3444 2949.86645   154%     -  438s
     1     4 2801.59952    1  475 -5493.3444 2942.15182   154%  5458  444s
     3     8 2663.91361    2  486 -5493.3444 2801.54127   151%  5668  455s
     7    16 2498.43541    3  483 -5493.3444 2699.45413   149%  6992  466s
    15    32 2095.47420    4  482 -5493.3444 2496.62144   145%  6599  482s
    31    49 -4370.9455    5  201 -5493.3444 2095.23983   138%  7915  668s
    48    78  871.19162    6  451 -5493.3444 2095.23983   138% 10621  694s
    79   118  540.49961    7  430 -5493.3444 2095.23983   138%  8797  711s
   123   170  251.01488    8  429 -5493.3444 2095.23983   138%  7403  726s
   175   240   61.72491    8  355 -5493.3444 2095.23983   138%  6075  743s
   251   308 -1389.2842    9  253 -5493.3444 2095.23983   138%  4859  761s
   344   362  -21.51269    9  366 -5493.3444 2095.23983   138%  4047  776s
   447   385 -1699.7295    9  252 -5493.3444 2095.23983   138%  3623  790s
   495   400 -264.11825    9  418 -5493.3444 2095.23983   138%  3540  803s
   583   436 -866.86316   10  381 -5493.3444 2095.23983   138%  3327  817s
   654   442 -488.83861   10  432 -5493.3444 2095.23983   138%  3337  829s
   732   454 -1543.8747   10  253 -5493.3444 2095.23983   138%  3335  842s
   774   481 -3131.6472   10  201 -5493.3444 1760.50187   132%  3450  855s
   823   501 -999.86630   11  391 -5493.3444 1760.50187   132%  3528  867s
   867   522 -1776.5468   12  414 -5493.3444 1760.50187   132%  3596  880s
   929   535 -3021.6669   12  192 -5493.3444 1760.50187   132%  3607  893s
  1001   535 -2308.1366   13  408 -5493.3444 1760.50187   132%  3556  908s
  1065   570 -2343.7101   13  397 -5493.3444 1760.50187   132%  3558  922s
  1134   603 -2383.6439   14  387 -5493.3444 1760.50187   132%  3609  936s
  1219   621 -3441.8392   13  180 -5493.3444 1760.50187   132%  3603  950s
  1305   666 -2730.0309   15  259 -5493.3444 1760.50187   132%  3572  966s
  1380   694 -3332.9924   16  250 -5493.3444 1760.50187   132%  3601  974s
  1418   718 -3271.4340   16  247 -5493.3444 1760.50187   132%  3642  989s
  1474   760 -3853.7411   17  355 -5493.3444 1760.50187   132%  3668 1005s
  1553   781 -3875.1836   18  354 -5493.3444 1760.50187   132%  3664 1023s
  1641   815 -4776.9078   19  250 -5493.3444 1760.50187   132%  3676 1040s
  1713   858 infeasible   22      -5493.3444 1364.13585   125%  3751 1058s
  1802   890 -1886.4024   15  379 -5493.3444 1364.13585   125%  3790 1076s
  1928   927 -2334.8761   16  361 -5493.3444 1364.13585   125%  3782 1094s
  2025   978 -4758.8812   17  141 -5493.3444 1364.13585   125%  3793 1113s
  2131  1049 -3463.8569   10  440 -5493.3444 1364.13585   125%  3834 1134s
  2273  1090 -3552.3526   11  437 -5493.3444 1364.13585   125%  3817 1156s
  2406  1129     cutoff   11      -5493.3444  778.97957   114%  3860 1178s
  2537  1193 -4698.7299   13  384 -5493.3444  778.97957   114%  3914 1198s
  2671  1228 -5251.5571   17  369 -5493.3444  778.97957   114%  3938 1218s
  2796  1253 infeasible   17      -5493.3444  778.97957   114%  3909 1239s
  2967  1298 -1067.7288    8  399 -5493.3444  139.35023   103%  3916 1265s
  3136  1358     cutoff   13      -5493.3444  139.35023   103%  3949 1289s
  3298  1397     cutoff   12      -5493.3444  103.47258   102%  3956 1314s
  3481  1473 -1514.6056   10  381 -5493.3444 -156.32670  97.2%  3994 1342s
  3675  1513 -3004.3956   13  311 -5493.3444 -274.15979  95.0%  4015 1369s
  3876  1547 -3970.5205   17  395 -5493.3444 -274.15979  95.0%  4022 1397s
  4043  1598 -4720.6564   20  404 -5493.3444 -274.15979  95.0%  4023 1425s
  4272  1645 -5409.0662   10  307 -5493.3444 -274.15979  95.0%  4017 1455s
  4524  1726 -4464.0196   15  394 -5493.3444 -274.15979  95.0%  4002 1481s
  4733  1800 infeasible   17      -5493.3444 -822.67416  85.0%  4033 1513s
  4970  1865 -5135.4056   15  387 -5493.3444 -869.55069  84.2%  4045 1544s
  5221  1929 -2540.7761   10  263 -5493.3444 -895.68955  83.7%  4029 1576s
  5477  1997 -3921.6230   13  357 -5493.3444 -932.72384  83.0%  4046 1609s
  5632  2073 -4661.6219   16  179 -5493.3444 -1157.3074  78.9%  4076 1643s
  5931  2174 -3302.1352   15  212 -5493.3444 -1201.4219  78.1%  4080 1677s
  6311  2175 -4601.6486   23  492 -5493.3444 -1343.4973  75.5%  4030 1761s
  6313  2176 -2240.4531   15  252 -5493.3444 -1343.4973  75.5%  4029 1826s
  6314  2177 -3826.7462   16  402 -5493.3444 -1343.4973  75.5%  4028 1866s
  6315  2178 -4531.7427   22  449 -5493.3444 -1343.4973  75.5%  4028 1895s
  6316  2178 -3529.3501   22  459 -5493.3444 -1343.4973  75.5%  4027 1915s
  6317  2179 -3482.6525   15  471 -5493.3444 -1343.4973  75.5%  4026 1931s
  6318  2180 -2256.2456   12  528 -5493.3444 -1343.4973  75.5%  4026 1940s
  6319  2180 -2352.5413   19  461 -5493.3444 -1343.4973  75.5%  4025 1955s
  6320  2181 -3251.6703    9  515 -5493.3444 -1343.4973  75.5%  4024 1963s
  6321  2182 -4285.5973   18  480 -5493.3444 -1343.4973  75.5%  4024 1970s
  6322  2182 -3885.9046   18  488 -5493.3444 -1343.4973  75.5%  4023 1978s
  6323  2183 -4887.9974   22  498 -5493.3444 -1343.4973  75.5%  4023 1983s
  6324  2184 -5059.8828   18  489 -5493.3444 -1343.4973  75.5%  4022 1988s
  6325  2184 -2946.0206   17  484 -5493.3444 -1343.4973  75.5%  4021 1993s
  6326  2185 -4603.1970   21  484 -5493.3444 -1343.4973  75.5%  4021 2004s
  6327  2186 -3818.2415   13  536 -5493.3444 -1343.4973  75.5%  4020 2011s
  6328  2186 -2038.5441    9  485 -5493.3444 -1343.4973  75.5%  4019 2016s
  6329  2187 -4246.2588   23  549 -5493.3444 -1343.4973  75.5%  4019 2026s
  6330  2188 -4537.7341   16  499 -5493.3444 -1343.4973  75.5%  4018 2031s
  6331  2188 -3625.2555   16  487 -5493.3444 -1343.4973  75.5%  4017 2042s
  6332  2189 -2685.0819   16  489 -5493.3444 -1343.4973  75.5%  4017 2047s
  6333  2190 -4337.0733   20  540 -5493.3444 -1343.4973  75.5%  4016 2061s
  6335  2191 -4220.5241   25  543 -5493.3444 -1343.4973  75.5%  4015 2068s
  6336  2192 -2507.6638    7  492 -5493.3444 -1343.4973  75.5%  4014 2075s
  6338  2193 -1807.1837   14  551 -5493.3444 -1343.4973  75.5%  4013 2087s
  6339  2194 -2021.3088   13  551 -5493.3444 -1343.4973  75.5%  4012 2150s
  6340  2194 -3725.3823   23  551 -5493.3444 -1343.4973  75.5%  4012 2185s
  6341  2197 -1343.4973   11  417 -5493.3444 -1343.4973  75.5%  4055 2198s
  6342  2200 -1343.4973   12  461 -5493.3444 -1343.4973  75.5%  4055 2218s
  6345  2205 -1343.4973   13  398 -5493.3444 -1343.4973  75.5%  4057 2233s
  6351  2215 -1343.4973   14  385 -5493.3444 -1343.4973  75.5%  4061 2252s
  6363  2226 -2561.1910   15  205 -5493.3444 -1343.4973  75.5%  4071 2279s
  6378  2248 -1343.4973   15  463 -5493.3444 -1343.4973  75.5%  4094 2322s
  6410  2327 -1448.9612   16  367 -5493.3444 -1343.4973  75.5%  4099 2342s
  6518  2332 -2342.5501   18  423 -5493.3444 -1343.4973  75.5%  4108 2358s
  6608  2315 -3877.4172   18  216 -5493.3444 -1343.4973  75.5%  4080 2372s
  6675  2303 -2229.1919   17  422 -5493.3444 -1343.4973  75.5%  4066 2385s
  6723  2309 -2350.1845   18  425 -5493.3444 -1343.4973  75.5%  4062 2397s
  6780  2299 -4149.1465   19  227 -5493.3444 -1343.4973  75.5%  4070 2411s
  6839  2290 -4753.1417   21  211 -5493.3444 -1343.4973  75.5%  4067 2425s
  6889  2294 -4850.2129   20  206 -5493.3444 -1343.4973  75.5%  4073 2448s
  6922  2282     cutoff   23      -5493.3444 -1343.4973  75.5%  4075 2463s
  6975  2283 -1798.5205   20  361 -5493.3444 -1343.4973  75.5%  4093 2477s
  7010  2286 -2047.8176   21  317 -5493.3444 -1343.4973  75.5%  4106 2490s
  7049  2279 -2593.7864   22  310 -5493.3444 -1343.4973  75.5%  4104 2514s
  7093  2267 -2874.4748   23  330 -5493.3444 -1343.4973  75.5%  4105 2529s
  7142  2254 -2918.8211   24  325 -5493.3444 -1343.4973  75.5%  4116 2543s
  7182  2250 -3319.8864   25  257 -5493.3444 -1343.4973  75.5%  4126 2558s
  7229  2245 -4463.0985   26  308 -5493.3444 -1343.4973  75.5%  4138 2579s
  7279  2245 -4799.0133   27  394 -5493.3444 -1343.4973  75.5%  4142 2595s
  7327  2241 -5240.1651   28  324 -5493.3444 -1343.4973  75.5%  4157 2611s
  7370  2236 -5387.6202   29  303 -5493.3444 -1343.4973  75.5%  4175 2631s
  7420  2243 -3311.9425   18  322 -5493.3444 -1343.4973  75.5%  4179 2651s
  7462  2236     cutoff   20      -5493.3444 -1343.4973  75.5%  4192 2676s
  7519  2233     cutoff   23      -5493.3444 -1343.4973  75.5%  4202 2693s
  7580  2235 -3611.8088   18  526 -5493.3444 -1343.4973  75.5%  4219 2708s
  7638  2230 -4202.8596   20  425 -5493.3444 -1343.4973  75.5%  4231 2741s
  7725  2213     cutoff   22      -5493.3444 -1343.4973  75.5%  4229 2762s
  7794  2206     cutoff   22      -5493.3444 -1343.4973  75.5%  4256 2784s
  7873  2177     cutoff   23      -5493.3444 -1343.4973  75.5%  4251 2806s
  7933  2166 -5423.4704   26  404 -5493.3444 -1343.4973  75.5%  4264 2828s
  8006  2142 -3275.7233   18  390 -5493.3444 -1343.4973  75.5%  4272 2850s
  8082  2131 -3732.3815   19  375 -5493.3444 -1343.4973  75.5%  4276 2871s
  8146  2125 -4481.8241   20  357 -5493.3444 -1343.4973  75.5%  4286 2897s
  8234  2104     cutoff   21      -5493.3444 -1343.4973  75.5%  4295 2922s
  8348  2099 -4402.4720   20  207 -5493.3444 -1567.7785  71.5%  4297 2947s
  8465  2070 -4434.0899   21  203 -5493.3444 -1567.7785  71.5%  4305 2974s
  8592  2035 -4926.3665   25  177 -5493.3444 -2086.8008  62.0%  4308 3000s
  8717  2011 -5056.0811   23  421 -5493.3444 -2210.8183  59.8%  4320 3026s
  8853  1975     cutoff   27      -5493.3444 -2210.8183  59.8%  4330 3054s
  8976  1937 -3899.7675   19  332 -5493.3444 -2385.7647  56.6%  4325 3084s
  9113  1886     cutoff   21      -5493.3444 -2433.7671  55.7%  4321 3115s
  9280  1827 -4772.7173   21  314 -5493.3444 -2699.3476  50.9%  4323 3140s
  9406  1778 -5256.8900   22  279 -5493.3444 -2771.1133  49.6%  4320 3172s
  9571  1720     cutoff   25      -5493.3444 -2771.1133  49.6%  4306 3207s
  9771  1632 -4973.2789   26  313 -5493.3444 -2966.4737  46.0%  4305 3241s
 10001  1507 -5262.8196   23  269 -5493.3444 -3126.5800  43.1%  4297 3275s
 10285  1340 -4410.5957   26  264 -5493.3444 -3384.3837  38.4%  4277 3323s
 10627  1126 -4617.8164   24  492 -5493.3444 -3555.5500  35.3%  4236 3359s
 10989   882 -4996.3693   26  313 -5493.3444 -3555.5500  35.3%  4188 3399s
 11427   557     cutoff   29      -5493.3444 -4045.0438  26.4%  4114 3429s
 11867   352 -5080.6295   29  236 -5493.3444 -4443.8207  19.1%  4027 3437s

Cutting planes:
  Gomory: 4
  MIR: 560
  Flow cover: 1168
  RLT: 9
  Relax-and-lift: 83

Explored 11970 nodes (48233255 simplex iterations) in 3437.92 seconds (6203.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5493.34 -5503.98 -5507.94 ... -5809.14
No other solutions better than -5493.34

Optimal solution found (tolerance 1.00e-06)
Best objective -5.493344359960e+03, best bound -5.493344359960e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3437.94s
  Master Objective (UB) = -5493.34, θ = 120500.19
  Upper Bound (UB) = -5493.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120500.19
  [DEBUG]   ✓ Scenario 0: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120500.19 ≤ Q = 120500.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120500.19 ≤ Q = 120500.19 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4c87d1d4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb3782e2c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362774e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6433825.7282
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.447644e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144764.42    0  124 6433825.73 -144764.42   102%     -    0s
H    0     0                    -110895.7478 -144764.42  30.5%     -    0s
H    0     0                    -112038.9618 -144764.42  29.2%     -    0s
     0     0 -121687.62    0  129 -112038.96 -121687.62  8.61%     -    0s
H    0     0                    -115877.5341 -121529.84  4.88%     -    0s
     0     0 -120124.12    0  131 -115877.53 -120124.12  3.66%     -    0s
H    0     0                    -116358.3370 -119969.47  3.10%     -    0s
H    0     0                    -116372.8142 -119438.47  2.63%     -    0s
     0     0 -119438.47    0  136 -116372.81 -119438.47  2.63%     -    0s
     0     0 -119411.48    0  136 -116372.81 -119411.48  2.61%     -    0s
     0     0 -118885.42    0  108 -116372.81 -118885.42  2.16%     -    0s
     0     0 -118859.36    0  130 -116372.81 -118859.36  2.14%     -    0s
     0     0 -118859.31    0  130 -116372.81 -118859.31  2.14%     -    0s
     0     0 -118551.26    0   62 -116372.81 -118551.26  1.87%     -    0s
     0     0 -118389.43    0  131 -116372.81 -118389.43  1.73%     -    0s
     0     0 -118381.20    0  131 -116372.81 -118381.20  1.73%     -    0s
     0     0 -118202.77    0  115 -116372.81 -118202.77  1.57%     -    0s
     0     0 -118180.62    0  118 -116372.81 -118180.62  1.55%     -    0s
     0     0 -118076.99    0  118 -116372.81 -118076.99  1.46%     -    0s
     0     0 -118073.87    0  118 -116372.81 -118073.87  1.46%     -    0s
H    0     0                    -116388.9359 -118066.43  1.44%     -    0s
     0     2 -118066.43    0  118 -116388.94 -118066.43  1.44%     -    0s
H  110   255                    -116435.1489 -117668.32  1.06%  18.4    0s
H  120   255                    -116478.8200 -117668.32  1.02%  17.8    0s
H  135   255                    -116492.7822 -117668.32  1.01%  17.1    0s
* 1312  1055              39    -116704.1047 -117571.18  0.74%   8.6    0s
H 1639  1178                    -116864.1216 -117415.79  0.47%   8.9    0s
* 2177  1185              24    -117004.0765 -117358.85  0.30%   8.8    0s
H 3083   825                    -117028.8814 -117202.72  0.15%   9.2    0s
* 4017     0              21    -117028.9724 -117065.07  0.03%   8.0    0s

Cutting planes:
  Gomory: 62
  MIR: 228
  RLT: 8
  BQP: 1

Explored 4254 nodes (33017 simplex iterations) in 0.49 seconds (0.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117029 -117029 -117004 ... -116373
No other solutions better than -117029

Optimal solution found (tolerance 1.00e-06)
Best objective -1.170289724409e+05, best bound -1.170289724409e+05, gap 0.0000%
  Subproblem solved in 0.52s
  Worst-case operational profit (Z_SP) = 116973.66
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117028.97
  [DEBUG]   S×d_nominal = 234002.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234002.63 + -117028.97 = 116973.66
  [DEBUG]   Current θ from Master = 120500.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3526.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9019.87
  Lower Bound (LB) = -9019.87
  Gap (UB-LB) = 3526.5244, Absolute Gap = 3526.5244, Relative Gap = 0.641963
  Not converged yet (gap = 3526.52 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xe1b7c80e
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.68s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22230   -2.0371694e+05   0.000000e+00   2.396094e+06      5s
   38586   -5.9172998e+04   0.000000e+00   1.176060e+08     10s
   45370   -2.5761446e+04   0.000000e+00   9.497782e+08     15s
   52478   -1.6906702e+04   0.000000e+00   4.814688e+07     20s
   59179   -2.1870297e+03   0.000000e+00   6.639175e+07     25s
   64934    7.8336025e+02   0.000000e+00   8.126187e+06     30s
   70460    1.3632008e+03   0.000000e+00   2.706873e+07     35s
   76387    2.9429212e+03   0.000000e+00   3.253490e+07     40s
   81735    3.5226134e+03   0.000000e+00   6.312185e+06     45s
   86447    3.7257587e+03   0.000000e+00   1.271747e+06     50s
   90301    4.0712219e+03   0.000000e+00   5.157938e+06     55s
   93127    4.0864638e+03   0.000000e+00   1.878116e+07     60s
   97409    5.4673901e+03   0.000000e+00   5.352802e+06     65s
  101908    6.1476572e+03   0.000000e+00   1.018223e+09     70s
  106185    6.4615756e+03   0.000000e+00   4.861847e+07     75s
  109168    6.4906332e+03   0.000000e+00   7.384660e+06     80s
  113483    7.3879333e+03   0.000000e+00   7.679507e+07     85s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.342030e+04, 75024 iterations, 81.70 seconds (101.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13420.2981    0  166 -177247.82 13420.2981   108%     -   85s
H    0     0                    -170943.4194 13420.2981   108%     -   85s
H    0     0                    -90873.72417 13420.2981   115%     -   85s
H    0     0                    -90214.14684 13420.2981   115%     -   85s
H    0     0                    -80248.25734 13420.2981   117%     -   85s
H    0     0                    -22938.78248 13420.2981   159%     -   86s
H    0     0                    -15650.62137 13420.2981   186%     -   86s
H    0     0                    -15493.81039 13420.2981   187%     -   86s
H    0     0                    -14895.84004 13420.2981   190%     -   86s
H    0     0                    -14610.26593 13420.2981   192%     -   86s
H    0     0                    -14498.61013 13420.2981   193%     -   86s
H    0     0                    -14419.27189 13420.2981   193%     -   87s
H    0     0                    -14404.13008 13420.2981   193%     -   91s
H    0     0                    -7232.490477 13420.2981   286%     -   93s
H    0     0                    -5987.039277 13420.2981   324%     -   93s
H    0     0                    -5973.891608 13420.2981   325%     -   93s
H    0     0                    -5969.900711 13420.2981   325%     -   93s
H    0     0                    -5964.851019 13420.2981   325%     -   93s
H    0     0                    -5961.392632 13420.2981   325%     -   93s
     0     0 10116.5616    0  328 -5961.3926 10116.5616   270%     -  113s
H    0     0                    -5939.975759 10116.5616   270%     -  114s
     0     0 10116.5616    0  331 -5939.9758 10116.5616   270%     -  121s
     0     0 10116.5616    0  331 -5939.9758 10116.5616   270%     -  124s
     0     0 10116.5616    0  331 -5939.9758 10116.5616   270%     -  124s
     0     0 10116.5616    0  325 -5939.9758 10116.5616   270%     -  126s
     0     0 7888.60864    0  318 -5939.9758 7888.60864   233%     -  127s
     0     0 7888.60864    0  318 -5939.9758 7888.60864   233%     -  128s
     0     0 7798.15042    0  356 -5939.9758 7798.15042   231%     -  150s
H    0     0                    -5818.725752 7797.58961   234%     -  151s
H    0     0                    -5753.875628 7797.58961   236%     -  151s
     0     0 7269.69809    0  372 -5753.8756 7269.69809   226%     -  163s
     0     0 7217.55417    0  386 -5753.8756 7217.55417   225%     -  169s
     0     0 7206.41346    0  392 -5753.8756 7206.41346   225%     -  172s
     0     0 7167.54115    0  379 -5753.8756 7167.54115   225%     -  177s
     0     0 7156.31350    0  387 -5753.8756 7156.31350   224%     -  179s
     0     0 7098.52774    0  385 -5753.8756 7098.52774   223%     -  184s
     0     0 6860.12666    0  399 -5753.8756 6860.12666   219%     -  192s
     0     0 6770.19586    0  398 -5753.8756 6770.19586   218%     -  198s
     0     0 6761.34491    0  401 -5753.8756 6761.34491   218%     -  200s
     0     0 6755.87328    0  404 -5753.8756 6755.87328   217%     -  201s
     0     0 6752.39981    0  405 -5753.8756 6752.39981   217%     -  202s
     0     0 6752.07518    0  397 -5753.8756 6752.07518   217%     -  203s
     0     0 5604.66037    0  451 -5753.8756 5604.66037   197%     -  235s
H    0     0                    -5697.580011 5604.55875   198%     -  236s
H    0     0                    -5684.298605 5604.55875   199%     -  236s
H    0     0                    -5672.684155 5604.55875   199%     -  236s
H    0     0                    -5661.140703 5604.55875   199%     -  236s
H    0     0                    -5660.937332 5604.55875   199%     -  236s
H    0     0                    -5652.237421 5281.42981   193%     -  249s
H    0     0                    -5646.111420 5281.42981   194%     -  249s
     0     0 5281.42981    0  448 -5646.1114 5281.42981   194%     -  249s
     0     0 5037.45817    0  441 -5646.1114 5037.45817   189%     -  262s
     0     0 4829.01502    0  457 -5646.1114 4829.01502   186%     -  269s
     0     0 4721.22675    0  468 -5646.1114 4721.22675   184%     -  274s
     0     0 4659.96363    0  463 -5646.1114 4659.96363   183%     -  280s
     0     0 4627.53881    0  470 -5646.1114 4627.53881   182%     -  286s
     0     0 4583.65203    0  456 -5646.1114 4583.65203   181%     -  290s
     0     0 4569.97103    0  463 -5646.1114 4569.97103   181%     -  292s
     0     0 4557.07886    0  453 -5646.1114 4557.07886   181%     -  296s
     0     0 4526.56549    0  458 -5646.1114 4526.56549   180%     -  300s
     0     0 4521.66263    0  464 -5646.1114 4521.66263   180%     -  300s
     0     0 4518.03373    0  464 -5646.1114 4518.03373   180%     -  301s
     0     0 4515.99320    0  463 -5646.1114 4515.99320   180%     -  302s
     0     0 4515.93627    0  464 -5646.1114 4515.93627   180%     -  303s
     0     0 3862.43214    0  471 -5646.1114 3862.43214   168%     -  325s
     0     0 3652.00843    0  482 -5646.1114 3652.00843   165%     -  335s
     0     0 3613.65848    0  487 -5646.1114 3613.65848   164%     -  340s
     0     0 3582.56436    0  490 -5646.1114 3582.56436   163%     -  344s
H    0     0                    -5593.124114 3571.94738   164%     -  346s
H    0     0                    -5583.833914 3571.94738   164%     -  346s
H    0     0                    -5556.964639 3571.94738   164%     -  346s
H    0     0                    -5527.476520 3571.94738   165%     -  346s
     0     0 3571.94738    0  488 -5527.4765 3571.94738   165%     -  346s
     0     0 3536.30857    0  497 -5527.4765 3536.30857   164%     -  349s
     0     0 3520.18789    0  499 -5527.4765 3520.18789   164%     -  351s
     0     0 3514.13334    0  493 -5527.4765 3514.13334   164%     -  352s
H    0     0                    -5521.380432 3511.14508   164%     -  353s
     0     0 3511.14508    0  496 -5521.3804 3511.14508   164%     -  353s
     0     0 3506.78987    0  499 -5521.3804 3506.78987   164%     -  354s
     0     0 3506.37834    0  503 -5521.3804 3506.37834   164%     -  355s
     0     0 3370.69595    0  482 -5521.3804 3370.69595   161%     -  364s
     0     0 3313.55598    0  487 -5521.3804 3313.55598   160%     -  370s
     0     0 3301.38483    0  485 -5521.3804 3301.38483   160%     -  372s
     0     0 3293.89150    0  487 -5521.3804 3293.89150   160%     -  374s
     0     0 3288.55528    0  482 -5521.3804 3288.55528   160%     -  375s
     0     0 3285.25044    0  488 -5521.3804 3285.25044   160%     -  378s
     0     0 3280.83536    0  488 -5521.3804 3280.83536   159%     -  378s
     0     0 3279.24632    0  490 -5521.3804 3279.24632   159%     -  379s
     0     0 3277.79917    0  490 -5521.3804 3277.79917   159%     -  380s
     0     0 3275.93018    0  500 -5521.3804 3275.93018   159%     -  381s
     0     0 3275.82251    0  500 -5521.3804 3275.82251   159%     -  381s
     0     0 3228.81137    0  495 -5521.3804 3228.81137   158%     -  389s
H    0     0                    -5510.742308 3217.01457   158%     -  397s
     0     0 3217.01457    0  502 -5510.7423 3217.01457   158%     -  397s
     0     0 3211.47336    0  499 -5510.7423 3211.47336   158%     -  399s
     0     0 3197.39660    0  506 -5510.7423 3197.39660   158%     -  401s
     0     0 3180.37586    0  491 -5510.7423 3180.37586   158%     -  404s
     0     0 3177.09844    0  499 -5510.7423 3177.09844   158%     -  406s
     0     0 3175.68435    0  501 -5510.7423 3175.68435   158%     -  407s
     0     0 3175.21267    0  507 -5510.7423 3175.21267   158%     -  407s
     0     0 3150.37206    0  502 -5510.7423 3150.37206   157%     -  412s
     0     0 3141.27730    0  495 -5510.7423 3141.27730   157%     -  416s
     0     0 3137.57216    0  496 -5510.7423 3137.57216   157%     -  418s
     0     0 3136.31858    0  496 -5510.7423 3136.31858   157%     -  419s
     0     0 3126.53242    0  504 -5510.7423 3126.53242   157%     -  423s
     0     0 3118.72801    0  554 -5510.7423 3118.72801   157%     -  427s
     0     0 3118.25214    0  559 -5510.7423 3118.25214   157%     -  428s
     0     0 3114.11608    0  499 -5510.7423 3114.11608   157%     -  431s
     0     0 3109.90189    0  500 -5510.7423 3109.90189   156%     -  433s
     0     0 3109.47980    0  497 -5510.7423 3109.47980   156%     -  434s
     0     0 3104.16525    0  498 -5510.7423 3104.16525   156%     -  437s
     0     0 3101.78004    0  501 -5510.7423 3101.78004   156%     -  440s
     0     0 3100.27262    0  502 -5510.7423 3100.27262   156%     -  442s
     0     0 3099.26401    0  507 -5510.7423 3099.26401   156%     -  443s
     0     0 3086.92207    0  508 -5510.7423 3086.92207   156%     -  448s
     0     0 3085.04349    0  515 -5510.7423 3085.04349   156%     -  450s
     0     0 3084.41839    0  516 -5510.7423 3084.41839   156%     -  451s
     0     0 3079.47555    0  518 -5510.7423 3079.47555   156%     -  453s
     0     0 3078.13162    0  522 -5510.7423 3078.13162   156%     -  465s
     0     0 3077.47843    0  523 -5510.7423 3077.47843   156%     -  465s
     0     0 3065.08718    0  517 -5510.7423 3065.08718   156%     -  470s
     0     0 3064.27014    0  519 -5510.7423 3064.27014   156%     -  472s
     0     0 3061.81243    0  515 -5510.7423 3061.81243   156%     -  474s
     0     0 3060.51621    0  519 -5510.7423 3060.51621   156%     -  477s
     0     0 3057.37802    0  516 -5510.7423 3057.37802   155%     -  480s
     0     0 3056.24639    0  515 -5510.7423 3056.24639   155%     -  481s
     0     0 3055.82145    0  519 -5510.7423 3055.82145   155%     -  483s
     0     0 3055.22388    0  519 -5510.7423 3055.22388   155%     -  486s
     0     2 3055.22388    0  519 -5510.7423 3055.22388   155%     -  549s
     1     4 3007.50149    1  494 -5510.7423 3054.91622   155%  4273  555s
     3     8 2877.58633    2  495 -5510.7423 3007.33141   155%  5296  574s
     7    16 2705.09438    3  548 -5510.7423 2877.09340   152%  7488  591s
    15    31 2535.56496    4  498 -5510.7423 2704.94220   149%  8957  612s
    30    46 1173.15367    5  470 -5510.7423 2535.22092   146% 11769  653s
    45    75  590.46910    6  397 -5510.7423 2535.22092   146% 10747  720s
    76   135  258.19050    7  287 -5510.7423 2535.22092   146% 10570  754s
   140   223   13.48709    9  284 -5510.7423 2535.22092   146%  7801  777s
   238   311 -1281.5160   11  209 -5510.7423 2535.22092   146%  5682  793s
   354   371 -1428.6299   16  201 -5510.7423 2535.22092   146%  4707  810s
   447   432 -2693.6627   20  179 -5510.7423 2535.22092   146%  4189  825s
   536   459 -4835.3812   25  138 -5510.7423 2535.22092   146%  3896  838s
   589   503 -4952.7640   26  150 -5510.7423 2535.22092   146%  3831  852s
   659   544 -3263.8812   11  266 -5510.7423 2535.22092   146%  3688  867s
   728   586 -590.97150   15  353 -5510.7423 2535.22092   146%  3632  882s
   796   608 -718.33966   16  339 -5510.7423 2535.22092   146%  3574  896s
   869   631 -781.73010   16  337 -5510.7423 2535.22092   146%  3522  912s
   948   645 -1475.9542   18  330 -5510.7423 2535.22092   146%  3528  926s
  1026   666 -1101.4083   17  334 -5510.7423 2535.22092   146%  3580  943s
  1097   687 -1612.4791   19  333 -5510.7423 2535.22092   146%  3564  957s
  1160   692 -2061.8271   19  297 -5510.7423 2535.22092   146%  3625  973s
  1239   703 -1727.8618   20  321 -5510.7423 2387.15732   143%  3698  988s
  1328   732 -2320.7117   21  392 -5510.7423 2387.15732   143%  3699 1005s
  1389   759 -2016.6121   21  240 -5510.7423 2387.15732   143%  3782 1021s
  1456   799 infeasible   22      -5510.7423 2387.15732   143%  3866 1035s
  1531   832 -2374.5713   22  327 -5510.7423 2387.15732   143%  3929 1054s
  1614   874 -3280.9312   24  222 -5510.7423 2387.15732   143%  4009 1073s
  1706   931 -3587.3934   27  312 -5510.7423 2387.15732   143%  4091 1092s
  1792   996     cutoff   30      -5510.7423 2387.15732   143%  4191 1112s
  1934  1025 -4444.0663   34  416 -5510.7423 2387.15732   143%  4134 1132s
  2067  1076 -4480.2553   34  401 -5510.7423 2387.15732   143%  4115 1153s
  2168  1113 -4806.0486   37  366 -5510.7423 2387.15732   143%  4196 1170s
  2235  1136     cutoff   35      -5510.7423 1958.66051   136%  4226 1191s
  2274  1179 -5184.8614   38  350 -5510.7423 1958.66051   136%  4272 1211s
  2329  1212 -5090.6446   39  296 -5510.7423 1958.66051   136%  4311 1235s
  2410  1232 -5285.7707   40  218 -5510.7423 1958.66051   136%  4321 1256s
  2492  1255 -5177.4860   11  162 -5510.7423 1958.66051   136%  4346 1281s
  2597  1301     cutoff   13      -5510.7423 1958.66051   136%  4369 1305s
  2729  1361 -714.46001    9  421 -5510.7423 1958.66051   136%  4391 1330s
  2857  1433 -1124.9793   10  472 -5510.7423 1721.05585   131%  4431 1355s
  3011  1504 -1676.2474   12  440 -5510.7423 1721.05585   131%  4440 1380s
  3190  1562 -2247.0134   15  414 -5510.7423 1721.05585   131%  4445 1408s
  3346  1619 -4448.3631   18  308 -5510.7423 1721.05585   131%  4476 1435s
  3479  1691 -4543.8447   20  417 -5510.7423 1324.69882   124%  4547 1463s
  3672  1759     cutoff   24      -5510.7423  841.44644   115%  4557 1495s
  3890  1850     cutoff   29      -5510.7423  841.44644   115%  4515 1527s
  4097  1914 -3953.3621   11  317 -5510.7423  841.44644   115%  4511 1561s
  4316  1966     cutoff   14      -5510.7423  720.72248   113%  4521 1596s
  4520  1976     cutoff   15      -5510.7423  720.72248   113%  4516 1624s
  4579  2008 -1654.1035    9  311 -5510.7423  378.52241   107%  4544 1654s
  4635  2053 -1952.5921   10  308 -5510.7423  378.52241   107%  4579 1688s
  4767  2105 -2243.7186   11  314 -5510.7423  378.52241   107%  4585 1724s
  4931  2196     cutoff   13      -5510.7423  312.15109   106%  4623 1764s
  5129  2303 -821.04513   10  320 -5510.7423  217.03910   104%  4678 1803s
  5371  2304 -4178.6497   20  519 -5510.7423  217.03910   104%  4706 1923s
  5373  2305 -3766.4886   17  166 -5510.7423  217.03910   104%  4704 1983s
  5374  2306 -2265.7511   12  386 -5510.7423  217.03910   104%  4703 2021s
  5375  2307 -2612.1736   11  447 -5510.7423  217.03910   104%  4703 2056s
  5376  2307 -5172.6841   24  528 -5510.7423  217.03910   104%  4702 2078s
  5377  2308 -5173.8003   40  480 -5510.7423  217.03910   104%  4701 2089s
  5378  2309 -2509.2839   21  484 -5510.7423  217.03910   104%  4700 2103s
  5379  2309 -3538.7747   14  496 -5510.7423  217.03910   104%  4699 2113s
  5380  2310 -1411.1034   16  552 -5510.7423  217.03910   104%  4698 2124s
  5381  2311 -1817.9523   21  488 -5510.7423  217.03910   104%  4697 2131s
  5382  2311 -4861.5596   22  557 -5510.7423  217.03910   104%  4696 2136s
  5383  2312 -783.42324   17  505 -5510.7423  217.03910   104%  4696 2142s
  5384  2313 -4325.1456   33  505 -5510.7423  217.03910   104%  4695 2148s
  5385  2313 -1813.3477   11  536 -5510.7423  217.03910   104%  4694 2162s
  5386  2314 -4679.4476   33  543 -5510.7423  217.03910   104%  4693 2170s
  5387  2315 -3078.5151   17  546 -5510.7423  217.03910   104%  4692 2175s
  5388  2315 -204.99808   12  541 -5510.7423  217.03910   104%  4691 2183s
  5389  2316 -1844.1189   13  537 -5510.7423  217.03910   104%  4690 2189s
  5390  2317 -2528.3065   22  538 -5510.7423  217.03910   104%  4689 2200s
  5391  2317 -2593.7550   14  549 -5510.7423  217.03910   104%  4689 2206s
  5392  2318 -4451.6710   24  478 -5510.7423  217.03910   104%  4688 2222s
  5393  2319 -4464.2245   13  496 -5510.7423  217.03910   104%  4687 2228s
  5394  2319 -3940.6756   20  502 -5510.7423  217.03910   104%  4686 2240s
  5396  2321 -4580.3714   20  504 -5510.7423  217.03910   104%  4684 2249s
  5397  2321 -762.90457   13  570 -5510.7423  217.03910   104%  4683 2263s
  5398  2322 -3856.6331   27  577 -5510.7423  217.03910   104%  4682 2270s
  5399  2323 -4979.7878   16  514 -5510.7423  217.03910   104%  4682 2280s
  5401  2324 -4483.4957   34  564 -5510.7423  217.03910   104%  4680 2298s
  5402  2325 -3598.1622   32  621 -5510.7423  217.03910   104%  4679 2305s
  5403  2325 -1062.2830    9  510 -5510.7423  217.03910   104%  4678 2311s
  5404  2326 -2203.3283   14  510 -5510.7423  217.03910   104%  4677 2368s
  5405  2327 -3302.6751   18  510 -5510.7423  217.03910   104%  4676 2444s
  5406  2329  217.03910   15  458 -5510.7423  217.03910   104%  4728 2461s
  5407  2332 -229.63700   16  326 -5510.7423  217.03910   104%  4729 2482s
  5410  2337 -373.98726   17  320 -5510.7423  217.03910   104%  4728 2520s
  5416  2343 -720.81256   18  333 -5510.7423  217.03910   104%  4731 2557s
  5428  2347  217.03910   19  544 -5510.7423  217.03910   104%  4753 2602s
  5436  2367 -1604.7028   20  316 -5510.7423  217.03910   104%  4758 2661s
  5463  2390 -1711.8813   21  280 -5510.7423  217.03910   104%  4811 2688s
  5495  2452 -1753.5888   22  301 -5510.7423  217.03910   104%  4844 2719s
  5575  2492 -1878.6959   24  300 -5510.7423  217.03910   104%  4857 2745s
  5656  2497 -4907.4895   27   69 -5510.7423  217.03910   104%  4868 2787s
  5704  2508 -5130.9468   28   79 -5510.7423  217.03910   104%  4879 2808s
  5782  2487     cutoff   30      -5510.7423  217.03910   104%  4880 2840s
  5846  2477 -1065.5510   23  405 -5510.7423  217.03910   104%  4905 2876s
  5902  2475 -2296.9673   24  240 -5510.7423  217.03910   104%  4932 2907s
  5966  2474 -4196.1814   26  239 -5510.7423  217.03910   104%  4960 2931s
  6036  2470 -4852.9554   27  225 -5510.7423  217.03910   104%  4981 2952s
  6101  2466 -5147.1104   29  235 -5510.7423  217.03910   104%  4997 2972s
  6165  2451     cutoff   30      -5510.7423  217.03910   104%  4996 3001s
  6242  2434     cutoff   32      -5510.7423  217.03910   104%  4987 3026s
  6303  2432     cutoff   22      -5510.7423  217.03910   104%  5009 3046s
  6377  2433 -2789.6976   23  261 -5510.7423  217.03910   104%  5024 3075s
  6440  2426 -3590.5076   25  260 -5510.7423  217.03910   104%  5040 3096s
  6491  2421 -3671.0810   26  261 -5510.7423  217.03910   104%  5062 3116s
  6533  2437 -3834.9898   27  257 -5510.7423  217.03910   104%  5081 3138s
  6588  2442     cutoff   28      -5510.7423  217.03910   104%  5090 3159s
  6655  2431     cutoff   27      -5510.7423  217.03910   104%  5101 3181s
  6735  2415 -5215.6012   27  177 -5510.7423  217.03910   104%  5104 3228s
  6818  2405 -5239.5821   28  163 -5510.7423  217.03910   104%  5102 3255s
  6893  2396     cutoff   29      -5510.7423  217.03910   104%  5117 3290s
  6989  2381 -4893.8712   26  299 -5510.7423  217.03910   104%  5126 3318s
  7091  2357     cutoff   29      -5510.7423  217.03910   104%  5143 3347s
  7206  2347 -2308.1672   22  454 -5510.7423  217.03910   104%  5151 3375s
  7317  2339 -2544.1931   24  446 -5510.7423 -160.03538  97.1%  5153 3406s
  7423  2332 -2978.4484   27  416 -5510.7423 -160.03538  97.1%  5165 3443s
  7542  2318 -5472.4543   29  256 -5510.7423 -1045.9549  81.0%  5189 3475s
  7653  2314 -3416.9881   23  229 -5510.7423 -1135.7078  79.4%  5215 3510s
  7785  2270 -5275.3569   26  330 -5510.7423 -1323.7481  76.0%  5227 3544s
  7874  2285 -2657.3184   27  489 -5510.7423 -1323.7481  76.0%  5252 3580s
  7970  2275 -3116.5504   30  437 -5510.7423 -1323.7481  76.0%  5281 3600s

Cutting planes:
  Gomory: 2
  MIR: 759
  Flow cover: 1570
  Zero half: 1
  RLT: 5
  Relax-and-lift: 84

Explored 8071 nodes (42991958 simplex iterations) in 3600.06 seconds (6283.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5510.74 -5521.38 -5527.48 ... -5661.14

Time limit reached
Best objective -5.510742308193e+03, best bound -1.470706887507e+03, gap 73.3120%
  WARNING: Time limit reached. Using best solution found (gap: 73.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -5510.74, θ = 120643.45
  Upper Bound (UB) = -5510.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120643.45
  [DEBUG]   ✓ Scenario 0: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120643.45 ≤ Q = 120643.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120643.45 ≤ Q = 120643.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34018a8a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34018a8a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6450124.9136
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.450318e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145031.80    0  124 6450124.91 -145031.80   102%     -    0s
H    0     0                    -111059.1407 -145031.80  30.6%     -    0s
H    0     0                    -112202.3546 -145031.80  29.3%     -    0s
     0     0 -122295.48    0  129 -112202.35 -122295.48  9.00%     -    0s
H    0     0                    -116844.2140 -122134.17  4.53%     -    0s
     0     0 -121031.42    0  128 -116844.21 -121031.42  3.58%     -    0s
H    0     0                    -117076.7962 -120942.73  3.30%     -    0s
     0     0 -120912.03    0  128 -117076.80 -120912.03  3.28%     -    0s
H    0     0                    -117093.6545 -120912.03  3.26%     -    0s
     0     0 -120487.87    0  131 -117093.65 -120487.87  2.90%     -    0s
     0     0 -120451.75    0  131 -117093.65 -120451.75  2.87%     -    0s
     0     0 -119913.50    0  122 -117093.65 -119913.50  2.41%     -    0s
H    0     0                    -117594.5315 -119880.53  1.94%     -    0s
     0     0 -119880.53    0  122 -117594.53 -119880.53  1.94%     -    0s
     0     0 -119488.62    0   72 -117594.53 -119488.62  1.61%     -    0s
     0     0 -119422.63    0   74 -117594.53 -119422.63  1.55%     -    0s
     0     0 -119213.75    0   75 -117594.53 -119213.75  1.38%     -    0s
     0     0 -119143.89    0   74 -117594.53 -119143.89  1.32%     -    0s
     0     0 -118967.97    0   81 -117594.53 -118967.97  1.17%     -    0s
     0     0 -118920.93    0   74 -117594.53 -118920.93  1.13%     -    0s
     0     0 -118916.89    0   85 -117594.53 -118916.89  1.12%     -    0s
     0     0 -118874.96    0   85 -117594.53 -118874.96  1.09%     -    0s
     0     0 -118843.49    0   85 -117594.53 -118843.49  1.06%     -    0s
     0     2 -118843.49    0   85 -117594.53 -118843.49  1.06%     -    0s
H   57    62                    -117715.3910 -118502.91  0.67%  19.9    0s
H  465   426                    -117762.4358 -118501.82  0.63%   8.7    0s
H  495   426                    -117783.3137 -118501.82  0.61%   8.6    0s
H 3436  1227                    -117799.8731 -118162.93  0.31%   6.8    0s
H 4075  1232                    -117808.6267 -118099.03  0.25%   6.9    0s
H 5719  1266                    -117808.7547 -118013.33  0.17%   7.1    0s

Cutting planes:
  Gomory: 55
  Implied bound: 4
  MIR: 232
  RLT: 30

Explored 11252 nodes (73727 simplex iterations) in 1.07 seconds (0.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117809 -117809 -117800 ... -116844
No other solutions better than -117809

Optimal solution found (tolerance 1.00e-06)
Best objective -1.178087546796e+05, best bound -1.178087546796e+05, gap 0.0000%
  Subproblem solved in 1.10s
  Worst-case operational profit (Z_SP) = 116629.84
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117808.75
  [DEBUG]   S×d_nominal = 234438.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234438.60 + -117808.75 = 116629.84
  [DEBUG]   Current θ from Master = 120643.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4013.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9524.35
  Lower Bound (LB) = -9019.87
  Gap (UB-LB) = 3509.1264, Absolute Gap = 3509.1264, Relative Gap = 0.636779
  Not converged yet (gap = 3509.13 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xbd269074
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 3.17s
Presolved: 83583 rows, 35960 columns, 511919 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397731.2310
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.585e+06
 Factor NZ  : 7.691e+06 (roughly 100 MB of memory)
 Factor Ops : 1.319e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80766112e+07  1.66872446e+08  1.02e+05 1.89e+01  8.29e+04     5s
   1  -1.36465685e+07  1.44495135e+08  7.09e+04 7.17e+01  5.75e+04     5s
   2  -4.37893214e+06  1.06503124e+08  2.22e+04 3.14e+00  1.86e+04     5s
   3  -2.83338831e+06  9.86059860e+07  1.08e+04 2.34e+00  9.24e+03     5s
   4  -8.57798769e+05  8.30265724e+07  1.15e+03 1.40e+00  1.44e+03     5s
   5  -6.45227215e+05  4.05836498e+07  5.95e+02 5.02e-01  6.78e+02     5s
   6  -4.86367231e+05  2.52693439e+07  2.31e+02 2.55e-01  3.15e+02     5s
   7  -3.35530384e+05  1.90520254e+07  8.99e+01 1.77e-01  1.79e+02     5s
   8  -2.04586778e+05  1.20726406e+07  3.10e+01 1.02e-01  9.50e+01     6s
   9  -1.44434012e+05  7.74898392e+06  1.73e+01 6.18e-02  5.76e+01     6s
  10  -1.04680049e+05  4.02157410e+06  6.15e+00 3.01e-02  2.82e+01     6s
  11  -7.49171551e+04  1.56286383e+06  1.87e+00 1.11e-02  1.08e+01     6s
  12  -4.95328871e+04  6.94243292e+05  7.06e-01 4.75e-03  4.87e+00     6s
  13  -3.60381778e+04  3.31449344e+05  4.12e-01 2.34e-03  2.40e+00     6s
  14  -2.69965404e+04  1.71903813e+05  2.83e-01 1.31e-03  1.30e+00     6s
  15  -2.14122974e+04  1.18202793e+05  2.22e-01 1.06e-03  9.12e-01     6s
  16  -1.39153636e+04  9.75679115e+04  1.55e-01 1.03e-03  7.28e-01     6s
  17  -1.07849572e+04  7.45310789e+04  1.34e-01 1.42e-03  5.57e-01     6s
  18  -4.93148250e+03  5.45391871e+04  9.66e-02 1.12e-03  3.88e-01     6s
  19   2.51238584e+02  4.03544888e+04  7.08e-02 1.63e-03  2.62e-01     7s
  20   2.01773246e+03  3.55285190e+04  6.07e-02 2.35e-03  2.19e-01     7s
  21   4.59046049e+03  3.03894172e+04  4.81e-02 1.61e-03  1.68e-01     7s
  22   7.67645540e+03  2.75367568e+04  3.36e-02 1.82e-03  1.30e-01     7s
  23   9.61958485e+03  2.51901957e+04  2.51e-02 1.99e-03  1.02e-01     7s
  24   1.01376819e+04  2.29305292e+04  2.28e-02 1.55e-03  8.35e-02     7s
  25   1.14996687e+04  2.05406465e+04  1.73e-02 9.54e-04  5.90e-02     7s
  26   1.26848847e+04  1.91349793e+04  1.28e-02 6.59e-04  4.21e-02     7s
  27   1.30899297e+04  1.82911276e+04  1.12e-02 5.17e-04  3.40e-02     7s
  28   1.39870521e+04  1.74350771e+04  7.80e-03 3.09e-04  2.25e-02     8s
  29   1.44199524e+04  1.70525285e+04  6.19e-03 2.58e-04  1.72e-02     8s
  30   1.45208991e+04  1.69223506e+04  5.77e-03 2.46e-04  1.57e-02     8s
  31   1.47877351e+04  1.67683603e+04  4.81e-03 1.91e-04  1.29e-02     8s
  32   1.51766960e+04  1.65752693e+04  3.42e-03 1.22e-04  9.14e-03     8s
  33   1.54162149e+04  1.64249524e+04  2.59e-03 5.45e-05  6.59e-03     8s
  34   1.55305813e+04  1.63870439e+04  2.19e-03 4.54e-05  5.60e-03     8s
  35   1.55561772e+04  1.63711870e+04  2.10e-03 4.21e-05  5.33e-03     9s
  36   1.56843167e+04  1.63284738e+04  1.67e-03 3.32e-05  4.21e-03     9s
  37   1.57382754e+04  1.63000235e+04  1.49e-03 2.70e-05  3.67e-03     9s
  38   1.57757636e+04  1.62835613e+04  1.36e-03 2.35e-05  3.32e-03     9s
  39   1.58232212e+04  1.62540470e+04  1.18e-03 1.79e-05  2.82e-03     9s
  40   1.59163127e+04  1.62435402e+04  8.63e-04 1.55e-05  2.14e-03     9s
  41   1.59790909e+04  1.62248399e+04  6.42e-04 1.14e-05  1.61e-03     9s
  42   1.60498493e+04  1.62185627e+04  4.06e-04 9.99e-06  1.10e-03    10s
  43   1.60879506e+04  1.62096884e+04  2.76e-04 8.19e-06  7.95e-04    10s
  44   1.60916492e+04  1.62040993e+04  2.62e-04 7.00e-06  7.35e-04    10s
  45   1.61104528e+04  1.62030507e+04  2.01e-04 6.77e-06  6.05e-04    10s
  46   1.61149903e+04  1.61960345e+04  1.86e-04 5.21e-06  5.29e-04    10s
  47   1.61388061e+04  1.61948973e+04  1.03e-04 4.96e-06  3.66e-04    10s
  48   1.61566505e+04  1.61814626e+04  4.43e-05 2.04e-06  1.62e-04    10s
  49   1.61612477e+04  1.61771001e+04  2.95e-05 1.16e-06  1.03e-04    10s
  50   1.61635213e+04  1.61744432e+04  2.28e-05 6.25e-07  7.13e-05    11s
  51   1.61637572e+04  1.61739587e+04  2.20e-05 5.30e-07  6.66e-05    11s
  52   1.61661077e+04  1.61723648e+04  1.51e-05 2.03e-07  4.09e-05    11s
  53   1.61693481e+04  1.61720402e+04  5.10e-06 1.48e-07  1.76e-05    11s
  54   1.61694565e+04  1.61718256e+04  4.80e-06 1.06e-07  1.55e-05    11s
  55   1.61702782e+04  1.61717435e+04  2.58e-06 8.69e-08  9.56e-06    11s
  56   1.61709869e+04  1.61712933e+04  6.33e-07 5.53e-09  2.00e-06    11s
  57   1.61709917e+04  1.61712665e+04  6.19e-07 3.13e-09  1.80e-06    11s
  58   1.61710948e+04  1.61712601e+04  3.61e-07 2.74e-09  1.08e-06    12s
  59   1.61712220e+04  1.61712491e+04  6.30e-07 2.30e-09  1.77e-07    12s
  60   1.61712406e+04  1.61712406e+04  2.37e-09 2.33e-09  2.01e-10    12s

Barrier solved model in 60 iterations and 11.82 seconds (8.74 work units)
Optimal objective 1.61712406e+04


Root crossover log...

   70964 DPushes remaining with DInf 0.0000000e+00                12s
      62 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2695 PPushes remaining with PInf 1.1188364e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.8755507e+00     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36529    1.6171241e+04   0.000000e+00   9.875551e+00     16s
   36576    1.6171241e+04   0.000000e+00   0.000000e+00     16s
   36576    1.6171241e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.617124e+04, 36576 iterations, 11.80 seconds (13.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 16171.2406    0  311 -177247.82 16171.2406   109%     -   16s
H    0     0                    -170943.4194 16171.2406   109%     -   16s
H    0     0                    -145481.8083 16171.2406   111%     -   16s
H    0     0                    -122889.7919 16171.2406   113%     -   17s
H    0     0                    -81394.93149 16171.2406   120%     -   17s
H    0     0                    -40078.86568 16171.2406   140%     -   17s
H    0     0                    -28093.83126 16171.2406   158%     -   17s
H    0     0                    -20813.34668 16171.2406   178%     -   17s
H    0     0                    -20708.95229 16171.2406   178%     -   17s
H    0     0                    -20515.82805 16171.2406   179%     -   18s
H    0     0                    -20334.59249 16171.2406   180%     -   20s
H    0     0                    -20333.51174 16171.2406   180%     -   20s
H    0     0                    -20333.30837 16171.2406   180%     -   20s
H    0     0                    -20224.53542 16171.2406   180%     -   20s
     0     0 11402.6212    0  372 -20224.535 11402.6212   156%     -   57s
     0     0 11293.8675    0  390 -20224.535 11293.8675   156%     -   71s
     0     0 11103.9674    0  382 -20224.535 11103.9674   155%     -   82s
     0     0 11077.9433    0  381 -20224.535 11077.9433   155%     -   85s
     0     0 11077.8093    0  387 -20224.535 11077.8093   155%     -   87s
     0     0 8410.83023    0  456 -20224.535 8410.83023   142%     -  125s
H    0     0                    -14450.77594 8410.83023   158%     -  125s
H    0     0                    -14213.37008 8410.83023   159%     -  125s
H    0     0                    -14127.65913 8410.83023   160%     -  125s
H    0     0                    -14124.04071 8410.83023   160%     -  125s
H    0     0                    -13840.19816 8410.83023   161%     -  125s
     0     0 8263.47360    0  471 -13840.198 8263.47360   160%     -  143s
     0     0 7993.64486    0  481 -13840.198 7993.64486   158%     -  155s
     0     0 7880.04751    0  358 -13840.198 7880.04751   157%     -  165s
     0     0 7814.51615    0  468 -13840.198 7814.51615   156%     -  172s
     0     0 7801.81125    0  367 -13840.198 7801.81125   156%     -  175s
     0     0 7756.70952    0  478 -13840.198 7756.70952   156%     -  182s
     0     0 7719.62009    0  353 -13840.198 7719.62009   156%     -  187s
     0     0 7716.68996    0  355 -13840.198 7716.68996   156%     -  192s
     0     0 7691.26027    0  476 -13840.198 7691.26027   156%     -  197s
     0     0 7687.86424    0  477 -13840.198 7687.86424   156%     -  198s
     0     0 7686.21810    0  471 -13840.198 7686.21810   156%     -  200s
     0     0 7683.30360    0  474 -13840.198 7683.30360   156%     -  201s
     0     0 7683.18894    0  474 -13840.198 7683.18894   156%     -  201s
H    0     0                    -12262.08686 6154.33723   150%     -  252s
H    0     0                    -12224.44183 6154.33723   150%     -  252s
     0     0 6154.33723    0  412 -12224.442 6154.33723   150%     -  252s
H    0     0                    -12196.66834 5400.86533   144%     -  284s
H    0     0                    -12149.99978 5400.86533   144%     -  284s
H    0     0                    -11955.45842 5400.86533   145%     -  284s
H    0     0                    -11898.23281 5400.86533   145%     -  284s
     0     0 5400.86533    0  514 -11898.233 5400.86533   145%     -  284s
     0     0 5138.34422    0  539 -11898.233 5138.34422   143%     -  300s
     0     0 5048.91578    0  526 -11898.233 5048.91578   142%     -  309s
     0     0 5023.22593    0  433 -11898.233 5023.22593   142%     -  315s
     0     0 4977.07577    0  529 -11898.233 4977.07577   142%     -  322s
     0     0 4972.46981    0  441 -11898.233 4972.46981   142%     -  325s
     0     0 4963.11599    0  442 -11898.233 4963.11599   142%     -  328s
     0     0 4962.36257    0  436 -11898.233 4962.36257   142%     -  329s
     0     0 4494.86759    0  445 -11898.233 4494.86759   138%     -  361s
H    0     0                    -11368.54335 4494.79991   140%     -  362s
H    0     0                    -11316.88219 4494.79991   140%     -  362s
     0     0 4257.70403    0  458 -11316.882 4257.70403   138%     -  381s
     0     0 4217.77098    0  459 -11316.882 4217.77098   137%     -  389s
     0     0 4168.74056    0  453 -11316.882 4168.74056   137%     -  397s
     0     0 4143.95057    0  462 -11316.882 4143.95057   137%     -  402s
     0     0 4113.60633    0  461 -11316.882 4113.60633   136%     -  410s
     0     0 4065.82130    0  472 -11316.882 4065.82130   136%     -  421s
     0     0 4021.54468    0  466 -11316.882 4021.54468   136%     -  429s
     0     0 4017.87376    0  462 -11316.882 4017.87376   136%     -  432s
     0     0 4014.67678    0  467 -11316.882 4014.67678   135%     -  435s
H    0     0                    -9864.173323 4006.28645   141%     -  440s
H    0     0                    -9813.794516 4006.28645   141%     -  440s
H    0     0                    -9775.282372 4006.28645   141%     -  440s
     0     0 4006.28645    0  461 -9775.2824 4006.28645   141%     -  440s
     0     0 4001.49520    0  467 -9775.2824 4001.49520   141%     -  443s
     0     0 3987.06314    0  471 -9775.2824 3987.06314   141%     -  447s
H    0     0                    -9769.645174 3962.70722   141%     -  454s
H    0     0                    -9753.681802 3962.70722   141%     -  454s
     0     0 3962.70722    0  448 -9753.6818 3962.70722   141%     -  454s
     0     0 3951.66973    0  459 -9753.6818 3951.66973   141%     -  459s
     0     0 3946.58030    0  456 -9753.6818 3946.58030   140%     -  462s
     0     0 3945.74010    0  459 -9753.6818 3945.74010   140%     -  464s
H    0     0                    -8960.238639 3744.79839   142%     -  485s
H    0     0                    -8855.006320 3744.79839   142%     -  485s
H    0     0                    -8725.411695 3744.79839   143%     -  485s
H    0     0                    -8672.425669 3744.79839   143%     -  485s
H    0     0                    -8607.885064 3744.79839   144%     -  485s
H    0     0                    -8597.878827 3744.79839   144%     -  485s
H    0     0                    -8580.467478 3744.79839   144%     -  485s
     0     0 3744.79839    0  558 -8580.4675 3744.79839   144%     -  485s
H    0     0                    -8483.294973 3744.76851   144%     -  486s
H    0     0                    -8428.338348 3744.76851   144%     -  486s
H    0     0                    -8371.382937 3744.76851   145%     -  486s
H    0     0                    -8288.528623 3744.76851   145%     -  486s
H    0     0                    -8269.067160 3744.76851   145%     -  486s
     0     0 3670.02106    0  550 -8269.0672 3670.02106   144%     -  498s
     0     0 3639.61912    0  552 -8269.0672 3639.61912   144%     -  504s
     0     0 3624.41705    0  470 -8269.0672 3624.41705   144%     -  509s
     0     0 3621.16825    0  574 -8269.0672 3621.16825   144%     -  512s
     0     0 3619.38211    0  487 -8269.0672 3619.38211   144%     -  513s
     0     0 3615.72259    0  476 -8269.0672 3615.72259   144%     -  518s
     0     0 3613.20572    0  480 -8269.0672 3613.20572   144%     -  521s
     0     0 3610.30549    0  487 -8269.0672 3610.30549   144%     -  522s
     0     0 3610.25951    0  489 -8269.0672 3610.25951   144%     -  523s
     0     0 3545.58745    0  634 -8269.0672 3545.58745   143%     -  535s
     0     0 3512.59035    0  582 -8269.0672 3512.59035   142%     -  549s
     0     0 3501.22177    0  586 -8269.0672 3501.22177   142%     -  556s
H    0     0                    -8249.111394 3493.79152   142%     -  559s
H    0     0                    -8236.877762 3493.79152   142%     -  559s
H    0     0                    -8236.619149 3493.79152   142%     -  559s
H    0     0                    -8223.783242 3493.79152   142%     -  559s
     0     0 3493.79152    0  581 -8223.7832 3493.79152   142%     -  559s
     0     0 3490.52521    0  587 -8223.7832 3490.52521   142%     -  562s
     0     0 3482.82796    0  583 -8223.7832 3482.82796   142%     -  564s
     0     0 3479.04758    0  487 -8223.7832 3479.04758   142%     -  565s
     0     0 3478.80649    0  497 -8223.7832 3478.80649   142%     -  566s
     0     0 3436.57987    0  578 -8223.7832 3436.57987   142%     -  578s
     0     0 3425.00207    0  588 -8223.7832 3425.00207   142%     -  582s
     0     0 3420.34965    0  493 -8223.7832 3420.34965   142%     -  585s
     0     0 3418.30626    0  582 -8223.7832 3418.30626   142%     -  587s
     0     0 3417.57422    0  585 -8223.7832 3417.57422   142%     -  588s
     0     0 3388.84348    0  638 -8223.7832 3388.84348   141%     -  597s
H    0     0                    -8181.503808 3387.59324   141%     -  599s
H    0     0                    -8165.544691 3387.59324   141%     -  599s
     0     0 3377.22641    0  497 -8165.5447 3377.22641   141%     -  603s
     0     0 3374.82493    0  500 -8165.5447 3374.82493   141%     -  605s
     0     0 3373.31229    0  491 -8165.5447 3373.31229   141%     -  606s
     0     0 3342.61603    0  496 -8165.5447 3342.61603   141%     -  613s
     0     0 3338.45625    0  506 -8165.5447 3338.45625   141%     -  617s
H    0     0                    -8116.203543 3337.26181   141%     -  618s
H    0     0                    -8092.618144 3337.26181   141%     -  618s
     0     0 3337.26181    0  503 -8092.6181 3337.26181   141%     -  618s
     0     0 3325.16686    0  511 -8092.6181 3325.16686   141%     -  625s
H    0     0                    -8090.195611 3324.94065   141%     -  628s
H    0     0                    -8076.733541 3324.94065   141%     -  629s
     0     0 3319.42885    0  513 -8076.7335 3319.42885   141%     -  635s
     0     0 3316.81620    0  510 -8076.7335 3316.81620   141%     -  638s
     0     0 3315.55346    0  513 -8076.7335 3315.55346   141%     -  639s
H    0     0                    -8070.055175 3306.22834   141%     -  647s
H    0     0                    -8052.508012 3306.22834   141%     -  647s
H    0     0                    -8049.701570 3306.22834   141%     -  647s
H    0     0                    -8035.791856 3306.22834   141%     -  647s
     0     0 3306.22834    0  504 -8035.7919 3306.22834   141%     -  647s
H    0     0                    -8024.990038 3303.66512   141%     -  650s
H    0     0                    -8009.685831 3303.66512   141%     -  650s
     0     0 3303.66512    0  505 -8009.6858 3303.66512   141%     -  650s
     0     0 3301.13555    0  512 -8009.6858 3301.13555   141%     -  654s
     0     0 3299.86368    0  512 -8009.6858 3299.86368   141%     -  656s
     0     0 3293.49421    0  504 -8009.6858 3293.49421   141%     -  661s
H    0     0                    -7977.832206 3292.62835   141%     -  665s
H    0     0                    -7970.201965 3290.49284   141%     -  668s
     0     0 3290.49284    0  514 -7970.2020 3290.49284   141%     -  669s
     0     0 3289.79001    0  518 -7970.2020 3289.79001   141%     -  671s
     0     0 3279.37363    0  521 -7970.2020 3279.37363   141%     -  678s
     0     0 3276.78342    0  516 -7970.2020 3276.78342   141%     -  682s
     0     0 3275.25064    0  524 -7970.2020 3275.25064   141%     -  684s
     0     0 3266.34181    0  513 -7970.2020 3266.34181   141%     -  691s
     0     0 3266.22134    0  513 -7970.2020 3266.22134   141%     -  696s
H    0     0                    -7932.903140 3266.08909   141%     -  767s
H    0     0                    -7900.090773 3266.08909   141%     -  767s
H    0     0                    -7893.883808 3266.08909   141%     -  767s
H    0     0                    -7851.143112 3265.95672   142%     -  853s
H    0     0                    -7562.328121 3265.95672   143%     -  867s
H    0     0                    -7024.884488 3265.95672   146%     -  872s
H    0     0                    -6877.722781 3265.95672   147%     -  872s
H    0     0                    -5900.591320 3265.95672   155%     -  873s
H    0     0                    -5885.231521 3265.95672   155%     -  873s
H    0     0                    -5868.053651 3265.95672   156%     -  874s
H    0     2                    -5686.325386 3265.95672   157%     -  877s
     0     2 3265.95672    0  513 -5686.3254 3265.95672   157%     -  877s
     1     3 2135.18906    1  345 -5686.3254 3265.74668   157% 11888  894s
     2     6 2086.14813    2  333 -5686.3254 3265.74668   157%  8638  902s
     5    12 1625.80384    3  400 -5686.3254 3205.95983   156%  6809  915s
    11    24 1204.90348    4  407 -5686.3254 3107.13284   155%  8322  938s
    23    36  186.02856    4  404 -5686.3254 2963.00293   152% 12268  983s
    35    67 2208.29262    5  390 -5686.3254 2963.00293   152% 10838 1072s
H   46    67                    -5595.544148 2963.00293   153%  9653 1072s
    66   153 1584.65196    6  379 -5595.5441 2887.91743   152% 13383 1108s
   152   183 1280.43736    8  300 -5595.5441 2863.74574   151% 10554 1133s
   184   214 1336.08395    8  357 -5595.5441 2863.74574   151% 10302 1154s
H  186   214                    -5571.965640 2863.74574   151% 10233 1154s
H  187   214                    -5549.960957 2863.74574   152% 10188 1154s
H  203   214                    -5544.391784 2863.74574   152%  9819 1154s
   215   315 -170.86122    9  231 -5544.3918 2863.74574   152% 10166 1178s
   325   338 1089.48897    9  359 -5544.3918 2863.74574   152%  8239 1199s
H  335   338                    -5530.947468 2863.74574   152%  8093 1199s
   363   384 -284.71702   10  233 -5530.9475 2863.74574   152%  7745 1219s
   442   437 -255.13155   10  226 -5530.9475 2863.74574   152%  7297 1235s
   524   474 -822.71981   13  231 -5530.9475 2863.74574   152%  7012 1253s
   605   512 -1335.2321   14  210 -5530.9475 2863.74574   152%  6723 1271s
   675   543 -1770.9919   15  188 -5530.9475 2863.74574   152%  6598 1290s
   743   575 -3192.8387   17  166 -5530.9475 2863.74574   152%  6468 1305s
   805   616 -3423.5764   19  155 -5530.9475 2863.74574   152%  6308 1323s
   880   635 -3400.7728   20  143 -5530.9475 2849.28600   152%  6159 1345s
   912   665 -3777.3307   21  142 -5530.9475 2849.28600   152%  6142 1381s
H  930   665                    -5528.085094 2849.28600   152%  6102 1381s
   964   704 -4820.4164   25  115 -5528.0851 2849.28600   152%  6003 1400s
  1052   732 -918.79131   15  343 -5528.0851 2759.35395   150%  5850 1421s
  1122   761 -3539.9357   26  310 -5528.0851 2759.35395   150%  5785 1443s
  1181   798 -3601.0511   27  318 -5528.0851 2759.35395   150%  5814 1464s
  1234   840 infeasible   28      -5528.0851 2759.35395   150%  5912 1483s
  1289   904 -3784.6338   28  309 -5528.0851 2759.35395   150%  5959 1503s
  1374   979 infeasible   29      -5528.0851 2759.35395   150%  5924 1524s
  1491   997 infeasible   29      -5528.0851 1847.82157   133%  5785 1547s
  1533  1047  679.46059    8  444 -5528.0851 1847.82157   133%  5848 1571s
  1612  1129 -423.94194    9  359 -5528.0851 1847.82157   133%  5842 1593s
  1735  1216 -454.47307   10  355 -5528.0851 1847.82157   133%  5739 1618s
H 1830  1216                    -5527.820792 1847.82157   133%  5653 1618s
  1883  1296 -849.68407   12  367 -5527.8208 1847.82157   133%  5605 1642s
  2024  1384 -953.03472   13  382 -5527.8208 1847.82157   133%  5495 1669s
  2173  1486 -1189.1752   15  392 -5527.8208 1847.82157   133%  5386 1696s
  2325  1587 -1319.8023   17  387 -5527.8208 1847.82157   133%  5290 1723s
  2506  1657 -2088.1441   20  316 -5527.8208 1847.82157   133%  5156 1752s
  2666  1685 -3435.9391   23  176 -5527.8208 1680.20590   130%  5115 1783s
  2762  1753 -4296.8889   24  316 -5527.8208 1680.20590   130%  5099 1813s
  2873  1784 -4334.4782   25  415 -5527.8208 1562.43160   128%  5129 1840s
  2934  1856 -4446.7455   26  426 -5527.8208 1562.43160   128%  5137 1869s
  3059  1932 -4670.0603   29  383 -5527.8208 1278.43126   123%  5132 1902s
  3186  2014 -4890.7094   31  304 -5527.8208 1235.37685   122%  5152 1937s
  3312  2103 -5213.1086   34  294 -5527.8208 1080.57020   120%  5210 1971s
  3458  2189 infeasible   38      -5527.8208 1080.57020   120%  5255 2008s
  3616  2207 -1937.7535    9  429 -5527.8208 1043.59193   119%  5306 2040s
  3658  2229 -2274.2358   10  514 -5527.8208  901.17718   116%  5361 2077s
  3720  2272 -2310.8780   11  522 -5527.8208  901.17718   116%  5375 2113s
  3815  2305 -3091.5245   14  498 -5527.8208  901.17718   116%  5416 2151s
  3892  2380 -3975.7603   12  524 -5527.8208  892.44979   116%  5458 2193s
  4076  2447 -4139.8667   13  527 -5527.8208  892.44979   116%  5450 2240s
  4257  2566 -4546.7354   16  414 -5527.8208  812.16100   115%  5497 2289s
  4463  2567 -4577.2192   27  513 -5527.8208  741.04410   113%  5525 2434s
  4465  2568 -4342.5692   15  320 -5527.8208  741.04410   113%  5522 2454s
  4466  2569 -4885.6016   44  362 -5527.8208  741.04410   113%  5521 2527s
  4467  2570 -4143.8028   28  529 -5527.8208  741.04410   113%  5520 2592s
  4468  2570 -2744.6200   18  462 -5527.8208  741.04410   113%  5519 2635s
  4469  2571 -3761.1371   42  485 -5527.8208  741.04410   113%  5518 2664s
  4470  2572 -4300.7623   41  485 -5527.8208  741.04410   113%  5516 2694s
  4471  2572 -4675.3093   14  488 -5527.8208  741.04410   113%  5515 2717s
  4472  2573 -1052.4788   15  481 -5527.8208  741.04410   113%  5514 2729s
  4473  2574 -3419.6261   22  488 -5527.8208  741.04410   113%  5513 2737s
  4474  2574 -5121.9731   16  487 -5527.8208  741.04410   113%  5511 2744s
  4475  2575 -3979.6743   32  489 -5527.8208  741.04410   113%  5510 2750s
  4476  2576 -3725.5130   10  507 -5527.8208  741.04410   113%  5509 2757s
  4477  2576 -4597.7693   33  506 -5527.8208  741.04410   113%  5508 2768s
  4478  2577 -4120.0211   20  498 -5527.8208  741.04410   113%  5506 2775s
  4479  2578 -4854.5926   53  500 -5527.8208  741.04410   113%  5505 2783s
  4480  2578 -4102.4175   19  614 -5527.8208  741.04410   113%  5504 2804s
  4481  2579 -2467.6367   16  505 -5527.8208  741.04410   113%  5503 2815s
  4482  2580 -4453.3944   17  512 -5527.8208  741.04410   113%  5502 2822s
  4483  2580 -1207.2593    8  501 -5527.8208  741.04410   113%  5500 2829s
  4484  2581 -4234.8966   16  493 -5527.8208  741.04410   113%  5499 2851s
  4485  2582 -3470.0642   30  489 -5527.8208  741.04410   113%  5498 2860s
  4486  2582 -4850.9534   21  575 -5527.8208  741.04410   113%  5497 2880s
  4487  2583 -2412.8719   12  483 -5527.8208  741.04410   113%  5495 2888s
  4488  2584 -4211.2666   35  500 -5527.8208  741.04410   113%  5494 2903s
  4489  2584 -3797.8679   10  516 -5527.8208  741.04410   113%  5493 2913s
  4490  2585 -3903.7328   37  500 -5527.8208  741.04410   113%  5492 2931s
  4491  2586 -4958.1536   17  505 -5527.8208  741.04410   113%  5491 2941s
  4492  2586 -5120.7629   31  506 -5527.8208  741.04410   113%  5489 2951s
  4493  2587 -3888.1653   19  507 -5527.8208  741.04410   113%  5488 2971s
  4494  2588 -4976.6459   32  504 -5527.8208  741.04410   113%  5487 2982s
  4495  2588 -3243.5928   24  504 -5527.8208  741.04410   113%  5486 2990s
  4496  2589 -4469.4141   22  585 -5527.8208  741.04410   113%  5484 3009s
  4497  2590 -3822.6797   41  507 -5527.8208  741.04410   113%  5483 3019s
  4498  2590 -3160.8826   33  513 -5527.8208  741.04410   113%  5482 3037s
  4499  2591 -3879.0133   19  513 -5527.8208  741.04410   113%  5481 3066s
  4500  2592 -3527.2945   18  513 -5527.8208  741.04410   113%  5480 3154s
  4501  2594  741.04410   16  467 -5527.8208  741.04410   113%  5558 3190s
  4502  2596  741.04410   17  486 -5527.8208  741.04410   113%  5559 3211s
  4504  2600  741.04410   17  466 -5527.8208  741.04410   113%  5561 3245s
  4509  2609  741.04410   18  452 -5527.8208  741.04410   113%  5562 3273s
  4519  2623  741.04410   19  446 -5527.8208  741.04410   113%  5571 3319s
  4539  2627  -77.73673   21  481 -5527.8208  741.04410   113%  5604 3382s
  4551  2644 -2052.8213   21  284 -5527.8208  741.04410   113%  5646 3441s
  4574  2704 -2397.2427   22  275 -5527.8208  741.04410   113%  5657 3503s
  4642  2742 -3557.0801   27  258 -5527.8208  741.04410   113%  5668 3540s
  4716  2752 -5274.8875   32  245 -5527.8208  741.04410   113%  5636 3579s
  4795  2732 -4610.9874   26  192 -5527.8208  741.04410   113%  5611 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 14
  Projected implied bound: 391
  MIR: 1081
  Mixing: 1
  Flow cover: 1498
  Zero half: 1
  RLT: 25
  Relax-and-lift: 186

Explored 4846 nodes (27537433 simplex iterations) in 3600.08 seconds (5904.27 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5527.82 -5528.09 -5530.95 ... -5885.23

Time limit reached
Best objective -5.527820791647e+03, best bound 7.410441011880e+02, gap 113.4057%
  WARNING: Time limit reached. Using best solution found (gap: 113.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -5527.82, θ = 120476.09
  Upper Bound (UB) = -5527.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120476.09
  [DEBUG]   ✓ Scenario 0: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120476.09 ≤ Q = 120476.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120476.09 ≤ Q = 120476.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120476.09 ≤ Q = 120476.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4615471c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb9eab8e4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373420e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6459086.7798
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.437453e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143745.27    0  124 6459086.78 -143745.27   102%     -    0s
H    0     0                    -109994.9265 -143745.27  30.7%     -    0s
H    0     0                    -110980.6617 -143745.27  29.5%     -    0s
     0     0 -119523.58    0  125 -110980.66 -119523.58  7.70%     -    0s
H    0     0                    -114167.9428 -119377.90  4.56%     -    0s
     0     0 -118689.35    0   85 -114167.94 -118689.35  3.96%     -    0s
H    0     0                    -115104.1032 -118658.85  3.09%     -    0s
H    0     0                    -115657.4548 -118658.85  2.60%     -    0s
H    0     0                    -115789.6661 -118454.93  2.30%     -    0s
H    0     0                    -116053.8709 -118454.93  2.07%     -    0s
     0     0 -118454.93    0   85 -116053.87 -118454.93  2.07%     -    0s
     0     0 -118440.22    0   85 -116053.87 -118440.22  2.06%     -    0s
H    0     0                    -116395.9207 -118440.22  1.76%     -    0s
H    0     0                    -116660.1254 -118440.22  1.53%     -    0s
     0     2 -118440.22    0   85 -116660.13 -118440.22  1.53%     -    0s
H   35    35                    -116681.1368 -117986.23  1.12%   7.9    0s
*  639   199              24    -116683.5522 -117409.32  0.62%   5.1    0s
*  795   266              24    -116715.5865 -117409.32  0.59%   4.8    0s
*  813   266              29    -116734.8223 -117409.32  0.58%   4.8    0s
*  864   266              28    -116759.4996 -117409.32  0.56%   4.7    0s
*  927   280              33    -116761.1052 -117388.09  0.54%   4.6    0s
* 1291   347              25    -116770.8944 -117262.34  0.42%   4.2    0s
* 1513   347              30    -116780.3761 -117239.68  0.39%   4.1    0s
* 1543   347              25    -116802.9286 -117239.68  0.37%   4.1    0s
* 1584   356              28    -116825.8676 -117239.68  0.35%   4.1    0s

Cutting planes:
  Gomory: 54
  MIR: 209
  RLT: 6
  Relax-and-lift: 3

Explored 2543 nodes (12063 simplex iterations) in 0.35 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -116826 -116803 -116780 ... -116681
No other solutions better than -116826

Optimal solution found (tolerance 1.00e-06)
Best objective -1.168258676136e+05, best bound -1.168258676136e+05, gap 0.0000%
  Subproblem solved in 0.38s
  Worst-case operational profit (Z_SP) = 116191.28
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116825.87
  [DEBUG]   S×d_nominal = 233017.14
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233017.14 + -116825.87 = 116191.28
  [DEBUG]   Current θ from Master = 120476.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4284.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9812.63
  Lower Bound (LB) = -9019.87
  Gap (UB-LB) = 3492.0479, Absolute Gap = 3492.0479, Relative Gap = 0.631722
  Not converged yet (gap = 3492.05 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x6c45db07
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 3.04s
Presolved: 91803 rows, 39330 columns, 558577 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -399313.8049
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 645
 AA' NZ     : 3.025e+06
 Factor NZ  : 7.029e+06 (roughly 100 MB of memory)
 Factor Ops : 1.284e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80788825e+07  1.81793227e+08  1.02e+05 1.87e+01  8.24e+04     5s
   1  -1.37432772e+07  1.57689823e+08  7.12e+04 6.82e+01  5.73e+04     5s
   2  -4.38287966e+06  1.19168983e+08  2.22e+04 7.38e-01  1.87e+04     5s
   3  -8.64941491e+05  8.02051413e+07  1.92e+03 1.05e+00  1.98e+03     5s
   4  -5.10533512e+05  3.35772708e+07  4.21e+02 1.85e-01  4.97e+02     5s
   5  -3.91937447e+05  2.28766835e+07  1.64e+02 1.11e-01  2.45e+02     5s
   6  -3.04001540e+05  1.56973608e+07  6.62e+01 6.96e-02  1.33e+02     5s
   7  -1.98703681e+05  1.15875049e+07  2.41e+01 4.86e-02  8.16e+01     5s
   8  -1.32600304e+05  5.75867037e+06  1.14e+01 2.21e-02  3.83e+01     5s
   9  -7.94706523e+04  1.59525475e+06  3.07e+00 4.95e-03  1.03e+01     5s
  10  -4.53655069e+04  5.38036720e+05  1.51e+00 1.48e-03  3.53e+00     6s
  11  -3.56773813e+04  3.31597982e+05  1.16e+00 9.33e-04  2.21e+00     6s
  12  -2.75630853e+04  1.98069853e+05  7.79e-01 6.02e-04  1.35e+00     6s
  13  -1.89787078e+04  1.24660323e+05  5.04e-01 6.55e-04  8.59e-01     6s
  14  -1.37682586e+04  7.69694112e+04  3.81e-01 7.09e-04  5.42e-01     6s
  15  -1.03333852e+04  6.33182219e+04  3.28e-01 1.68e-03  4.40e-01     6s
  16  -6.26777424e+03  4.85803076e+04  2.67e-01 1.60e-03  3.27e-01     6s
  17  -2.27249292e+03  3.87243182e+04  2.16e-01 1.18e-03  2.45e-01     6s
  18   1.79444686e+03  3.19198119e+04  1.67e-01 1.74e-03  1.80e-01     6s
  19   4.18106674e+03  2.64745250e+04  1.41e-01 1.99e-03  1.33e-01     6s
  20   6.58751343e+03  2.47614819e+04  1.14e-01 1.57e-03  1.08e-01     6s
  21   8.63748040e+03  2.33023707e+04  9.17e-02 1.51e-03  8.75e-02     6s
  22   1.01245200e+04  2.22760776e+04  7.46e-02 1.23e-03  7.25e-02     6s
  23   1.10001622e+04  2.13670243e+04  6.33e-02 1.37e-03  6.18e-02     7s
  24   1.26450523e+04  2.05222161e+04  4.62e-02 1.17e-03  4.70e-02     7s
  25   1.31610683e+04  1.93735910e+04  4.05e-02 1.04e-03  3.70e-02     7s
  26   1.38087691e+04  1.90146960e+04  3.40e-02 1.40e-03  3.10e-02     7s
  27   1.40977710e+04  1.86460879e+04  3.11e-02 1.55e-03  2.71e-02     7s
  28   1.45859135e+04  1.83809788e+04  2.57e-02 1.40e-03  2.26e-02     7s
  29   1.50342314e+04  1.80964694e+04  2.09e-02 1.12e-03  1.83e-02     7s
  30   1.52036863e+04  1.78916278e+04  1.91e-02 8.63e-04  1.60e-02     7s
  31   1.54902708e+04  1.77296975e+04  1.61e-02 8.04e-04  1.34e-02     7s
  32   1.59478844e+04  1.75956570e+04  1.15e-02 5.74e-04  9.83e-03     7s
  33   1.61135989e+04  1.75311541e+04  9.80e-03 5.44e-04  8.45e-03     7s
  34   1.63556796e+04  1.74060017e+04  7.34e-03 4.10e-04  6.26e-03     8s
  35   1.64421382e+04  1.73380964e+04  6.49e-03 3.03e-04  5.34e-03     8s
  36   1.65771922e+04  1.72647123e+04  5.13e-03 2.05e-04  4.10e-03     8s
  37   1.67142925e+04  1.72280319e+04  3.78e-03 1.48e-04  3.06e-03     8s
  38   1.67840177e+04  1.72069037e+04  3.11e-03 1.16e-04  2.52e-03     8s
  39   1.68472322e+04  1.71695883e+04  2.50e-03 1.56e-04  1.92e-03     8s
  40   1.68996218e+04  1.71607143e+04  2.00e-03 1.30e-04  1.56e-03     8s
  41   1.70044774e+04  1.71401743e+04  1.01e-03 6.54e-05  8.09e-04     8s
  42   1.70794674e+04  1.71357868e+04  3.50e-04 4.80e-05  3.36e-04     8s
  43   1.70811711e+04  1.71335315e+04  3.34e-04 4.11e-05  3.12e-04     8s
  44   1.70855045e+04  1.71304123e+04  2.97e-04 3.14e-05  2.68e-04     9s
  45   1.70870970e+04  1.71294600e+04  2.83e-04 2.80e-05  2.53e-04     9s
  46   1.70983260e+04  1.71254124e+04  1.87e-04 1.49e-05  1.61e-04     9s
  47   1.71093450e+04  1.71215199e+04  8.99e-05 2.94e-06  7.26e-05     9s
  48   1.71156534e+04  1.71209282e+04  3.67e-05 1.68e-06  3.14e-05     9s
  49   1.71169935e+04  1.71204826e+04  2.52e-05 6.39e-07  2.08e-05     9s
  50   1.71193020e+04  1.71204049e+04  6.68e-06 4.29e-07  6.57e-06     9s
  51   1.71202032e+04  1.71202152e+04  5.26e-08 3.17e-07  7.14e-08     9s
  52   1.71202117e+04  1.71202131e+04  9.68e-08 1.21e-07  8.59e-09     9s
  53   1.71202131e+04  1.71202131e+04  1.14e-08 1.31e-08  9.63e-11    10s

Barrier solved model in 53 iterations and 9.50 seconds (7.81 work units)
Optimal objective 1.71202131e+04


Root crossover log...

   76855 DPushes remaining with DInf 0.0000000e+00                10s
   26133 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    3006 PPushes remaining with PInf 2.0923119e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3305475e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34871    1.7120213e+04   0.000000e+00   0.000000e+00     12s
   34871    1.7120213e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.712021e+04, 34871 iterations, 8.13 seconds (8.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 17120.2131    0  329 -177247.82 17120.2131   110%     -   12s
H    0     0                    -166737.1316 17120.2131   110%     -   13s
H    0     0                    -154317.5625 17120.2131   111%     -   13s
H    0     0                    -152756.6674 17120.2131   111%     -   13s
H    0     0                    -152393.4538 17120.2131   111%     -   13s
H    0     0                    -94395.52617 17120.2131   118%     -   13s
H    0     0                    -54529.82354 17120.2131   131%     -   13s
H    0     0                    -46985.62386 17120.2131   136%     -   13s
H    0     0                    -43370.03161 17120.2131   139%     -   13s
H    0     0                    -38428.77432 17120.2131   145%     -   14s
H    0     0                    -38391.58425 17120.2131   145%     -   14s
H    0     0                    -38312.57848 17120.2131   145%     -   14s
H    0     0                    -38300.62234 17120.2131   145%     -   14s
H    0     0                    -38252.04426 17120.2131   145%     -   14s
H    0     0                    -38251.08847 17120.2131   145%     -   14s
H    0     0                    -29035.62049 17120.2131   159%     -   15s
H    0     0                    -24861.14879 17120.2131   169%     -   15s
H    0     0                    -24346.91170 17120.2131   170%     -   15s
H    0     0                    -24337.10007 17120.2131   170%     -   15s
H    0     0                    -24241.09434 17120.2131   171%     -   15s
H    0     0                    -23885.44669 17120.2131   172%     -   15s
H    0     0                    -23589.40670 17120.2131   173%     -   16s
H    0     0                    -23579.26947 17120.2131   173%     -   16s
H    0     0                    -23574.35027 17120.2131   173%     -   16s
H    0     0                    -23563.97182 17120.2131   173%     -   16s
H    0     0                    -23323.58963 17120.2131   173%     -   16s
H    0     0                    -23254.68120 17120.2131   174%     -   16s
H    0     0                    -23243.91682 17120.2131   174%     -   16s
H    0     0                    -23003.92056 17120.2131   174%     -   16s
     0     0 11864.1448    0  422 -23003.921 11864.1448   152%     -   57s
H    0     0                    -22338.54223 11864.1448   153%     -   57s
H    0     0                    -22314.54492 11864.1448   153%     -   57s
     0     0 11383.9146    0  396 -22314.545 11383.9146   151%     -   81s
     0     0 11174.3998    0  414 -22314.545 11174.3998   150%     -   92s
     0     0 11145.3619    0  414 -22314.545 11145.3619   150%     -   96s
     0     0 11104.4411    0  423 -22314.545 11104.4411   150%     -  107s
     0     0 11069.6853    0  412 -22314.545 11069.6853   150%     -  117s
     0     0 11064.5389    0  414 -22314.545 11064.5389   150%     -  120s
     0     0 11061.2972    0  411 -22314.545 11061.2972   150%     -  122s
     0     0 11061.1353    0  411 -22314.545 11061.1353   150%     -  123s
     0     0 8872.37717    0  572 -22314.545 8872.37717   140%     -  181s
H    0     0                    -14197.18508 8872.27816   162%     -  182s
H    0     0                    -14123.00496 8872.27816   163%     -  182s
     0     0 8213.98332    0  585 -14123.005 8213.98332   158%     -  207s
     0     0 8089.15021    0  554 -14123.005 8089.15021   157%     -  225s
     0     0 7941.30854    0  587 -14123.005 7941.30854   156%     -  249s
     0     0 7822.69601    0  571 -14123.005 7822.69601   155%     -  265s
     0     0 7743.23132    0  569 -14123.005 7743.23132   155%     -  279s
H    0     0                    -11552.17352 7710.22532   167%     -  290s
H    0     0                    -11544.07684 7710.22532   167%     -  290s
H    0     0                    -11532.82427 7710.22532   167%     -  290s
H    0     0                    -11502.59165 7710.22532   167%     -  290s
H    0     0                    -11483.24240 7710.22532   167%     -  290s
H    0     0                    -11450.49339 7710.22532   167%     -  290s
H    0     0                    -11442.39670 7710.22532   167%     -  290s
     0     0 7710.22532    0  576 -11442.397 7710.22532   167%     -  290s
     0     0 7698.63345    0  563 -11442.397 7698.63345   167%     -  295s
     0     0 7696.15557    0  561 -11442.397 7696.15557   167%     -  298s
     0     0 7695.60783    0  567 -11442.397 7695.60783   167%     -  299s
H    0     0                    -11435.13359 6337.06700   155%     -  373s
     0     0 6337.06700    0  517 -11435.134 6337.06700   155%     -  373s
     0     0 5907.85672    0  543 -11435.134 5907.85672   152%     -  407s
     0     0 5705.61590    0  447 -11435.134 5705.61590   150%     -  432s
     0     0 5630.75056    0  556 -11435.134 5630.75056   149%     -  452s
     0     0 5501.76438    0  546 -11435.134 5501.76438   148%     -  473s
     0     0 5295.84583    0  611 -11435.134 5295.84583   146%     -  492s
     0     0 5165.77450    0  613 -11435.134 5165.77450   145%     -  511s
     0     0 5088.26023    0  621 -11435.134 5088.26023   144%     -  528s
     0     0 5067.17250    0  629 -11435.134 5067.17250   144%     -  538s
     0     0 5059.61976    0  621 -11435.134 5059.61976   144%     -  542s
     0     0 5057.53616    0  640 -11435.134 5057.53616   144%     -  546s
     0     0 5043.84178    0  620 -11435.134 5043.84178   144%     -  549s
     0     0 5034.61518    0  625 -11435.134 5034.61518   144%     -  554s
H    0     0                    -9347.232303 5032.49048   154%     -  557s
H    0     0                    -9213.650855 5032.49048   155%     -  557s
     0     0 5032.49048    0  618 -9213.6509 5032.49048   155%     -  557s
H    0     0                    -9163.148600 5031.54429   155%     -  558s
     0     0 5031.54429    0  618 -9163.1486 5031.54429   155%     -  558s
H    0     0                    -9128.566623 5031.54429   155%     -  571s
H    0     0                    -9056.099369 5031.54429   156%     -  571s
H    0     0                    -8952.311614 5031.54429   156%     -  571s
H    0     0                    -8929.122584 5031.54429   156%     -  571s
H    0     0                    -8917.517984 5031.54429   156%     -  571s
H    0     0                    -8916.179411 4422.62761   150%     -  620s
H    0     0                    -8613.124305 4422.62761   151%     -  620s
H    0     0                    -8548.552019 4422.62761   152%     -  620s
H    0     0                    -8450.683057 4422.62761   152%     -  620s
H    0     0                    -8447.609116 4422.62761   152%     -  620s
H    0     0                    -8440.900848 4422.62761   152%     -  620s
H    0     0                    -8424.384447 4422.62761   152%     -  620s
H    0     0                    -8424.084893 4422.62761   152%     -  620s
H    0     0                    -8422.434026 4422.62761   153%     -  620s
H    0     0                    -8400.967445 4422.62761   153%     -  620s
H    0     0                    -8399.915719 4422.62761   153%     -  620s
H    0     0                    -8396.400931 4422.62761   153%     -  620s
     0     0 4422.62761    0  528 -8396.4009 4422.62761   153%     -  620s
H    0     0                    -8378.163814 4422.14301   153%     -  621s
H    0     0                    -8349.550516 4422.14301   153%     -  621s
     0     0 4266.66970    0  571 -8349.5505 4266.66970   151%     -  647s
     0     0 4176.89377    0  473 -8349.5505 4176.89377   150%     -  665s
     0     0 4141.10407    0  581 -8349.5505 4141.10407   150%     -  683s
     0     0 4126.19296    0  478 -8349.5505 4126.19296   149%     -  691s
     0     0 4111.68564    0  557 -8349.5505 4111.68564   149%     -  700s
     0     0 4089.63737    0  636 -8349.5505 4089.63737   149%     -  709s
     0     0 4074.88798    0  553 -8349.5505 4074.88798   149%     -  717s
     0     0 4072.45678    0  564 -8349.5505 4072.45678   149%     -  721s
     0     0 4070.50391    0  561 -8349.5505 4070.50391   149%     -  724s
H    0     0                    -8347.911281 3953.68676   147%     -  741s
H    0     0                    -8337.739562 3953.68676   147%     -  741s
H    0     0                    -8267.416719 3953.68676   148%     -  741s
     0     0 3953.68676    0  472 -8267.4167 3953.68676   148%     -  741s
     0     0 3893.33867    0  478 -8267.4167 3893.33867   147%     -  754s
     0     0 3874.37285    0  484 -8267.4167 3874.37285   147%     -  763s
     0     0 3862.42782    0  483 -8267.4167 3862.42782   147%     -  769s
     0     0 3790.59406    0  472 -8267.4167 3790.59406   146%     -  781s
     0     0 3783.40412    0  475 -8267.4167 3783.40412   146%     -  785s
     0     0 3781.46406    0  479 -8267.4167 3781.46406   146%     -  788s
     0     0 3781.24687    0  477 -8267.4167 3781.24687   146%     -  789s
     0     0 3685.02738    0  637 -8267.4167 3685.02738   145%     -  805s
     0     0 3685.02738    0  637 -8267.4167 3685.02738   145%     -  806s
H    0     0                    -8259.830935 3684.34673   145%     -  807s
H    0     0                    -8254.435609 3684.34673   145%     -  807s
H    0     0                    -8248.336118 3684.34673   145%     -  807s
H    0     0                    -8247.355080 3684.34673   145%     -  807s
H    0     0                    -8238.516454 3684.34673   145%     -  807s
     0     0 3663.35722    0  642 -8238.5165 3663.35722   144%     -  814s
     0     0 3653.78989    0  477 -8238.5165 3653.78989   144%     -  819s
     0     0 3649.79609    0  485 -8238.5165 3649.79609   144%     -  824s
     0     0 3640.78358    0  492 -8238.5165 3640.78358   144%     -  829s
     0     0 3638.88150    0  492 -8238.5165 3638.88150   144%     -  835s
     0     0 3582.91224    0  477 -8238.5165 3582.91224   143%     -  850s
     0     0 3572.44035    0  641 -8238.5165 3572.44035   143%     -  858s
     0     0 3558.46085    0  486 -8238.5165 3558.46085   143%     -  863s
     0     0 3556.77900    0  493 -8238.5165 3556.77900   143%     -  867s
     0     0 3532.32564    0  575 -8238.5165 3532.32564   143%     -  880s
     0     0 3525.81220    0  486 -8238.5165 3525.81220   143%     -  886s
H    0     0                    -8215.239264 3514.14989   143%     -  898s
     0     0 3514.14989    0  659 -8215.2393 3514.14989   143%     -  898s
     0     0 3510.55097    0  650 -8215.2393 3510.55097   143%     -  909s
     0     0 3509.28547    0  488 -8215.2393 3509.28547   143%     -  912s
     0     0 3486.51461    0  655 -8215.2393 3486.51461   142%     -  929s
H    0     0                    -8214.977068 3486.29013   142%     -  929s
     0     0 3479.13844    0  676 -8214.9771 3479.13844   142%     -  941s
     0     0 3474.66764    0  683 -8214.9771 3474.66764   142%     -  947s
     0     0 3473.24951    0  679 -8214.9771 3473.24951   142%     -  950s
     0     0 3456.87042    0  496 -8214.9771 3456.87042   142%     -  964s
H    0     0                    -8194.214057 3456.80802   142%     -  965s
     0     0 3445.85712    0  508 -8194.2141 3445.85712   142%     -  980s
     0     0 3441.42443    0  681 -8194.2141 3441.42443   142%     -  989s
     0     0 3439.93080    0  444 -8194.2141 3439.93080   142%     -  992s
     0     0 3363.81138    0  549 -8194.2141 3363.81138   141%     - 1012s
     0     0 3346.18066    0  493 -8194.2141 3346.18066   141%     - 1029s
     0     0 3315.95644    0  508 -8194.2141 3315.95644   140%     - 1041s
     0     0 3304.61467    0  499 -8194.2141 3304.61467   140%     - 1050s
     0     0 3300.67764    0  511 -8194.2141 3300.67764   140%     - 1053s
     0     0 3296.79979    0  647 -8194.2141 3296.79979   140%     - 1061s
     0     0 3282.37432    0  519 -8194.2141 3282.37432   140%     - 1068s
     0     0 3274.75553    0  520 -8194.2141 3274.75553   140%     - 1075s
     0     0 3271.17017    0  507 -8194.2141 3271.17017   140%     - 1081s
H    0     0                    -8115.241857 3269.55938   140%     - 1087s
H    0     0                    -8109.904814 3269.55938   140%     - 1087s
     0     0 3269.55938    0  578 -8109.9048 3269.55938   140%     - 1088s
     0     0 3247.41189    0  573 -8109.9048 3247.41189   140%     - 1102s
     0     0 3239.80243    0  517 -8109.9048 3239.80243   140%     - 1110s
     0     0 3226.72606    0  507 -8109.9048 3226.72606   140%     - 1118s
     0     0 3222.71151    0  509 -8109.9048 3222.71151   140%     - 1126s
     0     0 3220.16126    0  606 -8109.9048 3220.16126   140%     - 1131s
     0     0 3218.99183    0  520 -8109.9048 3218.99183   140%     - 1133s
     0     0 3208.85788    0  507 -8109.9048 3208.85788   140%     - 1146s
H    0     0                    -8106.783439 3208.85176   140%     - 1147s
     0     0 3206.09817    0  514 -8106.7834 3206.09817   140%     - 1151s
     0     0 3195.15229    0  606 -8106.7834 3195.15229   139%     - 1160s
     0     0 3188.74163    0  519 -8106.7834 3188.74163   139%     - 1167s
     0     0 3186.98494    0  517 -8106.7834 3186.98494   139%     - 1171s
     0     0 3179.26590    0  612 -8106.7834 3179.26590   139%     - 1181s
     0     0 3177.22726    0  528 -8106.7834 3177.22726   139%     - 1188s
     0     0 3169.80757    0  602 -8106.7834 3169.80757   139%     - 1196s
     0     0 3163.13600    0  597 -8106.7834 3163.13600   139%     - 1206s
     0     0 3162.23507    0  609 -8106.7834 3162.23507   139%     - 1212s
     0     0 3157.62049    0  521 -8106.7834 3157.62049   139%     - 1219s
H    0     0                    -8100.979337 3157.04413   139%     - 1220s
     0     0 3156.43257    0  525 -8100.9793 3156.43257   139%     - 1225s
     0     0 3153.50651    0  528 -8100.9793 3153.50651   139%     - 1234s
     0     0 3153.50168    0  528 -8100.9793 3153.50168   139%     - 1239s
H    0     0                    -8061.610564 3153.50168   139%     - 1325s
H    0     0                    -6352.106242 3153.50168   150%     - 1338s
H    0     2                    -6198.815562 3153.50168   151%     - 1340s
     0     2 3153.50168    0  528 -6198.8156 3153.50168   151%     - 1340s
     1     3 2547.61189    1  471 -6198.8156 3153.46253   151% 10483 1359s
     2     4 3050.37818    1  632 -6198.8156 3050.37818   149%  9432 1373s
     3     6 2987.51619    2  619 -6198.8156 3049.53936   149%  8953 1393s
     5    11 1042.76760    3  465 -6198.8156 3049.53936   149%  8862 1425s
    10    21  874.58773    4  459 -6198.8156 2987.29576   148%  9000 1458s
    20    31 1758.65858    4  466 -6198.8156 2878.26865   146% 13913 1513s
H   30    61                    -6155.469356 2515.57226   141% 12594 1919s
H   34    61                    -6000.498544 2515.57226   142% 12807 1919s
H   34    61                    -5925.363789 2515.57226   142% 12807 1919s
    60    93 1360.80537    6  455 -5925.3638 2515.57226   142% 21925 1961s
H   92   162                    -5889.055131 2515.57226   143% 20789 2035s
H   94   162                    -5869.514727 2515.57226   143% 20518 2035s
H   95   162                    -5807.694992 2515.57226   143% 20406 2035s
H  101   162                    -5635.338693 2515.57226   145% 19650 2035s
   161   235  716.10869    8  364 -5635.3387 2515.57226   145% 15394 2086s
H  234   325                    -5624.700569 2515.57226   145% 12671 2128s
   324   398  940.27535   10  454 -5624.7006 2515.57226   145% 10590 2164s
   397   433   94.69208   16  499 -5624.7006 2515.57226   145%  9545 2191s
   434   493  631.03703   12  441 -5624.7006 2515.57226   145%  9398 2222s
H  452   493                    -5620.986940 2515.57226   145%  9191 2222s
   496   524  618.27149   13  434 -5620.9869 2515.57226   145%  9001 2248s
   527   557 -323.15547   14  309 -5620.9869 2515.57226   145%  8837 2274s
   562   589 -358.27492   15  299 -5620.9869 2515.57226   145%  8727 2304s
H  595   589                    -5619.832933 2515.57226   145%  8487 2304s
   606   610 -460.98293   16  374 -5619.8329 2515.57226   145%  8468 2354s
   639   673 -1232.7910   17  357 -5619.8329 2515.57226   145%  8502 2384s
   712   728 -1705.7472   18  329 -5619.8329 2515.57226   145%  8428 2410s
   798   758 -2873.0136   20  312 -5619.8329 2515.57226   145%  8313 2435s
   873   773 -5216.6663   22   67 -5619.8329 2515.57226   145%  8146 2464s
   946   779 -5298.8620   27   35 -5619.8329 2515.57226   145%  7982 2490s
  1020   806 infeasible   33      -5619.8329 2515.57226   145%  7874 2520s
  1091   845 -1735.3629    8  444 -5619.8329 2515.57226   145%  7908 2550s
  1184   883 -1775.9267    9  461 -5619.8329 2515.57226   145%  7779 2581s
  1270   931 -1924.1553   11  459 -5619.8329 2515.57226   145%  7690 2614s
  1371   988 -2241.3465   13  435 -5619.8329 2515.57226   145%  7580 2646s
  1495  1042 -2670.1909   16  423 -5619.8329 2515.57226   145%  7488 2681s
  1615  1071 -3041.1101   18  424 -5619.8329 2515.57226   145%  7417 2715s
  1700  1113 -3189.0050   20  444 -5619.8329 2515.57226   145%  7335 2750s
  1795  1146 infeasible   21      -5619.8329 2515.57226   145%  7351 2781s
  1860  1173 infeasible   23      -5619.8329 1855.18513   133%  7334 2820s
  1941  1194  919.02252    6  354 -5619.8329 1855.00514   133%  7343 2850s
  1984  1218 -682.02708    7  255 -5619.8329 1855.00514   133%  7445 2884s
  2037  1251 -761.49676    8  265 -5619.8329 1855.00514   133%  7476 2921s
H 2048  1251                    -5560.653226 1855.00514   133%  7472 2921s
H 2134  1327                    -5547.208910 1548.05528   128%  7473 2963s
  2290  1407 -3342.0993   12  131 -5547.2089 1548.05528   128%  7444 3007s
  2462  1488 -5533.3450   25   25 -5547.2089 1548.05528   128%  7361 3051s
  2648  1563 -568.86395   10  356 -5547.2089 1548.05528   128%  7276 3097s
  2820  1628 -1135.7561   13  266 -5547.2089 1548.05528   128%  7246 3144s
  2971  1678 -2768.6329   16  616 -5547.2089 1548.05528   128%  7294 3193s
  3121  1711 -3683.5309   17  411 -5547.2089 1538.07503   128%  7347 3240s
  3188  1767 -3915.3350   18  425 -5547.2089 1538.07503   128%  7399 3292s
  3359  1845 -4403.9913   20  430 -5547.2089 1538.07503   128%  7366 3348s
  3537  1909 -5491.9326   30  381 -5547.2089  574.61710   110%  7385 3409s
  3735  1937 -502.42773   11  451 -5547.2089  521.71681   109%  7401 3464s
  3869  2003 -645.46818   12  442 -5547.2089  521.71681   109%  7392 3529s
  4015  2083 -1085.3032   15  527 -5547.2089  521.71681   109%  7447 3592s
  4224  2079 -4229.7132   12  229 -5547.2089  411.29261   107%  7415 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 94
  MIR: 2212
  Flow cover: 2771
  Zero half: 4
  RLT: 123
  Relax-and-lift: 585

Explored 4261 nodes (32195160 simplex iterations) in 3600.06 seconds (5733.94 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5547.21 -5560.65 -5619.83 ... -5925.36

Time limit reached
Best objective -5.547208910034e+03, best bound 4.112926146035e+02, gap 107.4144%
  WARNING: Time limit reached. Using best solution found (gap: 107.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -5547.21, θ = 120275.06
  Upper Bound (UB) = -5547.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120275.06
  [DEBUG]   ✓ Scenario 0: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120275.06 ≤ Q = 120275.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4a9a95de
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4a9a95de
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368031e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6406954.8983
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.450237e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145023.75    0  124 6406954.90 -145023.75   102%     -    0s
H    0     0                    -111108.1374 -145023.75  30.5%     -    0s
H    0     0                    -112251.3513 -145023.75  29.2%     -    0s
     0     0 -121969.45    0  127 -112251.35 -121969.45  8.66%     -    0s
H    0     0                    -116494.7507 -121839.01  4.59%     -    0s
     0     0 -120799.03    0  130 -116494.75 -120799.03  3.69%     -    0s
H    0     0                    -116720.8778 -120751.53  3.45%     -    0s
H    0     0                    -116934.9559 -120751.53  3.26%     -    0s
     0     0 -120751.53    0  130 -116934.96 -120751.53  3.26%     -    0s
     0     0 -120053.27    0  136 -116934.96 -120053.27  2.67%     -    0s
     0     0 -120010.18    0  136 -116934.96 -120010.18  2.63%     -    0s
     0     0 -120009.50    0  136 -116934.96 -120009.50  2.63%     -    0s
     0     0 -119505.70    0  129 -116934.96 -119505.70  2.20%     -    0s
     0     0 -119432.22    0  128 -116934.96 -119432.22  2.14%     -    0s
     0     0 -119085.15    0  130 -116934.96 -119085.15  1.84%     -    0s
     0     0 -119028.44    0  130 -116934.96 -119028.44  1.79%     -    0s
     0     0 -119028.16    0  130 -116934.96 -119028.16  1.79%     -    0s
     0     0 -118775.42    0  124 -116934.96 -118775.42  1.57%     -    0s
     0     0 -118745.48    0  130 -116934.96 -118745.48  1.55%     -    0s
     0     0 -118743.77    0  130 -116934.96 -118743.77  1.55%     -    0s
     0     0 -118600.11    0  130 -116934.96 -118600.11  1.42%     -    0s
     0     0 -118591.47    0  130 -116934.96 -118591.47  1.42%     -    0s
     0     2 -118591.47    0  130 -116934.96 -118591.47  1.42%     -    0s
H   99   223                    -117108.8733 -118280.33  1.00%  15.6    0s
H  114   223                    -117160.9537 -118280.33  0.96%  14.8    0s
H  119   223                    -117168.8901 -118280.33  0.95%  14.4    0s
H  154   223                    -117171.2710 -118280.33  0.95%  13.3    0s
H 1618  1194                    -117189.5849 -118160.74  0.83%   6.0    0s
* 2627  1604              51    -117207.5199 -118013.32  0.69%   5.7    0s
H 2854  1834                    -117332.4465 -117972.36  0.55%   5.7    0s
* 3449  1933              48    -117359.3258 -117972.36  0.52%   5.6    0s
* 3842  1933              41    -117380.4810 -117901.68  0.44%   5.6    0s
* 3926  1933              39    -117397.4192 -117901.68  0.43%   5.6    0s
H 5855  1683                    -117399.6664 -117779.10  0.32%   5.9    0s
H 5856  1683                    -117409.3187 -117779.10  0.31%   5.9    0s
H 5887  1683                    -117410.2333 -117779.10  0.31%   5.9    0s
H 5894  1683                    -117421.0278 -117779.10  0.30%   5.9    0s
H10009  1703                    -117432.9274 -117641.79  0.18%   6.1    0s
H10870  1697                    -117433.8420 -117634.56  0.17%   6.2    0s

Cutting planes:
  Gomory: 58
  Implied bound: 2
  MIR: 275
  RLT: 12

Explored 16390 nodes (106510 simplex iterations) in 0.73 seconds (0.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117434 -117433 -117421 ... -117332
No other solutions better than -117434

Optimal solution found (tolerance 1.00e-06)
Best objective -1.174338420274e+05, best bound -1.174338420274e+05, gap 0.0000%
  Subproblem solved in 0.76s
  Worst-case operational profit (Z_SP) = 116555.25
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117433.84
  [DEBUG]   S×d_nominal = 233989.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233989.09 + -117433.84 = 116555.25
  [DEBUG]   Current θ from Master = 120275.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3719.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9267.02
  Lower Bound (LB) = -9019.87
  Gap (UB-LB) = 3472.6598, Absolute Gap = 3472.6598, Relative Gap = 0.626019
  Not converged yet (gap = 3472.66 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x5fea2ffc
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 3.32s
Presolved: 100023 rows, 42700 columns, 605807 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -399807.2008
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 3.497e+06
 Factor NZ  : 8.263e+06 (roughly 120 MB of memory)
 Factor Ops : 1.566e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80783568e+07  1.96497388e+08  1.02e+05 1.77e+01  8.19e+04     5s
   1  -1.37308293e+07  1.70614664e+08  7.11e+04 6.40e+01  5.67e+04     5s
   2  -4.58189405e+06  1.29291648e+08  2.32e+04 7.26e-01  1.94e+04     5s
   3  -1.08163468e+06  9.14317991e+07  2.86e+03 1.20e+00  2.73e+03     5s
   4  -5.99730515e+05  4.25011016e+07  7.32e+02 2.44e-01  7.49e+02     5s
   5  -4.38226815e+05  2.73444971e+07  2.75e+02 1.43e-01  3.30e+02     6s
   6  -3.32077267e+05  2.07314290e+07  9.33e+01 9.78e-02  1.71e+02     6s
   7  -1.99871048e+05  1.51592329e+07  2.64e+01 6.69e-02  9.76e+01     6s
   8  -1.36344584e+05  1.05069869e+07  1.16e+01 4.41e-02  6.27e+01     6s
   9  -9.50922955e+04  3.71114949e+06  4.02e+00 1.34e-02  2.15e+01     6s
  10  -6.05990259e+04  1.19988880e+06  1.59e+00 4.17e-03  6.98e+00     6s
  11  -3.60083601e+04  5.14872689e+05  9.33e-01 1.81e-03  3.03e+00     6s
  12  -3.17803580e+04  3.64346376e+05  6.90e-01 1.39e-03  2.18e+00     6s
  13  -2.06132955e+04  1.89347602e+05  3.59e-01 6.87e-04  1.15e+00     6s
  14  -1.31503125e+04  9.87519818e+04  2.38e-01 9.69e-04  6.12e-01     6s
  15  -9.93455695e+03  7.40577843e+04  1.96e-01 1.22e-03  4.59e-01     6s
  16  -5.46841685e+03  6.01948479e+04  1.56e-01 1.95e-03  3.59e-01     7s
  17  -2.86462683e+03  5.12876482e+04  1.32e-01 2.23e-03  2.96e-01     7s
  18   6.94828938e+02  3.91039371e+04  1.04e-01 1.82e-03  2.10e-01     7s
  19   5.23661943e+03  3.18038120e+04  7.29e-02 2.43e-03  1.45e-01     7s
  20   6.23989814e+03  2.76400648e+04  6.62e-02 2.24e-03  1.17e-01     7s
  21   7.42597205e+03  2.64136548e+04  5.88e-02 1.96e-03  1.04e-01     7s
  22   8.95329909e+03  2.51391438e+04  4.93e-02 1.48e-03  8.85e-02     7s
  23   9.87728086e+03  2.36618861e+04  4.32e-02 1.41e-03  7.54e-02     7s
  24   1.11329967e+04  2.21891005e+04  3.53e-02 1.37e-03  6.04e-02     7s
  25   1.18116854e+04  2.10330898e+04  3.14e-02 1.09e-03  5.04e-02     7s
  26   1.21140710e+04  2.06560859e+04  2.93e-02 9.12e-04  4.67e-02     7s
  27   1.29451673e+04  1.96335998e+04  2.44e-02 6.41e-04  3.66e-02     8s
  28   1.34553527e+04  1.93295925e+04  2.15e-02 5.56e-04  3.21e-02     8s
  29   1.35978673e+04  1.89429169e+04  2.05e-02 4.53e-04  2.92e-02     8s
  30   1.41894801e+04  1.84892533e+04  1.71e-02 3.27e-04  2.35e-02     8s
  31   1.44745480e+04  1.82449029e+04  1.54e-02 2.70e-04  2.06e-02     8s
  32   1.50087152e+04  1.79981962e+04  1.24e-02 2.26e-04  1.63e-02     8s
  33   1.52376003e+04  1.78564726e+04  1.09e-02 2.43e-04  1.43e-02     8s
  34   1.54868973e+04  1.76807970e+04  9.45e-03 2.28e-04  1.20e-02     8s
  35   1.56615057e+04  1.76190385e+04  8.45e-03 1.97e-04  1.07e-02     9s
  36   1.59282456e+04  1.75362652e+04  6.93e-03 1.60e-04  8.79e-03     9s
  37   1.61566360e+04  1.74132155e+04  5.58e-03 1.06e-04  6.87e-03     9s
  38   1.62997000e+04  1.73446520e+04  4.76e-03 7.37e-05  5.72e-03     9s
  39   1.64511500e+04  1.72665170e+04  3.86e-03 6.70e-05  4.46e-03     9s
  40   1.65736191e+04  1.72324573e+04  3.15e-03 4.56e-05  3.60e-03     9s
  41   1.66002165e+04  1.72064517e+04  2.99e-03 5.65e-05  3.32e-03     9s
  42   1.67918426e+04  1.71798877e+04  1.90e-03 5.57e-04  2.12e-03     9s
  43   1.69458775e+04  1.71688744e+04  1.04e-03 3.68e-04  1.22e-03    10s
  44   1.69564020e+04  1.71621199e+04  9.90e-04 2.75e-04  1.13e-03    10s
  45   1.69783691e+04  1.71578180e+04  8.72e-04 2.15e-04  9.82e-04    10s
  46   1.69963155e+04  1.71547179e+04  7.74e-04 1.65e-04  8.67e-04    10s
  47   1.70555350e+04  1.71524967e+04  4.45e-04 1.37e-04  5.30e-04    10s
  48   1.70811794e+04  1.71484762e+04  3.09e-04 7.43e-05  3.68e-04    10s
  49   1.70934249e+04  1.71451297e+04  2.45e-04 3.54e-05  2.83e-04    10s
  50   1.71258631e+04  1.71437793e+04  7.89e-05 2.16e-05  9.80e-05    10s
  51   1.71294134e+04  1.71431640e+04  6.01e-05 1.61e-05  7.52e-05    11s
  52   1.71364318e+04  1.71426818e+04  2.42e-05 1.15e-05  3.42e-05    11s
  53   1.71386579e+04  1.71419268e+04  1.28e-05 4.53e-06  1.79e-05    11s
  54   1.71393704e+04  1.71418620e+04  9.36e-06 3.98e-06  1.36e-05    11s
  55   1.71399494e+04  1.71415113e+04  6.66e-06 1.11e-06  8.54e-06    11s
  56   1.71411371e+04  1.71414329e+04  9.96e-07 4.32e-07  1.62e-06    11s
  57   1.71413773e+04  1.71413823e+04  1.60e-08 2.67e-08  2.76e-08    11s
  58   1.71413813e+04  1.71413814e+04  2.45e-08 1.35e-08  4.45e-10    11s

Barrier solved model in 58 iterations and 11.35 seconds (9.58 work units)
Optimal objective 1.71413813e+04


Root crossover log...

   79745 DPushes remaining with DInf 0.0000000e+00                12s
    2619 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    8118 PPushes remaining with PInf 3.8132693e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.5522804e-01     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44323    1.7141381e+04   0.000000e+00   9.552280e-01     16s
   44326    1.7141381e+04   0.000000e+00   0.000000e+00     16s
   44326    1.7141381e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.714138e+04, 44326 iterations, 11.96 seconds (14.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 17141.3814    0  419 -177247.82 17141.3814   110%     -   17s
H    0     0                    -172792.3193 17141.3814   110%     -   17s
H    0     0                    -94395.52617 17141.3814   118%     -   17s
H    0     0                    -44093.63563 17141.3814   139%     -   17s
H    0     0                    -20940.11317 17141.3814   182%     -   18s
H    0     0                    -20510.67142 17141.3814   184%     -   18s
H    0     0                    -20471.95743 17141.3814   184%     -   18s
H    0     0                    -20265.59224 17141.3814   185%     -   18s
H    0     0                    -20245.74227 17141.3814   185%     -   18s
H    0     0                    -20236.08095 17141.3814   185%     -   24s
H    0     0                    -19767.67685 12082.9548   161%     -   72s
H    0     0                    -19754.43590 12082.9548   161%     -   72s
H    0     0                    -19754.23253 12082.9548   161%     -   72s
     0     0 11640.1715    0  554 -19754.233 11640.1715   159%     -   73s
     0     0 11162.0489    0  523 -19754.233 11162.0489   157%     -  105s
     0     0 11162.0489    0  465 -19754.233 11162.0489   157%     -  112s
     0     0 11162.0489    0  479 -19754.233 11162.0489   157%     -  121s
     0     0 11162.0489    0  467 -19754.233 11162.0489   157%     -  130s
     0     0 11162.0489    0  467 -19754.233 11162.0489   157%     -  131s
H    0     0                    -19705.23107 8887.55210   145%     -  197s
H    0     0                    -19679.03134 8887.55210   145%     -  197s
     0     0 8887.55210    0  553 -19679.031 8887.55210   145%     -  197s
H    0     0                    -12244.88500 8887.46988   173%     -  197s
H    0     0                    -11792.35567 8887.46988   175%     -  198s
H    0     0                    -11724.90935 8887.46988   176%     -  198s
     0     0 8281.09697    0  572 -11724.909 8281.09697   171%     -  246s
     0     0 8161.76121    0  569 -11724.909 8161.76121   170%     -  277s
     0     0 8074.78851    0  545 -11724.909 8074.78851   169%     -  302s
     0     0 8006.62067    0  543 -11724.909 8006.62067   168%     -  317s
     0     0 7966.97072    0  624 -11724.909 7966.97072   168%     -  332s
     0     0 7911.30310    0  554 -11724.909 7911.30310   167%     -  343s
     0     0 7904.64993    0  544 -11724.909 7904.64993   167%     -  346s
     0     0 7897.41817    0  546 -11724.909 7897.41817   167%     -  348s
     0     0 7889.08921    0  547 -11724.909 7889.08921   167%     -  351s
H    0     0                    -11358.32738 7886.53079   169%     -  353s
H    0     0                    -11292.74937 7886.53079   170%     -  353s
H    0     0                    -11268.83036 7886.53079   170%     -  353s
H    0     0                    -11253.47056 7886.53079   170%     -  353s
     0     0 7886.53079    0  549 -11253.471 7886.53079   170%     -  353s
     0     0 7882.55200    0  550 -11253.471 7882.55200   170%     -  357s
     0     0 7881.95904    0  550 -11253.471 7881.95904   170%     -  360s
     0     0 6368.74266    0  509 -11253.471 6368.74266   157%     -  445s
H    0     0                    -11181.94035 6368.69168   157%     -  446s
H    0     0                    -11157.27874 6368.69168   157%     -  446s
     0     0 5954.89516    0  638 -11157.279 5954.89516   153%     -  487s
     0     0 5687.67295    0  595 -11157.279 5687.67295   151%     -  519s
     0     0 5476.13186    0  673 -11157.279 5476.13186   149%     -  546s
     0     0 5433.73857    0  678 -11157.279 5433.73857   149%     -  560s
     0     0 5426.11614    0  669 -11157.279 5426.11614   149%     -  569s
     0     0 5409.96375    0  652 -11157.279 5409.96375   148%     -  578s
     0     0 5399.05972    0  687 -11157.279 5399.05972   148%     -  590s
     0     0 5388.90033    0  616 -11157.279 5388.90033   148%     -  598s
     0     0 5386.26446    0  682 -11157.279 5386.26446   148%     -  606s
H    0     0                    -11139.70593 5384.07675   148%     -  609s
     0     0 5384.07675    0  693 -11139.706 5384.07675   148%     -  609s
     0     0 5383.22976    0  678 -11139.706 5383.22976   148%     -  612s
     0     0 4549.63581    0  446 -11139.706 4549.63581   141%     -  683s
     0     0 4353.40316    0  650 -11139.706 4353.40316   139%     -  716s
H    0     0                    -10215.96071 4280.43788   142%     -  740s
H    0     0                    -10213.04010 4280.43788   142%     -  740s
H    0     0                    -10211.72457 4280.43788   142%     -  740s
H    0     0                    -9819.441626 4280.43788   144%     -  740s
H    0     0                    -9676.237248 4280.43788   144%     -  740s
H    0     0                    -9658.872529 4280.43788   144%     -  740s
H    0     0                    -9638.943563 4280.43788   144%     -  741s
H    0     0                    -9575.825249 4280.43788   145%     -  741s
H    0     0                    -9559.430178 4280.43788   145%     -  741s
H    0     0                    -9384.325351 4280.43788   146%     -  741s
H    0     0                    -9370.366193 4280.43788   146%     -  741s
     0     0 4280.43788    0  601 -9370.3662 4280.43788   146%     -  741s
     0     0 4233.90430    0  640 -9370.3662 4233.90430   145%     -  754s
     0     0 4194.04088    0  624 -9370.3662 4194.04088   145%     -  765s
     0     0 4172.54297    0  640 -9370.3662 4172.54297   145%     -  775s
     0     0 4160.38945    0  651 -9370.3662 4160.38945   144%     -  782s
     0     0 4151.02464    0  637 -9370.3662 4151.02464   144%     -  788s
     0     0 4116.27639    0  622 -9370.3662 4116.27639   144%     -  798s
     0     0 4109.77434    0  640 -9370.3662 4109.77434   144%     -  804s
     0     0 4102.57788    0  649 -9370.3662 4102.57788   144%     -  809s
     0     0 4094.95650    0  640 -9370.3662 4094.95650   144%     -  815s
     0     0 4085.62125    0  643 -9370.3662 4085.62125   144%     -  819s
     0     0 4083.99432    0  643 -9370.3662 4083.99432   144%     -  823s
     0     0 3883.44697    0  539 -9370.3662 3883.44697   141%     -  848s
H    0     0                    -8952.849587 3883.30606   143%     -  849s
H    0     0                    -8922.135620 3883.30606   144%     -  849s
H    0     0                    -8860.493084 3883.30606   144%     -  849s
     0     0 3855.79978    0  625 -8860.4931 3855.79978   144%     -  865s
     0     0 3827.78990    0  471 -8860.4931 3827.78990   143%     -  880s
     0     0 3807.56272    0  467 -8860.4931 3807.56272   143%     -  894s
     0     0 3804.35718    0  470 -8860.4931 3804.35718   143%     -  899s
     0     0 3800.47240    0  471 -8860.4931 3800.47240   143%     -  904s
     0     0 3779.95046    0  474 -8860.4931 3779.95046   143%     -  915s
     0     0 3776.15217    0  478 -8860.4931 3776.15217   143%     -  920s
     0     0 3773.72807    0  639 -8860.4931 3773.72807   143%     -  927s
     0     0 3772.16648    0  647 -8860.4931 3772.16648   143%     -  931s
     0     0 3699.98669    0  635 -8860.4931 3699.98669   142%     -  954s
H    0     0                    -8848.868855 3699.92557   142%     -  954s
     0     0 3670.02526    0  635 -8848.8689 3670.02526   141%     -  968s
     0     0 3655.79973    0  487 -8848.8689 3655.79973   141%     -  977s
     0     0 3648.34421    0  492 -8848.8689 3648.34421   141%     -  985s
     0     0 3638.76169    0  490 -8848.8689 3638.76169   141%     -  994s
     0     0 3636.02651    0  485 -8848.8689 3636.02651   141%     - 1000s
     0     0 3635.54436    0  572 -8848.8689 3635.54436   141%     - 1001s
     0     0 3635.54436    0  572 -8848.8689 3635.54436   141%     - 1001s
     0     0 3581.11971    0  586 -8848.8689 3581.11971   140%     - 1019s
H    0     0                    -8804.571035 3580.71083   141%     - 1020s
     0     0 3560.69406    0  497 -8804.5710 3560.69406   140%     - 1034s
     0     0 3543.14311    0  503 -8804.5710 3543.14311   140%     - 1042s
     0     0 3530.26606    0  583 -8804.5710 3530.26606   140%     - 1054s
     0     0 3527.04819    0  493 -8804.5710 3527.04819   140%     - 1057s
     0     0 3522.93479    0  502 -8804.5710 3522.93479   140%     - 1061s
     0     0 3518.68335    0  511 -8804.5710 3518.68335   140%     - 1065s
     0     0 3512.65979    0  500 -8804.5710 3512.65979   140%     - 1071s
     0     0 3512.00034    0  502 -8804.5710 3512.00034   140%     - 1075s
     0     0 3426.78352    0  569 -8804.5710 3426.78352   139%     - 1092s
H    0     0                    -8653.075314 3426.77879   140%     - 1093s
H    0     0                    -8635.099661 3426.77879   140%     - 1093s
H    0     0                    -8631.376623 3426.77879   140%     - 1093s
H    0     0                    -8630.670901 3426.77879   140%     - 1093s
H    0     0                    -8627.679780 3426.77879   140%     - 1093s
     0     0 3405.17593    0  482 -8627.6798 3405.17593   139%     - 1104s
     0     0 3399.59121    0  492 -8627.6798 3399.59121   139%     - 1113s
     0     0 3397.09347    0  496 -8627.6798 3397.09347   139%     - 1117s
     0     0 3393.33758    0  491 -8627.6798 3393.33758   139%     - 1126s
     0     0 3390.52226    0  503 -8627.6798 3390.52226   139%     - 1129s
     0     0 3389.71938    0  511 -8627.6798 3389.71938   139%     - 1132s
     0     0 3355.80355    0  743 -8627.6798 3355.80355   139%     - 1148s
     0     0 3343.02499    0  728 -8627.6798 3343.02499   139%     - 1157s
     0     0 3332.66407    0  716 -8627.6798 3332.66407   139%     - 1167s
     0     0 3325.39320    0  664 -8627.6798 3325.39320   139%     - 1176s
     0     0 3319.46368    0  505 -8627.6798 3319.46368   138%     - 1181s
     0     0 3317.85166    0  588 -8627.6798 3317.85166   138%     - 1183s
     0     0 3285.09149    0  583 -8627.6798 3285.09149   138%     - 1196s
H    0     0                    -8590.678785 3285.01408   138%     - 1197s
H    0     0                    -8584.972129 3285.01408   138%     - 1197s
     0     0 3281.37299    0  592 -8584.9721 3281.37299   138%     - 1201s
     0     0 3279.69071    0  589 -8584.9721 3279.69071   138%     - 1206s
     0     0 3274.55595    0  527 -8584.9721 3274.55595   138%     - 1212s
     0     0 3271.97294    0  521 -8584.9721 3271.97294   138%     - 1217s
     0     0 3270.07221    0  523 -8584.9721 3270.07221   138%     - 1221s
     0     0 3263.58695    0  530 -8584.9721 3263.58695   138%     - 1231s
     0     0 3263.51050    0  530 -8584.9721 3263.51050   138%     - 1238s
H    0     0                    -8315.120432 3263.51050   139%     - 1285s
H    0     0                    -6884.268616 3263.51050   147%     - 1359s
H    0     0                    -6643.846117 3263.51050   149%     - 1362s
H    0     0                    -6624.305713 3263.51050   149%     - 1364s
H    0     2                    -6593.634833 3263.51050   149%     - 1366s
     0     2 3263.51050    0  530 -6593.6348 3263.51050   149%     - 1366s
     1     3 2288.28059    1  460 -6593.6348 3263.41713   149% 16425 1391s
     2     4 2980.46568    1  502 -6593.6348 2980.46568   145% 13908 1407s
     3     7 1213.86609    2  461 -6593.6348 2980.20561   145% 13187 1427s
     6    14 2114.94803    3  466 -6593.6348 2979.67431   145% 11083 1447s
    13    28 1795.86722    4  457 -6593.6348 2580.90612   139%  9990 1470s
    27    42 1372.88419    5  479 -6593.6348 2470.08820   137% 15957 1990s
    41    74 1049.08050    6  480 -6593.6348 2470.08820   137% 19000 2240s
H   42    74                    -6559.391243 2470.08820   138% 18547 2240s
H   46    74                    -6453.074454 2470.08820   138% 17760 2240s
H   48    74                    -6402.656928 2470.08820   139% 17557 2240s
H   50    74                    -5967.439682 2470.08820   141% 17358 2240s
H   61    72                    -5927.358375 2470.08820   142% 15387 2240s
    73   188  820.43587    7  460 -5927.3584 2107.42256   136% 18956 2292s
H  201   239                    -5906.980468 2107.42256   136%  9957 2320s
H  202   239                    -5825.425152 2107.42256   136%  9928 2320s
H  209   239                    -5764.408420 2107.42256   137%  9707 2320s
H  211   239                    -5762.346524 2107.42256   137%  9658 2320s
H  217   239                    -5694.057444 2107.42256   137%  9458 2320s
H  254   239                    -5634.150214 2107.42256   137%  8659 2320s
   268   290  492.77472    9  431 -5634.1502 2107.42256   137%  8496 2344s
   327   323  675.24773   10  449 -5634.1502 2107.42256   137%  8338 2368s
H  330   323                    -5619.832933 2107.42256   137%  8359 2368s
H  336   323                    -5609.861429 2107.42256   138%  8303 2369s
   366   371  450.80937   10  422 -5609.8614 2107.42256   138%  8224 2390s
   417   399 -1383.0538   14  483 -5609.8614 2107.42256   138%  8045 2410s
H  428   399                    -5595.544148 2107.42256   138%  8053 2410s
   449   434 -1676.2972   10  233 -5595.5441 2107.42256   138%  8064 2431s
   506   477 -2717.3425   11  216 -5595.5441 2107.42256   138%  7934 2451s
   561   521 -2948.3056   11  227 -5595.5441 2107.42256   138%  7708 2472s
   627   551 -2808.8817   12  205 -5595.5441 1946.02264   135%  7448 2497s
   691   563 -3354.7242   14  211 -5595.5441 1946.02264   135%  7302 2519s
   765   588 -5029.0437   15  128 -5595.5441 1946.02264   135%  7169 2541s
   798   602 -3608.6734   15  219 -5595.5441 1946.02264   135%  7244 2563s
   840   616 -3610.2714   14  215 -5595.5441 1946.02264   135%  7197 2582s
   874   642 -3872.8578   16  206 -5595.5441 1946.02264   135%  7184 2603s
   916   660 -5259.4878   20  222 -5595.5441 1946.02264   135%  7221 2623s
   958   673 -4681.8432   17  205 -5595.5441 1836.25553   133%  7202 2644s
  1003   688 -5078.9140   16  128 -5595.5441 1747.10716   131%  7157 2667s
  1048   699 -5001.9948   18  217 -5595.5441 1747.10716   131%  7126 2691s
  1101   723 -4973.4272   18  196 -5595.5441 1747.10716   131%  7170 2713s
  1161   763 -5076.8521   19  188 -5595.5441 1747.10716   131%  7148 2738s
  1209   804 -5152.5181   20  178 -5595.5441 1747.10716   131%  7291 2764s
  1266   850 infeasible   20      -5595.5441 1611.08459   129%  7334 2789s
  1339   878 infeasible   21      -5595.5441 1611.08459   129%  7289 2814s
  1404   922 -1214.2074   13  461 -5595.5441 1611.08459   129%  7345 2841s
  1474   973 -1762.9959   14  493 -5595.5441 1611.08459   129%  7411 2871s
  1539   999 -1902.1848   15  465 -5595.5441 1611.08459   129%  7510 2902s
  1617  1053 -2427.2054   17  366 -5595.5441 1611.08459   129%  7536 2934s
  1701  1112 -4006.9675   19  194 -5595.5441 1611.08459   129%  7578 2964s
  1791  1162 -4861.0108   21  180 -5595.5441 1611.08459   129%  7533 2999s
  1915  1190     cutoff   28      -5595.5441 1611.08459   129%  7459 3034s
  2005  1232 -447.49378   10  258 -5595.5441 1611.08459   129%  7476 3072s
  2113  1274 -1079.1947   13  253 -5595.5441 1611.08459   129%  7502 3113s
  2230  1338 -2038.9612   14  240 -5595.5441 1263.02378   123%  7496 3156s
  2351  1402 -3115.2102   15  218 -5595.5441 1263.00958   123%  7553 3199s
  2473  1472 -4142.4078   19  196 -5595.5441 1263.00958   123%  7553 3241s
  2621  1517 -5207.3625   24  197 -5595.5441 1263.00958   123%  7537 3285s
  2774  1577     cutoff   42      -5595.5441 1014.90037   118%  7552 3332s
  2920  1651 -168.83092    7  426 -5595.5441 1014.90037   118%  7612 3377s
  3050  1711 -1006.2598   10  402 -5595.5441 1014.90037   118%  7685 3429s
  3202  1768 -3150.6882   12  313 -5595.5441  938.82147   117%  7677 3486s
  3331  1828 infeasible   15      -5595.5441  938.82147   117%  7763 3541s
  3462  1868 -1962.3366   14  327 -5595.5441  938.82147   117%  7854 3597s
  3552  1865 infeasible   23      -5595.5441  938.82147   117%  7929 3600s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 52
  MIR: 2367
  Flow cover: 2755
  Zero half: 4
  RLT: 139
  Relax-and-lift: 648

Explored 3559 nodes (28991048 simplex iterations) in 3600.06 seconds (5523.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5595.54 -5609.86 -5619.83 ... -5927.36

Time limit reached
Best objective -5.595544147978e+03, best bound 9.388214744817e+02, gap 116.7780%
  WARNING: Time limit reached. Using best solution found (gap: 116.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -5595.54, θ = 120103.10
  Upper Bound (UB) = -5595.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120103.10
  [DEBUG]   ✓ Scenario 0: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120103.10 ≤ Q = 120103.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120103.10 ≤ Q = 120103.10 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x288ed38b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x288ed38b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373288e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6414951.9736
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.442007e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144200.67    0  124 6414951.97 -144200.67   102%     -    0s
H    0     0                    -110469.5247 -144200.67  30.5%     -    0s
H    0     0                    -111429.2411 -144200.67  29.4%     -    0s
     0     0 -120239.86    0  128 -111429.24 -120239.86  7.91%     -    0s
H    0     0                    -116409.2099 -120120.17  3.19%     -    0s
H    0     0                    -116962.5615 -120120.17  2.70%     -    0s
     0     0 -119182.73    0   86 -116962.56 -119182.73  1.90%     -    0s
     0     0 -119107.71    0   86 -116962.56 -119107.71  1.83%     -    0s
     0     0 -118704.50    0   79 -116962.56 -118704.50  1.49%     -    0s
     0     0 -118640.80    0   87 -116962.56 -118640.80  1.43%     -    0s
     0     0 -118640.80    0   87 -116962.56 -118640.80  1.43%     -    0s
     0     0 -118352.11    0   79 -116962.56 -118352.11  1.19%     -    0s
     0     0 -118342.77    0   81 -116962.56 -118342.77  1.18%     -    0s
H    0     0                    -117034.3478 -118151.29  0.95%     -    0s
     0     0 -118151.29    0   80 -117034.35 -118151.29  0.95%     -    0s
     0     0 -118148.35    0   80 -117034.35 -118148.35  0.95%     -    0s
     0     2 -118148.35    0   80 -117034.35 -118148.35  0.95%     -    0s
H   52    64                    -117117.8007 -117667.69  0.47%  13.3    0s
H  450   376                    -117162.2836 -117661.97  0.43%   6.8    0s
H 4925  1345                    -117169.2155 -117355.52  0.16%   5.0    0s
H 5864  1330                    -117174.8979 -117329.75  0.13%   4.9    0s
H 5887  1330                    -117188.6886 -117329.75  0.12%   4.9    0s

Cutting planes:
  Gomory: 45
  Implied bound: 4
  MIR: 180
  RLT: 13
  BQP: 2

Explored 10686 nodes (50642 simplex iterations) in 0.79 seconds (0.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117189 -117175 -117169 ... -110470
No other solutions better than -117189

Optimal solution found (tolerance 1.00e-06)
Best objective -1.171886885815e+05, best bound -1.171886885815e+05, gap 0.0000%
  Subproblem solved in 0.82s
  Worst-case operational profit (Z_SP) = 115780.04
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117188.69
  [DEBUG]   S×d_nominal = 232968.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232968.73 + -117188.69 = 115780.04
  [DEBUG]   Current θ from Master = 120103.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4323.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9918.60
  Lower Bound (LB) = -9019.87
  Gap (UB-LB) = 3424.3246, Absolute Gap = 3424.3246, Relative Gap = 0.611973
  Not converged yet (gap = 3424.32 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0xdb7bfd46
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 3.06s
Presolved: 108243 rows, 46070 columns, 654635 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -400005.1773
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 4.001e+06
 Factor NZ  : 9.907e+06 (roughly 140 MB of memory)
 Factor Ops : 2.492e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80941246e+07  2.11566423e+08  1.02e+05 1.68e+01  8.15e+04     5s
   1  -1.37540492e+07  1.83673301e+08  7.11e+04 6.03e+01  5.65e+04     5s
   2  -5.20550208e+06  1.39328065e+08  2.65e+04 9.38e-01  2.19e+04     5s
   3  -9.75544169e+05  9.81800198e+07  2.02e+03 1.77e+00  2.07e+03     5s
   4  -5.70342641e+05  4.68162618e+07  4.94e+02 6.09e-01  5.83e+02     5s
   5  -4.68600448e+05  3.17400148e+07  2.16e+02 3.57e-01  3.02e+02     6s
   6  -3.31941921e+05  2.11569263e+07  6.18e+01 2.11e-01  1.44e+02     6s
   7  -2.01611706e+05  1.71909532e+07  1.81e+01 1.65e-01  9.71e+01     6s
   8  -1.42200762e+05  8.29563201e+06  7.60e+00 7.39e-02  4.48e+01     6s
   9  -8.59248662e+04  3.93100102e+06  1.53e+00 3.16e-02  2.05e+01     6s
  10  -5.76055026e+04  1.91097186e+06  5.57e-01 1.48e-02  9.98e+00     6s
  11  -3.71234862e+04  9.60198392e+05  2.66e-01 7.52e-03  5.04e+00     6s
  12  -3.14412739e+04  5.46577623e+05  2.01e-01 4.32e-03  2.92e+00     6s
  13  -2.27560924e+04  2.92967175e+05  1.11e-01 2.41e-03  1.59e+00     6s
  14  -1.57188062e+04  1.48814018e+05  6.88e-02 1.11e-03  8.31e-01     7s
  15  -1.25403810e+04  1.02479456e+05  5.80e-02 7.94e-04  5.81e-01     7s
  16  -7.62151507e+03  7.65503010e+04  4.59e-02 1.17e-03  4.25e-01     7s
  17  -2.73835362e+03  5.65307230e+04  3.37e-02 3.53e-03  2.99e-01     7s
  18   8.32400132e+02  4.61418422e+04  2.66e-02 2.56e-03  2.29e-01     7s
  19   2.62231399e+03  3.62103693e+04  2.35e-02 1.78e-03  1.70e-01     7s
  20   4.74918346e+03  3.15655049e+04  2.00e-02 1.32e-03  1.35e-01     7s
  21   6.70773747e+03  2.87621494e+04  1.68e-02 1.04e-03  1.11e-01     7s
  22   8.29125100e+03  2.67342621e+04  1.41e-02 8.56e-04  9.31e-02     8s
  23   9.85888906e+03  2.41399124e+04  1.15e-02 6.27e-04  7.21e-02     8s
  24   1.05688439e+04  2.29170703e+04  1.05e-02 5.18e-04  6.23e-02     8s
  25   1.16206290e+04  2.20226575e+04  8.76e-03 4.42e-04  5.25e-02     8s
  26   1.22486208e+04  2.08387277e+04  7.73e-03 3.21e-04  4.34e-02     8s
  27   1.29392044e+04  2.02511940e+04  6.68e-03 2.64e-04  3.69e-02     8s
  28   1.33188832e+04  1.97935214e+04  5.98e-03 2.26e-04  3.27e-02     9s
  29   1.41750046e+04  1.92506228e+04  4.62e-03 1.78e-04  2.56e-02     9s
  30   1.44996757e+04  1.86628311e+04  4.09e-03 1.23e-04  2.10e-02     9s
  31   1.50422547e+04  1.82433095e+04  3.25e-03 8.54e-05  1.62e-02     9s
  32   1.54328809e+04  1.81408578e+04  2.69e-03 7.60e-05  1.37e-02     9s
  33   1.55527778e+04  1.80880632e+04  2.51e-03 7.16e-05  1.28e-02     9s
  34   1.58579575e+04  1.78628037e+04  2.06e-03 5.34e-05  1.01e-02    10s
  35   1.60188631e+04  1.77068533e+04  1.81e-03 3.99e-05  8.52e-03    10s
  36   1.62324156e+04  1.75940277e+04  1.49e-03 2.96e-05  6.87e-03    10s
  37   1.64458381e+04  1.74604968e+04  1.15e-03 8.32e-05  5.12e-03    10s
  38   1.66609670e+04  1.74031010e+04  8.32e-04 6.02e-05  3.75e-03    10s
  39   1.66774542e+04  1.73584672e+04  8.07e-04 4.35e-05  3.44e-03    10s
  40   1.68470415e+04  1.73348697e+04  5.66e-04 3.39e-05  2.46e-03    11s
  41   1.68579612e+04  1.73186441e+04  5.50e-04 2.81e-05  2.33e-03    11s
  42   1.69666138e+04  1.72961636e+04  3.98e-04 1.99e-05  1.66e-03    11s
  43   1.70310406e+04  1.72787092e+04  3.01e-04 1.39e-05  1.25e-03    11s
  44   1.70566240e+04  1.72672492e+04  2.63e-04 9.81e-06  1.06e-03    11s
  45   1.71011537e+04  1.72622173e+04  1.97e-04 7.83e-06  8.13e-04    11s
  46   1.71071681e+04  1.72598607e+04  1.89e-04 7.09e-06  7.71e-04    12s
  47   1.71202748e+04  1.72543092e+04  1.70e-04 5.05e-06  6.77e-04    12s
  48   1.71587215e+04  1.72502944e+04  1.14e-04 4.01e-06  4.62e-04    12s
  49   1.71627218e+04  1.72476363e+04  1.09e-04 5.42e-06  4.29e-04    12s
  50   1.71891979e+04  1.72459635e+04  6.99e-05 5.35e-06  2.87e-04    12s
  51   1.72141788e+04  1.72441286e+04  3.39e-05 5.98e-06  1.51e-04    12s
  52   1.72337177e+04  1.72428366e+04  6.58e-06 4.62e-06  4.60e-05    13s
  53   1.72345965e+04  1.72412886e+04  5.54e-06 2.64e-06  3.38e-05    13s
  54   1.72356509e+04  1.72411233e+04  4.23e-06 2.41e-06  2.76e-05    13s
  55   1.72374600e+04  1.72403684e+04  1.94e-06 1.45e-06  1.47e-05    13s
  56   1.72379871e+04  1.72399121e+04  1.34e-06 8.59e-07  9.71e-06    13s
  57   1.72386282e+04  1.72396913e+04  5.87e-07 5.65e-07  5.36e-06    14s
  58   1.72391161e+04  1.72392378e+04  7.38e-08 1.36e-08  6.14e-07    14s
  59   1.72392104e+04  1.72392109e+04  4.18e-09 1.35e-10  2.76e-09    14s
  60   1.72392109e+04  1.72392109e+04  1.21e-08 3.20e-11  1.01e-10    14s

Barrier solved model in 60 iterations and 13.89 seconds (11.86 work units)
Optimal objective 1.72392109e+04


Root crossover log...

   82367 DPushes remaining with DInf 0.0000000e+00                14s
   26977 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    5139 PPushes remaining with PInf 1.9830043e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0674212e+00     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38641    1.7239211e+04   0.000000e+00   3.067421e+00     18s
   38642    1.7239211e+04   0.000000e+00   0.000000e+00     18s
   38642    1.7239211e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 1.723921e+04, 38642 iterations, 14.44 seconds (16.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 17239.2109    0  510 -177247.82 17239.2109   110%     -   19s
H    0     0                    -172792.3193 17239.2109   110%     -   19s
H    0     0                    -147132.6242 17239.2109   112%     -   20s
H    0     0                    -131098.3450 17239.2109   113%     -   20s
H    0     0                    -94382.07506 17239.2109   118%     -   20s
H    0     0                    -59510.29491 17239.2109   129%     -   20s
H    0     0                    -34995.95789 17239.2109   149%     -   21s
H    0     0                    -34297.95000 17239.2109   150%     -   21s
H    0     0                    -31752.84626 17239.2109   154%     -   23s
H    0     0                    -26195.68216 17239.2109   166%     -   23s
H    0     0                    -26180.87396 17239.2109   166%     -   23s
H    0     0                    -26164.84354 17239.2109   166%     -   23s
H    0     0                    -25844.06819 17239.2109   167%     -   23s
H    0     0                    -21297.94419 17235.8033   181%     -   24s
H    0     0                    -20878.60571 17235.8033   183%     -   24s
H    0     0                    -20830.68697 17235.8033   183%     -   24s
H    0     0                    -20824.16793 12169.0244   158%     -   91s
H    0     0                    -20001.02804 12169.0244   161%     -   91s
H    0     0                    -19960.61834 12169.0244   161%     -   91s
H    0     0                    -19947.02661 12169.0244   161%     -   91s
H    0     0                    -19903.97483 12169.0244   161%     -   91s
H    0     0                    -19890.38310 12169.0244   161%     -   91s
     0     0 12169.0244    0  642 -19890.383 12169.0244   161%     -   91s
     0     0 11544.1636    0  596 -19890.383 11544.1636   158%     -  123s
     0     0 11455.6626    0  581 -19890.383 11455.6626   158%     -  145s
     0     0 11402.2845    0  571 -19890.383 11402.2845   157%     -  157s
     0     0 11377.4595    0  563 -19890.383 11377.4595   157%     -  171s
     0     0 11374.6471    0  565 -19890.383 11374.6471   157%     -  175s
     0     0 11358.5113    0  563 -19890.383 11358.5113   157%     -  179s
     0     0 11357.8887    0  560 -19890.383 11357.8887   157%     -  181s
     0     0 11357.3601    0  547 -19890.383 11357.3601   157%     -  183s
H    0     0                    -19863.73886 8966.12375   145%     -  270s
     0     0 8966.12375    0  519 -19863.739 8966.12375   145%     -  271s
H    0     0                    -12511.22091 8965.62816   172%     -  271s
H    0     0                    -11892.89774 8965.62816   175%     -  272s
H    0     0                    -11842.53049 8965.62816   176%     -  272s
     0     0 8223.17943    0  543 -11842.530 8223.17943   169%     -  351s
     0     0 8118.55946    0  561 -11842.530 8118.55946   169%     -  394s
     0     0 7904.38498    0  566 -11842.530 7904.38498   167%     -  438s
H    0     0                    -10237.63601 7808.07860   176%     -  474s
H    0     0                    -9436.880973 7808.07860   183%     -  474s
H    0     0                    -8777.276202 7808.07860   189%     -  474s
H    0     0                    -8310.263614 7808.07860   194%     -  474s
H    0     0                    -8242.845636 7808.07860   195%     -  474s
H    0     0                    -8006.194812 7808.07860   198%     -  474s
H    0     0                    -7939.339221 7808.07860   198%     -  474s
     0     0 7808.07860    0  578 -7939.3392 7808.07860   198%     -  474s
     0     0 7756.57603    0  546 -7939.3392 7756.57603   198%     -  505s
     0     0 7697.99783    0  546 -7939.3392 7697.99783   197%     -  524s
     0     0 7511.26572    0  579 -7939.3392 7511.26572   195%     -  553s
     0     0 7481.04751    0  574 -7939.3392 7481.04751   194%     -  567s
     0     0 7472.54220    0  574 -7939.3392 7472.54220   194%     -  574s
     0     0 7471.82979    0  587 -7939.3392 7471.82979   194%     -  577s
     0     0 5929.98299    0  624 -7939.3392 5929.98299   175%     -  704s
H    0     0                    -7595.808116 5929.96694   178%     -  705s
H    0     0                    -7187.093533 5929.96694   183%     -  705s
H    0     0                    -6974.028093 5929.96694   185%     -  705s
H    0     0                    -6907.165189 5929.96694   186%     -  706s
H    0     0                    -6865.452489 5929.96694   186%     -  706s
H    0     0                    -6824.023031 5929.96694   187%     -  706s
H    0     0                    -6806.359619 5929.96694   187%     -  706s
     0     0 5549.55855    0  666 -6806.3596 5549.55855   182%     -  776s
     0     0 5272.69359    0  632 -6806.3596 5272.69359   177%     -  836s
     0     0 5136.72093    0  662 -6806.3596 5136.72093   175%     -  877s
     0     0 5030.73225    0  628 -6806.3596 5030.73225   174%     -  910s
     0     0 4976.98488    0  636 -6806.3596 4976.98488   173%     -  936s
     0     0 4941.31762    0  640 -6806.3596 4941.31762   173%     -  958s
     0     0 4926.67273    0  662 -6806.3596 4926.67273   172%     -  969s
     0     0 4918.66178    0  658 -6806.3596 4918.66178   172%     -  975s
     0     0 4910.43023    0  682 -6806.3596 4910.43023   172%     -  984s
     0     0 4905.27372    0  663 -6806.3596 4905.27372   172%     -  991s
     0     0 4903.32225    0  662 -6806.3596 4903.32225   172%     -  994s
     0     0 4890.48534    0  657 -6806.3596 4890.48534   172%     - 1007s
     0     0 4886.21975    0  656 -6806.3596 4886.21975   172%     - 1011s
     0     0 4883.15378    0  656 -6806.3596 4883.15378   172%     - 1015s
     0     0 4881.89468    0  655 -6806.3596 4881.89468   172%     - 1018s
     0     0 4265.93118    0  636 -6806.3596 4265.93118   163%     - 1102s
H    0     0                    -6226.165312 4265.91816   169%     - 1103s
H    0     0                    -6224.467818 4265.91816   169%     - 1103s
     0     0 4061.39382    0  638 -6224.4678 4061.39382   165%     - 1135s
     0     0 3971.16466    0  472 -6224.4678 3971.16466   164%     - 1162s
     0     0 3942.83445    0  622 -6224.4678 3942.83445   163%     - 1178s
     0     0 3930.61891    0  465 -6224.4678 3930.61891   163%     - 1183s
     0     0 3889.07260    0  474 -6224.4678 3889.07260   162%     - 1198s
     0     0 3871.43820    0  468 -6224.4678 3871.43820   162%     - 1208s
     0     0 3858.59461    0  466 -6224.4678 3858.59461   162%     - 1216s
     0     0 3838.37897    0  457 -6224.4678 3838.37897   162%     - 1227s
     0     0 3830.51652    0  645 -6224.4678 3830.51652   162%     - 1239s
     0     0 3827.37919    0  472 -6224.4678 3827.37919   161%     - 1245s
     0     0 3822.63506    0  561 -6224.4678 3822.63506   161%     - 1255s
     0     0 3803.68983    0  633 -6224.4678 3803.68983   161%     - 1271s
     0     0 3796.45488    0  537 -6224.4678 3796.45488   161%     - 1284s
     0     0 3795.83324    0  644 -6224.4678 3795.83324   161%     - 1286s
     0     0 3683.56693    0  624 -6224.4678 3683.56693   159%     - 1313s
     0     0 3654.24897    0  384 -6224.4678 3654.24897   159%     - 1331s
     0     0 3635.39591    0  386 -6224.4678 3635.39591   158%     - 1344s
     0     0 3631.75477    0  451 -6224.4678 3631.75477   158%     - 1350s
     0     0 3598.30385    0  450 -6224.4678 3598.30385   158%     - 1369s
     0     0 3590.70427    0  398 -6224.4678 3590.70427   158%     - 1378s
     0     0 3585.91194    0  401 -6224.4678 3585.91194   158%     - 1382s
     0     0 3577.07908    0  400 -6224.4678 3577.07908   157%     - 1388s
     0     0 3575.32546    0  402 -6224.4678 3575.32546   157%     - 1392s
     0     0 3523.45156    0  466 -6224.4678 3523.45156   157%     - 1422s
H    0     0                    -5632.581447 3522.29543   163%     - 1426s
     0     0 3515.67700    0  478 -5632.5814 3515.67700   162%     - 1434s
     0     0 3510.15518    0  469 -5632.5814 3510.15518   162%     - 1446s
     0     0 3508.58058    0  474 -5632.5814 3508.58058   162%     - 1451s
     0     0 3472.32535    0  560 -5632.5814 3472.32535   162%     - 1480s
     0     0 3456.78988    0  634 -5632.5814 3456.78988   161%     - 1502s
     0     0 3453.09830    0  477 -5632.5814 3453.09830   161%     - 1515s
     0     0 3431.68120    0  650 -5632.5814 3431.68120   161%     - 1530s
     0     0 3428.83975    0  635 -5632.5814 3428.83975   161%     - 1539s
     0     0 3426.79340    0  630 -5632.5814 3426.79340   161%     - 1546s
     0     0 3387.69765    0  487 -5632.5814 3387.69765   160%     - 1573s
     0     0 3379.07618    0  494 -5632.5814 3379.07618   160%     - 1585s
     0     0 3375.27311    0  493 -5632.5814 3375.27311   160%     - 1593s
     0     0 3373.90609    0  485 -5632.5814 3373.90609   160%     - 1597s
     0     0 3357.18643    0  658 -5632.5814 3357.18643   160%     - 1626s
     0     0 3351.44884    0  506 -5632.5814 3351.44884   160%     - 1638s
     0     0 3350.00002    0  508 -5632.5814 3350.00002   159%     - 1644s
     0     0 3338.64560    0  503 -5632.5814 3338.64560   159%     - 1658s
     0     0 3328.95377    0  515 -5632.5814 3328.95377   159%     - 1673s
     0     0 3319.46976    0  569 -5632.5814 3319.46976   159%     - 1690s
     0     0 3317.48891    0  586 -5632.5814 3317.48891   159%     - 1701s
     0     0 3307.94476    0  499 -5632.5814 3307.94476   159%     - 1712s
H    0     0                    -5630.471057 3307.61721   159%     - 1713s
     0     0 3306.00493    0  575 -5630.4711 3306.00493   159%     - 1721s
     0     0 3302.22146    0  644 -5630.4711 3302.22146   159%     - 1732s
     0     0 3300.18451    0  504 -5630.4711 3300.18451   159%     - 1747s
     0     0 3297.52466    0  505 -5630.4711 3297.52466   159%     - 1755s
     0     0 3297.46066    0  505 -5630.4711 3297.46066   159%     - 1763s
     0     2 3297.46066    0  505 -5630.4711 3297.46066   159%     - 1944s
     1     3 2605.26566    1  368 -5630.4711 3297.40904   159% 10216 1966s
     2     4 3095.94796    1  643 -5630.4711 3095.94796   155% 11958 1991s
     3     6 1901.44064    2  384 -5630.4711 3095.94449   155% 11392 2015s
     5    11 1169.47947    3  411 -5630.4711 3095.94449   155% 11632 2043s
    10    20  586.63076    4  397 -5630.4711 2788.53258   150% 11114 2087s
    19    29  396.22528    4  352 -5630.4711 2788.53258   150% 18136 2159s
H   28    57                    -5619.832933 2199.55295   139% 15660 2340s
    56    89 1317.64535    5  545 -5619.8329 2127.03905   138% 21361 2397s
    88   190 1271.05480    6  553 -5619.8329 1958.47803   135% 19631 2453s
   189   272 1180.69166    9  550 -5619.8329 1958.43536   135% 11342 2490s
   271   301 -2353.4152   16  183 -5619.8329 1958.43536   135%  9027 2531s
   300   332  954.51678   10  537 -5619.8329 1958.43536   135%  8966 2603s
   341   379  864.37586   11  523 -5619.8329 1958.43536   135%  8600 2633s
   394   426  703.26356   12  523 -5619.8329 1958.43536   135%  8236 2663s
   455   467 -1637.4176   13  191 -5619.8329 1958.43536   135%  8087 2692s
   512   515 -3207.3385   14  167 -5619.8329 1958.43536   135%  7768 2715s
   569   533 -3703.1901   16  147 -5619.8329 1958.43536   135%  7682 2742s
   626   553 -3914.4901   18  148 -5619.8329 1958.43536   135%  7406 2769s
   683   576     cutoff   22      -5619.8329 1958.43536   135%  7284 2795s
   724   605 infeasible   23      -5619.8329 1958.43536   135%  7261 2821s
   781   623 -2480.9379   16  316 -5619.8329 1958.43536   135%  7241 2846s
   825   665 -2659.6417   17  295 -5619.8329 1958.43536   135%  7183 2878s
   885   706     cutoff   18      -5619.8329 1958.43536   135%  7245 2910s
   968   723 -3209.1052   18  500 -5619.8329 1958.43536   135%  7122 2938s
  1037   731 -3317.3536   19  577 -5619.8329 1958.43536   135%  7080 2966s
  1087   751 -3388.2755   20  579 -5619.8329 1958.43536   135%  7032 3009s
  1137   779 -3639.9110   22  629 -5619.8329 1958.43536   135%  7204 3041s
H 1175   779                    -5618.148603 1958.43536   135%  7252 3041s
  1189   810 -4065.3210   23  542 -5618.1486 1958.43536   135%  7361 3071s
  1240   850 -4956.7321   24  519 -5618.1486 1958.43536   135%  7457 3107s
  1316   901 -4518.2358   27  316 -5618.1486 1958.43536   135%  7501 3139s
  1417   900 infeasible   25      -5618.1486 1958.43536   135%  7446 3173s
  1478   898 -4959.1422   25  530 -5618.1486 1958.43536   135%  7526 3213s
  1538   900 -5279.8886   26  533 -5618.1486 1958.43536   135%  7660 3256s
  1596   913 infeasible   26      -5618.1486 1958.43536   135%  7719 3302s
  1647   921 -2303.1917   13  243 -5618.1486 1958.43536   135%  7811 3349s
  1709   961 -5244.4771   14  199 -5618.1486 1958.43536   135%  7891 3398s
  1761   991 -5372.9162   15  176 -5618.1486 1958.43536   135%  8071 3442s
  1874  1014     cutoff   14      -5618.1486 1958.43536   135%  8071 3494s
  1966  1045 -645.25982    7  318 -5618.1486 1958.43536   135%  8103 3546s
  2046  1060 -756.54824    8  468 -5618.1486 1958.43536   135%  8142 3596s
  2097  1056 infeasible   14      -5618.1486 1958.43536   135%  8199 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 205
  MIR: 3216
  Flow cover: 3342
  Zero half: 6
  RLT: 149
  Relax-and-lift: 902

Explored 2101 nodes (18116082 simplex iterations) in 3600.07 seconds (5243.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5618.15 -5619.83 -5630.47 ... -6907.17

Time limit reached
Best objective -5.618148602628e+03, best bound 1.958435362732e+03, gap 134.8591%
  WARNING: Time limit reached. Using best solution found (gap: 134.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -5618.15, θ = 120372.21
  Upper Bound (UB) = -5618.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120372.21
  [DEBUG]   ✓ Scenario 0: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120372.21 ≤ Q = 120372.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120372.21 ≤ Q = 120372.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120372.21 ≤ Q = 120372.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120372.21 ≤ Q = 120372.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120372.21 ≤ Q = 120372.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x28a854ba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd757ab46
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362774e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6437543.0195
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.443875e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144387.46    0  124 6437543.02 -144387.46   102%     -    0s
H    0     0                    -110515.0627 -144387.46  30.6%     -    0s
H    0     0                    -111500.7980 -144387.46  29.5%     -    0s
     0     0 -120696.65    0  129 -111500.80 -120696.65  8.25%     -    0s
H    0     0                    -114955.7560 -120545.54  4.86%     -    0s
     0     0 -119415.81    0  128 -114955.76 -119415.81  3.88%     -    0s
H    0     0                    -115478.4660 -119413.09  3.41%     -    0s
     0     0 -119399.02    0  128 -115478.47 -119399.02  3.40%     -    0s
H    0     0                    -115520.4329 -118596.57  2.66%     -    0s
     0     0 -118596.57    0  126 -115520.43 -118596.57  2.66%     -    0s
H    0     0                    -115567.3819 -118565.69  2.59%     -    0s
     0     0 -118565.69    0  124 -115567.38 -118565.69  2.59%     -    0s
     0     0 -118565.61    0  124 -115567.38 -118565.61  2.59%     -    0s
     0     0 -118102.29    0  138 -115567.38 -118102.29  2.19%     -    0s
     0     0 -118034.57    0  137 -115567.38 -118034.57  2.13%     -    0s
     0     0 -118034.57    0  137 -115567.38 -118034.57  2.13%     -    0s
     0     0 -117524.87    0  121 -115567.38 -117524.87  1.69%     -    0s
     0     0 -117419.45    0  120 -115567.38 -117419.45  1.60%     -    0s
     0     0 -117287.73    0  115 -115567.38 -117287.73  1.49%     -    0s
     0     0 -117287.14    0  115 -115567.38 -117287.14  1.49%     -    0s
H    0     0                    -115832.4086 -117275.14  1.25%     -    0s
     0     2 -117275.14    0  115 -115832.41 -117275.14  1.25%     -    0s
H   32    62                    -115886.2004 -116919.72  0.89%  15.0    0s
H   37    62                    -115903.8038 -116919.72  0.88%  14.4    0s
H   61    62                    -115932.7315 -116895.92  0.83%  15.4    0s
* 1983  1206              32    -115950.5133 -116647.68  0.60%   7.3    0s
* 2465  1416              28    -115984.4497 -116646.60  0.57%   7.1    0s
H 4079  1805                    -116003.7206 -116494.99  0.42%   7.4    0s

Cutting planes:
  Gomory: 47
  Implied bound: 1
  MIR: 222
  RLT: 9
  BQP: 2

Explored 18011 nodes (143060 simplex iterations) in 0.71 seconds (0.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -116004 -115984 -115951 ... -115478
No other solutions better than -116004

Optimal solution found (tolerance 1.00e-06)
Best objective -1.160037206445e+05, best bound -1.160037206445e+05, gap 0.0000%
  Subproblem solved in 0.74s
  Worst-case operational profit (Z_SP) = 117516.63
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116003.72
  [DEBUG]   S×d_nominal = 233520.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233520.35 + -116003.72 = 117516.63
  [DEBUG]   Current θ from Master = 120372.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2855.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8473.73
  Lower Bound (LB) = -8473.73
  Gap (UB-LB) = 2855.5825, Absolute Gap = 2855.5825, Relative Gap = 0.508278
  Not converged yet (gap = 2855.58 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x417f0a31
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns (presolve time = 5s)...
Presolve removed 98980 rows and 40180 columns
Presolve time: 5.22s
Presolved: 116463 rows, 49440 columns, 701851 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -400408.6688
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.36s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 4.435e+06
 Factor NZ  : 1.059e+07 (roughly 150 MB of memory)
 Factor Ops : 2.084e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80917260e+07  2.26068026e+08  1.02e+05 1.56e+01  8.10e+04     9s
   1  -1.37474025e+07  1.96396322e+08  7.09e+04 5.73e+01  5.60e+04     9s
   2  -5.31603204e+06  1.49553865e+08  2.71e+04 7.44e-01  2.23e+04     9s
   3  -1.11780231e+06  1.25664877e+08  2.41e+03 3.65e+00  2.47e+03     9s
   4  -6.97038462e+05  7.76211190e+07  4.69e+02 1.69e+00  7.07e+02     9s
   5  -5.63859441e+05  4.38797524e+07  3.50e+02 7.51e-01  4.37e+02     9s
   6  -4.85517046e+05  3.60769286e+07  2.42e+02 5.16e-01  3.23e+02     9s
   7  -4.12082818e+05  2.63764710e+07  1.48e+02 1.32e-01  2.11e+02     9s
   8  -2.87185602e+05  1.92893898e+07  2.04e+01 2.71e-02  1.02e+02     9s
   9  -1.42326239e+05  1.04216608e+07  1.75e+00 1.44e-02  5.02e+01     9s
  10  -9.68369194e+04  2.91620081e+06  9.02e-01 3.93e-03  1.42e+01    10s
  11  -7.15002400e+04  1.88497697e+06  5.30e-01 2.51e-03  9.22e+00    10s
  12  -4.49914804e+04  1.06723512e+06  2.99e-01 1.37e-03  5.23e+00    10s
  13  -3.67048379e+04  6.30319782e+05  2.14e-01 7.90e-04  3.14e+00    10s
  14  -2.18087081e+04  2.75882193e+05  8.25e-02 3.09e-04  1.40e+00    10s
  15  -1.57804561e+04  1.49082022e+05  5.83e-02 2.35e-04  7.74e-01    10s
  16  -9.55980592e+03  9.48901073e+04  4.26e-02 1.46e-04  4.91e-01    10s
  17  -6.27766433e+03  7.75278143e+04  3.56e-02 2.84e-04  3.94e-01    10s
  18  -8.21604308e+02  6.45662546e+04  2.63e-02 6.41e-04  3.07e-01    10s
  19   2.90182945e+03  4.77689921e+04  2.06e-02 1.03e-03  2.11e-01    10s
  20   5.92215868e+03  4.00261516e+04  1.64e-02 7.16e-04  1.60e-01    10s
  21   7.36383751e+03  3.18008160e+04  1.44e-02 4.51e-04  1.15e-01    10s
  22   8.93808261e+03  2.97139128e+04  1.22e-02 3.77e-04  9.76e-02    11s
  23   1.11829755e+04  2.64968488e+04  9.19e-03 2.66e-04  7.19e-02    11s
  24   1.20539490e+04  2.53012405e+04  8.03e-03 2.27e-04  6.22e-02    11s
  25   1.29781700e+04  2.36965300e+04  6.86e-03 1.93e-04  5.03e-02    11s
  26   1.39891173e+04  2.21850970e+04  5.65e-03 1.61e-04  3.85e-02    11s
  27   1.51263674e+04  2.13430878e+04  4.27e-03 1.03e-04  2.92e-02    11s
  28   1.57491689e+04  2.06216151e+04  3.55e-03 1.17e-04  2.29e-02    11s
  29   1.62757318e+04  2.02967349e+04  2.95e-03 9.69e-05  1.89e-02    11s
  30   1.65308097e+04  2.01096785e+04  2.63e-03 8.42e-05  1.68e-02    11s
  31   1.70917045e+04  1.99352436e+04  1.97e-03 7.37e-05  1.34e-02    12s
  32   1.74010272e+04  1.97245837e+04  1.60e-03 5.49e-05  1.09e-02    12s
  33   1.76124962e+04  1.95956723e+04  1.34e-03 4.71e-05  9.31e-03    12s
  34   1.76526005e+04  1.95443224e+04  1.29e-03 4.41e-05  8.88e-03    12s
  35   1.78739944e+04  1.94983233e+04  1.04e-03 4.13e-05  7.63e-03    12s
  36   1.80425442e+04  1.93265416e+04  8.47e-04 3.15e-05  6.03e-03    12s
  37   1.81869707e+04  1.92162958e+04  6.78e-04 2.46e-05  4.83e-03    12s
  38   1.82415689e+04  1.90978443e+04  6.11e-04 2.05e-05  4.02e-03    12s
  39   1.82837286e+04  1.90926878e+04  5.62e-04 2.00e-05  3.80e-03    13s
  40   1.84090364e+04  1.90602400e+04  4.27e-04 1.79e-05  3.06e-03    13s
  41   1.84499307e+04  1.89602212e+04  3.80e-04 1.11e-05  2.40e-03    13s
  42   1.85300612e+04  1.89289433e+04  2.93e-04 8.92e-06  1.87e-03    13s
  43   1.85625757e+04  1.88950603e+04  2.56e-04 6.56e-06  1.56e-03    13s
  44   1.85825461e+04  1.88938839e+04  2.34e-04 6.45e-06  1.46e-03    13s
  45   1.86165795e+04  1.88787353e+04  1.96e-04 5.46e-06  1.23e-03    13s
  46   1.86651785e+04  1.88538685e+04  1.41e-04 3.73e-06  8.86e-04    13s
  47   1.86744605e+04  1.88443389e+04  1.31e-04 3.11e-06  7.98e-04    14s
  48   1.86799092e+04  1.88390719e+04  1.25e-04 2.78e-06  7.47e-04    14s
  49   1.87141286e+04  1.88309467e+04  8.78e-05 2.26e-06  5.49e-04    14s
  50   1.87186210e+04  1.88275812e+04  8.30e-05 2.03e-06  5.12e-04    14s
  51   1.87317839e+04  1.88150707e+04  6.83e-05 1.16e-06  3.91e-04    14s
  52   1.87407989e+04  1.88135956e+04  5.86e-05 1.07e-06  3.42e-04    14s
  53   1.87432119e+04  1.88126228e+04  5.61e-05 1.01e-06  3.26e-04    14s
  54   1.87639335e+04  1.88083277e+04  3.33e-05 1.31e-06  2.08e-04    14s
  55   1.87710351e+04  1.88065788e+04  2.60e-05 1.27e-06  1.67e-04    15s
  56   1.87837949e+04  1.88040827e+04  1.24e-05 5.67e-07  9.53e-05    15s
  57   1.87881571e+04  1.87977875e+04  7.82e-06 9.89e-08  4.52e-05    15s
  58   1.87894862e+04  1.87969706e+04  6.51e-06 4.99e-07  3.51e-05    15s
  59   1.87929230e+04  1.87966481e+04  3.04e-06 2.54e-07  1.75e-05    15s
  60   1.87956945e+04  1.87965753e+04  5.18e-07 1.89e-07  4.14e-06    15s
  61   1.87959164e+04  1.87963714e+04  3.25e-07 3.80e-08  2.14e-06    15s
  62   1.87962005e+04  1.87963189e+04  9.04e-08 5.37e-09  5.56e-07    15s
  63   1.87962541e+04  1.87963159e+04  2.69e-07 1.19e-09  2.90e-07    16s
  64   1.87962641e+04  1.87963157e+04  2.15e-06 3.16e-06  2.43e-07    16s
  65   1.87962745e+04  1.87963156e+04  2.11e-06 4.00e-06  1.93e-07    16s
  66   1.87962753e+04  1.87963156e+04  3.31e-06 3.79e-06  1.89e-07    16s
  67   1.87962755e+04  1.87963156e+04  3.86e-06 3.78e-06  1.89e-07    16s
  68   1.87962771e+04  1.87963156e+04  3.94e-06 3.72e-06  1.80e-07    16s
  69   1.87962780e+04  1.87963155e+04  3.82e-06 3.80e-06  1.76e-07    16s
  70   1.87962846e+04  1.87963154e+04  2.76e-06 6.73e-06  1.45e-07    16s
  71   1.87962846e+04  1.87963154e+04  3.11e-06 6.73e-06  1.45e-07    16s
  72   1.87962869e+04  1.87963154e+04  8.13e-06 5.41e-06  1.35e-07    17s
  73   1.87962884e+04  1.87963154e+04  6.75e-06 5.20e-06  1.28e-07    17s
  74   1.87962902e+04  1.87963154e+04  4.48e-06 4.96e-06  1.19e-07    17s
  75   1.87962921e+04  1.87963154e+04  7.94e-06 4.64e-06  1.11e-07    17s
  76   1.87962929e+04  1.87963154e+04  7.43e-06 4.62e-06  1.07e-07    17s
  77   1.87962951e+04  1.87963154e+04  6.40e-06 3.10e-06  9.61e-08    17s
  78   1.87962963e+04  1.87963154e+04  6.75e-06 2.94e-06  9.12e-08    17s
  79   1.87962990e+04  1.87963153e+04  1.36e-05 2.80e-06  7.93e-08    18s
  80   1.87962992e+04  1.87963153e+04  1.30e-05 2.74e-06  7.90e-08    18s
  81   1.87963034e+04  1.87963154e+04  7.35e-06 2.83e-06  5.67e-08    18s
  82   1.87963035e+04  1.87963154e+04  7.43e-06 2.78e-06  5.64e-08    18s
  83   1.87963050e+04  1.87963154e+04  6.34e-06 2.70e-06  4.91e-08    18s
  84   1.87963055e+04  1.87963154e+04  5.96e-06 2.57e-06  4.66e-08    18s
  85   1.87963058e+04  1.87963154e+04  5.64e-06 2.35e-06  4.52e-08    18s
  86   1.87963064e+04  1.87963153e+04  5.39e-06 2.17e-06  4.24e-08    18s
  87   1.87963060e+04  1.87963153e+04  4.99e-06 2.17e-06  4.24e-08    19s
  88   1.87963065e+04  1.87963157e+04  4.63e-06 1.80e-06  4.19e-08    19s
  89   1.87963071e+04  1.87963157e+04  4.38e-06 1.59e-06  3.92e-08    19s
  90   1.87963071e+04  1.87963157e+04  4.46e-06 1.59e-06  3.92e-08    19s
  91   1.87963080e+04  1.87963156e+04  6.85e-06 1.36e-06  3.50e-08    19s
  92   1.87963085e+04  1.87963156e+04  6.42e-06 1.31e-06  3.28e-08    19s
  93   1.87963086e+04  1.87963155e+04  6.22e-06 1.13e-06  3.21e-08    19s
  94   1.87963087e+04  1.87963155e+04  6.11e-06 1.13e-06  3.12e-08    20s
  95   1.87963094e+04  1.87963155e+04  5.75e-06 9.02e-07  2.81e-08    20s
  96   1.87963100e+04  1.87963155e+04  4.84e-06 8.91e-07  2.54e-08    20s
  97   1.87963101e+04  1.87963154e+04  4.79e-06 7.53e-07  2.46e-08    20s
  98   1.87963108e+04  1.87963154e+04  3.80e-06 7.61e-07  2.12e-08    20s
  99   1.87963108e+04  1.87963154e+04  3.49e-06 7.61e-07  2.12e-08    20s
 100   1.87963113e+04  1.87963154e+04  2.78e-06 5.44e-07  1.89e-08    20s
 101   1.87963113e+04  1.87963154e+04  3.04e-06 5.40e-07  1.86e-08    21s
 102   1.87963114e+04  1.87963154e+04  2.46e-06 5.25e-07  1.81e-08    21s
 103   1.87963115e+04  1.87963154e+04  2.17e-06 5.01e-07  1.78e-08    21s
 104   1.87963116e+04  1.87963154e+04  2.13e-06 4.24e-07  1.72e-08    21s
 105   1.87963118e+04  1.87963153e+04  2.08e-06 3.64e-07  1.67e-08    21s
 106   1.87963117e+04  1.87963153e+04  2.21e-06 3.64e-07  1.67e-08    21s
 107   1.87963118e+04  1.87963153e+04  2.06e-06 2.36e-07  1.61e-08    21s
 108   1.87963123e+04  1.87963153e+04  4.61e-06 2.00e-07  1.40e-08    22s
 109   1.87963124e+04  1.87963153e+04  4.05e-06 2.12e-07  1.37e-08    22s
 110   1.87963124e+04  1.87963153e+04  4.28e-06 2.13e-07  1.37e-08    22s
 111   1.87963124e+04  1.87963153e+04  3.98e-06 2.12e-07  1.36e-08    22s
 112   1.87963126e+04  1.87963153e+04  3.35e-06 2.08e-07  1.29e-08    22s
 113   1.87963126e+04  1.87963153e+04  3.32e-06 2.04e-07  1.28e-08    22s
 114   1.87963126e+04  1.87963153e+04  3.35e-06 2.05e-07  1.27e-08    22s
 115   1.87963128e+04  1.87963153e+04  3.87e-06 1.57e-07  1.11e-08    23s
 116   1.87963138e+04  1.87963153e+04  5.18e-06 1.81e-07  6.83e-09    23s
 117   1.87963138e+04  1.87963153e+04  4.52e-06 1.81e-07  6.83e-09    23s
 118   1.87963140e+04  1.87963153e+04  4.46e-06 1.68e-07  5.82e-09    23s
 119   1.87963140e+04  1.87963153e+04  4.36e-06 1.66e-07  5.77e-09    23s

Barrier solved model in 119 iterations and 23.28 seconds (22.98 work units)
Optimal objective 1.87963140e+04


Root crossover log...

   89276 DPushes remaining with DInf 0.0000000e+00                23s
   24664 DPushes remaining with DInf 0.0000000e+00                25s
    2034 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                31s

   42432 PPushes remaining with PInf 1.5375484e-04                31s
       0 PPushes remaining with PInf 4.7649467e-04                34s

  Push phase complete: Pinf 4.7649467e-04, Dinf 2.8419636e+06     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   89450    1.8795354e+04   0.000000e+00   2.841964e+06     34s
   90214    1.8796159e+04   0.000000e+00   1.658226e+05     35s
   93461    1.8796299e+04   0.000000e+00   7.035110e+02     40s
   93789    1.8796315e+04   0.000000e+00   0.000000e+00     41s
   93789    1.8796315e+04   0.000000e+00   0.000000e+00     41s
Concurrent spin time: 3.01s

Solved with barrier

Root relaxation: objective 1.879632e+04, 93789 iterations, 37.20 seconds (47.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18796.3152    0  493 -177247.82 18796.3152   111%     -   45s
H    0     0                    -150814.4801 18796.3152   112%     -   45s
H    0     0                    -149867.1448 18796.3152   113%     -   45s
H    0     0                    -131651.9506 18796.3152   114%     -   45s
H    0     0                    -130957.3938 18796.3152   114%     -   45s
H    0     0                    -119467.0040 18796.3152   116%     -   46s
H    0     0                    -112379.8071 18796.3152   117%     -   46s
H    0     0                    -112261.3085 18796.3152   117%     -   46s
H    0     0                    -111121.9881 18796.3152   117%     -   46s
H    0     0                    -100871.1403 18796.3152   119%     -   46s
H    0     0                    -100843.2842 18796.3152   119%     -   46s
H    0     0                    -77814.96030 18796.3152   124%     -   49s
H    0     0                    -59868.58605 18796.3152   131%     -   49s
H    0     0                    -59086.72369 18796.3152   132%     -   49s
H    0     0                    -58810.88247 13542.7275   123%     -  144s
H    0     0                    -58636.07401 13542.7275   123%     -  144s
     0     0 13509.8376    0  657 -58636.074 13509.8376   123%     -  145s
H    0     0                    -58632.45560 13509.8376   123%     -  146s
H    0     0                    -52900.79274 13509.8376   126%     -  146s
H    0     0                    -52881.79179 13509.8376   126%     -  146s
H    0     0                    -52837.68414 13509.8376   126%     -  146s
H    0     0                    -52779.08817 13509.8376   126%     -  146s
     0     0 12579.7490    0  615 -52779.088 12579.7490   124%     -  195s
     0     0 12276.2230    0  564 -52779.088 12276.2230   123%     -  227s
     0     0 12234.5287    0  557 -52779.088 12234.5287   123%     -  240s
     0     0 12174.3458    0  546 -52779.088 12174.3458   123%     -  251s
     0     0 12168.7776    0  544 -52779.088 12168.7776   123%     -  255s
     0     0 12167.5809    0  539 -52779.088 12167.5809   123%     -  262s
     0     0 12167.5809    0  551 -52779.088 12167.5809   123%     -  266s
     0     0 12167.5809    0  541 -52779.088 12167.5809   123%     -  275s
     0     0 12167.5809    0  526 -52779.088 12167.5809   123%     -  283s
     0     0 12167.5809    0  537 -52779.088 12167.5809   123%     -  288s
     0     0 12167.5809    0  537 -52779.088 12167.5809   123%     -  291s
H    0     0                    -41133.08240 10111.6894   125%     -  365s
H    0     0                    -40903.93025 10111.6894   125%     -  365s
H    0     0                    -40294.86138 10111.6894   125%     -  365s
H    0     0                    -40280.07195 10111.6894   125%     -  365s
H    0     0                    -40033.83295 10111.6894   125%     -  365s
H    0     0                    -40019.04351 10111.6894   125%     -  365s
     0     0 10108.7704    0  484 -40019.044 10108.7704   125%     -  365s
H    0     0                    -29745.31727 10108.7704   134%     -  366s
H    0     0                    -28986.57770 10108.7704   135%     -  366s
H    0     0                    -28913.72165 10108.7704   135%     -  366s
H    0     0                    -28732.33619 10108.7704   135%     -  367s
H    0     0                    -28714.54428 10108.7704   135%     -  367s
H    0     0                    -28704.28544 10108.7704   135%     -  367s
H    0     0                    -28686.49354 10108.7704   135%     -  367s
H    0     0                    -28673.13882 10108.7704   135%     -  367s
     0     0 9163.51458    0  569 -28673.139 9163.51458   132%     -  450s
     0     0 8978.20853    0  660 -28673.139 8978.20853   131%     -  490s
     0     0 8936.55929    0  585 -28673.139 8936.55929   131%     -  511s
     0     0 8716.45396    0  624 -28673.139 8716.45396   130%     -  539s
     0     0 8658.97530    0  563 -28673.139 8658.97530   130%     -  558s
     0     0 8648.52948    0  567 -28673.139 8648.52948   130%     -  564s
H    0     0                    -22789.70156 8646.54065   138%     -  570s
H    0     0                    -19539.50871 8646.54065   144%     -  570s
     0     0 8646.54065    0  587 -19539.509 8646.54065   144%     -  570s
     0     0 8616.73640    0  585 -19539.509 8616.73640   144%     -  583s
     0     0 8591.48155    0  666 -19539.509 8591.48155   144%     -  601s
     0     0 8585.66192    0  674 -19539.509 8585.66192   144%     -  605s
     0     0 8581.69753    0  661 -19539.509 8581.69753   144%     -  609s
     0     0 8581.38090    0  666 -19539.509 8581.38090   144%     -  611s
     0     0 6916.25542    0  596 -19539.509 6916.25542   135%     -  743s
H    0     0                    -19502.00592 6916.21844   135%     -  745s
     0     0 6271.14896    0  617 -19502.006 6271.14896   132%     -  828s
H    0     0                    -9258.029464 6109.28539   166%     -  862s
H    0     0                    -7925.592345 6109.28539   177%     -  862s
H    0     0                    -7829.686800 6109.28539   178%     -  862s
H    0     0                    -7816.776908 6109.28539   178%     -  862s
     0     0 6109.28539    0  578 -7816.7769 6109.28539   178%     -  862s
     0     0 6050.24009    0  596 -7816.7769 6050.24009   177%     -  882s
H    0     0                    -7787.223275 5921.52044   176%     -  911s
     0     0 5921.52044    0  616 -7787.2233 5921.52044   176%     -  911s
     0     0 5840.21281    0  627 -7787.2233 5840.21281   175%     -  930s
     0     0 5813.45355    0  615 -7787.2233 5813.45355   175%     -  946s
     0     0 5739.70292    0  598 -7787.2233 5739.70292   174%     -  982s
     0     0 5712.04253    0  621 -7787.2233 5712.04253   173%     - 1004s
     0     0 5693.13756    0  600 -7787.2233 5693.13756   173%     - 1019s
     0     0 5657.47942    0  612 -7787.2233 5657.47942   173%     - 1040s
     0     0 5643.32136    0  611 -7787.2233 5643.32136   172%     - 1054s
     0     0 5633.63500    0  596 -7787.2233 5633.63500   172%     - 1062s
     0     0 5627.97434    0  605 -7787.2233 5627.97434   172%     - 1069s
     0     0 5626.41149    0  605 -7787.2233 5626.41149   172%     - 1072s
     0     0 4494.64562    0  522 -7787.2233 4494.64562   158%     - 1183s
     0     0 4284.13111    0  474 -7787.2233 4284.13111   155%     - 1229s
     0     0 4214.01355    0  480 -7787.2233 4214.01355   154%     - 1257s
     0     0 4172.58716    0  568 -7787.2233 4172.58716   154%     - 1277s
H    0     0                    -7678.242948 4126.28992   154%     - 1306s
H    0     0                    -7672.730769 4126.28992   154%     - 1306s
     0     0 4126.28992    0  488 -7672.7308 4126.28992   154%     - 1306s
     0     0 4108.58259    0  492 -7672.7308 4108.58259   154%     - 1332s
     0     0 4102.08974    0  656 -7672.7308 4102.08974   153%     - 1348s
     0     0 4088.09078    0  489 -7672.7308 4088.09078   153%     - 1361s
     0     0 4049.81861    0  473 -7672.7308 4049.81861   153%     - 1385s
     0     0 4035.80521    0  476 -7672.7308 4035.80521   153%     - 1402s
     0     0 4032.24316    0  475 -7672.7308 4032.24316   153%     - 1408s
     0     0 4031.77121    0  478 -7672.7308 4031.77121   153%     - 1411s
     0     0 3864.41234    0  630 -7672.7308 3864.41234   150%     - 1462s
     0     0 3785.45785    0  731 -7672.7308 3785.45785   149%     - 1507s
     0     0 3701.60599    0  704 -7672.7308 3701.60599   148%     - 1546s
     0     0 3695.98766    0  479 -7672.7308 3695.98766   148%     - 1570s
     0     0 3690.24664    0  629 -7672.7308 3690.24664   148%     - 1584s
     0     0 3672.93843    0  639 -7672.7308 3672.93843   148%     - 1606s
     0     0 3659.92425    0  635 -7672.7308 3659.92425   148%     - 1622s
     0     0 3656.98297    0  652 -7672.7308 3656.98297   148%     - 1630s
     0     0 3656.36097    0  652 -7672.7308 3656.36097   148%     - 1637s
     0     0 3578.00114    0  706 -7672.7308 3578.00114   147%     - 1701s
     0     0 3532.90237    0  729 -7672.7308 3532.90237   146%     - 1758s
     0     0 3472.72945    0  487 -7672.7308 3472.72945   145%     - 1778s
     0     0 3466.73220    0  492 -7672.7308 3466.73220   145%     - 1793s
     0     0 3464.03124    0  496 -7672.7308 3464.03124   145%     - 1806s
     0     0 3462.75954    0  499 -7672.7308 3462.75954   145%     - 1819s
     0     0 3423.53046    0  749 -7672.7308 3423.53046   145%     - 1850s
     0     0 3417.46448    0  739 -7672.7308 3417.46448   145%     - 1871s
     0     0 3412.85799    0  505 -7672.7308 3412.85799   144%     - 1879s
     0     0 3401.87634    0  829 -7672.7308 3401.87634   144%     - 1896s
     0     0 3397.08122    0  500 -7672.7308 3397.08122   144%     - 1907s
     0     0 3394.01059    0  811 -7672.7308 3394.01059   144%     - 1921s
     0     0 3392.55362    0  502 -7672.7308 3392.55362   144%     - 1929s
     0     0 3348.67075    0  747 -7672.7308 3348.67075   144%     - 1958s
     0     0 3333.64682    0  760 -7672.7308 3333.64682   143%     - 1988s
     0     0 3326.50813    0  757 -7672.7308 3326.50813   143%     - 2003s
     0     0 3319.47841    0  754 -7672.7308 3319.47841   143%     - 2016s
     0     0 3316.71006    0  750 -7672.7308 3316.71006   143%     - 2028s
     0     0 3315.72471    0  741 -7672.7308 3315.72471   143%     - 2034s
     0     0 3296.17199    0  498 -7672.7308 3296.17199   143%     - 2072s
     0     0 3286.52982    0  576 -7672.7308 3286.52982   143%     - 2104s
     0     0 3283.21638    0  514 -7672.7308 3283.21638   143%     - 2117s
     0     0 3281.95232    0  519 -7672.7308 3281.95232   143%     - 2126s
     0     0 3275.97049    0  518 -7672.7308 3275.97049   143%     - 2142s
     0     0 3267.74581    0  510 -7672.7308 3267.74581   143%     - 2159s
     0     0 3266.38985    0  517 -7672.7308 3266.38985   143%     - 2172s
     0     0 3256.44504    0  514 -7672.7308 3256.44504   142%     - 2189s
     0     0 3256.35555    0  514 -7672.7308 3256.35555   142%     - 2197s
H    0     0                    -6843.717601 3256.34622   148%     - 2538s
H    0     0                    -6707.275330 3256.34622   149%     - 2543s
H    0     0                    -6316.614209 3256.34622   152%     - 2545s
     0     2 3256.34622    0  514 -6316.6142 3256.34622   152%     - 2550s
     1     3 3190.10733    1  553 -6316.6142 3256.04199   152% 16792 2585s
     2     4 3113.72115    1  470 -6316.6142 3190.10688   151% 11772 2614s
     3     7 1359.40648    2  430 -6316.6142 3190.07599   151% 11817 2651s
     6    14 2428.17137    3  466 -6316.6142 3113.35217   149% 13408 2708s
    13    28 1391.44040    4  383 -6316.6142 2755.46519   144% 12762 2753s
    27    40  357.78544    5  532 -6316.6142 2069.40749   133% 20959 2869s
    41    70  927.39140    6  531 -6316.6142 2069.40749   133% 19574 3147s
H   42    70                    -6264.163738 2069.40749   133% 19108 3147s
H   45    70                    -6222.772878 2069.40749   133% 18724 3147s
H   48    70                    -5632.697017 2069.40749   137% 18188 3147s
H   50    70                    -5624.700569 2069.40749   137% 17629 3147s
    71   189  182.57332    7  367 -5624.7006 2069.40749   137% 19388 3234s
H  147   189                    -5619.832933 2069.40749   137% 14833 3234s
   190   276   92.79035   10  493 -5619.8329 2069.40749   137% 13555 3274s
   281   328   91.13897   11  489 -5619.8329 2069.40749   137% 10726 3306s
   355   370 -396.66877   12  489 -5619.8329 2069.40749   137%  9966 3336s
   415   398 -1429.3931   12  225 -5619.8329 2069.40749   137%  9463 3370s
   476   418 -4528.8420   10  188 -5619.8329 2069.40749   137%  9089 3401s
   523   442 -5340.0833   22  126 -5619.8329 2069.40749   137%  8869 3434s
   581   480 -1815.0649   13  200 -5619.8329 2069.40749   137%  8471 3460s
   650   493 -2360.6831   14  200 -5619.8329 2069.40749   137%  8087 3489s
   725   503 -3554.9344   15  191 -5619.8329 2069.40749   137%  7989 3516s
   787   515 -4573.9124   14  205 -5619.8329 2069.40749   137%  7920 3542s
   845   524 -4673.2075   16  169 -5619.8329 2069.40749   137%  7925 3567s
   895   526 infeasible   17      -5619.8329 2069.40749   137%  7944 3595s
   947   518 infeasible   18      -5619.8329 2069.40749   137%  7922 3600s

Cutting planes:
  Learned: 2
  Implied bound: 168
  MIR: 2758
  Flow cover: 3114
  Zero half: 6
  RLT: 167
  Relax-and-lift: 929
  PSD: 1

Explored 955 nodes (8694126 simplex iterations) in 3600.07 seconds (5022.70 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5619.83 -5624.7 -5632.7 ... -7678.24

Time limit reached
Best objective -5.619832932829e+03, best bound 2.069407485109e+03, gap 136.8233%
  WARNING: Time limit reached. Using best solution found (gap: 136.82%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -5619.83, θ = 119897.97
  Upper Bound (UB) = -5619.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119897.97
  [DEBUG]   ✓ Scenario 0: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 119897.97 ≤ Q = 119897.97 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x446cd265
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x446cd265
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373552e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6429936.4622
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.445997e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144599.74    0  124 6429936.46 -144599.74   102%     -    0s
H    0     0                    -110772.7475 -144599.74  30.5%     -    0s
H    0     0                    -111732.4640 -144599.74  29.4%     -    0s
     0     0 -121599.50    0   84 -111732.46 -121599.50  8.83%     -    0s
H    0     0                    -116560.6795 -121453.73  4.20%     -    0s
H    0     0                    -117114.0311 -121453.73  3.71%     -    0s
H    0     0                    -117549.0565 -121453.73  3.32%     -    0s
H    0     0                    -118102.4081 -121453.73  2.84%     -    0s
     0     0 -120481.26    0   87 -118102.41 -120481.26  2.01%     -    0s
H    0     0                    -118288.1566 -120319.05  1.72%     -    0s
     0     0 -119807.85    0   89 -118288.16 -119807.85  1.28%     -    0s
     0     0 -119737.65    0   86 -118288.16 -119737.65  1.23%     -    0s
     0     0 -119733.29    0   85 -118288.16 -119733.29  1.22%     -    0s
     0     0 -119225.33    0   61 -118288.16 -119225.33  0.79%     -    0s
     0     0 -119038.92    0   50 -118288.16 -119038.92  0.63%     -    0s
     0     0 -119038.77    0   51 -118288.16 -119038.77  0.63%     -    0s
     0     0 -118959.57    0   21 -118288.16 -118959.57  0.57%     -    0s
     0     0 -118825.46    0   61 -118288.16 -118825.46  0.45%     -    0s
     0     0 -118823.73    0   61 -118288.16 -118823.73  0.45%     -    0s
     0     0 -118754.26    0   61 -118288.16 -118754.26  0.39%     -    0s
     0     0 -118743.18    0   61 -118288.16 -118743.18  0.38%     -    0s
     0     2 -118743.18    0   61 -118288.16 -118743.18  0.38%     -    0s
H   52    68                    -118324.0297 -118578.95  0.22%  11.4    0s
H  561   258                    -118334.9903 -118463.54  0.11%   4.3    0s

Cutting planes:
  Gomory: 25
  Implied bound: 12
  MIR: 115
  Flow cover: 7
  RLT: 68
  Relax-and-lift: 4
  BQP: 2

Explored 2043 nodes (9096 simplex iterations) in 0.41 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -118335 -118324 -118288 ... 1.37355e+13
No other solutions better than -118335

Optimal solution found (tolerance 1.00e-06)
Best objective -1.183349903209e+05, best bound -1.183349903209e+05, gap 0.0000%
  Subproblem solved in 0.45s
  Worst-case operational profit (Z_SP) = 114835.61
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118334.99
  [DEBUG]   S×d_nominal = 233170.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233170.60 + -118334.99 = 114835.61
  [DEBUG]   Current θ from Master = 119897.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5062.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10682.19
  Lower Bound (LB) = -8473.73
  Gap (UB-LB) = 2853.8982, Absolute Gap = 2853.8982, Relative Gap = 0.507826
  Not converged yet (gap = 2853.90 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xd17c0884
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 3.92s
Presolved: 124683 rows, 52810 columns, 767270 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.45s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 5.526e+06
 Factor NZ  : 1.225e+07 (roughly 170 MB of memory)
 Factor Ops : 2.568e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80255836e+07  2.38198670e+08  1.02e+05 1.46e+01  8.02e+04     7s
   1  -1.37987237e+07  2.06254051e+08  7.19e+04 5.01e+01  5.60e+04     7s
   2  -4.40692879e+06  1.57205487e+08  2.20e+04 9.13e-01  1.80e+04     8s
   3  -1.02155621e+06  1.09600860e+08  2.16e+03 1.00e+00  2.13e+03     8s
   4  -6.21877799e+05  5.24497626e+07  5.33e+02 2.53e-01  5.98e+02     8s
   5  -5.00906133e+05  3.31033379e+07  2.32e+02 1.30e-01  2.94e+02     8s
   6  -4.13534699e+05  2.70085216e+07  1.11e+02 9.93e-02  1.87e+02     8s
   7  -2.90349501e+05  1.92236946e+07  3.08e+01 6.47e-02  1.02e+02     8s
   8  -2.05586249e+05  1.36578538e+07  9.87e+00 4.37e-02  6.50e+01     8s
   9  -1.44813885e+05  5.06059662e+06  4.35e+00 1.49e-02  2.37e+01     8s
  10  -1.09102779e+05  2.40178898e+06  2.08e+00 6.75e-03  1.12e+01     8s
  11  -9.85550689e+04  1.42782163e+06  1.61e+00 3.94e-03  6.80e+00     8s
  12  -7.03998616e+04  1.06858300e+06  7.60e-01 2.90e-03  5.04e+00     8s
  13  -4.91369247e+04  3.81485139e+05  3.36e-01 1.11e-03  1.90e+00     9s
  14  -2.87089423e+04  1.77583732e+05  1.78e-01 6.32e-04  9.08e-01     9s
  15  -2.16238261e+04  1.11382768e+05  1.37e-01 8.49e-04  5.85e-01     9s
  16  -1.41486651e+04  8.27710395e+04  1.04e-01 1.70e-03  4.26e-01     9s
  17  -1.16173412e+04  6.63060402e+04  9.27e-02 1.94e-03  3.43e-01     9s
  18  -7.66097812e+03  5.05410289e+04  7.59e-02 1.36e-03  2.56e-01     9s
  19  -2.99879180e+03  3.96210907e+04  5.74e-02 1.48e-03  1.88e-01     9s
  20  -2.93981771e+01  3.26194686e+04  4.66e-02 2.04e-03  1.44e-01     9s
  21   3.09031669e+03  2.86127196e+04  3.58e-02 1.53e-03  1.12e-01     9s
  22   4.81760588e+03  2.44821946e+04  3.01e-02 1.07e-03  8.66e-02     9s
  23   6.48071612e+03  2.20657046e+04  2.52e-02 7.80e-04  6.86e-02    10s
  24   9.04806613e+03  2.04119029e+04  1.78e-02 6.86e-04  5.00e-02    10s
  25   1.01566464e+04  1.93886555e+04  1.47e-02 5.30e-04  4.06e-02    10s
  26   1.13115623e+04  1.85602327e+04  1.14e-02 4.11e-04  3.19e-02    10s
  27   1.19437361e+04  1.74338855e+04  9.55e-03 2.70e-04  2.42e-02    10s
  28   1.24687973e+04  1.70169368e+04  8.04e-03 2.08e-04  2.00e-02    10s
  29   1.28449498e+04  1.65322159e+04  6.92e-03 1.45e-04  1.62e-02    10s
  30   1.35399633e+04  1.63385898e+04  4.96e-03 1.20e-04  1.23e-02    10s
  31   1.36785473e+04  1.60191122e+04  4.58e-03 7.69e-05  1.03e-02    11s
  32   1.42015137e+04  1.58691160e+04  3.21e-03 5.40e-05  7.35e-03    11s
  33   1.43580173e+04  1.58325050e+04  2.80e-03 4.75e-05  6.50e-03    11s
  34   1.45166713e+04  1.57370673e+04  2.38e-03 3.93e-05  5.38e-03    11s
  35   1.46473074e+04  1.56893708e+04  2.06e-03 4.01e-05  4.59e-03    11s
  36   1.48835267e+04  1.56692290e+04  1.47e-03 3.62e-05  3.46e-03    11s
  37   1.49995312e+04  1.56478975e+04  1.17e-03 3.20e-05  2.86e-03    11s
  38   1.50384807e+04  1.56282327e+04  1.08e-03 2.84e-05  2.60e-03    11s
  39   1.51453265e+04  1.55985092e+04  8.11e-04 4.13e-05  2.00e-03    12s
  40   1.51668280e+04  1.55755471e+04  7.60e-04 3.33e-05  1.80e-03    12s
  41   1.52239580e+04  1.55439477e+04  6.08e-04 2.21e-05  1.41e-03    12s
  42   1.52443081e+04  1.55359457e+04  5.60e-04 2.01e-05  1.28e-03    12s
  43   1.52701079e+04  1.55338350e+04  4.97e-04 1.93e-05  1.16e-03    12s
  44   1.52870303e+04  1.55245087e+04  4.57e-04 1.62e-05  1.05e-03    12s
  45   1.52977454e+04  1.55219845e+04  4.31e-04 1.54e-05  9.88e-04    12s
  46   1.53126818e+04  1.55179780e+04  3.95e-04 1.41e-05  9.05e-04    13s
  47   1.53293125e+04  1.55139542e+04  3.56e-04 1.26e-05  8.14e-04    13s
  48   1.53591026e+04  1.55042486e+04  2.80e-04 9.54e-06  6.40e-04    13s
  49   1.53903257e+04  1.54999814e+04  2.01e-04 8.11e-06  4.83e-04    13s
  50   1.54074873e+04  1.54991438e+04  1.58e-04 7.85e-06  4.04e-04    13s
  51   1.54349029e+04  1.54875745e+04  9.18e-05 4.19e-06  2.32e-04    13s
  52   1.54428545e+04  1.54864976e+04  7.37e-05 3.79e-06  1.92e-04    13s
  53   1.54642242e+04  1.54779069e+04  2.38e-05 6.72e-07  6.03e-05    13s
  54   1.54741366e+04  1.54757198e+04  2.32e-06 5.97e-07  6.97e-06    14s
  55   1.54754050e+04  1.54754674e+04  1.08e-07 1.74e-07  2.75e-07    14s
  56   1.54754095e+04  1.54754672e+04  8.69e-07 1.63e-07  2.54e-07    14s
  57   1.54754634e+04  1.54754635e+04  2.66e-09 5.35e-11  2.74e-10    14s

Barrier solved model in 57 iterations and 13.93 seconds (14.05 work units)
Optimal objective 1.54754634e+04


Root crossover log...

  110758 DPushes remaining with DInf 0.0000000e+00                14s
   42943 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    6376 PPushes remaining with PInf 5.3730625e-05                20s
    3819 PPushes remaining with PInf 3.1336843e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.5518381e+04     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59297    1.5475463e+04   0.000000e+00   2.551838e+04     21s
   59906    1.5475463e+04   0.000000e+00   0.000000e+00     22s
   59906    1.5475463e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 4.79s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.547546e+04, 59906 iterations, 21.56 seconds (24.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15475.4635    0  185 -177247.82 15475.4635   109%     -   27s
H    0     0                    -130230.1109 15475.4635   112%     -   28s
H    0     0                    -128769.7433 15475.4635   112%     -   28s
H    0     0                    -78069.09140 15475.4635   120%     -   28s
H    0     0                    -39483.81932 15475.4635   139%     -   29s
H    0     0                    -23981.13103 15475.4635   165%     -   29s
H    0     0                    -22222.87758 15475.4635   170%     -   29s
H    0     0                    -22026.49897 15475.4635   170%     -   29s
H    0     0                    -21807.52798 15475.4635   171%     -   29s
     0     0 11613.5987    0  356 -21807.528 11613.5987   153%     -  125s
H    0     0                    -21154.89459 11612.6220   155%     -  126s
H    0     0                    -20425.81816 11612.6220   157%     -  126s
H    0     0                    -20372.00166 11612.6220   157%     -  126s
H    0     0                    -20292.56069 11612.6220   157%     -  126s
     0     0 11452.0615    0  403 -20292.561 11452.0615   156%     -  153s
     0     0 11380.1611    0  418 -20292.561 11380.1611   156%     -  189s
     0     0 11075.2790    0  350 -20292.561 11075.2790   155%     -  213s
     0     0 11075.2790    0  360 -20292.561 11075.2790   155%     -  235s
     0     0 11073.0217    0  349 -20292.561 11073.0217   155%     -  239s
     0     0 11072.9363    0  353 -20292.561 11072.9363   155%     -  240s
     0     0 8703.05857    0  391 -20292.561 8703.05857   143%     -  329s
H    0     0                    -12690.12398 8703.05857   169%     -  330s
H    0     0                    -12352.89955 8703.05857   170%     -  330s
     0     0 8500.09247    0  382 -12352.900 8500.09247   169%     -  361s
     0     0 7991.60730    0  378 -12352.900 7991.60730   165%     -  391s
     0     0 7980.98919    0  378 -12352.900 7980.98919   165%     -  398s
     0     0 7952.71252    0  385 -12352.900 7952.71252   164%     -  406s
     0     0 7931.40353    0  390 -12352.900 7931.40353   164%     -  411s
     0     0 7930.11927    0  393 -12352.900 7930.11927   164%     -  415s
     0     0 7896.35177    0  382 -12352.900 7896.35177   164%     -  424s
     0     0 7895.54960    0  384 -12352.900 7895.54960   164%     -  425s
     0     0 6139.76583    0  435 -12352.900 6139.76583   150%     -  491s
H    0     0                    -12342.26142 6139.54623   150%     -  492s
     0     0 5702.92882    0  427 -12342.261 5702.92882   146%     -  517s
     0     0 5611.17679    0  519 -12342.261 5611.17679   145%     -  534s
     0     0 5532.74572    0  514 -12342.261 5532.74572   145%     -  549s
     0     0 5506.19933    0  505 -12342.261 5506.19933   145%     -  559s
     0     0 5447.22194    0  506 -12342.261 5447.22194   144%     -  570s
     0     0 5424.52022    0  510 -12342.261 5424.52022   144%     -  578s
     0     0 5389.11335    0  507 -12342.261 5389.11335   144%     -  588s
     0     0 5243.39709    0  514 -12342.261 5243.39709   142%     -  605s
     0     0 5208.35721    0  521 -12342.261 5208.35721   142%     -  615s
     0     0 5143.38086    0  523 -12342.261 5143.38086   142%     -  626s
     0     0 5136.63611    0  526 -12342.261 5136.63611   142%     -  631s
     0     0 5134.23067    0  517 -12342.261 5134.23067   142%     -  635s
     0     0 5129.35274    0  521 -12342.261 5129.35274   142%     -  639s
     0     0 5129.05061    0  520 -12342.261 5129.05061   142%     -  640s
     0     0 4457.06900    0  451 -12342.261 4457.06900   136%     -  696s
     0     0 4292.35898    0  529 -12342.261 4292.35898   135%     -  726s
     0     0 4184.36369    0  538 -12342.261 4184.36369   134%     -  748s
     0     0 4134.15155    0  546 -12342.261 4134.15155   133%     -  766s
     0     0 4120.79649    0  555 -12342.261 4120.79649   133%     -  777s
     0     0 4110.45092    0  547 -12342.261 4110.45092   133%     -  786s
     0     0 4099.99835    0  556 -12342.261 4099.99835   133%     -  792s
     0     0 4082.93222    0  464 -12342.261 4082.93222   133%     -  801s
     0     0 4072.59571    0  469 -12342.261 4072.59571   133%     -  807s
     0     0 4070.75884    0  470 -12342.261 4070.75884   133%     -  809s
H    0     0                    -11481.67897 4067.41671   135%     -  812s
H    0     0                    -11432.09710 4067.41671   136%     -  812s
     0     0 4067.41671    0  476 -11432.097 4067.41671   136%     -  812s
     0     0 4060.20989    0  475 -11432.097 4060.20989   136%     -  817s
     0     0 4044.55927    0  476 -11432.097 4044.55927   135%     -  822s
     0     0 4038.50266    0  472 -11432.097 4038.50266   135%     -  827s
     0     0 4022.60505    0  471 -11432.097 4022.60505   135%     -  834s
     0     0 4020.72732    0  476 -11432.097 4020.72732   135%     -  836s
     0     0 4020.49696    0  477 -11432.097 4020.49696   135%     -  838s
     0     0 3910.84851    0  599 -11432.097 3910.84851   134%     -  865s
     0     0 3862.87825    0  602 -11432.097 3862.87825   134%     -  879s
     0     0 3848.77612    0  569 -11432.097 3848.77612   134%     -  885s
     0     0 3842.29994    0  468 -11432.097 3842.29994   134%     -  893s
     0     0 3826.21723    0  559 -11432.097 3826.21723   133%     -  901s
     0     0 3814.77672    0  564 -11432.097 3814.77672   133%     -  906s
     0     0 3810.29642    0  559 -11432.097 3810.29642   133%     -  911s
     0     0 3796.55166    0  600 -11432.097 3796.55166   133%     -  917s
     0     0 3790.16947    0  610 -11432.097 3790.16947   133%     -  921s
     0     0 3786.32089    0  606 -11432.097 3786.32089   133%     -  924s
     0     0 3785.06845    0  608 -11432.097 3785.06845   133%     -  925s
     0     0 3662.02819    0  476 -11432.097 3662.02819   132%     -  946s
H    0     0                    -6466.784327 3661.46103   157%     -  951s
H    0     0                    -6254.913053 3661.46103   159%     -  954s
H    0     0                    -6219.058724 3661.46103   159%     -  958s
H    0     0                    -6179.409922 3661.46103   159%     -  958s
H    0     0                    -6159.982667 3661.46103   159%     -  958s
     0     0 3647.42562    0  481 -6159.9827 3647.42562   159%     -  965s
     0     0 3630.31335    0  483 -6159.9827 3630.31335   159%     -  972s
     0     0 3608.69927    0  495 -6159.9827 3608.69927   159%     -  980s
     0     0 3599.01716    0  496 -6159.9827 3599.01716   158%     -  985s
     0     0 3596.24958    0  496 -6159.9827 3596.24958   158%     -  987s
     0     0 3591.19868    0  492 -6159.9827 3591.19868   158%     -  989s
     0     0 3589.15285    0  499 -6159.9827 3589.15285   158%     -  991s
     0     0 3588.93363    0  493 -6159.9827 3588.93363   158%     -  992s
     0     0 3442.12220    0  486 -6159.9827 3442.12220   156%     - 1008s
     0     0 3424.53934    0  476 -6159.9827 3424.53934   156%     - 1015s
     0     0 3421.24261    0  487 -6159.9827 3421.24261   156%     - 1018s
     0     0 3416.63946    0  496 -6159.9827 3416.63946   155%     - 1021s
     0     0 3412.55014    0  493 -6159.9827 3412.55014   155%     - 1024s
     0     0 3404.39581    0  477 -6159.9827 3404.39581   155%     - 1032s
     0     0 3393.34935    0  491 -6159.9827 3393.34935   155%     - 1041s
     0     0 3391.80778    0  492 -6159.9827 3391.80778   155%     - 1043s
     0     0 3379.44043    0  506 -6159.9827 3379.44043   155%     - 1053s
H    0     0                    -6154.022012 3379.43165   155%     - 1055s
H    0     0                    -6134.481608 3379.43165   155%     - 1057s
H    0     0                    -6123.351132 3379.43165   155%     - 1057s
H    0     0                    -6103.572230 3379.43165   155%     - 1057s
     0     0 3363.24858    0  508 -6103.5722 3363.24858   155%     - 1065s
     0     0 3358.46937    0  505 -6103.5722 3358.46937   155%     - 1068s
     0     0 3358.16844    0  514 -6103.5722 3358.16844   155%     - 1070s
     0     0 3346.82937    0  511 -6103.5722 3346.82937   155%     - 1080s
     0     0 3343.05825    0  517 -6103.5722 3343.05825   155%     - 1086s
     0     0 3342.29011    0  522 -6103.5722 3342.29011   155%     - 1089s
     0     0 3328.16266    0  520 -6103.5722 3328.16266   155%     - 1100s
H    0     0                    -6059.443513 3327.94959   155%     - 1119s
H    0     0                    -6057.592465 3327.94959   155%     - 1119s
H    0     0                    -6046.647149 3327.94959   155%     - 1123s
     0     0 3324.91725    0  533 -6046.6471 3324.91725   155%     - 1126s
     0     0 3324.71027    0  530 -6046.6471 3324.71027   155%     - 1128s
     0     0 3321.15469    0  511 -6046.6471 3321.15469   155%     - 1135s
H    0     0                    -5993.656531 3320.93676   155%     - 1136s
H    0     0                    -5990.019872 3320.93676   155%     - 1136s
H    0     0                    -5978.304011 3320.93676   156%     - 1136s
     0     0 3319.98397    0  521 -5978.3040 3319.98397   156%     - 1139s
     0     0 3316.76552    0  524 -5978.3040 3316.76552   155%     - 1145s
H    0     0                    -5971.308631 3316.33542   156%     - 1151s
H    0     0                    -5967.418547 3316.33542   156%     - 1151s
     0     0 3315.58072    0  529 -5967.4185 3315.58072   156%     - 1155s
     0     0 3309.92344    0  565 -5967.4185 3309.92344   155%     - 1162s
     0     0 3308.57516    0  565 -5967.4185 3308.57516   155%     - 1170s
H    0     0                    -5872.520657 3308.57516   156%     - 1321s
H    0     0                    -5826.833325 3308.57516   157%     - 1327s
H    0     0                    -5821.200184 3308.57516   157%     - 1334s
H    0     2                    -5801.901033 3308.57516   157%     - 1336s
     0     2 3308.57516    0  565 -5801.9010 3308.57516   157%     - 1336s
     1     3 2580.76799    1  455 -5801.9010 3308.57516   157% 11727 1363s
     2     4 3169.90257    1  541 -5801.9010 3169.90257   155% 11512 1381s
     3     6 2368.57219    2  484 -5801.9010 3169.76519   155% 10059 1404s
     5    12  766.72747    3  410 -5801.9010 3169.76519   155% 11815 1435s
    11    24  640.69802    4  398 -5801.9010 2884.37358   150%  9531 1470s
    23    36 1130.83256    4  415 -5801.9010 2838.20370   149% 14662 1583s
    35    68 1264.15148    5  421 -5801.9010 2838.20370   149% 13907 1772s
H   39    68                    -5791.262909 2838.20370   149% 13589 1772s
H   41    68                    -5787.583752 2838.20370   149% 13432 1772s
H   45    68                    -5776.945628 2838.20370   149% 12692 1772s
H   50    68                    -5728.937501 2838.20370   150% 11719 1772s
    67   100 1221.93055    6  430 -5728.9375 2684.75875   147% 17827 1824s
H   75   100                    -5718.880443 2684.75875   147% 16637 1824s
H   87   100                    -5706.818298 2684.75875   147% 15295 1824s
    99   171 1187.01884    7  423 -5706.8183 2684.75875   147% 14691 1879s
H  104   171                    -5690.412006 2684.75875   147% 14109 1879s
H  181   171                    -5680.904264 2684.75875   147%  9583 1879s
   185   278 1002.50997   12  401 -5680.9043 2684.75875   147%  9542 1919s
   306   327  704.22451   17  399 -5680.9043 2684.75875   147%  8362 1950s
   376   375  673.81704   18  399 -5680.9043 2684.75875   147%  7904 1977s
   454   383  246.91645   19  288 -5680.9043 2684.75875   147%  7660 2003s
   512   423 -3212.3809   22  150 -5680.9043 2684.75875   147%  7482 2029s
   568   467 -3921.6975   26  134 -5680.9043 2684.75875   147%  7503 2053s
   636   506     cutoff   17      -5680.9043 2684.75875   147%  7445 2076s
   713   526 infeasible   21      -5680.9043 2684.75875   147%  7070 2099s
   803   592 -3655.5854   19  435 -5680.9043 2684.75875   147%  6806 2121s
   887   643 -3807.2507   20  294 -5680.9043 2684.75875   147%  6693 2145s
   972   706 -3876.9954   21  457 -5680.9043 2684.75875   147%  6567 2169s
  1073   739 -3998.8470   23  446 -5680.9043 2684.75875   147%  6313 2196s
  1162   765 -4048.0291   25  431 -5680.9043 2593.91104   146%  6259 2224s
  1230   800 -4503.8944   27  441 -5680.9043 2593.91104   146%  6351 2249s
  1295   854 -5014.8711   29  480 -5680.9043 2593.91104   146%  6420 2275s
  1375   873 -5133.5738   33  419 -5680.9043 2593.91104   146%  6436 2305s
  1457   893 infeasible   34      -5680.9043 2507.29694   144%  6423 2335s
  1533   918 -1510.2328    9  292 -5680.9043 2507.29694   144%  6561 2365s
  1618   941 -2821.0463   10  271 -5680.9043 2303.68962   141%  6638 2397s
H 1619   941                    -5650.916761 2303.68962   141%  6634 2397s
H 1637   941                    -5632.697017 2303.68962   141%  6687 2397s
  1669   971 -5506.5808   11  283 -5632.6970 2303.68962   141%  6729 2428s
  1767   981 -4019.8433   12  136 -5632.6970 2303.68962   141%  6735 2459s
  1808   997     cutoff   13      -5632.6970 2303.68962   141%  6802 2492s
  1856  1018 -5149.3661   14  134 -5632.6970 2303.68962   141%  6874 2525s
  1905  1033 -5169.8223   15  133 -5632.6970 2303.68962   141%  6948 2560s
H 1915  1033                    -5624.304836 2303.68962   141%  6972 2560s
  1955  1062 infeasible   16      -5624.3048 2303.68962   141%  7037 2596s
  1992  1091 infeasible   10      -5624.3048 2303.68962   141%  7186 2637s
  2075  1124 -2298.5029   10  428 -5624.3048 2303.68962   141%  7181 2673s
  2146  1171 -2313.9619   11  419 -5624.3048 2303.68962   141%  7234 2712s
  2259  1221 -4460.5245   14  153 -5624.3048 2303.68962   141%  7255 2756s
  2371  1273 infeasible   22      -5624.3048 2303.68962   141%  7313 2803s
  2525  1316 -5616.9076   25   66 -5624.3048 1403.33375   125%  7286 2851s
  2646  1339  408.79067    7  288 -5624.3048 1403.33375   125%  7332 2898s
  2762  1360 -1316.1199    8  334 -5624.3048 1403.33375   125%  7398 2945s
  2808  1395 -1785.9489    9  306 -5624.3048 1403.33375   125%  7528 2996s
  2873  1437 -2565.5629   11  199 -5624.3048 1403.33375   125%  7602 3055s
  2983  1481 -3915.6036   14  258 -5624.3048 1403.33375   125%  7667 3107s
  3085  1537 -4527.9753   20  120 -5624.3048 1403.33375   125%  7802 3159s
  3255  1560 infeasible   23      -5624.3048 1403.33375   125%  7795 3218s
  3379  1593 -3948.3157   10  392 -5624.3048 1403.33375   125%  7833 3282s
  3492  1637 -4094.3497   11  314 -5624.3048 1403.33375   125%  7961 3346s
  3604  1655 infeasible   15      -5624.3048 1403.33375   125%  8070 3404s
  3664  1675 -5203.3052   15  412 -5624.3048 1403.33375   125%  8149 3463s
  3732  1680 -5332.9747   16  349 -5624.3048  660.66369   112%  8153 3532s
  3826  1711 infeasible   17      -5624.3048  660.66369   112%  8136 3599s
  3963  1683 infeasible   25      -5624.3048  660.66369   112%  8228 3600s

Cutting planes:
  Gomory: 12
  Implied bound: 124
  MIR: 2813
  Flow cover: 3215
  Inf proof: 1
  Zero half: 4
  RLT: 46
  Relax-and-lift: 245

Explored 3966 nodes (33282850 simplex iterations) in 3600.07 seconds (5758.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5624.3 -5632.7 -5650.92 ... -5787.58

Time limit reached
Best objective -5.624304835935e+03, best bound 6.606636892809e+02, gap 111.7466%
  WARNING: Time limit reached. Using best solution found (gap: 111.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -5624.30, θ = 120728.40
  Upper Bound (UB) = -5624.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120728.40
  [DEBUG]   ✓ Scenario 0: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120728.40 ≤ Q = 120728.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120728.40 ≤ Q = 120728.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120728.40 ≤ Q = 120728.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120728.40 ≤ Q = 120728.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120728.40 ≤ Q = 120728.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120728.40 ≤ Q = 120728.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x649f0b95
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9b60f46b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6455603.5211
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.439018e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143901.79    0  124 6455603.52 -143901.79   102%     -    0s
H    0     0                    -110024.8763 -143901.79  30.8%     -    0s
H    0     0                    -111142.0715 -143901.79  29.5%     -    0s
     0     0 -120214.76    0  130 -111142.07 -120214.76  8.16%     -    0s
H    0     0                    -114531.2552 -120063.65  4.83%     -    0s
     0     0 -118672.99    0  132 -114531.26 -118672.99  3.62%     -    0s
H    0     0                    -114984.7916 -118658.62  3.20%     -    0s
     0     0 -118082.78    0  133 -114984.79 -118082.78  2.69%     -    0s
H    0     0                    -115086.2686 -117992.89  2.53%     -    0s
     0     0 -117992.89    0  133 -115086.27 -117992.89  2.53%     -    0s
H    0     0                    -115089.7360 -117992.89  2.52%     -    0s
     0     0 -117623.86    0  127 -115089.74 -117623.86  2.20%     -    0s
     0     0 -117568.11    0  126 -115089.74 -117568.11  2.15%     -    0s
     0     0 -117251.15    0  125 -115089.74 -117251.15  1.88%     -    0s
     0     0 -117201.95    0  125 -115089.74 -117201.95  1.84%     -    0s
     0     0 -117016.11    0   67 -115089.74 -117016.11  1.67%     -    0s
     0     0 -116983.86    0   66 -115089.74 -116983.86  1.65%     -    0s
     0     0 -116956.52    0   67 -115089.74 -116956.52  1.62%     -    0s
     0     0 -116928.82    0   67 -115089.74 -116928.82  1.60%     -    0s
H    0     0                    -115756.0922 -116928.82  1.01%     -    0s
     0     2 -116928.82    0   67 -115756.09 -116928.82  1.01%     -    0s
H  120   235                    -115768.7555 -116539.47  0.67%  16.0    0s
H  125   235                    -115785.3087 -116539.47  0.65%  15.6    0s
H  135   235                    -115853.5014 -116539.47  0.59%  14.9    0s
H  180   235                    -115916.0073 -116539.47  0.54%  12.8    0s
H 1461   787                    -115918.0104 -116301.17  0.33%   6.6    0s
H 1560   787                    -115936.8852 -116297.99  0.31%   6.7    0s
* 2796  1327              26    -115937.0598 -116222.08  0.25%   6.3    0s
* 2806  1327              28    -115941.7321 -116222.08  0.24%   6.3    0s
* 3264  1327              25    -115949.8194 -116176.96  0.20%   6.2    0s
H 4892  1834                    -115971.1784 -116136.29  0.14%   5.9    0s
H 5543  1834                    -115982.1390 -116126.80  0.12%   5.8    0s
* 8324   750              27    -115982.3136 -116066.82  0.07%   5.7    0s

Cutting planes:
  Gomory: 57
  Implied bound: 1
  MIR: 243
  RLT: 5
  BQP: 2

Explored 10280 nodes (56572 simplex iterations) in 0.56 seconds (0.33 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115982 -115971 -115950 ... -115769
No other solutions better than -115982

Optimal solution found (tolerance 1.00e-06)
Best objective -1.159823135828e+05, best bound -1.159823135828e+05, gap 0.0000%
  Subproblem solved in 0.61s
  Worst-case operational profit (Z_SP) = 117418.02
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115982.31
  [DEBUG]   S×d_nominal = 233400.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233400.33 + -115982.31 = 117418.02
  [DEBUG]   Current θ from Master = 120728.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3310.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8934.69
  Lower Bound (LB) = -8473.73
  Gap (UB-LB) = 2849.4263, Absolute Gap = 2849.4263, Relative Gap = 0.506627
  Not converged yet (gap = 2849.43 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x9798ea9e
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 4.77s
Presolved: 132903 rows, 56180 columns, 817794 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -396774.3506
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.64s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.196e+06
 Factor NZ  : 1.379e+07 (roughly 200 MB of memory)
 Factor Ops : 3.025e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80207043e+07  2.52210294e+08  1.03e+05 1.41e+01  7.98e+04     9s
   1  -1.38038981e+07  2.18431358e+08  7.24e+04 4.73e+01  5.58e+04     9s
   2  -4.51166262e+06  1.66915977e+08  2.27e+04 6.14e-01  1.84e+04     9s
   3  -1.17952640e+06  1.32224174e+08  2.53e+03 2.76e+00  2.47e+03     9s
   4  -7.24230204e+05  8.07042849e+07  4.75e+02 1.36e+00  6.69e+02     9s
   5  -5.81405310e+05  4.88305659e+07  3.38e+02 6.39e-01  4.20e+02     9s
   6  -5.56877146e+05  3.98475656e+07  1.55e+02 4.81e-01  2.62e+02     9s
   7  -4.29293944e+05  2.95239554e+07  7.57e+01 1.76e-01  1.65e+02     9s
   8  -3.72528990e+05  1.94814668e+07  2.67e+01 2.22e-02  9.40e+01    10s
   9  -2.00864706e+05  9.67871540e+06  7.61e+00 1.00e-02  4.29e+01    10s
  10  -1.42672865e+05  4.75975692e+06  3.70e+00 4.76e-03  2.08e+01    10s
  11  -1.14085696e+05  2.98437562e+06  2.08e+00 2.95e-03  1.30e+01    10s
  12  -8.55954960e+04  1.87035820e+06  9.08e-01 1.84e-03  8.12e+00    10s
  13  -6.84714997e+04  1.19370274e+06  5.08e-01 1.18e-03  5.22e+00    10s
  14  -4.38434822e+04  5.06456536e+05  2.07e-01 4.50e-04  2.27e+00    10s
  15  -2.54761266e+04  2.21865233e+05  8.45e-02 3.79e-04  1.02e+00    10s
  16  -1.75443296e+04  1.35659306e+05  5.52e-02 5.15e-04  6.32e-01    10s
  17  -1.35409694e+04  1.02109296e+05  4.49e-02 6.99e-04  4.77e-01    10s
  18  -9.12396147e+03  7.49165365e+04  3.56e-02 1.24e-03  3.47e-01    11s
  19  -5.19568595e+03  5.85944928e+04  2.72e-02 2.48e-03  2.63e-01    11s
  20  -1.47426147e+03  4.47802481e+04  2.08e-02 1.88e-03  1.91e-01    11s
  21   1.19411931e+03  3.67905277e+04  1.68e-02 1.39e-03  1.47e-01    11s
  22   3.26529787e+03  3.15663688e+04  1.39e-02 1.07e-03  1.17e-01    11s
  23   5.47853230e+03  2.69185580e+04  1.10e-02 7.64e-04  8.84e-02    11s
  24   7.16594708e+03  2.32198371e+04  8.98e-03 5.09e-04  6.62e-02    11s
  25   9.48803214e+03  2.10535434e+04  6.40e-03 3.88e-04  4.77e-02    12s
  26   1.11154876e+04  1.97894697e+04  4.60e-03 2.89e-04  3.58e-02    12s
  27   1.21212865e+04  1.79975977e+04  3.46e-03 2.68e-04  2.42e-02    12s
  28   1.30047093e+04  1.70469168e+04  2.48e-03 2.09e-04  1.67e-02    12s
  29   1.34543452e+04  1.66245998e+04  2.01e-03 1.53e-04  1.31e-02    12s
  30   1.38313428e+04  1.63025759e+04  1.61e-03 1.10e-04  1.02e-02    12s
  31   1.42149944e+04  1.60517364e+04  1.21e-03 7.76e-05  7.58e-03    13s
  32   1.45070811e+04  1.59521829e+04  9.20e-04 6.41e-05  5.96e-03    13s
  33   1.45853685e+04  1.58108082e+04  8.43e-04 4.48e-05  5.06e-03    13s
  34   1.48137098e+04  1.57856590e+04  6.30e-04 4.10e-05  4.01e-03    13s
  35   1.49454400e+04  1.56960928e+04  5.02e-04 2.79e-05  3.10e-03    13s
  36   1.50827113e+04  1.56473048e+04  3.73e-04 2.09e-05  2.33e-03    13s
  37   1.51629554e+04  1.56027294e+04  2.97e-04 1.49e-05  1.81e-03    14s
  38   1.52149352e+04  1.55601964e+04  2.50e-04 9.33e-06  1.42e-03    14s
  39   1.52998356e+04  1.55537345e+04  1.71e-04 8.40e-06  1.05e-03    14s
  40   1.53065061e+04  1.55450052e+04  1.65e-04 7.34e-06  9.84e-04    14s
  41   1.53432481e+04  1.55400178e+04  1.31e-04 6.71e-06  8.12e-04    14s
  42   1.53568865e+04  1.55377621e+04  1.18e-04 6.42e-06  7.46e-04    14s
  43   1.53640096e+04  1.55304088e+04  1.12e-04 5.45e-06  6.86e-04    15s
  44   1.53694760e+04  1.55243380e+04  1.06e-04 4.68e-06  6.39e-04    15s
  45   1.53861739e+04  1.55148980e+04  8.93e-05 3.66e-06  5.31e-04    15s
  46   1.54066748e+04  1.55087505e+04  7.08e-05 2.77e-06  4.21e-04    15s
  47   1.54284416e+04  1.55024315e+04  5.09e-05 1.92e-06  3.05e-04    15s
  48   1.54427914e+04  1.55023739e+04  3.82e-05 1.90e-06  2.46e-04    15s
  49   1.54530695e+04  1.54991957e+04  2.92e-05 1.52e-06  1.90e-04    16s
  50   1.54553636e+04  1.54987098e+04  2.70e-05 1.46e-06  1.79e-04    16s
  51   1.54647358e+04  1.54967992e+04  1.88e-05 1.24e-06  1.32e-04    16s
  52   1.54802557e+04  1.54884100e+04  5.26e-06 1.45e-07  3.36e-05    16s
  53   1.54862911e+04  1.54870588e+04  3.97e-07 2.98e-07  3.17e-06    16s
  54   1.54864733e+04  1.54870208e+04  3.24e-07 1.81e-07  2.26e-06    16s
  55   1.54869311e+04  1.54869562e+04  1.78e-08 6.27e-09  1.03e-07    16s
  56   1.54869527e+04  1.54869557e+04  1.31e-06 2.53e-10  1.21e-08    17s
  57   1.54869552e+04  1.54869557e+04  3.04e-06 1.43e-09  1.92e-09    17s
  58   1.54869557e+04  1.54869557e+04  4.08e-07 2.05e-07  2.57e-10    17s

Barrier solved model in 58 iterations and 16.83 seconds (15.78 work units)
Optimal objective 1.54869557e+04


Root crossover log...

  117941 DPushes remaining with DInf 0.0000000e+00                17s
   24525 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    6939 PPushes remaining with PInf 9.0552693e-05                24s
     541 PPushes remaining with PInf 3.9763752e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8312205e+02     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63958    1.5486956e+04   0.000000e+00   1.831221e+02     25s
   64028    1.5486956e+04   0.000000e+00   0.000000e+00     26s
   64028    1.5486956e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 4.85s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.548696e+04, 64028 iterations, 24.50 seconds (27.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15486.9557    0  185 -177247.82 15486.9557   109%     -   31s
H    0     0                    -172792.3193 15486.9557   109%     -   31s
H    0     0                    -144127.1321 15486.9557   111%     -   33s
H    0     0                    -141259.8455 15486.9557   111%     -   34s
H    0     0                    -138247.7167 15486.9557   111%     -   34s
H    0     0                    -136893.4909 15486.9557   111%     -   34s
H    0     0                    -135502.9957 15486.9557   111%     -   35s
H    0     0                    -135483.0723 15486.9557   111%     -   36s
H    0     0                    -135189.1987 15486.9557   111%     -   36s
H    0     0                    -135095.3991 15486.9557   111%     -   36s
H    0     0                    -135040.5288 15486.9557   111%     -   36s
H    0     0                    -99986.45751 15486.9557   115%     -   36s
H    0     0                    -92109.38378 15486.9557   117%     -   36s
H    0     0                    -59978.05748 15486.9557   126%     -   37s
H    0     0                    -59955.20592 15486.9557   126%     -   38s
H    0     0                    -57352.17691 15486.9557   127%     -   38s
H    0     0                    -57264.92078 15486.9557   127%     -   38s
H    0     0                    -56518.18332 15486.9557   127%     -   38s
     0     0 11347.8831    0  358 -56518.183 11347.8831   120%     -  124s
H    0     0                    -53493.80069 11347.8818   121%     -  125s
H    0     0                    -53451.07162 11347.8818   121%     -  126s
H    0     0                    -38262.62717 11347.8818   130%     -  126s
H    0     0                    -37898.46019 11347.8818   130%     -  126s
H    0     0                    -37732.79652 11347.8818   130%     -  126s
H    0     0                    -37073.30653 11347.8818   131%     -  126s
H    0     0                    -36980.38331 11347.8818   131%     -  126s
H    0     0                    -36962.96710 11347.8818   131%     -  126s
     0     0 11221.2873    0  361 -36962.967 11221.2873   130%     -  147s
     0     0 11191.6357    0  361 -36962.967 11191.6357   130%     -  158s
     0     0 11191.4538    0  360 -36962.967 11191.4538   130%     -  159s
     0     0 8914.74297    0  457 -36962.967 8914.74297   124%     -  237s
H    0     0                    -31851.07832 8914.54342   128%     -  238s
H    0     0                    -30785.35587 8914.54342   129%     -  238s
H    0     0                    -19295.09270 8914.54342   146%     -  238s
H    0     0                    -19081.77462 8914.54342   147%     -  238s
H    0     0                    -8937.901747 8914.54342   200%     -  238s
H    0     0                    -8724.583666 8914.54342   202%     -  238s
H    0     0                    -8209.870888 8914.54342   209%     -  238s
H    0     0                    -8121.454490 8914.54342   210%     -  238s
     0     0 8642.58460    0  446 -8121.4545 8642.58460   206%     -  272s
     0     0 8075.68753    0  359 -8121.4545 8075.68753   199%     -  296s
     0     0 8022.53772    0  456 -8121.4545 8022.53772   199%     -  313s
     0     0 7992.59377    0  361 -8121.4545 7992.59377   198%     -  321s
     0     0 7989.72362    0  361 -8121.4545 7989.72362   198%     -  325s
     0     0 7974.16566    0  361 -8121.4545 7974.16566   198%     -  334s
     0     0 7911.65532    0  374 -8121.4545 7911.65532   197%     -  349s
     0     0 7908.84270    0  374 -8121.4545 7908.84270   197%     -  355s
     0     0 7901.08007    0  382 -8121.4545 7901.08007   197%     -  360s
     0     0 7880.67943    0  363 -8121.4545 7880.67943   197%     -  368s
     0     0 7878.91085    0  462 -8121.4545 7878.91085   197%     -  372s
     0     0 7833.32642    0  473 -8121.4545 7833.32642   196%     -  380s
     0     0 7828.18516    0  479 -8121.4545 7828.18516   196%     -  384s
     0     0 7828.07053    0  384 -8121.4545 7828.07053   196%     -  385s
     0     0 5690.91851    0  520 -8121.4545 5690.91851   170%     -  483s
H    0     0                    -7901.508615 5689.98299   172%     -  484s
H    0     0                    -7538.279887 5689.98299   175%     -  485s
H    0     0                    -7478.401970 5689.98299   176%     -  485s
H    0     0                    -7418.742959 5689.98299   177%     -  485s
H    0     0                    -7376.013893 5689.98299   177%     -  485s
H    0     0                    -7307.446394 5689.98299   178%     -  485s
     0     0 5502.20150    0  523 -7307.4464 5502.20150   175%     -  513s
     0     0 5215.39918    0  513 -7307.4464 5215.39918   171%     -  540s
     0     0 5139.27454    0  511 -7307.4464 5139.27454   170%     -  558s
     0     0 5114.63855    0  520 -7307.4464 5114.63855   170%     -  565s
     0     0 5100.68578    0  537 -7307.4464 5100.68578   170%     -  570s
     0     0 5099.91714    0  527 -7307.4464 5099.91714   170%     -  572s
     0     0 4486.17406    0  438 -7307.4464 4486.17406   161%     -  633s
     0     0 4295.89615    0  439 -7307.4464 4295.89615   159%     -  657s
     0     0 4016.44958    0  443 -7307.4464 4016.44958   155%     -  681s
     0     0 3933.08106    0  542 -7307.4464 3933.08106   154%     -  700s
     0     0 3911.88493    0  541 -7307.4464 3911.88493   154%     -  709s
     0     0 3903.55181    0  544 -7307.4464 3903.55181   153%     -  716s
     0     0 3896.84325    0  549 -7307.4464 3896.84325   153%     -  722s
     0     0 3861.29857    0  528 -7307.4464 3861.29857   153%     -  732s
     0     0 3826.20700    0  541 -7307.4464 3826.20700   152%     -  739s
     0     0 3807.85390    0  540 -7307.4464 3807.85390   152%     -  746s
     0     0 3803.00824    0  545 -7307.4464 3803.00824   152%     -  750s
     0     0 3801.89336    0  540 -7307.4464 3801.89336   152%     -  753s
     0     0 3553.46143    0  534 -7307.4464 3553.46143   149%     -  790s
H    0     0                    -7182.299861 3552.32877   149%     -  791s
H    0     0                    -6844.071399 3552.32877   152%     -  792s
H    0     0                    -6784.306715 3552.32877   152%     -  792s
H    0     0                    -6397.807299 3552.32877   156%     -  792s
H    0     0                    -6280.312264 3552.32877   157%     -  792s
H    0     0                    -6234.624932 3552.32877   157%     -  800s
     0     0 3506.18360    0  455 -6234.6249 3506.18360   156%     -  819s
     0     0 3487.62826    0  460 -6234.6249 3487.62826   156%     -  830s
     0     0 3481.83643    0  460 -6234.6249 3481.83643   156%     -  835s
     0     0 3480.58340    0  545 -6234.6249 3480.58340   156%     -  839s
     0     0 3416.98506    0  588 -6234.6249 3416.98506   155%     -  866s
H    0     0                    -6203.954052 3415.71795   155%     -  867s
     0     0 3403.38591    0  467 -6203.9541 3403.38591   155%     -  875s
     0     0 3396.84027    0  586 -6203.9541 3396.84027   155%     -  882s
     0     0 3387.04474    0  584 -6203.9541 3387.04474   155%     -  891s
     0     0 3379.62347    0  597 -6203.9541 3379.62347   154%     -  899s
     0     0 3378.47379    0  608 -6203.9541 3378.47379   154%     -  903s
     0     0 3346.03930    0  483 -6203.9541 3346.03930   154%     -  925s
H    0     0                    -6198.511019 3345.70720   154%     -  926s
H    0     0                    -6187.913643 3345.70720   154%     -  926s
H    0     0                    -6159.141054 3345.70720   154%     -  927s
H    0     0                    -6149.508596 3345.70720   154%     -  927s
     0     0 3337.61126    0  490 -6149.5086 3337.61126   154%     -  933s
     0     0 3332.00726    0  492 -6149.5086 3332.00726   154%     -  939s
     0     0 3328.38936    0  490 -6149.5086 3328.38936   154%     -  943s
     0     0 3325.98858    0  491 -6149.5086 3325.98858   154%     -  945s
     0     0 3325.15197    0  497 -6149.5086 3325.15197   154%     -  948s
     0     0 3298.10692    0  571 -6149.5086 3298.10692   154%     -  963s
H    0     0                    -6133.915797 3298.03578   154%     -  964s
     0     0 3288.83299    0  563 -6133.9158 3288.83299   154%     -  975s
     0     0 3284.91073    0  489 -6133.9158 3284.91073   154%     -  982s
     0     0 3282.50036    0  565 -6133.9158 3282.50036   154%     -  986s
     0     0 3281.87857    0  499 -6133.9158 3281.87857   154%     -  988s
     0     0 3277.03330    0  492 -6133.9158 3277.03330   153%     -  997s
H    0     0                    -6079.124503 3276.73433   154%     -  998s
H    0     0                    -6033.437171 3276.73433   154%     -  998s
     0     0 3273.33340    0  510 -6033.4372 3273.33340   154%     - 1007s
     0     0 3267.65321    0  505 -6033.4372 3267.65321   154%     - 1018s
     0     0 3266.19671    0  639 -6033.4372 3266.19671   154%     - 1024s
     0     0 3261.23583    0  628 -6033.4372 3261.23583   154%     - 1035s
H    0     0                    -5939.021978 3260.85499   155%     - 1038s
H    0     0                    -5884.126526 3260.85499   155%     - 1038s
     0     0 3255.13853    0  629 -5884.1265 3255.13853   155%     - 1047s
     0     0 3248.03087    0  621 -5884.1265 3248.03087   155%     - 1057s
     0     0 3246.46782    0  625 -5884.1265 3246.46782   155%     - 1062s
     0     0 3238.88371    0  626 -5884.1265 3238.88371   155%     - 1076s
     0     0 3235.70836    0  625 -5884.1265 3235.70836   155%     - 1083s
     0     0 3231.61704    0  621 -5884.1265 3231.61704   155%     - 1089s
     0     0 3230.51003    0  624 -5884.1265 3230.51003   155%     - 1092s
     0     0 3222.53676    0  615 -5884.1265 3222.53676   155%     - 1101s
H    0     0                    -5818.080014 3221.81135   155%     - 1102s
     0     0 3218.17200    0  624 -5818.0800 3218.17200   155%     - 1111s
     0     0 3217.11846    0  622 -5818.0800 3217.11846   155%     - 1115s
     0     0 3214.80524    0  623 -5818.0800 3214.80524   155%     - 1122s
     0     0 3213.25770    0  629 -5818.0800 3213.25770   155%     - 1126s
     0     0 3210.18684    0  626 -5818.0800 3210.18684   155%     - 1134s
     0     0 3210.08577    0  626 -5818.0800 3210.08577   155%     - 1146s
H    0     0                    -5798.390605 3210.07053   155%     - 1421s
H    0     0                    -5760.476286 3210.07053   156%     - 1457s
H    0     0                    -5758.861270 3210.07053   156%     - 1457s
H    0     0                    -5733.650315 3210.07053   156%     - 1457s
H    0     2                    -5721.903493 3210.07053   156%     - 1460s
     0     2 3210.07053    0  626 -5721.9035 3210.07053   156%     - 1461s
     1     3 2667.59111    1  464 -5721.9035 3210.07053   156% 14255 1496s
     2     4 3139.35995    1  622 -5721.9035 3139.35995   155% 11080 1515s
     3     7 2182.71847    2  464 -5721.9035 3139.34882   155% 11025 1544s
     6    14 2670.18777    3  463 -5721.9035 3139.34882   155% 10915 1591s
    13    27 2179.41895    4  460 -5721.9035 2760.13474   148% 12593 1628s
    26    41 -1107.4451    5  225 -5721.9035 2760.13474   148% 17401 1723s
    40    73 1559.50724    5  468 -5721.9035 2296.19481   140% 15986 1947s
    72   201 1474.30611    6  476 -5721.9035 1992.11196   135% 16188 2009s
H   83   201                    -5707.706039 1992.11196   135% 14987 2009s
H   91   201                    -5694.516800 1992.11196   135% 14042 2009s
   200   234 -1703.6048   10  227 -5694.5168 1987.92079   135% 10062 2040s
H  204   234                    -5684.715220 1987.92079   135%  9883 2040s
H  207   234                    -5683.878677 1987.92079   135%  9832 2040s
H  219   234                    -5645.894102 1987.92079   135%  9408 2040s
   246   295 -2001.1454   10  231 -5645.8941 1987.92079   135%  9005 2074s
H  260   295                    -5632.697017 1987.92079   135%  8829 2074s
   313   339 -2062.8048   10  248 -5632.6970 1987.92079   135%  8223 2106s
   385   363 -2174.8232   12  219 -5632.6970 1987.92079   135%  7738 2134s
   429   405 -3407.4752   13  209 -5632.6970 1987.92079   135%  7924 2178s
   487   446 -2197.8983   11  220 -5632.6970 1987.92079   135%  7799 2202s
   548   465 -2373.4942   12  217 -5632.6970 1987.92079   135%  7572 2227s
   618   483 -2909.4370   13  192 -5632.6970 1987.92079   135%  7223 2249s
   680   517 -3474.7058   15  173 -5632.6970 1987.92079   135%  7081 2272s
   746   549 -3644.3214   16  168 -5632.6970 1987.92079   135%  6889 2298s
   819   582 -3902.0814   17  164 -5632.6970 1987.92079   135%  6775 2321s
   893   595 -4551.7538   18  140 -5632.6970 1987.92079   135%  6689 2343s
   975   601     cutoff   20      -5632.6970 1987.92079   135%  6566 2367s
  1040   615 -4790.2185   21  141 -5632.6970 1870.02893   133%  6484 2396s
  1082   636 -4828.5030   22  116 -5632.6970 1870.02893   133%  6494 2434s
  1117   657 -5037.9331   23   99 -5632.6970 1870.02893   133%  6508 2460s
  1161   663 -5104.9116   24  105 -5632.6970 1870.02893   133%  6515 2490s
  1229   667     cutoff   23      -5632.6970 1842.26320   133%  6418 2518s
  1296   680     cutoff   28      -5632.6970 1842.26320   133%  6350 2546s
  1347   701 -5332.8757   27   94 -5632.6970 1842.26320   133%  6395 2578s
  1412   740 -5333.1721   28   90 -5632.6970 1842.26320   133%  6438 2607s
  1495   775 -5487.9704   31   89 -5632.6970 1842.26320   133%  6498 2641s
  1573   822 -1304.0178   12  196 -5632.6970 1842.26320   133%  6488 2674s
  1655   864 -1741.6666   14  179 -5632.6970 1842.26320   133%  6532 2708s
  1754   885 -4902.9013   16  179 -5632.6970 1842.26320   133%  6541 2743s
  1793   906 -5278.2498   17  179 -5632.6970 1842.26320   133%  6615 2780s
  1839   932 -5446.2328   18  172 -5632.6970 1842.26320   133%  6670 2818s
  1881   966 -5553.1581   19  170 -5632.6970 1842.26320   133%  6728 2858s
  1967   977     cutoff   20      -5632.6970 1842.26320   133%  6718 2895s
  2036   995 -1348.0654   17  448 -5632.6970 1842.26320   133%  6736 2933s
  2106  1034 -5114.8386   35  326 -5632.6970 1842.26320   133%  6773 2973s
  2197  1071 -5406.3670   39  283 -5632.6970 1842.26320   133%  6864 3016s
  2290  1114 -4397.1749   18  207 -5632.6970 1775.91132   132%  6972 3062s
  2389  1140 infeasible   21      -5632.6970 1775.91132   132%  7041 3113s
  2483  1166 infeasible   20      -5632.6970 1775.91132   132%  7208 3169s
  2587  1233 -3908.2381   24  487 -5632.6970 1775.91132   132%  7329 3225s
  2704  1282 -5169.7591   17  135 -5632.6970 1775.91132   132%  7402 3284s
  2845  1316 -4837.0528   21  469 -5632.6970 1775.91132   132%  7442 3342s
  2972  1380 -5347.2754   22  503 -5632.6970 1775.91132   132%  7521 3403s
  3100  1440 -5102.5876   24  510 -5632.6970 1775.91132   132%  7547 3466s
  3256  1520 -5493.5585   27  501 -5632.6970 1332.22628   124%  7607 3527s
  3392  1564 -2686.2756    8  254 -5632.6970 1332.21484   124%  7725 3591s
  3514  1566 -4317.9206   11  135 -5632.6970 1332.21484   124%  7841 3600s

Cutting planes:
  Learned: 1
  Gomory: 6
  Implied bound: 198
  MIR: 3061
  Flow cover: 3302
  Zero half: 4
  RLT: 41
  Relax-and-lift: 225

Explored 3528 nodes (28260204 simplex iterations) in 3600.09 seconds (5553.61 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5632.7 -5645.89 -5683.88 ... -5760.48

Time limit reached
Best objective -5.632697016939e+03, best bound 1.332214838269e+03, gap 123.6515%
  WARNING: Time limit reached. Using best solution found (gap: 123.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -5632.70, θ = 120465.47
  Upper Bound (UB) = -5632.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120465.47
  [DEBUG]   ✓ Scenario 0: θ = 120465.47 ≤ Q = 120776.46 (slack: 310.99)
  [DEBUG]   ✓ Scenario 1: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120465.47 ≤ Q = 120465.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120465.47 ≤ Q = 120465.47 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xd21d759
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf2de28a7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6459658.8022
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.434899e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143489.91    0  124 6459658.80 -143489.91   102%     -    0s
H    0     0                    -109507.6057 -143489.91  31.0%     -    0s
H    0     0                    -110650.8197 -143489.91  29.7%     -    0s
     0     0 -119111.15    0  129 -110650.82 -119111.15  7.65%     -    0s
H    0     0                    -113587.1759 -119041.56  4.80%     -    0s
     0     0 -117790.41    0   86 -113587.18 -117790.41  3.70%     -    0s
H    0     0                    -114987.3605 -117645.76  2.31%     -    0s
H    0     0                    -115251.5652 -117645.76  2.08%     -    0s
     0     0 -117307.01    0   88 -115251.57 -117307.01  1.78%     -    0s
H    0     0                    -115463.5533 -117260.78  1.56%     -    0s
     0     0 -117260.78    0   88 -115463.55 -117260.78  1.56%     -    0s
     0     0 -116949.28    0   90 -115463.55 -116949.28  1.29%     -    0s
     0     0 -116926.85    0   79 -115463.55 -116926.85  1.27%     -    0s
     0     0 -116668.81    0   81 -115463.55 -116668.81  1.04%     -    0s
     0     0 -116654.63    0   81 -115463.55 -116654.63  1.03%     -    0s
     0     2 -116654.52    0   81 -115463.55 -116654.52  1.03%     -    0s
H  415   405                    -115482.6241 -116251.87  0.67%   7.9    0s
H  460   405                    -115487.4951 -116251.87  0.66%   7.7    0s
H  500   405                    -115505.3157 -116251.87  0.65%   7.3    0s
H 1609   920                    -115516.6359 -116180.83  0.57%   5.7    0s
H 3489  1436                    -115535.7067 -115933.37  0.34%   6.1    0s
H 3783  1556                    -115540.5777 -115911.47  0.32%   6.1    0s
H 3951  1556                    -115557.2707 -115911.47  0.31%   6.1    0s
H 6992  1530                    -115558.3830 -115757.04  0.17%   6.4    0s

Cutting planes:
  Gomory: 65
  Implied bound: 4
  MIR: 220
  RLT: 4
  BQP: 1

Explored 13145 nodes (82264 simplex iterations) in 0.54 seconds (0.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115558 -115557 -115541 ... -115252
No other solutions better than -115558

Optimal solution found (tolerance 1.00e-06)
Best objective -1.155583829842e+05, best bound -1.155583829842e+05, gap 0.0000%
  Subproblem solved in 0.58s
  Worst-case operational profit (Z_SP) = 117194.28
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115558.38
  [DEBUG]   S×d_nominal = 232752.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232752.66 + -115558.38 = 117194.28
  [DEBUG]   Current θ from Master = 120465.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3271.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8903.89
  Lower Bound (LB) = -8473.73
  Gap (UB-LB) = 2841.0341, Absolute Gap = 2841.0341, Relative Gap = 0.504383
  Not converged yet (gap = 2841.03 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x8df9fb78
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 4.82s
Presolved: 141123 rows, 59550 columns, 868413 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.88s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.905e+06
 Factor NZ  : 1.544e+07 (roughly 200 MB of memory)
 Factor Ops : 3.645e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80164982e+07  2.65467302e+08  1.02e+05 1.36e+01  7.93e+04     9s
   1  -1.38003966e+07  2.29743384e+08  7.18e+04 4.44e+01  5.53e+04     9s
   2  -4.59115747e+06  1.77175289e+08  2.30e+04 6.19e-01  1.86e+04     9s
   3  -1.60543230e+06  1.50253917e+08  4.61e+03 5.95e+00  4.10e+03     9s
   4  -7.94426482e+05  1.10285136e+08  7.02e+02 3.19e+00  9.43e+02    10s
   5  -6.97950287e+05  8.24331608e+07  3.26e+02 2.27e+00  5.48e+02    10s
   6  -5.49333135e+05  5.41570931e+07  1.77e+02 1.25e+00  3.25e+02    10s
   7  -4.52834502e+05  4.31035427e+07  7.02e+01 9.08e-01  2.11e+02    10s
   8  -4.05240685e+05  3.37842526e+07  3.90e+01 5.09e-01  1.53e+02    10s
   9  -3.06224953e+05  1.91637725e+07  5.25e+00 1.83e-02  7.77e+01    10s
  10  -1.93737758e+05  6.53701221e+06  1.12e+00 5.86e-03  2.63e+01    10s
  11  -1.37277498e+05  5.02944075e+06  5.68e-01 4.52e-03  2.01e+01    10s
  12  -1.19971134e+05  3.63981040e+06  4.06e-01 2.13e-02  1.46e+01    10s
  13  -9.27069588e+04  2.17782851e+06  1.91e-01 1.94e-03  8.83e+00    11s
  14  -5.90986977e+04  1.28381945e+06  4.45e-02 1.10e-03  5.22e+00    11s
  15  -3.71114996e+04  3.75991124e+05  1.26e-02 2.91e-04  1.60e+00    11s
  16  -2.21989031e+04  1.86714570e+05  6.52e-03 1.10e-03  8.11e-01    11s
  17  -1.72895078e+04  1.08485762e+05  5.31e-03 1.28e-03  4.88e-01    11s
  18  -1.15838137e+04  8.05411648e+04  3.99e-03 8.91e-04  3.58e-01    11s
  19  -9.15301091e+03  6.74693078e+04  3.53e-03 1.00e-03  2.98e-01    11s
  20  -6.52621482e+03  5.67109685e+04  3.03e-03 1.34e-03  2.46e-01    11s
  21  -2.96263114e+03  4.71061257e+04  2.41e-03 9.94e-04  1.94e-01    12s
  22  -3.18930009e+02  3.68068180e+04  1.99e-03 9.01e-04  1.44e-01    12s
  23   1.79856411e+03  3.20737457e+04  1.68e-03 7.82e-04  1.18e-01    12s
  24   4.17507125e+03  2.79415774e+04  1.34e-03 6.07e-04  9.23e-02    12s
  25   5.89805174e+03  2.38583499e+04  1.11e-03 4.16e-04  6.97e-02    12s
  26   8.08292362e+03  2.11832830e+04  8.48e-04 2.81e-04  5.09e-02    12s
  27   9.02136144e+03  2.03053277e+04  7.36e-04 2.38e-04  4.38e-02    12s
  28   1.05446120e+04  1.92690041e+04  5.56e-04 1.81e-04  3.39e-02    13s
  29   1.14662218e+04  1.76112537e+04  4.45e-04 1.11e-04  2.39e-02    13s
  30   1.19427041e+04  1.70245431e+04  3.87e-04 8.12e-05  1.97e-02    13s
  31   1.29797137e+04  1.65974947e+04  2.65e-04 5.92e-05  1.40e-02    13s
  32   1.32949177e+04  1.62609462e+04  2.30e-04 4.32e-05  1.15e-02    13s
  33   1.35746799e+04  1.60623207e+04  1.98e-04 3.35e-05  9.66e-03    13s
  34   1.40583689e+04  1.58098590e+04  1.45e-04 2.70e-05  6.80e-03    14s
  35   1.42809399e+04  1.57358802e+04  1.22e-04 2.19e-05  5.65e-03    14s
  36   1.43946483e+04  1.56864982e+04  1.10e-04 1.83e-05  5.02e-03    14s
  37   1.45759135e+04  1.56303054e+04  9.01e-05 1.43e-05  4.09e-03    14s
  38   1.47848827e+04  1.56078964e+04  6.77e-05 1.24e-05  3.20e-03    14s
  39   1.49569045e+04  1.55579012e+04  4.94e-05 8.53e-06  2.33e-03    15s
  40   1.50493510e+04  1.55284467e+04  3.96e-05 6.44e-06  1.86e-03    15s
  41   1.51146578e+04  1.54981341e+04  3.29e-05 4.33e-06  1.49e-03    15s
  42   1.52078295e+04  1.54905473e+04  2.33e-05 3.84e-06  1.10e-03    15s
  43   1.52302551e+04  1.54834136e+04  2.11e-05 3.33e-06  9.83e-04    15s
  44   1.52547309e+04  1.54783951e+04  1.85e-05 2.92e-06  8.68e-04    15s
  45   1.52652943e+04  1.54719598e+04  1.75e-05 2.51e-06  8.02e-04    16s
  46   1.52709427e+04  1.54688476e+04  1.68e-05 2.30e-06  7.68e-04    16s
  47   1.53010102e+04  1.54599563e+04  1.36e-05 1.76e-06  6.17e-04    16s
  48   1.53142519e+04  1.54588377e+04  1.22e-05 1.69e-06  5.61e-04    16s
  49   1.53188853e+04  1.54558285e+04  1.17e-05 1.50e-06  5.32e-04    16s
  50   1.53274885e+04  1.54515111e+04  1.07e-05 1.24e-06  4.81e-04    17s
  51   1.53626678e+04  1.54469627e+04  7.03e-06 9.39e-07  3.27e-04    17s
  52   1.53860821e+04  1.54437564e+04  4.63e-06 7.32e-07  2.24e-04    17s
  53   1.54024347e+04  1.54403672e+04  2.96e-06 5.03e-07  1.47e-04    17s
  54   1.54147506e+04  1.54364218e+04  1.75e-06 2.00e-07  8.41e-05    17s
  55   1.54168119e+04  1.54360496e+04  1.56e-06 1.78e-07  7.47e-05    17s
  56   1.54208309e+04  1.54349697e+04  1.15e-06 1.13e-07  5.49e-05    18s
  57   1.54228320e+04  1.54345790e+04  9.63e-07 8.91e-08  4.56e-05    18s
  58   1.54265741e+04  1.54338250e+04  6.08e-07 4.01e-08  2.82e-05    18s
  59   1.54291051e+04  1.54335648e+04  3.73e-07 2.76e-08  1.73e-05    18s
  60   1.54323646e+04  1.54335534e+04  6.33e-08 2.70e-08  4.62e-06    18s
  61   1.54328138e+04  1.54331031e+04  2.06e-08 2.45e-09  1.12e-06    18s
  62   1.54330179e+04  1.54330550e+04  3.92e-09 6.08e-11  1.44e-07    19s
  63   1.54330533e+04  1.54330541e+04  9.14e-08 1.53e-09  3.16e-09    19s
  64   1.54330531e+04  1.54330541e+04  2.67e-06 3.62e-09  3.16e-09    19s
  65   1.54330531e+04  1.54330542e+04  2.64e-06 2.44e-07  3.32e-09    19s
  66   1.54330532e+04  1.54330542e+04  2.33e-06 2.11e-07  2.92e-09    19s

Barrier solved model in 66 iterations and 19.21 seconds (18.57 work units)
Optimal objective 1.54330532e+04


Root crossover log...

  125147 DPushes remaining with DInf 0.0000000e+00                19s
   63130 DPushes remaining with DInf 0.0000000e+00                20s
   21027 DPushes remaining with DInf 0.0000000e+00                25s
     831 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                31s

   44015 PPushes remaining with PInf 5.4531227e-04                31s
    6922 PPushes remaining with PInf 1.2276709e-03                35s
       0 PPushes remaining with PInf 0.0000000e+00                37s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7343798e+05     37s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  117548    1.5433054e+04   0.000000e+00   1.734380e+05     37s
  118588    1.5433054e+04   0.000000e+00   1.466070e+06     40s
  120466    1.5433055e+04   0.000000e+00   5.286073e+03     45s
  121663    1.5433054e+04   0.000000e+00   0.000000e+00     48s
  121663    1.5433054e+04   0.000000e+00   0.000000e+00     48s
Concurrent spin time: 17.61s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 121663 iterations, 59.38 seconds (64.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   66s
H    0     0                    -149512.4448 15433.0541   110%     -   67s
H    0     0                    -140450.7518 15433.0541   111%     -   67s
H    0     0                    -78058.88076 15433.0541   120%     -   67s
H    0     0                    -25707.78549 15433.0541   160%     -   68s
H    0     0                    -23893.11928 15433.0541   165%     -   68s
H    0     0                    -23638.46861 15433.0541   165%     -   69s
     0     0 11467.7482    0  422 -23638.469 11467.7482   149%     -  209s
H    0     0                    -23293.03602 11467.5772   149%     -  210s
H    0     0                    -23255.17905 11467.5772   149%     -  210s
H    0     0                    -23212.44998 11467.5772   149%     -  210s
H    0     0                    -23097.30760 11467.5772   150%     -  210s
     0     0 10852.8565    0  421 -23097.308 10852.8565   147%     -  248s
     0     0 10805.8964    0  422 -23097.308 10805.8964   147%     -  270s
     0     0 10775.7808    0  415 -23097.308 10775.7808   147%     -  288s
     0     0 10775.7794    0  415 -23097.308 10775.7794   147%     -  290s
     0     0 8704.44950    0  475 -23097.308 8704.44950   138%     -  394s
H    0     0                    -11398.39598 8704.40413   176%     -  395s
H    0     0                    -11332.81796 8704.40413   177%     -  395s
     0     0 8404.27160    0  472 -11332.818 8404.27160   174%     -  444s
     0     0 7841.50831    0  493 -11332.818 7841.50831   169%     -  494s
     0     0 7768.32567    0  497 -11332.818 7768.32567   169%     -  523s
     0     0 7698.83875    0  496 -11332.818 7698.83875   168%     -  540s
     0     0 7638.49180    0  491 -11332.818 7638.49180   167%     -  561s
     0     0 7573.25955    0  496 -11332.818 7573.25955   167%     -  569s
     0     0 7438.40244    0  509 -11332.818 7438.40244   166%     -  597s
     0     0 7385.62269    0  507 -11332.818 7385.62269   165%     -  609s
     0     0 7379.50017    0  519 -11332.818 7379.50017   165%     -  615s
     0     0 7363.53351    0  524 -11332.818 7363.53351   165%     -  623s
     0     0 7265.10682    0  396 -11332.818 7265.10682   164%     -  640s
     0     0 7255.27317    0  402 -11332.818 7255.27317   164%     -  650s
     0     0 7226.30193    0  394 -11332.818 7226.30193   164%     -  660s
     0     0 7153.20506    0  522 -11332.818 7153.20506   163%     -  681s
     0     0 7149.18805    0  525 -11332.818 7149.18805   163%     -  686s
     0     0 7149.06755    0  525 -11332.818 7149.06755   163%     -  687s
     0     0 5785.31209    0  448 -11332.818 5785.31209   151%     -  782s
H    0     0                    -11292.05193 5783.36103   151%     -  783s
     0     0 5410.64786    0  442 -11292.052 5410.64786   148%     -  828s
     0     0 5068.14943    0  545 -11292.052 5068.14943   145%     -  867s
     0     0 4974.26476    0  466 -11292.052 4974.26476   144%     -  887s
     0     0 4854.77436    0  540 -11292.052 4854.77436   143%     -  914s
     0     0 4824.58333    0  474 -11292.052 4824.58333   143%     -  924s
     0     0 4752.76147    0  468 -11292.052 4752.76147   142%     -  936s
     0     0 4734.06195    0  475 -11292.052 4734.06195   142%     -  942s
     0     0 4726.16874    0  474 -11292.052 4726.16874   142%     -  946s
     0     0 4707.40338    0  467 -11292.052 4707.40338   142%     -  960s
     0     0 4703.50822    0  468 -11292.052 4703.50822   142%     -  963s
     0     0 4684.14316    0  470 -11292.052 4684.14316   141%     -  975s
     0     0 4669.92194    0  460 -11292.052 4669.92194   141%     -  983s
     0     0 4664.84972    0  467 -11292.052 4664.84972   141%     -  988s
     0     0 4664.10145    0  463 -11292.052 4664.10145   141%     -  989s
     0     0 4157.42109    0  557 -11292.052 4157.42109   137%     - 1050s
     0     0 4037.01556    0  488 -11292.052 4037.01556   136%     - 1080s
     0     0 3994.96732    0  480 -11292.052 3994.96732   135%     - 1096s
     0     0 3978.11425    0  483 -11292.052 3978.11425   135%     - 1110s
     0     0 3967.38904    0  489 -11292.052 3967.38904   135%     - 1117s
     0     0 3962.93077    0  481 -11292.052 3962.93077   135%     - 1126s
     0     0 3956.71665    0  485 -11292.052 3956.71665   135%     - 1134s
     0     0 3953.85261    0  480 -11292.052 3953.85261   135%     - 1142s
     0     0 3952.58247    0  485 -11292.052 3952.58247   135%     - 1144s
     0     0 3767.48650    0  562 -11292.052 3767.48650   133%     - 1184s
     0     0 3668.61417    0  502 -11292.052 3668.61417   132%     - 1206s
     0     0 3657.88159    0  507 -11292.052 3657.88159   132%     - 1212s
     0     0 3649.65389    0  495 -11292.052 3649.65389   132%     - 1218s
     0     0 3634.88752    0  489 -11292.052 3634.88752   132%     - 1225s
     0     0 3629.93296    0  494 -11292.052 3629.93296   132%     - 1229s
     0     0 3628.82076    0  495 -11292.052 3628.82076   132%     - 1231s
     0     0 3522.39221    0  569 -11292.052 3522.39221   131%     - 1256s
     0     0 3495.81986    0  575 -11292.052 3495.81986   131%     - 1274s
     0     0 3483.77625    0  576 -11292.052 3483.77625   131%     - 1281s
     0     0 3481.01037    0  602 -11292.052 3481.01037   131%     - 1287s
     0     0 3478.14681    0  584 -11292.052 3478.14681   131%     - 1291s
     0     0 3475.68504    0  582 -11292.052 3475.68504   131%     - 1295s
     0     0 3471.76319    0  579 -11292.052 3471.76319   131%     - 1299s
     0     0 3467.15240    0  586 -11292.052 3467.15240   131%     - 1306s
     0     0 3465.81475    0  587 -11292.052 3465.81475   131%     - 1310s
     0     0 3428.32339    0  502 -11292.052 3428.32339   130%     - 1328s
     0     0 3408.03399    0  500 -11292.052 3408.03399   130%     - 1350s
     0     0 3402.29916    0  506 -11292.052 3402.29916   130%     - 1355s
     0     0 3397.55559    0  501 -11292.052 3397.55559   130%     - 1361s
     0     0 3396.32567    0  500 -11292.052 3396.32567   130%     - 1362s
     0     0 3362.15067    0  506 -11292.052 3362.15067   130%     - 1389s
     0     0 3343.69136    0  516 -11292.052 3343.69136   130%     - 1405s
     0     0 3341.10514    0  523 -11292.052 3341.10514   130%     - 1408s
     0     0 3340.35753    0  522 -11292.052 3340.35753   130%     - 1411s
     0     0 3333.40680    0  515 -11292.052 3333.40680   130%     - 1421s
     0     0 3327.56037    0  518 -11292.052 3327.56037   129%     - 1428s
     0     0 3325.63053    0  519 -11292.052 3325.63053   129%     - 1433s
     0     0 3324.12478    0  524 -11292.052 3324.12478   129%     - 1435s
     0     0 3314.64602    0  654 -11292.052 3314.64602   129%     - 1454s
     0     0 3310.70868    0  533 -11292.052 3310.70868   129%     - 1462s
     0     0 3310.19646    0  531 -11292.052 3310.19646   129%     - 1463s
     0     0 3298.67170    0  530 -11292.052 3298.67170   129%     - 1473s
     0     0 3296.06909    0  532 -11292.052 3296.06909   129%     - 1478s
     0     0 3293.52813    0  541 -11292.052 3293.52813   129%     - 1484s
     0     0 3292.62407    0  534 -11292.052 3292.62407   129%     - 1486s
     0     0 3282.00569    0  657 -11292.052 3282.00569   129%     - 1499s
H    0     0                    -7661.494379 3281.96915   143%     - 1529s
H    0     0                    -7090.583683 3281.96915   146%     - 1531s
H    0     0                    -6980.048810 3281.96915   147%     - 1531s
H    0     0                    -6634.551838 3281.96915   149%     - 1535s
H    0     0                    -6555.879785 3281.96915   150%     - 1539s
H    0     0                    -6526.762172 3281.96915   150%     - 1539s
H    0     0                    -6514.428649 3281.96915   150%     - 1539s
H    0     0                    -6399.863420 3281.96915   151%     - 1539s
H    0     0                    -6388.257062 3281.96915   151%     - 1540s
H    0     0                    -6356.895581 3281.96915   152%     - 1540s
H    0     0                    -6231.330276 3281.96915   153%     - 1544s
H    0     0                    -6174.111288 3281.96915   153%     - 1544s
H    0     0                    -6167.209778 3281.96915   153%     - 1544s
H    0     0                    -6165.512284 3281.96915   153%     - 1544s
     0     0 3277.62172    0  654 -6165.5123 3277.62172   153%     - 1553s
     0     0 3275.45628    0  655 -6165.5123 3275.45628   153%     - 1559s
     0     0 3274.62915    0  600 -6165.5123 3274.62915   153%     - 1562s
     0     0 3259.13658    0  643 -6165.5123 3259.13658   153%     - 1581s
H    0     0                    -6021.727881 3259.10344   154%     - 1583s
     0     0 3256.72392    0  529 -6021.7279 3256.72392   154%     - 1587s
     0     0 3254.05654    0  647 -6021.7279 3254.05654   154%     - 1592s
     0     0 3252.57033    0  516 -6021.7279 3252.57033   154%     - 1594s
     0     0 3239.51081    0  609 -6021.7279 3239.51081   154%     - 1608s
H    0     0                    -6003.545110 3239.48101   154%     - 1613s
H    0     0                    -6002.144930 3239.48101   154%     - 1614s
     0     0 3235.59191    0  609 -6002.1449 3235.59191   154%     - 1620s
     0     0 3232.16145    0  611 -6002.1449 3232.16145   154%     - 1625s
     0     0 3231.26965    0  609 -6002.1449 3231.26965   154%     - 1627s
     0     0 3221.10318    0  601 -6002.1449 3221.10318   154%     - 1643s
     0     0 3220.27513    0  613 -6002.1449 3220.27513   154%     - 1648s
     0     0 3217.74039    0  597 -6002.1449 3217.74039   154%     - 1657s
H    0     0                    -5969.878450 3217.38705   154%     - 1698s
H    0     0                    -5832.269904 3217.38705   155%     - 1698s
H    0     0                    -5804.053034 3217.38705   155%     - 1703s
H    0     0                    -5788.693234 3217.38705   156%     - 1708s
     0     0 3216.54254    0  598 -5788.6932 3216.54254   156%     - 1714s
     0     0 3212.02964    0  598 -5788.6932 3212.02964   155%     - 1722s
     0     0 3210.91231    0  604 -5788.6932 3210.91231   155%     - 1727s
     0     0 3206.27820    0  607 -5788.6932 3206.27820   155%     - 1737s
     0     0 3204.70135    0  607 -5788.6932 3204.70135   155%     - 1751s
H    0     0                    -5784.939333 3204.70135   155%     - 1980s
H    0     0                    -5772.264006 3204.70135   156%     - 1983s
     0     2 3204.70135    0  607 -5772.2640 3204.70135   156%     - 1985s
     1     3 2781.87419    1  451 -5772.2640 3204.70135   156% 16093 2024s
     2     4 3110.26149    1  593 -5772.2640 3110.26149   154% 10430 2042s
     3     6 2060.68017    2  484 -5772.2640 3110.24927   154%  9921 2070s
     5    12 1244.02281    3  443 -5772.2640 3110.24927   154% 11070 2102s
    11    24 1138.80387    4  434 -5772.2640 2911.08444   150% 10173 2135s
    23    36 1293.10405    4  393 -5772.2640 2445.26150   142% 17459 2240s
    35    67  901.67637    5  403 -5772.2640 2445.26150   142% 16842 2497s
H   38    67                    -5728.687065 2445.26150   143% 16090 2497s
H   39    67                    -5680.613128 2445.26150   143% 16065 2497s
    66   161  697.19855    6  396 -5680.6131 1898.26438   133% 23762 2589s
   160   199 -832.22637    9  360 -5680.6131 1862.77774   133% 15695 2619s
H  161   199                    -5649.952700 1862.77774   133% 15597 2619s
H  167   199                    -5648.783009 1862.77774   133% 15401 2619s
H  170   199                    -5639.842379 1862.77774   133% 15232 2619s
   198   286 -865.36304   10  365 -5639.8424 1862.77774   133% 14009 2675s
   285   359 -1106.9343   13  296 -5639.8424 1862.77774   133% 11393 2720s
   358   418 -1501.8963   15  281 -5639.8424 1862.77774   133% 10076 2760s
   419   471 -1962.5040   17  269 -5639.8424 1862.77774   133%  9569 2799s
   479   514 -2063.2719   18  263 -5639.8424 1862.77774   133%  9295 2836s
   539   531     cutoff   20      -5639.8424 1862.77774   133%  9128 2869s
   566   535 -4091.1864   20  225 -5639.8424 1862.77774   133%  9293 2903s
   596   544 -4156.2778   21  226 -5639.8424 1862.77774   133%  9322 2937s
   619   566 -4308.5496   22  275 -5639.8424 1862.77774   133%  9415 2987s
   657   590 -4808.8008   23  245 -5639.8424 1862.77774   133%  9558 3018s
   686   609 -5508.2048   24  254 -5639.8424 1862.77774   133%  9596 3052s
   730   640     cutoff   25      -5639.8424 1862.77774   133%  9516 3078s
   793   680 infeasible   24      -5639.8424 1597.60451   128%  9308 3107s
   879   702  466.66969    6  442 -5639.8424 1597.60451   128%  9037 3139s
   959   718 -5217.6435   25  189 -5639.8424 1597.60451   128%  8669 3170s
  1023   704 -5250.7166   26  184 -5639.8424 1597.60451   128%  8452 3206s
  1100   706 infeasible   26      -5639.8424 1597.60451   128%  8205 3244s
  1152   732 -3105.0389   14  475 -5639.8424 1597.60451   128%  8320 3284s
  1228   764 -3809.3580   15  367 -5639.8424 1597.60451   128%  8246 3323s
  1305   776 -5416.8216   16  414 -5639.8424 1597.60451   128%  8331 3361s
  1388   812     cutoff   17      -5639.8424 1597.60451   128%  8331 3405s
  1460   836 -3385.7790   15  391 -5639.8424 1597.60451   128%  8351 3448s
  1543   858 -4325.6696   16  466 -5639.8424 1597.60451   128%  8345 3495s
  1626   872 -4840.5047   17  449 -5639.8424 1597.60451   128%  8358 3557s
  1699   882 infeasible   17      -5639.8424 1327.52696   124%  8371 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 186
  MIR: 2875
  Flow cover: 3284
  Zero half: 2
  RLT: 36
  Relax-and-lift: 287

Explored 1759 nodes (15755750 simplex iterations) in 3600.12 seconds (5206.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5639.84 -5648.78 -5649.95 ... -5832.27

Time limit reached
Best objective -5.639842379396e+03, best bound 1.327526963897e+03, gap 123.5384%
  WARNING: Time limit reached. Using best solution found (gap: 123.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -5639.84, θ = 120407.38
  Upper Bound (UB) = -5639.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120407.38
  [DEBUG]   ✓ Scenario 0: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120407.38 ≤ Q = 120407.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120407.38 ≤ Q = 120407.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120407.38 ≤ Q = 120407.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120407.38 ≤ Q = 120407.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ca5a334
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ca5a334
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368295e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6423923.9493
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.449456e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144945.62    0  124 6423923.95 -144945.62   102%     -    0s
H    0     0                    -110823.3597 -144945.62  30.8%     -    0s
H    0     0                    -111940.5549 -144945.62  29.5%     -    0s
     0     0 -121891.02    0  128 -111940.55 -121891.02  8.89%     -    0s
H    0     0                    -116065.9543 -121733.24  4.88%     -    0s
     0     0 -120716.25    0   86 -116065.95 -120716.25  4.01%     -    0s
H    0     0                    -118080.2731 -120552.35  2.09%     -    0s
H    0     0                    -118344.4779 -120552.35  1.87%     -    0s
     0     0 -119747.93    0   78 -118344.48 -119747.93  1.19%     -    0s
     0     0 -119711.78    0   75 -118344.48 -119711.78  1.16%     -    0s
     0     0 -119709.14    0   75 -118344.48 -119709.14  1.15%     -    0s
     0     0 -119210.76    0   48 -118344.48 -119210.76  0.73%     -    0s
     0     0 -119042.58    0   46 -118344.48 -119042.58  0.59%     -    0s
     0     0 -118936.45    0   49 -118344.48 -118936.45  0.50%     -    0s
     0     0 -118919.97    0   49 -118344.48 -118919.97  0.49%     -    0s
H    0     0                    -118391.3116 -118919.97  0.45%     -    0s
     0     2 -118919.97    0   49 -118391.31 -118919.97  0.45%     -    0s

Cutting planes:
  Gomory: 54
  Implied bound: 5
  MIR: 177
  Flow cover: 5
  RLT: 32
  BQP: 1

Explored 2546 nodes (19239 simplex iterations) in 0.34 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -118391 -118344 -118080 ... 1.3683e+13
No other solutions better than -118391

Optimal solution found (tolerance 1.00e-06)
Best objective -1.183913115941e+05, best bound -1.183913115941e+05, gap 0.0000%
  Subproblem solved in 0.37s
  Worst-case operational profit (Z_SP) = 115610.02
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118391.31
  [DEBUG]   S×d_nominal = 234001.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234001.34 + -118391.31 = 115610.02
  [DEBUG]   Current θ from Master = 120407.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4797.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10437.19
  Lower Bound (LB) = -8473.73
  Gap (UB-LB) = 2833.8887, Absolute Gap = 2833.8887, Relative Gap = 0.502477
  Not converged yet (gap = 2833.89 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xa366ad88
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns
Presolve time: 4.92s
Presolved: 149343 rows, 62920 columns, 918417 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.58s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 7.627e+06
 Factor NZ  : 1.733e+07 (roughly 230 MB of memory)
 Factor Ops : 4.339e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80132082e+07  2.79035867e+08  1.02e+05 1.32e+01  7.88e+04     8s
   1  -1.37965800e+07  2.41334454e+08  7.17e+04 4.37e+01  5.49e+04     8s
   2  -4.67008098e+06  1.87235240e+08  2.35e+04 8.49e-01  1.88e+04     8s
   3  -1.28105958e+06  1.78891404e+08  3.17e+03 1.36e+01  3.10e+03     8s
   4  -6.95352238e+05  1.39836459e+08  5.71e+02 9.06e+00  9.40e+02     8s
   5  -5.84489600e+05  8.18430885e+07  3.12e+02 4.71e+00  5.12e+02     8s
   6  -5.13410935e+05  6.17319589e+07  2.02e+02 3.31e+00  3.55e+02     8s
   7  -4.73007478e+05  4.43288112e+07  7.63e+01 2.04e+00  2.09e+02     9s
   8  -3.85172276e+05  3.29483303e+07  1.09e+01 1.06e+00  1.28e+02     9s
   9  -2.56676342e+05  9.05664469e+06  3.52e-01 2.07e-02  3.43e+01     9s
  10  -1.58192650e+05  3.39142992e+06  1.42e-01 7.51e-03  1.31e+01     9s
  11  -1.25660739e+05  2.74189450e+06  9.58e-02 7.94e-02  1.05e+01     9s
  12  -8.60604797e+04  1.72286728e+06  4.12e-02 3.95e-02  6.65e+00     9s
  13  -5.73388474e+04  1.30348891e+06  1.51e-02 1.65e-02  5.00e+00     9s
  14  -3.24217067e+04  8.13726833e+05  3.58e-03 1.74e-03  3.11e+00     9s
  15  -2.69830835e+04  4.36530181e+05  2.39e-03 1.46e-02  1.70e+00    10s
  16  -1.74130572e+04  1.82289835e+05  1.16e-03 2.99e-03  7.34e-01    10s
  17  -1.37035598e+04  1.42682903e+05  9.52e-04 2.37e-03  5.74e-01    10s
  18  -9.15754069e+03  1.07838410e+05  7.39e-04 9.51e-04  4.30e-01    10s
  19  -6.28117057e+03  7.25599845e+04  6.21e-04 6.01e-04  2.90e-01    10s
  20  -3.27152578e+03  6.17002815e+04  5.02e-04 6.64e-04  2.39e-01    10s
  21  -1.04007348e+03  4.96633401e+04  4.26e-04 1.14e-03  1.86e-01    10s
  22   2.26965856e+03  4.36646994e+04  3.15e-04 8.10e-04  1.52e-01    10s
  23   3.40437217e+03  3.80088762e+04  2.80e-04 6.15e-04  1.27e-01    10s
  24   6.31194132e+03  3.39927337e+04  1.96e-04 5.32e-04  1.02e-01    11s
  25   8.08491001e+03  2.70695416e+04  1.52e-04 2.72e-03  6.97e-02    11s
  26   1.03724485e+04  2.36467900e+04  1.01e-04 1.69e-03  4.88e-02    11s
  27   1.15300354e+04  2.18012311e+04  7.62e-05 1.30e-03  3.77e-02    11s
  28   1.23329721e+04  1.96095754e+04  5.93e-05 8.87e-04  2.67e-02    11s
  29   1.28401310e+04  1.83461768e+04  4.81e-05 6.50e-04  2.02e-02    11s
  30   1.33395871e+04  1.73365115e+04  3.82e-05 7.36e-04  1.47e-02    11s
  31   1.37360311e+04  1.66916815e+04  3.03e-05 4.28e-04  1.09e-02    12s
  32   1.43012759e+04  1.63545035e+04  1.96e-05 3.07e-04  7.54e-03    12s
  33   1.44510575e+04  1.59437215e+04  1.69e-05 1.70e-04  5.48e-03    12s
  34   1.47042750e+04  1.58489727e+04  1.23e-05 1.39e-04  4.20e-03    12s
  35   1.48463466e+04  1.57479902e+04  9.82e-06 1.05e-04  3.31e-03    12s
  36   1.49181971e+04  1.57369193e+04  8.62e-06 1.01e-04  3.01e-03    13s
  37   1.50817211e+04  1.56466552e+04  5.82e-06 6.98e-05  2.07e-03    13s
  38   1.51433357e+04  1.55838015e+04  4.77e-06 4.88e-05  1.62e-03    13s
  39   1.51481370e+04  1.55709003e+04  4.69e-06 4.45e-05  1.55e-03    13s
  40   1.51993911e+04  1.55372177e+04  3.81e-06 3.32e-05  1.24e-03    13s
  41   1.52373010e+04  1.55206554e+04  3.21e-06 2.77e-05  1.04e-03    13s
  42   1.52660349e+04  1.55000521e+04  2.75e-06 2.08e-05  8.59e-04    14s
  43   1.52864953e+04  1.54894166e+04  2.42e-06 1.75e-05  7.45e-04    14s
  44   1.53090838e+04  1.54732549e+04  2.02e-06 1.27e-05  6.03e-04    14s
  45   1.53157186e+04  1.54717312e+04  1.91e-06 1.22e-05  5.73e-04    14s
  46   1.53368756e+04  1.54685635e+04  1.56e-06 1.12e-05  4.83e-04    14s
  47   1.53466508e+04  1.54650039e+04  1.40e-06 1.01e-05  4.35e-04    15s
  48   1.53549613e+04  1.54594203e+04  1.26e-06 8.38e-06  3.84e-04    15s
  49   1.53934003e+04  1.54503517e+04  6.26e-07 5.45e-06  2.09e-04    15s
  50   1.54025542e+04  1.54451086e+04  4.72e-07 3.79e-06  1.56e-04    15s
  51   1.54166191e+04  1.54413165e+04  2.56e-07 2.58e-06  9.07e-05    15s
  52   1.54212844e+04  1.54347233e+04  1.85e-07 3.64e-07  4.93e-05    15s
  53   1.54219798e+04  1.54343966e+04  1.74e-07 2.97e-07  4.56e-05    16s
  54   1.54245084e+04  1.54341197e+04  1.33e-07 2.39e-07  3.53e-05    16s
  55   1.54265897e+04  1.54339577e+04  9.89e-08 2.00e-07  2.70e-05    16s
  56   1.54269932e+04  1.54339440e+04  9.27e-08 1.97e-07  2.55e-05    16s
  57   1.54298342e+04  1.54333755e+04  5.14e-08 6.60e-08  1.30e-05    16s
  58   1.54324420e+04  1.54332677e+04  1.86e-08 4.56e-08  3.03e-06    16s
  59   1.54328381e+04  1.54331973e+04  6.53e-09 3.06e-08  1.32e-06    17s
  60   1.54329684e+04  1.54330682e+04  8.05e-09 2.68e-09  3.67e-07    17s
  61   1.54330485e+04  1.54330542e+04  8.09e-08 3.06e-08  2.07e-08    17s
  62   1.54330493e+04  1.54330542e+04  3.86e-06 2.39e-08  1.90e-08    17s
  63   1.54330524e+04  1.54330541e+04  1.44e-06 1.27e-08  6.62e-09    17s
  64   1.54330528e+04  1.54330541e+04  2.94e-06 9.65e-09  5.15e-09    17s
  65   1.54330532e+04  1.54330541e+04  1.91e-06 2.57e-09  3.60e-09    17s
  66   1.54330536e+04  1.54330542e+04  2.82e-06 3.20e-06  2.19e-09    18s
  67   1.54330536e+04  1.54330542e+04  2.67e-06 2.93e-06  2.07e-09    18s
  68   1.54330536e+04  1.54330541e+04  6.14e-06 3.56e-06  1.38e-09    18s
  69   1.54330536e+04  1.54330541e+04  6.14e-06 3.56e-06  1.38e-09    18s
  70   1.54330536e+04  1.54330541e+04  6.14e-06 3.55e-06  1.38e-09    18s
  71   1.54330536e+04  1.54330541e+04  6.14e-06 3.53e-06  1.38e-09    18s
  72   1.54330536e+04  1.54330541e+04  6.08e-06 3.38e-06  1.38e-09    19s
  73   1.54330536e+04  1.54330541e+04  5.59e-06 3.02e-06  1.27e-09    19s
  74   1.54330540e+04  1.54330541e+04  9.77e-07 4.10e-08  2.21e-10    19s

Barrier solved model in 74 iterations and 19.04 seconds (20.67 work units)
Optimal objective 1.54330540e+04


Root crossover log...

  132338 DPushes remaining with DInf 0.0000000e+00                19s
   57227 DPushes remaining with DInf 0.0000000e+00                20s
    5464 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    7534 PPushes remaining with PInf 4.7859459e-05                27s
       0 PPushes remaining with PInf 2.1745377e-07                28s

  Push phase complete: Pinf 2.1745377e-07, Dinf 4.3759600e+05     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71743    1.5433054e+04   0.000000e+00   4.375960e+05     28s
   71946    1.5433054e+04   0.000000e+00   0.000000e+00     28s
   71946    1.5433054e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 5.83s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 71946 iterations, 28.27 seconds (33.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   35s
H    0     0                    -175398.9179 15433.0541   109%     -   35s
H    0     0                    -135868.8478 15433.0541   111%     -   36s
H    0     0                    -135154.0000 15433.0541   111%     -   37s
H    0     0                    -134913.6944 15433.0541   111%     -   38s
H    0     0                    -132550.7634 15433.0541   112%     -   40s
H    0     0                    -131476.1971 15433.0541   112%     -   40s
H    0     0                    -129380.7831 15433.0541   112%     -   40s
H    0     0                    -128566.1956 15433.0541   112%     -   40s
H    0     0                    -128420.3953 15433.0541   112%     -   40s
H    0     0                    -120431.0391 15433.0541   113%     -   40s
H    0     0                    -120376.1688 15433.0541   113%     -   40s
H    0     0                    -58391.55012 15433.0541   126%     -   41s
H    0     0                    -54788.48517 15433.0541   128%     -   41s
H    0     0                    -40754.05450 15433.0541   138%     -   41s
H    0     0                    -40745.21359 15433.0541   138%     -   41s
     0     0 11646.6419    0  416 -40745.214 11646.6419   129%     -  190s
H    0     0                    -39835.31929 11646.0810   129%     -  191s
H    0     0                    -37211.53223 11646.0810   131%     -  192s
H    0     0                    -36653.76740 11646.0810   132%     -  192s
H    0     0                    -36637.58492 11646.0810   132%     -  192s
H    0     0                    -36608.08007 11646.0810   132%     -  192s
H    0     0                    -36478.95895 11646.0810   132%     -  192s
     0     0 11385.4788    0  422 -36478.959 11385.4788   131%     -  316s
     0     0 11311.2537    0  424 -36478.959 11311.2537   131%     -  344s
     0     0 11294.3355    0  423 -36478.959 11294.3355   131%     -  356s
     0     0 11294.3335    0  423 -36478.959 11294.3335   131%     -  357s
     0     0 8441.83150    0  464 -36478.959 8441.83150   123%     -  467s
H    0     0                    -32208.61703 8441.50037   126%     -  468s
H    0     0                    -31700.18099 8441.50037   127%     -  469s
H    0     0                    -30900.59839 8441.50037   127%     -  469s
H    0     0                    -30846.16061 8441.50037   127%     -  469s
H    0     0                    -30613.60366 8441.50037   128%     -  469s
H    0     0                    -30332.54637 8441.50037   128%     -  469s
H    0     0                    -30274.87198 8441.50037   128%     -  469s
H    0     0                    -30132.58841 8441.50037   128%     -  469s
     0     0 8157.18219    0  452 -30132.588 8157.18219   127%     -  513s
     0     0 7609.36555    0  484 -30132.588 7609.36555   125%     -  552s
     0     0 7572.40324    0  490 -30132.588 7572.40324   125%     -  562s
     0     0 7551.70071    0  384 -30132.588 7551.70071   125%     -  574s
     0     0 7495.68282    0  477 -30132.588 7495.68282   125%     -  595s
     0     0 7455.74866    0  486 -30132.588 7455.74866   125%     -  607s
     0     0 7444.08361    0  481 -30132.588 7444.08361   125%     -  612s
     0     0 7440.82793    0  470 -30132.588 7440.82793   125%     -  616s
     0     0 7439.37405    0  469 -30132.588 7439.37405   125%     -  618s
     0     0 7370.46122    0  484 -30132.588 7370.46122   124%     -  630s
     0     0 7240.54108    0  454 -30132.588 7240.54108   124%     -  652s
     0     0 7215.03463    0  464 -30132.588 7215.03463   124%     -  662s
     0     0 7214.93209    0  465 -30132.588 7214.93209   124%     -  666s
     0     0 5718.19276    0  417 -30132.588 5718.19276   119%     -  763s
H    0     0                    -28588.50579 5717.94901   120%     -  764s
H    0     0                    -28405.84077 5717.94901   120%     -  764s
     0     0 5450.17623    0  419 -28405.841 5450.17623   119%     -  808s
     0     0 5287.99090    0  425 -28405.841 5287.99090   119%     -  834s
     0     0 5150.12746    0  445 -28405.841 5150.12746   118%     -  859s
     0     0 5073.41289    0  442 -28405.841 5073.41289   118%     -  879s
     0     0 5015.60018    0  551 -28405.841 5015.60018   118%     -  901s
     0     0 4916.00270    0  442 -28405.841 4916.00270   117%     -  921s
     0     0 4907.55232    0  447 -28405.841 4907.55232   117%     -  931s
     0     0 4898.49067    0  547 -28405.841 4898.49067   117%     -  941s
     0     0 4878.20342    0  547 -28405.841 4878.20342   117%     -  957s
     0     0 4874.08060    0  533 -28405.841 4874.08060   117%     -  967s
     0     0 4873.97305    0  534 -28405.841 4873.97305   117%     -  969s
     0     0 4085.49157    0  667 -28405.841 4085.49157   114%     - 1061s
H    0     0                    -20349.42098 4085.05768   120%     - 1063s
H    0     0                    -19481.71932 4085.05768   121%     - 1063s
H    0     0                    -19383.43660 4085.05768   121%     - 1063s
H    0     0                    -19218.87928 4085.05768   121%     - 1064s
H    0     0                    -19203.05557 4085.05768   121%     - 1064s
H    0     0                    -19181.88418 4085.05768   121%     - 1064s
H    0     0                    -19042.11100 4085.05768   121%     - 1064s
H    0     0                    -18961.21212 4085.05768   122%     - 1064s
H    0     0                    -18940.39410 4085.05768   122%     - 1064s
     0     0 4036.81311    0  679 -18940.394 4036.81311   121%     - 1087s
     0     0 4024.53134    0  667 -18940.394 4024.53134   121%     - 1103s
     0     0 3997.70763    0  626 -18940.394 3997.70763   121%     - 1120s
     0     0 3905.14974    0  629 -18940.394 3905.14974   121%     - 1142s
     0     0 3879.05108    0  629 -18940.394 3879.05108   120%     - 1159s
     0     0 3824.24161    0  621 -18940.394 3824.24161   120%     - 1183s
     0     0 3806.21824    0  633 -18940.394 3806.21824   120%     - 1193s
     0     0 3804.55130    0  633 -18940.394 3804.55130   120%     - 1196s
     0     0 3803.27024    0  633 -18940.394 3803.27024   120%     - 1199s
     0     0 3691.14397    0  477 -18940.394 3691.14397   119%     - 1228s
H    0     0                    -18708.28708 3690.80965   120%     - 1229s
H    0     0                    -17893.60099 3690.80965   121%     - 1229s
H    0     0                    -17409.72996 3690.80965   121%     - 1229s
H    0     0                    -17054.15635 3690.80965   122%     - 1229s
     0     0 3630.58505    0  489 -17054.156 3630.58505   121%     - 1258s
     0     0 3595.86413    0  495 -17054.156 3595.86413   121%     - 1284s
     0     0 3565.03747    0  478 -17054.156 3565.03747   121%     - 1298s
     0     0 3541.97200    0  477 -17054.156 3541.97200   121%     - 1311s
     0     0 3529.96839    0  478 -17054.156 3529.96839   121%     - 1320s
     0     0 3514.50751    0  474 -17054.156 3514.50751   121%     - 1331s
     0     0 3509.94071    0  477 -17054.156 3509.94071   121%     - 1337s
     0     0 3508.90318    0  478 -17054.156 3508.90318   121%     - 1341s
     0     0 3457.34259    0  618 -17054.156 3457.34259   120%     - 1368s
H    0     0                    -16974.15622 3457.29015   120%     - 1377s
H    0     0                    -14893.85650 3457.29015   123%     - 1377s
H    0     0                    -12381.91132 3457.29015   128%     - 1378s
H    0     0                    -12356.33500 3457.29015   128%     - 1378s
H    0     0                    -7571.791716 3457.29015   146%     - 1378s
H    0     0                    -6762.291488 3457.29015   151%     - 1379s
H    0     0                    -6724.863764 3457.29015   151%     - 1380s
H    0     0                    -6705.404924 3457.29015   152%     - 1381s
H    0     0                    -6563.748352 3457.29015   153%     - 1381s
     0     0 3437.95937    0  681 -6563.7484 3437.95937   152%     - 1400s
     0     0 3425.84485    0  477 -6563.7484 3425.84485   152%     - 1412s
     0     0 3408.35929    0  688 -6563.7484 3408.35929   152%     - 1428s
     0     0 3403.36346    0  688 -6563.7484 3403.36346   152%     - 1435s
     0     0 3399.46583    0  693 -6563.7484 3399.46583   152%     - 1444s
     0     0 3397.96592    0  695 -6563.7484 3397.96592   152%     - 1449s
     0     0 3358.49327    0  487 -6563.7484 3358.49327   151%     - 1477s
H    0     0                    -6329.604630 3357.95280   153%     - 1479s
H    0     0                    -6244.947725 3357.95280   154%     - 1479s
H    0     0                    -6216.274523 3357.95280   154%     - 1479s
     0     0 3342.18157    0  487 -6216.2745 3342.18157   154%     - 1496s
     0     0 3339.43825    0  485 -6216.2745 3339.43825   154%     - 1507s
     0     0 3334.18486    0  491 -6216.2745 3334.18486   154%     - 1521s
     0     0 3332.62041    0  642 -6216.2745 3332.62041   154%     - 1529s
     0     0 3322.50716    0  645 -6216.2745 3322.50716   153%     - 1543s
H    0     0                    -6151.745958 3322.35015   154%     - 1548s
     0     0 3313.83223    0  562 -6151.7460 3313.83223   154%     - 1559s
     0     0 3310.21272    0  562 -6151.7460 3310.21272   154%     - 1566s
     0     0 3303.04158    0  495 -6151.7460 3303.04158   154%     - 1574s
     0     0 3291.81327    0  562 -6151.7460 3291.81327   154%     - 1586s
     0     0 3286.19226    0  560 -6151.7460 3286.19226   153%     - 1593s
     0     0 3281.84176    0  566 -6151.7460 3281.84176   153%     - 1600s
     0     0 3278.80404    0  572 -6151.7460 3278.80404   153%     - 1605s
     0     0 3276.89505    0  510 -6151.7460 3276.89505   153%     - 1608s
     0     0 3276.24171    0  515 -6151.7460 3276.24171   153%     - 1612s
     0     0 3260.90579    0  511 -6151.7460 3260.90579   153%     - 1623s
H    0     0                    -6132.835315 3260.58563   153%     - 1625s
     0     0 3254.55830    0  570 -6132.8353 3254.55830   153%     - 1633s
     0     0 3252.35635    0  515 -6132.8353 3252.35635   153%     - 1640s
     0     0 3250.36226    0  512 -6132.8353 3250.36226   153%     - 1647s
     0     0 3249.34759    0  514 -6132.8353 3249.34759   153%     - 1650s
     0     0 3240.59820    0  569 -6132.8353 3240.59820   153%     - 1661s
H    0     0                    -6076.548115 3239.22642   153%     - 1664s
H    0     0                    -6044.305099 3239.22642   154%     - 1664s
H    0     0                    -6030.860783 3239.22642   154%     - 1665s
H    0     0                    -6008.684455 3239.22642   154%     - 1666s
     0     0 3238.36578    0  565 -6008.6845 3238.36578   154%     - 1670s
     0     0 3236.35557    0  576 -6008.6845 3236.35557   154%     - 1677s
     0     0 3235.29505    0  577 -6008.6845 3235.29505   154%     - 1680s
     0     0 3230.42064    0  570 -6008.6845 3230.42064   154%     - 1690s
     0     0 3229.80520    0  514 -6008.6845 3229.80520   154%     - 1694s
     0     0 3215.19053    0  511 -6008.6845 3215.19053   154%     - 1712s
H    0     0                    -5980.760367 3215.18541   154%     - 1742s
H    0     0                    -5970.122244 3215.18541   154%     - 1744s
H    0     0                    -5967.316051 3215.18541   154%     - 1744s
H    0     0                    -5965.618557 3215.18541   154%     - 1745s
     0     0 3213.04371    0  505 -5965.6186 3213.04371   154%     - 1751s
     0     0 3211.51210    0  568 -5965.6186 3211.51210   154%     - 1765s
     0     0 3204.06074    0  511 -5965.6186 3204.06074   154%     - 1783s
     0     0 3202.40535    0  511 -5965.6186 3202.40535   154%     - 1799s
     0     0 3194.78804    0  513 -5965.6186 3194.78804   154%     - 1814s
     0     0 3194.71295    0  513 -5965.6186 3194.71295   154%     - 1826s
H    0     0                    -5947.260993 3194.71295   154%     - 1922s
H    0     0                    -5904.042723 3194.63954   154%     - 2177s
H    0     0                    -5893.404599 3194.63954   154%     - 2177s
     0     2 3194.63954    0  513 -5893.4046 3194.63954   154%     - 2182s
     1     3 2389.87865    1  454 -5893.4046 3194.63954   154% 17769 2232s
     2     4 2864.85355    1  492 -5893.4046 2864.85355   149% 15836 2257s
     3     5 1197.47904    2  437 -5893.4046 2864.50338   149% 14569 2288s
     4     9 2720.60859    2  475 -5893.4046 2861.44667   149% 14410 2334s
     8    17 2240.03835    3  464 -5893.4046 2720.51802   146% 12524 2395s
    16    34 1356.30652    4  552 -5893.4046 2720.51802   146% 15328 2444s
    33    47 1580.17660    5  579 -5893.4046 2058.22762   135% 20355 2592s
    48    70 1230.26506    6  490 -5893.4046 2058.22762   135% 21329 2691s
H   55    70                    -5759.452207 2058.22762   136% 20219 2691s
H   57    70                    -5750.625984 2058.22762   136% 19793 2691s
    75   187  918.48247    7  533 -5750.6260 2058.22762   136% 17488 2794s
   194   246  799.61998    8  514 -5750.6260 2058.22762   136% 10737 2848s
H  200   246                    -5741.899508 2058.22762   136% 10564 2849s
H  246   246                    -5716.349742 2058.22762   136%  9496 2849s
   268   282  -63.60738   11  525 -5716.3497 2058.22762   136%  9002 2896s
   330   318 -211.96661   12  365 -5716.3497 2058.22762   136%  8018 2943s
   398   329 -446.81549   13  366 -5716.3497 2058.22762   136%  7371 2988s
   447   333 -5620.6590   15  211 -5716.3497 2058.22762   136%  7040 3034s
   474   343     cutoff   16      -5716.3497 2058.22762   136%  6995 3077s
   506   355 -3913.3658   14  214 -5716.3497 2058.22762   136%  6948 3118s
   532   379 -4689.9150   15  151 -5716.3497 2058.22762   136%  6905 3156s
   568   391 -4863.5523   16  143 -5716.3497 2058.22762   136%  6748 3202s
H  597   391                    -5691.526705 2058.22762   136%  6683 3202s
   603   411 -4915.9533   17  138 -5691.5267 2058.22762   136%  6671 3243s
   701   423 -4887.3305   17  147 -5691.5267 2058.22762   136%  6119 3284s
   790   412 infeasible   18      -5691.5267 2058.22762   136%  5726 3327s
   853   406 -595.75594   10  544 -5691.5267 2058.22762   136%  5546 3371s
   890   411 infeasible   25      -5691.5267 2058.22762   136%  5496 3419s
   917   417 -3839.5286   14  232 -5691.5267 2058.22762   136%  5490 3468s
   935   432 -3929.3549   15  228 -5691.5267 2058.22762   136%  5498 3518s
   958   447 -4524.9404   16  196 -5691.5267 2058.22762   136%  5548 3568s
   989   446 infeasible   17      -5691.5267 2058.22762   136%  5632 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 154
  MIR: 2992
  Flow cover: 3586
  Zero half: 3
  RLT: 41
  Relax-and-lift: 355

Explored 1012 nodes (6535709 simplex iterations) in 3600.11 seconds (4930.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5691.53 -5716.35 -5741.9 ... -5967.32

Time limit reached
Best objective -5.691526705351e+03, best bound 2.058227624623e+03, gap 136.1630%
  WARNING: Time limit reached. Using best solution found (gap: 136.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -5691.53, θ = 120230.98
  Upper Bound (UB) = -5691.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120230.98
  [DEBUG]   ✓ Scenario 0: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120230.98 ≤ Q = 120230.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 120230.98 ≤ Q = 120230.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d004320
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2ffbce0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6452945.5585
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.441511e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144151.06    0  124 6452945.56 -144151.06   102%     -    0s
H    0     0                    -110306.3406 -144151.06  30.7%     -    0s
H    0     0                    -111423.5358 -144151.06  29.4%     -    0s
     0     0 -120105.01    0  130 -111423.54 -120105.01  7.79%     -    0s
H    0     0                    -114481.6540 -119953.91  4.78%     -    0s
     0     0 -118542.55    0  129 -114481.65 -118542.55  3.55%     -    0s
H    0     0                    -114925.6455 -118514.30  3.12%     -    0s
H    0     0                    -114994.6591 -117711.73  2.36%     -    0s
     0     0 -117711.73    0  131 -114994.66 -117711.73  2.36%     -    0s
     0     0 -117678.56    0  135 -114994.66 -117678.56  2.33%     -    0s
     0     0 -117676.43    0  135 -114994.66 -117676.43  2.33%     -    0s
     0     0 -117379.36    0  129 -114994.66 -117379.36  2.07%     -    0s
     0     0 -117362.61    0  123 -114994.66 -117362.61  2.06%     -    0s
     0     0 -117017.31    0  134 -114994.66 -117017.31  1.76%     -    0s
     0     0 -116997.98    0  129 -114994.66 -116997.98  1.74%     -    0s
     0     0 -116755.82    0  128 -114994.66 -116755.82  1.53%     -    0s
     0     0 -116742.22    0  128 -114994.66 -116742.22  1.52%     -    0s
     0     2 -116742.22    0  128 -114994.66 -116742.22  1.52%     -    0s
H   31    58                    -115041.7093 -116373.99  1.16%  24.5    0s
H   59    58                    -115059.1845 -116305.96  1.08%  24.8    0s
H 1009   756                    -115128.5394 -116092.91  0.84%   9.1    0s
* 3220  2039              32    -115171.2548 -115875.86  0.61%   7.3    0s
* 3223  2039              30    -115175.2046 -115875.86  0.61%   7.3    0s
H 4035  2543                    -115215.2272 -115839.91  0.54%   7.0    0s
H 4059  2288                    -115274.9160 -115839.91  0.49%   7.0    0s
H 4397  2220                    -115291.3299 -115826.25  0.46%   7.0    0s
H 4860  1897                    -115334.2473 -115812.37  0.41%   7.0    0s
H 4881  1754                    -115347.1573 -115347.16  0.00%   6.9    0s

Cutting planes:
  Gomory: 118
  Implied bound: 3
  Projected implied bound: 3
  MIR: 101
  Flow cover: 73
  RLT: 14
  BQP: 4

Explored 4881 nodes (35977 simplex iterations) in 0.87 seconds (0.52 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115347 -115334 -115291 ... -115042
No other solutions better than -115347

Optimal solution found (tolerance 1.00e-06)
Best objective -1.153471572662e+05, best bound -1.153471572662e+05, gap 0.0000%
  Subproblem solved in 0.92s
  Worst-case operational profit (Z_SP) = 117805.11
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115347.16
  [DEBUG]   S×d_nominal = 233152.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233152.27 + -115347.16 = 117805.11
  [DEBUG]   Current θ from Master = 120230.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2425.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8117.39
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 2425.8628, Absolute Gap = 2425.8628, Relative Gap = 0.426224
  Not converged yet (gap = 2425.86 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x2890a496
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns (presolve time = 5s)...
Presolve removed 134330 rows and 54530 columns
Presolve time: 5.63s
Presolved: 157563 rows, 66290 columns, 969224 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.63s

Barrier statistics:
 Dense cols : 651
 AA' NZ     : 8.456e+06
 Factor NZ  : 1.916e+07 (roughly 250 MB of memory)
 Factor Ops : 5.001e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79609094e+07  2.92364218e+08  1.02e+05 1.28e+01  7.82e+04     9s
   1  -1.37709613e+07  2.52471752e+08  7.15e+04 4.34e+01  5.45e+04     9s
   2  -4.70796754e+06  1.94923863e+08  2.36e+04 1.49e+01  1.86e+04     9s
   3  -1.98926331e+06  1.72566292e+08  7.65e+03 8.49e+00  6.35e+03     9s
   4  -7.08679815e+05  1.06205347e+08  8.28e+02 1.21e+00  9.56e+02     9s
   5  -5.63484703e+05  5.91020117e+07  3.84e+02 4.91e-01  4.51e+02     9s
   6  -4.76000465e+05  4.49722207e+07  1.96e+02 3.35e-01  2.76e+02    10s
   7  -4.20432204e+05  3.37800777e+07  9.51e+01 2.15e-01  1.71e+02    10s
   8  -3.55073363e+05  2.60863136e+07  4.84e+01 9.33e-02  1.16e+02    10s
   9  -2.29979955e+05  1.73327163e+07  1.86e+01 9.60e-03  6.84e+01    10s
  10  -1.60953748e+05  1.14934379e+07  9.00e+00 6.13e-03  4.31e+01    10s
  11  -1.37473425e+05  7.96184085e+06  6.32e+00 4.16e-03  2.95e+01    10s
  12  -1.15770441e+05  4.96515469e+06  3.68e+00 2.50e-03  1.82e+01    10s
  13  -9.27983870e+04  3.60225591e+06  1.79e+00 1.81e-03  1.30e+01    10s
  14  -7.11666064e+04  1.85536868e+06  5.31e-01 9.20e-04  6.74e+00    11s
  15  -5.60447236e+04  5.90036388e+05  2.30e-01 2.71e-04  2.25e+00    11s
  16  -2.88540891e+04  1.80222657e+05  7.39e-02 2.38e-04  7.29e-01    11s
  17  -2.14904216e+04  1.16856476e+05  5.74e-02 5.73e-04  4.82e-01    11s
  18  -1.67426235e+04  8.92403794e+04  4.85e-02 1.34e-03  3.69e-01    11s
  19  -1.37984021e+04  7.81493479e+04  4.32e-02 1.25e-03  3.20e-01    11s
  20  -1.06903671e+04  5.83126015e+04  3.74e-02 1.29e-03  2.40e-01    11s
  21  -8.25737132e+03  4.36254030e+04  3.34e-02 2.03e-03  1.81e-01    12s
  22  -4.52899005e+03  3.48865081e+04  2.74e-02 1.42e-03  1.37e-01    12s
  23  -2.43883482e+03  3.22936012e+04  2.43e-02 1.23e-03  1.21e-01    12s
  24  -7.48307015e+02  2.92148697e+04  2.18e-02 1.01e-03  1.04e-01    12s
  25   1.59433180e+03  2.73824301e+04  1.84e-02 8.77e-04  8.99e-02    12s
  26   2.71616382e+03  2.34358860e+04  1.67e-02 5.88e-04  7.22e-02    12s
  27   4.28175346e+03  2.18758561e+04  1.46e-02 4.73e-04  6.14e-02    13s
  28   5.23232207e+03  2.07162680e+04  1.34e-02 3.76e-04  5.40e-02    13s
  29   7.98551768e+03  1.92846050e+04  9.76e-03 2.64e-04  3.94e-02    13s
  30   9.31966348e+03  1.84182868e+04  7.97e-03 1.61e-04  3.17e-02    13s
  31   1.04250315e+04  1.75577006e+04  6.50e-03 1.10e-04  2.49e-02    13s
  32   1.09049498e+04  1.69177881e+04  5.87e-03 7.74e-05  2.10e-02    14s
  33   1.17715208e+04  1.65047998e+04  4.73e-03 6.34e-05  1.65e-02    14s
  34   1.26213588e+04  1.62176536e+04  3.55e-03 1.21e-04  1.25e-02    14s
  35   1.27667052e+04  1.59472611e+04  3.36e-03 1.88e-04  1.11e-02    14s
  36   1.32880705e+04  1.58618418e+04  2.73e-03 1.51e-04  8.98e-03    14s
  37   1.38173388e+04  1.57457643e+04  2.04e-03 1.04e-04  6.73e-03    14s
  38   1.39142993e+04  1.56660967e+04  1.91e-03 8.62e-05  6.11e-03    15s
  39   1.41698920e+04  1.56393743e+04  1.59e-03 7.62e-05  5.13e-03    15s
  40   1.44276973e+04  1.55955727e+04  1.26e-03 5.76e-05  4.07e-03    15s
  41   1.45595779e+04  1.55929439e+04  1.10e-03 5.65e-05  3.60e-03    15s
  42   1.47889960e+04  1.55452609e+04  8.04e-04 3.92e-05  2.64e-03    15s
  43   1.48706123e+04  1.55229270e+04  7.01e-04 2.96e-05  2.28e-03    16s
  44   1.49863029e+04  1.54935407e+04  5.57e-04 2.04e-05  1.77e-03    16s
  45   1.50309826e+04  1.54857672e+04  5.02e-04 1.75e-05  1.59e-03    16s
  46   1.50439487e+04  1.54790233e+04  4.86e-04 1.51e-05  1.52e-03    16s
  47   1.51012801e+04  1.54721683e+04  4.12e-04 1.27e-05  1.29e-03    16s
  48   1.51104327e+04  1.54705019e+04  4.00e-04 1.21e-05  1.26e-03    17s
  49   1.51418503e+04  1.54687541e+04  3.64e-04 1.15e-05  1.14e-03    17s
  50   1.51608191e+04  1.54677916e+04  3.41e-04 1.11e-05  1.07e-03    17s
  51   1.52009100e+04  1.54631531e+04  2.90e-04 9.07e-06  9.15e-04    17s
  52   1.52174410e+04  1.54549249e+04  2.68e-04 6.50e-06  8.29e-04    17s
  53   1.52351546e+04  1.54528743e+04  2.46e-04 5.88e-06  7.60e-04    18s
  54   1.52493169e+04  1.54517652e+04  2.28e-04 5.55e-06  7.06e-04    18s
  55   1.52624696e+04  1.54496066e+04  2.10e-04 4.87e-06  6.53e-04    18s
  56   1.52686455e+04  1.54461515e+04  2.02e-04 3.77e-06  6.19e-04    18s
  57   1.52764887e+04  1.54401799e+04  1.93e-04 6.17e-06  5.71e-04    18s
  58   1.53496097e+04  1.54393135e+04  1.01e-04 7.59e-06  3.13e-04    19s
  59   1.53850793e+04  1.54363099e+04  5.68e-05 4.29e-06  1.79e-04    19s
  60   1.53999222e+04  1.54358274e+04  4.03e-05 3.19e-06  1.25e-04    19s
  61   1.54025014e+04  1.54351059e+04  3.70e-05 2.27e-06  1.14e-04    19s
  62   1.54090264e+04  1.54338095e+04  2.89e-05 3.80e-07  8.65e-05    19s
  63   1.54132665e+04  1.54336424e+04  2.38e-05 2.60e-07  7.11e-05    19s
  64   1.54196721e+04  1.54335333e+04  1.58e-05 2.19e-07  4.84e-05    20s
  65   1.54237786e+04  1.54333677e+04  1.06e-05 1.53e-07  3.35e-05    20s
  66   1.54264992e+04  1.54333055e+04  7.39e-06 6.88e-08  2.37e-05    20s
  67   1.54317114e+04  1.54332669e+04  1.51e-06 4.52e-08  5.43e-06    20s
  68   1.54327962e+04  1.54330710e+04  2.84e-07 1.46e-08  9.59e-07    20s
  69   1.54330216e+04  1.54330544e+04  1.03e-07 1.82e-07  1.15e-07    21s
  70   1.54330237e+04  1.54330544e+04  4.28e-06 1.72e-07  1.08e-07    21s
  71   1.54330257e+04  1.54330544e+04  3.99e-06 1.59e-07  1.01e-07    21s
  72   1.54330425e+04  1.54330541e+04  1.63e-06 6.73e-10  4.07e-08    21s
  73   1.54330481e+04  1.54330541e+04  8.42e-07 7.16e-07  2.10e-08    21s
  74   1.54330509e+04  1.54330541e+04  7.24e-07 4.90e-07  1.14e-08    21s
  75   1.54330516e+04  1.54330541e+04  2.80e-06 3.14e-07  8.99e-09    22s
  76   1.54330539e+04  1.54330541e+04  2.33e-07 4.36e-09  7.76e-10    22s
  77   1.54330541e+04  1.54330541e+04  1.46e-08 3.89e-10  1.71e-11    22s

Barrier solved model in 77 iterations and 21.87 seconds (22.70 work units)
Optimal objective 1.54330541e+04


Root crossover log...

  139530 DPushes remaining with DInf 0.0000000e+00                22s
   23714 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

    3289 PPushes remaining with PInf 8.2310312e-06                29s
       0 PPushes remaining with PInf 0.0000000e+00                30s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.5260488e-01     30s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66949    1.5433054e+04   0.000000e+00   9.526049e-01     30s
   66952    1.5433054e+04   0.000000e+00   0.000000e+00     30s
   66952    1.5433054e+04   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 6.40s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 66952 iterations, 29.53 seconds (31.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   37s
H    0     0                    -63927.45109 15433.0541   124%     -   38s
H    0     0                    -55938.09483 15433.0541   128%     -   38s
H    0     0                    -28732.52428 15433.0541   154%     -   38s
H    0     0                    -27831.51073 15433.0541   155%     -   39s
H    0     0                    -27742.18136 15433.0541   156%     -   39s
H    0     0                    -27728.73705 15433.0541   156%     -   39s
H    0     0                    -27717.59798 15433.0541   156%     -   39s
H    0     0                    -27672.61108 15433.0541   156%     -   39s
H    0     0                    -27665.80036 15433.0541   156%     -   39s
H    0     0                    -27665.32730 15433.0541   156%     -   39s
     0     0 11761.5288    0  359 -27665.327 11761.5288   143%     -  155s
H    0     0                    -26789.35796 11761.3188   144%     -  157s
H    0     0                    -26622.37987 11761.3188   144%     -  157s
     0     0 11531.8039    0  401 -26622.380 11531.8039   143%     -  224s
     0     0 11357.2373    0  404 -26622.380 11357.2373   143%     -  259s
     0     0 11336.0860    0  412 -26622.380 11336.0860   143%     -  275s
     0     0 11018.3869    0  409 -26622.380 11018.3869   141%     -  303s
     0     0 11013.3526    0  407 -26622.380 11013.3526   141%     -  307s
     0     0 11013.3437    0  407 -26622.380 11013.3437   141%     -  308s
     0     0 8233.68960    0  479 -26622.380 8233.68960   131%     -  430s
H    0     0                    -14467.71647 8233.67564   157%     -  431s
H    0     0                    -14446.29960 8233.67564   157%     -  431s
     0     0 7874.26856    0  489 -14446.300 7874.26856   155%     -  478s
     0     0 7738.46822    0  488 -14446.300 7738.46822   154%     -  519s
     0     0 7720.24751    0  493 -14446.300 7720.24751   153%     -  536s
     0     0 7713.54112    0  487 -14446.300 7713.54112   153%     -  548s
     0     0 7698.48657    0  497 -14446.300 7698.48657   153%     -  562s
     0     0 7614.20497    0  476 -14446.300 7614.20497   153%     -  602s
     0     0 7515.50332    0  483 -14446.300 7515.50332   152%     -  625s
     0     0 7506.09905    0  491 -14446.300 7506.09905   152%     -  637s
     0     0 7467.26925    0  499 -14446.300 7467.26925   152%     -  653s
     0     0 7460.86677    0  499 -14446.300 7460.86677   152%     -  659s
     0     0 7460.54453    0  495 -14446.300 7460.54453   152%     -  661s
     0     0 5915.05275    0  440 -14446.300 5915.05275   141%     -  794s
H    0     0                    -14236.74618 5914.91341   142%     -  795s
H    0     0                    -14209.55721 5914.91341   142%     -  795s
H    0     0                    -14194.33968 5914.91341   142%     -  795s
H    0     0                    -14100.83712 5914.91341   142%     -  795s
H    0     0                    -14094.67330 5914.91341   142%     -  795s
     0     0 5590.54195    0  451 -14094.673 5590.54195   140%     -  858s
     0     0 5461.60693    0  440 -14094.673 5461.60693   139%     -  891s
     0     0 5341.43522    0  443 -14094.673 5341.43522   138%     -  923s
     0     0 5158.53940    0  531 -14094.673 5158.53940   137%     -  951s
     0     0 5094.70896    0  548 -14094.673 5094.70896   136%     -  970s
     0     0 5061.61581    0  535 -14094.673 5061.61581   136%     -  989s
     0     0 5049.81571    0  555 -14094.673 5049.81571   136%     - 1000s
     0     0 5047.76682    0  554 -14094.673 5047.76682   136%     - 1005s
     0     0 5036.55119    0  557 -14094.673 5036.55119   136%     - 1014s
     0     0 5033.23137    0  559 -14094.673 5033.23137   136%     - 1020s
     0     0 5027.61971    0  556 -14094.673 5027.61971   136%     - 1024s
     0     0 5013.68237    0  554 -14094.673 5013.68237   136%     - 1031s
     0     0 5010.59976    0  554 -14094.673 5010.59976   136%     - 1036s
     0     0 5009.25692    0  552 -14094.673 5009.25692   136%     - 1040s
     0     0 5007.94526    0  559 -14094.673 5007.94526   136%     - 1044s
     0     0 5003.46134    0  551 -14094.673 5003.46134   135%     - 1049s
     0     0 5000.27950    0  555 -14094.673 5000.27950   135%     - 1055s
     0     0 4992.68112    0  552 -14094.673 4992.68112   135%     - 1061s
     0     0 4991.98861    0  554 -14094.673 4991.98861   135%     - 1064s
     0     0 4308.36270    0  452 -14094.673 4308.36270   131%     - 1158s
H    0     0                    -14079.08050 4308.15248   131%     - 1159s
     0     0 4213.05664    0  456 -14079.080 4213.05664   130%     - 1190s
     0     0 4197.50697    0  463 -14079.080 4197.50697   130%     - 1199s
     0     0 4194.46068    0  470 -14079.080 4194.46068   130%     - 1203s
     0     0 4190.13750    0  471 -14079.080 4190.13750   130%     - 1210s
     0     0 4127.08307    0  451 -14079.080 4127.08307   129%     - 1237s
     0     0 4115.14585    0  463 -14079.080 4115.14585   129%     - 1242s
     0     0 4111.88329    0  463 -14079.080 4111.88329   129%     - 1246s
     0     0 4105.52201    0  457 -14079.080 4105.52201   129%     - 1252s
     0     0 4100.47849    0  463 -14079.080 4100.47849   129%     - 1256s
     0     0 4095.14549    0  471 -14079.080 4095.14549   129%     - 1260s
     0     0 4087.86505    0  471 -14079.080 4087.86505   129%     - 1262s
     0     0 4041.81696    0  461 -14079.080 4041.81696   129%     - 1273s
     0     0 4038.32609    0  468 -14079.080 4038.32609   129%     - 1278s
     0     0 4036.58615    0  465 -14079.080 4036.58615   129%     - 1279s
     0     0 4007.93219    0  459 -14079.080 4007.93219   128%     - 1286s
     0     0 3999.02227    0  466 -14079.080 3999.02227   128%     - 1293s
     0     0 3996.27762    0  461 -14079.080 3996.27762   128%     - 1297s
     0     0 3995.60793    0  469 -14079.080 3995.60793   128%     - 1299s
     0     0 3830.95061    0  473 -14079.080 3830.95061   127%     - 1332s
H    0     0                    -14073.81155 3830.48612   127%     - 1334s
H    0     0                    -14027.09044 3830.48612   127%     - 1334s
     0     0 3785.17796    0  478 -14027.090 3785.17796   127%     - 1353s
     0     0 3773.48275    0  482 -14027.090 3773.48275   127%     - 1364s
     0     0 3764.99744    0  477 -14027.090 3764.99744   127%     - 1380s
     0     0 3762.78450    0  487 -14027.090 3762.78450   127%     - 1385s
     0     0 3760.96387    0  485 -14027.090 3760.96387   127%     - 1390s
     0     0 3759.88407    0  491 -14027.090 3759.88407   127%     - 1392s
     0     0 3594.30012    0  472 -14027.090 3594.30012   126%     - 1435s
H    0     0                    -13983.50913 3594.07632   126%     - 1442s
     0     0 3569.36913    0  482 -13983.509 3569.36913   126%     - 1460s
     0     0 3558.10369    0  480 -13983.509 3558.10369   125%     - 1471s
     0     0 3552.23260    0  481 -13983.509 3552.23260   125%     - 1476s
     0     0 3546.07099    0  485 -13983.509 3546.07099   125%     - 1484s
     0     0 3538.55555    0  563 -13983.509 3538.55555   125%     - 1500s
     0     0 3532.72148    0  483 -13983.509 3532.72148   125%     - 1511s
     0     0 3523.18287    0  488 -13983.509 3523.18287   125%     - 1522s
     0     0 3517.30182    0  483 -13983.509 3517.30182   125%     - 1533s
     0     0 3514.21413    0  496 -13983.509 3514.21413   125%     - 1544s
     0     0 3512.33473    0  500 -13983.509 3512.33473   125%     - 1553s
     0     0 3501.33483    0  486 -13983.509 3501.33483   125%     - 1566s
     0     0 3499.55344    0  492 -13983.509 3499.55344   125%     - 1577s
     0     0 3497.17274    0  491 -13983.509 3497.17274   125%     - 1586s
     0     0 3496.75388    0  493 -13983.509 3496.75388   125%     - 1589s
     0     0 3426.92828    0  570 -13983.509 3426.92828   125%     - 1623s
     0     0 3415.21095    0  495 -13983.509 3415.21095   124%     - 1640s
     0     0 3413.23171    0  504 -13983.509 3413.23171   124%     - 1646s
     0     0 3352.11526    0  487 -13983.509 3352.11526   124%     - 1666s
     0     0 3344.77792    0  500 -13983.509 3344.77792   124%     - 1676s
     0     0 3329.68936    0  491 -13983.509 3329.68936   124%     - 1694s
     0     0 3326.88487    0  485 -13983.509 3326.88487   124%     - 1701s
     0     0 3320.17794    0  482 -13983.509 3320.17794   124%     - 1708s
     0     0 3317.75733    0  491 -13983.509 3317.75733   124%     - 1715s
     0     0 3317.12479    0  486 -13983.509 3317.12479   124%     - 1718s
     0     0 3282.74352    0  486 -13983.509 3282.74352   123%     - 1745s
H    0     0                    -6557.275435 3282.59331   150%     - 1747s
H    0     0                    -6523.417750 3282.59331   150%     - 1747s
H    0     0                    -6455.103380 3282.59331   151%     - 1747s
H    0     0                    -6440.535891 3282.59331   151%     - 1748s
H    0     0                    -6414.964147 3282.59331   151%     - 1748s
H    0     0                    -6383.106985 3282.59331   151%     - 1748s
H    0     0                    -6372.221521 3282.59331   152%     - 1748s
     0     0 3266.08892    0  496 -6372.2215 3266.08892   151%     - 1764s
     0     0 3259.58261    0  497 -6372.2215 3259.58261   151%     - 1776s
     0     0 3254.98739    0  504 -6372.2215 3254.98739   151%     - 1784s
     0     0 3252.04860    0  493 -6372.2215 3252.04860   151%     - 1794s
     0     0 3250.89224    0  499 -6372.2215 3250.89224   151%     - 1800s
     0     0 3224.01751    0  538 -6372.2215 3224.01751   151%     - 1827s
     0     0 3215.14896    0  506 -6372.2215 3215.14896   150%     - 1844s
     0     0 3213.25764    0  551 -6372.2215 3213.25764   150%     - 1852s
     0     0 3211.97683    0  550 -6372.2215 3211.97683   150%     - 1858s
     0     0 3202.51756    0  515 -6372.2215 3202.51756   150%     - 1875s
     0     0 3196.93166    0  501 -6372.2215 3196.93166   150%     - 1888s
     0     0 3195.32565    0  518 -6372.2215 3195.32565   150%     - 1895s
     0     0 3187.24920    0  597 -6372.2215 3187.24920   150%     - 1913s
     0     0 3186.57622    0  516 -6372.2215 3186.57622   150%     - 1920s
     0     0 3172.65821    0  589 -6372.2215 3172.65821   150%     - 1942s
H    0     0                    -6361.847620 3172.03449   150%     - 1950s
     0     0 3164.50440    0  520 -6361.8476 3164.50440   150%     - 1971s
     0     0 3163.41889    0  514 -6361.8476 3163.41889   150%     - 1976s
     0     0 3158.67758    0  520 -6361.8476 3158.67758   150%     - 1993s
     0     0 3158.60874    0  520 -6361.8476 3158.60874   150%     - 2006s
H    0     0                    -6288.417874 3158.60874   150%     - 2122s
H    0     0                    -6195.463353 3158.60874   151%     - 2122s
H    0     0                    -6160.425356 3158.60874   151%     - 2122s
H    0     0                    -6104.376111 3158.60874   152%     - 2122s
H    0     0                    -6102.678617 3158.60874   152%     - 2122s
H    0     0                    -6059.443513 3158.60874   152%     - 2248s
H    0     0                    -6028.680999 3158.60874   152%     - 2248s
H    0     2                    -5983.657378 3158.60874   153%     - 2256s
     0     2 3158.60874    0  520 -5983.6574 3158.60874   153%     - 2256s
     1     3 2961.20789    1  471 -5983.6574 3158.60874   153% 12320 2289s
     2     4 3010.64964    1  505 -5983.6574 3010.64964   150% 13047 2323s
     3     5 2090.24128    2  379 -5983.6574 3010.50137   150% 11803 2354s
     4    10 1834.57306    3  434 -5983.6574 3010.50137   150% 11999 2382s
     9    19 1749.47500    4  436 -5983.6574 2877.42744   148% 10796 2452s
    18    27 2080.58754    4  482 -5983.6574 2877.42744   148% 13767 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 232
  MIR: 2612
  Flow cover: 2454
  Zero half: 5
  RLT: 30
  Relax-and-lift: 180

Explored 26 nodes (1273570 simplex iterations) in 3600.11 seconds (3885.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5983.66 -6028.68 -6059.44 ... -6372.22

Time limit reached
Best objective -5.983657378176e+03, best bound 2.533833803470e+03, gap 142.3459%
  WARNING: Time limit reached. Using best solution found (gap: 142.35%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -5983.66, θ = 119284.66
  Upper Bound (UB) = -5983.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119284.66
  [DEBUG]   ✓ Scenario 0: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 119284.66 ≤ Q = 119284.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 119284.66 ≤ Q = 119284.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xee29e37
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf11d61c9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.367899e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6394483.0204
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.448409e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144840.92    0  124 6394483.02 -144840.92   102%     -    0s
H    0     0                    -110909.0802 -144840.92  30.6%     -    0s
H    0     0                    -111868.7967 -144840.92  29.5%     -    0s
     0     0 -120583.77    0  128 -111868.80 -120583.77  7.79%     -    0s
H    0     0                    -114916.9142 -120537.93  4.89%     -    0s
     0     0 -119459.37    0   86 -114916.91 -119459.37  3.95%     -    0s
H    0     0                    -116427.3700 -119363.81  2.52%     -    0s
H    0     0                    -116980.7216 -119363.81  2.04%     -    0s
     0     0 -119139.28    0   77 -116980.72 -119139.28  1.85%     -    0s
     0     0 -119011.98    0   77 -116980.72 -119011.98  1.74%     -    0s
     0     0 -118690.28    0   68 -116980.72 -118690.28  1.46%     -    0s
     0     0 -118670.17    0   77 -116980.72 -118670.17  1.44%     -    0s
     0     0 -118354.03    0   81 -116980.72 -118354.03  1.17%     -    0s
     0     0 -118282.04    0   82 -116980.72 -118282.04  1.11%     -    0s
     0     0 -118155.99    0   80 -116980.72 -118155.99  1.00%     -    0s
     0     0 -118116.63    0   80 -116980.72 -118116.63  0.97%     -    0s
     0     2 -118116.63    0   80 -116980.72 -118116.63  0.97%     -    0s
H   42    33                    -116998.7098 -117800.27  0.69%  16.4    0s
H   48    33                    -117045.1107 -117800.27  0.65%  14.8    0s
H 1044   579                    -117052.0520 -117628.82  0.49%   5.3    0s
H 1086   579                    -117064.1174 -117519.22  0.39%   5.3    0s
H 1419   649                    -117090.2548 -117489.93  0.34%   5.0    0s
H 1923   915                    -117092.9681 -117351.19  0.22%   4.6    0s
H 2229   969                    -117134.1832 -117293.52  0.14%   4.5    0s

Cutting planes:
  Gomory: 62
  Implied bound: 6
  MIR: 222
  Flow cover: 1
  RLT: 6
  BQP: 2

Explored 4586 nodes (20197 simplex iterations) in 0.54 seconds (0.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117134 -117093 -117090 ... -114917
No other solutions better than -117134

Optimal solution found (tolerance 1.00e-06)
Best objective -1.171341831757e+05, best bound -1.171341831757e+05, gap 0.0000%
  Subproblem solved in 0.57s
  Worst-case operational profit (Z_SP) = 115624.28
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117134.18
  [DEBUG]   S×d_nominal = 232758.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232758.46 + -117134.18 = 115624.28
  [DEBUG]   Current θ from Master = 119284.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3660.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9644.04
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 2133.7321, Absolute Gap = 2133.7321, Relative Gap = 0.356593
  Not converged yet (gap = 2133.73 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x2dd18408
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns (presolve time = 5s)...
Presolve removed 141400 rows and 57400 columns
Presolve time: 6.24s
Presolved: 165783 rows, 69660 columns, 1019877 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -373815.4826
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.08s

Barrier statistics:
 Dense cols : 1124
 AA' NZ     : 4.076e+06
 Factor NZ  : 1.125e+07 (roughly 200 MB of memory)
 Factor Ops : 3.619e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80031914e+07  3.05967165e+08  1.02e+05 1.24e+01  7.79e+04    11s
   1  -1.38573795e+07  2.63955916e+08  7.20e+04 4.30e+01  5.45e+04    11s
   2  -5.31753021e+06  2.03697296e+08  2.69e+04 1.46e+01  2.10e+04    11s
   3  -3.68172615e+06  1.79661386e+08  1.80e+04 5.62e+00  1.40e+04    11s
   4  -8.79708419e+05  1.50821970e+08  1.83e+03 4.02e+00  1.84e+03    11s
   5  -5.85043365e+05  7.97277955e+07  5.44e+02 1.22e+00  6.24e+02    12s
   6  -5.31421327e+05  5.06419002e+07  3.81e+02 2.12e-01  4.00e+02    12s
   7  -4.48973022e+05  4.09199424e+07  1.85e+02 5.74e-02  2.44e+02    12s
   8  -3.38788343e+05  2.57550888e+07  4.97e+01 3.20e-02  1.11e+02    12s
   9  -1.93487506e+05  1.57435429e+07  4.37e+00 1.77e-02  5.44e+01    12s
  10  -1.41516929e+05  7.12626215e+06  2.23e+00 7.90e-03  2.45e+01    12s
  11  -1.17181133e+05  4.99550209e+06  1.25e+00 5.47e-03  1.71e+01    12s
  12  -9.25150272e+04  3.56968857e+06  5.43e-01 3.87e-03  1.22e+01    12s
  13  -8.14914117e+04  2.26343529e+06  3.32e-01 2.44e-03  7.78e+00    12s
  14  -5.92104283e+04  7.50175485e+05  7.82e-02 9.51e-04  2.68e+00    12s
  15  -4.51331701e+04  2.91916252e+05  4.06e-02 3.13e-04  1.12e+00    13s
  16  -2.90518637e+04  1.60513139e+05  2.48e-02 2.66e-04  6.28e-01    13s
  17  -2.12403178e+04  1.08712718e+05  1.98e-02 1.06e-03  4.30e-01    13s
  18  -1.65847912e+04  8.89854228e+04  1.70e-02 1.72e-03  3.50e-01    13s
  19  -1.45597796e+04  7.78549303e+04  1.57e-02 2.33e-03  3.06e-01    13s
  20  -8.77656727e+03  5.38064833e+04  1.20e-02 2.04e-03  2.07e-01    13s
  21  -6.62254366e+03  4.77140565e+04  1.07e-02 1.71e-03  1.80e-01    13s
  22  -2.69526650e+03  4.05973622e+04  8.50e-03 1.30e-03  1.43e-01    14s
  23  -5.04802589e+02  3.53947995e+04  7.29e-03 1.05e-03  1.19e-01    14s
  24   1.35157621e+03  3.19708994e+04  6.28e-03 8.81e-04  1.01e-01    14s
  25   4.10239585e+03  2.74542231e+04  4.90e-03 6.45e-04  7.73e-02    14s
  26   5.05615317e+03  2.34104189e+04  4.43e-03 4.33e-04  6.08e-02    14s
  27   6.67327757e+03  2.13451047e+04  3.71e-03 4.75e-04  4.86e-02    14s
  28   8.05768495e+03  1.98537375e+04  3.12e-03 3.42e-04  3.91e-02    14s
  29   1.00160329e+04  1.91516076e+04  2.29e-03 2.82e-04  3.03e-02    15s
  30   1.08895029e+04  1.87581527e+04  1.92e-03 2.50e-04  2.61e-02    15s
  31   1.15855616e+04  1.77405512e+04  1.62e-03 1.69e-04  2.04e-02    15s
  32   1.23900254e+04  1.73027129e+04  1.27e-03 1.33e-04  1.63e-02    15s
  33   1.30794880e+04  1.67671201e+04  9.59e-04 9.49e-05  1.22e-02    15s
  34   1.34482506e+04  1.64670243e+04  7.96e-04 7.31e-05  1.00e-02    15s
  35   1.38072556e+04  1.62341608e+04  6.41e-04 5.60e-05  8.04e-03    16s
  36   1.42504695e+04  1.60199313e+04  4.66e-04 3.96e-05  5.86e-03    16s
  37   1.44395780e+04  1.59372702e+04  3.91e-04 3.38e-05  4.96e-03    16s
  38   1.45763398e+04  1.57573883e+04  3.38e-04 2.09e-05  3.91e-03    16s
  39   1.47668271e+04  1.57472246e+04  2.66e-04 2.00e-05  3.25e-03    16s
  40   1.49058815e+04  1.56998934e+04  2.12e-04 1.65e-05  2.63e-03    17s
  41   1.50710226e+04  1.56529194e+04  1.48e-04 1.28e-05  1.93e-03    17s
  42   1.51434839e+04  1.56212685e+04  1.21e-04 1.05e-05  1.58e-03    17s
  43   1.52245733e+04  1.56077599e+04  9.02e-05 9.48e-06  1.27e-03    17s
  44   1.52622134e+04  1.55781198e+04  7.67e-05 7.42e-06  1.05e-03    17s
  45   1.52822884e+04  1.55727150e+04  6.95e-05 6.95e-06  9.62e-04    17s
  46   1.53006515e+04  1.55457559e+04  6.26e-05 5.05e-06  8.12e-04    18s
  47   1.53092029e+04  1.55413204e+04  5.91e-05 4.74e-06  7.69e-04    18s
  48   1.53356300e+04  1.55316950e+04  4.98e-05 4.03e-06  6.49e-04    18s
  49   1.53457632e+04  1.55212625e+04  4.62e-05 3.30e-06  5.81e-04    18s
  50   1.53730324e+04  1.55149704e+04  3.62e-05 2.87e-06  4.70e-04    18s
  51   1.53986620e+04  1.55098796e+04  2.68e-05 2.50e-06  3.68e-04    19s
  52   1.54112546e+04  1.54950338e+04  2.22e-05 1.40e-06  2.77e-04    19s
  53   1.54433613e+04  1.54918212e+04  1.06e-05 1.18e-06  1.60e-04    19s
  54   1.54632394e+04  1.54858229e+04  3.75e-06 7.32e-07  7.48e-05    19s
  55   1.54702071e+04  1.54780578e+04  1.51e-06 1.85e-07  2.60e-05    19s
  56   1.54746366e+04  1.54759527e+04  2.33e-07 1.37e-07  4.36e-06    19s
  57   1.54754377e+04  1.54754669e+04  6.54e-09 1.11e-10  9.66e-08    19s
  58   1.54754635e+04  1.54754635e+04  3.85e-10 2.79e-11  2.63e-12    20s

Barrier solved model in 58 iterations and 19.59 seconds (18.01 work units)
Optimal objective 1.54754635e+04


Root crossover log...

  146707 DPushes remaining with DInf 0.0000000e+00                20s
   72172 DPushes remaining with DInf 0.0000000e+00                21s
    7795 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    2431 PPushes remaining with PInf 3.6258253e-06                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9369264e-10     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69150    1.5475463e+04   0.000000e+00   0.000000e+00     28s
   69150    1.5475463e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 1.48s

Solved with barrier

Root relaxation: objective 1.547546e+04, 69150 iterations, 21.39 seconds (26.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15475.4635    0  185 -177247.82 15475.4635   109%     -   30s
H    0     0                    -85654.50186 15475.4635   118%     -   30s
H    0     0                    -78069.09140 15475.4635   120%     -   31s
H    0     0                    -31180.61037 15475.4635   150%     -   31s
H    0     0                    -22233.69664 15475.4635   170%     -   31s
H    0     0                    -21048.54829 15475.4635   174%     -   32s
H    0     0                    -20422.78224 15475.4635   176%     -   32s
     0     0 11702.8849    0  368 -20422.782 11702.8849   157%     -  187s
     0     0 11526.2810    0  413 -20422.782 11526.2810   156%     -  297s
     0     0 11499.9767    0  418 -20422.782 11499.9767   156%     -  341s
     0     0 11411.9373    0  418 -20422.782 11411.9373   156%     -  394s
     0     0 11096.9621    0  359 -20422.782 11096.9621   154%     -  483s
     0     0 11095.3874    0  358 -20422.782 11095.3874   154%     -  485s
     0     0 11095.3750    0  358 -20422.782 11095.3750   154%     -  486s
     0     0 8779.54305    0  367 -20422.782 8779.54305   143%     -  634s
H    0     0                    -11625.51459 8779.24016   176%     -  636s
H    0     0                    -11610.15479 8779.24016   176%     -  636s
H    0     0                    -11441.74779 8779.24016   177%     -  636s
H    0     0                    -11438.12937 8779.24016   177%     -  636s
     0     0 8184.00674    0  462 -11438.129 8184.00674   172%     -  714s
     0     0 8084.06849    0  372 -11438.129 8084.06849   171%     -  747s
     0     0 8060.00559    0  369 -11438.129 8060.00559   170%     -  759s
     0     0 8048.53920    0  372 -11438.129 8048.53920   170%     -  765s
     0     0 8036.51881    0  372 -11438.129 8036.51881   170%     -  776s
     0     0 8034.89704    0  367 -11438.129 8034.89704   170%     -  781s
     0     0 8033.74872    0  373 -11438.129 8033.74872   170%     -  784s
     0     0 8026.17886    0  371 -11438.129 8026.17886   170%     -  790s
     0     0 7984.21647    0  366 -11438.129 7984.21647   170%     -  802s
     0     0 7983.74712    0  362 -11438.129 7983.74712   170%     -  805s
     0     0 6114.88883    0  406 -11438.129 6114.88883   153%     -  946s
H    0     0                    -11341.06588 6114.39430   154%     -  948s
H    0     0                    -11327.20227 6114.39430   154%     -  948s
     0     0 5756.32152    0  505 -11327.202 5756.32152   151%     - 1029s
     0     0 5581.90238    0  510 -11327.202 5581.90238   149%     - 1070s
     0     0 5536.71962    0  519 -11327.202 5536.71962   149%     - 1096s
     0     0 5508.76108    0  525 -11327.202 5508.76108   149%     - 1107s
     0     0 5418.09334    0  436 -11327.202 5418.09334   148%     - 1135s
     0     0 5368.29987    0  444 -11327.202 5368.29987   147%     - 1148s
     0     0 5325.90761    0  440 -11327.202 5325.90761   147%     - 1164s
     0     0 5290.40977    0  443 -11327.202 5290.40977   147%     - 1182s
     0     0 5268.80840    0  440 -11327.202 5268.80840   147%     - 1196s
     0     0 5243.00786    0  430 -11327.202 5243.00786   146%     - 1211s
     0     0 5238.79373    0  441 -11327.202 5238.79373   146%     - 1216s
     0     0 5238.32242    0  530 -11327.202 5238.32242   146%     - 1220s
     0     0 4410.18016    0  447 -11327.202 4410.18016   139%     - 1285s
     0     0 4255.73989    0  542 -11327.202 4255.73989   138%     - 1335s
     0     0 4142.09343    0  447 -11327.202 4142.09343   137%     - 1356s
     0     0 4029.26892    0  459 -11327.202 4029.26892   136%     - 1379s
     0     0 3987.73636    0  466 -11327.202 3987.73636   135%     - 1395s
     0     0 3926.65571    0  473 -11327.202 3926.65571   135%     - 1418s
     0     0 3902.72238    0  470 -11327.202 3902.72238   134%     - 1430s
     0     0 3877.80066    0  477 -11327.202 3877.80066   134%     - 1443s
     0     0 3862.37664    0  469 -11327.202 3862.37664   134%     - 1457s
     0     0 3843.78717    0  558 -11327.202 3843.78717   134%     - 1468s
     0     0 3837.28629    0  467 -11327.202 3837.28629   134%     - 1474s
     0     0 3831.48193    0  468 -11327.202 3831.48193   134%     - 1478s
     0     0 3827.25770    0  469 -11327.202 3827.25770   134%     - 1483s
     0     0 3804.31073    0  476 -11327.202 3804.31073   134%     - 1490s
     0     0 3787.86429    0  471 -11327.202 3787.86429   133%     - 1500s
     0     0 3784.44106    0  472 -11327.202 3784.44106   133%     - 1504s
     0     0 3781.76990    0  476 -11327.202 3781.76990   133%     - 1507s
     0     0 3781.47018    0  478 -11327.202 3781.47018   133%     - 1508s
     0     0 3662.21932    0  546 -11327.202 3662.21932   132%     - 1540s
H    0     0                    -11323.78528 3661.60106   132%     - 1542s
     0     0 3629.53964    0  566 -11323.785 3629.53964   132%     - 1567s
     0     0 3578.04148    0  569 -11323.785 3578.04148   132%     - 1587s
     0     0 3537.41113    0  473 -11323.785 3537.41113   131%     - 1608s
     0     0 3531.56702    0  565 -11323.785 3531.56702   131%     - 1621s
     0     0 3526.97621    0  569 -11323.785 3526.97621   131%     - 1630s
     0     0 3519.44248    0  558 -11323.785 3519.44248   131%     - 1638s
     0     0 3516.47092    0  556 -11323.785 3516.47092   131%     - 1644s
     0     0 3516.25492    0  558 -11323.785 3516.25492   131%     - 1646s
     0     0 3422.65588    0  485 -11323.785 3422.65588   130%     - 1681s
H    0     0                    -11318.60474 3422.40033   130%     - 1689s
H    0     0                    -11293.95031 3422.40033   130%     - 1689s
     0     0 3408.73868    0  489 -11293.950 3408.73868   130%     - 1702s
     0     0 3404.57457    0  482 -11293.950 3404.57457   130%     - 1710s
     0     0 3399.82917    0  496 -11293.950 3399.82917   130%     - 1718s
     0     0 3398.87447    0  487 -11293.950 3398.87447   130%     - 1722s
     0     0 3368.15351    0  621 -11293.950 3368.15351   130%     - 1754s
     0     0 3363.21412    0  488 -11293.950 3363.21412   130%     - 1767s
     0     0 3352.26669    0  610 -11293.950 3352.26669   130%     - 1778s
     0     0 3347.20363    0  487 -11293.950 3347.20363   130%     - 1785s
     0     0 3339.89833    0  494 -11293.950 3339.89833   130%     - 1795s
     0     0 3337.57619    0  496 -11293.950 3337.57619   130%     - 1800s
     0     0 3336.60093    0  497 -11293.950 3336.60093   130%     - 1804s
     0     0 3325.89699    0  507 -11293.950 3325.89699   129%     - 1828s
     0     0 3316.13231    0  546 -11293.950 3316.13231   129%     - 1843s
     0     0 3310.59927    0  556 -11293.950 3310.59927   129%     - 1856s
     0     0 3309.69425    0  561 -11293.950 3309.69425   129%     - 1861s
     0     0 3291.54381    0  555 -11293.950 3291.54381   129%     - 1895s
     0     0 3283.63110    0  549 -11293.950 3283.63110   129%     - 1913s
     0     0 3281.30559    0  485 -11293.950 3281.30559   129%     - 1918s
     0     0 3280.88903    0  505 -11293.950 3280.88903   129%     - 1923s
     0     0 3261.93597    0  509 -11293.950 3261.93597   129%     - 1942s
     0     0 3251.87149    0  605 -11293.950 3251.87149   129%     - 1962s
     0     0 3248.35671    0  514 -11293.950 3248.35671   129%     - 1969s
     0     0 3247.90716    0  515 -11293.950 3247.90716   129%     - 1970s
     0     0 3230.87919    0  509 -11293.950 3230.87919   129%     - 1986s
     0     0 3225.53001    0  511 -11293.950 3225.53001   129%     - 1996s
     0     0 3224.21824    0  512 -11293.950 3224.21824   129%     - 2001s
     0     0 3215.77239    0  520 -11293.950 3215.77239   128%     - 2016s
     0     0 3212.49026    0  517 -11293.950 3212.49026   128%     - 2026s
     0     0 3211.89563    0  518 -11293.950 3211.89563   128%     - 2035s
     0     0 3208.39041    0  525 -11293.950 3208.39041   128%     - 2047s
     0     0 3207.02482    0  516 -11293.950 3207.02482   128%     - 2053s
     0     0 3197.76172    0  516 -11293.950 3197.76172   128%     - 2069s
     0     0 3197.53867    0  516 -11293.950 3197.53867   128%     - 2081s
H    0     0                    -7235.455650 3197.37393   144%     - 2508s
H    0     0                    -7161.730696 3197.37393   145%     - 2517s
H    0     0                    -7035.841946 3197.37393   145%     - 2517s
H    0     0                    -6943.827751 3197.37393   146%     - 2517s
H    0     0                    -6894.263459 3197.37393   146%     - 2517s
H    0     0                    -6878.670660 3197.37393   146%     - 2524s
H    0     2                    -6582.893398 3197.37393   149%     - 2896s
     0     2 3197.37393    0  516 -6582.8934 3197.37393   149%     - 2896s
     1     4 3140.22428    1  500 -6582.8934 3197.37393   149%  7245 2926s
     3     8 3029.22292    2  538 -6582.8934 3139.98775   148% 11587 3022s
     7    16 2672.78324    3  595 -6582.8934 3029.20060   146% 18586 3096s
    15    31 2274.09970    4  567 -6582.8934 2672.71058   141% 18001 3179s
    30    46 -1899.7268    5  237 -6582.8934 2546.15303   139% 28070 3375s
    45    76 1364.55854    6  478 -6582.8934 2494.63644   138% 23977 3600s
H   51    76                    -6251.443098 2494.63644   140% 22740 3600s
H   67    76                    -6161.126570 2494.63644   140% 20914 3600s

Cutting planes:
  Learned: 2
  Gomory: 9
  Implied bound: 187
  MIR: 2825
  Flow cover: 2950
  Zero half: 3
  RLT: 36
  Relax-and-lift: 220

Explored 75 nodes (2404244 simplex iterations) in 3600.16 seconds (4933.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -6161.13 -6251.44 -6582.89 ... -11294

Time limit reached
Best objective -6.161126570256e+03, best bound 2.494636440634e+03, gap 140.4899%
  WARNING: Time limit reached. Using best solution found (gap: 140.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = -6161.13, θ = 120894.38
  Upper Bound (UB) = -6161.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120894.38
  [DEBUG]   ✓ Scenario 0: θ = 120894.38 ≤ Q = 120894.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120894.38 ≤ Q = 120894.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120894.38 ≤ Q = 120894.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120894.38 ≤ Q = 120894.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 120894.38 ≤ Q = 120894.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 120894.38 ≤ Q = 120894.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x61879b86
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x61879b86
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368163e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6440876.3922
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.447503e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144750.27    0  124 6440876.39 -144750.27   102%     -    0s
H    0     0                    -110703.6676 -144750.27  30.8%     -    0s
H    0     0                    -111825.4248 -144750.27  29.4%     -    0s
     0     0 -122290.74    0   85 -111825.42 -122290.74  9.36%     -    0s
H    0     0                    -117265.7695 -122144.34  4.16%     -    0s
H    0     0                    -117819.1210 -122144.34  3.67%     -    0s
H    0     0                    -118293.6721 -122144.34  3.26%     -    0s
H    0     0                    -118847.0237 -122144.34  2.77%     -    0s
     0     0 -121237.46    0   87 -118847.02 -121237.46  2.01%     -    0s
H    0     0                    -118966.3192 -120390.68  1.20%     -    0s
     0     0 -120390.68    0   65 -118966.32 -120390.68  1.20%     -    0s
     0     0 -120248.87    0   69 -118966.32 -120248.87  1.08%     -    0s
     0     0 -120234.73    0   69 -118966.32 -120234.73  1.07%     -    0s
     0     0 -119936.99    0   52 -118966.32 -119936.99  0.82%     -    0s
H    0     0                    -118987.2630 -119891.03  0.76%     -    0s
     0     0 -119875.82    0   51 -118987.26 -119875.82  0.75%     -    0s
     0     0 -119680.87    0   40 -118987.26 -119680.87  0.58%     -    0s
     0     0 -119651.31    0   65 -118987.26 -119651.31  0.56%     -    0s
     0     0 -119650.20    0   65 -118987.26 -119650.20  0.56%     -    0s
     0     0 -119566.09    0   48 -118987.26 -119566.09  0.49%     -    0s
     0     0 -119539.02    0   48 -118987.26 -119539.02  0.46%     -    0s
H    0     2                    -119030.3473 -119539.02  0.43%     -    0s
     0     2 -119539.02    0   48 -119030.35 -119539.02  0.43%     -    0s
H  257   267                    -119030.7915 -119300.18  0.23%   6.6    0s
H  430   362                    -119036.6365 -119251.47  0.18%   5.4    0s
H  435   362                    -119051.9968 -119251.47  0.17%   5.4    0s
H  445   362                    -119052.6703 -119251.47  0.17%   5.4    0s
H  470   362                    -119076.1609 -119251.47  0.15%   5.3    0s
H  583   362                    -119085.4656 -119251.47  0.14%   5.1    0s
H  584   362                    -119094.3637 -119251.47  0.13%   5.1    0s
H  585   362                    -119097.1047 -119251.47  0.13%   5.1    0s
H  601   362                    -119105.6033 -119251.47  0.12%   5.0    0s

Cutting planes:
  Gomory: 14
  Implied bound: 8
  MIR: 158
  Flow cover: 5
  RLT: 39
  Relax-and-lift: 1
  BQP: 2

Explored 1444 nodes (7996 simplex iterations) in 0.27 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -119106 -119097 -119094 ... -119030
No other solutions better than -119106

Optimal solution found (tolerance 1.00e-06)
Best objective -1.191056033298e+05, best bound -1.191056033298e+05, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 115181.04
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119105.60
  [DEBUG]   S×d_nominal = 234286.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234286.64 + -119105.60 = 115181.04
  [DEBUG]   Current θ from Master = 120894.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5713.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11874.47
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 1956.2629, Absolute Gap = 1956.2629, Relative Gap = 0.317517
  Not converged yet (gap = 1956.26 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0x41eb402d
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns (presolve time = 5s)...
Presolve removed 148470 rows and 60270 columns
Presolve time: 6.43s
Presolved: 174003 rows, 73030 columns, 1070397 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.93s

Barrier statistics:
 Dense cols : 1123
 AA' NZ     : 4.419e+06
 Factor NZ  : 1.224e+07 (roughly 200 MB of memory)
 Factor Ops : 4.088e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80013412e+07  3.18716645e+08  1.02e+05 1.22e+01  7.75e+04    11s
   1  -1.39109651e+07  2.74731983e+08  7.23e+04 4.26e+01  5.45e+04    11s
   2  -5.90082230e+06  2.11635400e+08  3.00e+04 1.37e+01  2.32e+04    11s
   3  -3.11790352e+06  1.87689256e+08  1.47e+04 3.84e+00  1.15e+04    11s
   4  -7.66235567e+05  1.31566644e+08  1.33e+03 1.72e+00  1.36e+03    11s
   5  -6.52437861e+05  9.25490142e+07  8.27e+02 6.42e-01  8.44e+02    12s
   6  -5.14975135e+05  5.36856099e+07  3.51e+02 7.59e-02  3.87e+02    12s
   7  -4.46969806e+05  4.38081189e+07  1.74e+02 5.82e-02  2.42e+02    12s
   8  -3.61118813e+05  2.82864178e+07  4.93e+01 3.36e-02  1.16e+02    12s
   9  -2.15613906e+05  1.74819976e+07  5.67e+00 1.89e-02  5.81e+01    12s
  10  -1.50997881e+05  9.37159877e+06  3.30e+00 9.85e-03  3.08e+01    12s
  11  -1.38026396e+05  7.33053165e+06  2.61e+00 7.61e-03  2.40e+01    12s
  12  -1.10176570e+05  6.74314439e+06  1.16e+00 6.95e-03  2.18e+01    12s
  13  -9.30576826e+04  5.26747847e+06  4.93e-01 5.39e-03  1.70e+01    13s
  14  -7.94284883e+04  1.83682869e+06  2.12e-01 1.91e-03  6.06e+00    13s
  15  -5.69985326e+04  4.77022869e+05  7.74e-02 4.66e-04  1.69e+00    13s
  16  -3.09851428e+04  2.06581799e+05  2.96e-02 2.53e-04  7.50e-01    13s
  17  -2.33602027e+04  1.38305483e+05  2.35e-02 5.06e-04  5.10e-01    13s
  18  -1.94828524e+04  1.07574739e+05  2.07e-02 1.36e-03  4.01e-01    13s
  19  -1.44521688e+04  8.88989243e+04  1.72e-02 1.40e-03  3.26e-01    13s
  20  -8.67510354e+03  5.64551963e+04  1.31e-02 1.95e-03  2.06e-01    13s
  21  -6.17895709e+03  4.88173115e+04  1.14e-02 1.60e-03  1.74e-01    14s
  22  -3.35581686e+03  4.12990156e+04  9.61e-03 1.27e-03  1.41e-01    14s
  23  -4.10001324e+02  3.51866066e+04  7.83e-03 9.80e-04  1.12e-01    14s
  24   1.76099936e+03  3.17446759e+04  6.55e-03 8.17e-04  9.46e-02    14s
  25   3.80267317e+03  2.64921282e+04  5.45e-03 5.62e-04  7.16e-02    14s
  26   5.83128474e+03  2.42946812e+04  4.41e-03 4.52e-04  5.83e-02    14s
  27   8.16394782e+03  2.15439431e+04  3.27e-03 3.09e-04  4.22e-02    15s
  28   9.90980956e+03  1.97734467e+04  2.45e-03 2.23e-04  3.11e-02    15s
  29   1.07843733e+04  1.87062621e+04  2.05e-03 1.74e-04  2.50e-02    15s
  30   1.13846131e+04  1.74989333e+04  1.77e-03 1.02e-04  1.93e-02    15s
  31   1.22325890e+04  1.70202612e+04  1.37e-03 7.77e-05  1.51e-02    15s
  32   1.26079954e+04  1.62703616e+04  1.20e-03 9.30e-05  1.16e-02    16s
  33   1.28736937e+04  1.60047460e+04  1.08e-03 6.57e-05  9.88e-03    16s
  34   1.33028725e+04  1.58649422e+04  9.04e-04 4.48e-05  8.09e-03    16s
  35   1.38968111e+04  1.57258898e+04  6.46e-04 2.87e-05  5.77e-03    16s
  36   1.40385315e+04  1.56337658e+04  5.84e-04 1.98e-05  5.04e-03    16s
  37   1.42717349e+04  1.56117542e+04  4.88e-04 1.76e-05  4.23e-03    16s
  38   1.44989950e+04  1.55883468e+04  3.90e-04 1.50e-05  3.44e-03    17s
  39   1.45989295e+04  1.55824610e+04  3.47e-04 1.44e-05  3.10e-03    17s
  40   1.47917136e+04  1.55555864e+04  2.69e-04 1.42e-05  2.41e-03    17s
  41   1.48257975e+04  1.55520926e+04  2.55e-04 1.39e-05  2.29e-03    17s
  42   1.49235411e+04  1.55374758e+04  2.13e-04 1.19e-05  1.94e-03    17s
  43   1.50596510e+04  1.55158754e+04  1.58e-04 9.21e-06  1.44e-03    18s
  44   1.50989397e+04  1.55103982e+04  1.42e-04 8.47e-06  1.30e-03    18s
  45   1.51118397e+04  1.54976431e+04  1.36e-04 7.09e-06  1.22e-03    18s
  46   1.52237865e+04  1.54861868e+04  8.86e-05 5.87e-06  8.28e-04    18s
  47   1.52450016e+04  1.54814225e+04  7.95e-05 5.30e-06  7.46e-04    18s
  48   1.52544026e+04  1.54733928e+04  7.57e-05 4.33e-06  6.91e-04    19s
  49   1.52743338e+04  1.54687541e+04  6.68e-05 3.80e-06  6.14e-04    19s
  50   1.52896920e+04  1.54603567e+04  6.02e-05 2.89e-06  5.39e-04    19s
  51   1.53024356e+04  1.54590263e+04  5.49e-05 2.76e-06  4.94e-04    19s
  52   1.53054296e+04  1.54581547e+04  5.36e-05 2.67e-06  4.82e-04    19s
  53   1.53256658e+04  1.54564841e+04  4.53e-05 2.49e-06  4.13e-04    19s
  54   1.53274807e+04  1.54499835e+04  4.45e-05 1.86e-06  3.87e-04    20s
  55   1.53626183e+04  1.54460747e+04  2.95e-05 1.44e-06  2.63e-04    20s
  56   1.53906657e+04  1.54430799e+04  1.74e-05 1.05e-06  1.65e-04    20s
  57   1.54077215e+04  1.54363805e+04  1.04e-05 3.33e-07  9.05e-05    20s
  58   1.54170607e+04  1.54354119e+04  6.51e-06 2.41e-07  5.79e-05    20s
  59   1.54199542e+04  1.54342120e+04  5.28e-06 1.90e-07  4.50e-05    21s
  60   1.54207481e+04  1.54337000e+04  4.96e-06 1.14e-07  4.09e-05    21s
  61   1.54229067e+04  1.54336337e+04  4.06e-06 9.47e-08  3.39e-05    21s
  62   1.54258038e+04  1.54335859e+04  2.92e-06 8.82e-08  2.46e-05    21s
  63   1.54267758e+04  1.54333929e+04  2.53e-06 5.91e-08  2.09e-05    21s
  64   1.54309092e+04  1.54332396e+04  8.21e-07 2.61e-07  7.36e-06    21s
  65   1.54324366e+04  1.54331620e+04  2.42e-07 1.26e-07  2.29e-06    22s
  66   1.54329927e+04  1.54330588e+04  2.84e-08 1.21e-08  2.09e-07    22s
  67   1.54330523e+04  1.54330542e+04  6.27e-09 1.08e-09  5.90e-09    22s
  68   1.54330524e+04  1.54330542e+04  6.25e-08 7.19e-07  5.76e-09    22s
  69   1.54330526e+04  1.54330541e+04  1.44e-06 3.70e-07  4.86e-09    22s
  70   1.54330539e+04  1.54330541e+04  7.32e-07 1.44e-09  7.56e-10    22s
  71   1.54330539e+04  1.54330541e+04  6.60e-07 2.39e-09  5.75e-10    23s
  72   1.54330541e+04  1.54330541e+04  1.12e-06 1.03e-06  2.56e-11    23s

Barrier solved model in 72 iterations and 22.77 seconds (21.85 work units)
Optimal objective 1.54330541e+04


Root crossover log...

  153913 DPushes remaining with DInf 0.0000000e+00                23s
   39989 DPushes remaining with DInf 0.0000000e+00                25s
    1156 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                31s

    4016 PPushes remaining with PInf 3.4914432e-05                31s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.7257439e+00     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   73433    1.5433054e+04   0.000000e+00   8.725744e+00     31s
   73439    1.5433054e+04   0.000000e+00   0.000000e+00     31s
   73439    1.5433054e+04   0.000000e+00   0.000000e+00     31s
Concurrent spin time: 4.19s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 73439 iterations, 27.73 seconds (30.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   36s
H    0     0                    -78959.40331 15433.0541   120%     -   37s
H    0     0                    -75131.14352 15433.0541   121%     -   37s
H    0     0                    -67141.78727 15433.0541   123%     -   37s
H    0     0                    -20994.77576 15433.0541   174%     -   38s
H    0     0                    -20301.42309 15433.0541   176%     -   38s
     0     0 11627.9965    0  416 -20301.423 11627.9965   157%     -  195s
H    0     0                    -20047.09896 11627.9925   158%     -  197s
H    0     0                    -19743.32391 11627.9925   159%     -  197s
H    0     0                    -19730.73037 11627.9925   159%     -  197s
     0     0 11451.1980    0  403 -19730.730 11451.1980   158%     -  303s
     0     0 11394.3614    0  414 -19730.730 11394.3614   158%     -  348s
     0     0 11364.2337    0  418 -19730.730 11364.2337   158%     -  382s
     0     0 11315.4341    0  424 -19730.730 11315.4341   157%     -  417s
     0     0 11314.8125    0  426 -19730.730 11314.8125   157%     -  420s
     0     0 11314.6940    0  426 -19730.730 11314.6940   157%     -  422s
     0     0 8066.00988    0  455 -19730.730 8066.00988   141%     -  542s
H    0     0                    -12470.22438 8065.86422   165%     -  544s
H    0     0                    -12373.30953 8065.86422   165%     -  544s
H    0     0                    -12327.62220 8065.86422   165%     -  544s
H    0     0                    -12224.42415 8065.86422   166%     -  544s
H    0     0                    -11895.23532 8065.86422   168%     -  545s
H    0     0                    -11761.02705 8065.86422   169%     -  545s
H    0     0                    -11743.28349 8065.86422   169%     -  545s
     0     0 7800.81286    0  464 -11743.283 7800.81286   166%     -  584s
     0     0 7602.51039    0  464 -11743.283 7602.51039   165%     -  651s
     0     0 7561.42516    0  469 -11743.283 7561.42516   164%     -  667s
     0     0 7516.51943    0  481 -11743.283 7516.51943   164%     -  679s
     0     0 7500.76675    0  479 -11743.283 7500.76675   164%     -  683s
     0     0 7491.52614    0  478 -11743.283 7491.52614   164%     -  691s
     0     0 7485.09419    0  465 -11743.283 7485.09419   164%     -  699s
     0     0 7478.18953    0  475 -11743.283 7478.18953   164%     -  704s
     0     0 7414.63838    0  488 -11743.283 7414.63838   163%     -  723s
     0     0 7288.80956    0  480 -11743.283 7288.80956   162%     -  748s
     0     0 7259.73695    0  481 -11743.283 7259.73695   162%     -  764s
     0     0 7256.96058    0  481 -11743.283 7256.96058   162%     -  769s
     0     0 7218.72166    0  492 -11743.283 7218.72166   161%     -  785s
     0     0 7202.16464    0  484 -11743.283 7202.16464   161%     -  795s
     0     0 7200.09836    0  493 -11743.283 7200.09836   161%     -  800s
     0     0 7200.03693    0  493 -11743.283 7200.03693   161%     -  802s
     0     0 6052.68474    0  419 -11743.283 6052.68474   152%     -  909s
H    0     0                    -11689.40564 6051.48047   152%     -  911s
     0     0 5875.11971    0  433 -11689.406 5875.11971   150%     -  956s
     0     0 5787.12711    0  530 -11689.406 5787.12711   150%     -  992s
     0     0 5691.73257    0  532 -11689.406 5691.73257   149%     - 1035s
     0     0 5661.13686    0  544 -11689.406 5661.13686   148%     - 1056s
     0     0 5617.69257    0  445 -11689.406 5617.69257   148%     - 1072s
     0     0 5592.08007    0  457 -11689.406 5592.08007   148%     - 1084s
     0     0 5473.02982    0  446 -11689.406 5473.02982   147%     - 1121s
     0     0 5464.78577    0  451 -11689.406 5464.78577   147%     - 1130s
     0     0 5417.97232    0  556 -11689.406 5417.97232   146%     - 1146s
     0     0 5406.81347    0  552 -11689.406 5406.81347   146%     - 1159s
     0     0 5390.45828    0  561 -11689.406 5390.45828   146%     - 1168s
     0     0 5385.18721    0  449 -11689.406 5385.18721   146%     - 1176s
     0     0 5380.97976    0  445 -11689.406 5380.97976   146%     - 1179s
     0     0 5363.45330    0  443 -11689.406 5363.45330   146%     - 1184s
     0     0 5363.00877    0  445 -11689.406 5363.00877   146%     - 1186s
     0     0 4647.62953    0  608 -11689.406 4647.62953   140%     - 1292s
H    0     0                    -11685.78722 4646.22293   140%     - 1294s
H    0     0                    -11662.24045 4646.22293   140%     - 1294s
     0     0 4344.91117    0  589 -11662.240 4344.91117   137%     - 1354s
     0     0 4275.42050    0  612 -11662.240 4275.42050   137%     - 1380s
     0     0 4235.61137    0  609 -11662.240 4235.61137   136%     - 1403s
     0     0 4213.17018    0  615 -11662.240 4213.17018   136%     - 1429s
     0     0 4206.72759    0  625 -11662.240 4206.72759   136%     - 1444s
     0     0 4177.45847    0  472 -11662.240 4177.45847   136%     - 1467s
     0     0 4169.52496    0  628 -11662.240 4169.52496   136%     - 1481s
     0     0 4152.80488    0  476 -11662.240 4152.80488   136%     - 1495s
     0     0 4137.02332    0  476 -11662.240 4137.02332   135%     - 1508s
     0     0 4131.26890    0  636 -11662.240 4131.26890   135%     - 1520s
     0     0 4126.28209    0  627 -11662.240 4126.28209   135%     - 1526s
     0     0 4126.05956    0  628 -11662.240 4126.05956   135%     - 1529s
     0     0 3959.80403    0  463 -11662.240 3959.80403   134%     - 1584s
     0     0 3911.99034    0  472 -11662.240 3911.99034   134%     - 1620s
     0     0 3878.94209    0  562 -11662.240 3878.94209   133%     - 1641s
     0     0 3867.06378    0  470 -11662.240 3867.06378   133%     - 1659s
     0     0 3856.71844    0  480 -11662.240 3856.71844   133%     - 1673s
     0     0 3852.87384    0  480 -11662.240 3852.87384   133%     - 1679s
     0     0 3836.06842    0  551 -11662.240 3836.06842   133%     - 1691s
     0     0 3829.27358    0  468 -11662.240 3829.27358   133%     - 1698s
     0     0 3827.76544    0  468 -11662.240 3827.76544   133%     - 1705s
     0     0 3826.93904    0  473 -11662.240 3826.93904   133%     - 1709s
     0     0 3752.37413    0  562 -11662.240 3752.37413   132%     - 1751s
     0     0 3736.18704    0  560 -11662.240 3736.18704   132%     - 1783s
     0     0 3732.60912    0  549 -11662.240 3732.60912   132%     - 1794s
     0     0 3726.88248    0  559 -11662.240 3726.88248   132%     - 1804s
     0     0 3721.41576    0  550 -11662.240 3721.41576   132%     - 1820s
     0     0 3718.38192    0  562 -11662.240 3718.38192   132%     - 1830s
     0     0 3717.14503    0  559 -11662.240 3717.14503   132%     - 1836s
     0     0 3648.17718    0  623 -11662.240 3648.17718   131%     - 1891s
     0     0 3636.20457    0  529 -11662.240 3636.20457   131%     - 1925s
     0     0 3626.90208    0  535 -11662.240 3626.90208   131%     - 1950s
     0     0 3622.08867    0  626 -11662.240 3622.08867   131%     - 1961s
     0     0 3618.10603    0  565 -11662.240 3618.10603   131%     - 1972s
     0     0 3614.37591    0  629 -11662.240 3614.37591   131%     - 1984s
     0     0 3611.38394    0  633 -11662.240 3611.38394   131%     - 1993s
     0     0 3607.88742    0  576 -11662.240 3607.88742   131%     - 1999s
     0     0 3606.60328    0  580 -11662.240 3606.60328   131%     - 2003s
     0     0 3525.22813    0  585 -11662.240 3525.22813   130%     - 2040s
     0     0 3510.59765    0  643 -11662.240 3510.59765   130%     - 2074s
     0     0 3491.74206    0  640 -11662.240 3491.74206   130%     - 2098s
     0     0 3481.05579    0  651 -11662.240 3481.05579   130%     - 2120s
     0     0 3478.91420    0  658 -11662.240 3478.91420   130%     - 2129s
     0     0 3478.35444    0  660 -11662.240 3478.35444   130%     - 2135s
     0     0 3461.54973    0  561 -11662.240 3461.54973   130%     - 2160s
     0     0 3452.06440    0  565 -11662.240 3452.06440   130%     - 2174s
     0     0 3445.13215    0  561 -11662.240 3445.13215   130%     - 2187s
     0     0 3441.55923    0  559 -11662.240 3441.55923   130%     - 2194s
     0     0 3438.81750    0  565 -11662.240 3438.81750   129%     - 2200s
     0     0 3437.26343    0  561 -11662.240 3437.26343   129%     - 2203s
     0     0 3428.15433    0  504 -11662.240 3428.15433   129%     - 2220s
H    0     0                    -11660.93757 3428.09378   129%     - 2226s
H    0     0                    -11657.31915 3428.09378   129%     - 2226s
H    0     0                    -11642.26167 3428.09378   129%     - 2226s
     0     0 3425.05433    0  557 -11642.262 3425.05433   129%     - 2239s
     0     0 3422.67301    0  524 -11642.262 3422.67301   129%     - 2249s
     0     0 3421.94491    0  523 -11642.262 3421.94491   129%     - 2255s
     0     0 3416.21103    0  517 -11642.262 3416.21103   129%     - 2272s
     0     0 3413.89715    0  604 -11642.262 3413.89715   129%     - 2283s
     0     0 3411.99166    0  597 -11642.262 3411.99166   129%     - 2292s
     0     0 3409.92191    0  585 -11642.262 3409.92191   129%     - 2299s
     0     0 3408.81542    0  588 -11642.262 3408.81542   129%     - 2305s
     0     0 3399.92453    0  583 -11642.262 3399.92453   129%     - 2330s
     0     0 3398.01426    0  587 -11642.262 3398.01426   129%     - 2347s
     0     0 3397.60483    0  515 -11642.262 3397.60483   129%     - 2351s
     0     0 3391.83664    0  518 -11642.262 3391.83664   129%     - 2365s
     0     0 3390.76897    0  524 -11642.262 3390.76897   129%     - 2374s
     0     0 3369.12210    0  561 -11642.262 3369.12210   129%     - 2399s
H    0     0                    -9741.205847 3369.01471   135%     - 2706s
H    0     0                    -8469.470939 3369.01471   140%     - 2706s
H    0     0                    -7899.785748 3369.01471   143%     - 2707s
H    0     0                    -6899.489856 3369.01471   149%     - 2707s
H    0     0                    -5873.911814 3369.01471   157%     - 2737s
     0     0 3365.32071    0  528 -5873.9118 3365.32071   157%     - 2762s
     0     0 3361.96586    0  573 -5873.9118 3361.96586   157%     - 2774s
     0     0 3360.80041    0  573 -5873.9118 3360.80041   157%     - 2784s
     0     0 3356.71778    0  578 -5873.9118 3356.71778   157%     - 2805s
     0     0 3355.12597    0  661 -5873.9118 3355.12597   157%     - 2813s
     0     0 3349.70281    0  603 -5873.9118 3349.70281   157%     - 2834s
     0     0 3349.06968    0  607 -5873.9118 3349.06968   157%     - 2838s
     0     0 3347.77044    0  609 -5873.9118 3347.77044   157%     - 2847s
     0     0 3347.62878    0  609 -5873.9118 3347.62878   157%     - 2868s
H    0     0                    -5814.970444 3347.62878   158%     - 3152s
H    0     0                    -5801.729498 3347.62878   158%     - 3160s
     0     2 3347.62878    0  609 -5801.7295 3347.62878   158%     - 3166s
     1     3 2553.95332    1  480 -5801.7295 3347.47123   158% 28675 3272s
     2     4 3132.85965    1  500 -5801.7295 3132.85965   154% 19040 3312s
     3     7 2795.73252    2  461 -5801.7295 3130.62971   154% 17760 3369s
     6    13 2499.17117    3  459 -5801.7295 3130.62971   154% 17142 3466s
    12    26 2388.90399    4  457 -5801.7295 2794.01071   148% 18158 3524s
    25    30 2028.99298    5  476 -5801.7295 2388.81505   141% 21262 3600s

Cutting planes:
  Learned: 2
  Gomory: 4
  Implied bound: 190
  MIR: 2824
  Flow cover: 2910
  Zero half: 4
  RLT: 26
  Relax-and-lift: 214

Explored 29 nodes (1684775 simplex iterations) in 3600.11 seconds (4586.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5801.73 -5814.97 -5873.91 ... -11660.9

Time limit reached
Best objective -5.801729498206e+03, best bound 2.388815047738e+03, gap 141.1742%
  WARNING: Time limit reached. Using best solution found (gap: 141.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = -5801.73, θ = 120030.74
  Upper Bound (UB) = -5801.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120030.74
  [DEBUG]   ✓ Scenario 0: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120030.74 ≤ Q = 120030.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 120030.74 ≤ Q = 120030.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 120030.74 ≤ Q = 120030.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3d0356a2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3d0356a2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.367899e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6417869.2141
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.447217e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144721.71    0  124 6417869.21 -144721.71   102%     -    0s
H    0     0                    -110802.2645 -144721.71  30.6%     -    0s
H    0     0                    -111761.9809 -144721.71  29.5%     -    0s
     0     0 -121050.41    0  129 -111761.98 -121050.41  8.31%     -    0s
H    0     0                    -115497.7962 -121046.80  4.80%     -    0s
     0     0 -119494.39    0  131 -115497.80 -119494.39  3.46%     -    0s
H    0     0                    -115923.4909 -119327.74  2.94%     -    0s
H    0     0                    -115982.2193 -118791.41  2.42%     -    0s
     0     0 -118791.41    0  126 -115982.22 -118791.41  2.42%     -    0s
     0     0 -118727.00    0  126 -115982.22 -118727.00  2.37%     -    0s
     0     0 -118721.22    0  126 -115982.22 -118721.22  2.36%     -    0s
     0     0 -118439.40    0  114 -115982.22 -118439.40  2.12%     -    0s
     0     0 -118425.43    0  114 -115982.22 -118425.43  2.11%     -    0s
     0     0 -118156.56    0   71 -115982.22 -118156.56  1.87%     -    0s
     0     0 -118093.38    0  128 -115982.22 -118093.38  1.82%     -    0s
     0     0 -118088.55    0  128 -115982.22 -118088.55  1.82%     -    0s
     0     0 -117905.00    0  139 -115982.22 -117905.00  1.66%     -    0s
     0     0 -117888.29    0  139 -115982.22 -117888.29  1.64%     -    0s
     0     2 -117888.29    0  139 -115982.22 -117888.29  1.64%     -    0s
H   32    64                    -116001.4401 -117579.88  1.36%  16.7    0s
H   33    64                    -116020.4531 -117579.88  1.34%  17.1    0s
H   35    64                    -116070.6399 -117579.88  1.30%  16.7    0s
H   59    64                    -116071.7932 -117526.16  1.25%  17.4    0s
H 1248  1109                    -116110.3396 -117526.16  1.22%   6.3    0s
* 1254  1109              44    -116221.1498 -117526.16  1.12%   6.2    0s
* 1629  1434              47    -116292.2550 -117387.70  0.94%   6.3    0s
* 2429  1919              32    -116304.4925 -117280.19  0.84%   6.4    0s
* 2844  2063              41    -116364.8318 -117280.19  0.79%   6.3    0s
* 3062  2063              41    -116385.7570 -117203.26  0.70%   6.3    0s
H 4863  2358                    -116402.7995 -117091.73  0.59%   6.8    0s
H 4863  2239                    -116432.7154 -117091.73  0.57%   6.8    0s
H 4882  2121                    -116478.5085 -116545.21  0.06%   6.8    0s
H 4889  2020                    -116486.3005 -116536.89  0.04%   7.0    0s
H 4889  1919                    -116502.5967 -116536.89  0.03%   7.0    0s
* 4891  1825              23    -116533.3344 -116533.33  0.00%   7.0    0s

Cutting planes:
  Gomory: 22
  Implied bound: 5
  MIR: 15
  Flow cover: 46
  RLT: 1
  Relax-and-lift: 5

Explored 4891 nodes (35165 simplex iterations) in 0.88 seconds (0.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -116533 -116503 -116486 ... -116292
No other solutions better than -116533

Optimal solution found (tolerance 1.00e-06)
Best objective -1.165333343755e+05, best bound -1.165333343755e+05, gap 0.0000%
  Subproblem solved in 0.92s
  Worst-case operational profit (Z_SP) = 116872.66
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116533.33
  [DEBUG]   S×d_nominal = 233405.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233405.99 + -116533.33 = 116872.66
  [DEBUG]   Current θ from Master = 120030.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3158.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8959.81
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 2315.6600, Absolute Gap = 2315.6600, Relative Gap = 0.399133
  Not converged yet (gap = 2315.66 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0x8334c2ae
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns (presolve time = 5s)...
Presolve removed 155540 rows and 63140 columns
Presolve time: 7.09s
Presolved: 182223 rows, 76400 columns, 1120875 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.62s

Barrier statistics:
 Dense cols : 1123
 AA' NZ     : 4.765e+06
 Factor NZ  : 1.326e+07 (roughly 200 MB of memory)
 Factor Ops : 4.528e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79848925e+07  3.31804449e+08  1.02e+05 1.21e+01  7.70e+04    11s
   1  -1.40731737e+07  2.85633278e+08  7.25e+04 4.23e+01  5.41e+04    11s
   2  -4.53817400e+06  2.16216939e+08  2.22e+04 1.24e+00  1.77e+04    11s
   3  -9.27819937e+05  1.48818662e+08  2.10e+03 1.43e+00  2.02e+03    11s
   4  -5.76827495e+05  7.49877767e+07  4.65e+02 4.15e-01  5.41e+02    11s
   5  -5.11333355e+05  4.89686841e+07  2.60e+02 2.29e-01  3.11e+02    11s
   6  -4.42476913e+05  4.24138005e+07  1.17e+02 1.90e-01  1.99e+02    11s
   7  -3.76507838e+05  3.14605268e+07  3.95e+01 1.31e-01  1.17e+02    12s
   8  -2.42052404e+05  2.19233897e+07  5.82e-02 8.69e-02  6.68e+01    12s
   9  -1.81467818e+05  6.92899975e+06  2.19e-02 2.72e-02  2.14e+01    12s
  10  -1.14905352e+05  3.94424140e+06  7.73e-03 1.52e-02  1.22e+01    12s
  11  -9.17093505e+04  2.77156717e+06  3.79e-03 1.05e-02  8.63e+00    12s
  12  -7.18031114e+04  1.77470722e+06  1.72e-03 6.69e-03  5.56e+00    12s
  13  -5.18706390e+04  7.18757586e+05  6.38e-04 2.50e-03  2.32e+00    12s
  14  -2.60435074e+04  1.84563773e+05  2.21e-04 7.98e-04  6.35e-01    13s
  15  -2.09410163e+04  1.28336397e+05  1.84e-04 5.40e-04  4.50e-01    13s
  16  -1.58394021e+04  8.71152173e+04  1.51e-04 3.46e-04  3.10e-01    13s
  17  -1.23029252e+04  5.59841807e+04  1.30e-04 2.00e-04  2.06e-01    13s
  18  -7.21127402e+03  5.03080206e+04  9.98e-05 1.72e-04  1.73e-01    14s
  19  -4.06911540e+03  4.61550995e+04  8.29e-05 1.53e-04  1.51e-01    14s
  20  -1.35223105e+03  3.89225765e+04  6.87e-05 1.19e-04  1.21e-01    14s
  21   3.97423829e+02  3.28194300e+04  6.02e-05 8.98e-05  9.77e-02    14s
  22   1.96122927e+03  2.99009057e+04  5.25e-05 7.55e-05  8.42e-02    14s
  23   2.64555318e+03  2.79399942e+04  4.96e-05 6.66e-05  7.62e-02    15s
  24   5.47849388e+03  2.46400734e+04  3.78e-05 4.95e-05  5.77e-02    15s
  25   7.36032273e+03  2.21331676e+04  3.02e-05 3.57e-05  4.45e-02    15s
  26   9.62938880e+03  2.04583403e+04  2.15e-05 2.64e-05  3.26e-02    15s
  27   1.09287173e+04  1.92703262e+04  1.65e-05 2.00e-05  2.51e-02    15s
  28   1.17411719e+04  1.79929593e+04  1.34e-05 1.32e-05  1.88e-02    16s
  29   1.24805071e+04  1.71665957e+04  1.06e-05 8.88e-06  1.41e-02    16s
  30   1.29801780e+04  1.67507192e+04  8.73e-06 6.77e-06  1.14e-02    16s
  31   1.36220614e+04  1.63598846e+04  6.27e-06 4.75e-06  8.25e-03    16s
  32   1.36885101e+04  1.61117285e+04  6.00e-06 3.57e-06  7.30e-03    17s
  33   1.43884799e+04  1.59256354e+04  3.54e-06 2.59e-06  4.63e-03    17s
  34   1.44785911e+04  1.57706036e+04  3.23e-06 1.77e-06  3.89e-03    17s
  35   1.46702362e+04  1.57596331e+04  2.58e-06 1.78e-06  3.28e-03    17s
  36   1.47528276e+04  1.56769647e+04  2.28e-06 1.27e-06  2.78e-03    17s
  37   1.49482661e+04  1.56486101e+04  1.61e-06 1.11e-06  2.11e-03    18s
  38   1.50360890e+04  1.55820720e+04  1.31e-06 1.20e-06  1.65e-03    18s
  39   1.51258089e+04  1.55510548e+04  1.01e-06 9.86e-07  1.28e-03    18s
  40   1.51620228e+04  1.55172657e+04  8.82e-07 8.02e-07  1.07e-03    18s
  41   1.51960284e+04  1.55079387e+04  7.67e-07 7.04e-07  9.40e-04    19s
  42   1.52466454e+04  1.54879033e+04  6.06e-07 6.81e-07  7.27e-04    19s
  43   1.52533391e+04  1.54863332e+04  5.86e-07 6.62e-07  7.02e-04    19s
  44   1.52704885e+04  1.54815882e+04  5.31e-07 7.08e-07  6.36e-04    19s
  45   1.52755477e+04  1.54677741e+04  5.15e-07 4.81e-07  5.79e-04    20s
  46   1.52902746e+04  1.54619500e+04  4.64e-07 4.31e-07  5.17e-04    20s
  47   1.53143797e+04  1.54560171e+04  3.79e-07 3.42e-07  4.27e-04    20s
  48   1.53237031e+04  1.54531726e+04  3.44e-07 3.01e-07  3.90e-04    21s
  49   1.53334367e+04  1.54517184e+04  3.12e-07 2.83e-07  3.56e-04    21s
  50   1.53486598e+04  1.54494622e+04  2.64e-07 2.48e-07  3.04e-04    21s
  51   1.53528098e+04  1.54485014e+04  2.51e-07 2.31e-07  2.88e-04    22s
  52   1.53551770e+04  1.54479009e+04  2.43e-07 2.22e-07  2.79e-04    22s
  53   1.53696742e+04  1.54468958e+04  1.97e-07 2.06e-07  2.33e-04    22s
  54   1.53782736e+04  1.54414370e+04  1.70e-07 1.31e-07  1.90e-04    23s
  55   1.53997572e+04  1.54365382e+04  1.04e-07 2.87e-08  1.11e-04    23s
  56   1.54161322e+04  1.54352768e+04  6.32e-08 1.31e-08  5.77e-05    24s
  57   1.54249288e+04  1.54344429e+04  3.18e-08 7.11e-09  2.87e-05    24s
  58   1.54259903e+04  1.54336271e+04  2.79e-08 1.12e-10  2.30e-05    25s
  59   1.54282483e+04  1.54333300e+04  2.10e-08 4.17e-09  1.53e-05    25s
  60   1.54317127e+04  1.54331493e+04  8.58e-08 7.90e-10  4.33e-06    25s
  61   1.54319268e+04  1.54331277e+04  1.75e-07 1.02e-08  3.62e-06    25s
  62   1.54322557e+04  1.54331239e+04  1.26e-07 5.03e-08  2.62e-06    26s
  63   1.54323075e+04  1.54331195e+04  4.10e-07 4.76e-08  2.45e-06    26s
  64   1.54327659e+04  1.54330693e+04  1.56e-07 1.11e-07  9.14e-07    26s
  65   1.54330111e+04  1.54330548e+04  1.48e-07 3.57e-09  1.32e-07    26s
  66   1.54330536e+04  1.54330542e+04  1.59e-08 5.22e-10  1.61e-09    26s
  67   1.54330535e+04  1.54330541e+04  3.67e-06 3.04e-08  7.91e-10    27s
  68   1.54330537e+04  1.54330541e+04  2.62e-06 2.61e-07  5.60e-10    27s
  69   1.54330541e+04  1.54330541e+04  4.09e-08 1.81e-09  8.72e-12    27s

Barrier solved model in 69 iterations and 27.01 seconds (24.43 work units)
Optimal objective 1.54330541e+04


Root crossover log...

  161105 DPushes remaining with DInf 0.0000000e+00                27s
   36516 DPushes remaining with DInf 0.0000000e+00                30s
    1948 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                36s

    3971 PPushes remaining with PInf 5.5678722e-06                36s
       0 PPushes remaining with PInf 0.0000000e+00                36s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.2692251e-03     36s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74408    1.5433054e+04   0.000000e+00   9.269225e-03     36s
   74410    1.5433054e+04   0.000000e+00   0.000000e+00     36s
   74410    1.5433054e+04   0.000000e+00   0.000000e+00     36s
Concurrent spin time: 3.65s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 74410 iterations, 31.22 seconds (32.43 work units)
Total elapsed time = 40.45s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   41s
H    0     0                    -81779.98910 15433.0541   119%     -   41s
H    0     0                    -77927.57343 15433.0541   120%     -   41s
H    0     0                    -69938.21718 15433.0541   122%     -   41s
H    0     0                    -27182.44662 15433.0541   157%     -   42s
H    0     0                    -21825.14254 15433.0541   171%     -   42s
H    0     0                    -20713.05603 15433.0541   175%     -   44s
H    0     0                    -20588.79002 15433.0541   175%     -   44s
H    0     0                    -20563.08147 15433.0541   175%     -   44s
     0     0 11637.7494    0  416 -20563.081 11637.7494   157%     -  232s
H    0     0                    -20151.84007 11637.7026   158%     -  234s
H    0     0                    -20010.65914 11637.7026   158%     -  234s
H    0     0                    -19903.88356 11637.7026   158%     -  234s
H    0     0                    -19864.60476 11637.7026   159%     -  234s
     0     0 11412.6445    0  413 -19864.605 11412.6445   157%     -  338s
     0     0 11385.0155    0  409 -19864.605 11385.0155   157%     -  364s
     0     0 11337.3925    0  415 -19864.605 11337.3925   157%     -  410s
     0     0 11302.2212    0  424 -19864.605 11302.2212   157%     -  444s
     0     0 11302.2160    0  424 -19864.605 11302.2160   157%     -  447s
     0     0 8367.50089    0  456 -19864.605 8367.50089   142%     -  611s
H    0     0                    -12115.93075 8366.18576   169%     -  612s
     0     0 7956.89383    0  460 -12115.931 7956.89383   166%     -  668s
     0     0 7786.06079    0  481 -12115.931 7786.06079   164%     -  694s
     0     0 7758.22643    0  475 -12115.931 7758.22643   164%     -  709s
     0     0 7746.21208    0  477 -12115.931 7746.21208   164%     -  721s
     0     0 7701.35498    0  486 -12115.931 7701.35498   164%     -  730s
     0     0 7691.07824    0  485 -12115.931 7691.07824   163%     -  739s
     0     0 7615.08510    0  477 -12115.931 7615.08510   163%     -  775s
     0     0 7343.67706    0  475 -12115.931 7343.67706   161%     -  844s
     0     0 7322.77834    0  462 -12115.931 7322.77834   160%     -  862s
     0     0 7287.03596    0  470 -12115.931 7287.03596   160%     -  887s
     0     0 7286.98696    0  469 -12115.931 7286.98696   160%     -  888s
     0     0 5685.26462    0  438 -12115.931 5685.26462   147%     - 1046s
     0     0 5433.19485    0  452 -12115.931 5433.19485   145%     - 1125s
     0     0 5242.27511    0  460 -12115.931 5242.27511   143%     - 1181s
     0     0 5213.35897    0  458 -12115.931 5213.35897   143%     - 1209s
     0     0 5177.76374    0  463 -12115.931 5177.76374   143%     - 1232s
     0     0 5132.55945    0  465 -12115.931 5132.55945   142%     - 1253s
     0     0 5128.44840    0  465 -12115.931 5128.44840   142%     - 1260s
     0     0 5120.29812    0  551 -12115.931 5120.29812   142%     - 1269s
     0     0 5113.57027    0  473 -12115.931 5113.57027   142%     - 1272s
     0     0 5089.68220    0  475 -12115.931 5089.68220   142%     - 1285s
     0     0 5080.18312    0  477 -12115.931 5080.18312   142%     - 1298s
     0     0 5074.48574    0  479 -12115.931 5074.48574   142%     - 1305s
     0     0 5059.93150    0  476 -12115.931 5059.93150   142%     - 1315s
     0     0 5008.77189    0  472 -12115.931 5008.77189   141%     - 1347s
     0     0 4993.52640    0  478 -12115.931 4993.52640   141%     - 1376s
     0     0 4987.55127    0  483 -12115.931 4987.55127   141%     - 1385s
     0     0 4971.60223    0  472 -12115.931 4971.60223   141%     - 1396s
     0     0 4969.60861    0  476 -12115.931 4969.60861   141%     - 1401s
     0     0 4969.47904    0  473 -12115.931 4969.47904   141%     - 1403s
     0     0 4244.61260    0  557 -12115.931 4244.61260   135%     - 1536s
H    0     0                    -12114.44353 4244.32289   135%     - 1538s
H    0     0                    -12075.16472 4244.32289   135%     - 1538s
     0     0 4158.84252    0  468 -12075.165 4158.84252   134%     - 1575s
     0     0 4101.55023    0  621 -12075.165 4101.55023   134%     - 1624s
     0     0 4074.07357    0  630 -12075.165 4074.07357   134%     - 1646s
     0     0 4038.16351    0  532 -12075.165 4038.16351   133%     - 1662s
     0     0 4032.80698    0  536 -12075.165 4032.80698   133%     - 1672s
     0     0 4030.41647    0  542 -12075.165 4030.41647   133%     - 1677s
     0     0 4006.49667    0  619 -12075.165 4006.49667   133%     - 1702s
     0     0 3891.28835    0  607 -12075.165 3891.28835   132%     - 1730s
     0     0 3883.24314    0  619 -12075.165 3883.24314   132%     - 1743s
     0     0 3881.24319    0  617 -12075.165 3881.24319   132%     - 1748s
     0     0 3880.35211    0  623 -12075.165 3880.35211   132%     - 1756s
     0     0 3719.47927    0  563 -12075.165 3719.47927   131%     - 1818s
     0     0 3660.12243    0  490 -12075.165 3660.12243   130%     - 1859s
     0     0 3634.57482    0  494 -12075.165 3634.57482   130%     - 1884s
     0     0 3629.82436    0  504 -12075.165 3629.82436   130%     - 1899s
     0     0 3594.56662    0  616 -12075.165 3594.56662   130%     - 1925s
     0     0 3497.87111    0  619 -12075.165 3497.87111   129%     - 1969s
     0     0 3488.65703    0  488 -12075.165 3488.65703   129%     - 1980s
     0     0 3475.33789    0  493 -12075.165 3475.33789   129%     - 1997s
     0     0 3450.48593    0  494 -12075.165 3450.48593   129%     - 2006s
     0     0 3442.70674    0  492 -12075.165 3442.70674   129%     - 2013s
     0     0 3437.70678    0  494 -12075.165 3437.70678   128%     - 2023s
     0     0 3429.35029    0  494 -12075.165 3429.35029   128%     - 2034s
     0     0 3427.04579    0  502 -12075.165 3427.04579   128%     - 2038s
     0     0 3425.39322    0  503 -12075.165 3425.39322   128%     - 2043s
     0     0 3424.54066    0  511 -12075.165 3424.54066   128%     - 2046s
     0     0 3355.35338    0  571 -12075.165 3355.35338   128%     - 2074s
H    0     0                    -10805.55825 3353.96047   131%     - 2098s
H    0     0                    -10420.01228 3353.96047   132%     - 2099s
H    0     0                    -9534.490448 3353.96047   135%     - 2099s
H    0     0                    -9039.706754 3353.96047   137%     - 2101s
H    0     0                    -9026.465807 3353.96047   137%     - 2102s
H    0     0                    -9026.262437 3353.96047   137%     - 2102s
H    0     0                    -8956.191877 3353.96047   137%     - 2103s
     0     0 3323.76946    0  480 -8956.1919 3323.76946   137%     - 2125s
     0     0 3302.57772    0  627 -8956.1919 3302.57772   137%     - 2146s
     0     0 3291.89229    0  626 -8956.1919 3291.89229   137%     - 2160s
     0     0 3289.03643    0  632 -8956.1919 3289.03643   137%     - 2168s
     0     0 3287.74125    0  638 -8956.1919 3287.74125   137%     - 2172s
     0     0 3258.71773    0  498 -8956.1919 3258.71773   136%     - 2196s
     0     0 3246.99487    0  505 -8956.1919 3246.99487   136%     - 2213s
     0     0 3236.78742    0  505 -8956.1919 3236.78742   136%     - 2230s
     0     0 3233.04106    0  502 -8956.1919 3233.04106   136%     - 2237s
     0     0 3226.14822    0  505 -8956.1919 3226.14822   136%     - 2252s
     0     0 3222.95889    0  504 -8956.1919 3222.95889   136%     - 2258s
     0     0 3220.61903    0  511 -8956.1919 3220.61903   136%     - 2265s
     0     0 3216.49005    0  508 -8956.1919 3216.49005   136%     - 2282s
     0     0 3213.97384    0  512 -8956.1919 3213.97384   136%     - 2291s
     0     0 3212.19906    0  515 -8956.1919 3212.19906   136%     - 2298s
     0     0 3211.71793    0  513 -8956.1919 3211.71793   136%     - 2301s
     0     0 3174.78933    0  508 -8956.1919 3174.78933   135%     - 2332s
H    0     0                    -8493.426592 3174.78576   137%     - 2334s
H    0     0                    -8231.718396 3174.78576   139%     - 2337s
H    0     0                    -8219.700502 3174.78576   139%     - 2337s
H    0     0                    -8163.547895 3174.78576   139%     - 2338s
     0     0 3168.73318    0  506 -8163.5479 3168.73318   139%     - 2351s
     0     0 3167.19531    0  510 -8163.5479 3167.19531   139%     - 2355s
     0     0 3156.20000    0  509 -8163.5479 3156.20000   139%     - 2380s
H    0     0                    -8098.004085 3155.90217   139%     - 2381s
H    0     0                    -7968.933688 3155.90217   140%     - 2381s
H    0     0                    -7941.987720 3155.90217   140%     - 2381s
H    0     0                    -7933.065703 3155.90217   140%     - 2381s
     0     0 3149.91163    0  511 -7933.0657 3149.91163   140%     - 2402s
     0     0 3143.29450    0  522 -7933.0657 3143.29450   140%     - 2413s
     0     0 3141.50639    0  518 -7933.0657 3141.50639   140%     - 2419s
     0     0 3139.01108    0  518 -7933.0657 3139.01108   140%     - 2425s
     0     0 3136.08750    0  513 -7933.0657 3136.08750   140%     - 2433s
     0     0 3133.32192    0  510 -7933.0657 3133.32192   139%     - 2436s
     0     0 3133.30725    0  510 -7933.0657 3133.30725   139%     - 2437s
     0     0 3121.26602    0  556 -7933.0657 3121.26602   139%     - 2471s
H    0     0                    -7932.279794 3120.42868   139%     - 2474s
H    0     0                    -7880.239338 3120.42868   140%     - 2477s
H    0     0                    -7837.772250 3120.42868   140%     - 2477s
     0     0 3116.11000    0  506 -7837.7723 3116.11000   140%     - 2488s
     0     0 3114.91546    0  512 -7837.7723 3114.91546   140%     - 2493s
     0     0 3108.43425    0  521 -7837.7723 3108.43425   140%     - 2515s
     0     0 3106.85445    0  572 -7837.7723 3106.85445   140%     - 2525s
     0     0 3102.80899    0  570 -7837.7723 3102.80899   140%     - 2543s
H    0     0                    -7182.326780 3102.67577   143%     - 2601s
H    0     0                    -6251.511706 3102.67577   150%     - 2601s
H    0     0                    -6250.651757 3102.67577   150%     - 2601s
H    0     0                    -6204.964425 3102.67577   150%     - 2604s
H    0     0                    -6174.785897 3102.67577   150%     - 2609s
     0     0 3101.90992    0  565 -6174.7859 3101.90992   150%     - 2615s
     0     0 3098.85566    0  564 -6174.7859 3098.85566   150%     - 2634s
     0     0 3098.64651    0  564 -6174.7859 3098.64651   150%     - 2649s
H    0     0                    -6120.387309 3098.64651   151%     - 2874s
H    0     0                    -6109.749186 3098.64651   151%     - 2875s
H    0     0                    -6081.141523 3098.64651   151%     - 3002s
H    0     0                    -5985.881032 3098.64651   152%     - 3067s
H    0     0                    -5968.245518 3098.64651   152%     - 3067s
     0     2 3098.64651    0  564 -5968.2455 3098.64651   152%     - 3077s
     1     3 2352.76815    1  480 -5968.2455 3098.64651   152% 19659 3151s
     2     4 2903.10494    1  542 -5968.2455 2903.10494   149% 19492 3198s
     3     6 1908.65538    2  503 -5968.2455 2902.95164   149% 16866 3244s
     5    10 1760.95490    3  514 -5968.2455 2902.95164   149% 15111 3315s
     9    18 2078.66204    3  398 -5968.2455 2766.85219   146% 14335 3392s
    17    26 -1355.6477    4  263 -5968.2455 2515.08140   142% 13657 3512s
    25    40  916.24706    5  500 -5968.2455 2515.08140   142% 15001 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 267
  MIR: 3162
  Flow cover: 2911
  Zero half: 3
  RLT: 32
  Relax-and-lift: 235

Explored 43 nodes (1890046 simplex iterations) in 3600.19 seconds (4297.67 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -5968.25 -5985.88 -6081.14 ... -7182.33

Time limit reached
Best objective -5.968245518076e+03, best bound 2.515081404523e+03, gap 142.1411%
  WARNING: Time limit reached. Using best solution found (gap: 142.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = -5968.25, θ = 120304.32
  Upper Bound (UB) = -5968.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120304.32
  [DEBUG]   ✓ Scenario 0: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 120304.32 ≤ Q = 120304.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 120304.32 ≤ Q = 120304.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6ae08912
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6ae08912
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373420e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6445795.0718
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.437556e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143755.57    0  124 6445795.07 -143755.57   102%     -    0s
H    0     0                    -109807.1295 -143755.57  30.9%     -    0s
H    0     0                    -110766.8460 -143755.57  29.8%     -    0s
     0     0 -121195.49    0   84 -110766.85 -121195.49  9.41%     -    0s
H    0     0                    -116051.1172 -121058.07  4.31%     -    0s
H    0     0                    -116604.4688 -121058.07  3.82%     -    0s
H    0     0                    -117200.9021 -121058.07  3.29%     -    0s
H    0     0                    -117754.2537 -121058.07  2.81%     -    0s
     0     0 -120240.91    0   83 -117754.25 -120240.91  2.11%     -    0s
     0     0 -119683.90    0   88 -117754.25 -119683.90  1.64%     -    0s
H    0     0                    -117798.6772 -119648.33  1.57%     -    0s
     0     0 -119648.33    0   84 -117798.68 -119648.33  1.57%     -    0s
     0     0 -119397.09    0   78 -117798.68 -119397.09  1.36%     -    0s
     0     0 -119382.59    0   68 -117798.68 -119382.59  1.34%     -    0s
     0     0 -119080.96    0   63 -117798.68 -119080.96  1.09%     -    0s
H    0     0                    -117841.1484 -119046.28  1.02%     -    0s
     0     0 -119046.28    0   65 -117841.15 -119046.28  1.02%     -    0s
     0     0 -118987.89    0   57 -117841.15 -118987.89  0.97%     -    0s
     0     0 -118963.83    0   57 -117841.15 -118963.83  0.95%     -    0s
     0     2 -118961.71    0   57 -117841.15 -118961.71  0.95%     -    0s
H   30    27                    -117891.2751 -118606.13  0.61%  25.1    0s
H   32    27                    -117933.5449 -118576.79  0.55%  25.0    0s
*  552   263              23    -117951.2554 -118367.53  0.35%   6.9    0s
* 1941   477              24    -117980.3808 -118129.90  0.13%   4.8    0s

Cutting planes:
  Gomory: 34
  Implied bound: 3
  MIR: 166
  Flow cover: 3
  RLT: 34
  Relax-and-lift: 1
  BQP: 2

Explored 3250 nodes (14166 simplex iterations) in 0.46 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -117980 -117951 -117934 ... -109807
No other solutions better than -117980

Optimal solution found (tolerance 1.00e-06)
Best objective -1.179803807508e+05, best bound -1.179803807508e+05, gap 0.0000%
  Subproblem solved in 0.49s
  Worst-case operational profit (Z_SP) = 114752.84
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117980.38
  [DEBUG]   S×d_nominal = 232733.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232733.22 + -117980.38 = 114752.84
  [DEBUG]   Current θ from Master = 120304.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5551.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11519.73
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 2149.1440, Absolute Gap = 2149.1440, Relative Gap = 0.360096
  Not converged yet (gap = 2149.14 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0x93fd1529
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns (presolve time = 5s)...
Presolve removed 162610 rows and 66010 columns
Presolve time: 7.10s
Presolved: 190443 rows, 79770 columns, 1171387 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.38s

Barrier statistics:
 Dense cols : 1123
 AA' NZ     : 5.124e+06
 Factor NZ  : 1.411e+07 (roughly 220 MB of memory)
 Factor Ops : 4.785e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79854917e+07  3.44744329e+08  1.02e+05 1.19e+01  7.66e+04    12s
   1  -1.40799774e+07  2.96410481e+08  7.24e+04 4.19e+01  5.38e+04    13s
   2  -4.59335257e+06  2.25041285e+08  2.25e+04 9.95e-01  1.78e+04    13s
   3  -9.35293434e+05  1.55229207e+08  2.12e+03 2.41e+00  2.02e+03    13s
   4  -5.79433289e+05  7.88751087e+07  4.56e+02 7.65e-01  5.36e+02    13s
   5  -5.18050349e+05  5.17917817e+07  2.64e+02 4.22e-01  3.14e+02    13s
   6  -4.52219419e+05  4.49308110e+07  1.23e+02 3.50e-01  2.04e+02    13s
   7  -3.88325999e+05  3.31374286e+07  4.10e+01 2.39e-01  1.19e+02    13s
   8  -2.66954242e+05  2.34038402e+07  7.48e-02 1.59e-01  6.83e+01    14s
   9  -1.91362856e+05  6.10039741e+06  2.10e-02 4.05e-02  1.81e+01    14s
  10  -1.16528103e+05  4.32879564e+06  7.37e-03 2.83e-02  1.28e+01    14s
  11  -1.00365880e+05  2.47620622e+06  4.76e-03 1.64e-02  7.43e+00    14s
  12  -7.36189476e+04  1.82982492e+06  1.97e-03 1.19e-02  5.49e+00    14s
  13  -5.28485931e+04  9.04209413e+05  7.55e-04 5.52e-03  2.76e+00    14s
  14  -2.85555685e+04  2.42774743e+05  2.18e-04 1.54e-03  7.83e-01    15s
  15  -2.11607008e+04  1.61345954e+05  1.64e-04 1.00e-03  5.26e-01    15s
  16  -1.55166578e+04  9.73644751e+04  1.28e-04 5.69e-04  3.26e-01    15s
  17  -1.10563339e+04  6.89128121e+04  1.05e-04 3.99e-04  2.31e-01    15s
  18  -7.25496899e+03  5.95652154e+04  8.56e-05 3.32e-04  1.93e-01    15s
  19  -3.80943476e+03  5.25724060e+04  6.90e-05 2.86e-04  1.63e-01    16s
  20  -2.09502480e+03  4.49099460e+04  6.10e-05 2.31e-04  1.36e-01    16s
  21   1.43910085e+02  3.87291867e+04  5.13e-05 1.87e-04  1.11e-01    16s
  22   2.93486060e+03  3.42370037e+04  4.01e-05 1.52e-04  9.03e-02    16s
  23   4.12668000e+03  2.91917884e+04  3.55e-05 1.14e-04  7.23e-02    17s
  24   6.34630164e+03  2.47372055e+04  2.77e-05 7.76e-05  5.30e-02    17s
  25   8.51178282e+03  2.26037776e+04  2.04e-05 5.98e-05  4.06e-02    17s
  26   1.00364650e+04  2.05428734e+04  1.57e-05 4.21e-05  3.03e-02    17s
  27   1.11506964e+04  1.92273578e+04  1.23e-05 3.08e-05  2.33e-02    18s
  28   1.23297572e+04  1.80635702e+04  8.73e-06 2.12e-05  1.65e-02    18s
  29   1.25984944e+04  1.71411006e+04  7.83e-06 1.39e-05  1.31e-02    18s
  30   1.30361438e+04  1.65454988e+04  6.55e-06 8.99e-06  1.01e-02    18s
  31   1.34812303e+04  1.62074539e+04  5.26e-06 6.26e-06  7.86e-03    19s
  32   1.40653921e+04  1.60291297e+04  3.63e-06 4.76e-06  5.66e-03    19s
  33   1.43573485e+04  1.57812026e+04  2.84e-06 2.80e-06  4.11e-03    19s
  34   1.45582000e+04  1.57488865e+04  2.32e-06 2.55e-06  3.43e-03    19s
  35   1.47236973e+04  1.57034190e+04  1.89e-06 2.16e-06  2.83e-03    20s
  36   1.48564703e+04  1.56742573e+04  1.52e-06 1.92e-06  2.36e-03    20s
  37   1.49430917e+04  1.56252690e+04  1.28e-06 1.52e-06  1.97e-03    20s
  38   1.50387292e+04  1.55685172e+04  1.03e-06 1.04e-06  1.53e-03    20s
  39   1.50797163e+04  1.55124384e+04  9.27e-07 9.55e-07  1.25e-03    21s
  40   1.51186764e+04  1.54996938e+04  8.23e-07 7.73e-07  1.10e-03    21s
  41   1.51861136e+04  1.54895447e+04  6.35e-07 6.54e-07  8.75e-04    21s
  42   1.52135699e+04  1.54814982e+04  5.67e-07 5.40e-07  7.73e-04    21s
  43   1.52429830e+04  1.54709025e+04  4.93e-07 3.98e-07  6.57e-04    22s
  44   1.53101074e+04  1.54638289e+04  3.08e-07 3.11e-07  4.43e-04    22s
  45   1.53219278e+04  1.54562408e+04  2.79e-07 2.46e-07  3.87e-04    22s
  46   1.53411743e+04  1.54539709e+04  2.30e-07 2.24e-07  3.25e-04    22s
  47   1.53479708e+04  1.54526836e+04  2.13e-07 2.11e-07  3.02e-04    23s
  48   1.53562264e+04  1.54523073e+04  1.93e-07 2.02e-07  2.77e-04    23s
  49   1.53634241e+04  1.54469793e+04  1.76e-07 1.53e-07  2.41e-04    24s
  50   1.53701401e+04  1.54442818e+04  1.72e-07 1.24e-07  2.14e-04    24s
  51   1.53948202e+04  1.54394413e+04  1.28e-07 5.41e-08  1.29e-04    25s
  52   1.54054749e+04  1.54365721e+04  1.03e-07 3.27e-08  8.97e-05    25s
  53   1.54145292e+04  1.54364170e+04  6.98e-08 3.11e-08  6.31e-05    26s
  54   1.54192990e+04  1.54361643e+04  5.22e-08 2.83e-08  4.86e-05    26s
  55   1.54223489e+04  1.54349341e+04  4.35e-08 1.62e-08  3.63e-05    26s
  56   1.54238584e+04  1.54336764e+04  4.89e-08 4.22e-10  2.83e-05    27s
  57   1.54272117e+04  1.54334461e+04  9.06e-08 4.83e-10  1.80e-05    27s
  58   1.54313568e+04  1.54331513e+04  4.39e-08 1.40e-10  5.18e-06    28s
  59   1.54325379e+04  1.54331393e+04  7.06e-08 1.33e-10  1.74e-06    28s
  60   1.54329408e+04  1.54330952e+04  1.54e-08 5.18e-10  4.45e-07    28s
  61   1.54330355e+04  1.54330602e+04  2.44e-09 9.04e-11  7.14e-08    28s
  62   1.54330492e+04  1.54330542e+04  1.88e-07 5.27e-09  1.45e-08    29s
  63   1.54330541e+04  1.54330541e+04  2.48e-07 1.47e-09  1.53e-10    29s

Barrier solved model in 63 iterations and 28.76 seconds (26.28 work units)
Optimal objective 1.54330541e+04


Root crossover log...

  168299 DPushes remaining with DInf 0.0000000e+00                29s
   73658 DPushes remaining with DInf 0.0000000e+00                30s
   26576 DPushes remaining with DInf 0.0000000e+00                35s
    1597 DPushes remaining with DInf 0.0000000e+00                40s
       0 DPushes remaining with DInf 0.0000000e+00                41s

    8956 PPushes remaining with PInf 8.8364968e-05                41s
       0 PPushes remaining with PInf 0.0000000e+00                42s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.3608057e+02     42s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   87489    1.5433054e+04   0.000000e+00   5.360806e+02     42s
   87607    1.5433054e+04   0.000000e+00   0.000000e+00     43s
   87607    1.5433054e+04   0.000000e+00   0.000000e+00     43s
Concurrent spin time: 8.33s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.543305e+04, 87607 iterations, 42.46 seconds (44.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   52s
H    0     0                    -172792.3193 15433.0541   109%     -   53s
H    0     0                    -152419.8263 15433.0541   110%     -   54s
H    0     0                    -150002.1872 15433.0541   110%     -   55s
H    0     0                    -145696.2788 15433.0541   111%     -   55s
H    0     0                    -145553.6460 15433.0541   111%     -   56s
H    0     0                    -144155.1562 15433.0541   111%     -   56s
H    0     0                    -78058.88076 15433.0541   120%     -   56s
H    0     0                    -25626.23017 15433.0541   160%     -   57s
H    0     0                    -24129.44845 15433.0541   164%     -   58s
H    0     0                    -24121.44427 15433.0541   164%     -   58s
H    0     0                    -24111.95361 15433.0541   164%     -   58s
H    0     0                    -24074.84337 15433.0541   164%     -   58s
H    0     0                    -24072.74900 15433.0541   164%     -   58s
H    0     0                    -24057.03239 15433.0541   164%     -   58s
H    0     0                    -24056.67865 15433.0541   164%     -   58s
     0     0 11778.0160    0  366 -24056.679 11778.0160   149%     -  312s
H    0     0                    -24037.82375 11777.8252   149%     -  314s
H    0     0                    -24021.77995 11777.8252   149%     -  314s
     0     0 11559.9901    0  409 -24021.780 11559.9901   148%     -  453s
     0     0 11386.1290    0  410 -24021.780 11386.1290   147%     -  540s
     0     0 11320.8425    0  418 -24021.780 11320.8425   147%     -  597s
     0     0 11274.9697    0  430 -24021.780 11274.9697   147%     -  650s
     0     0 11274.4855    0  430 -24021.780 11274.4855   147%     -  652s
     0     0 11258.4829    0  421 -24021.780 11258.4829   147%     -  663s
     0     0 11258.3987    0  421 -24021.780 11258.3987   147%     -  665s
     0     0 8440.78043    0  442 -24021.780 8440.78043   135%     -  867s
H    0     0                    -13952.21964 8440.37165   160%     -  868s
H    0     0                    -13929.43952 8440.37165   161%     -  868s
H    0     0                    -13719.00004 8440.37165   162%     -  869s
H    0     0                    -13688.57822 8440.37165   162%     -  869s
H    0     0                    -13682.96756 8440.37165   162%     -  869s
     0     0 8029.14325    0  461 -13682.968 8029.14325   159%     -  989s
     0     0 7999.04405    0  469 -13682.968 7999.04405   158%     - 1014s
     0     0 7975.12106    0  477 -13682.968 7975.12106   158%     - 1038s
     0     0 7971.03117    0  478 -13682.968 7971.03117   158%     - 1050s
     0     0 7963.36945    0  482 -13682.968 7963.36945   158%     - 1067s
     0     0 7959.98760    0  478 -13682.968 7959.98760   158%     - 1074s
     0     0 7942.46003    0  478 -13682.968 7942.46003   158%     - 1087s
     0     0 7892.80090    0  475 -13682.968 7892.80090   158%     - 1119s
     0     0 7885.75998    0  463 -13682.968 7885.75998   158%     - 1133s
     0     0 7823.73032    0  461 -13682.968 7823.73032   157%     - 1171s
     0     0 7806.12394    0  448 -13682.968 7806.12394   157%     - 1201s
     0     0 7801.90525    0  456 -13682.968 7801.90525   157%     - 1214s
     0     0 7800.07648    0  454 -13682.968 7800.07648   157%     - 1221s
     0     0 7786.89884    0  451 -13682.968 7786.89884   157%     - 1237s
     0     0 7783.34740    0  453 -13682.968 7783.34740   157%     - 1251s
     0     0 7783.33196    0  456 -13682.968 7783.33196   157%     - 1254s
     0     0 6064.66790    0  402 -13682.968 6064.66790   144%     - 1395s
     0     0 5646.67458    0  429 -13682.968 5646.67458   141%     - 1471s
     0     0 5589.87825    0  435 -13682.968 5589.87825   141%     - 1503s
     0     0 5553.71854    0  425 -13682.968 5553.71854   141%     - 1518s
     0     0 5433.43845    0  418 -13682.968 5433.43845   140%     - 1561s
     0     0 5403.71113    0  435 -13682.968 5403.71113   139%     - 1573s
     0     0 5381.87164    0  432 -13682.968 5381.87164   139%     - 1586s
     0     0 5299.31321    0  433 -13682.968 5299.31321   139%     - 1609s
     0     0 5263.95690    0  433 -13682.968 5263.95690   138%     - 1628s
     0     0 5250.00092    0  438 -13682.968 5250.00092   138%     - 1640s
     0     0 5248.88022    0  436 -13682.968 5248.88022   138%     - 1645s
     0     0 4584.10331    0  482 -13682.968 4584.10331   134%     - 1760s
     0     0 4352.80074    0  555 -13682.968 4352.80074   132%     - 1826s
     0     0 4304.94400    0  565 -13682.968 4304.94400   131%     - 1852s
     0     0 4238.25022    0  553 -13682.968 4238.25022   131%     - 1888s
     0     0 4205.97793    0  569 -13682.968 4205.97793   131%     - 1912s
     0     0 4191.10289    0  563 -13682.968 4191.10289   131%     - 1934s
     0     0 4140.03106    0  568 -13682.968 4140.03106   130%     - 1952s
     0     0 4125.76782    0  573 -13682.968 4125.76782   130%     - 1968s
     0     0 4119.78023    0  574 -13682.968 4119.78023   130%     - 1978s
     0     0 4115.26708    0  566 -13682.968 4115.26708   130%     - 1988s
     0     0 4111.03617    0  569 -13682.968 4111.03617   130%     - 1997s
     0     0 4102.75815    0  564 -13682.968 4102.75815   130%     - 2005s
     0     0 4100.33907    0  573 -13682.968 4100.33907   130%     - 2009s
     0     0 4092.07709    0  571 -13682.968 4092.07709   130%     - 2016s
     0     0 4088.78479    0  560 -13682.968 4088.78479   130%     - 2025s
     0     0 4077.10286    0  575 -13682.968 4077.10286   130%     - 2037s
     0     0 4075.44307    0  575 -13682.968 4075.44307   130%     - 2041s
     0     0 4073.63158    0  584 -13682.968 4073.63158   130%     - 2044s
     0     0 4072.53227    0  585 -13682.968 4072.53227   130%     - 2048s
     0     0 3850.99154    0  464 -13682.968 3850.99154   128%     - 2127s
     0     0 3783.72837    0  474 -13682.968 3783.72837   128%     - 2169s
     0     0 3765.60708    0  480 -13682.968 3765.60708   128%     - 2199s
     0     0 3749.19606    0  484 -13682.968 3749.19606   127%     - 2239s
     0     0 3735.32228    0  483 -13682.968 3735.32228   127%     - 2258s
     0     0 3724.93311    0  483 -13682.968 3724.93311   127%     - 2266s
     0     0 3720.74543    0  481 -13682.968 3720.74543   127%     - 2273s
     0     0 3717.49651    0  476 -13682.968 3717.49651   127%     - 2284s
     0     0 3714.16971    0  484 -13682.968 3714.16971   127%     - 2290s
     0     0 3711.34915    0  479 -13682.968 3711.34915   127%     - 2298s
     0     0 3705.19292    0  487 -13682.968 3705.19292   127%     - 2320s
     0     0 3693.22389    0  472 -13682.968 3693.22389   127%     - 2344s
     0     0 3687.75898    0  476 -13682.968 3687.75898   127%     - 2354s
     0     0 3686.98187    0  478 -13682.968 3686.98187   127%     - 2358s
     0     0 3609.90561    0  486 -13682.968 3609.90561   126%     - 2439s
H    0     0                    -13658.76713 3609.88160   126%     - 2448s
     0     0 3582.98704    0  488 -13658.767 3582.98704   126%     - 2490s
     0     0 3571.35545    0  478 -13658.767 3571.35545   126%     - 2514s
     0     0 3558.76903    0  486 -13658.767 3558.76903   126%     - 2532s
     0     0 3554.17017    0  490 -13658.767 3554.17017   126%     - 2543s
     0     0 3552.38079    0  502 -13658.767 3552.38079   126%     - 2552s
     0     0 3509.29610    0  491 -13658.767 3509.29610   126%     - 2571s
     0     0 3506.64392    0  499 -13658.767 3506.64392   126%     - 2582s
     0     0 3505.23052    0  507 -13658.767 3505.23052   126%     - 2588s
     0     0 3449.62691    0  496 -13658.767 3449.62691   125%     - 2632s
     0     0 3437.84283    0  493 -13658.767 3437.84283   125%     - 2667s
     0     0 3432.55684    0  501 -13658.767 3432.55684   125%     - 2681s
     0     0 3428.27695    0  500 -13658.767 3428.27695   125%     - 2693s
     0     0 3417.28863    0  500 -13658.767 3417.28863   125%     - 2709s
     0     0 3408.09769    0  495 -13658.767 3408.09769   125%     - 2727s
     0     0 3406.50592    0  499 -13658.767 3406.50592   125%     - 2738s
     0     0 3389.49555    0  497 -13658.767 3389.49555   125%     - 2761s
H    0     0                    -12822.83988 3388.91785   126%     - 2763s
H    0     0                    -12792.29297 3388.91785   126%     - 2763s
H    0     0                    -12772.55460 3388.91785   127%     - 2764s
H    0     0                    -12653.93789 3388.91785   127%     - 2764s
H    0     0                    -12628.22934 3388.91785   127%     - 2764s
H    0     0                    -12548.78592 3388.91785   127%     - 2764s
H    0     0                    -12519.93967 3388.91785   127%     - 2764s
H    0     0                    -12367.97534 3388.91785   127%     - 2764s
H    0     0                    -12317.75712 3388.91785   128%     - 2764s
H    0     0                    -11946.86709 3388.91785   128%     - 2765s
H    0     0                    -11892.31228 3388.91785   128%     - 2765s
     0     0 3384.36663    0  500 -11892.312 3384.36663   128%     - 2782s
     0     0 3381.88059    0  503 -11892.312 3381.88059   128%     - 2795s
     0     0 3379.47646    0  502 -11892.312 3379.47646   128%     - 2806s
     0     0 3377.34416    0  506 -11892.312 3377.34416   128%     - 2816s
     0     0 3373.58115    0  508 -11892.312 3373.58115   128%     - 2826s
     0     0 3373.36413    0  506 -11892.312 3373.36413   128%     - 2831s
     0     0 3292.14804    0  483 -11892.312 3292.14804   128%     - 2885s
H    0     0                    -11843.31408 3291.93951   128%     - 2887s
     0     0 3274.42429    0  504 -11843.314 3274.42429   128%     - 2922s
     0     0 3268.53350    0  500 -11843.314 3268.53350   128%     - 2947s
     0     0 3264.33342    0  506 -11843.314 3264.33342   128%     - 2956s
     0     0 3261.23128    0  502 -11843.314 3261.23128   128%     - 2967s
     0     0 3260.56459    0  506 -11843.314 3260.56459   128%     - 2970s
     0     0 3249.97262    0  498 -11843.314 3249.97262   127%     - 2999s
H    0     0                    -10727.18856 3249.94237   130%     - 3006s
H    0     0                    -6982.316721 3249.94237   147%     - 3011s
H    0     0                    -6931.602621 3249.94237   147%     - 3011s
     0     0 3246.79101    0  505 -6931.6026 3246.79101   147%     - 3029s
     0     0 3245.07581    0  510 -6931.6026 3245.07581   147%     - 3037s
     0     0 3243.17501    0  514 -6931.6026 3243.17501   147%     - 3045s
     0     0 3241.05763    0  508 -6931.6026 3241.05763   147%     - 3056s
     0     0 3239.89051    0  567 -6931.6026 3239.89051   147%     - 3061s
     0     0 3235.80726    0  508 -6931.6026 3235.80726   147%     - 3075s
H    0     0                    -6925.544114 3235.68186   147%     - 3077s
     0     0 3231.51242    0  508 -6925.5441 3231.51242   147%     - 3086s
     0     0 3229.98129    0  505 -6925.5441 3229.98129   147%     - 3090s
     0     0 3222.53623    0  509 -6925.5441 3222.53623   147%     - 3106s
H    0     0                    -6681.127119 3222.51890   148%     - 3109s
H    0     0                    -6555.676762 3222.51890   149%     - 3110s
H    0     0                    -6485.494477 3222.51890   150%     - 3111s
H    0     0                    -6428.135524 3222.51890   150%     - 3111s
H    0     0                    -6294.020069 3222.51890   151%     - 3112s
H    0     0                    -6256.296893 3222.51890   152%     - 3113s
     0     0 3220.28372    0  584 -6256.2969 3220.28372   151%     - 3122s
     0     0 3218.71020    0  516 -6256.2969 3218.71020   151%     - 3128s
     0     0 3209.30108    0  506 -6256.2969 3209.30108   151%     - 3150s
     0     0 3209.13588    0  506 -6256.2969 3209.13588   151%     - 3168s
H    0     0                    -6109.990401 3209.10151   153%     - 3315s
H    0     0                    -6050.094091 3209.10151   153%     - 3472s
     0     2 3209.10151    0  506 -6050.0941 3209.10151   153%     - 3478s
     1     3 2807.94114    1  465 -6050.0941 3209.10151   153% 11631 3513s
     2     4 3152.85002    1  495 -6050.0941 3152.85002   152% 12620 3543s
     3     6 2412.18968    2  459 -6050.0941 3151.58675   152% 11921 3581s

Cutting planes:
  Learned: 2
  Implied bound: 252
  MIR: 2363
  Flow cover: 1847
  Zero half: 1
  RLT: 14
  Relax-and-lift: 145

Explored 5 nodes (1218945 simplex iterations) in 3600.06 seconds (3959.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -6050.09 -6109.99 -6256.3 ... -6931.6

Time limit reached
Best objective -6.050094090593e+03, best bound 3.151586749961e+03, gap 152.0915%
  WARNING: Time limit reached. Using best solution found (gap: 152.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -6050.09, θ = 119847.55
  Upper Bound (UB) = -6050.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119847.55
  [DEBUG]   ✓ Scenario 0: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 119847.55 ≤ Q = 119847.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 119847.55 ≤ Q = 119847.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6543f164
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9abc0e9c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368031e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6451838.6453
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.433408e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143340.80    0  124 6451838.65 -143340.80   102%     -    0s
H    0     0                    -109429.7361 -143340.80  31.0%     -    0s
H    0     0                    -110546.9312 -143340.80  29.7%     -    0s
     0     0 -119700.72    0   83 -110546.93 -119700.72  8.28%     -    0s
H    0     0                    -114715.2389 -119641.41  4.29%     -    0s
H    0     0                    -115268.5905 -119641.41  3.79%     -    0s
H    0     0                    -115434.3901 -119641.41  3.64%     -    0s
H    0     0                    -115987.7417 -119641.41  3.15%     -    0s
     0     0 -118936.93    0   88 -115987.74 -118936.93  2.54%     -    0s
     0     0 -118806.05    0   86 -115987.74 -118806.05  2.43%     -    0s
H    0     0                    -116144.3223 -118806.05  2.29%     -    0s
     0     0 -118501.98    0   81 -116144.32 -118501.98  2.03%     -    0s
     0     0 -118429.89    0   80 -116144.32 -118429.89  1.97%     -    0s
     0     0 -117995.20    0   71 -116144.32 -117995.20  1.59%     -    0s
     0     0 -117973.83    0   79 -116144.32 -117973.83  1.58%     -    0s
     0     0 -117869.85    0   67 -116144.32 -117869.85  1.49%     -    0s
     0     0 -117803.61    0   67 -116144.32 -117803.61  1.43%     -    0s
H    0     0                    -116169.2644 -117802.58  1.41%     -    0s
H    0     0                    -116220.3239 -117802.58  1.36%     -    0s
     0     2 -117802.58    0   67 -116220.32 -117802.58  1.36%     -    0s

Cutting planes:
  Gomory: 36
  Implied bound: 2
  MIR: 153
  RLT: 34
  Relax-and-lift: 7
  BQP: 1

Explored 9728 nodes (46084 simplex iterations) in 0.60 seconds (0.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -116220 -116169 -116144 ... 1.36803e+13
No other solutions better than -116220

Optimal solution found (tolerance 1.00e-06)
Best objective -1.162203239149e+05, best bound -1.162203239149e+05, gap 0.0000%
  Subproblem solved in 0.63s
  Worst-case operational profit (Z_SP) = 115645.89
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116220.32
  [DEBUG]   S×d_nominal = 231866.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 231866.21 + -116220.32 = 115645.89
  [DEBUG]   Current θ from Master = 119847.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4201.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10251.76
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = 2067.2954, Absolute Gap = 2067.2954, Relative Gap = 0.341696
  Not converged yet (gap = 2067.30 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0x6fc93dad
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169680 rows and 68880 columns (presolve time = 5s)...
Presolve removed 169680 rows and 68880 columns
Presolve time: 8.76s
Presolved: 198663 rows, 83140 columns, 1221796 nonzeros
Variable types: 80881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.48s

Barrier statistics:
 Dense cols : 1122
 AA' NZ     : 5.502e+06
 Factor NZ  : 1.518e+07 (roughly 240 MB of memory)
 Factor Ops : 5.282e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79701177e+07  3.57657333e+08  1.02e+05 1.18e+01  7.62e+04    14s
   1  -1.40712065e+07  3.07057709e+08  7.23e+04 4.16e+01  5.34e+04    15s
   2  -4.59941351e+06  2.33883915e+08  2.25e+04 1.24e+00  1.77e+04    15s
   3  -9.55921042e+05  1.63253418e+08  2.12e+03 1.42e+00  2.02e+03    15s
   4  -5.96865641e+05  8.46869492e+07  4.66e+02 4.54e-01  5.48e+02    15s
   5  -5.28459745e+05  5.47012119e+07  2.67e+02 2.51e-01  3.17e+02    15s
   6  -4.60576561e+05  4.76646304e+07  1.22e+02 2.09e-01  2.05e+02    16s
   7  -3.98274168e+05  3.50418621e+07  4.03e+01 1.43e-01  1.19e+02    16s
   8  -2.85137425e+05  2.58832225e+07  2.79e-01 1.01e-01  7.25e+01    16s
   9  -1.94668391e+05  6.25040659e+06  4.09e-02 2.37e-02  1.78e+01    16s
  10  -1.22074469e+05  4.30798340e+06  1.61e-02 1.62e-02  1.23e+01    16s
  11  -1.06908863e+05  2.89196439e+06  1.15e-02 1.08e-02  8.29e+00    16s
  12  -7.71517794e+04  2.00671475e+06  4.53e-03 7.27e-03  5.76e+00    17s
  13  -5.96464924e+04  9.87159503e+05  2.16e-03 3.40e-03  2.90e+00    17s
  14  -3.30904489e+04  2.25248488e+05  5.42e-04 8.75e-04  7.14e-01    17s
  15  -2.51202933e+04  1.54152487e+05  4.02e-04 5.83e-04  4.96e-01    17s
  16  -1.67854944e+04  1.20278573e+05  2.83e-04 4.47e-04  3.79e-01    17s
  17  -1.31561555e+04  8.89735543e+04  2.41e-04 3.21e-04  2.82e-01    18s
  18  -1.05681294e+04  6.63799461e+04  2.13e-04 2.26e-04  2.13e-01    18s
  19  -6.01835859e+03  5.41608165e+04  1.63e-04 1.74e-04  1.66e-01    18s
  20  -4.07454403e+03  5.04221978e+04  1.44e-04 1.58e-04  1.51e-01    19s
  21  -1.19248428e+03  4.54702437e+04  1.16e-04 1.37e-04  1.29e-01    19s
  22   5.20302068e+02  3.77556985e+04  1.01e-04 1.05e-04  1.03e-01    19s
  23   2.91462111e+03  3.33145508e+04  8.15e-05 8.49e-05  8.41e-02    19s
  24   4.05987801e+03  2.95981711e+04  7.26e-05 6.82e-05  7.06e-02    20s
  25   5.92234766e+03  2.60834791e+04  5.92e-05 5.16e-05  5.58e-02    20s
  26   7.54903129e+03  2.37817178e+04  4.81e-05 4.05e-05  4.49e-02    20s
  27   9.65586964e+03  2.17303730e+04  3.46e-05 3.03e-05  3.34e-02    21s
  28   1.07014814e+04  2.08776975e+04  2.79e-05 2.64e-05  2.81e-02    21s
  29   1.14001875e+04  1.88001492e+04  2.36e-05 1.64e-05  2.05e-02    21s
  30   1.22205541e+04  1.76088864e+04  1.81e-05 1.04e-05  1.49e-02    22s
  31   1.28167927e+04  1.66031121e+04  1.45e-05 5.66e-06  1.05e-02    22s
  32   1.30038130e+04  1.64201415e+04  1.35e-05 4.81e-06  9.45e-03    22s
  33   1.35756088e+04  1.61971521e+04  1.00e-05 3.76e-06  7.25e-03    22s
  34   1.41255714e+04  1.59614268e+04  6.94e-06 2.57e-06  5.08e-03    23s
  35   1.43443417e+04  1.57263649e+04  5.73e-06 1.45e-06  3.82e-03    23s
  36   1.44786496e+04  1.56897181e+04  5.01e-06 1.27e-06  3.35e-03    23s
  37   1.46246161e+04  1.56490652e+04  4.26e-06 1.06e-06  2.83e-03    24s
  38   1.47717270e+04  1.56269695e+04  3.47e-06 9.46e-07  2.37e-03    24s
  39   1.49582613e+04  1.55927196e+04  2.50e-06 7.60e-07  1.75e-03    24s
  40   1.50483444e+04  1.55370897e+04  2.02e-06 4.84e-07  1.35e-03    24s
  41   1.51071959e+04  1.55239293e+04  1.70e-06 4.13e-07  1.15e-03    25s
  42   1.51463910e+04  1.54999187e+04  1.51e-06 2.87e-07  9.78e-04    25s
  43   1.51981670e+04  1.54837843e+04  1.22e-06 2.18e-07  7.90e-04    25s
  44   1.52357145e+04  1.54687678e+04  1.03e-06 1.45e-07  6.45e-04    26s
  45   1.52546762e+04  1.54635196e+04  9.29e-07 1.20e-07  5.78e-04    26s
  46   1.52875188e+04  1.54608901e+04  7.63e-07 1.10e-07  4.79e-04    27s
  47   1.53064662e+04  1.54503712e+04  6.66e-07 6.99e-08  3.98e-04    27s
  48   1.53174144e+04  1.54494325e+04  6.07e-07 6.66e-08  3.65e-04    27s
  49   1.53315804e+04  1.54490703e+04  5.34e-07 6.50e-08  3.25e-04    28s
  50   1.53372161e+04  1.54462026e+04  5.06e-07 5.27e-08  3.01e-04    28s
  51   1.53485475e+04  1.54429032e+04  4.45e-07 4.21e-08  2.61e-04    29s
  52   1.53626817e+04  1.54389994e+04  3.71e-07 2.03e-08  2.11e-04    30s
  53   1.53825931e+04  1.54374129e+04  2.64e-07 1.19e-08  1.52e-04    30s
  54   1.54019407e+04  1.54352811e+04  1.61e-07 6.64e-09  9.22e-05    31s
  55   1.54105905e+04  1.54349106e+04  1.15e-07 5.14e-09  6.73e-05    31s
  56   1.54187600e+04  1.54339206e+04  7.34e-08 1.19e-09  4.19e-05    32s
  57   1.54212901e+04  1.54335963e+04  6.03e-08 8.19e-10  3.40e-05    32s
  58   1.54258202e+04  1.54335273e+04  5.83e-08 2.44e-09  2.13e-05    32s
  59   1.54280767e+04  1.54333124e+04  3.63e-08 1.31e-09  1.45e-05    33s
  60   1.54316568e+04  1.54331740e+04  2.03e-08 5.99e-10  4.20e-06    33s
  61   1.54321291e+04  1.54331643e+04  1.76e-07 7.94e-10  2.86e-06    33s
  62   1.54327919e+04  1.54331376e+04  4.96e-08 3.02e-07  9.56e-07    34s
  63   1.54328869e+04  1.54330901e+04  2.93e-07 1.35e-06  5.62e-07    34s
  64   1.54330423e+04  1.54330554e+04  4.62e-08 9.43e-09  3.61e-08    34s
  65   1.54330529e+04  1.54330541e+04  8.09e-08 1.06e-08  3.35e-09    35s
  66   1.54330529e+04  1.54330541e+04  1.30e-06 1.98e-08  3.23e-09    35s
  67   1.54330540e+04  1.54330541e+04  2.50e-07 1.27e-09  4.57e-10    35s
  68   1.54330541e+04  1.54330541e+04  1.05e-07 3.35e-09  9.44e-11    35s

Barrier solved model in 68 iterations and 35.22 seconds (28.88 work units)
Optimal objective 1.54330541e+04


Root crossover log...

  175489 DPushes remaining with DInf 0.0000000e+00                35s
   37400 DPushes remaining with DInf 0.0000000e+00                40s
    3434 DPushes remaining with DInf 0.0000000e+00                45s
       0 DPushes remaining with DInf 0.0000000e+00                46s

    7394 PPushes remaining with PInf 7.5875264e-05                46s
       0 PPushes remaining with PInf 0.0000000e+00                47s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1345766e+02     47s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   86685    1.5433054e+04   0.000000e+00   6.134577e+02     47s
   86717    1.5433054e+04   0.000000e+00   0.000000e+00     47s
   86717    1.5433054e+04   0.000000e+00   0.000000e+00     47s
Concurrent spin time: 1.93s

Solved with barrier

Root relaxation: objective 1.543305e+04, 86717 iterations, 38.76 seconds (41.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15433.0541    0  184 -177247.82 15433.0541   109%     -   50s
H    0     0                    -155579.0945 15433.0541   110%     -   52s
H    0     0                    -149144.2189 15433.0541   110%     -   53s
H    0     0                    -78058.88076 15433.0541   120%     -   53s
H    0     0                    -29684.05963 15433.0541   152%     -   53s
H    0     0                    -26330.37906 15433.0541   159%     -   53s
H    0     0                    -23414.86337 15433.0541   166%     -   54s
H    0     0                    -21556.49951 15433.0541   172%     -   55s
H    0     0                    -21130.51643 15433.0541   173%     -   55s
     0     0 11530.6151    0  415 -21130.516 11530.6151   155%     -  313s
H    0     0                    -20748.18099 11530.3659   156%     -  316s
H    0     0                    -20292.45956 11530.3659   157%     -  316s
H    0     0                    -20269.99911 11530.3659   157%     -  316s
H    0     0                    -20256.55479 11530.3659   157%     -  316s
     0     0 10842.6749    0  416 -20256.555 10842.6749   154%     -  408s
     0     0 10787.4500    0  412 -20256.555 10787.4500   153%     -  460s
     0     0 10785.4939    0  415 -20256.555 10785.4939   153%     -  464s
     0     0 10785.4939    0  415 -20256.555 10785.4939   153%     -  465s
     0     0 8662.70416    0  456 -20256.555 8662.70416   143%     -  703s
H    0     0                    -12607.98340 8662.64283   169%     -  705s
H    0     0                    -12400.38801 8662.64283   170%     -  705s
H    0     0                    -12396.76959 8662.64283   170%     -  705s
H    0     0                    -12193.67217 8662.64283   171%     -  705s
H    0     0                    -12190.05375 8662.64283   171%     -  705s
     0     0 7920.86914    0  487 -12190.054 7920.86914   165%     -  841s
     0     0 7834.17344    0  478 -12190.054 7834.17344   164%     -  903s
     0     0 7749.41971    0  484 -12190.054 7749.41971   164%     -  948s
     0     0 7633.27963    0  475 -12190.054 7633.27963   163%     - 1024s
     0     0 7569.37070    0  489 -12190.054 7569.37070   162%     - 1072s
     0     0 7523.49217    0  483 -12190.054 7523.49217   162%     - 1120s
     0     0 7445.97296    0  483 -12190.054 7445.97296   161%     - 1163s
     0     0 7430.88456    0  494 -12190.054 7430.88456   161%     - 1184s
     0     0 7389.75077    0  487 -12190.054 7389.75077   161%     - 1215s
     0     0 7380.12823    0  489 -12190.054 7380.12823   161%     - 1230s
     0     0 7374.62496    0  483 -12190.054 7374.62496   160%     - 1243s
     0     0 7367.55382    0  488 -12190.054 7367.55382   160%     - 1254s
     0     0 7367.00027    0  506 -12190.054 7367.00027   160%     - 1259s
     0     0 6070.51160    0  399 -12190.054 6070.51160   150%     - 1404s
     0     0 5655.81204    0  414 -12190.054 5655.81204   146%     - 1471s
     0     0 5493.58425    0  407 -12190.054 5493.58425   145%     - 1518s
     0     0 5396.25365    0  427 -12190.054 5396.25365   144%     - 1555s
     0     0 5372.96256    0  432 -12190.054 5372.96256   144%     - 1580s
     0     0 5345.31554    0  425 -12190.054 5345.31554   144%     - 1609s
     0     0 5342.64391    0  425 -12190.054 5342.64391   144%     - 1619s
     0     0 5284.74215    0  436 -12190.054 5284.74215   143%     - 1656s
     0     0 5179.78844    0  510 -12190.054 5179.78844   142%     - 1695s
     0     0 5065.23186    0  426 -12190.054 5065.23186   142%     - 1734s
     0     0 5030.89232    0  432 -12190.054 5030.89232   141%     - 1763s
     0     0 5015.60091    0  441 -12190.054 5015.60091   141%     - 1788s
     0     0 5011.69303    0  444 -12190.054 5011.69303   141%     - 1799s
     0     0 5006.51837    0  447 -12190.054 5006.51837   141%     - 1807s
     0     0 4973.52300    0  435 -12190.054 4973.52300   141%     - 1826s
     0     0 4968.45957    0  439 -12190.054 4968.45957   141%     - 1834s
     0     0 4965.39484    0  443 -12190.054 4965.39484   141%     - 1842s
     0     0 4962.65129    0  439 -12190.054 4962.65129   141%     - 1847s
     0     0 4962.12591    0  441 -12190.054 4962.12591   141%     - 1849s
     0     0 4428.66402    0  466 -12190.054 4428.66402   136%     - 1954s
     0     0 4259.22945    0  553 -12190.054 4259.22945   135%     - 2040s
     0     0 4226.98770    0  464 -12190.054 4226.98770   135%     - 2082s
     0     0 4191.12662    0  547 -12190.054 4191.12662   134%     - 2113s
     0     0 4153.24381    0  467 -12190.054 4153.24381   134%     - 2155s
     0     0 4079.01817    0  568 -12190.054 4079.01817   133%     - 2194s
     0     0 4055.54995    0  560 -12190.054 4055.54995   133%     - 2227s
     0     0 4050.57442    0  559 -12190.054 4050.57442   133%     - 2235s
     0     0 4047.82542    0  564 -12190.054 4047.82542   133%     - 2244s
     0     0 4028.66485    0  563 -12190.054 4028.66485   133%     - 2266s
     0     0 4004.83597    0  467 -12190.054 4004.83597   133%     - 2279s
     0     0 4004.24211    0  471 -12190.054 4004.24211   133%     - 2282s
     0     0 3913.25058    0  563 -12190.054 3913.25058   132%     - 2326s
     0     0 3832.99030    0  461 -12190.054 3832.99030   131%     - 2366s
     0     0 3793.82573    0  559 -12190.054 3793.82573   131%     - 2402s
     0     0 3787.02469    0  470 -12190.054 3787.02469   131%     - 2415s
     0     0 3771.79881    0  476 -12190.054 3771.79881   131%     - 2430s
     0     0 3757.59803    0  561 -12190.054 3757.59803   131%     - 2449s
     0     0 3752.63769    0  561 -12190.054 3752.63769   131%     - 2461s
     0     0 3751.55350    0  566 -12190.054 3751.55350   131%     - 2465s
     0     0 3703.10526    0  483 -12190.054 3703.10526   130%     - 2503s
     0     0 3661.63573    0  465 -12190.054 3661.63573   130%     - 2540s
     0     0 3646.13828    0  471 -12190.054 3646.13828   130%     - 2558s
     0     0 3643.79362    0  479 -12190.054 3643.79362   130%     - 2563s
     0     0 3635.95942    0  483 -12190.054 3635.95942   130%     - 2573s
     0     0 3635.00984    0  482 -12190.054 3635.00984   130%     - 2576s
     0     0 3544.83365    0  475 -12190.054 3544.83365   129%     - 2611s
     0     0 3530.01317    0  472 -12190.054 3530.01317   129%     - 2635s
     0     0 3515.67731    0  466 -12190.054 3515.67731   129%     - 2651s
     0     0 3510.31703    0  472 -12190.054 3510.31703   129%     - 2674s
     0     0 3507.31970    0  470 -12190.054 3507.31970   129%     - 2682s
     0     0 3506.64654    0  475 -12190.054 3506.64654   129%     - 2689s
     0     0 3467.52308    0  476 -12190.054 3467.52308   128%     - 2717s
     0     0 3458.53682    0  486 -12190.054 3458.53682   128%     - 2737s
     0     0 3440.71376    0  499 -12190.054 3440.71376   128%     - 2754s
     0     0 3438.95630    0  500 -12190.054 3438.95630   128%     - 2763s
     0     0 3437.91758    0  489 -12190.054 3437.91758   128%     - 2772s
     0     0 3415.09399    0  630 -12190.054 3415.09399   128%     - 2816s
     0     0 3407.81636    0  492 -12190.054 3407.81636   128%     - 2833s
     0     0 3399.98426    0  638 -12190.054 3399.98426   128%     - 2854s
     0     0 3395.79665    0  633 -12190.054 3395.79665   128%     - 2866s
     0     0 3393.77806    0  640 -12190.054 3393.77806   128%     - 2877s
     0     0 3390.33876    0  635 -12190.054 3390.33876   128%     - 2886s
     0     0 3389.70684    0  509 -12190.054 3389.70684   128%     - 2892s
     0     0 3369.00026    0  607 -12190.054 3369.00026   128%     - 2922s
     0     0 3355.28610    0  635 -12190.054 3355.28610   128%     - 2944s
     0     0 3344.88412    0  557 -12190.054 3344.88412   127%     - 2965s
     0     0 3343.74220    0  651 -12190.054 3343.74220   127%     - 2974s
     0     0 3332.59627    0  508 -12190.054 3332.59627   127%     - 2993s
     0     0 3327.95765    0  511 -12190.054 3327.95765   127%     - 3002s
     0     0 3326.57591    0  504 -12190.054 3326.57591   127%     - 3008s
     0     0 3318.79799    0  506 -12190.054 3318.79799   127%     - 3029s
     0     0 3316.87866    0  518 -12190.054 3316.87866   127%     - 3051s
     0     0 3316.57114    0  519 -12190.054 3316.57114   127%     - 3055s
     0     0 3313.12022    0  521 -12190.054 3313.12022   127%     - 3070s
     0     0 3307.73646    0  528 -12190.054 3307.73646   127%     - 3082s
     0     0 3306.56036    0  528 -12190.054 3306.56036   127%     - 3090s
     0     0 3304.78947    0  524 -12190.054 3304.78947   127%     - 3102s
     0     0 3304.44914    0  524 -12190.054 3304.44914   127%     - 3119s

Cutting planes:
  Learned: 1
  Implied bound: 212
  MIR: 2250
  Flow cover: 1542
  Zero half: 3
  RLT: 25
  Relax-and-lift: 195

Explored 1 nodes (1188232 simplex iterations) in 3600.04 seconds (4060.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12190.1 -12193.7 -12396.8 ... -21130.5

Time limit reached
Best objective -1.219005375280e+04, best bound 3.304388959695e+03, gap 127.1073%
  WARNING: Time limit reached. Using best solution found (gap: 127.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -12190.05, θ = 117106.24
  Upper Bound (UB) = -12190.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 117106.24
  [DEBUG]   ✓ Scenario 0: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 117106.24 ≤ Q = 117106.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 117106.24 ≤ Q = 117106.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 117106.24 ≤ Q = 117106.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 117106.24 ≤ Q = 117106.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x39282068
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x39282068
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.414212e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6618543.3525
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.468101e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146810.12    0  124 6618543.35 -146810.12   102%     -    0s
H    0     0                    -112668.3890 -146810.12  30.3%     -    0s
H    0     0                    -113746.7565 -146810.12  29.1%     -    0s
     0     0 -131078.15    0   79 -113746.76 -131078.15  15.2%     -    0s
H    0     0                    -125965.4675 -130931.56  3.94%     -    0s
H    0     0                    -126527.0026 -130931.56  3.48%     -    0s
H    0     0                    -126759.6224 -130931.56  3.29%     -    0s
H    0     0                    -127321.1575 -130931.56  2.84%     -    0s
     0     0 -129862.09    0   81 -127321.16 -129862.09  2.00%     -    0s
H    0     0                    -127532.1822 -129753.73  1.74%     -    0s
H    0     0                    -127574.8006 -129753.73  1.71%     -    0s
     0     0 -129331.24    0   60 -127574.80 -129331.24  1.38%     -    0s
     0     0 -129194.57    0   79 -127574.80 -129194.57  1.27%     -    0s
     0     0 -128693.14    0   45 -127574.80 -128693.14  0.88%     -    0s
     0     0 -128653.50    0   46 -127574.80 -128653.50  0.85%     -    0s
     0     0 -128143.35    0   24 -127574.80 -128143.35  0.45%     -    0s
     0     0 -128110.36    0   23 -127574.80 -128110.36  0.42%     -    0s
     0     0 -128039.23    0   31 -127574.80 -128039.23  0.36%     -    0s
     0     0 -128038.91    0   31 -127574.80 -128038.91  0.36%     -    0s
     0     0 -127865.08    0   23 -127574.80 -127865.08  0.23%     -    0s
     0     0 -127853.99    0   19 -127574.80 -127853.99  0.22%     -    0s
     0     0 -127853.28    0   22 -127574.80 -127853.28  0.22%     -    0s
     0     0 -127775.35    0   14 -127574.80 -127775.35  0.16%     -    0s
     0     0 -127769.35    0   15 -127574.80 -127769.35  0.15%     -    0s
     0     0 -127643.19    0    8 -127574.80 -127643.19  0.05%     -    0s
     0     0 -127641.88    0   11 -127574.80 -127641.88  0.05%     -    0s
*    0     0               0    -127591.9458 -127591.95  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 6
  MIR: 5
  Flow cover: 8
  Relax-and-lift: 1

Explored 1 nodes (866 simplex iterations) in 0.28 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -127592 -127575 -127532 ... 1.41421e+13
No other solutions better than -127592

Optimal solution found (tolerance 1.00e-06)
Best objective -1.275919458062e+05, best bound -1.275919458062e+05, gap 0.0000%
  Subproblem solved in 0.32s
  Worst-case operational profit (Z_SP) = 104735.76
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127591.95
  [DEBUG]   S×d_nominal = 232327.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232327.70 + -127591.95 = 104735.76
  [DEBUG]   Current θ from Master = 117106.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12370.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24560.54
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = -4072.6643, Absolute Gap = 4072.6643, Relative Gap = -0.334097
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -12190.05, LB = -8117.39, Gap = -4072.66
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086294 nonzeros
Model fingerprint: 0x70d1e495
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 176750 rows and 71750 columns (presolve time = 5s)...
Presolve removed 176750 rows and 71750 columns
Presolve time: 7.95s
Presolved: 206883 rows, 86510 columns, 1272255 nonzeros
Variable types: 84251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -397441.0822
Found heuristic solution: objective -385740.9548
Found heuristic solution: objective -177247.8178

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.66s

Barrier statistics:
 Dense cols : 1121
 AA' NZ     : 5.899e+06
 Factor NZ  : 1.635e+07 (roughly 250 MB of memory)
 Factor Ops : 5.954e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82058565e+07  3.70691581e+08  1.03e+05 1.17e+01  7.68e+04    14s
   1  -1.42649620e+07  3.18285398e+08  7.32e+04 4.11e+01  5.39e+04    14s
   2  -4.68220139e+06  2.42631397e+08  2.29e+04 1.14e+00  1.80e+04    14s
   3  -9.53889335e+05  1.70526548e+08  2.09e+03 1.88e+00  1.99e+03    15s
   4  -6.00211997e+05  8.89551133e+07  4.64e+02 5.86e-01  5.48e+02    15s
   5  -5.30919033e+05  5.78982041e+07  2.64e+02 3.19e-01  3.17e+02    15s
   6  -4.62939849e+05  5.00212253e+07  1.18e+02 2.63e-01  2.04e+02    15s
   7  -4.02076386e+05  3.70658737e+07  3.85e+01 1.83e-01  1.20e+02    15s
   8  -2.94323244e+05  2.76592535e+07  2.02e-01 1.31e-01  7.43e+01    15s
   9  -1.97213014e+05  6.42011875e+06  1.98e-02 2.98e-02  1.76e+01    15s
  10  -1.23893598e+05  4.89941135e+06  7.68e-03 2.25e-02  1.33e+01    16s
  11  -1.09725912e+05  2.93256495e+06  5.64e-03 1.34e-02  8.08e+00    16s
  12  -8.26055429e+04  2.39498642e+06  2.51e-03 1.08e-02  6.58e+00    16s
  13  -6.52030467e+04  1.54777925e+06  1.24e-03 6.77e-03  4.28e+00    16s
  14  -4.28049876e+04  2.43701951e+05  3.91e-04 1.00e-03  7.61e-01    16s
  15  -2.89542177e+04  1.65648155e+05  2.69e-04 6.65e-04  5.17e-01    16s
  16  -2.36329753e+04  1.05223250e+05  2.32e-04 3.91e-04  3.42e-01    17s
  17  -1.78118213e+04  7.25111513e+04  1.93e-04 2.46e-04  2.40e-01    17s
  18  -1.08480022e+04  6.02324387e+04  1.44e-04 1.93e-04  1.89e-01    17s
  19  -6.70300243e+03  5.29930843e+04  1.16e-04 1.63e-04  1.59e-01    17s
  20  -5.58336608e+03  4.24923365e+04  1.09e-04 1.23e-04  1.28e-01    18s
  21  -2.15799648e+03  3.74722430e+04  8.76e-05 1.01e-04  1.05e-01    18s
  22  -6.64120261e+02  3.33099288e+04  7.87e-05 8.32e-05  9.02e-02    18s
  23   1.01373713e+03  2.95367902e+04  6.92e-05 6.65e-05  7.58e-02    18s
  24   3.92369674e+03  2.67799942e+04  5.37e-05 5.37e-05  6.07e-02    19s
  25   4.84892521e+03  2.53916493e+04  4.86e-05 4.76e-05  5.46e-02    19s
  26   7.13674638e+03  2.28238011e+04  3.74e-05 3.53e-05  4.17e-02    19s
  27   8.64786191e+03  2.12266226e+04  3.03e-05 2.75e-05  3.34e-02    19s
  28   1.04260882e+04  1.96843837e+04  2.23e-05 1.98e-05  2.46e-02    20s
  29   1.12377254e+04  1.92062467e+04  1.86e-05 1.75e-05  2.12e-02    20s
  30   1.15509047e+04  1.80892840e+04  1.72e-05 1.23e-05  1.74e-02    20s
  31   1.22331347e+04  1.72180745e+04  1.40e-05 8.06e-06  1.32e-02    21s
  32   1.27754219e+04  1.69543186e+04  1.14e-05 6.84e-06  1.11e-02    21s
  33   1.31899958e+04  1.64607522e+04  9.55e-06 4.59e-06  8.69e-03    21s
  34   1.36703166e+04  1.62439402e+04  7.48e-06 3.67e-06  6.84e-03    21s
  35   1.38560486e+04  1.61473361e+04  6.67e-06 3.25e-06  6.09e-03    22s
  36   1.42163726e+04  1.59750994e+04  5.15e-06 2.38e-06  4.67e-03    22s
  37   1.44198184e+04  1.58642957e+04  4.32e-06 1.87e-06  3.84e-03    22s
  38   1.45285941e+04  1.58382857e+04  3.87e-06 1.74e-06  3.48e-03    22s
  39   1.46639439e+04  1.57635327e+04  3.32e-06 1.39e-06  2.92e-03    23s
  40   1.47502116e+04  1.57382615e+04  2.97e-06 1.27e-06  2.62e-03    23s
  41   1.48490645e+04  1.57062531e+04  2.56e-06 1.10e-06  2.28e-03    23s
  42   1.49915981e+04  1.56697911e+04  1.96e-06 9.23e-07  1.80e-03    24s
  43   1.50417734e+04  1.56270127e+04  1.76e-06 7.18e-07  1.55e-03    24s
  44   1.51628314e+04  1.56011799e+04  1.26e-06 5.83e-07  1.16e-03    24s
  45   1.51776523e+04  1.55859595e+04  1.20e-06 5.09e-07  1.08e-03    24s
  46   1.51916488e+04  1.55476674e+04  1.13e-06 3.27e-07  9.46e-04    25s
  47   1.52567575e+04  1.55375981e+04  8.75e-07 2.80e-07  7.46e-04    25s
  48   1.52833795e+04  1.55302110e+04  7.71e-07 2.45e-07  6.56e-04    25s
  49   1.52959095e+04  1.55196864e+04  7.19e-07 1.94e-07  5.94e-04    25s
  50   1.53010977e+04  1.55161750e+04  6.96e-07 1.78e-07  5.71e-04    26s
  51   1.53305766e+04  1.55103149e+04  5.79e-07 1.53e-07  4.77e-04    26s
  52   1.53408953e+04  1.55085004e+04  5.38e-07 1.46e-07  4.45e-04    27s
  53   1.53502089e+04  1.55071010e+04  5.01e-07 1.39e-07  4.17e-04    27s
  54   1.53575193e+04  1.55019014e+04  4.73e-07 1.15e-07  3.84e-04    27s
  55   1.53581302e+04  1.55005747e+04  4.70e-07 1.09e-07  3.78e-04    28s
  56   1.53599543e+04  1.54999649e+04  4.62e-07 1.07e-07  3.72e-04    28s
  57   1.53656352e+04  1.54978814e+04  4.39e-07 9.99e-08  3.51e-04    29s
  58   1.53853363e+04  1.54916925e+04  3.55e-07 7.36e-08  2.83e-04    29s
  59   1.54011505e+04  1.54891335e+04  2.92e-07 6.08e-08  2.34e-04    30s
  60   1.54300925e+04  1.54873278e+04  1.74e-07 5.26e-08  1.52e-04    30s
  61   1.54385996e+04  1.54860373e+04  1.41e-07 4.74e-08  1.26e-04    31s
  62   1.54511373e+04  1.54849069e+04  9.11e-08 4.23e-08  8.97e-05    32s
  63   1.54646108e+04  1.54815127e+04  3.95e-08 2.67e-08  4.49e-05    32s
  64   1.54699380e+04  1.54786593e+04  2.62e-08 1.78e-08  2.32e-05    32s
  65   1.54721488e+04  1.54773335e+04  1.75e-08 9.50e-09  1.38e-05    33s
  66   1.54748606e+04  1.54755267e+04  3.74e-08 7.25e-09  1.77e-06    33s
  67   1.54754538e+04  1.54754649e+04  3.66e-09 7.90e-11  2.95e-08    33s
  68   1.54754573e+04  1.54754642e+04  8.45e-07 4.78e-10  1.82e-08    33s
  69   1.54754632e+04  1.54754635e+04  1.03e-07 6.45e-11  6.35e-10    34s
  70   1.54754635e+04  1.54754635e+04  4.68e-08 1.01e-10  3.38e-11    34s

Barrier solved model in 70 iterations and 33.78 seconds (32.23 work units)
Optimal objective 1.54754635e+04


Root crossover log...

  182659 DPushes remaining with DInf 0.0000000e+00                34s
   79289 DPushes remaining with DInf 0.0000000e+00                35s
   26098 DPushes remaining with DInf 0.0000000e+00                40s
     346 DPushes remaining with DInf 0.0000000e+00                45s
       0 DPushes remaining with DInf 0.0000000e+00                45s

    5713 PPushes remaining with PInf 7.2543908e-05                45s
       0 PPushes remaining with PInf 0.0000000e+00                46s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1216972e+04     46s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   86885    1.5475463e+04   0.000000e+00   1.121697e+04     46s
   86910    1.5475463e+04   0.000000e+00   0.000000e+00     46s
   86910    1.5475463e+04   0.000000e+00   0.000000e+00     46s
Concurrent spin time: 9.53s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.547546e+04, 86910 iterations, 45.89 seconds (46.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15475.4635    0  185 -177247.82 15475.4635   109%     -   57s
H    0     0                    -93790.11698 15475.4635   117%     -   58s
H    0     0                    -93292.71339 15475.4635   117%     -   58s
H    0     0                    -78069.09140 15475.4635   120%     -   58s
H    0     0                    -34438.71569 15475.4635   145%     -   59s
H    0     0                    -31269.30870 15475.4635   149%     -   59s
H    0     0                    -22220.06090 15475.4635   170%     -   60s
H    0     0                    -21981.08400 15475.4635   170%     -   60s
H    0     0                    -21967.63969 15475.4635   170%     -   60s
H    0     0                    -21944.48052 15475.4635   171%     -   60s
H    0     0                    -21809.77972 15475.4635   171%     -   61s
     0     0 11261.7708    0  366 -21809.780 11261.7708   152%     -  250s
     0     0 11122.5362    0  358 -21809.780 11122.5362   151%     -  368s
     0     0 11121.9905    0  358 -21809.780 11121.9905   151%     -  374s
     0     0 11086.5317    0  356 -21809.780 11086.5317   151%     -  414s
     0     0 11085.7264    0  356 -21809.780 11085.7264   151%     -  416s
     0     0 11085.7120    0  357 -21809.780 11085.7120   151%     -  417s
     0     0 8292.19957    0  467 -21809.780 8292.19957   138%     -  603s
H    0     0                    -21673.10268 8254.80480   138%     -  604s
H    0     0                    -21420.70763 8254.80480   139%     -  605s
H    0     0                    -21391.86138 8254.80480   139%     -  605s
H    0     0                    -21334.22655 8254.80480   139%     -  605s
H    0     0                    -21330.60813 8254.80480   139%     -  605s
     0     0 8052.84308    0  364 -21330.608 8052.84308   138%     -  662s
     0     0 8046.01024    0  370 -21330.608 8046.01024   138%     -  670s
     0     0 8041.88897    0  367 -21330.608 8041.88897   138%     -  676s
     0     0 8032.87702    0  369 -21330.608 8032.87702   138%     -  682s
     0     0 8024.74944    0  364 -21330.608 8024.74944   138%     -  691s
     0     0 8012.00790    0  370 -21330.608 8012.00790   138%     -  698s
     0     0 7953.95608    0  370 -21330.608 7953.95608   137%     -  706s
     0     0 7953.77861    0  371 -21330.608 7953.77861   137%     -  708s
     0     0 6608.65575    0  396 -21330.608 6608.65575   131%     -  817s
H    0     0                    -21169.11771 6608.65234   131%     -  820s
     0     0 6321.95510    0  418 -21169.118 6321.95510   130%     -  898s
     0     0 6123.01413    0  420 -21169.118 6123.01413   129%     -  959s
     0     0 5961.22189    0  418 -21169.118 5961.22189   128%     - 1014s
     0     0 5833.93311    0  513 -21169.118 5833.93311   128%     - 1068s
     0     0 5788.61247    0  423 -21169.118 5788.61247   127%     - 1095s
     0     0 5732.13252    0  510 -21169.118 5732.13252   127%     - 1126s
     0     0 5713.50671    0  514 -21169.118 5713.50671   127%     - 1147s
     0     0 5705.00395    0  520 -21169.118 5705.00395   127%     - 1157s
     0     0 5664.75962    0  539 -21169.118 5664.75962   127%     - 1179s
     0     0 5662.97322    0  539 -21169.118 5662.97322   127%     - 1186s
     0     0 5662.10348    0  538 -21169.118 5662.10348   127%     - 1191s
     0     0 4698.51708    0  442 -21169.118 4698.51708   122%     - 1306s
H    0     0                    -12469.20685 4698.00012   138%     - 1307s
     0     0 4535.82542    0  552 -12469.207 4535.82542   136%     - 1361s
     0     0 4474.97946    0  557 -12469.207 4474.97946   136%     - 1399s
     0     0 4384.13397    0  554 -12469.207 4384.13397   135%     - 1448s
     0     0 4335.97668    0  462 -12469.207 4335.97668   135%     - 1478s
     0     0 4308.85626    0  553 -12469.207 4308.85626   135%     - 1502s
     0     0 4270.11202    0  553 -12469.207 4270.11202   134%     - 1531s
     0     0 4260.99726    0  555 -12469.207 4260.99726   134%     - 1546s
     0     0 4257.84497    0  606 -12469.207 4257.84497   134%     - 1557s
     0     0 4251.20529    0  457 -12469.207 4251.20529   134%     - 1565s
     0     0 4250.93561    0  455 -12469.207 4250.93561   134%     - 1568s
     0     0 3955.69444    0  460 -12469.207 3955.69444   132%     - 1630s
     0     0 3894.95344    0  551 -12469.207 3894.95344   131%     - 1666s
     0     0 3868.94026    0  569 -12469.207 3868.94026   131%     - 1697s
     0     0 3854.34512    0  571 -12469.207 3854.34512   131%     - 1717s
     0     0 3844.16952    0  621 -12469.207 3844.16952   131%     - 1741s
     0     0 3836.43902    0  613 -12469.207 3836.43902   131%     - 1754s
     0     0 3833.37142    0  563 -12469.207 3833.37142   131%     - 1762s
     0     0 3822.18937    0  622 -12469.207 3822.18937   131%     - 1790s
     0     0 3808.20401    0  624 -12469.207 3808.20401   131%     - 1807s
     0     0 3790.33112    0  625 -12469.207 3790.33112   130%     - 1830s
     0     0 3788.56376    0  628 -12469.207 3788.56376   130%     - 1839s
     0     0 3787.93210    0  629 -12469.207 3787.93210   130%     - 1843s
     0     0 3701.12019    0  477 -12469.207 3701.12019   130%     - 1915s
     0     0 3666.61840    0  475 -12469.207 3666.61840   129%     - 1983s
     0     0 3651.95531    0  485 -12469.207 3651.95531   129%     - 2015s
     0     0 3636.98866    0  491 -12469.207 3636.98866   129%     - 2037s
     0     0 3635.23192    0  488 -12469.207 3635.23192   129%     - 2048s
     0     0 3632.55344    0  490 -12469.207 3632.55344   129%     - 2059s
     0     0 3629.82158    0  500 -12469.207 3629.82158   129%     - 2071s
     0     0 3627.24901    0  498 -12469.207 3627.24901   129%     - 2083s
     0     0 3621.52815    0  493 -12469.207 3621.52815   129%     - 2102s
     0     0 3619.48288    0  492 -12469.207 3619.48288   129%     - 2115s
     0     0 3612.77596    0  496 -12469.207 3612.77596   129%     - 2138s
     0     0 3609.97856    0  494 -12469.207 3609.97856   129%     - 2155s
     0     0 3609.14598    0  505 -12469.207 3609.14598   129%     - 2167s
     0     0 3515.48142    0  589 -12469.207 3515.48142   128%     - 2242s
     0     0 3502.26654    0  588 -12469.207 3502.26654   128%     - 2271s
     0     0 3480.94637    0  602 -12469.207 3480.94637   128%     - 2312s
     0     0 3476.64069    0  605 -12469.207 3476.64069   128%     - 2323s
     0     0 3474.26614    0  599 -12469.207 3474.26614   128%     - 2333s
     0     0 3471.35199    0  589 -12469.207 3471.35199   128%     - 2345s
     0     0 3470.48736    0  506 -12469.207 3470.48736   128%     - 2350s
     0     0 3443.18422    0  595 -12469.207 3443.18422   128%     - 2394s
H    0     0                    -12455.76253 3442.73868   128%     - 2400s
     0     0 3437.30106    0  519 -12455.763 3437.30106   128%     - 2408s
     0     0 3428.40404    0  508 -12455.763 3428.40404   128%     - 2426s
     0     0 3426.18483    0  513 -12455.763 3426.18483   128%     - 2432s
     0     0 3424.40347    0  519 -12455.763 3424.40347   127%     - 2436s
     0     0 3422.54939    0  510 -12455.763 3422.54939   127%     - 2440s
     0     0 3421.49281    0  507 -12455.763 3421.49281   127%     - 2442s
     0     0 3401.36803    0  511 -12455.763 3401.36803   127%     - 2471s
     0     0 3394.50444    0  514 -12455.763 3394.50444   127%     - 2483s
     0     0 3383.42492    0  515 -12455.763 3383.42492   127%     - 2502s
     0     0 3381.94275    0  606 -12455.763 3381.94275   127%     - 2514s
     0     0 3370.13713    0  517 -12455.763 3370.13713   127%     - 2534s
H    0     0                    -12435.92907 3370.10495   127%     - 2540s
     0     0 3366.32492    0  517 -12435.929 3366.32492   127%     - 2562s
     0     0 3361.48747    0  597 -12435.929 3361.48747   127%     - 2575s
     0     0 3358.48286    0  514 -12435.929 3358.48286   127%     - 2583s
     0     0 3356.12119    0  521 -12435.929 3356.12119   127%     - 2594s
     0     0 3355.31495    0  521 -12435.929 3355.31495   127%     - 2600s
     0     0 3345.67017    0  520 -12435.929 3345.67017   127%     - 2631s
     0     0 3337.46645    0  518 -12435.929 3337.46645   127%     - 2653s
     0     0 3335.49565    0  521 -12435.929 3335.49565   127%     - 2659s
     0     0 3335.08312    0  520 -12435.929 3335.08312   127%     - 2663s
     0     0 3330.18585    0  526 -12435.929 3330.18585   127%     - 2679s
H    0     0                    -12396.55784 3329.84968   127%     - 2684s
     0     0 3327.47914    0  531 -12396.558 3327.47914   127%     - 2695s
     0     0 3326.80423    0  527 -12396.558 3326.80423   127%     - 2699s
     0     0 3322.52489    0  532 -12396.558 3322.52489   127%     - 2716s
     0     0 3321.51705    0  529 -12396.558 3321.51705   127%     - 2726s
     0     0 3320.84955    0  524 -12396.558 3320.84955   127%     - 2737s
     0     0 3320.17199    0  524 -12396.558 3320.17199   127%     - 2753s
H    0     0                    -12317.02466 3320.14726   127%     - 3074s
H    0     0                    -12096.04394 3319.85456   127%     - 3292s
H    0     0                    -11082.30069 3319.85456   130%     - 3301s
H    0     0                    -10386.05994 3319.85456   132%     - 3359s
H    0     0                    -10241.18408 3319.85456   132%     - 3359s
H    0     0                    -10003.87319 3319.85456   133%     - 3359s
H    0     0                    -9995.265881 3319.85456   133%     - 3372s
H    0     0                    -9410.583598 3319.85456   135%     - 3380s
H    0     0                    -9123.980286 3319.85456   136%     - 3380s
H    0     0                    -8595.735395 3319.85456   139%     - 3392s
H    0     0                    -8279.789325 3319.85456   140%     - 3393s
H    0     0                    -8275.347492 3319.85456   140%     - 3393s
H    0     0                    -8240.766474 3319.85456   140%     - 3394s
H    0     2                    -8187.154502 3319.85456   141%     - 3405s
     0     2 3319.85456    0  524 -8187.1545 3319.85456   141%     - 3405s
     1     3 2260.87944    1  427 -8187.1545 3319.49420   141% 24851 3502s
     2     5 2122.93895    2  437 -8187.1545 3319.49420   141% 20051 3558s
     4     7 2075.67231    3  444 -8187.1545 3281.78842   140% 15319 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 141
  MIR: 2254
  Flow cover: 2092
  Zero half: 2
  RLT: 25
  Relax-and-lift: 189

Explored 6 nodes (1206228 simplex iterations) in 3600.11 seconds (4253.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8187.15 -8240.77 -8275.35 ... -10241.2

Time limit reached
Best objective -8.187154502075e+03, best bound 3.281788421063e+03, gap 140.0846%
  WARNING: Time limit reached. Using best solution found (gap: 140.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = -8187.15, θ = 120239.99
  Upper Bound (UB) = -8187.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120239.99
  [DEBUG]   ✓ Scenario 0: θ = 120239.99 ≤ Q = 120239.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120239.99 ≤ Q = 120239.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120239.99 ≤ Q = 120239.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 120239.99 ≤ Q = 120239.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 120239.99 ≤ Q = 120239.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x545bdf2a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaba420d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.381867e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6523861.2336
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.433986e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143398.61    0  125 6523861.23 -143398.61   102%     -    0s
H    0     0                    -109513.4751 -143398.61  30.9%     -    0s
H    0     0                    -110612.4276 -143398.61  29.6%     -    0s
     0     0 -128879.66    0   80 -110612.43 -128879.66  16.5%     -    0s
H    0     0                    -125044.7771 -128745.52  2.96%     -    0s
H    0     0                    -125332.8005 -128745.52  2.72%     -    0s
H    0     0                    -125656.0972 -128745.52  2.46%     -    0s
H    0     0                    -125944.1206 -128745.52  2.22%     -    0s
     0     0 -128126.26    0   77 -125944.12 -128126.26  1.73%     -    0s
     0     0 -128070.00    0   76 -125944.12 -128070.00  1.69%     -    0s
H    0     0                    -126148.2450 -128070.00  1.52%     -    0s
     0     0 -127121.79    0   58 -126148.25 -127121.79  0.77%     -    0s
     0     0 -127013.09    0   55 -126148.25 -127013.09  0.69%     -    0s
     0     0 -127013.09    0   57 -126148.25 -127013.09  0.69%     -    0s
     0     0 -126753.17    0   21 -126148.25 -126753.17  0.48%     -    0s
     0     0 -126708.38    0   22 -126148.25 -126708.38  0.44%     -    0s
     0     0 -126519.42    0   21 -126148.25 -126519.42  0.29%     -    0s
     0     0 -126495.22    0   21 -126148.25 -126495.22  0.28%     -    0s
     0     0 -126457.07    0   21 -126148.25 -126457.07  0.24%     -    0s
     0     0 -126450.02    0   21 -126148.25 -126450.02  0.24%     -    0s
H    0     0                    -126176.7029 -126450.02  0.22%     -    0s
     0     0 -126450.02    0   42 -126176.70 -126450.02  0.22%     -    0s
     0     0 -126360.83    0   19 -126176.70 -126360.83  0.15%     -    0s
     0     0 -126335.93    0   19 -126176.70 -126335.93  0.13%     -    0s
     0     0 -126318.92    0   19 -126176.70 -126318.92  0.11%     -    0s
     0     0 -126307.30    0   19 -126176.70 -126307.30  0.10%     -    0s
     0     0 -126299.28    0   19 -126176.70 -126299.28  0.10%     -    0s
     0     0 -126293.41    0   19 -126176.70 -126293.41  0.09%     -    0s
     0     0 -126289.12    0   19 -126176.70 -126289.12  0.09%     -    0s
     0     0 -126285.97    0   19 -126176.70 -126285.97  0.09%     -    0s
     0     0 -126283.68    0   19 -126176.70 -126283.68  0.08%     -    0s
     0     0 -126281.99    0   19 -126176.70 -126281.99  0.08%     -    0s
     0     0 -126260.21    0   15 -126176.70 -126260.21  0.07%     -    0s
     0     0 -126259.97    0   14 -126176.70 -126259.97  0.07%     -    0s
     0     0 -126185.04    0    5 -126176.70 -126185.04  0.01%     -    0s
     0     0 -126178.91    0    4 -126176.70 -126178.91  0.00%     -    0s
     0     0 -126178.32    0    2 -126176.70 -126178.32  0.00%     -    0s

Explored 1 nodes (1021 simplex iterations) in 0.25 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -126177 -126175 -126148 ... 1.38187e+13
No other solutions better than -126177

Optimal solution found (tolerance 1.00e-06)
Best objective -1.261767028700e+05, best bound -1.261767028700e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 106143.10
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126176.70
  [DEBUG]   S×d_nominal = 232319.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232319.80 + -126176.70 = 106143.10
  [DEBUG]   Current θ from Master = 120239.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14096.89 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22284.05
  Lower Bound (LB) = -8117.39
  Gap (UB-LB) = -69.7650, Absolute Gap = 69.7650, Relative Gap = -0.008521
  *** CONVERGED (small negative gap: -69.77 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 25
Total Time: 72621.41s
Converged: True
Final Lower Bound: -8117.3895
Final Upper Bound: -8187.1545
Final Gap: -69.765006
Number of Critical Scenarios: 25
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 6, 7] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 9 customers  Mode 2: 40 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 25
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-04 05:55:46
Total Time: 72621.41s
Optimal Value: -8117.39
Lower Bound: -8117.39
Upper Bound: -8187.15
Gap: -69.765006
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [3, 6, 7] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed14_LD_gamma20_20260104_055546.csv

Total Execution Time: 72621.66 seconds
End Time: 2026-01-04 05:55:46

All tasks completed successfully!

