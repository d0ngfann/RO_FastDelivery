
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 12
DI Scenario: LD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed12.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.091', '1.191'] (k=0.215)
  Product 1: ['1.000', '1.071', '1.147'] (k=0.169)
  Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=928, max=1669
  DC capacity (MC): min=444, max=839

Demand Structure (s_rk matrix):
  Total customer-product pairs: 79/150 (47.3% sparse)
  Average products per customer: 1.58

Demand (only non-zero entries):
  Nominal (μ): min=8.02, max=34.77, count=79
  Deviation (μ̂): min=4.04, max=9.89

Costs:
  Plant fixed cost: min=5855, max=8988
  DC fixed cost: min=3255, max=5629
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.459', '2.127'] (k=0.931)
    Product 2: ['1.000', '1.356', '1.838'] (k=0.751)
  MD:
    Product 0: ['1.000', '1.275', '1.626'] (k=0.599)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.235', '1.525'] (k=0.521)
  LD:
    Product 0: ['1.000', '1.091', '1.191'] (k=0.215)
    Product 1: ['1.000', '1.071', '1.147'] (k=0.169)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
  Mixed:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48747 nonzeros
Model fingerprint: 0xb8338793
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11912 rows and 2912 columns
Presolve time: 0.12s
Presolved: 4761 rows, 5588 columns, 33115 nonzeros
Variable types: 3329 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -319441.8198
Found heuristic solution: objective -185355.3570

Root relaxation: objective 5.169904e+04, 4488 iterations, 0.20 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51699.0398    0  602 -185355.36 51699.0398   128%     -    0s
H    0     0                    -183348.2604 51699.0398   128%     -    0s
     0     0 48516.9264    0  739 -183348.26 48516.9264   126%     -    0s
     0     0 48337.9297    0  739 -183348.26 48337.9297   126%     -    0s
H    0     0                    -155578.0691 48313.7990   131%     -    0s
     0     0 48313.7990    0  742 -155578.07 48313.7990   131%     -    0s
     0     0 48313.1862    0  743 -155578.07 48313.1862   131%     -    0s
     0     0 43785.0534    0 1014 -155578.07 43785.0534   128%     -    1s
H    0     0                    -110812.2153 43785.0534   140%     -    1s
     0     0 43151.3413    0 1013 -110812.22 43151.3413   139%     -    2s
     0     0 42691.4091    0 1022 -110812.22 42691.4091   139%     -    2s
     0     0 42691.4091    0 1025 -110812.22 42691.4091   139%     -    2s
     0     0 42691.4091    0 1028 -110812.22 42691.4091   139%     -    2s
H    0     0                    -106048.7656 39300.5795   137%     -    4s
H    0     0                    -102892.4145 39300.5795   138%     -    4s
H    0     0                    -40802.51956 39300.5795   196%     -    4s
H    0     0                    -27897.50233 39300.5795   241%     -    4s
H    0     0                    -27890.62214 39300.5795   241%     -    4s
     0     0 39300.5795    0 1113 -27890.622 39300.5795   241%     -    4s
     0     0 39249.7464    0 1113 -27890.622 39249.7464   241%     -    4s
     0     2 39249.7464    0 1113 -27890.622 39249.7464   241%     -    5s
    31    64 36179.5489    5  751 -27890.622 36883.8819   232%  2181   10s
H   42    64                    -27733.60230 36883.8819   233%  1876   10s
H   95   212                    -27353.25067 36175.0283   232%  1372   12s
H  144   212                    -27260.46285 36175.0283   233%  1140   12s
H  332   349                    -21369.63325 36175.0283   269%   705   13s
H  338   349                    -19953.54144 36175.0283   281%   702   13s
H  345   349                    -13136.38127 36175.0283   375%   689   13s
H  475   485                    -13117.51496 36175.0283   376%   591   14s
H  479   485                    -3957.063152 36175.0283  1014%   589   14s
H  489   577                    -3940.358774 36175.0283  1018%   579   14s
H  512   577                    -3925.836767 36175.0283  1021%   566   14s
H  526   577                    -3919.048692 36175.0283  1023%   561   14s
H  693   779                    -3806.797929 36175.0283  1050%   467   15s
H  894   967                    -3671.330729 36175.0283  1085%   412   16s
H  944   967                    -3642.217176 36175.0283  1093%   406   16s
H 1099  1131                    -3640.104343 35726.4742  1081%   381   17s
H 1328  1255                    -3537.845829 35584.8406  1106%   365   18s
H 1329  1255                    -455.8683734 35584.8406  7906%   364   18s
H 1337  1362                    -117.9042005 35584.8406      -   363   19s
H 1342  1362                     235.7912963 35584.8406      -   363   19s
H 1350  1362                     344.6648995 35584.8406      -   362   19s
H 1376  1362                     519.0798477 35584.8406  6755%   361   19s
H 1424  1362                    1207.0563012 35584.8406  2848%   355   19s
H 1489  1362                    2810.4908229 35584.8406  1166%   344   19s
  1656  1582 29471.7648    8  619 2810.49082 32175.9711  1045%   328   20s
H 1657  1582                    3418.5234525 32175.9711   841%   328   20s
H 1687  1582                    3844.1034161 32175.9711   737%   326   20s
H 1955  1751                    4038.0718177 32073.6379   694%   309   20s
H 2023  1751                    7563.0024167 32073.6379   324%   304   20s
H 2221  1776                    7598.3286056 31968.8664   321%   307   22s
H 2223  1776                    7601.0465530 31968.8664   321%   307   22s
H 2458  1836                    7615.5066926 31968.8664   320%   306   23s
H 2525  1836                    7628.8897997 31968.8664   319%   302   23s
H 2601  1836                    7629.6360871 31968.8664   319%   301   23s
H 2836  1922                    7629.6986017 31968.8664   319%   294   24s
H 2875  1922                    7642.9741846 31968.8664   318%   294   24s
H 2953  1922                    7642.9871600 31968.8664   318%   293   24s
H 2976  1922                    7643.0496745 31968.8664   318%   292   24s
  3005  2041 26612.6985   10  525 7643.04967 31968.8664   318%   292   25s
  4032  2540 12706.8592   35 1113 7643.04967 30515.8583   299%   292   46s
  4039  2545 9472.30580   52  490 7643.04967 14721.0372  92.6%   291   50s
  4053  2554 13586.8304   16  497 7643.04967 13586.8304  77.8%   290   57s
  4140  2555 10317.5025   17  361 7643.04967 11604.1648  51.8%   298   60s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  Projected implied bound: 158
  MIR: 203
  Flow cover: 339
  Zero half: 5
  RLT: 48
  Relax-and-lift: 109

Explored 4427 nodes (1279359 simplex iterations) in 63.22 seconds (82.32 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 7643.05 7629.7 7628.89 ... 2810.49

Optimal solution found (tolerance 1.00e-06)
Best objective 7.643049674510e+03, best bound 7.643049674510e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 63.22s
  Master Objective (UB) = 7643.05, θ = 125928.32
  Upper Bound (UB) = 7643.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 125928.32
  [DEBUG]   ✓ Scenario 0: θ = 125928.32 ≤ Q = 125928.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5957d039
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa6a82fc7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7954414.5585
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.036362e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -103636.23    0  121 7954414.56 -103636.23   101%     -    0s
H    0     0                    -71113.30984 -103636.23  45.7%     -    0s
H    0     0                    -71587.35376 -103636.23  44.8%     -    0s
H    0     0                    -74167.40169 -74167.402  0.00%     -    0s
     0     0          -    0      -74167.402 -74167.402  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 200

Explored 1 nodes (359 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -74167.4 -71587.4 -71113.3 ... 1.46279e+13
No other solutions better than -74167.4

Optimal solution found (tolerance 1.00e-06)
Best objective -7.416740169073e+04, best bound -7.416740169073e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 90071.52
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -74167.40
  [DEBUG]   S×d_nominal = 164238.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 164238.93 + -74167.40 = 90071.52
  [DEBUG]   Current θ from Master = 125928.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 35856.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28213.75
  Lower Bound (LB) = -28213.75
  Gap (UB-LB) = 35856.7954, Absolute Gap = 35856.7954, Relative Gap = 4.691425
  Not converged yet (gap = 35856.80 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91975 nonzeros
Model fingerprint: 0xfd350239
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -28213.7 (0.02s)
Loaded MIP start from previous solve with objective -28213.7

Presolve removed 14403 rows and 5842 columns
Presolve time: 0.50s
Presolved: 17560 rows, 8898 columns, 97148 nonzeros
Variable types: 6639 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.730968e+03, 10563 iterations, 2.53 seconds (3.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2730.96837    0  592 -28213.746 2730.96837   110%     -    3s
H    0     0                    -23650.41326 2730.96837   112%     -    3s
H    0     0                    -23557.83474 2730.96837   112%     -    3s
     0     0 -6125.3558    0  736 -23557.835 -6125.3558  74.0%     -    6s
     0     0 -6262.6099    0  745 -23557.835 -6262.6099  73.4%     -    7s
     0     0 -6266.0359    0  749 -23557.835 -6266.0359  73.4%     -    7s
     0     0 -6267.4351    0  750 -23557.835 -6267.4351  73.4%     -    7s
     0     0 -9989.1493    0  704 -23557.835 -9989.1493  57.6%     -   11s
H    0     0                    -22855.95369 -9990.5481  56.3%     -   11s
H    0     0                    -22845.78791 -9990.5481  56.3%     -   11s
H    0     0                    -22599.68710 -10373.863  54.1%     -   11s
     0     0 -10373.863    0  786 -22599.687 -10373.863  54.1%     -   12s
H    0     0                    -22463.92911 -10387.519  53.8%     -   12s
H    0     0                    -22195.41910 -10387.519  53.2%     -   12s
     0     0 -10387.519    0  787 -22195.419 -10387.519  53.2%     -   12s
     0     0 -10389.183    0  788 -22195.419 -10389.183  53.2%     -   12s
H    0     0                    -22136.50652 -12693.387  42.7%     -   17s
H    0     0                    -21464.15324 -12693.387  40.9%     -   17s
H    0     0                    -20219.50679 -12693.387  37.2%     -   17s
H    0     0                    -20208.62931 -12693.387  37.2%     -   17s
H    0     0                    -20184.25592 -12693.387  37.1%     -   17s
H    0     0                    -20177.80783 -12693.387  37.1%     -   17s
     0     0 -12693.387    0  758 -20177.808 -12693.387  37.1%     -   17s
H    0     0                    -19732.01833 -12694.448  35.7%     -   17s
H    0     0                    -19724.90076 -12694.448  35.6%     -   17s
H    0     0                    -19722.55659 -12694.448  35.6%     -   17s
H    0     0                    -19689.55533 -12694.448  35.5%     -   17s
H    0     0                    -19681.91960 -12694.448  35.5%     -   17s
H    0     0                    -19661.10156 -13250.901  32.6%     -   19s
H    0     0                    -19653.95428 -13250.901  32.6%     -   19s
H    0     0                    -19649.51098 -13250.901  32.6%     -   19s
H    0     0                    -19649.30357 -13250.901  32.6%     -   19s
     0     0 -13250.901    0  861 -19649.304 -13250.901  32.6%     -   19s
     0     0 -13346.223    0  923 -19649.304 -13346.223  32.1%     -   20s
     0     0 -13356.018    0  942 -19649.304 -13356.018  32.0%     -   20s
     0     0 -13357.108    0  946 -19649.304 -13357.108  32.0%     -   20s
     0     0 -14226.235    0  591 -19649.304 -14226.235  27.6%     -   25s
H    0     0                    -19630.28647 -14226.660  27.5%     -   26s
H    0     0                    -19502.85979 -14226.660  27.1%     -   26s
     0     0 -14357.896    0  613 -19502.860 -14357.896  26.4%     -   27s
     0     0 -14400.854    0  722 -19502.860 -14400.854  26.2%     -   27s
     0     0 -14431.474    0  723 -19502.860 -14431.474  26.0%     -   28s
     0     0 -14439.949    0  628 -19502.860 -14439.949  26.0%     -   28s
     0     0 -14442.368    0  625 -19502.860 -14442.368  25.9%     -   28s
H    0     0                    -19330.67078 -14823.568  23.3%     -   30s
H    0     0                    -19315.78293 -14823.568  23.3%     -   30s
H    0     0                    -19301.36880 -14823.568  23.2%     -   30s
H    0     0                    -19278.33346 -14823.568  23.1%     -   30s
H    0     0                    -19257.10263 -14823.568  23.0%     -   30s
H    0     0                    -19257.06495 -14823.568  23.0%     -   30s
H    0     0                    -19254.93655 -14823.568  23.0%     -   30s
     0     0 -14823.568    0  714 -19254.937 -14823.568  23.0%     -   30s
H    0     0                    -19234.03326 -14824.997  22.9%     -   30s
H    0     0                    -19136.38459 -14824.997  22.5%     -   31s
H    0     0                    -19123.00552 -14824.997  22.5%     -   31s
H    0     0                    -19121.35896 -14824.997  22.5%     -   31s
     0     0 -14880.068    0  741 -19121.359 -14880.068  22.2%     -   32s
     0     0 -14901.163    0  740 -19121.359 -14901.163  22.1%     -   32s
     0     0 -14905.880    0  827 -19121.359 -14905.880  22.0%     -   33s
     0     0 -14953.051    0  624 -19121.359 -14953.051  21.8%     -   34s
H    0     0                    -19118.00529 -14953.058  21.8%     -   36s
H    0     0                    -19112.96414 -14953.058  21.8%     -   36s
H    0     0                    -19112.56076 -14953.058  21.8%     -   36s
H    0     0                    -19112.33396 -14953.058  21.8%     -   36s
H    0     0                    -19105.08375 -14953.058  21.7%     -   36s
H    0     0                    -19104.83638 -14953.058  21.7%     -   36s
     0     0 -14971.646    0  624 -19104.836 -14971.646  21.6%     -   36s
     0     0 -14979.643    0  627 -19104.836 -14979.643  21.6%     -   36s
     0     0 -14983.420    0  637 -19104.836 -14983.420  21.6%     -   37s
     0     0 -15019.616    0  607 -19104.836 -15019.616  21.4%     -   38s
     0     0 -15031.213    0  602 -19104.836 -15031.213  21.3%     -   38s
     0     0 -15033.405    0  600 -19104.836 -15033.405  21.3%     -   38s
     0     0 -15045.837    0  609 -19104.836 -15045.837  21.2%     -   39s
     0     0 -15046.482    0  609 -19104.836 -15046.482  21.2%     -   40s
H    0     0                    -19091.26262 -15046.531  21.2%     -   41s
H    0     0                    -19089.55588 -15046.531  21.2%     -   41s
H    0     0                    -19084.34245 -15046.531  21.2%     -   41s
H    0     2                    -19081.20663 -15046.531  21.1%     -   50s
     0     2 -15046.531    0  609 -19081.207 -15046.531  21.1%     -   50s
    15    22 -16546.668    4  432 -19081.207 -15635.086  18.1%  1093   55s
   246    56 -18383.164    9  310 -19081.207 -17327.565  9.19%   396   60s
H  308   109                    -19078.69947 -17428.009  8.65%   372   61s
  1341   317 -18779.079   19   99 -19078.699 -17641.374  7.53%   166   65s
H 6046  1054                    -19076.39855 -19000.477  0.40%  60.6   69s
H 6761  1046                    -19074.28846 -19013.273  0.32%  55.2   69s
  6815  1109 -19057.284   37   45 -19074.288 -19015.080  0.31%  54.9   70s

Cutting planes:
  Gomory: 8
  Implied bound: 5
  MIR: 2038
  Flow cover: 1075
  Zero half: 13
  RLT: 87
  Relax-and-lift: 324

Explored 10834 nodes (456681 simplex iterations) in 72.08 seconds (95.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19074.3 -19076.4 -19078.7 ... -19112.3
No other solutions better than -19074.3

Optimal solution found (tolerance 1.00e-06)
Best objective -1.907428845907e+04, best bound -1.907428845907e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 72.09s
  Master Objective (UB) = -19074.29, θ = 93283.31
  Upper Bound (UB) = -19074.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93283.31
  [DEBUG]   ✓ Scenario 0: θ = 93283.31 ≤ Q = 93283.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93283.31 ≤ Q = 93283.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5687a661
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5687a661
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.344504e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 6862872.6152
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.182249e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118224.94    0  127 6862872.62 -118224.94   102%     -    0s
H    0     0                    -78250.80123 -118224.94  51.1%     -    0s
H    0     0                    -79035.38585 -118224.94  49.6%     -    0s
H    0     0                    -103405.0877 -118224.94  14.3%     -    0s
     0     0 -106462.61    0  115 -103405.09 -106462.61  2.96%     -    0s
H    0     0                    -105166.3775 -106422.90  1.19%     -    0s
     0     0 -106274.03    0  115 -105166.38 -106274.03  1.05%     -    0s
     0     0 -106266.86    0  115 -105166.38 -106266.86  1.05%     -    0s
     0     0 -106132.81    0   76 -105166.38 -106132.81  0.92%     -    0s
     0     0 -106029.89    0   80 -105166.38 -106029.89  0.82%     -    0s
     0     0 -106029.89    0   79 -105166.38 -106029.89  0.82%     -    0s
H    0     0                    -105703.4338 -106029.89  0.31%     -    0s
     0     0 -106029.89    0   58 -105703.43 -106029.89  0.31%     -    0s
     0     0 -106029.89    0   55 -105703.43 -106029.89  0.31%     -    0s
     0     0 -106016.61    0   39 -105703.43 -106016.61  0.30%     -    0s
     0     0 -105990.45    0   32 -105703.43 -105990.45  0.27%     -    0s
     0     0 -105978.72    0   30 -105703.43 -105978.72  0.26%     -    0s
H    0     0                    -105722.2610 -105946.24  0.21%     -    0s
     0     0 -105946.24    0   36 -105722.26 -105946.24  0.21%     -    0s
     0     0 -105920.88    0   32 -105722.26 -105920.88  0.19%     -    0s
     0     0 -105907.85    0   29 -105722.26 -105907.85  0.18%     -    0s
     0     0 -105885.19    0   28 -105722.26 -105885.19  0.15%     -    0s
     0     0 -105836.08    0   26 -105722.26 -105836.08  0.11%     -    0s
     0     0 -105781.18    0   19 -105722.26 -105781.18  0.06%     -    0s
     0     0 -105760.31    0    7 -105722.26 -105760.31  0.04%     -    0s
     0     0 -105759.73    0    6 -105722.26 -105759.73  0.04%     -    0s
     0     0 -105731.20    0    2 -105722.26 -105731.20  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 1
  MIR: 87
  Flow cover: 4
  RLT: 61
  BQP: 1

Explored 1 nodes (690 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -105722 -103405 -79035.4 ... 1.3445e+13
No other solutions better than -105722

Optimal solution found (tolerance 1.00e-06)
Best objective -1.057222610467e+05, best bound -1.057222610467e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 70286.81
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105722.26
  [DEBUG]   S×d_nominal = 176009.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 176009.07 + -105722.26 = 70286.81
  [DEBUG]   Current θ from Master = 93283.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22996.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -42070.79
  Lower Bound (LB) = -28213.75
  Gap (UB-LB) = 9139.4573, Absolute Gap = 9139.4573, Relative Gap = 0.479151
  Not converged yet (gap = 9139.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135203 nonzeros
Model fingerprint: 0xa7c02e50
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -42070.8 (0.03s)
Loaded MIP start from previous solve with objective -42070.8

Presolve removed 21573 rows and 8753 columns
Presolve time: 0.66s
Presolved: 25680 rows, 12227 columns, 143584 nonzeros
Variable types: 9968 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24901    1.6505620e+02   0.000000e+00   6.056565e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   18036    1.1357317e+03   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.135732e+03, 18036 iterations, 6.50 seconds (8.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1135.73169    0  569 -42070.785 1135.73169   103%     -    7s
H    0     0                    -41928.85877 1135.73169   103%     -    7s
H    0     0                    -41144.65865 1135.73169   103%     -    7s
H    0     0                    -35244.34522 1135.73169   103%     -    8s
H    0     0                    -35230.04424 1135.73169   103%     -    8s
H    0     0                    -35226.87777 1135.73169   103%     -    8s
H    0     0                    -35027.88648 1135.73169   103%     -    8s
H    0     0                    -34824.81026 1135.73169   103%     -    8s
H    0     0                    -34822.56336 1135.73169   103%     -    8s
H    0     0                    -34816.42002 1135.73169   103%     -    8s
H    0     0                    -34777.33135 1135.73169   103%     -    8s
     0     0 -7829.1580    0  857 -34777.331 -7829.1580  77.5%     -   13s
H    0     0                    -34769.62147 -7830.9193  77.5%     -   14s
H    0     0                    -34766.86725 -7830.9193  77.5%     -   14s
     0     0 -8188.3465    0  877 -34766.867 -8188.3465  76.4%     -   15s
     0     0 -8194.1782    0  874 -34766.867 -8194.1782  76.4%     -   15s
     0     0 -8198.7616    0  869 -34766.867 -8198.7616  76.4%     -   16s
     0     0 -8199.2020    0  865 -34766.867 -8199.2020  76.4%     -   16s
H    0     0                    -31204.03939 -12247.969  60.7%     -   22s
H    0     0                    -31008.89911 -12247.969  60.5%     -   22s
H    0     0                    -30300.44896 -12247.969  59.6%     -   22s
H    0     0                    -30291.67178 -12247.969  59.6%     -   22s
     0     0 -12247.969    0  739 -30291.672 -12247.969  59.6%     -   22s
H    0     0                    -26380.74708 -12249.363  53.6%     -   23s
H    0     0                    -26360.59769 -12249.363  53.5%     -   23s
H    0     0                    -26336.44413 -12249.363  53.5%     -   23s
H    0     0                    -26287.45400 -12249.363  53.4%     -   23s
     0     0 -13031.139    0  821 -26287.454 -13031.139  50.4%     -   25s
     0     0 -13114.465    0  752 -26287.454 -13114.465  50.1%     -   26s
     0     0 -13152.268    0  766 -26287.454 -13152.268  50.0%     -   27s
     0     0 -13167.687    0  765 -26287.454 -13167.687  49.9%     -   28s
     0     0 -13192.074    0  756 -26287.454 -13192.074  49.8%     -   28s
     0     0 -13193.699    0  752 -26287.454 -13193.699  49.8%     -   28s
H    0     0                    -25757.11718 -15157.736  41.2%     -   38s
H    0     0                    -25733.84516 -15157.736  41.1%     -   38s
H    0     0                    -23466.23434 -15157.736  35.4%     -   38s
H    0     0                    -23393.85108 -15157.736  35.2%     -   38s
H    0     0                    -23342.80141 -15157.736  35.1%     -   38s
H    0     0                    -23324.90095 -15157.736  35.0%     -   38s
H    0     0                    -23321.30891 -15157.736  35.0%     -   38s
H    0     0                    -23318.49501 -15157.736  35.0%     -   38s
H    0     0                    -23309.99113 -15157.736  35.0%     -   38s
H    0     0                    -23286.59705 -15157.736  34.9%     -   38s
H    0     0                    -23276.10150 -15157.736  34.9%     -   38s
H    0     0                    -23265.93572 -15157.736  34.9%     -   38s
     0     0 -15157.736    0  758 -23265.936 -15157.736  34.9%     -   38s
H    0     0                    -23230.48594 -15668.241  32.6%     -   41s
H    0     0                    -23226.42524 -15668.241  32.5%     -   41s
     0     0 -15668.241    0  872 -23226.425 -15668.241  32.5%     -   41s
H    0     0                    -23225.26679 -15811.644  31.9%     -   43s
H    0     0                    -23221.73370 -15811.644  31.9%     -   43s
H    0     0                    -23221.24921 -15811.644  31.9%     -   43s
     0     0 -15811.644    0  976 -23221.249 -15811.644  31.9%     -   43s
     0     0 -15836.684    0  970 -23221.249 -15836.684  31.8%     -   44s
     0     0 -15844.755    0  982 -23221.249 -15844.755  31.8%     -   46s
     0     0 -15845.624    0  980 -23221.249 -15845.624  31.8%     -   46s
H    0     0                    -23208.02091 -16766.616  27.8%     -   57s
     0     0 -16766.616    0  633 -23208.021 -16766.616  27.8%     -   57s
     0     0 -17170.407    0  654 -23208.021 -17170.407  26.0%     -   61s
     0     0 -17392.121    0  668 -23208.021 -17392.121  25.1%     -   64s
     0     0 -17442.643    0  659 -23208.021 -17442.643  24.8%     -   65s
     0     0 -17459.145    0  661 -23208.021 -17459.145  24.8%     -   67s
     0     0 -17463.761    0  663 -23208.021 -17463.761  24.8%     -   67s
     0     0 -17623.267    0  523 -23208.021 -17623.267  24.1%     -   71s
     0     0 -17696.637    0  633 -23208.021 -17696.637  23.7%     -   74s
     0     0 -17724.434    0  628 -23208.021 -17724.434  23.6%     -   75s
     0     0 -17735.894    0  647 -23208.021 -17735.894  23.6%     -   76s
     0     0 -17741.630    0  646 -23208.021 -17741.630  23.6%     -   77s
     0     0 -17875.873    0  637 -23208.021 -17875.873  23.0%     -   81s
     0     0 -17919.303    0  643 -23208.021 -17919.303  22.8%     -   83s
     0     0 -17937.154    0  652 -23208.021 -17937.154  22.7%     -   84s
     0     0 -17940.021    0  652 -23208.021 -17940.021  22.7%     -   85s
     0     0 -17964.831    0  562 -23208.021 -17964.831  22.6%     -   87s
     0     0 -17973.348    0  764 -23208.021 -17973.348  22.6%     -   88s
     0     0 -17975.923    0  637 -23208.021 -17975.923  22.5%     -   89s
     0     0 -18001.506    0  659 -23208.021 -18001.506  22.4%     -   91s
     0     0 -18010.835    0  652 -23208.021 -18010.835  22.4%     -   92s
     0     0 -18011.982    0  660 -23208.021 -18011.982  22.4%     -   93s
     0     0 -18024.259    0  650 -23208.021 -18024.259  22.3%     -   94s
     0     0 -18024.960    0  650 -23208.021 -18024.960  22.3%     -   95s
     0     2 -18024.960    0  650 -23208.021 -18024.960  22.3%     -  113s
     1     4 -18125.972    1  564 -23208.021 -18024.960  22.3%  1888  117s
     7    16 -18556.964    3  573 -23208.021 -18344.341  21.0%  2735  122s
    15    28 -18644.178    4  575 -23208.021 -18557.057  20.0%  2501  125s
    59    68 -20699.656    6  505 -23208.021 -19025.533  18.0%  2471  132s
    91    94 -21381.001    7  474 -23208.021 -19134.538  17.6%  2480  136s
   127   135 -21509.875    8  456 -23208.021 -19161.402  17.4%  2386  142s
   200   158 -21710.383   11  359 -23208.021 -19161.402  17.4%  2030  147s
   303   177     cutoff   13      -23208.021 -19161.402  17.4%  1657  153s
   394   219 -20262.342    9  409 -23208.021 -19161.402  17.4%  1525  156s
   482   250 -21054.344   11  242 -23208.021 -19582.454  15.6%  1473  162s
   691   345 -21091.611   20  146 -23208.021 -19607.223  15.5%  1250  167s
   896   437 -22795.728   26   95 -23208.021 -19607.223  15.5%  1089  173s
  1028   466 -22378.506   14  279 -23208.021 -19759.491  14.9%  1000  176s
  1327   527 -22395.668   12  277 -23208.021 -20326.183  12.4%   857  183s
  1474   590 -22443.843   13  273 -23208.021 -20326.183  12.4%   820  185s
  1878   701 -22936.721   16  321 -23208.021 -20326.183  12.4%   708  191s
  2320   771     cutoff   18      -23208.021 -20558.746  11.4%   630  197s
  2781   839     cutoff   12      -23208.021 -20776.291  10.5%   578  202s
  3237   842 -22026.816   14  108 -23208.021 -20979.079  9.60%   543  210s
  3695   749 -23073.614   11  112 -23208.021 -21703.152  6.48%   526  216s
  4301   618     cutoff   20      -23208.021 -22225.443  4.23%   493  220s
  5416   185     cutoff   20      -23208.021 -22635.158  2.47%   425  226s

Cutting planes:
  Learned: 1
  Gomory: 9
  Cover: 1
  Implied bound: 9
  MIR: 2478
  Flow cover: 1577
  Zero half: 3
  RLT: 153
  Relax-and-lift: 515

Explored 9583 nodes (2544615 simplex iterations) in 229.16 seconds (326.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23208 -23221.2 -23221.7 ... -23310
No other solutions better than -23208

Optimal solution found (tolerance 1.00e-06)
Best objective -2.320802090732e+04, best bound -2.320802090732e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 229.18s
  Master Objective (UB) = -23208.02, θ = 95278.55
  Upper Bound (UB) = -23208.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95278.55
  [DEBUG]   ✓ Scenario 0: θ = 95278.55 ≤ Q = 95278.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95278.55 ≤ Q = 95278.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95278.55 ≤ Q = 95278.55 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x78d70853
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x78d70853
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7726070.6432
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.101686e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110168.64    0  121 7726070.64 -110168.64   101%     -    0s
H    0     0                    -77361.56380 -110168.64  42.4%     -    0s
H    0     0                    -77764.26696 -110168.64  41.7%     -    0s
     0     0 -88825.200    0   59 -77764.267 -88825.200  14.2%     -    0s
H    0     0                    -85590.41112 -88692.701  3.62%     -    0s
H    0     0                    -85980.37846 -88692.701  3.15%     -    0s
H    0     0                    -86633.28597 -88692.701  2.38%     -    0s
H    0     0                    -87023.25331 -88692.701  1.92%     -    0s
     0     0 -88078.658    0   36 -87023.253 -88078.658  1.21%     -    0s
H    0     0                    -87125.64854 -88020.579  1.03%     -    0s
     0     0 -87700.448    0   27 -87125.649 -87700.448  0.66%     -    0s
H    0     0                    -87277.26126 -87700.448  0.48%     -    0s
     0     0 -87592.239    0   17 -87277.261 -87592.239  0.36%     -    0s
     0     0 -87556.238    0   26 -87277.261 -87556.238  0.32%     -    0s
     0     0 -87510.716    0   21 -87277.261 -87510.716  0.27%     -    0s
     0     0 -87508.238    0   23 -87277.261 -87508.238  0.26%     -    0s
     0     0 -87358.862    0   15 -87277.261 -87358.862  0.09%     -    0s
     0     0 -87358.862    0    9 -87277.261 -87358.862  0.09%     -    0s
     0     0 -87289.904    0    9 -87277.261 -87289.904  0.01%     -    0s
*    0     0               0    -87282.51593 -87282.516  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 4
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (642 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -87282.5 -87277.3 -87217.9 ... 1.46171e+13
No other solutions better than -87282.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.728251593315e+04, best bound -8.728251593315e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 88107.27
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87282.52
  [DEBUG]   S×d_nominal = 175389.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175389.79 + -87282.52 = 88107.27
  [DEBUG]   Current θ from Master = 95278.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7171.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30379.30
  Lower Bound (LB) = -28213.75
  Gap (UB-LB) = 5005.7248, Absolute Gap = 5005.7248, Relative Gap = 0.215689
  Not converged yet (gap = 5005.72 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178431 nonzeros
Model fingerprint: 0x2a105bc0
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -30379.3 (0.07s)
Loaded MIP start from previous solve with objective -30379.3

Presolve removed 28744 rows and 11674 columns
Presolve time: 1.14s
Presolved: 33799 rows, 15546 columns, 208839 nonzeros
Variable types: 13287 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33799 rows, 15546 columns, 208839 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32857   -2.9422737e+04   0.000000e+00   6.077636e+05      5s
   43205   -1.9771606e+04   0.000000e+00   7.263937e+05     10s
Concurrent spin time: 0.83s

Solved with dual simplex

Root relaxation: objective -1.016395e+04, 21177 iterations, 10.05 seconds (13.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10163.950    0  446 -30379.301 -10163.950  66.5%     -   11s
H    0     0                    -25074.69264 -10163.950  59.5%     -   11s
H    0     0                    -23535.72623 -10163.950  56.8%     -   11s
H    0     0                    -23523.74700 -10163.950  56.8%     -   11s
H    0     0                    -23490.66153 -10163.950  56.7%     -   13s
H    0     0                    -23482.89975 -10163.950  56.7%     -   13s
H    0     0                    -23480.49576 -10163.950  56.7%     -   13s
     0     0 -13928.644    0  192 -23480.496 -13928.644  40.7%     -   21s
     0     0 -14719.808    0  458 -23480.496 -14719.808  37.3%     -   24s
     0     0 -15704.270    0  488 -23480.496 -15704.270  33.1%     -   28s
     0     0 -15704.270    0  498 -23480.496 -15704.270  33.1%     -   29s
     0     0 -15704.270    0  500 -23480.496 -15704.270  33.1%     -   30s
     0     0 -15704.270    0  505 -23480.496 -15704.270  33.1%     -   30s
     0     0 -15704.270    0  505 -23480.496 -15704.270  33.1%     -   30s
     0     0 -15716.618    0  434 -23480.496 -15716.618  33.1%     -   35s
     0     0 -15936.904    0  463 -23480.496 -15936.904  32.1%     -   37s
     0     0 -15968.573    0  444 -23480.496 -15968.573  32.0%     -   38s
     0     0 -16001.227    0  526 -23480.496 -16001.227  31.9%     -   39s
     0     0 -16011.468    0  525 -23480.496 -16011.468  31.8%     -   40s
     0     0 -16011.491    0  530 -23480.496 -16011.491  31.8%     -   40s
     0     0 -16787.299    0  551 -23480.496 -16787.299  28.5%     -   49s
     0     0 -16989.583    0  571 -23480.496 -16989.583  27.6%     -   52s
     0     0 -17034.399    0  562 -23480.496 -17034.399  27.5%     -   54s
     0     0 -17062.923    0  567 -23480.496 -17062.923  27.3%     -   55s
     0     0 -17073.912    0  570 -23480.496 -17073.912  27.3%     -   56s
     0     0 -17085.218    0  565 -23480.496 -17085.218  27.2%     -   56s
     0     0 -17090.430    0  571 -23480.496 -17090.430  27.2%     -   57s
     0     0 -17092.895    0  577 -23480.496 -17092.895  27.2%     -   57s
     0     0 -17094.896    0  576 -23480.496 -17094.896  27.2%     -   58s
     0     0 -17094.896    0  576 -23480.496 -17094.896  27.2%     -   58s
     0     0 -17478.344    0  620 -23480.496 -17478.344  25.6%     -   65s
     0     0 -17570.580    0  506 -23480.496 -17570.580  25.2%     -   67s
     0     0 -17661.724    0  588 -23480.496 -17661.724  24.8%     -   69s
     0     0 -17694.127    0  606 -23480.496 -17694.127  24.6%     -   69s
     0     0 -17713.623    0  604 -23480.496 -17713.623  24.6%     -   71s
     0     0 -17722.875    0  608 -23480.496 -17722.875  24.5%     -   71s
     0     0 -17728.443    0  603 -23480.496 -17728.443  24.5%     -   72s
     0     0 -17731.657    0  609 -23480.496 -17731.657  24.5%     -   72s
     0     0 -17733.067    0  620 -23480.496 -17733.067  24.5%     -   72s
     0     0 -17733.530    0  616 -23480.496 -17733.530  24.5%     -   72s
     0     0 -17788.659    0  602 -23480.496 -17788.659  24.2%     -   75s
H    0     0                    -23466.35171 -17804.093  24.1%     -   77s
     0     0 -17804.093    0  602 -23466.352 -17804.093  24.1%     -   77s
     0     0 -17808.602    0  525 -23466.352 -17808.602  24.1%     -   77s
     0     0 -17811.118    0  604 -23466.352 -17811.118  24.1%     -   78s
     0     0 -17811.581    0  604 -23466.352 -17811.581  24.1%     -   78s
     0     0 -17835.897    0  623 -23466.352 -17835.897  24.0%     -   81s
     0     0 -17844.310    0  614 -23466.352 -17844.310  24.0%     -   82s
     0     0 -17847.381    0  624 -23466.352 -17847.381  23.9%     -   83s
     0     0 -17848.900    0  612 -23466.352 -17848.900  23.9%     -   83s
     0     0 -17849.469    0  627 -23466.352 -17849.469  23.9%     -   83s
     0     0 -17871.549    0  613 -23466.352 -17871.549  23.8%     -   86s
     0     0 -17876.253    0  633 -23466.352 -17876.253  23.8%     -   87s
     0     0 -17879.461    0  633 -23466.352 -17879.461  23.8%     -   88s
     0     0 -17880.563    0  623 -23466.352 -17880.563  23.8%     -   88s
     0     0 -17880.810    0  631 -23466.352 -17880.810  23.8%     -   88s
     0     0 -17889.227    0  624 -23466.352 -17889.227  23.8%     -   90s
     0     0 -17896.100    0  611 -23466.352 -17896.100  23.7%     -   91s
     0     0 -17896.485    0  612 -23466.352 -17896.485  23.7%     -   92s
     0     0 -17901.525    0  611 -23466.352 -17901.525  23.7%     -   93s
     0     0 -17902.967    0  610 -23466.352 -17902.967  23.7%     -   94s
     0     0 -17903.815    0  616 -23466.352 -17903.815  23.7%     -   94s
     0     0 -17905.571    0  617 -23466.352 -17905.571  23.7%     -   95s
     0     0 -17906.117    0  612 -23466.352 -17906.117  23.7%     -   96s
     0     0 -17906.587    0  611 -23466.352 -17906.587  23.7%     -   97s
     0     0 -17909.175    0  613 -23466.352 -17909.175  23.7%     -   97s
     0     0 -17909.175    0  618 -23466.352 -17909.175  23.7%     -   98s
     0     0 -17909.175    0  618 -23466.352 -17909.175  23.7%     -   99s
H    0     0                    -23455.11256 -17909.175  23.6%     -  116s
H    0     0                    -23410.18720 -17909.175  23.5%     -  116s
H    0     0                    -23342.85139 -17909.175  23.3%     -  116s
H    0     0                    -23342.22243 -17909.175  23.3%     -  116s
     0     2 -17909.175    0  618 -23342.222 -17909.175  23.3%     -  117s
     1     4 -17923.260    1  522 -23342.222 -17909.175  23.3%  1258  122s
     3     8 -17980.500    2  521 -23342.222 -17924.938  23.2%  2745  125s
     7    16 -17996.288    3  520 -23342.222 -17980.521  23.0%  2690  133s
    15    28 -18142.345    4  606 -23342.222 -17996.631  22.9%  2907  138s
H   31    48                    -23332.05665 -18142.502  22.2%  4214  142s
    59    76 -18466.895    6  610 -23332.057 -18276.904  21.7%  3260  147s
    91   132 -18554.284    7  664 -23332.057 -18467.011  20.9%  2801  156s
   151   203 -18655.614    8  567 -23332.057 -18467.011  20.9%  2247  160s
   252   244 -18815.359    9  572 -23332.057 -18554.417  20.5%  1683  166s
   308   286 -19983.975    9  397 -23332.057 -18554.417  20.5%  1623  170s
   409   343 -19305.669   11  637 -23332.057 -18554.417  20.5%  1544  179s
   447   384 -19332.658   12  631 -23332.057 -18554.417  20.5%  1514  183s
   501   420 -19613.742   14  644 -23332.057 -18554.417  20.5%  1430  188s
   563   453 -19691.191   16  649 -23332.057 -18815.375  19.4%  1363  195s
   618   496 -20041.337   18  653 -23332.057 -18815.375  19.4%  1316  201s
   733   548 -20458.016   20  660 -23332.057 -19031.875  18.4%  1242  210s
H  746   548                    -23267.39539 -19031.875  18.2%  1250  210s
   775   604 -21083.577   20  512 -23267.395 -19031.875  18.2%  1238  216s
   865   680 -20530.900   21  633 -23267.395 -19031.875  18.2%  1188  222s
   967   762 -20547.163   22  643 -23267.395 -19031.875  18.2%  1136  228s
  1085   827 -21136.886   23  704 -23267.395 -19031.875  18.2%  1097  233s
  1204   891 -21428.384   24  376 -23267.395 -19031.875  18.2%  1051  238s
  1333   961 -21823.877   25  347 -23267.395 -19305.759  17.0%  1006  244s
  1434  1021 -21908.483   26  341 -23267.395 -19472.818  16.3%  1010  251s
  1562  1070 -22097.070   28  338 -23267.395 -19472.818  16.3%   990  257s
H 1691  1103                    -23262.52371 -19527.784  16.1%   973  261s
H 1720  1103                    -23259.63360 -19610.772  15.7%   974  261s
  1742  1178     cutoff   30      -23259.634 -19610.772  15.7%   971  270s
  1883  1267     cutoff   31      -23259.634 -19610.772  15.7%   959  276s
  2034  1368 -21831.562   11  263 -23259.634 -19661.833  15.5%   937  280s
  2195  1447 -22815.673   14  274 -23259.634 -19661.833  15.5%   913  287s
  2344  1528 -20721.626   10  459 -23259.634 -19661.833  15.5%   903  293s
  2481  1602 -22083.180   12  320 -23259.634 -19796.184  14.9%   899  299s
  2619  1626     cutoff   13      -23259.634 -19796.184  14.9%   896  302s
H 2622  1626                    -23256.53179 -19796.184  14.9%   896  302s
H 2660  1626                    -23254.51331 -19796.184  14.9%   899  302s
  2667  1678 -22245.500   13  525 -23254.513 -19796.184  14.9%   900  308s
  2814  1711 -22514.911   14  461 -23254.513 -19955.384  14.2%   890  313s
  2915  1791 -22673.182   15  457 -23254.513 -19996.867  14.0%   884  318s
  3071  1878 -23186.215   16  465 -23254.513 -19996.867  14.0%   874  326s
  3279  1987     cutoff   17      -23254.513 -19996.867  14.0%   861  332s
  3535  2118     cutoff   10      -23254.513 -20037.934  13.8%   838  338s
  3778  2216 -21972.328   11  275 -23254.513 -20037.934  13.8%   821  346s
  4033  2372 -22149.073   14  270 -23254.513 -20154.101  13.3%   807  354s
  4265  2373 -20667.480   10  618 -23254.513 -20154.101  13.3%   800  384s
  4267  2374 -22110.740   16  446 -23254.513 -20154.101  13.3%   799  400s
  4268  2375 -20922.231   11  626 -23254.513 -20154.101  13.3%   799  412s
  4269  2376 -22672.736   24  570 -23254.513 -20154.101  13.3%   799  417s
  4270  2376 -21631.408   20  599 -23254.513 -20154.101  13.3%   799  422s
  4271  2377 -22692.323   16  606 -23254.513 -20154.101  13.3%   799  425s
  4274  2379 -22446.278   15  620 -23254.513 -20154.101  13.3%   798  431s
  4277  2381 -20691.779   14  599 -23254.513 -20154.101  13.3%   797  441s
  4280  2383 -22343.397   44  557 -23254.513 -20154.101  13.3%   797  445s
  4282  2384 -20920.759    9  628 -23254.513 -20154.101  13.3%   796  453s
  4283  2385 -22830.904   18  623 -23254.513 -20154.101  13.3%   796  455s
  4286  2387 -22045.551   15  550 -23254.513 -20154.101  13.3%   796  465s
  4289  2389 -20936.984    8  731 -23254.513 -20154.101  13.3%   795  471s
  4290  2390 -22615.180   12  550 -23254.513 -20154.101  13.3%   795  477s
  4292  2391 -21954.248   22  563 -23254.513 -20154.101  13.3%   795  482s
  4293  2392 -22662.738   20  567 -23254.513 -20154.101  13.3%   794  485s
  4295  2393 -23082.368   35  564 -23254.513 -20154.101  13.3%   794  493s
  4296  2394 -21684.100   18  567 -23254.513 -20154.101  13.3%   794  496s
  4298  2395 -22763.214   13  639 -23254.513 -20154.101  13.3%   793  519s
  4299  2396 -22446.278   15  639 -23254.513 -20154.101  13.3%   793  529s
  4300  2399 -20154.101   15  543 -23254.513 -20154.101  13.3%   818  537s
  4302  2403 -20154.101   16  546 -23254.513 -20154.101  13.3%   819  543s
  4306  2409 -20154.101   17  681 -23254.513 -20154.101  13.3%   821  548s
  4314  2423 -20154.101   18  598 -23254.513 -20154.101  13.3%   826  556s
  4330  2445 -20154.101   19  674 -23254.513 -20154.101  13.3%   843  564s
  4362  2467 -20154.101   20  679 -23254.513 -20154.101  13.3%   857  571s
  4394  2489 -20154.101   21  746 -23254.513 -20154.101  13.3%   878  575s
  4427  2523 -20154.101   22  675 -23254.513 -20154.101  13.3%   887  581s
  4486  2515 -21045.188   22  461 -23254.513 -20154.101  13.3%   900  588s
  4568  2504 -20154.101   23  670 -23254.513 -20154.101  13.3%   911  597s
  4629  2492 -21247.153   23  557 -23254.513 -20154.101  13.3%   926  603s
  4691  2484 -20650.765   24  600 -23254.513 -20154.101  13.3%   938  609s
  4754  2490 -21605.762   25  527 -23254.513 -20154.101  13.3%   951  614s
  4816  2492 -21523.550   25  550 -23254.513 -20154.101  13.3%   956  619s
  4896  2460 -22039.254   26  521 -23254.513 -20154.101  13.3%   958  627s
  4971  2438     cutoff   26      -23254.513 -20154.101  13.3%   963  634s
  5048  2423 -22904.073   27  487 -23254.513 -20470.816  12.0%   972  643s
  5112  2403 -23026.956   28  489 -23254.513 -20470.816  12.0%   974  650s
  5188  2381     cutoff   29      -23254.513 -20572.510  11.5%   981  656s
  5261  2373     cutoff   28      -23254.513 -20780.168  10.6%   984  663s
  5340  2361     cutoff   29      -23254.513 -20780.168  10.6%   989  668s
  5389  2355     cutoff   31      -23254.513 -20836.245  10.4%   994  674s
  5439  2324 infeasible   27      -23254.513 -20882.788  10.2%   999  680s
  5533  2269 -22018.448   24  514 -23254.513 -20938.417  10.0%  1004  687s
  5637  2216 -22111.479   25  342 -23254.513 -21067.480  9.40%  1006  694s
  5732  2176     cutoff   26      -23254.513 -21071.784  9.39%  1013  698s
  5846  2115 -22508.028   26  501 -23254.513 -21071.784  9.39%  1013  704s
  5973  2012 -22837.225   27  401 -23254.513 -21418.677  7.89%  1013  712s
  6120  1928     cutoff   26      -23254.513 -21507.671  7.51%  1011  722s
  6261  1810     cutoff   24      -23254.513 -21507.671  7.51%  1011  727s
  6426  1711     cutoff   26      -23254.513 -21880.012  5.91%  1002  733s
  6526  1663 -23105.382   27  438 -23254.513 -22465.243  3.39%   995  737s
  6645  1617 -23254.161   36   12 -23254.513 -23237.993  0.07%   980  740s

Cutting planes:
  Implied bound: 8
  Projected implied bound: 5
  MIR: 398
  Flow cover: 733
  Zero half: 8
  RLT: 8
  Relax-and-lift: 39

Explored 6712 nodes (6638016 simplex iterations) in 740.43 seconds (1288.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23254.5 -23256.5 -23259.6 ... -23455.1
No other solutions better than -23254.5

Optimal solution found (tolerance 1.00e-06)
Best objective -2.325451330634e+04, best bound -2.325451330634e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 740.44s
  Master Objective (UB) = -23254.51, θ = 95030.76
  Upper Bound (UB) = -23254.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95030.76
  [DEBUG]   ✓ Scenario 0: θ = 95030.76 ≤ Q = 95030.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95030.76 ≤ Q = 95030.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95030.76 ≤ Q = 95030.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 95030.76 ≤ Q = 95030.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7268d564
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7268d564
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7718094.1802
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.107362e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110736.21    0  121 7718094.18 -110736.21   101%     -    0s
H    0     0                    -77849.32264 -110736.21  42.2%     -    0s
H    0     0                    -78314.09906 -110736.21  41.4%     -    0s
     0     0 -84110.792    0  132 -78314.099 -84110.792  7.40%     -    0s
H    0     0                    -80085.49203 -83964.724  4.84%     -    0s
     0     0 -83376.692    0  132 -80085.492 -83376.692  4.11%     -    0s
     0     0 -83255.840    0  131 -80085.492 -83255.840  3.96%     -    0s
     0     0 -83251.032    0  131 -80085.492 -83251.032  3.95%     -    0s
     0     2 -83251.032    0  131 -80085.492 -83251.032  3.95%     -    0s
H   31    64                    -81644.96510 -83048.270  1.72%  18.8    0s
H   63    93                    -81869.50264 -83002.849  1.38%  16.7    0s
* 1306   471              41    -82026.85634 -82527.309  0.61%   5.6    0s
* 1358   471              47    -82065.84730 -82493.260  0.52%   5.6    0s
H 1705   510                    -82096.05277 -82370.292  0.33%   5.6    0s
H 2004   538                    -82103.75777 -82370.292  0.32%   5.5    0s
* 3418   176              39    -82104.27245 -82183.307  0.10%   5.5    0s
* 3780   176              41    -82112.77589 -82171.976  0.07%   5.4    0s

Cutting planes:
  Gomory: 65
  MIR: 187

Explored 4206 nodes (22453 simplex iterations) in 0.31 seconds (0.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -82112.8 -82104.3 -82103.8 ... -78314.1
No other solutions better than -82112.8

Optimal solution found (tolerance 1.00e-06)
Best objective -8.211277589266e+04, best bound -8.211277589266e+04, gap 0.0000%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 93579.05
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82112.78
  [DEBUG]   S×d_nominal = 175691.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175691.82 + -82112.78 = 93579.05
  [DEBUG]   Current θ from Master = 95030.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1451.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24706.22
  Lower Bound (LB) = -24706.22
  Gap (UB-LB) = 1451.7077, Absolute Gap = 1451.7077, Relative Gap = 0.062427
  Not converged yet (gap = 1451.71 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221659 nonzeros
Model fingerprint: 0x892125be
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35935 rows and 14595 columns
Presolve time: 1.18s
Presolved: 41898 rows, 18865 columns, 259654 nonzeros
Variable types: 16606 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41898 rows, 18865 columns, 259654 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22254   -2.0342280e+04   0.000000e+00   1.128492e+06      5s
   31039   -1.3953014e+04   0.000000e+00   2.325698e+05     10s
   37963   -1.3212908e+04   0.000000e+00   7.694444e+05     15s
   45081   -1.0992529e+04   0.000000e+00   1.844436e+06     20s
Concurrent spin time: 0.06s

Solved with dual simplex

Root relaxation: objective -1.017465e+04, 38640 iterations, 22.60 seconds (31.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10174.655    0  448 -222248.17 -10174.655  95.4%     -   24s
H    0     0                    -211464.4394 -10174.655  95.2%     -   24s
H    0     0                    -116475.2734 -10174.655  91.3%     -   24s
H    0     0                    -111790.8672 -10174.655  90.9%     -   24s
H    0     0                    -111509.0388 -10174.655  90.9%     -   24s
H    0     0                    -109450.9217 -10174.655  90.7%     -   24s
H    0     0                    -109130.1176 -10174.655  90.7%     -   24s
H    0     0                    -88025.51937 -10174.655  88.4%     -   24s
H    0     0                    -58697.13077 -10174.655  82.7%     -   24s
H    0     0                    -57827.44803 -10174.655  82.4%     -   24s
H    0     0                    -48563.16612 -10174.655  79.0%     -   26s
H    0     0                    -47803.54525 -10174.655  78.7%     -   26s
H    0     0                    -44175.64557 -13804.024  68.8%     -   37s
H    0     0                    -34301.41348 -13804.024  59.8%     -   37s
     0     0 -13832.851    0  197 -34301.413 -13832.851  59.7%     -   37s
     0     0 -14478.175    0  483 -34301.413 -14478.175  57.8%     -   40s
     0     0 -14524.099    0  488 -34301.413 -14524.099  57.7%     -   41s
     0     0 -14586.067    0  497 -34301.413 -14586.067  57.5%     -   43s
     0     0 -14586.067    0  497 -34301.413 -14586.067  57.5%     -   44s
     0     0 -14586.067    0  496 -34301.413 -14586.067  57.5%     -   46s
     0     0 -14586.067    0  498 -34301.413 -14586.067  57.5%     -   47s
     0     0 -15734.069    0  471 -34301.413 -15734.069  54.1%     -   54s
H    0     0                    -34186.68672 -15734.121  54.0%     -   55s
     0     0 -15825.311    0  476 -34186.687 -15825.311  53.7%     -   58s
     0     0 -15895.074    0  473 -34186.687 -15895.074  53.5%     -   59s
     0     0 -15939.043    0  469 -34186.687 -15939.043  53.4%     -   61s
     0     0 -15941.365    0  475 -34186.687 -15941.365  53.4%     -   61s
     0     0 -15941.913    0  476 -34186.687 -15941.913  53.4%     -   62s
H    0     0                    -34136.64359 -15941.913  53.3%     -   67s
     0     0 -16769.231    0  580 -34136.644 -16769.231  50.9%     -   76s
H    0     0                    -32660.81208 -16945.016  48.1%     -   80s
     0     0 -16945.016    0  570 -32660.812 -16945.016  48.1%     -   80s
     0     0 -16988.856    0  572 -32660.812 -16988.856  48.0%     -   82s
     0     0 -17036.360    0  580 -32660.812 -17036.360  47.8%     -   84s
     0     0 -17091.076    0  578 -32660.812 -17091.076  47.7%     -   86s
     0     0 -17103.858    0  579 -32660.812 -17103.858  47.6%     -   87s
     0     0 -17107.254    0  575 -32660.812 -17107.254  47.6%     -   87s
     0     0 -17115.907    0  570 -32660.812 -17115.907  47.6%     -   88s
     0     0 -17118.782    0  569 -32660.812 -17118.782  47.6%     -   88s
     0     0 -17119.009    0  570 -32660.812 -17119.009  47.6%     -   88s
     0     0 -17408.928    0  590 -32660.812 -17408.928  46.7%     -   97s
     0     0 -17481.408    0  592 -32660.812 -17481.408  46.5%     -  100s
     0     0 -17512.070    0  605 -32660.812 -17512.070  46.4%     -  103s
     0     0 -17521.723    0  604 -32660.812 -17521.723  46.4%     -  104s
     0     0 -17523.812    0  619 -32660.812 -17523.812  46.3%     -  104s
     0     0 -17526.943    0  616 -32660.812 -17526.943  46.3%     -  105s
     0     0 -17529.837    0  621 -32660.812 -17529.837  46.3%     -  105s
     0     0 -17530.159    0  618 -32660.812 -17530.159  46.3%     -  106s
     0     0 -17579.895    0  532 -32660.812 -17579.895  46.2%     -  109s
     0     0 -17585.405    0  530 -32660.812 -17585.405  46.2%     -  110s
     0     0 -17587.118    0  533 -32660.812 -17587.118  46.2%     -  111s
     0     0 -17587.697    0  626 -32660.812 -17587.697  46.2%     -  111s
     0     0 -17610.293    0  603 -32660.812 -17610.293  46.1%     -  115s
H    0     0                    -30164.46130 -17610.342  41.6%     -  117s
H    0     0                    -30136.10790 -17610.342  41.6%     -  117s
H    0     0                    -30129.62516 -17610.342  41.6%     -  117s
H    0     0                    -30129.40971 -17610.342  41.6%     -  117s
H    0     0                    -30125.49748 -17610.342  41.5%     -  118s
     0     0 -17627.909    0  619 -30125.497 -17627.909  41.5%     -  121s
     0     0 -17628.988    0  621 -30125.497 -17628.988  41.5%     -  121s
     0     0 -17629.288    0  538 -30125.497 -17629.288  41.5%     -  122s
     0     0 -17640.882    0  630 -30125.497 -17640.882  41.4%     -  124s
     0     0 -17645.598    0  624 -30125.497 -17645.598  41.4%     -  125s
     0     0 -17646.680    0  635 -30125.497 -17646.680  41.4%     -  126s
     0     0 -17647.691    0  632 -30125.497 -17647.691  41.4%     -  126s
     0     0 -17670.677    0  685 -30125.497 -17670.677  41.3%     -  129s
H    0     0                    -30089.64300 -17670.910  41.3%     -  130s
H    0     0                    -30083.31591 -17670.910  41.3%     -  130s
H    0     0                    -30079.40368 -17670.910  41.3%     -  130s
     0     0 -17692.696    0  618 -30079.404 -17692.696  41.2%     -  132s
     0     0 -17694.017    0  620 -30079.404 -17694.017  41.2%     -  132s
     0     0 -17694.865    0  626 -30079.404 -17694.865  41.2%     -  132s
     0     0 -17708.962    0  688 -30079.404 -17708.962  41.1%     -  135s
     0     0 -17711.655    0  627 -30079.404 -17711.655  41.1%     -  136s
     0     0 -17714.035    0  699 -30079.404 -17714.035  41.1%     -  136s
     0     0 -17714.342    0  640 -30079.404 -17714.342  41.1%     -  137s
     0     0 -17725.540    0  547 -30079.404 -17725.540  41.1%     -  139s
H    0     0                    -30047.66888 -17725.808  41.0%     -  150s
H    0     0                    -29777.40748 -17725.808  40.5%     -  151s
H    0     0                    -29732.66908 -17725.808  40.4%     -  155s
H    0     0                    -29708.72951 -17725.808  40.3%     -  155s
H    0     0                    -29310.82295 -17725.808  39.5%     -  157s
     0     0 -17726.480    0  545 -29310.823 -17726.480  39.5%     -  157s
     0     0 -17731.157    0  639 -29310.823 -17731.157  39.5%     -  159s
H    0     0                    -29173.16529 -17732.662  39.2%     -  160s
H    0     0                    -29092.02253 -17732.662  39.0%     -  160s
H    0     0                    -29002.38220 -17732.662  38.9%     -  160s
H    0     0                    -28792.69633 -17732.662  38.4%     -  160s
H    0     0                    -28788.78410 -17732.662  38.4%     -  160s
     0     0 -17733.108    0  708 -28788.784 -17733.108  38.4%     -  160s
     0     0 -17733.893    0  554 -28788.784 -17733.893  38.4%     -  161s
     0     0 -17735.436    0  637 -28788.784 -17735.436  38.4%     -  162s
     0     0 -17736.892    0  642 -28788.784 -17736.892  38.4%     -  163s
     0     0 -17737.257    0  642 -28788.784 -17737.257  38.4%     -  163s
     0     0 -17737.910    0  559 -28788.784 -17737.910  38.4%     -  165s
     0     0 -17738.038    0  559 -28788.784 -17738.038  38.4%     -  166s
H    0     0                    -28709.54940 -17738.038  38.2%     -  189s
     0     2 -17738.038    0  559 -28709.549 -17738.038  38.2%     -  190s
     3     8 -18159.283    2  595 -28709.549 -17958.281  37.4%  2931  198s
     7    16 -18355.036    3  522 -28709.549 -18162.317  36.7%  3456  205s
    15    32 -18440.084    4  532 -28709.549 -18357.703  36.1%  4626  215s
    31    50 -19359.250    5  481 -28709.549 -18440.088  35.8%  5693  230s
    49    82 -21711.268    6  291 -28709.549 -18440.088  35.8%  6952  236s
H   54    82                    -28674.66263 -18440.088  35.7%  6539  236s
H   55    82                    -28671.50725 -18440.088  35.7%  6565  236s
H   63    82                    -28636.62048 -18440.088  35.6%  6078  236s
    81   137 -21956.324    7  274 -28636.620 -18440.088  35.6%  5110  246s
   144   209 -22049.362    8  253 -28636.620 -18440.088  35.6%  4415  257s
   254   280 -22630.044   10  275 -28636.620 -18440.088  35.6%  3112  266s
   367   309 -23138.532   12  256 -28636.620 -18440.088  35.6%  2531  274s
   406   367 -23241.798   13  270 -28636.620 -18440.088  35.6%  2428  279s
   486   435 -24583.192   11  238 -28636.620 -18440.088  35.6%  2155  289s
   569   514 -23565.150   13  269 -28636.620 -18520.263  35.3%  1926  298s
   668   553 -26641.396   13  151 -28636.620 -18520.263  35.3%  1770  307s
   759   590 -23855.286   14  261 -28636.620 -18520.263  35.3%  1677  314s
   848   632 -23414.506   14  257 -28636.620 -18520.263  35.3%  1613  322s
   920   677 -23862.126   15  335 -28636.620 -18692.937  34.7%  1585  331s
  1003   701 -24295.623   15  238 -28636.620 -18692.937  34.7%  1543  340s
  1063   750 -24229.231   15  261 -28636.620 -18692.937  34.7%  1518  347s
  1160   789 -24221.050   16  331 -28636.620 -18730.919  34.6%  1481  357s
  1237   863 -24782.557   16  237 -28636.620 -18730.919  34.6%  1466  364s
  1335   915 -24616.198   16  265 -28636.620 -18730.919  34.6%  1438  372s
  1435   988     cutoff   17      -28636.620 -18730.919  34.6%  1410  382s
  1526  1072     cutoff   17      -28636.620 -18730.919  34.6%  1402  391s
  1626  1094     cutoff   20      -28636.620 -18730.919  34.6%  1399  397s
H 1659  1094                    -24236.56436 -18730.919  22.7%  1402  397s
  1668  1052     cutoff   20      -24236.564 -18730.919  22.7%  1399  408s
H 1683  1052                    -23881.64352 -18730.919  21.6%  1395  408s
H 1697  1052                    -23412.43676 -18730.919  20.0%  1393  408s
  1792  1107 -21631.151    8  227 -23412.437 -19578.580  16.4%  1366  416s
  1905  1154 -22053.718   12  305 -23412.437 -19609.794  16.2%  1364  425s
H 1920  1154                    -23406.92385 -19609.794  16.2%  1365  425s
H 1923  1154                    -23397.62969 -19609.794  16.2%  1368  425s
H 1927  1154                    -23389.40491 -19609.794  16.2%  1368  425s
  2021  1206 -22546.355   14  278 -23389.405 -19609.794  16.2%  1351  432s
  2173  1235 -20787.684   13  326 -23389.405 -19643.702  16.0%  1331  443s
  2292  1281 -20879.549   14  335 -23389.405 -19753.516  15.5%  1322  455s
  2460  1325     cutoff   19      -23389.405 -19753.516  15.5%  1300  463s
H 2488  1325                    -23349.78748 -19753.516  15.4%  1295  463s
  2670  1360     cutoff   19      -23349.787 -19873.285  14.9%  1263  473s
H 2835  1376                    -23336.19138 -20070.456  14.0%  1251  479s
  2883  1418 -20530.790   10  352 -23336.191 -20075.254  14.0%  1259  487s
  3063  1461 -22555.459   16  224 -23336.191 -20075.254  14.0%  1243  497s
  3234  1493 -21900.629   16  209 -23336.191 -20168.322  13.6%  1235  507s
  3423  1527 -23018.133   13  256 -23336.191 -20196.336  13.5%  1231  520s
  3609  1506     cutoff   15      -23336.191 -20196.336  13.5%  1224  532s
  3804  1516 -21882.246   11  422 -23336.191 -20510.481  12.1%  1222  540s
  3859  1548     cutoff   10      -23336.191 -20510.481  12.1%  1227  549s
  3979  1561 -23123.732   13  305 -23336.191 -20510.481  12.1%  1224  559s
  4209  1572 -23100.109   14  241 -23336.191 -20695.996  11.3%  1209  570s
  4315  1567     cutoff   16      -23336.191 -20750.682  11.1%  1206  581s
  4614  1552     cutoff   10      -23336.191 -20797.293  10.9%  1185  590s
  4903  1545 -22205.478   15  490 -23336.191 -21032.645  9.87%  1171  604s
  5205  1552 -22657.679   19  406 -23336.191 -21042.271  9.83%  1161  619s
  5528  1501 infeasible   10      -23336.191 -21147.440  9.38%  1146  632s
  5786  1440     cutoff   18      -23336.191 -21253.574  8.92%  1148  643s
  6065  1347 -22869.036   16  234 -23336.191 -21487.347  7.92%  1142  657s
  6460  1218     cutoff   17      -23336.191 -21683.071  7.08%  1125  670s
  6839  1035 -22425.900   14  256 -23336.191 -21888.630  6.20%  1113  687s
  7597  1124 infeasible   25      -23336.191 -22149.844  5.08%  1049  696s
H 8196  1124                    -23332.40287 -22245.662  4.66%   989  696s
  8863  1435     cutoff   19      -23332.403 -22299.424  4.43%   926  702s
 10643  1499     cutoff   58      -23332.403 -22791.024  2.32%   787  707s
 12787  1467 -23294.748   37   47 -23332.403 -22962.796  1.58%   668  712s
 14099  1564 -23327.485   39   40 -23332.403 -22979.808  1.51%   611  717s
 15544  1921 -23327.613   40   36 -23332.403 -23018.310  1.35%   559  722s
 18423  1638 -23318.747   42   37 -23332.403 -23224.910  0.46%   479  726s
 22135  1281 -23284.101   45   23 -23332.403 -23265.508  0.29%   406  730s
*28726   866              55    -23332.05665 -23311.693  0.09%   321  733s
 28750   857     cutoff   39      -23332.057 -23312.692  0.08%   320  736s
 29323   329 -23316.693   44   28 -23332.057 -23313.835  0.08%   315  741s
 30387     0 -23321.973   51   20 -23332.057 -23319.120  0.06%   305  746s

Cutting planes:
  Implied bound: 10
  MIR: 542
  Flow cover: 1080
  Zero half: 13
  RLT: 37
  Relax-and-lift: 32

Explored 30579 nodes (9414396 simplex iterations) in 746.19 seconds (1382.50 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23332.1 -23332.4 -23336.2 ... -24236.6
No other solutions better than -23332.1

Optimal solution found (tolerance 1.00e-06)
Best objective -2.333205665046e+04, best bound -2.333205665046e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 746.23s
  Master Objective (UB) = -23332.06, θ = 95045.78
  Upper Bound (UB) = -23332.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95045.78
  [DEBUG]   ✓ Scenario 0: θ = 95045.78 ≤ Q = 95045.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95045.78 ≤ Q = 95045.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95045.78 ≤ Q = 95045.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 95045.78 ≤ Q = 95045.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 95045.78 ≤ Q = 95045.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a226bb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x05a226bb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7730575.6389
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.104922e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110492.22    0  122 7730575.64 -110492.22   101%     -    0s
H    0     0                    -77703.43842 -110492.22  42.2%     -    0s
H    0     0                    -78106.14158 -110492.22  41.5%     -    0s
     0     0 -83651.983    0  134 -78106.142 -83651.983  7.10%     -    0s
H    0     0                    -79918.86722 -83530.986  4.52%     -    0s
     0     0 -83102.996    0  132 -79918.867 -83102.996  3.98%     -    0s
     0     0 -82948.277    0  131 -79918.867 -82948.277  3.79%     -    0s
     0     0 -82943.408    0  131 -79918.867 -82943.408  3.78%     -    0s
H    0     0                    -80876.80457 -82943.408  2.56%     -    0s
H    0     0                    -81423.58295 -82943.408  1.87%     -    0s
H    0     0                    -81533.77437 -82943.408  1.73%     -    0s
     0     2 -82943.408    0  131 -81533.774 -82943.408  1.73%     -    0s
*  871   230              30    -81549.04374 -82106.237  0.68%   5.0    0s

Cutting planes:
  Gomory: 40
  MIR: 136
  RLT: 1

Explored 1546 nodes (9052 simplex iterations) in 0.36 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -81549 -81533.8 -81423.6 ... 1.46279e+13
No other solutions better than -81549

Optimal solution found (tolerance 1.00e-06)
Best objective -8.154904374177e+04, best bound -8.154904374177e+04, gap 0.0000%
  Subproblem solved in 0.39s
  Worst-case operational profit (Z_SP) = 94016.00
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81549.04
  [DEBUG]   S×d_nominal = 175565.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175565.04 + -81549.04 = 94016.00
  [DEBUG]   Current θ from Master = 95045.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1029.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24361.83
  Lower Bound (LB) = -24361.83
  Gap (UB-LB) = 1029.7767, Absolute Gap = 1029.7767, Relative Gap = 0.044136
  Not converged yet (gap = 1029.78 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264887 nonzeros
Model fingerprint: 0xcece3abb
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43126 rows and 17516 columns
Presolve time: 1.56s
Presolved: 49997 rows, 22184 columns, 310469 nonzeros
Variable types: 19925 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49997 rows, 22184 columns, 310469 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24118   -2.7030036e+04   0.000000e+00   1.052257e+07      5s
   34735   -1.6601067e+04   0.000000e+00   4.162293e+07     10s
   40800   -1.4613237e+04   0.000000e+00   3.105705e+07     15s
   47172   -1.3317613e+04   0.000000e+00   3.371963e+08     20s
   51880   -1.3160314e+04   0.000000e+00   2.863826e+06     25s
   57662   -1.1702455e+04   0.000000e+00   1.362619e+07     30s
   63819   -1.0794389e+04   0.000000e+00   1.860735e+06     35s
Concurrent spin time: 0.64s

Solved with dual simplex

Root relaxation: objective -1.017465e+04, 51921 iterations, 34.97 seconds (49.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10174.655    0  448 -222248.17 -10174.655  95.4%     -   37s
H    0     0                    -209999.9595 -10174.655  95.2%     -   37s
H    0     0                    -146213.2655 -10174.655  93.0%     -   37s
H    0     0                    -130419.6253 -10174.655  92.2%     -   37s
H    0     0                    -130387.1725 -10174.655  92.2%     -   37s
H    0     0                    -126292.2950 -10174.655  91.9%     -   37s
H    0     0                    -81884.15027 -10174.655  87.6%     -   37s
H    0     0                    -81445.93856 -10174.655  87.5%     -   37s
H    0     0                    -41144.84838 -10174.655  75.3%     -   37s
H    0     0                    -41051.70893 -10174.655  75.2%     -   37s
H    0     0                    -34301.41348 -13206.543  61.5%     -   50s
     0     0 -13206.543    0  199 -34301.413 -13206.543  61.5%     -   50s
     0     0 -13996.921    0  481 -34301.413 -13996.921  59.2%     -   55s
     0     0 -14535.057    0  480 -34301.413 -14535.057  57.6%     -   59s
     0     0 -14535.057    0  489 -34301.413 -14535.057  57.6%     -   60s
     0     0 -14652.068    0  504 -34301.413 -14652.068  57.3%     -   61s
     0     0 -14662.962    0  496 -34301.413 -14662.962  57.3%     -   65s
     0     0 -14662.962    0  497 -34301.413 -14662.962  57.3%     -   67s
     0     0 -14662.962    0  497 -34301.413 -14662.962  57.3%     -   67s
     0     0 -14662.962    0  497 -34301.413 -14662.962  57.3%     -   67s
     0     0 -15669.786    0  448 -34301.413 -15669.786  54.3%     -   76s
H    0     0                    -32724.94341 -15669.786  52.1%     -   76s
     0     0 -15804.945    0  531 -32724.943 -15804.945  51.7%     -   80s
     0     0 -15836.378    0  467 -32724.943 -15836.378  51.6%     -   82s
     0     0 -15839.817    0  466 -32724.943 -15839.817  51.6%     -   83s
     0     0 -15846.354    0  468 -32724.943 -15846.354  51.6%     -   83s
     0     0 -15883.608    0  541 -32724.943 -15883.608  51.5%     -   85s
     0     0 -15892.643    0  530 -32724.943 -15892.643  51.4%     -   87s
     0     0 -15977.980    0  530 -32724.943 -15977.980  51.2%     -   92s
     0     0 -15978.847    0  529 -32724.943 -15978.847  51.2%     -   92s
     0     0 -15980.526    0  537 -32724.943 -15980.526  51.2%     -   93s
     0     0 -15982.569    0  535 -32724.943 -15982.569  51.2%     -   94s
     0     0 -15983.267    0  542 -32724.943 -15983.267  51.2%     -   95s
     0     0 -15983.307    0  539 -32724.943 -15983.307  51.2%     -   96s
     0     0 -16539.662    0  566 -32724.943 -16539.662  49.5%     -  113s
H    0     0                    -32687.30503 -16540.454  49.4%     -  113s
     0     0 -16766.335    0  567 -32687.305 -16766.335  48.7%     -  118s
     0     0 -16808.332    0  576 -32687.305 -16808.332  48.6%     -  121s
H    0     0                    -32625.37449 -16869.805  48.3%     -  124s
     0     0 -16869.805    0  571 -32625.374 -16869.805  48.3%     -  124s
     0     0 -16880.112    0  568 -32625.374 -16880.112  48.3%     -  125s
     0     0 -16882.978    0  572 -32625.374 -16882.978  48.3%     -  126s
     0     0 -16885.948    0  578 -32625.374 -16885.948  48.2%     -  126s
     0     0 -16887.028    0  578 -32625.374 -16887.028  48.2%     -  127s
     0     0 -16887.206    0  581 -32625.374 -16887.206  48.2%     -  127s
H    0     0                    -32191.46548 -17207.477  46.5%     -  142s
H    0     0                    -31972.98327 -17207.477  46.2%     -  142s
H    0     0                    -31964.05650 -17207.477  46.2%     -  142s
H    0     0                    -31960.03619 -17207.477  46.2%     -  142s
     0     0 -17207.477    0  511 -31960.036 -17207.477  46.2%     -  142s
H    0     0                    -31888.86520 -17208.512  46.0%     -  143s
     0     0 -17332.542    0  597 -31888.865 -17332.542  45.6%     -  150s
     0     0 -17369.422    0  591 -31888.865 -17369.422  45.5%     -  154s
     0     0 -17377.318    0  599 -31888.865 -17377.318  45.5%     -  155s
     0     0 -17381.611    0  518 -31888.865 -17381.611  45.5%     -  157s
     0     0 -17388.346    0  601 -31888.865 -17388.346  45.5%     -  158s
     0     0 -17390.712    0  604 -31888.865 -17390.712  45.5%     -  159s
     0     0 -17394.183    0  604 -31888.865 -17394.183  45.5%     -  160s
     0     0 -17395.108    0  605 -31888.865 -17395.108  45.5%     -  161s
     0     0 -17395.299    0  605 -31888.865 -17395.299  45.5%     -  161s
H    0     0                    -26557.99442 -17517.245  34.0%     -  167s
H    0     0                    -26458.80279 -17517.245  33.8%     -  167s
H    0     0                    -26149.01377 -17517.245  33.0%     -  167s
     0     0 -17517.245    0  598 -26149.014 -17517.245  33.0%     -  167s
H    0     0                    -25350.64886 -17517.849  30.9%     -  167s
H    0     0                    -25107.30872 -17517.849  30.2%     -  167s
H    0     0                    -25056.84612 -17517.849  30.1%     -  167s
H    0     0                    -24914.95829 -17517.849  29.7%     -  167s
H    0     0                    -24229.63335 -17517.849  27.7%     -  167s
H    0     0                    -24026.31566 -17538.698  27.0%     -  170s
H    0     0                    -24014.51864 -17538.698  27.0%     -  170s
     0     0 -17538.698    0  597 -24014.519 -17538.698  27.0%     -  170s
     0     0 -17541.417    0  597 -24014.519 -17541.417  27.0%     -  171s
     0     0 -17544.529    0  601 -24014.519 -17544.529  26.9%     -  171s
     0     0 -17545.613    0  597 -24014.519 -17545.613  26.9%     -  172s
     0     0 -17547.830    0  597 -24014.519 -17547.830  26.9%     -  172s
     0     0 -17549.375    0  594 -24014.519 -17549.375  26.9%     -  173s
H    0     0                    -23893.79844 -17549.470  26.6%     -  173s
H    0     0                    -23868.96027 -17549.470  26.5%     -  173s
     0     0 -17549.470    0  599 -23868.960 -17549.470  26.5%     -  173s
H    0     0                    -23843.20866 -17549.470  26.4%     -  174s
H    0     0                    -23830.90728 -17582.786  26.2%     -  178s
H    0     0                    -23820.08777 -17582.786  26.2%     -  178s
H    0     0                    -23818.47674 -17582.786  26.2%     -  178s
H    0     0                    -23816.29899 -17582.786  26.2%     -  178s
H    0     0                    -23809.22316 -17582.786  26.2%     -  178s
H    0     0                    -23795.07256 -17582.786  26.1%     -  178s
H    0     0                    -23773.01994 -17582.786  26.0%     -  178s
     0     0 -17582.786    0  603 -23773.020 -17582.786  26.0%     -  178s
     0     0 -17594.630    0  601 -23773.020 -17594.630  26.0%     -  181s
     0     0 -17601.547    0  605 -23773.020 -17601.547  26.0%     -  182s
     0     0 -17603.495    0  605 -23773.020 -17603.495  26.0%     -  183s
     0     0 -17603.946    0  617 -23773.020 -17603.946  25.9%     -  183s
     0     0 -17623.298    0  620 -23773.020 -17623.298  25.9%     -  187s
H    0     0                    -23757.11582 -17623.313  25.8%     -  187s
H    0     0                    -23749.35404 -17623.313  25.8%     -  187s
H    0     0                    -23728.96892 -17632.881  25.7%     -  190s
H    0     0                    -23665.12417 -17632.881  25.5%     -  190s
H    0     0                    -23641.70049 -17632.881  25.4%     -  190s
     0     0 -17632.881    0  629 -23641.700 -17632.881  25.4%     -  190s
H    0     0                    -23635.65790 -17635.052  25.4%     -  191s
H    0     0                    -23634.92708 -17635.052  25.4%     -  191s
     0     0 -17635.052    0  635 -23634.927 -17635.052  25.4%     -  191s
     0     0 -17635.243    0  633 -23634.927 -17635.243  25.4%     -  191s
     0     0 -17643.735    0  537 -23634.927 -17643.735  25.3%     -  194s
H    0     0                    -23634.36549 -17643.741  25.3%     -  196s
H    0     0                    -23631.49723 -17643.741  25.3%     -  196s
     0     0 -17646.761    0  631 -23631.497 -17646.761  25.3%     -  197s
     0     0 -17647.452    0  626 -23631.497 -17647.452  25.3%     -  198s
     0     0 -17655.926    0  625 -23631.497 -17655.926  25.3%     -  200s
     0     0 -17656.696    0  644 -23631.497 -17656.696  25.3%     -  201s
     0     0 -17663.249    0  643 -23631.497 -17663.249  25.3%     -  203s
     0     0 -17665.120    0  702 -23631.497 -17665.120  25.2%     -  204s
     0     0 -17665.998    0  556 -23631.497 -17665.998  25.2%     -  205s
     0     0 -17671.065    0  636 -23631.497 -17671.065  25.2%     -  207s
     0     0 -17671.065    0  636 -23631.497 -17671.065  25.2%     -  207s
     0     0 -17671.589    0  633 -23631.497 -17671.589  25.2%     -  208s
     0     0 -17672.325    0  637 -23631.497 -17672.325  25.2%     -  209s
     0     0 -17672.456    0  637 -23631.497 -17672.456  25.2%     -  211s
H    0     0                    -23624.49944 -17672.471  25.2%     -  245s
H    0     0                    -23541.24860 -17672.471  24.9%     -  245s
H    0     0                    -23524.36548 -17672.471  24.9%     -  245s
H    0     0                    -23507.73629 -17672.471  24.8%     -  246s
H    0     0                    -23504.17385 -17672.471  24.8%     -  247s
H    0     2                    -23496.11120 -17672.471  24.8%     -  256s
     0     2 -17672.471    0  637 -23496.111 -17672.471  24.8%     -  256s
     1     4 -17705.883    1  614 -23496.111 -17672.557  24.8%  1439  265s
     3     8 -17751.234    2  521 -23496.111 -17706.031  24.6%  4234  271s
     7    16 -17869.286    3  601 -23496.111 -17751.304  24.5%  4110  277s
    15    30 -18010.316    4  609 -23496.111 -17869.534  23.9%  4232  288s
    31    54 -18146.215    5  597 -23496.111 -18010.416  23.3%  5684  296s
    61    82 -18285.884    6  677 -23496.111 -18146.716  22.8%  4333  305s
    93   112 -18296.788    7  665 -23496.111 -18287.749  22.2%  4108  317s
   125   143 -18482.121    8  580 -23496.111 -18287.749  22.2%  3619  327s
H  132   143                    -23491.83478 -18287.749  22.2%  3761  327s
H  134   143                    -23485.68601 -18287.749  22.1%  3728  327s
H  142   143                    -23475.59519 -18287.749  22.1%  3662  327s
   158   234 -18503.621    9  591 -23475.595 -18287.749  22.1%  3596  337s
   276   275 -18572.883   11  584 -23475.595 -18287.749  22.1%  2690  348s
   357   305 -18618.497   12  582 -23475.595 -18287.749  22.1%  2636  358s
H  361   305                    -23466.35171 -18287.749  22.1%  2631  358s
   411   335 -18709.921   13  660 -23466.352 -18497.227  21.2%  2663  367s
   467   389 -18770.620   14  658 -23466.352 -18497.227  21.2%  2829  379s
   531   430 -18908.551   15  660 -23466.352 -18497.227  21.2%  2857  390s
   590   485 -18975.819   16  657 -23466.352 -18497.227  21.2%  2905  401s
   663   527 -19680.238   16  496 -23466.352 -18497.227  21.2%  2855  410s
   729   581 -19263.857   17  654 -23466.352 -18497.227  21.2%  2834  419s
   807   622 -21465.970   22  240 -23466.352 -18554.490  20.9%  2788  428s
   872   676 -19318.177   18  586 -23466.352 -18554.490  20.9%  2746  436s
   961   693 -21202.272   25  394 -23466.352 -18582.978  20.8%  2690  445s
H  962   693                    -23410.10502 -18582.978  20.6%  2687  445s
  1003   753 -19544.626   19  569 -23410.105 -18618.830  20.5%  2722  454s
  1095   799 -20010.080   19  173 -23410.105 -18618.830  20.5%  2660  463s
H 1196   826                    -23384.30592 -18618.830  20.4%  2617  472s
H 1199   826                    -23374.08053 -18618.830  20.3%  2620  472s
H 1206   826                    -23368.73917 -18618.830  20.3%  2622  472s
H 1223   826                    -23339.91008 -18649.076  20.1%  2632  472s
  1239   884 -20387.173   21  369 -23339.910 -18649.692  20.1%  2653  481s
  1339   949 -21014.301   21  398 -23339.910 -18649.692  20.1%  2621  492s
  1459  1007 -21625.786   22  378 -23339.910 -18649.692  20.1%  2583  503s
  1576  1070 -20406.417   22  342 -23339.910 -18649.692  20.1%  2536  510s
  1712  1155 -21003.626   26  146 -23339.910 -18707.805  19.8%  2483  519s
  1850  1177 -21965.034   30  145 -23339.910 -18707.805  19.8%  2436  524s
  1891  1199 -22186.481   30  145 -23339.910 -18920.007  18.9%  2437  529s
H 1898  1199                    -23337.64572 -18920.007  18.9%  2440  529s
  1933  1221     cutoff   31      -23337.646 -18920.007  18.9%  2442  535s
H 1938  1221                    -23334.69093 -18920.007  18.9%  2442  535s
  1973  1295     cutoff   31      -23334.691 -18955.494  18.8%  2448  547s
  2100  1368 -19357.585   13  565 -23334.691 -18955.494  18.8%  2440  559s
  2257  1428 -19565.959   15  551 -23334.691 -18955.494  18.8%  2426  569s
  2413  1485 -20536.185   18  518 -23334.691 -18955.494  18.8%  2415  581s
  2552  1555 -21497.703   20  233 -23334.691 -18975.550  18.7%  2431  595s
  2694  1632     cutoff   24      -23334.691 -18975.550  18.7%  2440  606s
  2865  1709 -22527.902   12  214 -23334.691 -19238.501  17.6%  2437  619s
  3045  1804 -22703.479   13  211 -23334.691 -19238.501  17.6%  2414  630s
  3205  1853 -23202.988   18  226 -23334.691 -19238.501  17.6%  2420  644s
  3313  1964 -20953.391   16  278 -23334.691 -19238.501  17.6%  2432  657s
  3508  2082 infeasible   21      -23334.691 -19238.501  17.6%  2419  671s
  3710  2207 -21874.055   15  221 -23334.691 -19286.422  17.3%  2414  685s
  4001  2299 -22506.809   21  371 -23334.691 -19299.668  17.3%  2370  701s
  4227  2365 -23142.119   29  290 -23334.691 -19407.956  16.8%  2370  718s
  4415  2454 -20477.147   11  242 -23334.691 -19407.956  16.8%  2373  734s
  4675  2553 infeasible   12      -23334.691 -19523.202  16.3%  2363  750s
  4962  2695 -22313.315   16  240 -23334.691 -19523.202  16.3%  2331  767s
  5221  2696 -21039.756   25  637 -23334.691 -19523.202  16.3%  2315  828s
  5223  2697 -20909.554   19  448 -23334.691 -19523.202  16.3%  2314  874s
  5224  2698 -20943.416   14  560 -23334.691 -19523.202  16.3%  2313  906s
  5225  2699 -21891.506   15  636 -23334.691 -19523.202  16.3%  2313  923s
  5226  2699 -21954.766   22  600 -23334.691 -19523.202  16.3%  2312  934s
  5227  2700 -21081.649   23  641 -23334.691 -19523.202  16.3%  2312  942s
  5228  2701 -21815.044   22  657 -23334.691 -19523.202  16.3%  2311  949s
  5229  2701 -21766.496   26  659 -23334.691 -19523.202  16.3%  2311  953s
  5230  2702 -21626.140   26  671 -23334.691 -19523.202  16.3%  2311  959s
  5231  2703 -21769.254   19  666 -23334.691 -19523.202  16.3%  2310  962s
  5233  2704 -22716.492   16  661 -23334.691 -19523.202  16.3%  2309  965s
  5235  2705 -21463.223   14  690 -23334.691 -19523.202  16.3%  2308  972s
  5236  2706 -22309.160   17  600 -23334.691 -19523.202  16.3%  2308  990s
  5237  2707 -22876.329   36  674 -23334.691 -19523.202  16.3%  2307  997s
  5238  2707 -21373.178   15  693 -23334.691 -19523.202  16.3%  2307 1000s
  5240  2709 -22247.521   30  696 -23334.691 -19523.202  16.3%  2306 1006s
  5241  2709 -22954.386   40  693 -23334.691 -19523.202  16.3%  2306 1010s
  5242  2710 -22989.440   29  704 -23334.691 -19523.202  16.3%  2305 1025s
  5244  2711 -22798.917   24  714 -23334.691 -19523.202  16.3%  2304 1034s
  5245  2712 -22428.836   30  620 -23334.691 -19523.202  16.3%  2304 1045s
  5247  2713 -22766.669   40  639 -23334.691 -19523.202  16.3%  2303 1050s
  5249  2715 -22178.429   19  544 -23334.691 -19523.202  16.3%  2302 1065s
  5251  2716 -20654.618   22  539 -23334.691 -19523.202  16.3%  2301 1072s
  5252  2717 -21538.450   16  697 -23334.691 -19523.202  16.3%  2301 1086s
  5253  2717 -22511.915   25  615 -23334.691 -19523.202  16.3%  2300 1090s
  5255  2719 -22638.713   47  630 -23334.691 -19523.202  16.3%  2300 1096s
  5256  2719 -22586.752   24  543 -23334.691 -19523.202  16.3%  2299 1100s
  5257  2720 -22065.445   16  622 -23334.691 -19523.202  16.3%  2299 1114s
  5258  2721 -22309.324    9  628 -23334.691 -19523.202  16.3%  2298 1116s
  5259  2721 -20415.582   20  635 -23334.691 -19523.202  16.3%  2298 1122s
  5260  2722 -22783.692   12  632 -23334.691 -19523.202  16.3%  2297 1133s
  5261  2723 -22168.596   34  636 -23334.691 -19523.202  16.3%  2297 1136s
  5262  2723 -22526.386   20  644 -23334.691 -19523.202  16.3%  2297 1143s
  5263  2724 -22884.931   29  710 -23334.691 -19523.202  16.3%  2296 1153s
  5264  2725 -21750.030   20  648 -23334.691 -19523.202  16.3%  2296 1160s
  5265  2725 -22555.309   35  657 -23334.691 -19523.202  16.3%  2295 1168s
  5266  2726 -22755.130   28  657 -23334.691 -19523.202  16.3%  2295 1223s
  5267  2727 -21886.952   16  657 -23334.691 -19523.202  16.3%  2294 1257s
  5268  2730 -19523.202   12  627 -23334.691 -19523.202  16.3%  2344 1270s
  5270  2734 -19523.202   13  616 -23334.691 -19523.202  16.3%  2346 1280s
  5274  2740 -19523.202   14  614 -23334.691 -19523.202  16.3%  2347 1291s
  5282  2742 -19820.759   15  571 -23334.691 -19523.202  16.3%  2354 1310s
  5290  2754 -21707.279   16  285 -23334.691 -19523.202  16.3%  2359 1332s
  5307  2769     cutoff   17      -23334.691 -19523.202  16.3%  2374 1345s
  5339  2827 -20438.822   18  369 -23334.691 -19523.202  16.3%  2421 1369s
  5464  2763 -22580.353   21  457 -23334.691 -19523.202  16.3%  2417 1387s
  5546  2744 -22425.700   21  453 -23334.691 -19523.202  16.3%  2416 1401s
  5610  2731 -22735.592   22  441 -23334.691 -19523.202  16.3%  2421 1421s
  5674  2695 -23057.111   24  460 -23334.691 -19523.202  16.3%  2422 1433s
  5761  2652     cutoff   25      -23334.691 -19523.202  16.3%  2406 1445s
  5832  2635 -20961.568   18  367 -23334.691 -19523.202  16.3%  2395 1456s
  5907  2609 -21691.903   19  243 -23334.691 -19523.202  16.3%  2384 1473s
  5953  2597 -21816.972   20  346 -23334.691 -19523.202  16.3%  2379 1485s
  6007  2587 -21936.733   21  441 -23334.691 -19523.202  16.3%  2379 1493s
  6050  2578     cutoff   22      -23334.691 -19523.202  16.3%  2373 1505s
  6125  2543 -23185.222   21  474 -23334.691 -19523.202  16.3%  2361 1516s
  6187  2525     cutoff   22      -23334.691 -19523.202  16.3%  2350 1534s
  6250  2501 -23176.807   22  326 -23334.691 -19523.202  16.3%  2343 1548s
  6301  2499     cutoff   23      -23334.691 -19523.202  16.3%  2340 1558s
  6344  2508     cutoff   22      -23334.691 -19523.202  16.3%  2339 1568s
  6396  2470 -23139.765   24  411 -23334.691 -19523.202  16.3%  2337 1582s
  6469  2428 -23183.774   26  486 -23334.691 -20803.756  10.8%  2325 1594s
  6546  2398     cutoff   21      -23334.691 -20941.890  10.3%  2316 1606s
  6623  2361 -22006.311   22  601 -23334.691 -20941.890  10.3%  2309 1618s
  6713  2308 -22219.064   23  383 -23334.691 -20941.890  10.3%  2294 1631s
  6774  2283 infeasible   22      -23334.691 -21890.749  6.19%  2283 1642s
  6857  2235 -22210.011   18  643 -23334.691 -21890.749  6.19%  2267 1650s
  6957  2196 -22434.260   19  650 -23334.691 -21890.749  6.19%  2245 1656s
  7054  2155 -22533.218   20  719 -23334.691 -22436.296  3.85%  2220 1666s
  7159  2120 -22635.202   21  743 -23334.691 -22535.381  3.43%  2190 1676s
  7268  2083 -22812.485   22  653 -23334.691 -22635.214  3.00%  2162 1682s
  7377  2026 -23077.655   23  575 -23334.691 -22813.350  2.23%  2133 1687s
  7457  2002 -23129.899   24  654 -23334.691 -23129.899  0.88%  2111 1693s
  7462  1995     cutoff   25      -23334.691 -23130.645  0.87%  2110 1695s

Cutting planes:
  Implied bound: 46
  Projected implied bound: 3
  MIR: 585
  Mixing: 1
  Flow cover: 1250
  Zero half: 8
  RLT: 12
  Relax-and-lift: 54

Explored 7482 nodes (15960398 simplex iterations) in 1695.67 seconds (2984.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23334.7 -23337.6 -23339.9 ... -23485.7
No other solutions better than -23334.7

Optimal solution found (tolerance 1.00e-06)
Best objective -2.333469092998e+04, best bound -2.333469092998e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1695.68s
  Master Objective (UB) = -23334.69, θ = 94999.91
  Upper Bound (UB) = -23334.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94999.91
  [DEBUG]   ✓ Scenario 0: θ = 94999.91 ≤ Q = 94999.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94999.91 ≤ Q = 94999.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94999.91 ≤ Q = 94999.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94999.91 ≤ Q = 94999.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94999.91 ≤ Q = 94999.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94999.91 ≤ Q = 94999.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x70ba97c9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x70ba97c9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7707546.8585
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.108037e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110803.68    0  122 7707546.86 -110803.68   101%     -    0s
H    0     0                    -77943.16240 -110803.68  42.2%     -    0s
H    0     0                    -78366.64232 -110803.68  41.4%     -    0s
     0     0 -84185.044    0  130 -78366.642 -84185.044  7.42%     -    0s
H    0     0                    -80110.15560 -84038.976  4.90%     -    0s
     0     0 -83429.379    0  132 -80110.156 -83429.379  4.14%     -    0s
     0     0 -83238.997    0  134 -80110.156 -83238.997  3.91%     -    0s
H    0     0                    -80365.95880 -83220.265  3.55%     -    0s
     0     0 -83220.265    0  134 -80365.959 -83220.265  3.55%     -    0s
     0     0 -83019.264    0  134 -80365.959 -83019.264  3.30%     -    0s
     0     0 -82999.943    0  134 -80365.959 -82999.943  3.28%     -    0s
     0     0 -82842.039    0  134 -80365.959 -82842.039  3.08%     -    0s
     0     0 -82799.830    0  134 -80365.959 -82799.830  3.03%     -    0s
     0     2 -82799.830    0  134 -80365.959 -82799.830  3.03%     -    0s
H   32    64                    -80429.74592 -82460.107  2.52%  22.6    0s
H   34    64                    -80537.81124 -82460.107  2.39%  21.6    0s
H   38    64                    -80656.76166 -82460.107  2.24%  20.5    0s
H   43    64                    -81010.76252 -82460.107  1.79%  19.2    0s
H  420   484                    -81371.37935 -82306.293  1.15%   6.5    0s
H  515   484                    -81376.95184 -82306.293  1.14%   6.1    0s
* 1080   675              33    -81386.54867 -82104.570  0.88%   6.2    0s
* 1450   666              28    -81393.52651 -81956.500  0.69%   6.7    0s
H 2424   616                    -81401.25066 -81730.078  0.40%   6.9    0s
H 2678   616                    -81438.86014 -81703.752  0.33%   6.9    0s
* 3099   278              17    -81449.11632 -81631.248  0.22%   7.0    0s

Cutting planes:
  Gomory: 63
  MIR: 270
  RLT: 1

Explored 3650 nodes (24930 simplex iterations) in 0.28 seconds (0.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -81449.1 -81438.9 -81401.3 ... -80537.8
No other solutions better than -81449.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.144911632101e+04, best bound -8.144911632101e+04, gap 0.0000%
  Subproblem solved in 0.32s
  Worst-case operational profit (Z_SP) = 94264.41
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81449.12
  [DEBUG]   S×d_nominal = 175713.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175713.53 + -81449.12 = 94264.41
  [DEBUG]   Current θ from Master = 94999.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 735.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24070.20
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 735.5048, Absolute Gap = 735.5048, Relative Gap = 0.031520
  Not converged yet (gap = 735.50 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308115 nonzeros
Model fingerprint: 0x83e62456
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50317 rows and 20437 columns
Presolve time: 1.54s
Presolved: 58096 rows, 25503 columns, 361284 nonzeros
Variable types: 23244 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58096 rows, 25503 columns, 361284 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25730   -8.1027569e+04   0.000000e+00   1.139621e+09      5s
   36136   -2.5321764e+04   0.000000e+00   5.619392e+06     10s
   43550   -1.5916572e+04   0.000000e+00   2.236437e+06     15s
   50216   -1.3123992e+04   0.000000e+00   3.089955e+05     20s
   55545   -1.2899395e+04   0.000000e+00   2.363861e+06     25s
   61288   -1.2524572e+04   0.000000e+00   1.320511e+06     30s
   66188   -1.1692532e+04   0.000000e+00   2.062130e+06     35s
   71508   -1.0797609e+04   0.000000e+00   4.388815e+05     40s
Concurrent spin time: 0.03s

Solved with dual simplex

Root relaxation: objective -1.017465e+04, 52263 iterations, 39.97 seconds (55.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10174.655    0  448 -222248.17 -10174.655  95.4%     -   42s
H    0     0                    -208451.6459 -10174.655  95.1%     -   42s
H    0     0                    -127851.7832 -10174.655  92.0%     -   42s
H    0     0                    -127694.3722 -10174.655  92.0%     -   42s
H    0     0                    -103326.1327 -10174.655  90.2%     -   42s
H    0     0                    -79466.29769 -10174.655  87.2%     -   42s
H    0     0                    -79028.08598 -10174.655  87.1%     -   42s
H    0     0                    -57973.00970 -10174.655  82.4%     -   42s
H    0     0                    -57827.44803 -10174.655  82.4%     -   42s
H    0     0                    -48709.23262 -10174.655  79.1%     -   44s
H    0     0                    -48563.16612 -10174.655  79.0%     -   44s
H    0     0                    -47803.54525 -10174.655  78.7%     -   44s
H    0     0                    -43756.74113 -13967.370  68.1%     -   61s
H    0     0                    -37476.99384 -13967.370  62.7%     -   61s
H    0     0                    -37197.87693 -13967.370  62.5%     -   61s
H    0     0                    -34705.72664 -13967.370  59.8%     -   61s
H    0     0                    -34586.02959 -13967.370  59.6%     -   61s
H    0     0                    -34525.60905 -13967.370  59.5%     -   61s
H    0     0                    -34500.53779 -13967.370  59.5%     -   61s
H    0     0                    -34490.86166 -13967.370  59.5%     -   61s
H    0     0                    -34482.25134 -13967.370  59.5%     -   61s
     0     0 -14056.608    0  488 -34482.251 -14056.608  59.2%     -   61s
H    0     0                    -34477.95413 -14056.608  59.2%     -   62s
H    0     0                    -34476.11108 -14056.608  59.2%     -   63s
     0     0 -14316.104    0  489 -34476.111 -14316.104  58.5%     -   66s
     0     0 -14360.143    0  487 -34476.111 -14360.143  58.3%     -   67s
     0     0 -14360.143    0  491 -34476.111 -14360.143  58.3%     -   68s
     0     0 -14360.143    0  491 -34476.111 -14360.143  58.3%     -   69s
     0     0 -14360.143    0  494 -34476.111 -14360.143  58.3%     -   69s
     0     0 -14509.253    0  499 -34476.111 -14509.253  57.9%     -   74s
     0     0 -14509.253    0  497 -34476.111 -14509.253  57.9%     -   75s
     0     0 -14509.253    0  497 -34476.111 -14509.253  57.9%     -   76s
H    0     0                    -34472.08556 -15587.208  54.8%     -   87s
     0     0 -15587.208    0  541 -34472.086 -15587.208  54.8%     -   87s
H    0     0                    -34469.13567 -15587.883  54.8%     -   88s
H    0     0                    -34440.40880 -15587.883  54.7%     -   89s
H    0     0                    -34439.61932 -15587.883  54.7%     -   89s
H    0     0                    -34437.67976 -15587.883  54.7%     -   89s
H    0     0                    -34434.79726 -15587.883  54.7%     -   89s
     0     0 -15819.929    0  521 -34434.797 -15819.929  54.1%     -   96s
     0     0 -15861.691    0  540 -34434.797 -15861.691  53.9%     -  100s
     0     0 -15871.402    0  545 -34434.797 -15871.402  53.9%     -  102s
     0     0 -15877.562    0  551 -34434.797 -15877.562  53.9%     -  103s
     0     0 -15894.550    0  544 -34434.797 -15894.550  53.8%     -  105s
     0     0 -15916.509    0  544 -34434.797 -15916.509  53.8%     -  108s
     0     0 -15919.786    0  545 -34434.797 -15919.786  53.8%     -  110s
     0     0 -15925.150    0  550 -34434.797 -15925.150  53.8%     -  111s
     0     0 -15928.066    0  552 -34434.797 -15928.066  53.7%     -  112s
     0     0 -15928.097    0  553 -34434.797 -15928.097  53.7%     -  112s
H    0     0                    -34432.08079 -16604.359  51.8%     -  137s
H    0     0                    -34423.48849 -16604.359  51.8%     -  137s
H    0     0                    -34420.56586 -16604.359  51.8%     -  137s
H    0     0                    -34417.03017 -16604.359  51.8%     -  137s
H    0     0                    -34414.15355 -16604.359  51.8%     -  137s
H    0     0                    -34388.05799 -16604.359  51.7%     -  137s
     0     0 -16604.359    0  563 -34388.058 -16604.359  51.7%     -  137s
H    0     0                    -34384.26866 -16604.770  51.7%     -  138s
H    0     0                    -34227.27709 -16853.333  50.8%     -  143s
H    0     0                    -34224.44126 -16853.333  50.8%     -  143s
H    0     0                    -34068.44076 -16853.333  50.5%     -  143s
     0     0 -16853.333    0  546 -34068.441 -16853.333  50.5%     -  143s
     0     0 -16938.171    0  570 -34068.441 -16938.171  50.3%     -  150s
H    0     0                    -33781.51441 -16970.110  49.8%     -  153s
     0     0 -16970.110    0  496 -33781.514 -16970.110  49.8%     -  153s
     0     0 -16976.821    0  492 -33781.514 -16976.821  49.7%     -  154s
H    0     0                    -33717.81752 -17017.428  49.5%     -  157s
     0     0 -17017.428    0  570 -33717.818 -17017.428  49.5%     -  157s
     0     0 -17018.863    0  495 -33717.818 -17018.863  49.5%     -  157s
     0     0 -17021.612    0  502 -33717.818 -17021.612  49.5%     -  158s
H    0     0                    -27406.07148 -17021.703  37.9%     -  158s
     0     0 -17021.703    0  503 -27406.071 -17021.703  37.9%     -  158s
H    0     0                    -27402.53286 -17021.703  37.9%     -  162s
H    0     0                    -27176.59071 -17021.703  37.4%     -  162s
H    0     0                    -27174.31990 -17021.703  37.4%     -  162s
H    0     0                    -27156.37616 -17021.703  37.3%     -  162s
H    0     0                    -27132.96383 -17021.703  37.3%     -  162s
H    0     0                    -27118.44679 -17021.703  37.2%     -  162s
H    0     0                    -27116.38876 -17021.703  37.2%     -  162s
H    0     0                    -27059.27250 -17355.377  35.9%     -  172s
H    0     0                    -27046.15854 -17355.377  35.8%     -  172s
H    0     0                    -27019.60335 -17355.377  35.8%     -  172s
H    0     0                    -27014.17761 -17355.377  35.8%     -  172s
     0     0 -17355.377    0  583 -27014.178 -17355.377  35.8%     -  172s
H    0     0                    -24617.20974 -17355.525  29.5%     -  173s
H    0     0                    -24522.73958 -17355.525  29.2%     -  173s
H    0     0                    -24385.44915 -17355.525  28.8%     -  173s
     0     0 -17486.523    0  590 -24385.449 -17486.523  28.3%     -  182s
     0     0 -17526.180    0  584 -24385.449 -17526.180  28.1%     -  185s
     0     0 -17543.453    0  588 -24385.449 -17543.453  28.1%     -  189s
     0     0 -17553.472    0  596 -24385.449 -17553.472  28.0%     -  191s
     0     0 -17557.281    0  592 -24385.449 -17557.281  28.0%     -  192s
     0     0 -17557.711    0  593 -24385.449 -17557.711  28.0%     -  192s
     0     0 -17627.061    0  601 -24385.449 -17627.061  27.7%     -  200s
     0     0 -17640.731    0  597 -24385.449 -17640.731  27.7%     -  204s
     0     0 -17645.198    0  606 -24385.449 -17645.198  27.6%     -  207s
     0     0 -17647.718    0  613 -24385.449 -17647.718  27.6%     -  208s
     0     0 -17651.313    0  610 -24385.449 -17651.313  27.6%     -  209s
     0     0 -17654.069    0  612 -24385.449 -17654.069  27.6%     -  211s
     0     0 -17654.530    0  614 -24385.449 -17654.530  27.6%     -  211s
     0     0 -17711.999    0  601 -24385.449 -17711.999  27.4%     -  218s
H    0     0                    -24376.58841 -17712.329  27.3%     -  219s
H    0     0                    -24323.16666 -17712.329  27.2%     -  219s
H    0     0                    -24298.58769 -17712.329  27.1%     -  219s
H    0     0                    -24288.57291 -17712.329  27.1%     -  219s
     0     0 -17718.788    0  600 -24288.573 -17718.788  27.0%     -  222s
     0     0 -17720.108    0  608 -24288.573 -17720.108  27.0%     -  223s
     0     0 -17720.811    0  615 -24288.573 -17720.811  27.0%     -  224s
     0     0 -17729.639    0  612 -24288.573 -17729.639  27.0%     -  227s
     0     0 -17732.231    0  616 -24288.573 -17732.231  27.0%     -  229s
     0     0 -17737.590    0  617 -24288.573 -17737.590  27.0%     -  231s
     0     0 -17737.984    0  614 -24288.573 -17737.984  27.0%     -  232s
     0     0 -17742.050    0  625 -24288.573 -17742.050  27.0%     -  235s
H    0     0                    -23988.80521 -17742.217  26.0%     -  236s
H    0     0                    -23720.03441 -17742.217  25.2%     -  236s
H    0     0                    -23711.64997 -17742.217  25.2%     -  236s
H    0     0                    -23708.32568 -17742.217  25.2%     -  236s
H    0     0                    -23701.31552 -17742.217  25.1%     -  236s
H    0     0                    -23692.56363 -17742.217  25.1%     -  236s
H    0     0                    -23688.55333 -17742.217  25.1%     -  236s
     0     0 -17743.747    0  627 -23688.553 -17743.747  25.1%     -  237s
     0     0 -17744.099    0  632 -23688.553 -17744.099  25.1%     -  238s
     0     0 -17751.208    0  619 -23688.553 -17751.208  25.1%     -  242s
H    0     0                    -23648.45959 -17751.297  24.9%     -  242s
     0     0 -17753.240    0  622 -23648.460 -17753.240  24.9%     -  243s
     0     0 -17753.434    0  620 -23648.460 -17753.434  24.9%     -  243s
     0     0 -17758.108    0  640 -23648.460 -17758.108  24.9%     -  248s
H    0     0                    -23601.60067 -17758.111  24.8%     -  249s
H    0     0                    -23600.42975 -17758.111  24.8%     -  249s
H    0     0                    -23594.29611 -17758.111  24.7%     -  249s
     0     0 -17759.114    0  644 -23594.296 -17759.114  24.7%     -  249s
     0     0 -17760.865    0  628 -23594.296 -17760.865  24.7%     -  253s
     0     0 -17761.637    0  628 -23594.296 -17761.637  24.7%     -  256s
H    0     0                    -23563.48756 -17761.637  24.6%     -  270s
H    0     0                    -23562.22560 -17761.637  24.6%     -  287s
     0     2 -17761.637    0  628 -23562.226 -17761.637  24.6%     -  288s
     1     4 -17777.266    1  606 -23562.226 -17761.637  24.6%  2041  291s
     3     8 -17936.990    2  616 -23562.226 -17777.847  24.5%  3375  298s
     7    16 -18065.978    3  592 -23562.226 -17938.965  23.9%  5019  312s
    15    30 -18094.779    4  606 -23562.226 -18063.467  23.3%  6167  327s
    31    40     cutoff    5      -23562.226 -18094.964  23.2%  8575  350s
H   45    63                    -23543.16093 -18094.964  23.1%  8990  370s
H   54    63                    -23540.43555 -18094.964  23.1%  8085  370s
H   55    63                    -23486.44548 -18094.964  23.0%  7962  370s
H   62    63                    -23485.68601 -18094.964  23.0%  7543  370s
    72   178 -19479.787    7  369 -23485.686 -18094.964  23.0%  7523  392s
   205   240 -19712.534   12  411 -23485.686 -18094.964  23.0%  4823  402s
H  238   240                    -23481.62532 -18094.964  22.9%  4447  402s
   269   314 -19824.113   14  419 -23481.625 -18094.964  22.9%  4186  414s
H  365   366                    -23478.81169 -18094.964  22.9%  3514  424s
H  405   366                    -23478.06287 -18094.964  22.9%  3290  424s
   447   411 -20007.793   16  267 -23478.063 -18094.964  22.9%  3118  435s
   538   447 -20822.072   18  226 -23478.063 -18094.964  22.9%  2862  446s
H  548   447                    -23476.76636 -18094.964  22.9%  2836  446s
   614   481 -21443.082   21  238 -23476.766 -18094.964  22.9%  2731  456s
   686   504 -22107.512   24  225 -23476.766 -18094.964  22.9%  2627  466s
H  697   504                    -23434.14371 -18094.964  22.8%  2610  466s
   731   560     cutoff   25      -23434.144 -18094.964  22.8%  2574  476s
   821   629 -22372.144   28  219 -23434.144 -18094.964  22.8%  2428  484s
   943   651 -23150.757   34  278 -23434.144 -18094.964  22.8%  2228  495s
H 1019   664                    -23412.86569 -18126.475  22.6%  2145  506s
H 1021   664                    -23403.78556 -18126.475  22.5%  2143  506s
H 1025   664                    -23385.78377 -18126.475  22.5%  2149  506s
  1062   709 -23223.086   37  348 -23385.784 -18126.475  22.5%  2146  517s
  1172   767 -22045.938   14  264 -23385.784 -18219.398  22.1%  2065  527s
  1282   842 -22116.499   15  279 -23385.784 -18219.398  22.1%  1996  539s
  1403   880     cutoff   16      -23385.784 -18327.074  21.6%  1939  550s
H 1404   880                    -23384.50909 -18327.074  21.6%  1938  550s
H 1429   880                    -23381.91968 -18327.074  21.6%  1935  550s
  1471   927     cutoff   16      -23381.920 -18327.074  21.6%  1914  563s
  1584   957     cutoff   17      -23381.920 -18499.316  20.9%  1883  574s
  1632  1012 -19077.086    7  476 -23381.920 -18499.316  20.9%  1889  587s
  1709  1084 -21092.304    8  432 -23381.920 -18499.316  20.9%  1884  599s
  1824  1110 -21103.020    9  431 -23381.920 -18499.316  20.9%  1837  610s
  1920  1158 -22085.069   10  219 -23381.920 -18499.316  20.9%  1821  624s
  2051  1203 -23127.948   11  201 -23381.920 -18789.543  19.6%  1811  636s
  2150  1276     cutoff   12      -23381.920 -18789.543  19.6%  1817  649s
  2299  1342     cutoff   12      -23381.920 -18789.543  19.6%  1791  662s
  2460  1376 infeasible   14      -23381.920 -18789.543  19.6%  1761  675s
  2591  1401 -20550.609    7  335 -23381.920 -18789.543  19.6%  1769  690s
  2628  1429 -20764.809    8  334 -23381.920 -18789.543  19.6%  1789  703s
  2674  1437 -20941.865    9  342 -23381.920 -19172.724  18.0%  1810  718s
  2742  1494 -22122.376   10  229 -23381.920 -19172.829  18.0%  1817  729s
  2847  1543 -22561.977   11  224 -23381.920 -19172.829  18.0%  1816  743s
  3018  1569     cutoff   14      -23381.920 -19172.829  18.0%  1796  760s
  3151  1589 -22163.950   15  263 -23381.920 -19172.829  18.0%  1805  772s
  3195  1616 -22244.726   16  237 -23381.920 -19172.829  18.0%  1823  789s
  3310  1668 -22720.716   15  373 -23381.920 -19172.829  18.0%  1807  807s
  3493  1742     cutoff   18      -23381.920 -19172.829  18.0%  1787  825s
  3681  1826 -23262.435   20  427 -23381.920 -19523.128  16.5%  1778  843s
  3935  1889 -21146.343   17  380 -23381.920 -19576.036  16.3%  1752  861s
  4212  1956 -22087.716   24  219 -23381.920 -19677.209  15.8%  1723  880s
  4417  2064 -22564.551   31  213 -23381.920 -19677.209  15.8%  1735  899s
  4714  2147 -22669.802   14  497 -23381.920 -19730.166  15.6%  1716  919s
  4997  2252 -20806.846   14  535 -23381.920 -19730.166  15.6%  1710  942s
  5310  2297 -21381.410   16  422 -23381.920 -19769.774  15.4%  1699  966s
  5509  2350 -22157.731   17  417 -23381.920 -19835.130  15.2%  1699  988s
  5792  2425 -22210.629   18  420 -23381.920 -19958.687  14.6%  1693 1012s
  6105  2509 infeasible   19      -23381.920 -20032.404  14.3%  1691 1036s
  6412  2510 -21098.656   11  628 -23381.920 -20032.404  14.3%  1695 1118s
  6414  2511 -23124.695   32  448 -23381.920 -20032.404  14.3%  1695 1187s
  6415  2512 -22085.876   12  557 -23381.920 -20032.404  14.3%  1694 1220s
  6416  2513 -20435.207   12  575 -23381.920 -20032.404  14.3%  1694 1233s
  6417  2513 -22938.856   37  641 -23381.920 -20032.404  14.3%  1694 1242s
  6418  2514 -23121.080   46  571 -23381.920 -20032.404  14.3%  1694 1250s
  6419  2515 -21945.779   18  577 -23381.920 -20032.404  14.3%  1693 1255s
  6421  2516 -20639.125   12  607 -23381.920 -20032.404  14.3%  1693 1263s
  6422  2517 -22039.913   24  633 -23381.920 -20032.404  14.3%  1692 1267s
  6423  2517 -23050.988   17  610 -23381.920 -20032.404  14.3%  1692 1271s
  6424  2518 -23023.693   35  618 -23381.920 -20032.404  14.3%  1692 1286s
  6425  2519 -22256.798   40  534 -23381.920 -20032.404  14.3%  1692 1290s
  6427  2520 -21784.571   21  623 -23381.920 -20032.404  14.3%  1691 1298s
  6428  2521 -22869.293   27  628 -23381.920 -20032.404  14.3%  1691 1303s
  6429  2521 -22308.489   14  623 -23381.920 -20032.404  14.3%  1691 1316s
  6430  2522 -20604.930   16  622 -23381.920 -20032.404  14.3%  1690 1324s
  6431  2523 -22683.651   21  623 -23381.920 -20032.404  14.3%  1690 1328s
  6432  2523 -21747.582   22  682 -23381.920 -20032.404  14.3%  1690 1333s
  6433  2524 -22898.931   27  692 -23381.920 -20032.404  14.3%  1690 1335s
  6434  2525 -22954.078   37  694 -23381.920 -20032.404  14.3%  1689 1341s
  6435  2525 -23114.376   30  628 -23381.920 -20032.404  14.3%  1689 1354s
  6436  2526 -22713.796   35  647 -23381.920 -20032.404  14.3%  1689 1356s
  6437  2527 -22261.539   18  644 -23381.920 -20032.404  14.3%  1689 1360s
  6438  2527 -21161.597   14  624 -23381.920 -20032.404  14.3%  1688 1375s
  6439  2528 -21177.729   15  614 -23381.920 -20032.404  14.3%  1688 1380s
  6440  2529 -21092.590    9  694 -23381.920 -20032.404  14.3%  1688 1385s
  6441  2529 -22272.099   13  636 -23381.920 -20032.404  14.3%  1687 1390s
  6442  2530 -21720.323   11  628 -23381.920 -20032.404  14.3%  1687 1403s
  6443  2531 -20494.845    9  638 -23381.920 -20032.404  14.3%  1687 1408s
  6444  2531 -22919.203   28  647 -23381.920 -20032.404  14.3%  1687 1423s
  6445  2532 -21118.230   16  640 -23381.920 -20032.404  14.3%  1686 1428s
  6446  2533 -20618.231   15  703 -23381.920 -20032.404  14.3%  1686 1437s
  6447  2533 -21616.782   15  703 -23381.920 -20032.404  14.3%  1686 1512s
  6448  2534 -20836.647   16  703 -23381.920 -20032.404  14.3%  1686 1548s
  6449  2538 -20032.404   12  696 -23381.920 -20032.404  14.3%  1726 1567s
  6451  2541 -20032.404   13  693 -23381.920 -20032.404  14.3%  1728 1579s
  6455  2548 -20032.404   14  620 -23381.920 -20032.404  14.3%  1731 1591s
  6463  2553 -20032.404   15  571 -23381.920 -20032.404  14.3%  1737 1614s
  6471  2568 -23132.900   16  472 -23381.920 -20032.404  14.3%  1746 1645s
  6495  2585 infeasible   17      -23381.920 -20032.404  14.3%  1805 1673s
  6527  2618 -20738.207   17  475 -23381.920 -20032.404  14.3%  1824 1688s
  6597  2611 -21561.199   19  445 -23381.920 -20032.404  14.3%  1831 1703s
  6707  2599 -21999.936   20  443 -23381.920 -20032.404  14.3%  1828 1716s
  6792  2575 -21215.046   19  479 -23381.920 -20032.404  14.3%  1832 1724s
  6845  2568     cutoff   19      -23381.920 -20032.404  14.3%  1837 1743s
  6903  2554 -22331.043   21  358 -23381.920 -20032.404  14.3%  1840 1756s
  6951  2545     cutoff   21      -23381.920 -20032.404  14.3%  1844 1767s
  7016  2541 -22844.933   23  219 -23381.920 -20032.404  14.3%  1845 1779s
  7089  2512 -23022.601   24  228 -23381.920 -20032.404  14.3%  1844 1792s
  7164  2476     cutoff   23      -23381.920 -20521.466  12.2%  1846 1804s
  7248  2439     cutoff   26      -23381.920 -20862.807  10.8%  1846 1816s
  7334  2403     cutoff   22      -23381.920 -20865.624  10.8%  1846 1827s
  7423  2363     cutoff   22      -23381.920 -21413.962  8.42%  1845 1838s
  7519  2323 -22350.398   22  616 -23381.920 -21483.984  8.12%  1838 1853s
  7634  2288     cutoff   24      -23381.920 -21483.984  8.12%  1829 1862s
H 7697  2139                    -23371.29360 -21483.984  8.08%  1822 1862s
  7760  2130 infeasible   25      -23371.294 -21483.984  8.08%  1812 1873s
  7921  2069     cutoff   22      -23371.294 -21919.042  6.21%  1791 1888s
  8106  2036     cutoff   22      -23371.294 -21919.042  6.21%  1765 1896s
  8331  1996 -23370.794   53   16 -23371.294 -22115.843  5.37%  1733 1903s
  8617  1974 -23364.425   54   18 -23371.294 -22115.843  5.37%  1685 1911s
  9005  1968 -23357.058   55   18 -23371.294 -22438.352  3.99%  1619 1915s
H 9021  1841                    -23363.53181 -22438.352  3.96%  1617 1915s
H 9060  1713                    -23359.09372 -22438.352  3.94%  1611 1915s
 10060  1352 -23350.014   49   26 -23359.094 -22438.352  3.94%  1456 1920s
*10410  1126              69    -23355.79056 -23299.844  0.24%  1408 1920s
*10510   990              72    -23352.01855 -23299.844  0.22%  1395 1920s
*10819   432              71    -23349.55458 -23326.111  0.10%  1356 1921s

Cutting planes:
  Gomory: 1
  Implied bound: 125
  Projected implied bound: 4
  MIR: 588
  Flow cover: 1342
  GUB cover: 1
  Zero half: 7
  RLT: 11
  Relax-and-lift: 100

Explored 11384 nodes (14928392 simplex iterations) in 1922.90 seconds (3318.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23349.6 -23352 -23355.8 ... -23403.8
No other solutions better than -23349.6

Optimal solution found (tolerance 1.00e-06)
Best objective -2.334955458449e+04, best bound -2.334955458449e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1922.91s
  Master Objective (UB) = -23349.55, θ = 94935.72
  Upper Bound (UB) = -23349.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94935.72
  [DEBUG]   ✓ Scenario 0: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94935.72 ≤ Q = 94935.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3f44a44f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc0bb5bb1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7729227.1085
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.104713e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110471.34    0  121 7729227.11 -110471.34   101%     -    0s
H    0     0                    -77520.78074 -110471.34  42.5%     -    0s
H    0     0                    -77964.04833 -110471.34  41.7%     -    0s
     0     0 -83456.792    0  133 -77964.048 -83456.792  7.05%     -    0s
H    0     0                    -79903.89975 -83325.162  4.28%     -    0s
     0     0 -82871.359    0  127 -79903.900 -82871.359  3.71%     -    0s
H    0     0                    -81376.56584 -82870.396  1.84%     -    0s
     0     0 -82869.690    0  126 -81376.566 -82869.690  1.83%     -    0s
     0     0 -82767.518    0  127 -81376.566 -82767.518  1.71%     -    0s
     0     0 -82756.539    0  127 -81376.566 -82756.539  1.70%     -    0s
     0     2 -82756.539    0  127 -81376.566 -82756.539  1.70%     -    0s

Cutting planes:
  Gomory: 36
  Implied bound: 2
  MIR: 201
  RLT: 3

Explored 3268 nodes (25225 simplex iterations) in 0.43 seconds (0.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -81376.6 -79903.9 -77964 ... 1.46279e+13
No other solutions better than -81376.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.137656584334e+04, best bound -8.137656584334e+04, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 94038.72
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81376.57
  [DEBUG]   S×d_nominal = 175415.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175415.28 + -81376.57 = 94038.72
  [DEBUG]   Current θ from Master = 94935.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 897.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24246.55
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 720.6412, Absolute Gap = 720.6412, Relative Gap = 0.030863
  Not converged yet (gap = 720.64 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351343 nonzeros
Model fingerprint: 0x1e032b0e
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57508 rows and 23358 columns
Presolve time: 1.94s
Presolved: 66195 rows, 28822 columns, 412099 nonzeros
Variable types: 26563 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66195 rows, 28822 columns, 412099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20946   -1.5691514e+05   0.000000e+00   9.501852e+06      5s
   33607   -2.9821771e+04   0.000000e+00   4.341568e+08     10s
   41255   -2.2356191e+04   0.000000e+00   1.532803e+06     15s
   46419   -1.6610362e+04   0.000000e+00   2.704536e+07     20s
   52379   -1.4968965e+04   0.000000e+00   7.442334e+06     25s
   57292   -1.4354913e+04   0.000000e+00   7.484708e+07     30s
   62622   -1.3435018e+04   0.000000e+00   5.560385e+05     35s
   67348   -1.3003151e+04   0.000000e+00   4.084356e+05     40s
   71212   -1.2935265e+04   0.000000e+00   1.302155e+06     45s
   74764   -1.2798278e+04   0.000000e+00   3.752344e+07     50s
Concurrent spin time: 2.43s

Solved with dual simplex

Root relaxation: objective -1.017465e+04, 64506 iterations, 53.43 seconds (75.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10174.655    0  448 -222248.17 -10174.655  95.4%     -   56s
H    0     0                    -209562.9746 -10174.655  95.1%     -   56s
H    0     0                    -177057.6480 -10174.655  94.3%     -   56s
H    0     0                    -149996.4758 -10174.655  93.2%     -   56s
H    0     0                    -102336.2903 -10174.655  90.1%     -   56s
H    0     0                    -102003.4625 -10174.655  90.0%     -   56s
H    0     0                    -96413.87855 -10174.655  89.4%     -   56s
H    0     0                    -95975.66684 -10174.655  89.4%     -   57s
H    0     0                    -95711.95893 -10174.655  89.4%     -   57s
H    0     0                    -59939.03292 -10174.655  83.0%     -   57s
H    0     0                    -56771.04852 -10174.655  82.1%     -   57s
H    0     0                    -55685.48607 -10174.655  81.7%     -   57s
H    0     0                    -52149.23495 -10174.655  80.5%     -   59s
H    0     0                    -43817.69551 -10174.655  76.8%     -   59s
H    0     0                    -42729.33852 -10174.655  76.2%     -   59s
H    0     0                    -41197.27060 -10175.620  75.3%     -   59s
H    0     0                    -41051.70893 -10175.620  75.2%     -   59s
H    0     0                    -39156.27665 -13235.566  66.2%     -   76s
H    0     0                    -37916.68539 -13235.566  65.1%     -   76s
H    0     0                    -34628.93139 -13235.566  61.8%     -   76s
H    0     0                    -34301.41348 -13235.566  61.4%     -   76s
     0     0 -13238.061    0  200 -34301.413 -13238.061  61.4%     -   76s
     0     0 -14495.795    0  490 -34301.413 -14495.795  57.7%     -   85s
     0     0 -14520.626    0  494 -34301.413 -14520.626  57.7%     -   87s
     0     0 -14520.626    0  495 -34301.413 -14520.626  57.7%     -   87s
     0     0 -14520.626    0  502 -34301.413 -14520.626  57.7%     -   88s
     0     0 -14520.626    0  508 -34301.413 -14520.626  57.7%     -   89s
     0     0 -14625.373    0  502 -34301.413 -14625.373  57.4%     -   92s
     0     0 -14662.394    0  504 -34301.413 -14662.394  57.3%     -   94s
     0     0 -14662.394    0  502 -34301.413 -14662.394  57.3%     -   96s
     0     0 -14662.394    0  500 -34301.413 -14662.394  57.3%     -   97s
H    0     0                    -34298.26825 -15637.300  54.4%     -  109s
     0     0 -15647.816    0  444 -34298.268 -15647.816  54.4%     -  109s
H    0     0                    -32654.29852 -15647.816  52.1%     -  109s
     0     0 -15802.963    0  459 -32654.299 -15802.963  51.6%     -  116s
     0     0 -15861.411    0  453 -32654.299 -15861.411  51.4%     -  120s
     0     0 -15878.319    0  454 -32654.299 -15878.319  51.4%     -  124s
     0     0 -15914.689    0  460 -32654.299 -15914.689  51.3%     -  127s
     0     0 -15950.538    0  461 -32654.299 -15950.538  51.2%     -  132s
H    0     0                    -31699.11075 -15955.811  49.7%     -  136s
H    0     0                    -31689.27770 -15955.811  49.6%     -  136s
     0     0 -15955.811    0  469 -31689.278 -15955.811  49.6%     -  136s
     0     0 -15957.743    0  475 -31689.278 -15957.743  49.6%     -  138s
H    0     0                    -31650.69487 -15958.214  49.6%     -  139s
     0     0 -15958.214    0  464 -31650.695 -15958.214  49.6%     -  139s
     0     0 -16575.673    0  569 -31650.695 -16575.673  47.6%     -  160s
H    0     0                    -29882.03150 -16576.463  44.5%     -  161s
H    0     0                    -29780.50608 -16576.463  44.3%     -  161s
H    0     0                    -29741.21059 -16576.463  44.3%     -  161s
     0     0 -16756.424    0  573 -29741.211 -16756.424  43.7%     -  167s
     0     0 -16821.493    0  586 -29741.211 -16821.493  43.4%     -  173s
     0     0 -16833.437    0  582 -29741.211 -16833.437  43.4%     -  174s
     0     0 -16834.117    0  585 -29741.211 -16834.117  43.4%     -  175s
     0     0 -17077.324    0  574 -29741.211 -17077.324  42.6%     -  189s
     0     0 -17155.766    0  570 -29741.211 -17155.766  42.3%     -  197s
     0     0 -17217.135    0  579 -29741.211 -17217.135  42.1%     -  203s
     0     0 -17249.037    0  599 -29741.211 -17249.037  42.0%     -  208s
     0     0 -17256.317    0  594 -29741.211 -17256.317  42.0%     -  211s
     0     0 -17264.012    0  585 -29741.211 -17264.012  42.0%     -  213s
     0     0 -17267.358    0  587 -29741.211 -17267.358  41.9%     -  214s
     0     0 -17270.373    0  590 -29741.211 -17270.373  41.9%     -  215s
     0     0 -17271.956    0  589 -29741.211 -17271.956  41.9%     -  216s
     0     0 -17275.501    0  583 -29741.211 -17275.501  41.9%     -  218s
     0     0 -17275.814    0  588 -29741.211 -17275.814  41.9%     -  218s
     0     0 -17340.989    0  583 -29741.211 -17340.989  41.7%     -  227s
     0     0 -17371.972    0  598 -29741.211 -17371.972  41.6%     -  233s
     0     0 -17379.378    0  594 -29741.211 -17379.378  41.6%     -  235s
     0     0 -17380.893    0  600 -29741.211 -17380.893  41.6%     -  236s
     0     0 -17382.611    0  589 -29741.211 -17382.611  41.6%     -  238s
     0     0 -17383.498    0  590 -29741.211 -17383.498  41.6%     -  238s
     0     0 -17429.942    0  587 -29741.211 -17429.942  41.4%     -  245s
     0     0 -17439.902    0  599 -29741.211 -17439.902  41.4%     -  249s
     0     0 -17442.895    0  610 -29741.211 -17442.895  41.4%     -  251s
     0     0 -17455.085    0  609 -29741.211 -17455.085  41.3%     -  253s
     0     0 -17461.537    0  607 -29741.211 -17461.537  41.3%     -  254s
     0     0 -17476.048    0  604 -29741.211 -17476.048  41.2%     -  256s
     0     0 -17476.473    0  610 -29741.211 -17476.473  41.2%     -  256s
     0     0 -17502.264    0  607 -29741.211 -17502.264  41.2%     -  261s
     0     0 -17510.257    0  599 -29741.211 -17510.257  41.1%     -  263s
     0     0 -17515.232    0  595 -29741.211 -17515.232  41.1%     -  265s
     0     0 -17517.213    0  606 -29741.211 -17517.213  41.1%     -  265s
     0     0 -17518.257    0  602 -29741.211 -17518.257  41.1%     -  266s
     0     0 -17518.831    0  601 -29741.211 -17518.831  41.1%     -  266s
     0     0 -17540.140    0  600 -29741.211 -17540.140  41.0%     -  271s
     0     0 -17544.714    0  609 -29741.211 -17544.714  41.0%     -  274s
     0     0 -17547.425    0  609 -29741.211 -17547.425  41.0%     -  275s
     0     0 -17548.047    0  610 -29741.211 -17548.047  41.0%     -  275s
     0     0 -17570.418    0  607 -29741.211 -17570.418  40.9%     -  280s
     0     0 -17575.166    0  617 -29741.211 -17575.166  40.9%     -  281s
     0     0 -17577.186    0  617 -29741.211 -17577.186  40.9%     -  282s
     0     0 -17578.488    0  613 -29741.211 -17578.488  40.9%     -  283s
     0     0 -17580.649    0  616 -29741.211 -17580.649  40.9%     -  284s
     0     0 -17584.017    0  604 -29741.211 -17584.017  40.9%     -  285s
     0     0 -17585.305    0  623 -29741.211 -17585.305  40.9%     -  286s
     0     0 -17585.849    0  623 -29741.211 -17585.849  40.9%     -  286s
     0     0 -17597.410    0  610 -29741.211 -17597.410  40.8%     -  290s
     0     0 -17600.169    0  611 -29741.211 -17600.169  40.8%     -  294s
     0     0 -17600.612    0  617 -29741.211 -17600.612  40.8%     -  294s
     0     0 -17604.820    0  611 -29741.211 -17604.820  40.8%     -  298s
H    0     0                    -29035.12100 -17606.119  39.4%     -  299s
H    0     0                    -29003.96513 -17606.119  39.3%     -  299s
H    0     0                    -28958.03832 -17606.119  39.2%     -  299s
H    0     0                    -28947.59681 -17606.119  39.2%     -  299s
H    0     0                    -28927.75049 -17606.119  39.1%     -  299s
H    0     0                    -28919.13965 -17606.119  39.1%     -  299s
H    0     0                    -28887.98378 -17606.119  39.1%     -  299s
     0     0 -17606.119    0  611 -28887.984 -17606.119  39.1%     -  300s
     0     0 -17610.389    0  623 -28887.984 -17610.389  39.0%     -  303s
H    0     0                    -28837.06675 -17611.041  38.9%     -  311s
H    0     0                    -28789.14360 -17611.041  38.8%     -  313s
     0     0 -17612.574    0  630 -28789.144 -17612.574  38.8%     -  317s
     0     0 -17612.858    0  626 -28789.144 -17612.858  38.8%     -  317s
     0     0 -17618.209    0  541 -28789.144 -17618.209  38.8%     -  320s
     0     0 -17622.497    0  542 -28789.144 -17622.497  38.8%     -  322s
     0     0 -17622.497    0  631 -28789.144 -17622.497  38.8%     -  323s
     0     0 -17622.497    0  632 -28789.144 -17622.497  38.8%     -  325s
     0     0 -17622.497    0  632 -28789.144 -17622.497  38.8%     -  329s
     0     2 -17622.543    0  632 -28789.144 -17622.543  38.8%     -  412s
     1     4 -17659.037    1  613 -28789.144 -17622.543  38.8%  3380  418s
     3     7 -18605.634    2  531 -28789.144 -17660.122  38.7%  4747  426s
     6    14 -18353.069    3  488 -28789.144 -17660.122  38.7%  5815  440s
    13    28 -18499.414    4  567 -28789.144 -17992.457  37.5%  7221  455s
    27    42 -19498.855    4  544 -28789.144 -18158.575  36.9% 10668  486s
    41    74 -19939.610    6  297 -28789.144 -18158.575  36.9%  9952  524s
H   42    74                    -28775.71713 -18158.575  36.9%  9715  524s
H   42    74                    -28636.62048 -18158.575  36.6%  9715  524s
    73   189 -20543.068    7  285 -28636.620 -18239.454  36.3%  8553  549s
   188   274 -20641.923   10  296 -28636.620 -18239.818  36.3%  5627  563s
   285   325 -21098.688   12  271 -28636.620 -18239.818  36.3%  4628  576s
   380   363 -22046.289   15  270 -28636.620 -18239.818  36.3%  4072  590s
   460   372 -22098.173   16  264 -28636.620 -18252.426  36.3%  3879  603s
H  485   372                    -27871.03546 -18252.426  34.5%  3868  603s
   503   408 -23129.577   17  236 -27871.035 -18252.426  34.5%  3935  616s
   555   448 -23880.924   18  242 -27871.035 -18252.426  34.5%  4210  629s
   617   481 -24521.783   19  329 -27871.035 -18252.426  34.5%  4304  640s
   674   507 -24826.459   20  328 -27871.035 -18252.426  34.5%  4290  652s
H  675   507                    -23968.93136 -18252.426  23.8%  4283  652s
H  689   507                    -23531.21273 -18252.426  22.4%  4342  652s
   704   488     cutoff   21      -23531.213 -18252.426  22.4%  4362  666s
   785   506 -19889.462   10  487 -23531.213 -18252.426  22.4%  4280  679s
   819   518 -20092.837   11  543 -23531.213 -18252.426  22.4%  4420  691s
H  831   518                    -23475.48959 -18252.426  22.2%  4410  691s
   875   541 -20203.170   12  463 -23475.490 -18252.426  22.2%  4487  705s
   914   561 -20428.497   13  461 -23475.490 -18252.426  22.2%  4537  718s
H  939   561                    -23473.19120 -18252.426  22.2%  4570  718s
   954   568 -20856.673   14  462 -23473.191 -18252.426  22.2%  4565  732s
  1031   585     cutoff   15      -23473.191 -18252.426  22.2%  4496  747s
  1112   590 -22750.215   15  328 -23473.191 -18292.469  22.1%  4543  762s
  1179   607 -23026.241   17  346 -23473.191 -18292.469  22.1%  4538  778s
  1262   620 -20337.892    6  460 -23473.191 -18934.549  19.3%  4566  793s
  1347   655 -21352.559    8  448 -23473.191 -19103.161  18.6%  4608  810s
  1450   662 -22000.390   10  364 -23473.191 -19103.161  18.6%  4542  828s
  1549   661     cutoff   13      -23473.191 -19103.161  18.6%  4538  844s
  1654   665     cutoff   14      -23473.191 -19128.494  18.5%  4517  860s
  1708   695 -22220.623   10  296 -23473.191 -19128.494  18.5%  4543  879s
H 1716   695                    -23451.98649 -19128.494  18.4%  4547  879s
H 1779   695                    -23409.09215 -19128.494  18.3%  4558  879s
  1782   708 infeasible   12      -23409.092 -19128.494  18.3%  4569  896s
  1909   729     cutoff   12      -23409.092 -19675.283  16.0%  4542  917s
  2033   730 -22763.256   10  299 -23409.092 -19679.668  15.9%  4522  936s
  2164   734 -20365.463   10  215 -23409.092 -19679.668  15.9%  4519  955s
H 2169   734                    -23385.69476 -19679.668  15.8%  4511  955s
  2242   738 -23095.321   14  188 -23385.695 -19759.304  15.5%  4521  974s
H 2278   738                    -23381.91968 -19768.953  15.5%  4512  974s
  2332   757     cutoff   15      -23381.920 -19768.953  15.5%  4469  996s
  2485   753 -22229.876   13  246 -23381.920 -19768.953  15.5%  4458 1017s
  2657   766     cutoff   15      -23381.920 -19882.943  15.0%  4435 1039s
  2810   762 -23208.093   15  193 -23381.920 -19889.602  14.9%  4445 1063s
  3009   738     cutoff   12      -23381.920 -20093.901  14.1%  4393 1086s
  3215   743 -21830.376   10  237 -23381.920 -20310.227  13.1%  4316 1111s
  3355   743     cutoff   13      -23381.920 -20310.227  13.1%  4363 1133s
  3421   754 -21970.706   10  258 -23381.920 -20367.966  12.9%  4380 1161s
  3583   746 -21928.742    8  306 -23381.920 -20367.966  12.9%  4358 1185s
  3777   739 infeasible   10      -23381.920 -20622.828  11.8%  4362 1210s
  3844   750 -22385.220    9  205 -23381.920 -20688.379  11.5%  4382 1235s
  3955   748     cutoff   10      -23381.920 -20748.427  11.3%  4368 1264s
  4157   702 -22261.416    9  225 -23381.920 -20748.427  11.3%  4329 1291s
  4404   636 infeasible   11      -23381.920 -20795.940  11.1%  4284 1321s
  4715   455     cutoff   11      -23381.920 -20964.295  10.3%  4200 1351s
  5094   296 -22822.462    9  351 -23381.920 -21447.705  8.27%  4081 1381s
  5477   118 -23087.626   12  205 -23381.920 -21711.877  7.14%  3925 1412s
  5993    92     cutoff    6      -23381.920 -22165.552  5.20%  3669 1419s
  6459   378 -23341.063   42   34 -23381.920 -23159.680  0.95%  3415 1423s
  7526   734 -23283.975   48   60 -23381.920 -23191.585  0.81%  2939 1426s
 10886  1343 -23380.883   52   32 -23381.920 -23313.524  0.29%  2045 1433s
 13094  1575     cutoff   48      -23381.920 -23345.166  0.16%  1706 1437s
 15718  1633 -23373.413   44   36 -23381.920 -23351.181  0.13%  1427 1441s
 17385  1564 -23377.714   54   20 -23381.920 -23353.956  0.12%  1293 1446s
 18702  1567 -23363.022   52   24 -23381.920 -23354.628  0.12%  1204 1450s
 18784  1378 -23374.036   54   28 -23381.920 -23354.628  0.12%  1199 1456s
 20890  1369     cutoff   50      -23381.920 -23359.021  0.10%  1081 1460s
 20947  1198 -23380.714   46   36 -23381.920 -23359.021  0.10%  1078 1465s
 24110     0     cutoff   46      -23381.920 -23361.785  0.09%   940 1471s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 31
  MIR: 926
  Flow cover: 1645
  Zero half: 9
  RLT: 27
  Relax-and-lift: 69

Explored 24849 nodes (22991378 simplex iterations) in 1471.87 seconds (2759.75 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23381.9 -23385.7 -23409.1 ... -28636.6
No other solutions better than -23381.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.338191967775e+04, best bound -2.338191967775e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1471.96s
  Master Objective (UB) = -23381.92, θ = 94995.91
  Upper Bound (UB) = -23381.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94995.91
  [DEBUG]   ✓ Scenario 0: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94995.91 ≤ Q = 94995.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94995.91 ≤ Q = 94995.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94995.91 ≤ Q = 94995.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3d9ea404
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3d9ea404
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7739585.4568
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.105177e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110517.68    0  122 7739585.46 -110517.68   101%     -    0s
H    0     0                    -77778.28315 -110517.68  42.1%     -    0s
H    0     0                    -78180.98631 -110517.68  41.4%     -    0s
     0     0 -83641.854    0  133 -78180.986 -83641.854  6.98%     -    0s
H    0     0                    -79953.42345 -83596.541  4.56%     -    0s
     0     0 -83391.164    0  133 -79953.423 -83391.164  4.30%     -    0s
     0     0 -83121.477    0  136 -79953.423 -83121.477  3.96%     -    0s
H    0     0                    -80507.17470 -83107.458  3.23%     -    0s
     0     0 -83107.458    0  136 -80507.175 -83107.458  3.23%     -    0s
     0     0 -82959.487    0  135 -80507.175 -82959.487  3.05%     -    0s
     0     0 -82953.133    0  135 -80507.175 -82953.133  3.04%     -    0s
     0     2 -82952.799    0  135 -80507.175 -82952.799  3.04%     -    0s
H  175   243                    -80531.51538 -82448.343  2.38%   6.4    0s
H  716   617                    -81491.81482 -82213.572  0.89%   5.2    0s
* 2392  1042              56    -81552.75091 -81914.359  0.44%   4.7    0s
H 2603  1042                    -81556.96290 -81914.359  0.44%   4.6    0s
* 3051  1194              47    -81558.97538 -81880.246  0.39%   4.5    0s
H 3359  1370                    -81579.87143 -81868.572  0.35%   4.4    0s
H 4914  1501                    -81589.24939 -81711.273  0.15%   4.3    0s

Cutting planes:
  Gomory: 30
  MIR: 248
  RLT: 1

Explored 8668 nodes (39482 simplex iterations) in 0.44 seconds (0.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -81589.2 -81579.9 -81559 ... -78181
No other solutions better than -81589.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.158924939298e+04, best bound -8.158924939298e+04, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 93942.03
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81589.25
  [DEBUG]   S×d_nominal = 175531.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175531.28 + -81589.25 = 93942.03
  [DEBUG]   Current θ from Master = 94995.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1053.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24435.80
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 688.2761, Absolute Gap = 688.2761, Relative Gap = 0.029436
  Not converged yet (gap = 688.28 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394571 nonzeros
Model fingerprint: 0x4b13d006
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 64699 rows and 26279 columns
Presolve time: 3.17s
Presolved: 74294 rows, 32141 columns, 462914 nonzeros
Variable types: 29882 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 74294 rows, 32141 columns, 462914 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17207   -1.9273936e+05   0.000000e+00   9.276488e+05      5s
   34179   -4.7518118e+04   0.000000e+00   1.138815e+08     10s
   42027   -2.7792043e+04   0.000000e+00   7.600999e+06     15s
   47957   -2.3320318e+04   0.000000e+00   2.179914e+06     20s
   52164   -2.2642356e+04   0.000000e+00   9.333901e+07     25s
   56926   -2.1841941e+04   0.000000e+00   9.058880e+05     30s
   61501   -1.9649057e+04   0.000000e+00   1.441862e+07     35s
   66324   -1.8158208e+04   0.000000e+00   7.343516e+05     40s
   71096   -1.6716977e+04   0.000000e+00   1.734913e+06     45s
   74892   -1.6558190e+04   0.000000e+00   1.856243e+06     50s
   79358   -1.6339343e+04   0.000000e+00   6.508319e+05     55s
   83664   -1.4823569e+04   0.000000e+00   3.175589e+06     60s
   87204   -1.4195545e+04   0.000000e+00   6.308299e+05     65s
   90480   -1.4067523e+04   0.000000e+00   3.801396e+06     70s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective -1.017465e+04, 65027 iterations, 67.93 seconds (87.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -10174.655    0  448 -222248.17 -10174.655  95.4%     -   72s
H    0     0                    -218798.3877 -10174.655  95.3%     -   72s
H    0     0                    -101373.8070 -10174.655  90.0%     -   72s
H    0     0                    -99157.04561 -10174.655  89.7%     -   72s
H    0     0                    -98105.61452 -10174.655  89.6%     -   72s
H    0     0                    -82178.69162 -10174.655  87.6%     -   72s
H    0     0                    -81740.47990 -10174.655  87.6%     -   73s
H    0     0                    -41065.41606 -10174.655  75.2%     -   73s
H    0     0                    -41051.70893 -10174.655  75.2%     -   73s
H    0     0                    -40595.80262 -13844.934  65.9%     -   99s
H    0     0                    -39792.00344 -13844.934  65.2%     -   99s
H    0     0                    -35864.35626 -13844.934  61.4%     -   99s
H    0     0                    -34526.44669 -13844.934  59.9%     -   99s
H    0     0                    -34301.41348 -13844.934  59.6%     -   99s
     0     0 -14344.656    0  493 -34301.413 -14344.656  58.2%     -  100s
     0     0 -14501.900    0  488 -34301.413 -14501.900  57.7%     -  106s
     0     0 -14501.900    0  491 -34301.413 -14501.900  57.7%     -  108s
     0     0 -14566.175    0  487 -34301.413 -14566.175  57.5%     -  109s
     0     0 -14566.175    0  494 -34301.413 -14566.175  57.5%     -  110s
     0     0 -14606.406    0  505 -34301.413 -14606.406  57.4%     -  112s
     0     0 -14653.055    0  512 -34301.413 -14653.055  57.3%     -  116s
     0     0 -14653.055    0  503 -34301.413 -14653.055  57.3%     -  120s
     0     0 -14653.055    0  503 -34301.413 -14653.055  57.3%     -  121s
     0     0 -15765.173    0  456 -34301.413 -15765.173  54.0%     -  132s
H    0     0                    -32742.57441 -15765.392  51.9%     -  133s
     0     0 -15827.416    0  531 -32742.574 -15827.416  51.7%     -  137s
     0     0 -15870.409    0  477 -32742.574 -15870.409  51.5%     -  142s
     0     0 -15938.448    0  473 -32742.574 -15938.448  51.3%     -  145s
     0     0 -15948.663    0  475 -32742.574 -15948.663  51.3%     -  147s
     0     0 -15949.060    0  477 -32742.574 -15949.060  51.3%     -  148s
     0     0 -16530.602    0  639 -32742.574 -16530.602  49.5%     -  171s
     0     0 -16714.892    0  638 -32742.574 -16714.892  49.0%     -  182s
H    0     0                    -26727.05234 -16772.599  37.2%     -  188s
H    0     0                    -26480.01965 -16772.599  36.7%     -  188s
H    0     0                    -24504.19195 -16772.599  31.6%     -  188s
H    0     0                    -24495.08220 -16772.599  31.5%     -  188s
H    0     0                    -24458.14631 -16772.599  31.4%     -  188s
H    0     0                    -24411.65332 -16772.599  31.3%     -  188s
H    0     0                    -24392.77457 -16772.599  31.2%     -  188s
     0     0 -16772.599    0  572 -24392.775 -16772.599  31.2%     -  188s
     0     0 -16803.904    0  579 -24392.775 -16803.904  31.1%     -  191s
     0     0 -16810.768    0  585 -24392.775 -16810.768  31.1%     -  194s
     0     0 -16815.111    0  651 -24392.775 -16815.111  31.1%     -  196s
H    0     0                    -24286.22102 -16815.211  30.8%     -  196s
H    0     0                    -24269.61390 -16815.211  30.7%     -  196s
H    0     0                    -24234.22536 -16815.211  30.6%     -  196s
H    0     0                    -24231.69789 -16815.211  30.6%     -  196s
     0     0 -16815.211    0  653 -24231.698 -16815.211  30.6%     -  196s
H    0     0                    -24228.43485 -16815.211  30.6%     -  200s
H    0     0                    -24215.62634 -17090.768  29.4%     -  210s
H    0     0                    -24186.97768 -17090.768  29.3%     -  210s
H    0     0                    -24176.94328 -17090.768  29.3%     -  210s
H    0     0                    -24172.79828 -17090.768  29.3%     -  210s
     0     0 -17090.768    0  593 -24172.798 -17090.768  29.3%     -  211s
H    0     0                    -24172.32276 -17091.560  29.3%     -  212s
     0     0 -17146.888    0  595 -24172.323 -17146.888  29.1%     -  219s
     0     0 -17167.447    0  595 -24172.323 -17167.447  29.0%     -  223s
     0     0 -17199.342    0  608 -24172.323 -17199.342  28.8%     -  227s
     0     0 -17206.632    0  606 -24172.323 -17206.632  28.8%     -  229s
     0     0 -17222.116    0  614 -24172.323 -17222.116  28.8%     -  231s
     0     0 -17224.745    0  620 -24172.323 -17224.745  28.7%     -  233s
     0     0 -17239.479    0  605 -24172.323 -17239.479  28.7%     -  235s
     0     0 -17241.821    0  603 -24172.323 -17241.821  28.7%     -  236s
     0     0 -17248.167    0  614 -24172.323 -17248.167  28.6%     -  238s
     0     0 -17268.670    0  613 -24172.323 -17268.670  28.6%     -  240s
     0     0 -17277.242    0  622 -24172.323 -17277.242  28.5%     -  243s
     0     0 -17278.052    0  621 -24172.323 -17278.052  28.5%     -  243s
     0     0 -17382.378    0  602 -24172.323 -17382.378  28.1%     -  254s
H    0     0                    -24166.18912 -17382.382  28.1%     -  254s
     0     0 -17394.626    0  595 -24166.189 -17394.626  28.0%     -  258s
     0     0 -17416.007    0  608 -24166.189 -17416.007  27.9%     -  263s
     0     0 -17428.932    0  616 -24166.189 -17428.932  27.9%     -  266s
     0     0 -17432.551    0  611 -24166.189 -17432.551  27.9%     -  267s
     0     0 -17433.433    0  619 -24166.189 -17433.433  27.9%     -  268s
     0     0 -17466.534    0  524 -24166.189 -17466.534  27.7%     -  276s
H    0     0                    -24163.45159 -17466.672  27.7%     -  280s
H    0     0                    -24159.53879 -17479.104  27.7%     -  285s
     0     0 -17479.104    0  524 -24159.539 -17479.104  27.7%     -  285s
     0     0 -17484.151    0  613 -24159.539 -17484.151  27.6%     -  288s
     0     0 -17487.738    0  604 -24159.539 -17487.738  27.6%     -  289s
     0     0 -17488.685    0  612 -24159.539 -17488.685  27.6%     -  290s
     0     0 -17495.573    0  592 -24159.539 -17495.573  27.6%     -  293s
     0     0 -17497.495    0  612 -24159.539 -17497.495  27.6%     -  295s
     0     0 -17500.856    0  606 -24159.539 -17500.856  27.6%     -  298s
     0     0 -17502.590    0  610 -24159.539 -17502.590  27.6%     -  299s
     0     0 -17503.485    0  609 -24159.539 -17503.485  27.6%     -  300s
H    0     0                    -23861.88587 -17527.031  26.5%     -  305s
H    0     0                    -23861.44244 -17527.031  26.5%     -  305s
H    0     0                    -23630.74968 -17527.031  25.8%     -  305s
     0     0 -17527.031    0  623 -23630.750 -17527.031  25.8%     -  305s
H    0     0                    -23550.75621 -17527.522  25.6%     -  305s
H    0     0                    -23501.12817 -17527.522  25.4%     -  305s
H    0     0                    -23500.29362 -17527.522  25.4%     -  305s
     0     0 -17533.769    0  620 -23500.294 -17533.769  25.4%     -  307s
     0     0 -17534.786    0  622 -23500.294 -17534.786  25.4%     -  309s
     0     0 -17537.203    0  622 -23500.294 -17537.203  25.4%     -  310s
     0     0 -17537.538    0  623 -23500.294 -17537.538  25.4%     -  310s
     0     0 -17560.190    0  623 -23500.294 -17560.190  25.3%     -  315s
     0     0 -17561.696    0  635 -23500.294 -17561.696  25.3%     -  317s
     0     0 -17563.965    0  627 -23500.294 -17563.965  25.3%     -  318s
     0     0 -17565.355    0  625 -23500.294 -17565.355  25.3%     -  319s
     0     0 -17565.594    0  629 -23500.294 -17565.594  25.3%     -  320s
     0     0 -17573.702    0  631 -23500.294 -17573.702  25.2%     -  324s
     0     0 -17580.665    0  627 -23500.294 -17580.665  25.2%     -  327s
     0     0 -17581.981    0  620 -23500.294 -17581.981  25.2%     -  329s
     0     0 -17582.303    0  627 -23500.294 -17582.303  25.2%     -  330s
     0     0 -17588.120    0  627 -23500.294 -17588.120  25.2%     -  334s
     0     0 -17589.948    0  625 -23500.294 -17589.948  25.2%     -  337s
     0     0 -17598.961    0  630 -23500.294 -17598.961  25.1%     -  339s
     0     0 -17599.293    0  623 -23500.294 -17599.293  25.1%     -  340s
     0     0 -17612.388    0  624 -23500.294 -17612.388  25.1%     -  347s
     0     0 -17615.118    0  631 -23500.294 -17615.118  25.0%     -  350s
     0     0 -17617.827    0  635 -23500.294 -17617.827  25.0%     -  351s
     0     0 -17618.271    0  548 -23500.294 -17618.271  25.0%     -  352s
     0     0 -17622.888    0  544 -23500.294 -17622.888  25.0%     -  355s
H    0     0                    -23493.26287 -17622.993  25.0%     -  388s
H    0     0                    -23489.70043 -17622.993  25.0%     -  407s
     0     0 -17624.629    0  541 -23489.700 -17624.629  25.0%     -  415s
     0     0 -17625.028    0  541 -23489.700 -17625.028  25.0%     -  416s
     0     0 -17625.555    0  539 -23489.700 -17625.555  25.0%     -  419s
     0     0 -17625.637    0  543 -23489.700 -17625.637  25.0%     -  421s
     0     0 -17625.750    0  546 -23489.700 -17625.750  25.0%     -  423s
     0     0 -17625.856    0  545 -23489.700 -17625.856  25.0%     -  423s
     0     0 -17625.946    0  542 -23489.700 -17625.946  25.0%     -  425s
     0     0 -17625.995    0  542 -23489.700 -17625.995  25.0%     -  430s
H    0     0                    -23487.35883 -17626.031  25.0%     -  456s
H    0     0                    -23487.11468 -17626.031  25.0%     -  456s
H    0     0                    -23485.94351 -17626.038  25.0%     -  519s
     0     2 -17626.038    0  542 -23485.944 -17626.038  25.0%     -  521s
     1     3 -18287.606    1  405 -23485.944 -17626.927  24.9%  7304  529s
     2     6 -18347.668    2  475 -23485.944 -17626.927  24.9%  5184  535s
     5    12 -19026.211    3  484 -23485.944 -17809.533  24.2%  5962  554s
    11    24 -19134.084    4  476 -23485.944 -18024.372  23.3%  7068  568s
    23    32 -19203.940    4  464 -23485.944 -18064.742  23.1%  7100  589s
    35    54 -19187.561    6  567 -23485.944 -18064.742  23.1%  8311  627s
    63    81 -19367.056    7  557 -23485.944 -18064.742  23.1%  8758  647s
    94   110 -19373.171    8  470 -23485.944 -18064.742  23.1%  8190  678s
   129   216 -19899.985    9  285 -23485.944 -18064.742  23.1%  7492  694s
   247   299 -19404.852    9  469 -23485.944 -18064.742  23.1%  5253  706s
   344   376     cutoff   10      -23485.944 -18064.742  23.1%  4377  717s
   431   431 -19515.685   10  555 -23485.944 -18064.742  23.1%  3952  725s
   506   481 -21483.870   19  237 -23485.944 -18064.742  23.1%  3762  738s
   570   541 -19911.431   10  279 -23485.944 -18064.742  23.1%  3675  748s
   643   598     cutoff   11      -23485.944 -18064.742  23.1%  3579  755s
   719   640     cutoff   12      -23485.944 -18064.742  23.1%  3531  762s
   804   695 infeasible   13      -23485.944 -18064.742  23.1%  3431  769s
   887   749 -20119.542   14  380 -23485.944 -18064.742  23.1%  3375  781s
   967   765 -20162.417   15  362 -23485.944 -18064.742  23.1%  3323  791s
H  982   765                    -23480.10411 -18064.742  23.1%  3311  791s
H 1007   765                    -23474.84398 -18064.742  23.0%  3300  791s
  1011   844 -20180.203   16  366 -23474.844 -18064.742  23.0%  3304  803s
  1116   866 -20346.215   17  365 -23474.844 -18064.742  23.0%  3216  815s
  1158   898 -22504.892   18  398 -23474.844 -18064.742  23.0%  3229  839s
H 1160   898                    -23474.38593 -18064.742  23.0%  3224  839s
  1214   957     cutoff   18      -23474.386 -18064.742  23.0%  3209  846s
  1361  1009 -22694.606   20  344 -23474.386 -18064.742  23.0%  3058  855s
  1489  1035     cutoff   20      -23474.386 -18064.742  23.0%  3008  868s
  1622  1069 -22906.185   25  358 -23474.386 -18064.742  23.0%  2984  879s
  1678  1097     cutoff   27      -23474.386 -18064.742  23.0%  3003  890s
  1792  1143     cutoff   31      -23474.386 -18064.742  23.0%  2992  901s
  1920  1177 -19831.915    9  263 -23474.386 -18064.742  23.0%  2958  914s
  2034  1208 -19992.365   11  340 -23474.386 -18064.742  23.0%  2984  925s
  2133  1249     cutoff   13      -23474.386 -18375.192  21.7%  3037  940s
H 2146  1249                    -23471.22339 -18375.192  21.7%  3046  940s
  2253  1311 -21737.407   14  373 -23471.223 -18379.342  21.7%  3020  954s
  2386  1358     cutoff   15      -23471.223 -18379.342  21.7%  3002  968s
  2527  1405 -21834.173   17  316 -23471.223 -18379.342  21.7%  3030  983s
H 2543  1405                    -23466.35171 -18379.342  21.7%  3024  983s
  2654  1473 -21874.683   18  306 -23466.352 -18379.342  21.7%  3029 1000s
  2819  1500 infeasible   22      -23466.352 -18379.342  21.7%  3035 1017s
  2920  1573     cutoff   24      -23466.352 -18379.342  21.7%  3054 1034s
  3051  1642 -23029.581   28  200 -23466.352 -18418.165  21.5%  3068 1050s
  3224  1705 -20267.060    8  480 -23466.352 -18418.165  21.5%  3070 1067s
  3379  1791 -20396.680   10  405 -23466.352 -18418.165  21.5%  3096 1083s
  3549  1852 -20839.515   13  391 -23466.352 -18988.252  19.1%  3103 1099s
  3726  1909 -20939.098   15  392 -23466.352 -18988.252  19.1%  3121 1117s
  3908  1965 -21258.895   18  286 -23466.352 -18988.252  19.1%  3149 1135s
  4068  2039 -22233.501   21  348 -23466.352 -19661.869  16.2%  3170 1155s
  4261  2109 -22675.870   25  271 -23466.352 -19665.874  16.2%  3174 1176s
  4487  2231 infeasible   25      -23466.352 -19838.669  15.5%  3179 1194s
  4510  2231 -22141.777   12  233 -23466.352 -19838.669  15.5%  3183 1195s
  4749  2283 -21291.308   10  227 -23466.352 -19900.984  15.2%  3165 1218s
  4931  2398 -21837.492   13  230 -23466.352 -19900.984  15.2%  3159 1238s
  5205  2399 -21676.995   10  542 -23466.352 -19900.984  15.2%  3147 1374s
  5207  2400 -21652.089   14  448 -23466.352 -19900.984  15.2%  3146 1440s
  5208  2401 -22312.415   24  554 -23466.352 -19900.984  15.2%  3145 1495s
  5209  2402 -20548.667   18  621 -23466.352 -19900.984  15.2%  3145 1517s
  5210  2402 -23077.384   47  582 -23466.352 -19900.984  15.2%  3144 1530s
  5211  2403 -22730.952   26  594 -23466.352 -19900.984  15.2%  3144 1542s
  5212  2404 -22387.103   23  593 -23466.352 -19900.984  15.2%  3143 1554s
  5213  2404 -22795.197   17  608 -23466.352 -19900.984  15.2%  3142 1558s
  5214  2405 -20374.188    9  612 -23466.352 -19900.984  15.2%  3142 1561s
  5215  2406 -22165.448   24  594 -23466.352 -19900.984  15.2%  3141 1566s
  5217  2407 -20695.737   16  600 -23466.352 -19900.984  15.2%  3140 1573s
  5218  2408 -23050.614   34  603 -23466.352 -19900.984  15.2%  3139 1578s
  5219  2408 -22131.459   17  610 -23466.352 -19900.984  15.2%  3139 1585s
  5220  2409 -20610.898   17  612 -23466.352 -19900.984  15.2%  3138 1608s
  5221  2410 -22244.425   15  666 -23466.352 -19900.984  15.2%  3137 1616s
  5222  2410 -20872.637   21  690 -23466.352 -19900.984  15.2%  3137 1623s
  5223  2411 -23267.756   12  620 -23466.352 -19900.984  15.2%  3136 1630s
  5224  2412 -22651.796   24  549 -23466.352 -19900.984  15.2%  3136 1637s
  5225  2412 -20650.954   17  639 -23466.352 -19900.984  15.2%  3135 1660s
  5226  2413 -22334.650   21  637 -23466.352 -19900.984  15.2%  3134 1670s
  5227  2414 -22361.079   24  642 -23466.352 -19900.984  15.2%  3134 1677s
  5228  2414 -22537.544   37  545 -23466.352 -19900.984  15.2%  3133 1684s
  5229  2415 -22606.237   22  630 -23466.352 -19900.984  15.2%  3133 1689s
  5230  2416 -22818.703   26  632 -23466.352 -19900.984  15.2%  3132 1697s
  5231  2416 -21985.533   33  635 -23466.352 -19900.984  15.2%  3131 1724s
  5232  2417 -21795.985   17  655 -23466.352 -19900.984  15.2%  3131 1730s
  5233  2418 -23017.542   37  650 -23466.352 -19900.984  15.2%  3130 1739s
  5234  2418 -20278.005   13  640 -23466.352 -19900.984  15.2%  3130 1759s
  5235  2419 -20524.428   14  660 -23466.352 -19900.984  15.2%  3129 1769s
  5236  2420 -21222.536   26  655 -23466.352 -19900.984  15.2%  3128 1776s
  5237  2420 -22449.307   17  657 -23466.352 -19900.984  15.2%  3128 1781s
  5238  2421 -20779.074   10  660 -23466.352 -19900.984  15.2%  3127 1789s
  5239  2422 -21692.556   24  625 -23466.352 -19900.984  15.2%  3127 1821s
  5240  2422 -20273.899    9  706 -23466.352 -19900.984  15.2%  3126 1832s
  5241  2423 -22144.134   20  647 -23466.352 -19900.984  15.2%  3126 1840s
  5242  2424 -23038.539   28  654 -23466.352 -19900.984  15.2%  3125 1847s
  5243  2424 -23077.384   47  638 -23466.352 -19900.984  15.2%  3124 1855s
  5244  2425 -22408.605   27  638 -23466.352 -19900.984  15.2%  3124 1873s
H 5244  2303                    -23429.99826 -19900.984  15.1%  3124 1877s
H 5244  2187                    -23429.30143 -19900.984  15.1%  3124 1877s
H 5244  2077                    -23426.64596 -19900.984  15.0%  3124 1877s
H 5244  1972                    -23420.25219 -19900.984  15.0%  3124 1877s
  5245  1973 -22877.391   22  626 -23420.252 -19900.984  15.0%  3123 1881s
  5246  1973 -21425.584   18  701 -23420.252 -19900.984  15.0%  3123 1897s
  5247  1974 -21746.940   28  719 -23420.252 -19900.984  15.0%  3122 1909s
  5248  1975 -22570.372   27  707 -23420.252 -19900.984  15.0%  3121 1919s
  5249  1975 -22675.825   29  634 -23420.252 -19900.984  15.0%  3121 1926s
  5250  1976 -21862.705   19  639 -23420.252 -19900.984  15.0%  3120 1936s
  5251  1977 -20694.248   15  639 -23420.252 -19900.984  15.0%  3120 2012s
H 5251  1878                    -23409.65621 -19900.984  15.0%  3120 2038s
  5252  1878 -21563.851   32  639 -23409.656 -19900.984  15.0%  3119 2058s
  5253  1882 -19900.984   11  612 -23409.656 -19900.984  15.0%  3189 2071s
  5255  1885 -19900.984   12  610 -23409.656 -19900.984  15.0%  3190 2091s
  5259  1890 -19900.984   13  596 -23409.656 -19900.984  15.0%  3194 2117s
  5267  1891 -19900.984   14  571 -23409.656 -19900.984  15.0%  3203 2154s
  5273  1904 -20273.234   15  439 -23409.656 -19900.984  15.0%  3209 2214s
H 5288  1827                    -23396.39629 -19900.984  14.9%  3242 2278s
  5320  1884 -20425.102   17  460 -23396.396 -19900.984  14.9%  3291 2309s
  5405  1892 -20571.228   22  396 -23396.396 -19900.984  14.9%  3306 2328s
H 5427  1795                    -23393.45377 -19900.984  14.9%  3301 2328s
  5470  1824 -20959.849   22  388 -23393.454 -19900.984  14.9%  3305 2349s
  5544  1827 -20580.550   21  386 -23393.454 -19900.984  14.9%  3313 2371s
  5617  1841 -21230.414   24  361 -23393.454 -19900.984  14.9%  3324 2388s
  5689  1826 -21331.139   23  399 -23393.454 -19900.984  14.9%  3351 2404s
  5728  1825 -21996.587   23  350 -23393.454 -19900.984  14.9%  3366 2420s
H 5768  1725                    -23392.29532 -19900.984  14.9%  3376 2420s
  5780  1723 -21531.869   25  354 -23392.295 -19900.984  14.9%  3381 2437s
  5855  1714 -21344.817   25  335 -23392.295 -19900.984  14.9%  3389 2451s
  5893  1709     cutoff   26      -23392.295 -19900.984  14.9%  3401 2473s
  5949  1709     cutoff   26      -23392.295 -19900.984  14.9%  3410 2495s
  6015  1685 -22407.527   27  333 -23392.295 -19900.984  14.9%  3421 2510s
  6082  1650 -22490.761   28  296 -23392.295 -19900.984  14.9%  3417 2527s
  6158  1645 -22686.777   29  300 -23392.295 -19900.984  14.9%  3414 2543s
  6207  1642     cutoff   28      -23392.295 -20135.404  13.9%  3430 2562s
  6275  1631 -22997.020   32  268 -23392.295 -20135.404  13.9%  3446 2578s
  6354  1614 -23090.548   19  255 -23392.295 -20135.404  13.9%  3451 2595s
  6429  1597 -23334.199   20  264 -23392.295 -20375.475  12.9%  3459 2612s
  6511  1579 infeasible   22      -23392.295 -20375.475  12.9%  3459 2628s
  6607  1564 -22738.082   27  344 -23392.295 -20375.475  12.9%  3463 2660s
  6691  1533     cutoff   32      -23392.295 -20375.475  12.9%  3463 2686s
  6805  1494 -22943.835   20  272 -23392.295 -20375.475  12.9%  3472 2707s
  6892  1470     cutoff   21      -23392.295 -20375.475  12.9%  3491 2728s
  6994  1439 -22250.269   21  391 -23392.295 -20925.351  10.5%  3487 2747s
  7050  1423 -22837.537   22  359 -23392.295 -20925.351  10.5%  3499 2767s
  7113  1405 -22921.457   23  353 -23392.295 -21105.002  9.78%  3510 2792s
  7185  1376     cutoff   24      -23392.295 -21105.002  9.78%  3521 2816s
  7276  1343     cutoff   25      -23392.295 -21105.002  9.78%  3527 2847s
  7349  1309 -23094.161   26  267 -23392.295 -21517.707  8.01%  3540 2871s
  7452  1237     cutoff   26      -23392.295 -21667.183  7.37%  3547 2900s
  7573  1173 -22963.651   21  339 -23392.295 -21724.912  7.13%  3570 2928s
  7719  1064     cutoff   23      -23392.295 -21724.912  7.13%  3566 2958s
  7898   937 -23117.265   26  226 -23392.295 -21873.898  6.49%  3571 2987s
  8112   730 -23234.521   21  312 -23392.295 -22290.088  4.71%  3550 3008s
  8386   621 -23243.149   28  354 -23392.295 -22553.519  3.59%  3488 3028s
  8584   620     cutoff   19      -23392.295 -22721.580  2.87%  3418 3037s
  9695   330     cutoff   55      -23392.295 -23354.731  0.16%  3034 3042s
 11345     0     cutoff   56      -23392.295 -23369.655  0.10%  2599 3045s

Cutting planes:
  Implied bound: 42
  Projected implied bound: 7
  MIR: 1037
  Flow cover: 1718
  Zero half: 8
  RLT: 10
  Relax-and-lift: 111

Explored 11638 nodes (29820805 simplex iterations) in 3045.45 seconds (5092.38 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23392.3 -23393.5 -23396.4 ... -23471.2
No other solutions better than -23392.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.339229531670e+04, best bound -2.339229531670e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3045.46s
  Master Objective (UB) = -23392.30, θ = 94942.31
  Upper Bound (UB) = -23392.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94942.31
  [DEBUG]   ✓ Scenario 0: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94942.31 ≤ Q = 94942.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94942.31 ≤ Q = 94942.31 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1682004
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x01682004
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7719637.9117
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.106614e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110661.40    0  122 7719637.91 -110661.40   101%     -    0s
H    0     0                    -77840.28986 -110661.40  42.2%     -    0s
H    0     0                    -78263.76978 -110661.40  41.4%     -    0s
     0     0 -83855.784    0  133 -78263.770 -83855.784  7.15%     -    0s
H    0     0                    -79915.70911 -83839.274  4.91%     -    0s
     0     0 -83520.357    0  135 -79915.709 -83520.357  4.51%     -    0s
     0     0 -83271.188    0  137 -79915.709 -83271.188  4.20%     -    0s
H    0     0                    -80142.89158 -83267.328  3.90%     -    0s
     0     0 -83267.328    0  137 -80142.892 -83267.328  3.90%     -    0s
H    0     0                    -80443.23184 -83267.328  3.51%     -    0s
     0     0 -83142.667    0  132 -80443.232 -83142.667  3.36%     -    0s
     0     0 -83132.573    0  132 -80443.232 -83132.573  3.34%     -    0s
     0     2 -83132.573    0  132 -80443.232 -83132.573  3.34%     -    0s
H  175   247                    -80458.71496 -82720.368  2.81%   7.3    0s
H 1027   963                    -81296.82987 -82397.364  1.35%   5.3    0s
H 2723  1446                    -81396.46928 -81962.938  0.70%   5.7    0s
H 3496  1762                    -81431.98773 -81896.633  0.57%   5.7    0s
H 4063  1688                    -81458.62728 -81842.436  0.47%   5.7    0s
H 4140  1688                    -81468.93239 -81840.299  0.46%   5.7    0s
H 4166  1688                    -81474.06412 -81840.299  0.45%   5.7    0s
H 5379  1680                    -81495.57195 -81790.699  0.36%   5.9    0s
H 5383  1680                    -81497.52834 -81788.031  0.36%   5.9    0s

Cutting planes:
  Gomory: 74
  MIR: 250
  RLT: 2

Explored 9676 nodes (56587 simplex iterations) in 0.58 seconds (0.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -81497.5 -81495.6 -81474.1 ... -80443.2
No other solutions better than -81497.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.149752834415e+04, best bound -8.149752834415e+04, gap 0.0000%
  Subproblem solved in 0.62s
  Worst-case operational profit (Z_SP) = 94052.42
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81497.53
  [DEBUG]   S×d_nominal = 175549.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175549.95 + -81497.53 = 94052.42
  [DEBUG]   Current θ from Master = 94942.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 889.89 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24282.19
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 677.9004, Absolute Gap = 677.9004, Relative Gap = 0.028980
  Not converged yet (gap = 677.90 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437799 nonzeros
Model fingerprint: 0xdf59781c
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71890 rows and 29200 columns
Presolve time: 2.64s
Presolved: 82393 rows, 35460 columns, 505069 nonzeros
Variable types: 33201 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.559e+06
 Factor NZ  : 7.670e+06 (roughly 100 MB of memory)
 Factor Ops : 1.340e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.10590254e+07  1.53099283e+08  3.43e+05 2.43e+01  1.28e+05     4s
   1  -3.55867658e+07  1.59156633e+08  2.87e+05 9.25e+01  1.06e+05     4s
   2  -2.40854257e+07  1.27147528e+08  1.86e+05 5.21e+01  6.96e+04     4s
   3  -7.47084157e+06  1.03179617e+08  5.39e+04 2.34e+01  2.06e+04     5s
   4  -3.18308214e+06  1.02050459e+08  1.80e+04 2.28e+01  7.37e+03     5s
   5  -1.72851990e+06  5.77491176e+07  7.50e+03 4.09e+00  3.03e+03     5s
   6  -8.32034945e+05  5.00804922e+07  1.13e+03 3.10e+00  7.26e+02     5s
   7  -7.27748758e+05  3.40943639e+07  5.28e+02 1.94e+00  4.00e+02     5s
   8  -6.06593996e+05  1.38821173e+07  1.32e+02 6.21e-01  1.32e+02     5s
   9  -4.91669962e+05  1.02131093e+07  6.67e+01 4.29e-01  8.70e+01     5s
  10  -2.82698135e+05  5.62849006e+06  2.38e+01 1.99e-01  4.33e+01     5s
  11  -2.00987432e+05  3.22249553e+06  1.56e+01 7.57e-02  2.45e+01     5s
  12  -1.68082053e+05  1.02284603e+06  1.08e+01 2.48e-12  8.45e+00     5s
  13  -1.58203768e+05  8.01993658e+05  9.60e+00 2.11e-12  6.77e+00     5s
  14  -1.31665572e+05  4.45917635e+05  7.25e+00 1.50e-12  4.02e+00     5s
  15  -8.63366737e+04  2.40570702e+05  4.24e+00 1.01e-12  2.24e+00     5s
  16  -5.68369729e+04  1.44357700e+05  2.61e+00 6.28e-13  1.37e+00     5s
  17  -4.23535946e+04  8.41585760e+04  1.87e+00 7.98e-13  8.57e-01     5s
  18  -2.94160957e+04  6.20451190e+04  1.20e+00 6.44e-13  6.16e-01     6s
  19  -2.09613860e+04  4.90483602e+04  7.38e-01 6.11e-13  4.69e-01     6s
  20  -1.86363514e+04  3.82512318e+04  6.24e-01 5.95e-13  3.81e-01     6s
  21  -1.61850490e+04  3.24331063e+04  5.17e-01 3.31e-04  3.26e-01     6s
  22  -1.34812048e+04  2.84211909e+04  3.97e-01 5.75e-04  2.80e-01     6s
  23  -1.15033408e+04  2.22599167e+04  3.06e-01 3.77e-04  2.25e-01     6s
  24  -1.00838557e+04  1.82763797e+04  2.40e-01 2.54e-04  1.89e-01     6s
  25  -8.84886946e+03  1.34521208e+04  1.90e-01 9.94e-04  1.49e-01     6s
  26  -7.89380298e+03  1.01658004e+04  1.58e-01 4.63e-04  1.20e-01     6s
  27  -6.92598830e+03  7.91161035e+03  1.25e-01 4.15e-04  9.89e-02     6s
  28  -6.37572894e+03  7.52033180e+03  1.07e-01 4.41e-04  9.25e-02     6s
  29  -5.67827226e+03  6.00441114e+03  8.49e-02 2.70e-04  7.78e-02     6s
  30  -4.95357111e+03  4.25971290e+03  6.37e-02 4.41e-04  6.13e-02     6s
  31  -4.33389571e+03  3.23820586e+03  4.71e-02 3.98e-04  5.03e-02     7s
  32  -3.78887334e+03  1.87663305e+03  3.42e-02 6.68e-04  3.77e-02     7s
  33  -3.70713338e+03  1.51572132e+03  3.27e-02 6.77e-04  3.47e-02     7s
  34  -3.35436657e+03  8.93834016e+02  2.61e-02 7.55e-04  2.82e-02     7s
  35  -3.11077424e+03  5.72749137e+02  2.18e-02 6.70e-04  2.45e-02     7s
  36  -2.53156771e+03 -4.37207523e+01  1.26e-02 4.69e-04  1.65e-02     7s
  37  -2.33691385e+03 -4.93444006e+02  9.83e-03 3.28e-04  1.22e-02     7s
  38  -2.28000127e+03 -6.30906553e+02  9.00e-03 2.89e-04  1.10e-02     7s
  39  -2.01025835e+03 -6.72380652e+02  5.39e-03 2.75e-04  8.87e-03     7s
  40  -1.92448946e+03 -9.04454036e+02  4.23e-03 2.05e-04  6.77e-03     7s
  41  -1.85557021e+03 -1.22034874e+03  3.31e-03 1.07e-04  4.22e-03     7s
  42  -1.78099383e+03 -1.40715754e+03  2.31e-03 8.41e-05  2.49e-03     8s
  43  -1.70964435e+03 -1.42985959e+03  1.43e-03 7.32e-05  1.86e-03     8s
  44  -1.65965515e+03 -1.48112138e+03  8.47e-04 4.77e-05  1.19e-03     8s
  45  -1.64070171e+03 -1.51411436e+03  6.38e-04 3.04e-05  8.41e-04     8s
  46  -1.61485872e+03 -1.53232169e+03  3.60e-04 2.18e-05  5.48e-04     8s
  47  -1.59640156e+03 -1.55065072e+03  1.50e-04 1.35e-05  3.03e-04     8s
  48  -1.58615289e+03 -1.57032659e+03  4.13e-05 4.59e-06  1.05e-04     8s
  49  -1.58184616e+03 -1.57615879e+03  8.65e-06 2.19e-06  3.76e-05     8s
  50  -1.58141528e+03 -1.57644161e+03  5.67e-06 2.05e-06  3.29e-05     8s
  51  -1.58091415e+03 -1.57769253e+03  2.57e-06 1.39e-06  2.13e-05     8s
  52  -1.58055376e+03 -1.57945079e+03  6.78e-07 4.73e-07  7.29e-06     8s
  53  -1.58041241e+03 -1.58021497e+03  1.21e-07 7.72e-08  1.31e-06     8s
  54  -1.58038229e+03 -1.58033971e+03  6.27e-08 1.48e-08  2.82e-07     9s
  55  -1.58037080e+03 -1.58036937e+03  2.48e-07 1.74e-08  9.38e-09     9s
  56  -1.58036996e+03 -1.58036988e+03  4.87e-08 1.51e-09  5.45e-10     9s
  57  -1.58036988e+03 -1.58036988e+03  4.14e-09 2.16e-10  2.80e-12     9s

Barrier solved model in 57 iterations and 8.90 seconds (7.71 work units)
Optimal objective -1.58036988e+03


Root crossover log...

   71667 DPushes remaining with DInf 0.0000000e+00                 9s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    1505 PPushes remaining with PInf 2.6033613e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9087982e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36104   -1.5803699e+03   0.000000e+00   0.000000e+00     10s
   36104   -1.5803699e+03   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective -1.580370e+03, 36104 iterations, 6.69 seconds (6.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -1580.3699    0  279 -222248.17 -1580.3699  99.3%     -   10s
H    0     0                    -216998.3032 -1580.3699  99.3%     -   10s
H    0     0                    -114555.1413 -1580.3699  98.6%     -   11s
H    0     0                    -114116.4046 -1580.3699  98.6%     -   11s
H    0     0                    -67447.94158 -1580.3699  97.7%     -   11s
H    0     0                    -63187.87015 -1580.3699  97.5%     -   11s
H    0     0                    -53247.43638 -1580.3699  97.0%     -   11s
H    0     0                    -45553.65591 -1580.3699  96.5%     -   12s
H    0     0                    -39816.43047 -1580.3699  96.0%     -   12s
H    0     0                    -39065.89505 -1580.3699  96.0%     -   12s
H    0     0                    -38818.19393 -1580.3699  95.9%     -   12s
H    0     0                    -38472.54594 -1580.3699  95.9%     -   12s
H    0     0                    -37539.73666 -1580.3699  95.8%     -   12s
H    0     0                    -37514.41736 -1580.3699  95.8%     -   12s
H    0     0                    -37309.50628 -1585.5967  95.8%     -   14s
H    0     0                    -36658.98656 -9184.5653  74.9%     -   48s
H    0     0                    -36648.51418 -9184.5653  74.9%     -   48s
H    0     0                    -36455.31533 -9184.5653  74.8%     -   48s
     0     0 -9184.5653    0  539 -36455.315 -9184.5653  74.8%     -   48s
H    0     0                    -36357.67206 -9185.5432  74.7%     -   51s
     0     0 -9308.2361    0  538 -36357.672 -9308.2361  74.4%     -   53s
     0     0 -9524.8485    0  540 -36357.672 -9524.8485  73.8%     -   63s
     0     0 -9524.8485    0  547 -36357.672 -9524.8485  73.8%     -   66s
     0     0 -9524.8485    0  546 -36357.672 -9524.8485  73.8%     -   66s
     0     0 -9524.8485    0  545 -36357.672 -9524.8485  73.8%     -   67s
     0     0 -9524.8485    0  540 -36357.672 -9524.8485  73.8%     -   70s
     0     0 -9524.8485    0  540 -36357.672 -9524.8485  73.8%     -   70s
H    0     0                    -36279.28108 -13290.650  63.4%     -  118s
H    0     0                    -36275.36885 -13290.650  63.4%     -  118s
H    0     0                    -36262.94127 -13290.650  63.3%     -  118s
H    0     0                    -36259.02904 -13290.650  63.3%     -  118s
H    0     0                    -36237.62196 -13290.650  63.3%     -  118s
H    0     0                    -36233.70973 -13290.650  63.3%     -  118s
     0     0 -13290.650    0  462 -36233.710 -13290.650  63.3%     -  118s
H    0     0                    -35059.44765 -13291.303  62.1%     -  118s
     0     0 -13708.450    0  492 -35059.448 -13708.450  60.9%     -  129s
     0     0 -13801.287    0  516 -35059.448 -13801.287  60.6%     -  134s
     0     0 -13840.872    0  510 -35059.448 -13840.872  60.5%     -  138s
     0     0 -13928.971    0  506 -35059.448 -13928.971  60.3%     -  142s
     0     0 -13978.090    0  515 -35059.448 -13978.090  60.1%     -  147s
     0     0 -13980.361    0  517 -35059.448 -13980.361  60.1%     -  148s
     0     0 -14016.078    0  519 -35059.448 -14016.078  60.0%     -  153s
H    0     0                    -35038.58737 -14038.575  59.9%     -  158s
H    0     0                    -34626.44231 -14038.575  59.5%     -  158s
H    0     0                    -34165.15311 -14038.575  58.9%     -  158s
H    0     0                    -34085.14091 -14038.575  58.8%     -  158s
H    0     0                    -34010.02915 -14038.575  58.7%     -  158s
H    0     0                    -33891.31591 -14038.575  58.6%     -  158s
H    0     0                    -33887.40368 -14038.575  58.6%     -  158s
H    0     0                    -33811.30371 -14038.575  58.5%     -  158s
     0     0 -14038.575    0  512 -33811.304 -14038.575  58.5%     -  158s
     0     0 -14107.713    0  512 -33811.304 -14107.713  58.3%     -  162s
     0     0 -14114.194    0  513 -33811.304 -14114.194  58.3%     -  163s
     0     0 -14115.544    0  515 -33811.304 -14115.544  58.3%     -  163s
     0     0 -15594.774    0  590 -33811.304 -15594.774  53.9%     -  192s
H    0     0                    -33763.16285 -15595.204  53.8%     -  193s
     0     0 -16381.820    0  585 -33763.163 -16381.820  51.5%     -  209s
H    0     0                    -33484.12557 -16540.539  50.6%     -  218s
H    0     0                    -33448.68798 -16540.539  50.5%     -  218s
H    0     0                    -33426.54171 -16540.539  50.5%     -  218s
     0     0 -16540.539    0  608 -33426.542 -16540.539  50.5%     -  218s
     0     0 -16629.191    0  679 -33426.542 -16629.191  50.3%     -  223s
     0     0 -16665.654    0  673 -33426.542 -16665.654  50.1%     -  226s
     0     0 -16667.266    0  677 -33426.542 -16667.266  50.1%     -  228s
H    0     0                    -28822.07690 -17533.755  39.2%     -  260s
H    0     0                    -27441.35861 -17533.755  36.1%     -  260s
H    0     0                    -27326.75237 -17533.755  35.8%     -  260s
H    0     0                    -27290.44427 -17533.755  35.8%     -  260s
H    0     0                    -27288.58472 -17533.755  35.7%     -  260s
H    0     0                    -27282.45853 -17533.755  35.7%     -  260s
H    0     0                    -27263.44717 -17533.755  35.7%     -  260s
H    0     0                    -24691.08707 -17533.755  29.0%     -  260s
H    0     0                    -24684.91439 -17533.755  29.0%     -  260s
H    0     0                    -24661.22772 -17533.755  28.9%     -  260s
H    0     0                    -24514.36271 -17533.755  28.5%     -  260s
H    0     0                    -24434.51402 -17533.755  28.2%     -  260s
H    0     0                    -24279.92943 -17533.755  27.8%     -  260s
H    0     0                    -24166.36333 -17533.755  27.4%     -  260s
H    0     0                    -24164.77159 -17533.755  27.4%     -  260s
H    0     0                    -24149.73414 -17533.755  27.4%     -  260s
     0     0 -17533.755    0  604 -24149.734 -17533.755  27.4%     -  260s
H    0     0                    -24148.57569 -17534.177  27.4%     -  261s
     0     0 -17695.422    0  679 -24148.576 -17695.422  26.7%     -  273s
     0     0 -17742.144    0  613 -24148.576 -17742.144  26.5%     -  280s
     0     0 -17774.966    0  613 -24148.576 -17774.966  26.4%     -  287s
     0     0 -17825.622    0  602 -24148.576 -17825.622  26.2%     -  295s
     0     0 -17858.316    0  611 -24148.576 -17858.316  26.0%     -  301s
     0     0 -17885.448    0  617 -24148.576 -17885.448  25.9%     -  306s
     0     0 -17893.397    0  616 -24148.576 -17893.397  25.9%     -  308s
     0     0 -17904.681    0  632 -24148.576 -17904.681  25.9%     -  311s
     0     0 -17908.918    0  627 -24148.576 -17908.918  25.8%     -  313s
     0     0 -17917.711    0  614 -24148.576 -17917.711  25.8%     -  315s
     0     0 -17919.384    0  622 -24148.576 -17919.384  25.8%     -  318s
     0     0 -18064.139    0  666 -24148.576 -18064.139  25.2%     -  332s
     0     0 -18102.021    0  609 -24148.576 -18102.021  25.0%     -  339s
     0     0 -18117.045    0  618 -24148.576 -18117.045  25.0%     -  343s
     0     0 -18119.313    0  616 -24148.576 -18119.313  25.0%     -  344s
     0     0 -18182.895    0  673 -24148.576 -18182.895  24.7%     -  355s
     0     0 -18200.895    0  690 -24148.576 -18200.895  24.6%     -  363s
     0     0 -18203.965    0  619 -24148.576 -18203.965  24.6%     -  367s
     0     0 -18204.603    0  620 -24148.576 -18204.603  24.6%     -  368s
     0     0 -18231.043    0  629 -24148.576 -18231.043  24.5%     -  376s
     0     0 -18235.387    0  640 -24148.576 -18235.387  24.5%     -  380s
     0     0 -18237.674    0  644 -24148.576 -18237.674  24.5%     -  381s
H    0     0                    -24121.73135 -18245.493  24.4%     -  387s
H    0     0                    -24109.11592 -18245.493  24.3%     -  387s
H    0     0                    -24087.47612 -18245.493  24.3%     -  387s
H    0     0                    -24082.03595 -18245.493  24.2%     -  387s
H    0     0                    -24040.98758 -18245.493  24.1%     -  387s
H    0     0                    -24028.03635 -18245.493  24.1%     -  387s
H    0     0                    -24026.62417 -18245.493  24.1%     -  387s
     0     0 -18245.493    0  642 -24026.624 -18245.493  24.1%     -  387s
     0     0 -18246.561    0  643 -24026.624 -18246.561  24.1%     -  392s
     0     0 -18255.136    0  650 -24026.624 -18255.136  24.0%     -  397s
     0     0 -18258.793    0  640 -24026.624 -18258.793  24.0%     -  400s
     0     0 -18263.981    0  635 -24026.624 -18263.981  24.0%     -  403s
H    0     0                    -24022.69849 -18264.515  24.0%     -  404s
     0     0 -18264.515    0  643 -24022.698 -18264.515  24.0%     -  404s
     0     0 -18278.300    0  629 -24022.698 -18278.300  23.9%     -  413s
     0     0 -18279.287    0  629 -24022.698 -18279.287  23.9%     -  419s
H    0     0                    -23709.78448 -18279.287  22.9%     -  512s
H    0     0                    -23695.07109 -18279.287  22.9%     -  512s
H    0     0                    -23629.37351 -18279.287  22.6%     -  512s
H    0     2                    -23612.13003 -18279.287  22.6%     -  538s
     0     2 -18279.287    0  629 -23612.130 -18279.287  22.6%     -  538s
     1     4 -18543.567    1  668 -23612.130 -18280.015  22.6%  8761  554s
     3     8 -18733.928    2  648 -23612.130 -18543.926  21.5%  9269  578s
     7    16 -18829.687    3  745 -23612.130 -18735.781  20.7% 10349  591s
    15    29 -18913.396    4  744 -23612.130 -18830.949  20.2%  7932  612s
    30    38 -19050.492    5  309 -23612.130 -18873.597  20.1%  9418  642s
    45    42 infeasible    6      -23612.130 -18913.404  19.9%  9422  677s
H   55    42                    -23608.52887 -18913.404  19.9%  8080  677s
H   59    42                    -23593.27724 -18914.142  19.8%  7740  677s
H   73   138                    -23589.50015 -18914.142  19.8%  8190  701s
H   89   138                    -23535.39096 -18914.142  19.6%  7555  701s
   191   205 -19662.975   11  376 -23535.391 -18914.142  19.6%  5545  716s
   284   234 -19703.794   12  370 -23535.391 -18914.142  19.6%  5118  729s
H  290   234                    -23491.77218 -18914.142  19.5%  5099  729s
   329   288 -19897.982   11  333 -23491.772 -18914.142  19.5%  5079  744s
   406   308 -19717.586   13  281 -23491.772 -18914.142  19.5%  4772  757s
   442   338 -19819.489   12  370 -23491.772 -18914.142  19.5%  4728  772s
H  462   338                    -23489.90359 -18914.142  19.5%  4763  772s
   480   411 -19829.486   14  279 -23489.904 -18914.142  19.5%  4774  783s
   570   465 -20056.718   13  367 -23489.904 -18914.142  19.5%  4611  796s
   642   520 -19924.949   13  374 -23489.904 -18914.142  19.5%  4487  807s
   736   562 infeasible   15      -23489.904 -18914.142  19.5%  4308  820s
   819   586 -20654.900   16  342 -23489.904 -18914.142  19.5%  4207  832s
H  823   586                    -23489.39957 -18914.142  19.5%  4199  832s
   857   636 -20817.336   17  346 -23489.400 -18914.142  19.5%  4196  844s
   934   676 infeasible   17      -23489.400 -18914.142  19.5%  4135  856s
  1010   718 -20854.503   18  334 -23489.400 -18914.142  19.5%  4088  869s
  1096   743 -21015.020   19  256 -23489.400 -18914.142  19.5%  4057  880s
H 1135   782                    -23488.60186 -18914.142  19.5%  4059  893s
H 1140   782                    -23482.79623 -18914.142  19.5%  4059  893s
H 1154   782                    -23479.23379 -18914.142  19.4%  4043  893s
  1196   807 -21254.009   21  348 -23479.234 -18914.142  19.4%  4018  908s
  1233   850 -20862.308   15  322 -23479.234 -18914.142  19.4%  4052  923s
H 1279   850                    -23476.76636 -18914.142  19.4%  4040  923s
H 1284   850                    -23473.19120 -18914.142  19.4%  4033  923s
  1290   926 -21316.947   22  243 -23473.191 -18914.142  19.4%  4040  936s
  1389   986 -21422.238   24  478 -23473.191 -18914.142  19.4%  3973  951s
  1504  1052 -22014.248   27  384 -23473.191 -18914.142  19.4%  3890  966s
  1616  1132 -22037.289   28  384 -23473.191 -18914.142  19.4%  3841  980s
  1730  1209 -22209.697   33  319 -23473.191 -18914.142  19.4%  3839  996s
  1855  1316 -22335.010   37  373 -23473.191 -18914.142  19.4%  3795 1010s
  1992  1345 -22464.934   40  372 -23473.191 -19045.365  18.9%  3750 1020s
  2033  1388 -22647.055   39  313 -23473.191 -19045.570  18.9%  3742 1037s
H 2120  1388                    -23466.37566 -19045.570  18.8%  3694 1037s
  2136  1456 -22499.280   41  383 -23466.376 -19045.570  18.8%  3685 1054s
  2281  1566 -22718.657   46  351 -23466.376 -19045.570  18.8%  3634 1072s
  2454  1626 infeasible   51      -23466.376 -19045.570  18.8%  3572 1091s
  2619  1667 -23159.195   56  294 -23466.376 -19045.570  18.8%  3540 1110s
  2759  1719 -21750.754   18  438 -23466.376 -19045.570  18.8%  3539 1129s
  2877  1782 -22038.838   21  467 -23466.376 -19045.570  18.8%  3572 1150s
  3022  1806 infeasible   25      -23466.376 -19190.213  18.2%  3564 1169s
  3062  1833 -22995.009   26  465 -23466.376 -19732.025  15.9%  3590 1187s
H 3079  1833                    -23466.35171 -19732.025  15.9%  3602 1187s
  3097  1867 -23034.954   27  404 -23466.352 -19732.025  15.9%  3616 1208s
  3167  1948 -23081.645   28  398 -23466.352 -19732.025  15.9%  3615 1227s
  3290  2038 infeasible   31      -23466.352 -19732.025  15.9%  3616 1248s
  3462  2177 infeasible   39      -23466.352 -19732.025  15.9%  3592 1270s
  3652  2338 -22179.453   13  266 -23466.352 -19894.932  15.2%  3594 1294s
  3885  2339 -20845.640   12  629 -23466.352 -19894.932  15.2%  3554 1569s
  3887  2340 -22114.526   24  450 -23466.352 -19894.932  15.2%  3552 1586s
  3888  2341 -22438.443   25  554 -23466.352 -19894.932  15.2%  3551 1660s
  3889  2342 -21625.488   16  552 -23466.352 -19894.932  15.2%  3550 1703s
  3890  2342 -21670.702   14  622 -23466.352 -19894.932  15.2%  3549 1737s
  3891  2343 -22810.371   39  589 -23466.352 -19894.932  15.2%  3549 1761s
  3892  2344 -23251.363   66  661 -23466.352 -19894.932  15.2%  3548 1778s
  3893  2344 -22607.695   27  651 -23466.352 -19894.932  15.2%  3547 1800s
  3894  2345 -22330.977   33  599 -23466.352 -19894.932  15.2%  3546 1813s
  3895  2346 -21472.883   16  674 -23466.352 -19894.932  15.2%  3545 1825s
  3896  2346 -21438.702   22  687 -23466.352 -19894.932  15.2%  3544 1831s
  3897  2347 -22897.888   35  692 -23466.352 -19894.932  15.2%  3543 1838s
  3898  2348 -21987.361   18  698 -23466.352 -19894.932  15.2%  3542 1850s
  3899  2348 -20701.919   10  616 -23466.352 -19894.932  15.2%  3541 1903s
  3900  2349 -21485.191   17  683 -23466.352 -19894.932  15.2%  3540 1925s
  3901  2350 -21436.293   27  613 -23466.352 -19894.932  15.2%  3539 1935s
  3902  2350 -20999.251   10  615 -23466.352 -19894.932  15.2%  3539 1944s
  3903  2351 -22274.900   32  607 -23466.352 -19894.932  15.2%  3538 1951s
  3904  2352 -23214.552   39  624 -23466.352 -19894.932  15.2%  3537 1980s
  3905  2352 -21783.556   19  621 -23466.352 -19894.932  15.2%  3536 1987s
  3906  2353 -20853.890   19  545 -23466.352 -19894.932  15.2%  3535 1993s
  3907  2354 -22514.398   38  684 -23466.352 -19894.932  15.2%  3534 2003s
  3908  2354 -23218.639   34  616 -23466.352 -19894.932  15.2%  3533 2009s
  3909  2355 -22086.234   18  623 -23466.352 -19894.932  15.2%  3532 2015s
  3910  2356 -20855.460    9  623 -23466.352 -19894.932  15.2%  3531 2022s
  3911  2356 -21950.591   19  710 -23466.352 -19894.932  15.2%  3530 2054s
  3912  2357 -22796.796   21  714 -23466.352 -19894.932  15.2%  3529 2067s
  3913  2358 -22960.897   53  718 -23466.352 -19894.932  15.2%  3529 2073s
  3914  2358 -22057.602   28  623 -23466.352 -19894.932  15.2%  3528 2080s
  3915  2359 -20661.421    8  609 -23466.352 -19894.932  15.2%  3527 2104s
  3916  2360 -21578.613   26  620 -23466.352 -19894.932  15.2%  3526 2110s
  3918  2361 -22425.838   12  620 -23466.352 -19894.932  15.2%  3524 2124s
  3919  2362 -23112.970   37  614 -23466.352 -19894.932  15.2%  3523 2142s
  3920  2362 -22925.332   43  615 -23466.352 -19894.932  15.2%  3522 2150s
  3921  2363 -21870.994   27  542 -23466.352 -19894.932  15.2%  3521 2157s
  3922  2364 -23229.395   27  713 -23466.352 -19894.932  15.2%  3520 2166s
  3923  2364 -21795.372   28  601 -23466.352 -19894.932  15.2%  3520 2187s
  3924  2365 -23026.769   30  709 -23466.352 -19894.932  15.2%  3519 2196s
  3925  2366 -22651.901   42  603 -23466.352 -19894.932  15.2%  3518 2216s
  3926  2366 -23029.711   20  619 -23466.352 -19894.932  15.2%  3517 2227s
  3927  2367 -23002.088   30  614 -23466.352 -19894.932  15.2%  3516 2247s
  3928  2368 -21889.970   31  620 -23466.352 -19894.932  15.2%  3515 2255s
  3929  2368 -21479.489   28  607 -23466.352 -19894.932  15.2%  3514 2268s
  3930  2369 -20887.497   16  607 -23466.352 -19894.932  15.2%  3513 2282s
  3931  2370 -21450.720   21  607 -23466.352 -19894.932  15.2%  3512 2335s
  3932  2373 -19894.932   15  615 -23466.352 -19894.932  15.2%  3609 2398s
  3934  2375 -19894.932   16  596 -23466.352 -19894.932  15.2%  3616 2412s
  3938  2377 -19894.932   17  672 -23466.352 -19894.932  15.2%  3621 2433s
  3944  2375 infeasible   18      -23466.352 -19894.932  15.2%  3629 2487s
  3948  2377 -21707.959   19  475 -23466.352 -19894.932  15.2%  3634 2520s
  3953  2384 -21870.201   20  474 -23466.352 -19894.932  15.2%  3637 2565s
  3965  2392 -22422.808   21  481 -23466.352 -19894.932  15.2%  3662 2606s
  3986  2408 -22871.745   22  462 -23466.352 -19894.932  15.2%  3688 2628s
  4018  2428 -23352.058   23  469 -23466.352 -19948.795  15.0%  3706 2658s
  4050  2431 infeasible   24      -23466.352 -19978.802  14.9%  3731 2687s
  4091  2441 -22367.577   22  392 -23466.352 -19978.802  14.9%  3796 2719s
  4140  2433 -22460.518   23  460 -23466.352 -19978.802  14.9%  3823 2752s
  4200  2435 -23032.218   26  470 -23466.352 -19978.802  14.9%  3841 2788s
  4264  2441 -23129.919   27  482 -23466.352 -19978.802  14.9%  3858 2814s
  4342  2425 -23177.479   28  550 -23466.352 -19978.802  14.9%  3897 2855s
  4416  2431 -23346.008   30  571 -23466.352 -19978.802  14.9%  3945 2877s
  4492  2413 -23350.403   31  568 -23466.352 -19978.802  14.9%  3988 2898s
  4564  2391     cutoff   32      -23466.352 -20860.518  11.1%  4013 2920s
  4641  2379 -22552.914   31  343 -23466.352 -20860.518  11.1%  4019 2941s
  4706  2369 -21480.847   22  543 -23466.352 -20860.518  11.1%  4040 2959s
  4784  2366 -22715.720   25  362 -23466.352 -20860.518  11.1%  4054 2980s
  4864  2337 -22063.197   23  545 -23466.352 -20860.518  11.1%  4074 2999s
  4924  2316 -22067.828   24  550 -23466.352 -20860.518  11.1%  4101 3020s
  5003  2290 -22625.293   26  524 -23466.352 -20860.518  11.1%  4141 3042s
  5067  2257 infeasible   28      -23466.352 -20860.518  11.1%  4189 3064s
  5139  2228 infeasible   27      -23466.352 -20860.518  11.1%  4240 3085s
  5191  2210 infeasible   30      -23466.352 -21755.783  7.29%  4280 3111s
  5246  2209 -22102.304   24  653 -23466.352 -21961.618  6.41%  4302 3136s
  5325  2181 -23293.150   25  274 -23466.352 -22106.788  5.79%  4315 3161s
  5442  2102 -22874.706   26  541 -23466.352 -22106.788  5.79%  4318 3186s
  5564  2007     cutoff   28      -23466.352 -22106.788  5.79%  4337 3214s
  5697  1913     cutoff   27      -23466.352 -22106.788  5.79%  4339 3242s
  5822  1812 -23126.972   30  369 -23466.352 -22106.788  5.79%  4335 3269s
  5967  1722 infeasible   31      -23466.352 -22106.788  5.79%  4331 3289s
  6090  1738 -23241.122   31  545 -23466.352 -22865.990  2.56%  4285 3319s
  6251  1830 -23279.072   33  452 -23466.352 -23084.127  1.63%  4216 3345s
  6600  1863 infeasible   34      -23466.352 -23171.999  1.25%  4029 3366s
  7051  1892 -23316.447   44   48 -23466.352 -23171.999  1.25%  3821 3385s
  7649  1872 -23429.441   64   48 -23466.352 -23241.817  0.96%  3570 3402s
  8311  1771     cutoff   60      -23466.352 -23278.344  0.80%  3337 3415s
  9114  1362 -23348.176   56   57 -23466.352 -23320.727  0.62%  3089 3428s
  9847   997     cutoff   54      -23466.352 -23339.949  0.54%  2908 3442s
 10580   440 -23442.360   52   31 -23466.352 -23388.558  0.33%  2750 3453s
 11444    15     cutoff   58      -23466.352 -23409.089  0.24%  2586 3462s

Cutting planes:
  Gomory: 2
  Implied bound: 36
  Projected implied bound: 328
  MIR: 1528
  Flow cover: 1892
  Zero half: 6
  RLT: 45
  Relax-and-lift: 96

Explored 12054 nodes (30236008 simplex iterations) in 3464.54 seconds (5794.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23466.4 -23466.4 -23473.2 ... -23491.8
No other solutions better than -23466.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.346635171097e+04, best bound -2.346635171097e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3464.58s
  Master Objective (UB) = -23466.35, θ = 95170.13
  Upper Bound (UB) = -23466.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95170.13
  [DEBUG]   ✓ Scenario 0: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95170.13 ≤ Q = 95170.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 95170.13 ≤ Q = 95170.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 95170.13 ≤ Q = 95170.13 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4a0d6571
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb5f29a8f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7725662.7648
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.103685e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110368.54    0  121 7725662.76 -110368.54   101%     -    0s
H    0     0                    -77484.73406 -110368.54  42.4%     -    0s
H    0     0                    -77928.73373 -110368.54  41.6%     -    0s
     0     0 -83456.809    0  132 -77928.734 -83456.809  7.09%     -    0s
H    0     0                    -79691.72867 -83310.740  4.54%     -    0s
     0     0 -82717.894    0  134 -79691.729 -82717.894  3.80%     -    0s
     0     0 -82522.115    0  134 -79691.729 -82522.115  3.55%     -    0s
H    0     0                    -80266.84017 -82516.732  2.80%     -    0s
     0     0 -82516.732    0  134 -80266.840 -82516.732  2.80%     -    0s
     0     0 -82422.693    0  133 -80266.840 -82422.693  2.69%     -    0s
     0     0 -82402.088    0  133 -80266.840 -82402.088  2.66%     -    0s
     0     2 -82402.088    0  133 -80266.840 -82402.088  2.66%     -    0s
H   57    62                    -80865.39917 -81922.519  1.31%  17.5    0s
H  120   167                    -80887.76685 -81858.711  1.20%  12.2    0s
H  171   167                    -80908.46764 -81858.711  1.17%   9.8    0s
H 2005   463                    -80918.86904 -81384.126  0.57%   6.5    0s
H 2958   455                    -80927.71423 -81125.233  0.24%   6.3    0s
H 3153   455                    -80929.50613 -81121.687  0.24%   6.3    0s
* 3483   436              33    -80939.40226 -81076.451  0.17%   6.2    0s

Cutting planes:
  Gomory: 78
  MIR: 258
  RLT: 2

Explored 5179 nodes (32885 simplex iterations) in 0.49 seconds (0.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -80939.4 -80929.5 -80927.7 ... -77928.7
No other solutions better than -80939.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.093940225984e+04, best bound -8.093940225984e+04, gap 0.0000%
  Subproblem solved in 0.53s
  Worst-case operational profit (Z_SP) = 94506.44
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -80939.40
  [DEBUG]   S×d_nominal = 175445.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175445.84 + -80939.40 = 94506.44
  [DEBUG]   Current θ from Master = 95170.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 663.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24130.05
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 603.8440, Absolute Gap = 603.8440, Relative Gap = 0.025732
  Not converged yet (gap = 603.84 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481027 nonzeros
Model fingerprint: 0xd42fc55b
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 79081 rows and 32121 columns
Presolve time: 2.92s
Presolved: 90492 rows, 38779 columns, 551564 nonzeros
Variable types: 36520 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407808.0001
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 668
 AA' NZ     : 2.832e+06
 Factor NZ  : 6.689e+06 (roughly 100 MB of memory)
 Factor Ops : 1.254e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.15666081e+07  1.70314972e+08  3.48e+05 2.31e+01  1.29e+05     5s
   1  -3.63159569e+07  1.76012511e+08  2.94e+05 8.84e+01  1.08e+05     5s
   2  -2.39221552e+07  1.41180062e+08  1.84e+05 4.91e+01  6.84e+04     5s
   3  -9.24318413e+06  1.09034482e+08  6.64e+04 1.76e+01  2.51e+04     5s
   4  -3.49395544e+06  1.07737083e+08  2.18e+04 1.71e+01  8.66e+03     5s
   5  -1.77403607e+06  6.26520066e+07  8.67e+03 3.30e+00  3.43e+03     5s
   6  -7.26887883e+05  3.85240944e+07  9.44e+02 7.46e-01  5.54e+02     5s
   7  -6.11830904e+05  1.73376677e+07  4.66e+02 2.23e-01  2.45e+02     5s
   8  -3.71258672e+05  1.33396457e+07  1.54e+02 1.28e-01  1.25e+02     5s
   9  -1.85035057e+05  7.42937454e+06  5.29e+01 6.89e-03  5.76e+01     5s
  10  -1.53397382e+05  4.25221679e+06  3.68e+01 3.69e-03  3.25e+01     5s
  11  -1.27057384e+05  3.12102929e+06  2.24e+01 2.58e-03  2.25e+01     5s
  12  -1.00909083e+05  1.95356234e+06  1.29e+01 1.56e-03  1.35e+01     5s
  13  -6.28661323e+04  6.14045763e+05  4.79e+00 4.14e-04  4.24e+00     5s
  14  -4.51172080e+04  2.83545929e+05  3.27e+00 3.18e-04  2.04e+00     6s
  15  -3.36391881e+04  1.49030010e+05  1.92e+00 2.11e-04  1.12e+00     6s
  16  -2.65567099e+04  8.41433898e+04  1.33e+00 2.15e-04  6.76e-01     6s
  17  -2.27681443e+04  6.02658421e+04  1.07e+00 2.87e-04  5.06e-01     6s
  18  -1.87912762e+04  3.95951750e+04  8.32e-01 1.27e-03  3.55e-01     6s
  19  -1.45083552e+04  2.65072649e+04  6.14e-01 1.07e-03  2.49e-01     6s
  20  -1.11717765e+04  1.96329887e+04  4.72e-01 1.15e-03  1.87e-01     6s
  21  -8.97917024e+03  1.61239262e+04  3.82e-01 1.16e-03  1.52e-01     6s
  22  -6.91688984e+03  1.22890064e+04  3.05e-01 1.91e-03  1.17e-01     6s
  23  -5.28255030e+03  9.85830170e+03  2.41e-01 1.30e-03  9.18e-02     6s
  24  -4.43283252e+03  8.03828684e+03  2.07e-01 1.70e-03  7.56e-02     6s
  25  -3.78041110e+03  6.70881119e+03  1.81e-01 1.79e-03  6.36e-02     6s
  26  -3.26556855e+03  5.08248418e+03  1.61e-01 2.86e-03  5.06e-02     6s
  27  -2.60696250e+03  4.56223202e+03  1.37e-01 2.66e-03  4.35e-02     6s
  28  -1.93708049e+03  4.29446907e+03  1.13e-01 2.46e-03  3.78e-02     7s
  29  -1.39439207e+03  3.72292191e+03  9.24e-02 2.21e-03  3.10e-02     7s
  30  -9.92341523e+02  3.24717281e+03  7.83e-02 1.56e-03  2.57e-02     7s
  31  -3.26306613e+02  2.69089255e+03  5.57e-02 9.69e-04  1.83e-02     7s
  32  -5.15487771e+01  2.38545313e+03  4.68e-02 9.00e-04  1.48e-02     7s
  33  -1.81686044e+00  2.23828549e+03  4.52e-02 7.99e-04  1.36e-02     7s
  34   1.74082238e+02  2.03500430e+03  3.95e-02 5.69e-04  1.13e-02     7s
  35   5.69746123e+02  1.95155447e+03  2.70e-02 4.64e-04  8.37e-03     7s
  36   7.63593063e+02  1.85235579e+03  2.11e-02 5.51e-04  6.60e-03     7s
  37   8.95663907e+02  1.82836576e+03  1.70e-02 5.01e-04  5.65e-03     7s
  38   1.03879952e+03  1.74801252e+03  1.28e-02 5.73e-04  4.30e-03     7s
  39   1.14193796e+03  1.66346969e+03  9.72e-03 4.66e-04  3.16e-03     7s
  40   1.26417910e+03  1.62730949e+03  6.15e-03 4.47e-04  2.20e-03     7s
  41   1.28582144e+03  1.58883370e+03  5.54e-03 3.54e-04  1.84e-03     7s
  42   1.30815936e+03  1.56567664e+03  4.91e-03 2.53e-04  1.56e-03     8s
  43   1.41381537e+03  1.53589139e+03  1.86e-03 3.03e-04  7.39e-04     8s
  44   1.44748626e+03  1.51880816e+03  9.82e-04 1.96e-04  4.31e-04     8s
  45   1.45078733e+03  1.51783583e+03  8.96e-04 1.90e-04  4.05e-04     8s
  46   1.46308578e+03  1.50368340e+03  5.58e-04 1.01e-04  2.46e-04     8s
  47   1.47205334e+03  1.49731336e+03  3.21e-04 5.98e-05  1.53e-04     8s
  48   1.48095098e+03  1.49647313e+03  1.01e-04 5.56e-05  9.37e-05     8s
  49   1.48412793e+03  1.49261177e+03  2.26e-05 3.61e-05  5.11e-05     8s
  50   1.48434596e+03  1.48878037e+03  1.65e-05 1.75e-05  2.67e-05     8s
  51   1.48477666e+03  1.48565397e+03  6.75e-06 2.18e-06  5.30e-06     8s
  52   1.48503479e+03  1.48519465e+03  1.60e-06 2.69e-07  9.65e-07     8s
  53   1.48512326e+03  1.48512385e+03  5.54e-09 5.09e-08  3.61e-09     8s
  54   1.48512355e+03  1.48512355e+03  5.30e-09 5.28e-09  3.97e-13     8s

Barrier solved model in 54 iterations and 8.40 seconds (7.32 work units)
Optimal objective 1.48512355e+03


Root crossover log...

   70638 DPushes remaining with DInf 0.0000000e+00                 8s
     819 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    2618 PPushes remaining with PInf 1.0497438e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1180050e-11     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27291    1.4851235e+03   0.000000e+00   0.000000e+00     10s
   27291    1.4851235e+03   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.485124e+03, 27291 iterations, 6.74 seconds (7.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1485.12355    0  496 -222248.17 1485.12355   101%     -   11s
H    0     0                    -218983.6017 1485.12355   101%     -   11s
H    0     0                    -172971.3206 1485.12355   101%     -   11s
H    0     0                    -171621.4416 1485.12355   101%     -   11s
H    0     0                    -170785.1814 1485.12355   101%     -   11s
H    0     0                    -77091.77630 1485.12355   102%     -   11s
H    0     0                    -72991.10007 1485.12355   102%     -   12s
H    0     0                    -72746.15723 1485.12355   102%     -   12s
H    0     0                    -43730.72315 1485.12355   103%     -   14s
H    0     0                    -43204.61097 1485.12355   103%     -   14s
H    0     0                    -42996.96039 -4280.2152  90.0%     -   52s
H    0     0                    -42993.69686 -4280.2152  90.0%     -   52s
H    0     0                    -42812.88975 -4280.2152  90.0%     -   52s
H    0     0                    -42740.05330 -4280.2152  90.0%     -   52s
     0     0 -4280.2152    0  745 -42740.053 -4280.2152  90.0%     -   53s
H    0     0                    -37766.04644 -4284.9898  88.7%     -   53s
H    0     0                    -37405.54601 -4284.9898  88.5%     -   53s
H    0     0                    -37378.53480 -4284.9898  88.5%     -   53s
H    0     0                    -37312.87103 -4284.9898  88.5%     -   53s
H    0     0                    -37257.20233 -4284.9898  88.5%     -   53s
     0     0 -4831.5154    0  675 -37257.202 -4831.5154  87.0%     -   66s
     0     0 -5100.4886    0  669 -37257.202 -5100.4886  86.3%     -   73s
     0     0 -5191.7399    0  680 -37257.202 -5191.7399  86.1%     -   78s
     0     0 -5192.4794    0  681 -37257.202 -5192.4794  86.1%     -   78s
     0     0 -5214.0697    0  669 -37257.202 -5214.0697  86.0%     -   79s
     0     0 -5224.2780    0  663 -37257.202 -5224.2780  86.0%     -   80s
     0     0 -5229.3505    0  664 -37257.202 -5229.3505  86.0%     -   81s
     0     0 -5243.2286    0  674 -37257.202 -5243.2286  85.9%     -   83s
     0     0 -5243.9688    0  670 -37257.202 -5243.9688  85.9%     -   84s
     0     0 -5244.0238    0  671 -37257.202 -5244.0238  85.9%     -   84s
H    0     0                    -33938.11739 -8693.8634  74.4%     -  159s
H    0     0                    -32982.94080 -8693.8634  73.6%     -  159s
H    0     0                    -32235.87373 -8693.8634  73.0%     -  159s
H    0     0                    -32234.42964 -8693.8634  73.0%     -  159s
H    0     0                    -32227.80972 -8693.8634  73.0%     -  159s
     0     0 -8693.8634    0  561 -32227.810 -8693.8634  73.0%     -  159s
H    0     0                    -24644.52769 -8694.0588  64.7%     -  160s
H    0     0                    -24214.99240 -8694.0588  64.1%     -  160s
H    0     0                    -24157.36187 -8694.0588  64.0%     -  160s
H    0     0                    -24118.85759 -8694.0588  64.0%     -  161s
H    0     0                    -24117.30963 -8694.0588  64.0%     -  161s
H    0     0                    -24106.81407 -8694.0588  63.9%     -  161s
H    0     0                    -24086.50136 -8694.0588  63.9%     -  161s
H    0     0                    -24076.26126 -8694.0588  63.9%     -  161s
     0     0 -9795.3897    0  644 -24076.261 -9795.3897  59.3%     -  250s
H    0     0                    -23933.23258 -10031.864  58.1%     -  306s
H    0     0                    -23923.81801 -10031.864  58.1%     -  306s
H    0     0                    -23920.86806 -10031.864  58.1%     -  306s
H    0     0                    -23917.05392 -10031.864  58.1%     -  306s
H    0     0                    -23884.82248 -10031.864  58.0%     -  306s
H    0     0                    -23820.75816 -10031.864  57.9%     -  306s
H    0     0                    -23803.35968 -10031.864  57.9%     -  306s
     0     0 -10031.864    0  549 -23803.360 -10031.864  57.9%     -  306s
     0     0 -10098.626    0  558 -23803.360 -10098.626  57.6%     -  328s
     0     0 -10141.303    0  568 -23803.360 -10141.303  57.4%     -  345s
     0     0 -10155.941    0  558 -23803.360 -10155.941  57.3%     -  358s
     0     0 -10162.185    0  559 -23803.360 -10162.185  57.3%     -  365s
     0     0 -10298.825    0  640 -23803.360 -10298.825  56.7%     -  385s
     0     0 -10325.109    0  578 -23803.360 -10325.109  56.6%     -  397s
     0     0 -10327.137    0  572 -23803.360 -10327.137  56.6%     -  401s
     0     0 -10328.504    0  573 -23803.360 -10328.504  56.6%     -  403s
H    0     0                    -23698.07613 -14067.154  40.6%     -  528s
H    0     0                    -23622.05176 -14067.154  40.4%     -  528s
H    0     0                    -23601.37678 -14067.154  40.4%     -  528s
H    0     0                    -23585.31553 -14067.154  40.4%     -  528s
H    0     0                    -23562.43894 -14067.154  40.3%     -  528s
H    0     0                    -23558.00562 -14067.154  40.3%     -  528s
H    0     0                    -23556.64445 -14067.154  40.3%     -  528s
H    0     0                    -23555.34793 -14067.154  40.3%     -  528s
H    0     0                    -23537.99018 -14067.154  40.2%     -  528s
     0     0 -14067.154    0  581 -23537.990 -14067.154  40.2%     -  529s
H    0     0                    -23535.90325 -15317.840  34.9%     -  569s
     0     0 -15317.840    0  598 -23535.903 -15317.840  34.9%     -  569s
H    0     0                    -23509.98208 -15394.591  34.5%     -  581s
     0     0 -15394.591    0  530 -23509.982 -15394.591  34.5%     -  581s
     0     0 -15445.668    0  609 -23509.982 -15445.668  34.3%     -  589s
     0     0 -15499.049    0  521 -23509.982 -15499.049  34.1%     -  594s
     0     0 -15572.112    0  605 -23509.982 -15572.112  33.8%     -  602s
     0     0 -15703.134    0  604 -23509.982 -15703.134  33.2%     -  609s
     0     0 -15729.987    0  610 -23509.982 -15729.987  33.1%     -  614s
H    0     0                    -23495.41520 -15735.470  33.0%     -  617s
     0     0 -15735.470    0  615 -23495.415 -15735.470  33.0%     -  617s
     0     0 -15752.943    0  612 -23495.415 -15752.943  33.0%     -  619s
     0     0 -15754.186    0  613 -23495.415 -15754.186  32.9%     -  622s
     0     0 -16565.987    0  572 -23495.415 -16565.987  29.5%     -  664s
H    0     0                    -23493.59735 -16566.477  29.5%     -  667s
     0     0 -16701.071    0  595 -23493.597 -16701.071  28.9%     -  682s
     0     0 -16734.210    0  591 -23493.597 -16734.210  28.8%     -  699s
     0     0 -16787.893    0  590 -23493.597 -16787.893  28.5%     -  708s
     0     0 -16796.291    0  591 -23493.597 -16796.291  28.5%     -  710s
     0     0 -16800.592    0  528 -23493.597 -16800.592  28.5%     -  715s
     0     0 -16801.318    0  528 -23493.597 -16801.318  28.5%     -  716s
     0     0 -17025.785    0  580 -23493.597 -17025.785  27.5%     -  748s
     0     0 -17088.732    0  508 -23493.597 -17088.732  27.3%     -  764s
     0     0 -17111.738    0  514 -23493.597 -17111.738  27.2%     -  771s
     0     0 -17130.216    0  510 -23493.597 -17130.216  27.1%     -  778s
     0     0 -17133.074    0  509 -23493.597 -17133.074  27.1%     -  780s
     0     0 -17253.090    0  589 -23493.597 -17253.090  26.6%     -  800s
     0     0 -17288.386    0  580 -23493.597 -17288.386  26.4%     -  815s
     0     0 -17300.049    0  584 -23493.597 -17300.049  26.4%     -  822s
     0     0 -17307.497    0  581 -23493.597 -17307.497  26.3%     -  828s
H    0     0                    -23491.55148 -17314.674  26.3%     -  832s
     0     0 -17314.674    0  508 -23491.551 -17314.674  26.3%     -  832s
     0     0 -17316.092    0  588 -23491.551 -17316.092  26.3%     -  835s
     0     0 -17406.866    0  569 -23491.551 -17406.866  25.9%     -  852s
     0     0 -17438.906    0  590 -23491.551 -17438.906  25.8%     -  862s
     0     0 -17441.760    0  583 -23491.551 -17441.760  25.8%     -  865s
     0     0 -17462.070    0  509 -23491.551 -17462.070  25.7%     -  875s
     0     0 -17482.379    0  510 -23491.551 -17482.379  25.6%     -  886s
     0     0 -17488.056    0  517 -23491.551 -17488.056  25.6%     -  890s
     0     0 -17491.451    0  515 -23491.551 -17491.451  25.5%     -  895s
     0     0 -17500.498    0  517 -23491.551 -17500.498  25.5%     -  900s
     0     0 -17501.552    0  520 -23491.551 -17501.552  25.5%     -  902s
     0     0 -17511.447    0  521 -23491.551 -17511.447  25.5%     -  911s
H    0     0                    -23488.76022 -17511.545  25.4%     -  912s
     0     0 -17514.289    0  520 -23488.760 -17514.289  25.4%     -  917s
     0     0 -17517.641    0  522 -23488.760 -17517.641  25.4%     -  922s
     0     0 -17517.902    0  522 -23488.760 -17517.902  25.4%     -  928s
     0     2 -17519.512    0  522 -23488.760 -17519.512  25.4%     - 1048s
     1     3 -18336.025    1  459 -23488.760 -17521.371  25.4%  9039 1060s
     2     6 -18417.104    2  456 -23488.760 -17521.371  25.4%  6470 1069s
     5    12 -18526.403    3  476 -23488.760 -17820.348  24.1%  5394 1082s
    11    24 -18596.942    4  469 -23488.760 -17909.600  23.8%  7213 1115s
    23    32 -18621.870    4  550 -23488.760 -17963.265  23.5% 10626 1158s
    35    53 -19245.722    5  376 -23488.760 -17963.265  23.5% 10304 1319s
H   37    53                    -23478.29358 -17963.265  23.5% 10175 1319s
    62    83 -19389.784    6  528 -23478.294 -17963.265  23.5% 14170 1342s
    94   183 -19406.587    7  528 -23478.294 -17963.265  23.5% 13109 1375s
   200   257 -19454.211    8  518 -23478.294 -17963.265  23.5%  7948 1395s
   284   289 -20627.813    9  246 -23478.294 -17963.265  23.5%  7083 1419s
   316   324 -19687.712   10  540 -23478.294 -17963.265  23.5%  7028 1451s
   365   364 -20770.992   10  240 -23478.294 -17963.265  23.5%  6873 1467s
   429   407 -20105.784   10  266 -23478.294 -17963.265  23.5%  6405 1487s
   484   454 -19749.712   11  547 -23478.294 -17963.265  23.5%  6124 1506s
   541   489 -19781.088   12  543 -23478.294 -17963.265  23.5%  5938 1522s
   610   516 -21134.503   12  240 -23478.294 -17963.265  23.5%  5765 1540s
   685   533 -21275.665   13  244 -23478.294 -17963.265  23.5%  5539 1559s
   740   562 -21403.281   14  235 -23478.294 -17963.265  23.5%  5532 1577s
   801   588 -21796.679   15  229 -23478.294 -17963.265  23.5%  5543 1595s
   866   599 infeasible   15      -23478.294 -17963.265  23.5%  5516 1610s
   942   616     cutoff   16      -23478.294 -17963.265  23.5%  5394 1629s
  1002   637     cutoff   17      -23478.294 -17963.265  23.5%  5423 1646s
  1052   662 -22747.749   17  201 -23478.294 -17963.265  23.5%  5431 1664s
  1129   666 infeasible   18      -23478.294 -17963.265  23.5%  5389 1685s
  1219   694 -20714.581   11  413 -23478.294 -17963.265  23.5%  5317 1704s
  1303   736 -20886.564   12  336 -23478.294 -17963.265  23.5%  5281 1724s
  1410   789 infeasible   14      -23478.294 -17963.265  23.5%  5147 1753s
  1509   836 -22403.803   15  307 -23478.294 -18185.681  22.5%  5145 1775s
  1608   887 -23071.407   19  289 -23478.294 -18186.058  22.5%  5126 1797s
  1745   917 -23350.121   21  189 -23478.294 -18186.058  22.5%  4995 1821s
  1865   976 -19082.646    7  731 -23478.294 -18272.603  22.2%  5014 1844s
  1984  1020 -23295.019   15  221 -23478.294 -18272.603  22.2%  5044 1868s
  2079  1075 -19274.193    8  717 -23478.294 -18272.603  22.2%  5072 1895s
  2182  1131 -19587.904   10  542 -23478.294 -18272.603  22.2%  5093 1919s
  2305  1174 -21981.257   16  268 -23478.294 -18272.603  22.2%  5101 1946s
  2459  1224 -20326.164   13  421 -23478.294 -18272.603  22.2%  5071 1971s
  2590  1281 infeasible   15      -23478.294 -18272.603  22.2%  5086 2000s
  2727  1303 -22745.642   19  154 -23478.294 -19438.251  17.2%  5136 2034s
  2868  1345 -23205.852   31   36 -23478.294 -19438.251  17.2%  5125 2064s
  3012  1410 -21434.804    7  228 -23478.294 -19438.251  17.2%  5158 2094s
  3206  1447 -23137.578   10  259 -23478.294 -19438.251  17.2%  5114 2129s
  3429  1479 -23007.131   12  174 -23478.294 -19438.251  17.2%  5047 2162s
  3620  1502 infeasible   13      -23478.294 -19575.917  16.6%  5032 2196s
  3812  1524 -23207.573   15  205 -23478.294 -19575.917  16.6%  5058 2231s
  3970  1570 infeasible   14      -23478.294 -20097.611  14.4%  5090 2267s
  4164  1643 -22311.592   13  316 -23478.294 -20183.526  14.0%  5101 2303s
  4375  1653     cutoff   22      -23478.294 -20285.038  13.6%  5122 2345s
  4609  1718 infeasible   14      -23478.294 -20285.038  13.6%  5111 2385s
  4773  1784 infeasible   13      -23478.294 -20395.038  13.1%  5150 2429s
  5041  1848 -22233.126   14  296 -23478.294 -20486.450  12.7%  5121 2474s
  5319  1913 infeasible   23      -23478.294 -20486.450  12.7%  5095 2524s
  5596  1956 -22014.146   15  223 -23478.294 -20519.789  12.6%  5066 2571s
  5860  1991 infeasible   20      -23478.294 -20651.019  12.0%  5047 2619s
  6143  2020 -22376.883   12  209 -23478.294 -20736.638  11.7%  5066 2669s
  6421  2065 -22831.049   16  315 -23478.294 -20818.531  11.3%  5071 2723s
  6730  2080 -21720.489   12  222 -23478.294 -20846.023  11.2%  5093 2780s
  7042  2152 -23320.437   19  187 -23478.294 -20846.023  11.2%  5092 2837s
  7392  2146 infeasible   19      -23478.294 -20955.170  10.7%  5074 2899s
  7748  2146 -22454.501   14  215 -23478.294 -21101.388  10.1%  5073 2960s
  7968  2135 -23381.684   16  184 -23478.294 -21171.933  9.82%  5096 3025s
  8321  2149 infeasible   20      -23478.294 -21216.930  9.63%  5095 3088s
  8754  2108 -23050.391   14  310 -23478.294 -21375.565  8.96%  5079 3154s
  9130  2082 -22865.649   20  380 -23478.294 -21436.304  8.70%  5083 3223s
  9533  2071 infeasible   20      -23478.294 -21436.304  8.70%  5088 3291s
  9973  2051 -23253.857   18  271 -23478.294 -21666.354  7.72%  5057 3373s
 10336  1943 -22653.677   15  213 -23478.294 -21769.032  7.28%  5031 3445s
 10770  1906 -22942.083   16  330 -23478.294 -21838.099  6.99%  4977 3526s
 11327  1818 -22679.072   14  240 -23478.294 -21936.312  6.57%  4929 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 253
  MIR: 3541
  Flow cover: 2877
  Zero half: 24
  RLT: 210
  Relax-and-lift: 1289

Explored 11950 nodes (58956357 simplex iterations) in 3600.06 seconds (6261.74 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23478.3 -23488.8 -23491.6 ... -23556.6

Time limit reached
Best objective -2.347829358284e+04, best bound -2.208897472081e+04, gap 5.9175%
  WARNING: Time limit reached. Using best solution found (gap: 5.92%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -23478.29, θ = 94972.76
  Upper Bound (UB) = -23478.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94972.76
  [DEBUG]   ✓ Scenario 0: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94972.76 ≤ Q = 94972.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94972.76 ≤ Q = 95079.89 (slack: 107.13)
  [DEBUG]   ✓ Scenario 5: θ = 94972.76 ≤ Q = 94972.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94972.76 ≤ Q = 94972.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94972.76 ≤ Q = 94972.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94972.76 ≤ Q = 94972.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3ab16319
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3ab16319
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7712929.2138
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.107330e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110733.04    0  121 7712929.21 -110733.04   101%     -    0s
H    0     0                    -77920.41984 -110733.04  42.1%     -    0s
H    0     0                    -78385.19626 -110733.04  41.3%     -    0s
     0     0 -84060.974    0  133 -78385.196 -84060.974  7.24%     -    0s
H    0     0                    -80091.43412 -83938.798  4.80%     -    0s
     0     0 -83395.162    0  135 -80091.434 -83395.162  4.12%     -    0s
     0     0 -83153.565    0  134 -80091.434 -83153.565  3.82%     -    0s
H    0     0                    -80669.29766 -83133.347  3.05%     -    0s
     0     0 -83133.347    0  134 -80669.298 -83133.347  3.05%     -    0s
     0     0 -82926.661    0  133 -80669.298 -82926.661  2.80%     -    0s
     0     0 -82920.007    0  132 -80669.298 -82920.007  2.79%     -    0s
     0     0 -82745.842    0  131 -80669.298 -82745.842  2.57%     -    0s
     0     0 -82732.779    0  131 -80669.298 -82732.779  2.56%     -    0s
H    0     0                    -81116.23578 -82732.390  1.99%     -    0s
H    0     0                    -81384.16056 -82732.390  1.66%     -    0s
     0     2 -82732.390    0  131 -81384.161 -82732.390  1.66%     -    0s
H  508   294                    -81426.33191 -82279.244  1.05%   5.8    0s

Cutting planes:
  Gomory: 29
  MIR: 260
  RLT: 2

Explored 3819 nodes (25108 simplex iterations) in 0.53 seconds (0.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -81426.3 -81384.2 -81116.2 ... 1.46171e+13
No other solutions better than -81426.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.142633190948e+04, best bound -8.142633190948e+04, gap 0.0000%
  Subproblem solved in 0.56s
  Worst-case operational profit (Z_SP) = 94229.77
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81426.33
  [DEBUG]   S×d_nominal = 175656.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175656.10 + -81426.33 = 94229.77
  [DEBUG]   Current θ from Master = 94972.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 742.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24221.29
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 591.9022, Absolute Gap = 591.9022, Relative Gap = 0.025211
  Not converged yet (gap = 591.90 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524255 nonzeros
Model fingerprint: 0xe76ac076
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86272 rows and 35042 columns
Presolve time: 2.67s
Presolved: 98591 rows, 42098 columns, 599591 nonzeros
Variable types: 39839 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407734.5176
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 668
 AA' NZ     : 3.230e+06
 Factor NZ  : 7.712e+06 (roughly 120 MB of memory)
 Factor Ops : 1.504e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.15966605e+07  1.85017779e+08  3.48e+05 2.31e+01  1.28e+05     4s
   1  -3.65189794e+07  1.90539263e+08  2.96e+05 8.41e+01  1.08e+05     4s
   2  -2.31483369e+07  1.51893668e+08  1.77e+05 4.36e+01  6.57e+04     5s
   3  -1.49178652e+07  1.22166395e+08  1.12e+05 1.99e+01  4.17e+04     5s
   4  -6.15285277e+06  1.11770482e+08  4.50e+04 1.09e+01  1.70e+04     5s
   5  -2.28442946e+06  1.00041896e+08  1.37e+04 9.56e+00  5.51e+03     5s
   6  -9.50995670e+05  6.93229712e+07  3.00e+03 3.57e+00  1.44e+03     5s
   7  -6.71984057e+05  4.36048781e+07  1.08e+03 1.67e+00  5.95e+02     5s
   8  -4.59181478e+05  1.77042429e+07  2.37e+02 3.60e-01  1.68e+02     5s
   9  -2.66225292e+05  1.00413626e+07  8.37e+01 1.39e-02  7.71e+01     5s
  10  -1.71999736e+05  5.64671125e+06  4.06e+01 6.56e-03  3.94e+01     5s
  11  -1.43100648e+05  4.40322780e+06  2.79e+01 4.98e-03  2.93e+01     5s
  12  -1.21993784e+05  2.97786317e+06  1.75e+01 6.40e-03  1.91e+01     5s
  13  -8.52459993e+04  1.44329906e+06  7.81e+00 1.38e-03  8.95e+00     5s
  14  -4.60302026e+04  4.52349470e+05  2.65e+00 4.66e-04  2.82e+00     5s
  15  -3.85325034e+04  2.64486727e+05  1.90e+00 3.16e-04  1.70e+00     5s
  16  -2.83061406e+04  1.17220902e+05  1.11e+00 2.16e-04  8.14e-01     6s
  17  -2.39407044e+04  9.02278267e+04  8.60e-01 2.40e-04  6.37e-01     6s
  18  -1.94530736e+04  7.09031768e+04  6.56e-01 1.93e-04  5.04e-01     6s
  19  -1.50722214e+04  4.56689071e+04  4.55e-01 2.50e-04  3.38e-01     6s
  20  -1.18930208e+04  3.16666160e+04  3.41e-01 4.17e-04  2.42e-01     6s
  21  -9.27628215e+03  2.78893150e+04  2.64e-01 6.33e-04  2.07e-01     6s
  22  -7.58855150e+03  2.22733715e+04  2.18e-01 7.81e-04  1.66e-01     6s
  23  -5.78064001e+03  1.74667212e+04  1.73e-01 1.04e-03  1.29e-01     6s
  24  -4.77295639e+03  1.42237815e+04  1.47e-01 1.07e-03  1.06e-01     6s
  25  -3.52756156e+03  1.16009586e+04  1.17e-01 1.03e-03  8.40e-02     6s
  26  -2.48988549e+03  9.72385855e+03  9.33e-02 7.07e-04  6.78e-02     6s
  27  -1.98562997e+03  8.36481761e+03  8.18e-02 7.07e-04  5.75e-02     6s
  28  -1.39049216e+03  7.45884338e+03  6.89e-02 9.16e-04  4.91e-02     6s
  29  -7.84940168e+02  6.70181459e+03  5.58e-02 1.14e-03  4.15e-02     7s
  30  -3.26690118e+02  6.28135648e+03  4.60e-02 1.21e-03  3.67e-02     7s
  31  -1.37374668e+02  5.79352138e+03  4.20e-02 1.34e-03  3.29e-02     7s
  32   3.69055237e+02  5.27094661e+03  3.16e-02 1.52e-03  2.72e-02     7s
  33   6.12408688e+02  4.43867817e+03  2.73e-02 2.21e-03  2.12e-02     7s
  34   9.46056210e+02  4.09116487e+03  2.14e-02 1.76e-03  1.74e-02     7s
  35   1.18064348e+03  3.58126745e+03  1.73e-02 1.29e-03  1.33e-02     7s
  36   1.46825906e+03  3.28091559e+03  1.27e-02 9.40e-04  1.01e-02     7s
  37   1.62049957e+03  2.96199473e+03  1.03e-02 6.34e-04  7.44e-03     7s
  38   1.69934916e+03  2.90570342e+03  9.11e-03 5.79e-04  6.69e-03     7s
  39   1.89732087e+03  2.75253995e+03  6.17e-03 4.11e-04  4.74e-03     7s
  40   1.91317937e+03  2.69297397e+03  5.93e-03 3.53e-04  4.33e-03     8s
  41   1.94357625e+03  2.66078569e+03  5.48e-03 3.21e-04  3.98e-03     8s
  42   2.05222904e+03  2.59191638e+03  3.91e-03 2.50e-04  2.99e-03     8s
  43   2.16199357e+03  2.51951219e+03  2.35e-03 1.75e-04  1.98e-03     8s
  44   2.19462748e+03  2.43248310e+03  1.89e-03 9.19e-05  1.32e-03     8s
  45   2.20147626e+03  2.42134958e+03  1.79e-03 8.00e-05  1.22e-03     8s
  46   2.25072936e+03  2.40582202e+03  1.17e-03 6.39e-05  8.60e-04     8s
  47   2.26135826e+03  2.39641164e+03  1.03e-03 5.40e-05  7.49e-04     8s
  48   2.28088947e+03  2.37981836e+03  7.73e-04 3.64e-05  5.49e-04     8s
  49   2.30379342e+03  2.35479612e+03  4.87e-04 9.43e-06  2.83e-04     8s
  50   2.33597129e+03  2.34729367e+03  7.55e-05 3.00e-06  6.28e-05     9s
  51   2.33667007e+03  2.34675621e+03  6.74e-05 2.63e-06  5.59e-05     9s
  52   2.33880202e+03  2.34315147e+03  4.35e-05 2.38e-07  2.41e-05     9s
  53   2.34146769e+03  2.34277441e+03  1.28e-05 3.95e-08  7.25e-06     9s
  54   2.34267267e+03  2.34269778e+03  2.55e-07 5.31e-08  1.39e-07     9s
  55   2.34269709e+03  2.34269710e+03  3.59e-10 8.60e-11  4.65e-11     9s

Barrier solved model in 55 iterations and 8.98 seconds (8.66 work units)
Optimal objective 2.34269709e+03


Root crossover log...

   78193 DPushes remaining with DInf 0.0000000e+00                 9s
   17914 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2879 PPushes remaining with PInf 1.7151247e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.8642594e-11     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32171    2.3426971e+03   0.000000e+00   0.000000e+00     12s
   32171    2.3426971e+03   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.342697e+03, 32171 iterations, 8.19 seconds (9.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2342.69710    0  460 -222248.17 2342.69710   101%     -   12s
H    0     0                    -213942.2567 2342.69710   101%     -   12s
H    0     0                    -150985.8162 2342.69710   102%     -   13s
H    0     0                    -148726.3718 2342.69710   102%     -   13s
H    0     0                    -108645.6300 2342.69710   102%     -   13s
H    0     0                    -108314.2908 2342.69710   102%     -   13s
H    0     0                    -92101.08916 2342.69710   103%     -   14s
H    0     0                    -59230.39433 2342.69710   104%     -   14s
H    0     0                    -59157.28848 2342.69710   104%     -   14s
H    0     0                    -57096.09357 2342.69710   104%     -   16s
H    0     0                    -52681.68220 2342.69710   104%     -   16s
H    0     0                    -52572.23292 2342.69710   104%     -   16s
     0     0 -4039.6523    0  717 -52572.233 -4039.6523  92.3%     -   49s
H    0     0                    -47806.44385 -4040.6142  91.5%     -   49s
H    0     0                    -47728.70232 -4040.6142  91.5%     -   49s
H    0     0                    -47554.97688 -4040.6142  91.5%     -   49s
H    0     0                    -47490.77354 -4040.6142  91.5%     -   49s
H    0     0                    -47447.27005 -4040.6142  91.5%     -   49s
H    0     0                    -47406.63320 -4040.6142  91.5%     -   49s
H    0     0                    -47201.47195 -4040.6142  91.4%     -   49s
H    0     0                    -47197.55972 -4040.6142  91.4%     -   49s
H    0     0                    -41974.65905 -4385.0734  89.6%     -   60s
H    0     0                    -41970.74682 -4385.0734  89.6%     -   60s
H    0     0                    -41930.15628 -4385.0734  89.5%     -   60s
H    0     0                    -41752.46439 -4385.0734  89.5%     -   60s
H    0     0                    -41507.03349 -4385.0734  89.4%     -   60s
H    0     0                    -41500.33245 -4385.0734  89.4%     -   60s
H    0     0                    -41254.90155 -4385.0734  89.4%     -   60s
     0     0 -4385.0734    0  717 -41254.902 -4385.0734  89.4%     -   60s
     0     0 -4450.6571    0  725 -41254.902 -4450.6571  89.2%     -   65s
     0     0 -4530.3799    0  709 -41254.902 -4530.3799  89.0%     -   71s
     0     0 -4567.6030    0  721 -41254.902 -4567.6030  88.9%     -   73s
     0     0 -4592.1674    0  721 -41254.902 -4592.1674  88.9%     -   74s
     0     0 -4593.6173    0  721 -41254.902 -4593.6173  88.9%     -   75s
H    0     0                    -36152.12623 -7369.1834  79.6%     -  153s
H    0     0                    -33500.51357 -7369.1834  78.0%     -  153s
H    0     0                    -33309.56608 -7369.1834  77.9%     -  153s
H    0     0                    -32345.63682 -7369.1834  77.2%     -  153s
H    0     0                    -32343.18998 -7369.1834  77.2%     -  153s
H    0     0                    -32296.19875 -7369.1834  77.2%     -  153s
     0     0 -7917.0899    0  569 -32296.199 -7917.0899  75.5%     -  153s
H    0     0                    -27469.99702 -7917.0899  71.2%     -  154s
     0     0 -8372.0875    0  730 -27469.997 -8372.0875  69.5%     -  198s
H    0     0                    -24550.40449 -9089.6609  63.0%     -  233s
H    0     0                    -24219.74907 -9089.6609  62.5%     -  233s
H    0     0                    -24171.41094 -9089.6609  62.4%     -  233s
H    0     0                    -24152.48668 -9089.6609  62.4%     -  233s
H    0     0                    -24147.43790 -9089.6609  62.4%     -  233s
H    0     0                    -24134.72946 -9089.6609  62.3%     -  233s
H    0     0                    -24114.16441 -9089.6609  62.3%     -  233s
H    0     0                    -23797.77658 -9089.6609  61.8%     -  233s
H    0     0                    -23758.94966 -9089.6609  61.7%     -  233s
H    0     0                    -23753.54168 -9089.6609  61.7%     -  233s
H    0     0                    -23688.87214 -9089.6609  61.6%     -  233s
H    0     0                    -23686.53854 -9089.6609  61.6%     -  233s
H    0     0                    -23661.72793 -9089.6609  61.6%     -  233s
H    0     0                    -23652.10159 -9089.6609  61.6%     -  233s
H    0     0                    -23616.63351 -9089.6609  61.5%     -  233s
H    0     0                    -23615.06886 -9089.6609  61.5%     -  233s
     0     0 -9089.6609    0  671 -23615.069 -9089.6609  61.5%     -  233s
     0     0 -9360.3945    0  743 -23615.069 -9360.3945  60.4%     -  262s
     0     0 -9475.6228    0  742 -23615.069 -9475.6228  59.9%     -  275s
     0     0 -9526.0755    0  739 -23615.069 -9526.0755  59.7%     -  284s
     0     0 -9575.2500    0  744 -23615.069 -9575.2500  59.5%     -  297s
H    0     0                    -23594.65464 -9630.9806  59.2%     -  311s
     0     0 -9630.9806    0  734 -23594.655 -9630.9806  59.2%     -  311s
     0     0 -9679.7230    0  740 -23594.655 -9679.7230  59.0%     -  323s
H    0     0                    -23572.34159 -9687.6896  58.9%     -  333s
H    0     0                    -23571.14107 -9687.6896  58.9%     -  333s
H    0     0                    -23569.60185 -9687.6896  58.9%     -  333s
     0     0 -9687.6896    0  741 -23569.602 -9687.6896  58.9%     -  333s
     0     0 -9688.6798    0  744 -23569.602 -9688.6798  58.9%     -  336s
H    0     0                    -23567.51552 -12036.820  48.9%     -  442s
H    0     0                    -23543.84502 -12036.820  48.9%     -  442s
H    0     0                    -23540.74135 -12036.820  48.9%     -  442s
H    0     0                    -23528.03787 -12036.820  48.8%     -  442s
     0     0 -12036.820    0  494 -23528.038 -12036.820  48.8%     -  442s
H    0     0                    -23518.96136 -12036.919  48.8%     -  444s
H    0     0                    -23513.69248 -12036.919  48.8%     -  444s
H    0     0                    -23503.65433 -13925.089  40.8%     -  502s
     0     0 -13925.089    0  491 -23503.654 -13925.089  40.8%     -  502s
     0     0 -14678.582    0  564 -23503.654 -14678.582  37.5%     -  523s
     0     0 -14837.433    0  601 -23503.654 -14837.433  36.9%     -  533s
     0     0 -14868.459    0  580 -23503.654 -14868.459  36.7%     -  537s
     0     0 -14957.044    0  576 -23503.654 -14957.044  36.4%     -  544s
     0     0 -15162.613    0  606 -23503.654 -15162.613  35.5%     -  554s
     0     0 -15180.263    0  603 -23503.654 -15180.263  35.4%     -  557s
     0     0 -15186.280    0  601 -23503.654 -15186.280  35.4%     -  559s
     0     0 -15231.282    0  603 -23503.654 -15231.282  35.2%     -  566s
     0     0 -15235.531    0  595 -23503.654 -15235.531  35.2%     -  568s
     0     0 -15236.450    0  604 -23503.654 -15236.450  35.2%     -  569s
     0     0 -16413.471    0  600 -23503.654 -16413.471  30.2%     -  618s
     0     0 -16883.482    0  600 -23503.654 -16883.482  28.2%     -  660s
     0     0 -16986.195    0  604 -23503.654 -16986.195  27.7%     -  672s
     0     0 -17022.805    0  617 -23503.654 -17022.805  27.6%     -  682s
     0     0 -17038.496    0  624 -23503.654 -17038.496  27.5%     -  688s
     0     0 -17043.017    0  622 -23503.654 -17043.017  27.5%     -  692s
     0     0 -17057.170    0  641 -23503.654 -17057.170  27.4%     -  699s
     0     0 -17064.032    0  634 -23503.654 -17064.032  27.4%     -  703s
     0     0 -17070.823    0  536 -23503.654 -17070.823  27.4%     -  707s
     0     0 -17077.794    0  536 -23503.654 -17077.794  27.3%     -  712s
     0     0 -17077.989    0  543 -23503.654 -17077.989  27.3%     -  713s
     0     0 -17237.113    0  595 -23503.654 -17237.113  26.7%     -  734s
     0     0 -17282.184    0  616 -23503.654 -17282.184  26.5%     -  746s
     0     0 -17297.974    0  616 -23503.654 -17297.974  26.4%     -  752s
     0     0 -17323.352    0  610 -23503.654 -17323.352  26.3%     -  763s
     0     0 -17332.617    0  598 -23503.654 -17332.617  26.3%     -  772s
     0     0 -17335.070    0  607 -23503.654 -17335.070  26.2%     -  775s
     0     0 -17410.306    0  593 -23503.654 -17410.306  25.9%     -  795s
     0     0 -17432.218    0  685 -23503.654 -17432.218  25.8%     -  810s
     0     0 -17438.486    0  600 -23503.654 -17438.486  25.8%     -  817s
     0     0 -17457.419    0  517 -23503.654 -17457.419  25.7%     -  828s
     0     0 -17464.076    0  514 -23503.654 -17464.076  25.7%     -  833s
     0     0 -17466.281    0  607 -23503.654 -17466.281  25.7%     -  838s
     0     0 -17524.442    0  606 -23503.654 -17524.442  25.4%     -  857s
     0     0 -17530.559    0  599 -23503.654 -17530.559  25.4%     -  866s
     0     0 -17534.750    0  598 -23503.654 -17534.750  25.4%     -  871s
     0     0 -17537.295    0  595 -23503.654 -17537.295  25.4%     -  873s
     0     0 -17562.301    0  581 -23503.654 -17562.301  25.3%     -  885s
H    0     0                    -23498.29231 -17562.559  25.3%     -  886s
     0     0 -17593.862    0  591 -23498.292 -17593.862  25.1%     -  895s
     0     0 -17618.293    0  491 -23498.292 -17618.293  25.0%     -  906s
     0     0 -17628.109    0  520 -23498.292 -17628.109  25.0%     -  913s
     0     0 -17630.404    0  506 -23498.292 -17630.404  25.0%     -  916s
     0     0 -17664.086    0  616 -23498.292 -17664.086  24.8%     -  936s
     0     0 -17668.500    0  610 -23498.292 -17668.500  24.8%     -  943s
     0     0 -17669.375    0  613 -23498.292 -17669.375  24.8%     -  945s
     0     0 -17696.984    0  516 -23498.292 -17696.984  24.7%     -  958s
H    0     0                    -23484.23070 -17697.194  24.6%     -  960s
H    0     0                    -23482.78431 -17697.194  24.6%     -  960s
     0     0 -17704.614    0  518 -23482.784 -17704.614  24.6%     -  970s
     0     0 -17705.192    0  602 -23482.784 -17705.192  24.6%     -  972s
     0     0 -17705.192    0  602 -23482.784 -17705.192  24.6%     -  972s
     0     0 -17717.067    0  602 -23482.784 -17717.067  24.6%     -  981s
H    0     0                    -23478.80408 -17717.792  24.5%     -  982s
     0     0 -17720.588    0  525 -23478.804 -17720.588  24.5%     -  986s
     0     0 -17731.122    0  517 -23478.804 -17731.122  24.5%     - 1006s
     0     0 -17731.325    0  517 -23478.804 -17731.325  24.5%     - 1014s
     0     2 -17731.341    0  517 -23478.804 -17731.341  24.5%     - 1171s
     1     3 -18289.573    1  479 -23478.804 -17732.115  24.5% 12034 1191s
     2     5 -18382.632    2  488 -23478.804 -17732.115  24.5% 10103 1207s
     4     8 -18017.297    2  517 -23478.804 -17977.036  23.4%  9145 1228s
     7    15 -19180.143    4  365 -23478.804 -17977.036  23.4%  9224 1252s
    14    29 -19081.271    4  479 -23478.804 -18017.334  23.3%  9165 1277s
    28    43 -19352.402    5  568 -23478.804 -18072.041  23.0% 12801 1339s
    42    69 -19043.881    5  566 -23478.804 -18525.795  21.1% 12250 1484s
    74   160 -19169.046    6  404 -23478.804 -18609.451  20.7% 12858 1532s
   169   238 -19240.056    7  485 -23478.804 -18877.848  19.6%  9746 1561s
   267   285 -19282.034    8  475 -23478.804 -18877.848  19.6%  8217 1585s
   344   316 -19354.766    9  478 -23478.804 -18877.848  19.6%  7566 1606s
   391   355 -19817.013   13  653 -23478.804 -18877.848  19.6%  7452 1627s
   452   379 infeasible   10      -23478.804 -18877.848  19.6%  7102 1651s
   542   398 -20046.086   14  449 -23478.804 -18877.848  19.6%  6684 1671s
   619   406 -20624.435   16  352 -23478.804 -18877.848  19.6%  6433 1692s
   677   428 infeasible   17      -23478.804 -18877.848  19.6%  6361 1713s
   735   467 -20984.610   19  337 -23478.804 -18877.848  19.6%  6370 1733s
   786   507 -21300.885   22  283 -23478.804 -18877.848  19.6%  6426 1752s
   848   533 -21511.797   24  425 -23478.804 -18877.848  19.6%  6471 1777s
   892   579 -21532.413   25  402 -23478.804 -18877.848  19.6%  6480 1798s
   951   601 -21567.955   26  413 -23478.804 -18877.848  19.6%  6480 1816s
   991   622 -22235.082   27  399 -23478.804 -19141.277  18.5%  6476 1837s
  1038   663     cutoff   28      -23478.804 -19141.277  18.5%  6515 1858s
  1109   724 -22254.769   28  305 -23478.804 -19141.277  18.5%  6444 1881s
  1202   785 infeasible   29      -23478.804 -19141.277  18.5%  6390 1902s
  1318   850 -22677.250   30  391 -23478.804 -19231.506  18.1%  6296 1925s
  1429   920 -22998.506   34  376 -23478.804 -19231.506  18.1%  6159 1949s
  1543   968 infeasible   42      -23478.804 -19231.506  18.1%  5997 1979s
  1659   999 infeasible   19      -23478.804 -19231.506  18.1%  5898 2004s
  1748  1040 infeasible   36      -23478.804 -19231.506  18.1%  5863 2031s
  1861  1100 -20297.548   10  389 -23478.804 -19231.506  18.1%  5819 2060s
  1999  1129 -20438.692   12  360 -23478.804 -19231.506  18.1%  5750 2099s
  2075  1187 -20481.247   13  361 -23478.804 -19330.134  17.7%  5722 2126s
  2195  1243     cutoff   17      -23478.804 -19330.134  17.7%  5715 2159s
  2297  1313 -20882.057   18  347 -23478.804 -19330.134  17.7%  5767 2190s
  2408  1405 -21212.228   22  417 -23478.804 -19476.652  17.0%  5812 2229s
  2530  1488 -21727.721   24  540 -23478.804 -19476.652  17.0%  5864 2263s
  2671  1550 infeasible   28      -23478.804 -19476.652  17.0%  5915 2299s
  2811  1641 -22823.417   40  393 -23478.804 -19476.652  17.0%  5872 2338s
  2978  1715 -23239.319   49  301 -23478.804 -19476.652  17.0%  5863 2376s
  3116  1792 -20416.209   12  230 -23478.804 -19476.652  17.0%  5832 2420s
  3265  1860 -20627.083   13  323 -23478.804 -19476.652  17.0%  5859 2464s
  3397  1913 infeasible   14      -23478.804 -19564.776  16.7%  5924 2507s
  3502  1977 infeasible   36      -23478.804 -19564.776  16.7%  5937 2551s
  3620  2039 infeasible   28      -23478.804 -19564.776  16.7%  6029 2597s
  3760  2126 -23139.244   43  324 -23478.804 -19564.776  16.7%  6105 2643s
  3918  2186 infeasible   30      -23478.804 -19699.659  16.1%  6143 2694s
  4076  2262 -20828.815   12  359 -23478.804 -19781.023  15.7%  6208 2745s
  4242  2361 infeasible   14      -23478.804 -19817.239  15.6%  6265 2801s
  4461  2410 -21318.703   15  452 -23478.804 -19817.239  15.6%  6257 2853s
  4637  2489 -21337.953   16  433 -23478.804 -19836.125  15.5%  6260 2912s
  4789  2490 -21991.096   20  517 -23478.804 -19849.343  15.5%  6271 3268s
  4791  2491 -22319.632   29  489 -23478.804 -19849.343  15.5%  6268 3285s
  4792  2492 -20678.345   16  498 -23478.804 -19849.343  15.5%  6267 3372s
  4793  2493 -22502.233   27  555 -23478.804 -19849.343  15.5%  6266 3432s
  4794  2493 -22450.618   29  587 -23478.804 -19849.343  15.5%  6264 3465s
  4795  2494 -21918.488   20  554 -23478.804 -19849.343  15.5%  6263 3497s
  4796  2495 -21064.390   18  589 -23478.804 -19849.343  15.5%  6262 3520s
  4797  2495 -23005.343   27  585 -23478.804 -19849.343  15.5%  6260 3548s
  4798  2496 -23207.975   16  588 -23478.804 -19849.343  15.5%  6259 3575s
  4799  2497 -20854.421   13  602 -23478.804 -19849.343  15.5%  6258 3586s
  4800  2497 -21810.261   12  600 -23478.804 -19849.343  15.5%  6257 3590s

Cutting planes:
  Implied bound: 51
  Projected implied bound: 485
  MIR: 1197
  Flow cover: 1050
  Zero half: 7
  RLT: 89
  Relax-and-lift: 296

Explored 4800 nodes (30980455 simplex iterations) in 3600.05 seconds (5673.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23478.8 -23482.8 -23484.2 ... -23543.8

Time limit reached
Best objective -2.347880408002e+04, best bound -1.984934321703e+04, gap 15.4585%
  WARNING: Time limit reached. Using best solution found (gap: 15.46%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -23478.80, θ = 94943.81
  Upper Bound (UB) = -23478.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94943.81
  [DEBUG]   ✓ Scenario 0: θ = 94943.81 ≤ Q = 94943.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94943.81 ≤ Q = 94943.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94943.81 ≤ Q = 94943.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94943.81 ≤ Q = 94943.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x574e93a6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x574e93a6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7711190.0679
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.108105e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110810.50    0  122 7711190.07 -110810.50   101%     -    0s
H    0     0                    -77943.03165 -110810.50  42.2%     -    0s
H    0     0                    -78366.51157 -110810.50  41.4%     -    0s
     0     0 -84215.426    0  131 -78366.512 -84215.426  7.46%     -    0s
H    0     0                    -80217.49654 -84146.362  4.90%     -    0s
     0     0 -83875.131    0  135 -80217.497 -83875.131  4.56%     -    0s
H    0     0                    -80470.67538 -83533.427  3.81%     -    0s
     0     0 -83533.427    0  133 -80470.675 -83533.427  3.81%     -    0s
     0     0 -83522.472    0  133 -80470.675 -83522.472  3.79%     -    0s
     0     0 -83365.980    0  131 -80470.675 -83365.980  3.60%     -    0s
H    0     0                    -80781.79046 -83365.980  3.20%     -    0s
     0     0 -83351.877    0  131 -80781.790 -83351.877  3.18%     -    0s
     0     2 -83351.111    0  131 -80781.790 -83351.111  3.18%     -    0s
H   47    64                    -81295.80134 -83143.966  2.27%  10.1    0s
H   63    94                    -81925.01361 -83105.622  1.44%  15.1    0s
H   95   105                    -81947.53192 -83105.622  1.41%  12.4    0s
H  115   105                    -82100.49525 -83105.622  1.22%  11.0    0s
H  227   118                    -82107.69923 -82859.588  0.92%   8.5    0s
H 1566   438                    -82121.25899 -82434.072  0.38%   5.7    0s
* 1976   503              42    -82125.67764 -82349.328  0.27%   5.5    0s
H 2302   583                    -82126.35800 -82323.214  0.24%   5.5    0s
* 2305   583              36    -82133.73873 -82323.214  0.23%   5.5    0s
* 2309   583              36    -82156.50148 -82323.214  0.20%   5.5    0s
* 2407   583              36    -82163.98729 -82323.214  0.19%   5.5    0s
* 3848   239              35    -82166.04926 -82229.273  0.08%   5.9    0s

Cutting planes:
  Gomory: 78
  MIR: 213
  RLT: 1

Explored 4134 nodes (24408 simplex iterations) in 0.63 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -82166 -82164 -82156.5 ... -81947.5
No other solutions better than -82166

Optimal solution found (tolerance 1.00e-06)
Best objective -8.216604925680e+04, best bound -8.216604925680e+04, gap 0.0000%
  Subproblem solved in 0.66s
  Worst-case operational profit (Z_SP) = 93559.55
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82166.05
  [DEBUG]   S×d_nominal = 175725.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175725.60 + -82166.05 = 93559.55
  [DEBUG]   Current θ from Master = 94943.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1384.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24863.06
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 591.3917, Absolute Gap = 591.3917, Relative Gap = 0.025188
  Not converged yet (gap = 591.39 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567483 nonzeros
Model fingerprint: 0xa568cbf3
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93463 rows and 37963 columns
Presolve time: 3.81s
Presolved: 106690 rows, 45417 columns, 645374 nonzeros
Variable types: 43158 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407906.2669
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 656
 AA' NZ     : 3.670e+06
 Factor NZ  : 9.879e+06 (roughly 140 MB of memory)
 Factor Ops : 3.445e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.16023657e+07  1.99887352e+08  3.48e+05 2.16e+01  1.28e+05     6s
   1  -3.66538192e+07  2.05151661e+08  2.97e+05 7.96e+01  1.09e+05     6s
   2  -2.25514336e+07  1.65395384e+08  1.75e+05 4.20e+01  6.47e+04     6s
   3  -9.51896260e+06  1.17399454e+08  7.26e+04 9.77e+00  2.70e+04     6s
   4  -8.32468010e+06  1.16440178e+08  5.90e+04 9.48e+00  2.20e+04     6s
   5  -2.16614127e+06  8.25586819e+07  1.15e+04 2.39e+00  4.51e+03     6s
   6  -1.19452334e+06  7.56753544e+07  4.11e+03 1.91e+00  1.84e+03     7s
   7  -7.95314782e+05  4.52448578e+07  1.23e+03 6.96e-01  6.35e+02     7s
   8  -5.78473097e+05  2.07650052e+07  2.75e+02 2.50e-01  1.89e+02     7s
   9  -3.06992418e+05  1.14635905e+07  9.42e+01 8.62e-02  8.34e+01     7s
  10  -1.83832142e+05  7.79021505e+06  3.72e+01 1.20e-02  4.83e+01     7s
  11  -1.65690926e+05  6.30663061e+06  2.95e+01 9.39e-03  3.83e+01     7s
  12  -1.45626897e+05  4.91076001e+06  2.10e+01 7.10e-03  2.89e+01     7s
  13  -1.26514677e+05  2.97281024e+06  1.41e+01 4.13e-03  1.73e+01     7s
  14  -7.13557885e+04  1.57880706e+06  3.32e+00 2.15e-03  8.64e+00     7s
  15  -4.88437540e+04  5.15817607e+05  1.84e+00 6.50e-04  2.93e+00     7s
  16  -3.73621635e+04  2.77489838e+05  1.09e+00 2.74e-04  1.63e+00     8s
  17  -2.80463158e+04  1.38498202e+05  6.41e-01 5.08e-04  8.57e-01     8s
  18  -2.40131434e+04  8.61206735e+04  4.81e-01 2.37e-04  5.66e-01     8s
  19  -1.79763480e+04  5.81226023e+04  3.14e-01 8.60e-04  3.91e-01     8s
  20  -1.34478066e+04  3.61619788e+04  2.19e-01 1.75e-03  2.55e-01     8s
  21  -9.99680106e+03  2.55243417e+04  1.62e-01 1.76e-03  1.82e-01     8s
  22  -8.00908378e+03  2.21068426e+04  1.33e-01 1.97e-03  1.54e-01     8s
  23  -6.56993030e+03  2.00093878e+04  1.14e-01 2.12e-03  1.36e-01     8s
  24  -5.56556693e+03  1.47859930e+04  1.01e-01 1.99e-03  1.04e-01     8s
  25  -3.74081083e+03  1.30777228e+04  7.74e-02 1.90e-03  8.63e-02     9s
  26  -2.88810620e+03  1.06353333e+04  6.74e-02 2.57e-03  6.94e-02     9s
  27  -1.48033789e+03  9.50511773e+03  5.05e-02 2.14e-03  5.63e-02     9s
  28  -1.15450724e+03  8.77716045e+03  4.62e-02 1.97e-03  5.09e-02     9s
  29  -7.96848742e+02  8.25878831e+03  4.20e-02 1.89e-03  4.64e-02     9s
  30  -5.32453613e+02  7.89022471e+03  3.89e-02 1.90e-03  4.32e-02     9s
  31  -2.42169611e+02  7.60134399e+03  3.54e-02 1.84e-03  4.02e-02     9s
  32   2.92556580e+02  6.63651399e+03  2.92e-02 1.44e-03  3.25e-02     9s
  33   5.12558168e+02  6.31286335e+03  2.67e-02 1.32e-03  2.97e-02     9s
  34   9.29107326e+02  5.96059520e+03  2.21e-02 1.17e-03  2.58e-02    10s
  35   1.29458625e+03  5.45455316e+03  1.80e-02 9.63e-04  2.13e-02    10s
  36   1.71940769e+03  5.19606447e+03  1.37e-02 8.49e-04  1.78e-02    10s
  37   1.84680212e+03  4.91410950e+03  1.23e-02 6.92e-04  1.57e-02    10s
  38   2.09929932e+03  4.65163429e+03  9.70e-03 6.09e-04  1.31e-02    10s
  39   2.15170465e+03  4.59494202e+03  9.22e-03 5.86e-04  1.25e-02    10s
  40   2.31145987e+03  4.48093379e+03  7.63e-03 5.40e-04  1.11e-02    10s
  41   2.36173113e+03  4.26506707e+03  7.06e-03 4.52e-04  9.75e-03    11s
  42   2.48766771e+03  4.10367349e+03  5.85e-03 4.24e-04  8.28e-03    11s
  43   2.67163921e+03  4.01253329e+03  4.20e-03 3.82e-04  6.87e-03    11s
  44   2.74876899e+03  3.76514936e+03  3.50e-03 2.60e-04  5.21e-03    11s
  45   2.79969402e+03  3.69354161e+03  3.11e-03 2.26e-04  4.58e-03    11s
  46   2.87225880e+03  3.63167523e+03  2.53e-03 2.00e-04  3.89e-03    11s
  47   2.93171958e+03  3.50668926e+03  2.06e-03 1.38e-04  2.95e-03    11s
  48   2.98400317e+03  3.39760195e+03  1.67e-03 9.03e-05  2.12e-03    12s
  49   3.09416467e+03  3.36403471e+03  8.78e-04 7.26e-05  1.38e-03    12s
  50   3.12641640e+03  3.32776749e+03  6.48e-04 5.03e-05  1.03e-03    12s
  51   3.17728980e+03  3.27635901e+03  3.12e-04 2.67e-05  5.08e-04    12s
  52   3.20667255e+03  3.24085786e+03  1.15e-04 7.11e-06  1.75e-04    12s
  53   3.21820894e+03  3.23572186e+03  4.59e-05 4.62e-06  8.97e-05    12s
  54   3.22264667e+03  3.23180388e+03  1.71e-05 2.78e-06  4.69e-05    12s
  55   3.22445637e+03  3.23044840e+03  7.46e-06 2.13e-06  3.07e-05    13s
  56   3.22478254e+03  3.22772755e+03  5.75e-06 8.41e-07  1.51e-05    13s
  57   3.22487739e+03  3.22769329e+03  5.26e-06 8.24e-07  1.44e-05    13s
  58   3.22506180e+03  3.22648684e+03  4.24e-06 3.05e-07  7.30e-06    13s
  59   3.22567344e+03  3.22607748e+03  9.78e-07 1.46e-07  2.07e-06    13s
  60   3.22582011e+03  3.22599660e+03  3.16e-07 9.99e-08  9.04e-07    13s
  61   3.22586195e+03  3.22598405e+03  1.31e-07 8.80e-08  6.25e-07    13s
  62   3.22587436e+03  3.22597891e+03  7.75e-08 8.28e-08  5.35e-07    14s
  63   3.22588385e+03  3.22596268e+03  2.26e-08 6.82e-08  4.04e-07    14s
  64   3.22589195e+03  3.22589343e+03  1.05e-08 9.88e-09  7.59e-09    14s
  65   3.22589264e+03  3.22589265e+03  3.68e-09 4.97e-09  5.82e-11    14s

Barrier solved model in 65 iterations and 14.15 seconds (11.60 work units)
Optimal objective 3.22589264e+03


Root crossover log...

   86745 DPushes remaining with DInf 0.0000000e+00                14s
   26009 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    3323 PPushes remaining with PInf 5.5747962e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5765347e-11     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35347    3.2258926e+03   0.000000e+00   0.000000e+00     17s
   35347    3.2258926e+03   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.225893e+03, 35347 iterations, 12.61 seconds (13.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3225.89265    0  423 -222248.17 3225.89265   101%     -   18s
H    0     0                    -215843.7215 3225.89265   101%     -   18s
H    0     0                    -162945.4620 3225.89265   102%     -   18s
H    0     0                    -130634.9962 3225.89265   102%     -   18s
H    0     0                    -71642.36170 3225.89265   105%     -   19s
H    0     0                    -63780.72268 3225.89265   105%     -   19s
H    0     0                    -43726.88544 3225.89265   107%     -   19s
H    0     0                    -41170.68483 3225.89265   108%     -   19s
H    0     0                    -29938.85955 3225.89265   111%     -   20s
H    0     0                    -28033.73093 3225.89265   112%     -   23s
H    0     0                    -27896.57084 3225.89265   112%     -   23s
     0     0 -2210.1785    0  666 -27896.571 -2210.1785  92.1%     -   48s
H    0     0                    -24746.05371 -2211.5769  91.1%     -   49s
H    0     0                    -24350.83126 -2211.5769  90.9%     -   50s
H    0     0                    -24341.20976 -2211.5769  90.9%     -   50s
H    0     0                    -24326.27837 -2211.5769  90.9%     -   50s
H    0     0                    -23910.88464 -2211.5769  90.8%     -   50s
H    0     0                    -23841.08151 -2211.5769  90.7%     -   50s
     0     0 -2583.4803    0  682 -23841.082 -2583.4803  89.2%     -   59s
     0     0 -2744.5935    0  706 -23841.082 -2744.5935  88.5%     -   63s
     0     0 -2913.5196    0  695 -23841.082 -2913.5196  87.8%     -   68s
     0     0 -2967.3017    0  710 -23841.082 -2967.3017  87.6%     -   70s
     0     0 -3168.9676    0  708 -23841.082 -3168.9676  86.7%     -   73s
     0     0 -3168.9676    0  706 -23841.082 -3168.9676  86.7%     -   74s
     0     0 -3212.3793    0  704 -23841.082 -3212.3793  86.5%     -   75s
     0     0 -3276.8245    0  698 -23841.082 -3276.8245  86.3%     -   77s
     0     0 -3279.5975    0  698 -23841.082 -3279.5975  86.2%     -   77s
     0     0 -3298.2308    0  669 -23841.082 -3298.2308  86.2%     -   79s
     0     0 -3298.3712    0  666 -23841.082 -3298.3712  86.2%     -   80s
     0     0 -3298.3712    0  689 -23841.082 -3298.3712  86.2%     -   80s
     0     0 -3298.3712    0  689 -23841.082 -3298.3712  86.2%     -   81s
     0     0 -7047.0997    0  699 -23841.082 -7047.0997  70.4%     -  126s
H    0     0                    -23812.36842 -7047.2893  70.4%     -  127s
H    0     0                    -23810.63974 -7047.2893  70.4%     -  127s
H    0     0                    -23809.64599 -7947.1509  66.6%     -  190s
H    0     0                    -23806.31892 -7947.1509  66.6%     -  190s
     0     0 -7947.1509    0  689 -23806.319 -7947.1509  66.6%     -  190s
H    0     0                    -23748.72447 -8077.5653  66.0%     -  210s
H    0     0                    -23665.98783 -8077.5653  65.9%     -  210s
H    0     0                    -23665.69971 -8077.5653  65.9%     -  210s
H    0     0                    -23656.60170 -8077.5653  65.9%     -  210s
H    0     0                    -23631.74341 -8077.5653  65.8%     -  210s
H    0     0                    -23630.87334 -8077.5653  65.8%     -  210s
H    0     0                    -23625.50708 -8077.5653  65.8%     -  210s
H    0     0                    -23612.15133 -8077.5653  65.8%     -  210s
H    0     0                    -23607.44628 -8077.5653  65.8%     -  210s
     0     0 -8077.5653    0  686 -23607.446 -8077.5653  65.8%     -  210s
     0     0 -8195.4429    0  691 -23607.446 -8195.4429  65.3%     -  229s
     0     0 -8274.4145    0  692 -23607.446 -8274.4145  64.9%     -  248s
     0     0 -8296.4843    0  689 -23607.446 -8296.4843  64.9%     -  261s
     0     0 -8306.0490    0  688 -23607.446 -8306.0490  64.8%     -  270s
     0     0 -8320.3436    0  688 -23607.446 -8320.3436  64.8%     -  274s
     0     0 -8353.0772    0  692 -23607.446 -8353.0772  64.6%     -  295s
     0     0 -8361.9102    0  681 -23607.446 -8361.9102  64.6%     -  302s
H    0     0                    -23592.56932 -8375.4935  64.5%     -  315s
     0     0 -8375.4935    0  691 -23592.569 -8375.4935  64.5%     -  315s
     0     0 -8379.2013    0  697 -23592.569 -8379.2013  64.5%     -  324s
     0     0 -8384.3143    0  693 -23592.569 -8384.3143  64.5%     -  332s
     0     0 -8385.1985    0  692 -23592.569 -8385.1985  64.5%     -  336s
H    0     0                    -23535.43775 -8385.1985  64.4%     -  348s
H    0     0                    -23534.09237 -8385.1985  64.4%     -  348s
     0     0 -11765.743    0  277 -23534.092 -11765.743  50.0%     -  461s
H    0     0                    -23533.66024 -11765.877  50.0%     -  463s
H    0     0                    -23532.48933 -11765.877  50.0%     -  463s
     0     0 -13305.738    0  575 -23532.489 -13305.738  43.5%     -  542s
     0     0 -13868.531    0  595 -23532.489 -13868.531  41.1%     -  605s
H    0     0                    -23532.45577 -14001.367  40.5%     -  630s
H    0     0                    -23503.75487 -14001.367  40.4%     -  630s
     0     0 -14001.367    0  696 -23503.755 -14001.367  40.4%     -  630s
     0     0 -14270.108    0  619 -23503.755 -14270.108  39.3%     -  657s
     0     0 -14305.907    0  709 -23503.755 -14305.907  39.1%     -  673s
     0     0 -14313.264    0  633 -23503.755 -14313.264  39.1%     -  679s
     0     0 -14314.213    0  634 -23503.755 -14314.213  39.1%     -  682s
H    0     0                    -23501.78374 -14314.213  39.1%     -  701s
H    0     0                    -23495.90659 -14314.213  39.1%     -  701s
     0     0 -15497.231    0  572 -23495.907 -15497.231  34.0%     -  783s
H    0     0                    -23493.50213 -16099.379  31.5%     -  812s
     0     0 -16099.379    0  593 -23493.502 -16099.379  31.5%     -  812s
     0     0 -16233.848    0  590 -23493.502 -16233.848  30.9%     -  831s
     0     0 -16261.336    0  600 -23493.502 -16261.336  30.8%     -  839s
     0     0 -16277.869    0  602 -23493.502 -16277.869  30.7%     -  847s
     0     0 -16302.267    0  601 -23493.502 -16302.267  30.6%     -  854s
     0     0 -16304.102    0  604 -23493.502 -16304.102  30.6%     -  857s
     0     0 -16605.567    0  483 -23493.502 -16605.567  29.3%     -  885s
     0     0 -16647.167    0  569 -23493.502 -16647.167  29.1%     -  896s
     0     0 -16679.525    0  589 -23493.502 -16679.525  29.0%     -  904s
     0     0 -16687.985    0  584 -23493.502 -16687.985  29.0%     -  909s
     0     0 -16688.541    0  589 -23493.502 -16688.541  29.0%     -  911s
     0     0 -16812.414    0  599 -23493.502 -16812.414  28.4%     -  950s
     0     0 -16823.428    0  597 -23493.502 -16823.428  28.4%     -  961s
     0     0 -16841.381    0  598 -23493.502 -16841.381  28.3%     -  967s
     0     0 -16848.321    0  603 -23493.502 -16848.321  28.3%     -  971s
     0     0 -16849.944    0  611 -23493.502 -16849.944  28.3%     -  973s
     0     0 -16899.662    0  592 -23493.502 -16899.662  28.1%     -  986s
     0     0 -16921.269    0  600 -23493.502 -16921.269  28.0%     -  993s
     0     0 -16926.127    0  600 -23493.502 -16926.127  28.0%     -  998s
     0     0 -16927.481    0  599 -23493.502 -16927.481  27.9%     - 1000s
     0     0 -16979.768    0  600 -23493.502 -16979.768  27.7%     - 1014s
     0     0 -16993.882    0  519 -23493.502 -16993.882  27.7%     - 1021s
     0     0 -16996.018    0  598 -23493.502 -16996.018  27.7%     - 1025s
     0     0 -17025.911    0  519 -23493.502 -17025.911  27.5%     - 1035s
     0     0 -17030.026    0  522 -23493.502 -17030.026  27.5%     - 1041s
     0     0 -17031.067    0  618 -23493.502 -17031.067  27.5%     - 1044s
     0     0 -17046.494    0  610 -23493.502 -17046.494  27.4%     - 1055s
H    0     0                    -23492.08296 -17046.696  27.4%     - 1060s
H    0     0                    -23490.53832 -17046.696  27.4%     - 1060s
H    0     0                    -23489.77295 -17046.696  27.4%     - 1060s
     0     0 -17049.426    0  608 -23489.773 -17049.426  27.4%     - 1064s
     0     0 -17068.372    0  527 -23489.773 -17068.372  27.3%     - 1072s
     0     0 -17068.372    0  527 -23489.773 -17068.372  27.3%     - 1072s
     0     0 -17068.492    0  527 -23489.773 -17068.492  27.3%     - 1081s
     0     2 -17068.500    0  527 -23489.773 -17068.500  27.3%     - 1192s
     1     3 -17845.226    1  467 -23489.773 -17068.500  27.3% 16182 1214s
     2     6 -17926.487    2  368 -23489.773 -17068.500  27.3%  9979 1227s
     5     9 -18012.916    2  346 -23489.773 -17267.724  26.5% 11592 1260s
     8    16 -18234.943    3  291 -23489.773 -17267.724  26.5% 12239 1276s
    17    23 -18764.275    4  283 -23489.773 -17467.191  25.6% 11824 1344s
    24    41 -20166.198    5  260 -23489.773 -17467.191  25.6% 12331 1478s
    44    67 -20320.649    6  252 -23489.773 -17467.191  25.6% 34803 1517s
    76   139 -20559.494    7  253 -23489.773 -17467.191  25.6% 23332 1565s
   152   241 -20703.558    9  221 -23489.773 -17467.191  25.6% 13717 1603s
   264   325 -20900.489   11  228 -23489.773 -17467.191  25.6%  9081 1629s
   362   355 -21255.850   15  213 -23489.773 -17467.191  25.6%  7237 1647s
   396   378 -21348.267   14  203 -23489.773 -17467.191  25.6%  6851 1671s
   437   389 -21847.279   16  201 -23489.773 -17467.191  25.6%  6515 1694s
   484   419 -23168.867   16  195 -23489.773 -17467.191  25.6%  6216 1717s
H  508   419                    -23481.40044 -17467.191  25.6%  6091 1717s
   522   444 -22356.299   15  208 -23481.400 -17467.191  25.6%  6062 1741s
   573   462     cutoff   17      -23481.400 -17467.191  25.6%  5853 1766s
   645   486 infeasible   18      -23481.400 -17467.191  25.6%  5542 1796s
   731   506     cutoff   16      -23481.400 -17467.191  25.6%  5171 1820s
   789   543 -20992.319   16  382 -23481.400 -17467.191  25.6%  5009 1843s
   854   591 -21529.760   18  436 -23481.400 -17467.191  25.6%  4867 1866s
   936   624 -21847.314   20  348 -23481.400 -17467.191  25.6%  4650 1889s
  1020   672 -22077.273   23  408 -23481.400 -17467.191  25.6%  4405 1914s
  1123   724 -22323.198   26  408 -23481.400 -17467.191  25.6%  4180 1940s
  1239   749 -22356.087   27  315 -23481.400 -17467.191  25.6%  3992 1968s
  1347   810     cutoff   29      -23481.400 -17467.191  25.6%  3834 1996s
  1463   860     cutoff   14      -23481.400 -17467.191  25.6%  3701 2021s
  1598   894 -22027.336   15  363 -23481.400 -17467.191  25.6%  3543 2045s
  1684   956 -22579.748   16  232 -23481.400 -17467.191  25.6%  3477 2071s
  1837   976     cutoff   17      -23481.400 -17467.191  25.6%  3328 2104s
  1981  1014 -22161.157   16  227 -23481.400 -17467.191  25.6%  3253 2137s
  2077  1043 -21965.301   30  360 -23481.400 -17467.191  25.6%  3252 2172s
  2188  1104 -22057.567   34  290 -23481.400 -17467.191  25.6%  3228 2210s
  2291  1148 -22897.738   38  220 -23481.400 -17467.191  25.6%  3216 2247s
  2415  1195 -20755.883   12  337 -23481.400 -17467.191  25.6%  3176 2286s
  2558  1232     cutoff   14      -23481.400 -17467.191  25.6%  3114 2322s
  2681  1315 -20927.206   19  398 -23481.400 -17467.191  25.6%  3099 2361s
  2822  1380 -21395.837   22  391 -23481.400 -17467.191  25.6%  3092 2402s
  2973  1472 -21766.214   25  353 -23481.400 -17467.191  25.6%  3070 2442s
  3177  1492 -22162.475   32  205 -23481.400 -17725.269  24.5%  2993 2479s
  3219  1521 -22242.022   33  192 -23481.400 -17725.269  24.5%  3006 2518s
  3278  1580 -22463.191   34  216 -23481.400 -17725.269  24.5%  3008 2557s
  3388  1623     cutoff   45      -23481.400 -17725.269  24.5%  2995 2606s
  3499  1688     cutoff   16      -23481.400 -17725.269  24.5%  2998 2652s
  3620  1781 -21458.238   23  324 -23481.400 -17725.269  24.5%  3014 2705s
  3811  1839 -21790.883   27  342 -23481.400 -17725.269  24.5%  2997 2758s
  4007  1917 -22097.443   33  423 -23481.400 -17725.269  24.5%  2973 2821s
  4143  1997 -22503.218   38  312 -23481.400 -17725.269  24.5%  2979 2880s
  4341  2097 -21120.102    8  242 -23481.400 -17725.269  24.5%  2973 2941s
  4571  2194 infeasible   11      -23481.400 -18602.309  20.8%  2973 3007s
  4782  2195 -22545.278   20  527 -23481.400 -18602.309  20.8%  2976 3289s
  4784  2196 -22789.544   47  489 -23481.400 -18602.309  20.8%  2975 3309s
  4785  2197 -23164.471   18  513 -23481.400 -18602.309  20.8%  2974 3406s
  4786  2198 -21716.864   28  583 -23481.400 -18602.309  20.8%  2974 3524s
  4787  2198 -20235.001    8  577 -23481.400 -18602.309  20.8%  2973 3577s

Cutting planes:
  Gomory: 1
  Implied bound: 30
  Projected implied bound: 596
  MIR: 1259
  Mixing: 3
  Flow cover: 1005
  Zero half: 6
  RLT: 83
  Relax-and-lift: 327

Explored 4787 nodes (15191121 simplex iterations) in 3600.05 seconds (5031.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23481.4 -23489.8 -23490.5 ... -23532.5

Time limit reached
Best objective -2.348140043958e+04, best bound -1.860230890602e+04, gap 20.7785%
  WARNING: Time limit reached. Using best solution found (gap: 20.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -23481.40, θ = 95262.69
  Upper Bound (UB) = -23481.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95262.69
  [DEBUG]   ✓ Scenario 0: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 95262.69 ≤ Q = 95262.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 95262.69 ≤ Q = 95262.69 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x79ca33a0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x79ca33a0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7738238.0799
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.103235e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110323.52    0  121 7738238.08 -110323.52   101%     -    0s
H    0     0                    -77503.26935 -110323.52  42.3%     -    0s
H    0     0                    -77999.74631 -110323.52  41.4%     -    0s
     0     0 -83567.282    0  133 -77999.746 -83567.282  7.14%     -    0s
H    0     0                    -79798.50764 -83531.909  4.68%     -    0s
     0     0 -83307.628    0  132 -79798.508 -83307.628  4.40%     -    0s
H    0     0                    -80357.09311 -83093.241  3.40%     -    0s
     0     0 -83093.241    0  133 -80357.093 -83093.241  3.40%     -    0s
     0     0 -83069.413    0  133 -80357.093 -83069.413  3.38%     -    0s
     0     0 -82818.426    0  132 -80357.093 -82818.426  3.06%     -    0s
     0     0 -82797.705    0  134 -80357.093 -82797.705  3.04%     -    0s
     0     0 -82788.041    0  135 -80357.093 -82788.041  3.03%     -    0s
     0     0 -82633.945    0  135 -80357.093 -82633.945  2.83%     -    0s
     0     0 -82600.247    0  135 -80357.093 -82600.247  2.79%     -    0s
     0     2 -82600.247    0  135 -80357.093 -82600.247  2.79%     -    0s
H   36    64                    -81118.16134 -82172.164  1.30%  15.5    0s
H   41    63                    -81186.36338 -82172.164  1.21%  14.5    0s
H   54    56                    -81312.45588 -82063.048  0.92%  13.3    0s
H  401   141                    -81388.62940 -81935.884  0.67%   8.6    0s
*  765   162              28    -81393.86663 -81822.568  0.53%   8.0    0s
*  821   162              26    -81394.06429 -81807.873  0.51%   7.9    0s
*  825   162              27    -81416.52102 -81807.873  0.48%   7.9    0s
* 1032   130              27    -81421.48598 -81807.873  0.47%   7.7    0s
* 1236    94              25    -81421.63251 -81807.873  0.47%   7.6    0s
* 1447    53              25    -81431.19377 -81807.873  0.46%   7.4    0s
* 1611     0              26    -81432.50823 -81451.393  0.02%   7.1    0s

Cutting planes:
  Gomory: 62
  MIR: 276
  RLT: 2

Explored 1620 nodes (11989 simplex iterations) in 0.47 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -81432.5 -81431.2 -81421.6 ... -81186.4
No other solutions better than -81432.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.143250822536e+04, best bound -8.143250822536e+04, gap 0.0000%
  Subproblem solved in 0.51s
  Worst-case operational profit (Z_SP) = 94197.74
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81432.51
  [DEBUG]   S×d_nominal = 175630.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175630.25 + -81432.51 = 94197.74
  [DEBUG]   Current θ from Master = 95262.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1064.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24546.35
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 588.7953, Absolute Gap = 588.7953, Relative Gap = 0.025075
  Not converged yet (gap = 588.80 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610711 nonzeros
Model fingerprint: 0xa6998818
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100654 rows and 40884 columns
Presolve time: 4.86s
Presolved: 114789 rows, 48736 columns, 692937 nonzeros
Variable types: 46477 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407701.6748
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.45s

Barrier statistics:
 Dense cols : 651
 AA' NZ     : 4.138e+06
 Factor NZ  : 1.011e+07 (roughly 150 MB of memory)
 Factor Ops : 2.098e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.16183319e+07  2.13555719e+08  3.48e+05 2.00e+01  1.28e+05     8s
   1  -3.68103183e+07  2.18440692e+08  2.99e+05 7.18e+01  1.08e+05     8s
   2  -1.61136689e+07  1.52029071e+08  1.22e+05 1.46e+01  4.60e+04     8s
   3  -7.98687347e+06  1.26100264e+08  5.98e+04 1.13e+00  2.28e+04     9s
   4  -1.42168297e+06  1.18515280e+08  6.97e+03 9.44e+00  3.15e+03     9s
   5  -6.67063384e+05  7.38865412e+07  1.16e+03 3.75e+00  7.60e+02     9s
   6  -5.54988011e+05  3.11177534e+07  5.33e+02 1.07e+00  3.12e+02     9s
   7  -4.57610766e+05  2.15106012e+07  2.72e+02 4.72e-01  1.81e+02     9s
   8  -3.18787872e+05  1.47879899e+07  1.02e+02 4.57e-02  9.76e+01     9s
   9  -2.05447110e+05  9.41202039e+06  3.96e+01 2.68e-02  5.38e+01     9s
  10  -1.56574754e+05  5.69474674e+06  2.42e+01 1.53e-02  3.14e+01     9s
  11  -1.27195928e+05  4.17443909e+06  1.57e+01 1.09e-02  2.23e+01     9s
  12  -1.07879138e+05  2.97107807e+06  1.05e+01 7.62e-03  1.56e+01     9s
  13  -7.32986376e+04  1.86558480e+06  4.29e+00 4.66e-03  9.48e+00     9s
  14  -4.41291860e+04  5.75217895e+05  1.75e+00 1.45e-03  2.99e+00    10s
  15  -3.67650222e+04  3.45229231e+05  1.19e+00 8.43e-04  1.84e+00    10s
  16  -2.84476321e+04  1.38482166e+05  7.34e-01 4.87e-04  8.00e-01    10s
  17  -2.46306864e+04  8.22826115e+04  5.70e-01 4.58e-04  5.12e-01    10s
  18  -1.95898916e+04  6.16057170e+04  4.04e-01 2.92e-04  3.88e-01    10s
  19  -1.57955537e+04  3.94940739e+04  3.08e-01 6.12e-04  2.64e-01    10s
  20  -1.26379399e+04  2.80489254e+04  2.46e-01 1.80e-03  1.94e-01    10s
  21  -9.23379643e+03  2.36250865e+04  1.90e-01 3.08e-03  1.57e-01    10s
  22  -7.41591941e+03  1.69863943e+04  1.59e-01 4.95e-03  1.17e-01    10s
  23  -6.08815674e+03  1.40429854e+04  1.38e-01 4.95e-03  9.62e-02    10s
  24  -4.41797206e+03  1.21504606e+04  1.12e-01 4.39e-03  7.92e-02    11s
  25  -3.75426830e+03  1.08988389e+04  1.02e-01 3.60e-03  7.00e-02    11s
  26  -2.35301879e+03  8.97301810e+03  8.14e-02 3.18e-03  5.41e-02    11s
  27  -2.08407280e+03  8.43430904e+03  7.69e-02 2.98e-03  5.02e-02    11s
  28  -1.27361221e+03  7.60790060e+03  6.41e-02 2.64e-03  4.24e-02    11s
  29  -3.72367637e+02  7.30527611e+03  5.06e-02 2.50e-03  3.67e-02    11s
  30  -1.12027548e+02  6.42051484e+03  4.67e-02 2.35e-03  3.12e-02    11s
  31   3.93651135e+02  6.23310110e+03  3.91e-02 2.26e-03  2.79e-02    11s
  32   6.50127534e+02  5.95499931e+03  3.51e-02 2.06e-03  2.53e-02    11s
  33   8.16443243e+02  5.59853910e+03  3.24e-02 1.81e-03  2.28e-02    12s
  34   1.10940756e+03  5.20004857e+03  2.81e-02 1.52e-03  1.95e-02    12s
  35   1.64438878e+03  4.96619764e+03  2.03e-02 1.50e-03  1.59e-02    12s
  36   1.73259220e+03  4.60796560e+03  1.90e-02 1.18e-03  1.37e-02    12s
  37   1.98505596e+03  4.40699442e+03  1.56e-02 1.02e-03  1.16e-02    12s
  38   2.20883228e+03  4.23999670e+03  1.27e-02 8.81e-04  9.70e-03    12s
  39   2.37791598e+03  4.07358436e+03  1.05e-02 7.29e-04  8.09e-03    12s
  40   2.52046036e+03  4.01150975e+03  8.44e-03 6.79e-04  7.12e-03    12s
  41   2.64582799e+03  3.69795165e+03  6.80e-03 4.49e-04  5.02e-03    13s
  42   2.80827417e+03  3.62939174e+03  4.83e-03 3.82e-04  3.92e-03    13s
  43   2.89038883e+03  3.56655818e+03  3.78e-03 3.25e-04  3.23e-03    13s
  44   2.96431976e+03  3.49365859e+03  2.88e-03 2.57e-04  2.53e-03    13s
  45   3.04903121e+03  3.36861635e+03  1.90e-03 1.39e-04  1.53e-03    13s
  46   3.09334696e+03  3.32510545e+03  1.41e-03 9.52e-05  1.11e-03    13s
  47   3.15122819e+03  3.30373117e+03  7.81e-04 7.32e-05  7.28e-04    13s
  48   3.16858909e+03  3.27695991e+03  5.97e-04 4.48e-05  5.17e-04    13s
  49   3.17201818e+03  3.27515037e+03  5.59e-04 4.31e-05  4.92e-04    14s
  50   3.18680059e+03  3.26227520e+03  4.04e-04 3.09e-05  3.60e-04    14s
  51   3.19160512e+03  3.25832555e+03  3.57e-04 2.75e-05  3.18e-04    14s
  52   3.20231704e+03  3.25175413e+03  2.53e-04 2.12e-05  2.36e-04    14s
  53   3.20468087e+03  3.25058455e+03  2.29e-04 2.01e-05  2.19e-04    14s
  54   3.20641155e+03  3.24402471e+03  2.12e-04 1.44e-05  1.79e-04    14s
  55   3.21576150e+03  3.24051227e+03  1.17e-04 1.11e-05  1.18e-04    15s
  56   3.21663259e+03  3.23865762e+03  1.09e-04 9.44e-06  1.05e-04    15s
  57   3.21740966e+03  3.23604177e+03  1.01e-04 7.10e-06  8.89e-05    15s
  58   3.22001099e+03  3.23557068e+03  7.66e-05 6.64e-06  7.42e-05    15s
  59   3.22227858e+03  3.23346221e+03  5.52e-05 4.70e-06  5.34e-05    15s
  60   3.22360731e+03  3.23145796e+03  4.25e-05 2.89e-06  3.75e-05    15s
  61   3.22750658e+03  3.23002915e+03  4.54e-06 1.67e-06  1.20e-05    15s
  62   3.22751044e+03  3.22937365e+03  4.51e-06 1.11e-06  8.88e-06    16s
  63   3.22802122e+03  3.22842860e+03  1.06e-07 3.31e-07  1.94e-06    16s
  64   3.22804870e+03  3.22840260e+03  1.80e-08 3.08e-07  1.69e-06    16s
  65   3.22805195e+03  3.22838788e+03  1.52e-08 2.91e-07  1.60e-06    16s
  66   3.22805160e+03  3.22823532e+03  1.66e-08 1.58e-07  8.76e-07    16s
  67   3.22805229e+03  3.22806993e+03  1.12e-07 1.02e-08  8.39e-08    16s
  68   3.22805629e+03  3.22805629e+03  2.56e-10 1.20e-10  2.48e-11    16s

Barrier solved model in 68 iterations and 16.44 seconds (13.36 work units)
Optimal objective 3.22805629e+03


Root crossover log...

   87293 DPushes remaining with DInf 0.0000000e+00                17s
     506 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3529 PPushes remaining with PInf 2.0013462e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1784689e-01     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34019    3.2280563e+03   0.000000e+00   2.178469e-01     21s
   34020    3.2280563e+03   0.000000e+00   0.000000e+00     21s
   34020    3.2280563e+03   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 3.228056e+03, 34020 iterations, 14.70 seconds (16.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3228.05629    0  512 -222248.17 3228.05629   101%     -   22s
H    0     0                    -157769.3437 3228.05629   102%     -   22s
H    0     0                    -137215.6174 3228.05629   102%     -   23s
H    0     0                    -136827.9033 3228.05629   102%     -   23s
H    0     0                    -134903.3765 3228.05629   102%     -   24s
H    0     0                    -131636.3695 3228.05629   102%     -   24s
H    0     0                    -131550.1417 3228.05629   102%     -   24s
H    0     0                    -106976.8626 3228.05629   103%     -   24s
H    0     0                    -106645.5234 3228.05629   103%     -   25s
H    0     0                    -83849.24483 3228.05629   104%     -   25s
H    0     0                    -30467.42517 3228.05629   111%     -   25s
H    0     0                    -30431.79751 3228.05629   111%     -   25s
H    0     0                    -28371.40700 3228.05629   111%     -   29s
H    0     0                    -28259.98656 3228.05629   111%     -   29s
H    0     0                    -24241.88672 -3268.8283  86.5%     -   80s
H    0     0                    -24219.36835 -3268.8283  86.5%     -   80s
H    0     0                    -24109.06924 -3268.8283  86.4%     -   80s
H    0     0                    -23985.37708 -3268.8283  86.4%     -   80s
H    0     0                    -23937.96663 -3268.8283  86.3%     -   80s
     0     0 -3268.8283    0  773 -23937.967 -3268.8283  86.3%     -   81s
     0     0 -3476.0792    0  859 -23937.967 -3476.0792  85.5%     -   94s
     0     0 -3834.1459    0  864 -23937.967 -3834.1459  84.0%     -  104s
     0     0 -3966.4017    0  890 -23937.967 -3966.4017  83.4%     -  111s
     0     0 -4048.4210    0  878 -23937.967 -4048.4210  83.1%     -  124s
     0     0 -4075.4125    0  877 -23937.967 -4075.4125  83.0%     -  133s
H    0     0                    -23930.08401 -4114.4149  82.8%     -  137s
H    0     0                    -23859.15592 -4114.4149  82.8%     -  137s
H    0     0                    -23845.94130 -4114.4149  82.7%     -  137s
     0     0 -4114.4149    0  790 -23845.941 -4114.4149  82.7%     -  137s
     0     0 -4115.7195    0  871 -23845.941 -4115.7195  82.7%     -  139s
     0     0 -4118.5654    0  802 -23845.941 -4118.5654  82.7%     -  139s
     0     0 -4118.5663    0  873 -23845.941 -4118.5663  82.7%     -  140s
H    0     0                    -23835.28761 -8298.3681  65.2%     -  249s
H    0     0                    -23804.11028 -8298.3681  65.1%     -  249s
H    0     0                    -23785.37117 -8298.3681  65.1%     -  249s
H    0     0                    -23780.37765 -8298.3681  65.1%     -  249s
H    0     0                    -23778.90590 -8298.3681  65.1%     -  249s
H    0     0                    -23742.38755 -8298.3681  65.0%     -  249s
     0     0 -8298.3681    0  746 -23742.388 -8298.3681  65.0%     -  250s
H    0     0                    -23735.17806 -9794.8386  58.7%     -  394s
H    0     0                    -23730.93722 -9794.8386  58.7%     -  394s
H    0     0                    -23716.06037 -9794.8386  58.7%     -  394s
H    0     0                    -23711.13861 -9794.8386  58.7%     -  394s
H    0     0                    -23706.17249 -9794.8386  58.7%     -  394s
H    0     0                    -23698.70727 -9794.8386  58.7%     -  394s
H    0     0                    -23694.00557 -9794.8386  58.7%     -  394s
H    0     0                    -23691.58275 -9794.8386  58.7%     -  394s
H    0     0                    -23682.79725 -9794.8386  58.6%     -  394s
H    0     0                    -23627.61980 -9794.8386  58.5%     -  394s
     0     0 -9794.8386    0  857 -23627.620 -9794.8386  58.5%     -  394s
H    0     0                    -23611.32268 -10049.857  57.4%     -  449s
H    0     0                    -23603.26415 -10049.857  57.4%     -  449s
     0     0 -10049.857    0  803 -23603.264 -10049.857  57.4%     -  449s
     0     0 -10225.408    0  818 -23603.264 -10225.408  56.7%     -  484s
     0     0 -10283.154    0  820 -23603.264 -10283.154  56.4%     -  506s
     0     0 -10324.379    0  844 -23603.264 -10324.379  56.3%     -  533s
     0     0 -10345.038    0  815 -23603.264 -10345.038  56.2%     -  553s
     0     0 -10350.205    0  826 -23603.264 -10350.205  56.1%     -  564s
     0     0 -10418.725    0  830 -23603.264 -10418.725  55.9%     -  582s
     0     0 -10431.213    0  821 -23603.264 -10431.213  55.8%     -  590s
     0     0 -10439.598    0  823 -23603.264 -10439.598  55.8%     -  599s
     0     0 -10445.273    0  834 -23603.264 -10445.273  55.7%     -  604s
     0     0 -10460.020    0  835 -23603.264 -10460.020  55.7%     -  624s
     0     0 -10462.425    0  838 -23603.264 -10462.425  55.7%     -  630s
     0     0 -10464.274    0  844 -23603.264 -10464.274  55.7%     -  635s
     0     0 -10466.662    0  842 -23603.264 -10466.662  55.7%     -  641s
     0     0 -10472.893    0  838 -23603.264 -10472.893  55.6%     -  651s
     0     0 -10476.267    0  839 -23603.264 -10476.267  55.6%     -  656s
     0     0 -10477.360    0  839 -23603.264 -10477.360  55.6%     -  658s
H    0     0                    -23597.39016 -10477.360  55.6%     -  682s
H    0     0                    -23583.71549 -13116.745  44.4%     -  818s
H    0     0                    -23581.49674 -13116.745  44.4%     -  818s
H    0     0                    -23580.62103 -13116.745  44.4%     -  818s
     0     0 -13116.745    0  612 -23580.621 -13116.745  44.4%     -  818s
H    0     0                    -23577.22014 -14085.268  40.3%     -  913s
H    0     0                    -23571.03918 -14085.268  40.2%     -  913s
     0     0 -14085.268    0  616 -23571.039 -14085.268  40.2%     -  914s
H    0     0                    -23567.03790 -14232.607  39.6%     -  969s
H    0     0                    -23538.84898 -14232.607  39.5%     -  969s
H    0     0                    -23528.68320 -14232.607  39.5%     -  969s
     0     0 -14232.607    0  551 -23528.683 -14232.607  39.5%     -  969s
     0     0 -14332.078    0  608 -23528.683 -14332.078  39.1%     - 1007s
     0     0 -14367.595    0  618 -23528.683 -14367.595  38.9%     - 1030s
     0     0 -14379.846    0  622 -23528.683 -14379.846  38.9%     - 1042s
     0     0 -14384.962    0  612 -23528.683 -14384.962  38.9%     - 1048s
     0     0 -14385.518    0  613 -23528.683 -14385.518  38.9%     - 1050s
     0     0 -15734.659    0  590 -23528.683 -15734.659  33.1%     - 1162s
     0     0 -16169.757    0  615 -23528.683 -16169.757  31.3%     - 1219s
     0     0 -16317.129    0  621 -23528.683 -16317.129  30.7%     - 1244s
     0     0 -16363.273    0  624 -23528.683 -16363.273  30.5%     - 1258s
     0     0 -16383.785    0  626 -23528.683 -16383.785  30.4%     - 1271s
     0     0 -16399.671    0  616 -23528.683 -16399.671  30.3%     - 1284s
     0     0 -16409.733    0  616 -23528.683 -16409.733  30.3%     - 1290s
     0     0 -16419.235    0  605 -23528.683 -16419.235  30.2%     - 1299s
     0     0 -16428.940    0  618 -23528.683 -16428.940  30.2%     - 1306s
H    0     0                    -23526.23099 -16466.198  30.0%     - 1324s
     0     0 -16466.198    0  618 -23526.231 -16466.198  30.0%     - 1325s
     0     0 -16479.796    0  626 -23526.231 -16479.796  30.0%     - 1344s
     0     0 -16481.163    0  614 -23526.231 -16481.163  29.9%     - 1348s
     0     0 -16744.444    0  510 -23526.231 -16744.444  28.8%     - 1382s
     0     0 -16767.963    0  532 -23526.231 -16767.963  28.7%     - 1399s
     0     0 -16778.909    0  510 -23526.231 -16778.909  28.7%     - 1408s
     0     0 -16782.258    0  530 -23526.231 -16782.258  28.7%     - 1414s
     0     0 -16863.685    0  606 -23526.231 -16863.685  28.3%     - 1441s
     0     0 -16883.964    0  601 -23526.231 -16883.964  28.2%     - 1454s
     0     0 -16890.466    0  603 -23526.231 -16890.466  28.2%     - 1465s
     0     0 -16915.177    0  610 -23526.231 -16915.177  28.1%     - 1476s
     0     0 -16921.608    0  607 -23526.231 -16921.608  28.1%     - 1484s
     0     0 -16922.291    0  602 -23526.231 -16922.291  28.1%     - 1486s
     0     0 -16975.686    0  593 -23526.231 -16975.686  27.8%     - 1513s
     0     0 -16985.648    0  604 -23526.231 -16985.648  27.8%     - 1523s
     0     0 -16987.590    0  601 -23526.231 -16987.590  27.8%     - 1529s
     0     0 -17014.751    0  713 -23526.231 -17014.751  27.7%     - 1555s
     0     0 -17023.157    0  612 -23526.231 -17023.157  27.6%     - 1571s
     0     0 -17025.807    0  607 -23526.231 -17025.807  27.6%     - 1579s
     0     0 -17094.237    0  704 -23526.231 -17094.237  27.3%     - 1609s
     0     0 -17101.050    0  600 -23526.231 -17101.050  27.3%     - 1625s
     0     0 -17124.632    0  633 -23526.231 -17124.632  27.2%     - 1642s
     0     0 -17127.013    0  534 -23526.231 -17127.013  27.2%     - 1665s
     0     0 -17153.145    0  627 -23526.231 -17153.145  27.1%     - 1694s
     0     0 -17157.661    0  664 -23526.231 -17157.661  27.1%     - 1709s
     0     0 -17159.698    0  652 -23526.231 -17159.698  27.1%     - 1714s
     0     0 -17169.887    0  537 -23526.231 -17169.887  27.0%     - 1730s
     0     0 -17173.209    0  604 -23526.231 -17173.209  27.0%     - 1741s
     0     0 -17185.061    0  524 -23526.231 -17185.061  27.0%     - 1763s
     0     0 -17188.137    0  609 -23526.231 -17188.137  26.9%     - 1774s
     0     0 -17197.591    0  615 -23526.231 -17197.591  26.9%     - 1796s
     0     0 -17197.628    0  615 -23526.231 -17197.628  26.9%     - 1809s
H    0     0                    -23522.88060 -17197.661  26.9%     - 2033s
H    0     0                    -23511.86367 -17197.661  26.9%     - 2033s
     0     2 -17197.661    0  615 -23511.864 -17197.661  26.9%     - 2037s
     1     3 -18050.401    1  377 -23511.864 -17197.661  26.9% 25013 2088s
     2     6 -18092.289    2  246 -23511.864 -17197.661  26.9% 13270 2098s
     5     9 -18386.908    2  382 -23511.864 -17245.187  26.7% 13671 2159s
     8    18 -18471.413    3  382 -23511.864 -17245.187  26.7% 15705 2192s
    17    32 -20294.298    5  304 -23511.864 -17420.055  25.9% 13631 2248s
    31    44 -20356.743    5  283 -23511.864 -17507.799  25.5% 18969 2392s
    45    67 -20476.000    5  298 -23511.864 -17507.799  25.5% 18344 2472s
H   52    67                    -23499.78286 -17507.799  25.5% 17517 2472s
    68   130 -18980.655    6  386 -23499.783 -17507.799  25.5% 16168 2548s
   155   162     cutoff   10      -23499.783 -17507.799  25.5% 10117 2599s
   191   208 -19038.281    9  348 -23499.783 -17507.799  25.5% 10431 2648s
H  218   208                    -23488.74184 -17507.799  25.5%  9877 2649s
   259   256 -19184.893    8  377 -23488.742 -17507.799  25.5%  9660 2690s
H  286   256                    -23486.15051 -17507.799  25.5%  9167 2690s
   350   280 infeasible    8      -23486.151 -17507.799  25.5%  8855 2722s
   430   279 infeasible   16      -23486.151 -17507.799  25.5%  8321 2755s
   477   282 infeasible   19      -23486.151 -17507.799  25.5%  8091 2795s
   512   297 -19365.287    6  295 -23486.151 -17507.799  25.5%  8095 2834s
   557   318 -19475.320    7  273 -23486.151 -17507.799  25.5%  8019 2868s
   626   345 -19608.520    8  270 -23486.151 -17507.799  25.5%  7822 2903s
   692   371 -19849.289    9  271 -23486.151 -17507.799  25.5%  7672 2934s
   764   401 -20472.092   13  267 -23486.151 -17507.799  25.5%  7585 2963s
   833   434 -20839.860   15  329 -23486.151 -17507.799  25.5%  7429 2992s
   920   482 -21927.946   19  260 -23486.151 -17507.799  25.5%  7261 3023s
   998   510 -22202.689   21  315 -23486.151 -17507.799  25.5%  7208 3054s
  1068   569 -22514.799   23  246 -23486.151 -17508.096  25.5%  7152 3089s
  1171   618 -23081.826   28  238 -23486.151 -17508.096  25.5%  6981 3121s
  1260   649     cutoff   29      -23486.151 -17508.096  25.5%  6959 3156s
  1350   699 infeasible   28      -23486.151 -17636.161  24.9%  6901 3192s
  1432   760 -18978.690    5  271 -23486.151 -17636.161  24.9%  6898 3230s
  1549   872 -19454.968    8  257 -23486.151 -17636.161  24.9%  6850 3270s
  1693   936 -20120.310   10  375 -23486.151 -17828.896  24.1%  6758 3305s
  1837  1049 -20259.776   12  363 -23486.151 -17828.896  24.1%  6640 3343s
  2002  1135 -20669.863   15  289 -23486.151 -17828.896  24.1%  6501 3382s
  2146  1217 infeasible   16      -23486.151 -17949.849  23.6%  6394 3420s
  2340  1271 infeasible   17      -23486.151 -17949.849  23.6%  6245 3460s
  2477  1379 infeasible   17      -23486.151 -17949.849  23.6%  6258 3504s
  2623  1498 -21905.227   29  121 -23486.151 -17949.849  23.6%  6255 3544s
  2816  1526 -23121.088   36   76 -23486.151 -17949.849  23.6%  6167 3595s
  2974  1527 infeasible   37      -23486.151 -17949.849  23.6%  6093 3600s

Cutting planes:
  Gomory: 7
  Implied bound: 476
  MIR: 5582
  Flow cover: 4568
  Zero half: 5
  RLT: 282
  Relax-and-lift: 2202

Explored 2995 nodes (19133939 simplex iterations) in 3600.07 seconds (5123.75 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23486.2 -23488.7 -23499.8 ... -23571

Time limit reached
Best objective -2.348615051073e+04, best bound -1.794984879596e+04, gap 23.5726%
  WARNING: Time limit reached. Using best solution found (gap: 23.57%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -23486.15, θ = 95347.08
  Upper Bound (UB) = -23486.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95347.08
  [DEBUG]   ✓ Scenario 0: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 95347.08 ≤ Q = 95347.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 95347.08 ≤ Q = 95347.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 95347.08 ≤ Q = 95347.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 95347.08 ≤ Q = 95347.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 95347.08 ≤ Q = 95347.08 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x77c6a5cb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x88395a35
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461711e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7733639.5714
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.099919e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -109991.94    0  121 7733639.57 -109991.94   101%     -    0s
H    0     0                    -77193.37225 -109991.94  42.5%     -    0s
H    0     0                    -77596.07542 -109991.94  41.7%     -    0s
     0     0 -85855.356    0   56 -77596.075 -85855.356  10.6%     -    0s
H    0     0                    -82727.88410 -85830.842  3.75%     -    0s
H    0     0                    -83117.85144 -85830.842  3.26%     -    0s
H    0     0                    -83685.87969 -85830.842  2.56%     -    0s
H    0     0                    -84075.84702 -85830.842  2.09%     -    0s
     0     0 -85373.839    0   55 -84075.847 -85373.839  1.54%     -    0s
     0     0 -85340.969    0   53 -84075.847 -85340.969  1.50%     -    0s
H    0     0                    -84329.85498 -85340.969  1.20%     -    0s
     0     0 -84843.073    0   48 -84329.855 -84843.073  0.61%     -    0s
     0     0 -84774.828    0   48 -84329.855 -84774.828  0.53%     -    0s
     0     0 -84772.815    0   48 -84329.855 -84772.815  0.53%     -    0s
     0     0 -84536.098    0   17 -84329.855 -84536.098  0.24%     -    0s
     0     0 -84534.905    0   13 -84329.855 -84534.905  0.24%     -    0s
     0     0 -84459.190    0   15 -84329.855 -84459.190  0.15%     -    0s
     0     0 -84451.460    0   15 -84329.855 -84451.460  0.14%     -    0s
     0     0 -84406.903    0    7 -84329.855 -84406.903  0.09%     -    0s
     0     0 -84406.903    0   14 -84329.855 -84406.903  0.09%     -    0s
     0     0 -84372.211    0    9 -84329.855 -84372.211  0.05%     -    0s
     0     0 -84371.673    0    8 -84329.855 -84371.673  0.05%     -    0s
H    0     0                    -84358.06081 -84363.956  0.01%     -    0s
     0     0 -84363.956    0    4 -84358.061 -84363.956  0.01%     -    0s
     0     0 -84363.240    0    2 -84358.061 -84363.240  0.01%     -    0s
     0     0 -84358.653    0    2 -84358.061 -84358.653  0.00%     -    0s

Cutting planes:
  MIR: 5
  Flow cover: 4
  Relax-and-lift: 5

Explored 1 nodes (729 simplex iterations) in 0.16 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -84358.1 -84329.9 -84270.4 ... 1.46171e+13
No other solutions better than -84358.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.435806080760e+04, best bound -8.435806080760e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 90917.53
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84358.06
  [DEBUG]   S×d_nominal = 175275.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175275.59 + -84358.06 = 90917.53
  [DEBUG]   Current θ from Master = 95347.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4429.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27915.70
  Lower Bound (LB) = -24070.20
  Gap (UB-LB) = 584.0452, Absolute Gap = 584.0452, Relative Gap = 0.024868
  Not converged yet (gap = 584.05 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653939 nonzeros
Model fingerprint: 0xd40bacdf
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 107845 rows and 43805 columns (presolve time = 5s)...
Presolve removed 107845 rows and 43805 columns
Presolve time: 5.23s
Presolved: 122888 rows, 52055 columns, 757252 nonzeros
Variable types: 49796 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407399.0337
Found heuristic solution: objective -222248.1660

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.48s

Barrier statistics:
 Dense cols : 680
 AA' NZ     : 5.087e+06
 Factor NZ  : 1.172e+07 (roughly 170 MB of memory)
 Factor Ops : 2.620e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.11936762e+07  2.21627182e+08  3.48e+05 2.08e+01  1.26e+05     8s
   1  -3.64488113e+07  2.25332645e+08  2.98e+05 6.30e+01  1.07e+05     8s
   2  -1.12099087e+07  1.44708158e+08  8.99e+04 2.31e+00  3.40e+04     8s
   3  -6.96439105e+06  1.44775486e+08  5.43e+04 2.24e+00  2.08e+04     8s
   4  -1.20657707e+06  9.01050784e+07  4.47e+03 1.77e+00  2.02e+03     8s
   5  -7.53539281e+05  4.06699636e+07  1.10e+03 4.21e-01  5.39e+02     8s
   6  -5.83492570e+05  2.22200304e+07  4.80e+02 1.94e-01  2.42e+02     8s
   7  -3.32428555e+05  1.53612143e+07  1.66e+02 1.18e-01  1.15e+02     8s
   8  -1.96826650e+05  1.05071279e+07  6.62e+01 7.44e-02  6.29e+01     9s
   9  -1.48299138e+05  5.48985014e+06  3.51e+01 3.38e-02  3.08e+01     9s
  10  -1.25425984e+05  3.40240649e+06  2.02e+01 1.94e-02  1.80e+01     9s
  11  -9.13805730e+04  2.42696373e+06  5.09e+00 1.36e-02  1.17e+01     9s
  12  -7.72250458e+04  9.12841981e+05  2.61e+00 5.08e-03  4.50e+00     9s
  13  -6.18240903e+04  4.12269058e+05  1.31e+00 2.51e-03  2.14e+00     9s
  14  -4.52784153e+04  2.04411553e+05  7.02e-01 1.26e-03  1.12e+00     9s
  15  -4.00329754e+04  1.43980777e+05  5.76e-01 1.10e-03  8.25e-01     9s
  16  -3.49958739e+04  8.34175093e+04  4.73e-01 1.79e-03  5.31e-01     9s
  17  -3.09639287e+04  7.05012251e+04  4.02e-01 1.50e-03  4.55e-01    10s
  18  -2.60935476e+04  6.20035363e+04  3.18e-01 1.51e-03  3.95e-01    10s
  19  -2.24589575e+04  3.64832675e+04  2.59e-01 1.95e-03  2.64e-01    10s
  20  -2.19732146e+04  3.03150417e+04  2.52e-01 2.03e-03  2.34e-01    10s
  21  -1.85799469e+04  2.58319440e+04  2.05e-01 2.65e-03  1.99e-01    10s
  22  -1.65576688e+04  2.06064268e+04  1.74e-01 2.26e-03  1.67e-01    10s
  23  -1.47653481e+04  1.44173055e+04  1.49e-01 1.81e-03  1.31e-01    10s
  24  -1.36390462e+04  1.02449544e+04  1.32e-01 1.88e-03  1.07e-01    10s
  25  -1.15285491e+04  7.04988707e+03  1.04e-01 1.69e-03  8.33e-02    10s
  26  -1.07109618e+04  3.38458751e+03  9.36e-02 1.35e-03  6.33e-02    11s
  27  -9.95786242e+03  2.77164657e+03  8.44e-02 1.16e-03  5.71e-02    11s
  28  -8.64832721e+03  1.17013591e+03  6.91e-02 1.42e-03  4.41e-02    11s
  29  -7.60170279e+03  4.81375053e+02  5.73e-02 1.72e-03  3.63e-02    11s
  30  -6.75211615e+03  2.70916912e+02  4.79e-02 1.66e-03  3.15e-02    11s
  31  -6.02331044e+03 -9.52245479e+01  3.97e-02 1.16e-03  2.66e-02    11s
  32  -5.86265774e+03 -2.69080428e+02  3.79e-02 1.13e-03  2.51e-02    11s
  33  -5.40515416e+03 -7.81391512e+02  3.30e-02 9.86e-04  2.08e-02    11s
  34  -4.99370892e+03 -1.07680880e+03  2.86e-02 7.95e-04  1.76e-02    11s
  35  -4.76496064e+03 -1.14540197e+03  2.62e-02 7.48e-04  1.63e-02    12s
  36  -4.60410776e+03 -1.38285993e+03  2.45e-02 5.77e-04  1.45e-02    12s
  37  -3.96515634e+03 -1.57708977e+03  1.78e-02 3.60e-04  1.07e-02    12s
  38  -3.61008996e+03 -1.64289131e+03  1.40e-02 3.19e-04  8.83e-03    12s
  39  -3.46705844e+03 -1.91017442e+03  1.25e-02 1.64e-04  7.00e-03    12s
  40  -3.35415164e+03 -1.99777308e+03  1.14e-02 1.10e-04  6.10e-03    12s
  41  -3.07798743e+03 -2.05571699e+03  8.82e-03 7.47e-05  4.60e-03    12s
  42  -2.85066590e+03 -2.09736360e+03  6.52e-03 1.82e-04  3.39e-03    13s
  43  -2.66040222e+03 -2.10887337e+03  4.70e-03 1.61e-04  2.48e-03    13s
  44  -2.36500160e+03 -2.14642114e+03  1.69e-03 1.06e-04  9.82e-04    13s
  45  -2.31683267e+03 -2.15437174e+03  1.23e-03 8.75e-05  7.30e-04    13s
  46  -2.31140295e+03 -2.15714334e+03  1.18e-03 7.85e-05  6.93e-04    13s
  47  -2.25648555e+03 -2.16969115e+03  6.59e-04 3.27e-05  3.90e-04    13s
  48  -2.24538567e+03 -2.17745264e+03  5.61e-04 1.19e-05  3.06e-04    13s
  49  -2.21272981e+03 -2.17990265e+03  2.71e-04 4.88e-06  1.48e-04    13s
  50  -2.19284354e+03 -2.18056999e+03  9.23e-05 3.06e-06  5.51e-05    13s
  51  -2.18556641e+03 -2.18072811e+03  3.06e-05 2.71e-06  2.17e-05    14s
  52  -2.18377350e+03 -2.18160022e+03  1.52e-05 5.44e-07  9.76e-06    14s
  53  -2.18203485e+03 -2.18186531e+03  4.45e-07 9.78e-08  7.59e-07    14s
  54  -2.18199071e+03 -2.18187199e+03  1.55e-05 2.20e-07  5.31e-07    14s
  55  -2.18193809e+03 -2.18191096e+03  2.09e-06 4.29e-07  1.21e-07    14s
  56  -2.18193730e+03 -2.18192775e+03  2.03e-06 2.02e-08  4.25e-08    14s
  57  -2.18193626e+03 -2.18192775e+03  2.17e-06 1.77e-08  3.84e-08    14s
  58  -2.18192922e+03 -2.18192783e+03  1.98e-06 2.42e-07  6.73e-09    15s
  59  -2.18192785e+03 -2.18192783e+03  1.42e-07 1.15e-07  8.85e-11    15s

Barrier solved model in 59 iterations and 14.79 seconds (12.59 work units)
Optimal objective -2.18192785e+03


Root crossover log...

  104772 DPushes remaining with DInf 0.0000000e+00                15s
   53458 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3053 PPushes remaining with PInf 1.2559089e-05                20s
    1993 PPushes remaining with PInf 8.4031341e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1473238e+00     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52264   -2.1819278e+03   0.000000e+00   1.147324e+00     20s
   52271   -2.1819278e+03   0.000000e+00   0.000000e+00     20s
   52271   -2.1819278e+03   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -2.181928e+03, 52271 iterations, 14.04 seconds (18.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -2181.9278    0  332 -222248.17 -2181.9278  99.0%     -   21s
H    0     0                    -90478.55532 -2181.9278  97.6%     -   21s
H    0     0                    -90383.75587 -2181.9278  97.6%     -   21s
H    0     0                    -89038.30055 -2181.9278  97.5%     -   21s
H    0     0                    -88750.04464 -2181.9278  97.5%     -   22s
H    0     0                    -54538.09448 -2181.9278  96.0%     -   22s
H    0     0                    -54392.69575 -2181.9278  96.0%     -   22s
H    0     0                    -51455.85131 -2181.9278  95.8%     -   23s
H    0     0                    -47942.02287 -2181.9278  95.4%     -   26s
H    0     0                    -42744.38358 -2181.9278  94.9%     -   26s
H    0     0                    -42441.02612 -2181.9278  94.9%     -   26s
H    0     0                    -42441.00524 -2181.9278  94.9%     -   26s
H    0     0                    -42320.32038 -2181.9278  94.8%     -   26s
     0     0 -9417.8154    0  524 -42320.320 -9417.8154  77.7%     -   78s
H    0     0                    -42220.37568 -9417.8154  77.7%     -   79s
H    0     0                    -42197.40237 -9417.8154  77.7%     -   79s
H    0     0                    -42169.79752 -9417.8154  77.7%     -   79s
H    0     0                    -42143.90189 -9417.8154  77.7%     -   79s
H    0     0                    -42138.49986 -9417.8154  77.7%     -   80s
     0     0 -9596.8187    0  525 -42138.500 -9596.8187  77.2%     -   96s
     0     0 -9596.8187    0  527 -42138.500 -9596.8187  77.2%     -  100s
     0     0 -9596.8187    0  523 -42138.500 -9596.8187  77.2%     -  103s
     0     0 -9596.8187    0  547 -42138.500 -9596.8187  77.2%     -  107s
     0     0 -9596.8187    0  547 -42138.500 -9596.8187  77.2%     -  110s
     0     0 -13360.929    0  477 -42138.500 -13360.929  68.3%     -  158s
     0     0 -13924.856    0  496 -42138.500 -13924.856  67.0%     -  190s
H    0     0                    -36282.36540 -14024.712  61.3%     -  206s
H    0     0                    -36002.64937 -14024.712  61.0%     -  206s
H    0     0                    -35980.50311 -14024.712  61.0%     -  206s
H    0     0                    -35790.32858 -14024.712  60.8%     -  206s
H    0     0                    -35768.18232 -14024.712  60.8%     -  206s
H    0     0                    -35722.16027 -14024.712  60.7%     -  206s
H    0     0                    -35700.01401 -14024.712  60.7%     -  206s
H    0     0                    -35668.14036 -14024.712  60.7%     -  206s
H    0     0                    -35645.99410 -14024.712  60.7%     -  206s
H    0     0                    -35619.00161 -14024.712  60.6%     -  206s
H    0     0                    -35596.85534 -14024.712  60.6%     -  206s
H    0     0                    -35575.09758 -14024.712  60.6%     -  206s
H    0     0                    -29163.67237 -14024.712  51.9%     -  206s
H    0     0                    -28696.55014 -14024.712  51.1%     -  206s
H    0     0                    -28667.57681 -14024.712  51.1%     -  206s
H    0     0                    -28547.70252 -14024.712  50.9%     -  206s
     0     0 -14024.712    0  556 -28547.703 -14024.712  50.9%     -  206s
     0     0 -14094.213    0  559 -28547.703 -14094.213  50.6%     -  218s
     0     0 -14129.000    0  553 -28547.703 -14129.000  50.5%     -  225s
     0     0 -14134.307    0  556 -28547.703 -14134.307  50.5%     -  229s
     0     0 -14195.095    0  549 -28547.703 -14195.095  50.3%     -  234s
     0     0 -14206.443    0  558 -28547.703 -14206.443  50.2%     -  238s
H    0     0                    -27881.78741 -14213.508  49.0%     -  244s
H    0     0                    -27706.14875 -14213.508  48.7%     -  244s
H    0     0                    -27667.81100 -14213.508  48.6%     -  244s
H    0     0                    -27663.98131 -14213.508  48.6%     -  244s
H    0     0                    -27663.10776 -14213.508  48.6%     -  244s
H    0     0                    -27654.65773 -14213.508  48.6%     -  244s
H    0     0                    -27642.08735 -14213.508  48.6%     -  244s
H    0     0                    -27613.22414 -14213.508  48.5%     -  244s
H    0     0                    -27604.77411 -14213.508  48.5%     -  244s
H    0     0                    -27555.58696 -14213.508  48.4%     -  244s
H    0     0                    -27542.58802 -14213.508  48.4%     -  244s
H    0     0                    -27523.63431 -14213.508  48.4%     -  244s
     0     0 -14213.508    0  560 -27523.634 -14213.508  48.4%     -  244s
     0     0 -14216.084    0  563 -27523.634 -14216.084  48.3%     -  247s
     0     0 -14223.553    0  560 -27523.634 -14223.553  48.3%     -  249s
H    0     0                    -27514.41373 -14231.005  48.3%     -  252s
H    0     0                    -27481.68583 -14231.005  48.2%     -  252s
     0     0 -14231.005    0  568 -27481.686 -14231.005  48.2%     -  252s
     0     0 -14231.384    0  568 -27481.686 -14231.384  48.2%     -  255s
     0     0 -15698.979    0  568 -27481.686 -15698.979  42.9%     -  299s
H    0     0                    -27462.00886 -15699.479  42.8%     -  300s
H    0     0                    -27372.72244 -15699.479  42.6%     -  300s
H    0     0                    -27364.41089 -15699.479  42.6%     -  300s
H    0     0                    -27355.47655 -15699.479  42.6%     -  300s
     0     0 -16184.592    0  564 -27355.477 -16184.592  40.8%     -  321s
     0     0 -16309.864    0  588 -27355.477 -16309.864  40.4%     -  338s
     0     0 -16329.177    0  588 -27355.477 -16329.177  40.3%     -  344s
     0     0 -16332.764    0  592 -27355.477 -16332.764  40.3%     -  350s
     0     0 -16332.890    0  592 -27355.477 -16332.890  40.3%     -  351s
H    0     0                    -24660.38884 -16332.890  33.8%     -  362s
H    0     0                    -24572.86517 -16332.890  33.5%     -  362s
H    0     0                    -24143.37637 -16332.890  32.4%     -  363s
H    0     0                    -24142.87021 -16332.890  32.3%     -  363s
H    0     0                    -24136.62409 -17032.453  29.4%     -  397s
     0     0 -17032.453    0  652 -24136.624 -17032.453  29.4%     -  397s
H    0     0                    -24117.87792 -17288.525  28.3%     -  412s
     0     0 -17288.525    0  667 -24117.878 -17288.525  28.3%     -  412s
     0     0 -17362.841    0  662 -24117.878 -17362.841  28.0%     -  426s
     0     0 -17382.066    0  663 -24117.878 -17382.066  27.9%     -  436s
     0     0 -17436.303    0  664 -24117.878 -17436.303  27.7%     -  446s
     0     0 -17444.000    0  670 -24117.878 -17444.000  27.7%     -  451s
     0     0 -17470.565    0  664 -24117.878 -17470.565  27.6%     -  458s
     0     0 -17480.403    0  671 -24117.878 -17480.403  27.5%     -  463s
     0     0 -17482.975    0  675 -24117.878 -17482.975  27.5%     -  465s
     0     0 -17484.875    0  670 -24117.878 -17484.875  27.5%     -  468s
     0     0 -17647.334    0  585 -24117.878 -17647.334  26.8%     -  499s
     0     0 -17665.173    0  652 -24117.878 -17665.173  26.8%     -  520s
     0     0 -17669.883    0  653 -24117.878 -17669.883  26.7%     -  524s
     0     0 -17677.436    0  588 -24117.878 -17677.436  26.7%     -  531s
     0     0 -17689.855    0  590 -24117.878 -17689.855  26.7%     -  537s
     0     0 -17693.040    0  593 -24117.878 -17693.040  26.6%     -  543s
     0     0 -17695.425    0  599 -24117.878 -17695.425  26.6%     -  547s
     0     0 -17698.212    0  597 -24117.878 -17698.212  26.6%     -  550s
     0     0 -17701.126    0  590 -24117.878 -17701.126  26.6%     -  552s
     0     0 -17701.354    0  592 -24117.878 -17701.354  26.6%     -  553s
     0     0 -17701.354    0  592 -24117.878 -17701.354  26.6%     -  554s
     0     0 -17805.102    0  619 -24117.878 -17805.102  26.2%     -  584s
     0     0 -17825.567    0  530 -24117.878 -17825.567  26.1%     -  601s
     0     0 -17829.654    0  532 -24117.878 -17829.654  26.1%     -  609s
     0     0 -17840.571    0  538 -24117.878 -17840.571  26.0%     -  614s
     0     0 -17841.543    0  537 -24117.878 -17841.543  26.0%     -  617s
     0     0 -17859.227    0  529 -24117.878 -17859.227  26.0%     -  633s
     0     0 -17864.186    0  529 -24117.878 -17864.186  25.9%     -  641s
     0     0 -17873.459    0  523 -24117.878 -17873.459  25.9%     -  649s
     0     0 -17883.049    0  525 -24117.878 -17883.049  25.9%     -  656s
     0     0 -17886.973    0  531 -24117.878 -17886.973  25.8%     -  658s
     0     0 -17887.690    0  526 -24117.878 -17887.690  25.8%     -  662s
H    0     0                    -24092.39407 -17935.802  25.6%     -  684s
H    0     0                    -24085.49399 -17935.802  25.5%     -  684s
     0     0 -17935.802    0  602 -24085.494 -17935.802  25.5%     -  685s
     0     0 -17942.151    0  606 -24085.494 -17942.151  25.5%     -  696s
     0     0 -17945.720    0  611 -24085.494 -17945.720  25.5%     -  700s
     0     0 -17947.694    0  528 -24085.494 -17947.694  25.5%     -  702s
     0     0 -17984.785    0  623 -24085.494 -17984.785  25.3%     -  718s
H    0     0                    -23990.80767 -17985.416  25.0%     -  719s
     0     0 -17990.540    0  625 -23990.808 -17990.540  25.0%     -  727s
     0     0 -17992.051    0  643 -23990.808 -17992.051  25.0%     -  730s
     0     0 -18020.631    0  624 -23990.808 -18020.631  24.9%     -  745s
     0     0 -18025.756    0  635 -23990.808 -18025.756  24.9%     -  754s
     0     0 -18026.534    0  636 -23990.808 -18026.534  24.9%     -  756s
H    0     0                    -23924.72872 -18043.976  24.6%     -  766s
H    0     0                    -23916.62670 -18043.976  24.6%     -  766s
     0     0 -18043.976    0  532 -23916.627 -18043.976  24.6%     -  766s
H    0     0                    -23823.94001 -18044.162  24.3%     -  767s
     0     0 -18057.729    0  538 -23823.940 -18057.729  24.2%     -  776s
     0     0 -18059.063    0  540 -23823.940 -18059.063  24.2%     -  778s
H    0     0                    -23821.50247 -18074.090  24.1%     -  793s
H    0     0                    -23804.51409 -18074.090  24.1%     -  793s
     0     0 -18074.090    0  545 -23804.514 -18074.090  24.1%     -  793s
     0     0 -18077.255    0  611 -23804.514 -18077.255  24.1%     -  801s
     0     0 -18081.034    0  541 -23804.514 -18081.034  24.0%     -  807s
     0     0 -18084.215    0  536 -23804.514 -18084.215  24.0%     -  811s
     0     0 -18088.494    0  535 -23804.514 -18088.494  24.0%     -  814s
     0     0 -18088.919    0  538 -23804.514 -18088.919  24.0%     -  815s
     0     0 -18099.628    0  603 -23804.514 -18099.628  24.0%     -  828s
     0     0 -18107.721    0  613 -23804.514 -18107.721  23.9%     -  834s
     0     0 -18108.691    0  616 -23804.514 -18108.691  23.9%     -  836s
     0     0 -18116.419    0  540 -23804.514 -18116.419  23.9%     -  848s
H    0     0                    -23792.27815 -18116.526  23.9%     -  942s
H    0     0                    -23783.53369 -18116.526  23.8%     -  967s
H    0     0                    -23775.64895 -18116.526  23.8%     -  967s
H    0     0                    -23614.06240 -18116.526  23.3%     -  979s
H    0     0                    -23585.72171 -18116.526  23.2%     -  986s
     0     0 -18117.022    0  622 -23585.722 -18117.022  23.2%     -  991s
     0     0 -18118.064    0  539 -23585.722 -18118.064  23.2%     -  996s
     0     0 -18118.381    0  623 -23585.722 -18118.381  23.2%     -  999s
     0     0 -18123.585    0  622 -23585.722 -18123.585  23.2%     - 1006s
     0     0 -18123.742    0  622 -23585.722 -18123.742  23.2%     - 1016s
H    0     0                    -23583.93367 -18123.809  23.2%     - 1068s
H    0     0                    -23574.08361 -18123.809  23.1%     - 1135s
H    0     0                    -23552.99770 -18123.809  23.1%     - 1136s
     0     2 -18123.809    0  622 -23552.998 -18123.809  23.1%     - 1139s
     1     3 -19230.110    1  383 -23552.998 -18123.812  23.1% 20541 1176s
     2     6 -19329.002    2  379 -23552.998 -18123.812  23.1% 12366 1186s
     5     9 -19025.566    2  409 -23552.998 -18167.645  22.9%  9870 1216s
     8    18 -20517.501    3  278 -23552.998 -18167.645  22.9% 14231 1236s
    17    27 -19245.518    3  408 -23552.998 -18268.903  22.4% 10521 1310s
    26    52 -19396.289    5  386 -23552.998 -18268.903  22.4% 10662 1468s
    53    81 -19516.964    6  379 -23552.998 -18357.506  22.1% 36436 1509s
H   56    81                    -23534.50487 -18357.506  22.0% 34761 1509s
H   63    81                    -23532.37260 -18357.506  22.0% 31559 1510s
    84   168 -19539.907    7  383 -23532.373 -18358.461  22.0% 25527 1568s
   173   199 infeasible   12      -23532.373 -18358.461  22.0% 14212 1615s
   206   226 -20158.081   13  259 -23532.373 -18358.461  22.0% 12613 1699s
   235   260 -20160.738   14  266 -23532.373 -18358.461  22.0% 11638 1758s
   275   290 -20203.382   15  346 -23532.373 -18358.461  22.0% 10488 1797s
H  314   290                    -23527.51364 -18358.461  22.0%  9674 1797s
   323   353 -20318.993   16  259 -23527.514 -18358.461  22.0%  9486 1835s
H  398   382                    -23527.13782 -18358.461  22.0%  8361 1868s
H  424   382                    -23519.89085 -18384.302  21.8%  8024 1868s
   464   435 -20801.920   24  427 -23519.891 -18384.302  21.8%  7749 1905s
   536   484 -21142.449   29  365 -23519.891 -18384.302  21.8%  7175 1940s
   608   542 -21425.519   32  494 -23519.891 -18490.972  21.4%  6699 1974s
   693   584 -21722.214   37  474 -23519.891 -18490.972  21.4%  6191 2007s
   765   609 -21936.952   42  514 -23519.891 -18490.972  21.4%  5869 2039s
   830   641 -21970.032   44  385 -23519.891 -18552.972  21.1%  5648 2072s
   890   679 -22157.642   48  506 -23519.891 -18552.972  21.1%  5489 2106s
   954   745 -22341.244   53  359 -23519.891 -18552.972  21.1%  5399 2138s
  1030   780 infeasible   57      -23519.891 -18552.972  21.1%  5241 2173s
  1112   837 -23293.087   63  311 -23519.891 -18552.972  21.1%  5080 2208s
  1207   900 -23422.765   70  290 -23519.891 -18552.972  21.1%  4883 2244s
  1324   953 -22984.680   29  334 -23519.891 -18552.972  21.1%  4681 2280s
  1432   962 infeasible   19      -23519.891 -18880.584  19.7%  4479 2316s
  1502   983 -19203.167   12  571 -23519.891 -18880.584  19.7%  4432 2361s
  1539  1024 -19402.043   13  571 -23519.891 -18880.584  19.7%  4441 2401s
  1610  1077 -19532.575   14  551 -23519.891 -18977.914  19.3%  4417 2439s
  1711  1114 -20011.184   16  544 -23519.891 -18977.914  19.3%  4347 2486s
  1811  1155 infeasible   18      -23519.891 -18977.914  19.3%  4297 2532s
  1903  1227 -22169.918   18  257 -23519.891 -18977.914  19.3%  4274 2580s
  2013  1276 infeasible   20      -23519.891 -19203.294  18.4%  4239 2633s
  2141  1344 -22120.708   18  247 -23519.891 -19203.294  18.4%  4185 2683s
  2271  1415     cutoff   26      -23519.891 -19203.294  18.4%  4135 2761s
  2396  1486 infeasible   39      -23519.891 -19455.529  17.3%  4114 2814s
  2569  1530 -20448.384   14  269 -23519.891 -19455.529  17.3%  4017 2879s
  2738  1550 -21341.093   16  261 -23519.891 -19547.700  16.9%  3936 3000s
  2780  1569 -21771.335   17  324 -23519.891 -19548.583  16.9%  3962 3217s
  2818  1587 -22010.007   18  332 -23519.891 -19548.583  16.9%  3983 3370s
  2860  1618 -22132.867   19  480 -23519.891 -19548.583  16.9%  3993 3434s
  2909  1630 -22140.297   20  469 -23519.891 -19548.583  16.9%  4000 3491s
  2957  1651 -22176.149   21  469 -23519.891 -19548.583  16.9%  4004 3543s
H 2959  1651                    -23514.25427 -19548.583  16.9%  4003 3543s
  3004  1713 -22292.952   22  375 -23514.254 -19548.583  16.9%  4022 3600s

Cutting planes:
  Learned: 1
  Implied bound: 209
  MIR: 3687
  Flow cover: 3477
  Zero half: 11
  RLT: 87
  Relax-and-lift: 429

Explored 3116 nodes (13152476 simplex iterations) in 3600.09 seconds (5112.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -23514.3 -23519.9 -23527.1 ... -23585.7

Time limit reached
Best objective -2.351425427236e+04, best bound -1.954858311501e+04, gap 16.8650%
  WARNING: Time limit reached. Using best solution found (gap: 16.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -23514.25, θ = 94771.02
  Upper Bound (UB) = -23514.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94771.02
  [DEBUG]   ✓ Scenario 0: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94771.02 ≤ Q = 94771.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94771.02 ≤ Q = 94771.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 94771.02 ≤ Q = 94771.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 94771.02 ≤ Q = 94771.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 94771.02 ≤ Q = 94771.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1db45fdc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1db45fdc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462792e+13
Presolve removed 2610 rows and 1904 columns
Presolve time: 0.01s
Presolved: 483 rows, 485 columns, 1361 nonzeros
Found heuristic solution: objective 7743204.1556
Variable types: 327 continuous, 158 integer (158 binary)

Root relaxation: objective -1.099410e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -109941.03    0  121 7743204.16 -109941.03   101%     -    0s
H    0     0                    -77042.32806 -109941.03  42.7%     -    0s
H    0     0                    -77465.80798 -109941.03  41.9%     -    0s
     0     0 -82144.547    0  133 -77465.808 -82144.547  6.04%     -    0s
H    0     0                    -78490.42443 -81998.478  4.47%     -    0s
     0     0 -81539.050    0  130 -78490.424 -81539.050  3.88%     -    0s
H    0     0                    -79975.01445 -81537.352  1.95%     -    0s
     0     0 -81537.352    0  130 -79975.014 -81537.352  1.95%     -    0s
     0     0 -81409.551    0   60 -79975.014 -81409.551  1.79%     -    0s
     0     0 -81367.123    0   60 -79975.014 -81367.123  1.74%     -    0s
     0     0 -81319.725    0   61 -79975.014 -81319.725  1.68%     -    0s
     0     0 -81288.036    0   61 -79975.014 -81288.036  1.64%     -    0s
     0     2 -81288.036    0   61 -79975.014 -81288.036  1.64%     -    0s
H  342   165                    -79983.04914 -80748.108  0.96%   7.4    0s
*  814   304              27    -79983.67333 -80622.623  0.80%   6.9    0s
* 3244    88              27    -79986.54023 -80139.343  0.19%   7.0    0s

Cutting planes:
  Gomory: 48
  MIR: 186

Explored 3552 nodes (25006 simplex iterations) in 0.40 seconds (0.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -79986.5 -79983.7 -79983 ... 1.46279e+13
No other solutions better than -79986.5

Optimal solution found (tolerance 1.00e-06)
Best objective -7.998654023000e+04, best bound -7.998654023000e+04, gap 0.0000%
  Subproblem solved in 0.43s
  Worst-case operational profit (Z_SP) = 94761.81
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -79986.54
  [DEBUG]   S×d_nominal = 174748.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 174748.35 + -79986.54 = 94761.81
  [DEBUG]   Current θ from Master = 94771.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23523.46
  Lower Bound (LB) = -23523.46
  Gap (UB-LB) = 9.2023, Absolute Gap = 9.2023, Relative Gap = 0.000391
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 15
Total Time: 31467.04s
Converged: True
Final Lower Bound: -23523.4566
Final Upper Bound: -23514.2543
Final Gap: 9.202323
Number of Critical Scenarios: 15
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [8, 9] (2/10)
Active Routes (Plant→DC): 6
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 10 customers  Mode 1: 24 customers  Mode 2: 16 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 15
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-03 18:29:52
Total Time: 31467.04s
Optimal Value: -23523.46
Lower Bound: -23523.46
Upper Bound: -23514.25
Gap: 9.202323
Plants Opened: {0: [2], 1: [1], 2: [0]} (3 plants)
DCs Opened: [8, 9] (2 DCs)
================================================================================

Results saved to: result/DH_single_full_seed12_LD_gamma20_20260103_182952.csv

Total Execution Time: 31467.56 seconds
End Time: 2026-01-03 18:29:52

All tasks completed successfully!

