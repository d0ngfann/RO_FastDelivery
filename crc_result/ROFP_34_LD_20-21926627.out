
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 34
DI Scenario: LD
Start Time: 2026-01-04 06:35:45
================================================================================
Loading data from data/DH_data_full_seed34.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
  Product 1: ['1.000', '1.000', '1.000'] (k=0.000)
  Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=921, max=1787
  DC capacity (MC): min=431, max=854

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.04, max=34.79, count=82
  Deviation (μ̂): min=4.41, max=10.00

Costs:
  Plant fixed cost: min=5213, max=9962
  DC fixed cost: min=3231, max=5838
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.461', '2.135'] (k=0.935)
    Product 1: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 2: ['1.000', '1.441', '2.075'] (k=0.900)
  MD:
    Product 0: ['1.000', '1.184', '1.403'] (k=0.417)
    Product 1: ['1.000', '1.174', '1.379'] (k=0.396)
    Product 2: ['1.000', '1.288', '1.660'] (k=0.625)
  LD:
    Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
    Product 1: ['1.000', '1.000', '1.000'] (k=0.000)
    Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
  Mixed:
    Product 0: ['1.000', '1.461', '2.135'] (k=0.935)
    Product 1: ['1.000', '1.174', '1.379'] (k=0.396)
    Product 2: ['1.000', '1.034', '1.070'] (k=0.083)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x0e9c7c42
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.07s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309329.5914
Found heuristic solution: objective -193281.0883

Root relaxation: objective 7.001793e+04, 5429 iterations, 0.27 seconds (0.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 70017.9322    0  752 -193281.09 70017.9322   136%     -    0s
H    0     0                    -157414.7272 70017.9322   144%     -    0s
     0     0 65284.7175    0  992 -157414.73 65284.7175   141%     -    1s
     0     0 65196.3365    0  986 -157414.73 65196.3365   141%     -    1s
     0     0 65196.3365    0  989 -157414.73 65196.3365   141%     -    1s
     0     0 65196.3365    0  991 -157414.73 65196.3365   141%     -    1s
H    0     0                    -134756.0559 65196.3365   148%     -    1s
     0     0 62906.3639    0 1009 -134756.06 62906.3639   147%     -    2s
H    0     0                    -127580.2449 62905.2137   149%     -    2s
     0     0 62837.9238    0 1021 -127580.24 62837.9238   149%     -    2s
     0     0 62827.3281    0 1107 -127580.24 62827.3281   149%     -    2s
     0     0 62826.1371    0 1110 -127580.24 62826.1371   149%     -    2s
H    0     0                    -98697.92260 60626.4518   161%     -    3s
H    0     0                    -98321.02886 60626.4518   162%     -    3s
H    0     0                    -98269.08733 60626.4518   162%     -    3s
H    0     0                    -98217.77660 60626.4518   162%     -    3s
H    0     0                    -97980.99886 60626.4518   162%     -    3s
H    0     0                    -97940.08099 60626.4518   162%     -    3s
H    0     0                    -97879.80137 60626.4518   162%     -    3s
H    0     0                    -54260.16379 60626.4518   212%     -    3s
     0     0 60626.4518    0 1165 -54260.164 60626.4518   212%     -    3s
     0     0 60164.8176    0 1097 -54260.164 60164.8176   211%     -    4s
     0     0 60077.3525    0 1111 -54260.164 60077.3525   211%     -    4s
     0     0 60073.9339    0 1116 -54260.164 60073.9339   211%     -    4s
     0     0 60072.6885    0 1124 -54260.164 60072.6885   211%     -    4s
H    0     0                    -33927.32826 58215.7873   272%     -    6s
H    0     0                    -28559.57130 58215.7873   304%     -    6s
H    0     0                    -28520.73434 58215.7873   304%     -    6s
H    0     0                    -24896.25893 58215.7873   334%     -    6s
H    0     0                    -24771.10443 58215.7873   335%     -    6s
H    0     0                    -24636.12499 58215.7873   336%     -    6s
H    0     0                    -16802.63034 58215.7873   446%     -    6s
H    0     0                    -16483.64716 58215.7873   453%     -    6s
H    0     0                    -12290.30653 58215.7873   574%     -    6s
H    0     0                    -12288.11072 58215.7873   574%     -    6s
     0     0 58215.7873    0 1353 -12288.111 58215.7873   574%     -    6s
     0     0 57891.7399    0 1372 -12288.111 57891.7399   571%     -    7s
H    0     0                    -12104.30030 57877.4966   578%     -    7s
H    0     0                    -11478.10433 57877.4966   604%     -    7s
H    0     0                    -9072.858826 57877.4966   738%     -    7s
H    0     0                    -9069.932585 57877.4966   738%     -    7s
H    0     0                    -4546.363127 57877.4966  1373%     -    7s
H    0     0                    -4544.167310 57877.4966  1374%     -    7s
     0     0 57877.4966    0 1377 -4544.1673 57877.4966  1374%     -    7s
H    0     0                    -4208.632829 57877.4966  1475%     -    7s
H    0     0                    -4118.126447 57877.4966  1505%     -    7s
H    0     0                    -4115.200206 57877.4966  1506%     -    7s
     0     0 57877.4966    0 1377 -4115.2002 57877.4966  1506%     -    7s
H    0     0                    -3943.522793 57876.3842  1568%     -    7s
H    0     0                    -3831.059048 57876.3842  1611%     -    7s
H    0     0                    -3199.960990 57876.3842  1909%     -    7s
H    0     0                    -3160.459194 57876.3842  1931%     -    7s
H    0     0                    -2821.610019 57876.3842  2151%     -    7s
H    0     0                    -2444.060795 57876.3842  2468%     -    7s
H    0     0                    -2422.159624 57876.3842  2489%     -    7s
H    0     0                    -2333.375545 56499.8224  2521%     -    9s
H    0     0                    -2236.290914 56499.8224  2626%     -    9s
H    0     0                    -2233.324675 56499.8224  2630%     -    9s
H    0     0                    -2230.989491 56499.8224  2633%     -    9s
H    0     0                    -2230.661646 56499.8224  2633%     -    9s
H    0     0                    -2225.037994 56499.8224  2639%     -    9s
H    0     0                    -2222.071754 56499.8224  2643%     -    9s
H    0     0                    -2221.743909 56499.8224  2643%     -    9s
H    0     0                    -2044.127284 56499.8224  2864%     -    9s
H    0     0                    -1156.451315 56499.8224  4986%     -    9s
H    0     0                    -1048.972636 56499.8224  5486%     -    9s
H    0     0                    -1043.671213 56499.8224  5514%     -    9s
H    0     0                    -1020.745845 56499.8224  5635%     -    9s
H    0     0                    -1020.547601 56499.8224  5636%     -    9s
H    0     0                    -933.8130789 56499.8224  6150%     -    9s
H    0     0                    -885.5329711 56499.8224  6480%     -    9s
H    0     0                    -840.2790368 56499.8224  6824%     -    9s
H    0     0                    -825.7488579 56499.8224  6942%     -    9s
H    0     0                    -727.6374401 56499.8224  7865%     -    9s
H    0     0                    -718.8367857 56499.8224  7960%     -    9s
H    0     0                    -655.3553301 56499.8224  8721%     -    9s
H    0     0                    -630.2387002 56499.8224  9065%     -    9s
H    0     0                    -517.6699344 56499.8224      -     -    9s
H    0     0                    -431.1827015 56499.8224      -     -    9s
H    0     0                    -419.9790664 56499.8224      -     -    9s
H    0     0                    2749.1451131 56499.8224  1955%     -    9s
H    0     0                    3034.6528155 56499.8224  1762%     -    9s
H    0     0                    4074.3566678 56499.8224  1287%     -    9s
H    0     0                    4106.7334568 56499.8224  1276%     -    9s
H    0     0                    4163.6035675 56499.8224  1257%     -    9s
H    0     0                    5035.5611261 56499.8224  1022%     -    9s
H    0     0                    5042.4126269 56499.8224  1020%     -    9s
H    0     0                    5059.5613536 56499.8224  1017%     -    9s
H    0     0                    5069.7464807 56499.8224  1014%     -    9s
     0     0 56499.8224    0 1224 5069.74648 56499.8224  1014%     -    9s
H    0     0                    5195.1232942 56268.9906   983%     -    9s
H    0     0                    5199.0583325 56268.9906   982%     -    9s
H    0     0                    5202.9515213 56268.9906   981%     -    9s
H    0     0                    5204.1189945 56268.9906   981%     -    9s
H    0     0                    5205.9077320 56268.9906   981%     -    9s
     0     0 56268.9906    0 1367 5205.90773 56268.9906   981%     -    9s
H    0     0                    11648.225804 56229.2067   383%     -   10s
H    0     0                    11989.758247 56229.2067   369%     -   10s
     0     0 56229.2067    0 1382 11989.7582 56229.2067   369%     -   10s
     0     0 56222.0703    0 1382 11989.7582 56222.0703   369%     -   10s
H    0     0                    20807.760942 56222.0703   170%     -   10s
H    0     0                    20926.594324 56222.0703   169%     -   10s
H    0     0                    21052.568167 56222.0703   167%     -   10s
H    0     0                    21066.214308 56222.0703   167%     -   10s
H    0     0                    23739.003006 54759.0043   131%     -   11s
H    0     0                    23974.986671 54759.0043   128%     -   11s
H    0     0                    24844.271364 54759.0043   120%     -   11s
H    0     0                    26161.083411 54759.0043   109%     -   11s
H    0     0                    26368.182061 54759.0043   108%     -   11s
H    0     0                    26394.196829 54759.0043   107%     -   11s
H    0     0                    26746.014134 54759.0043   105%     -   11s
H    0     0                    28934.262915 54759.0043  89.3%     -   12s
H    0     0                    29233.621498 54759.0043  87.3%     -   12s
H    0     0                    29587.234333 54759.0043  85.1%     -   12s
H    0     0                    29632.819054 54759.0043  84.8%     -   12s
H    0     0                    29681.578958 54759.0043  84.5%     -   12s
H    0     0                    29695.829776 54759.0043  84.4%     -   12s
H    0     0                    29701.740764 54759.0043  84.4%     -   12s
H    0     0                    29862.614818 54759.0043  83.4%     -   12s
H    0     0                    29873.536201 54759.0043  83.3%     -   12s
H    0     0                    29878.241248 54759.0043  83.3%     -   12s
     0     0 54759.0043    0 1410 29878.2412 54759.0043  83.3%     -   12s
H    0     0                    29987.388988 54527.9229  81.8%     -   12s
H    0     0                    30149.510256 54527.9229  80.9%     -   12s
H    0     0                    30219.740017 54527.9229  80.4%     -   12s
H    0     0                    30265.261468 54527.9229  80.2%     -   12s
     0     0 54527.9229    0 1452 30265.2615 54527.9229  80.2%     -   12s
     0     0 54478.1599    0 1441 30265.2615 54478.1599  80.0%     -   12s
     0     0 54464.4867    0 1458 30265.2615 54464.4867  80.0%     -   13s
     0     0 54460.6076    0 1464 30265.2615 54460.6076  79.9%     -   13s
     0     0 53351.1264    0 1393 30265.2615 53351.1264  76.3%     -   14s
     0     0 53191.3068    0 1366 30265.2615 53191.3068  75.8%     -   15s
H    0     0                    30300.111856 53143.4220  75.4%     -   15s
H    0     0                    30300.385177 53143.4220  75.4%     -   15s
     0     0 53143.4220    0 1409 30300.3852 53143.4220  75.4%     -   15s
     0     0 53134.5428    0 1404 30300.3852 53134.5428  75.4%     -   15s
     0     0 52368.9603    0 1272 30300.3852 52368.9603  72.8%     -   17s
     0     0 52246.5373    0 1409 30300.3852 52246.5373  72.4%     -   18s
     0     0 52218.6408    0 1315 30300.3852 52218.6408  72.3%     -   18s
     0     0 52199.2034    0 1309 30300.3852 52199.2034  72.3%     -   18s
     0     0 52195.8301    0 1339 30300.3852 52195.8301  72.3%     -   19s
H    0     0                    31970.176530 50981.6747  59.5%     -   21s
H    0     0                    32094.640801 50981.6747  58.8%     -   21s
     0     0 50981.6747    0 1323 32094.6408 50981.6747  58.8%     -   21s
     0     0 50755.5975    0 1332 32094.6408 50755.5975  58.1%     -   22s
     0     0 50718.8378    0 1352 32094.6408 50718.8378  58.0%     -   22s
     0     0 50709.6647    0 1353 32094.6408 50709.6647  58.0%     -   22s
     0     0 49545.5153    0 1229 32094.6408 49545.5153  54.4%     -   24s
     0     0 49236.1673    0 1232 32094.6408 49236.1673  53.4%     -   25s
     0     0 49135.5236    0 1255 32094.6408 49135.5236  53.1%     -   25s
     0     0 49122.0967    0 1274 32094.6408 49122.0967  53.1%     -   26s
     0     0 48240.3601    0 1141 32094.6408 48240.3601  50.3%     -   27s
     0     0 48041.0301    0 1288 32094.6408 48041.0301  49.7%     -   28s
     0     0 47992.5343    0 1297 32094.6408 47992.5343  49.5%     -   29s
     0     0 47982.6827    0 1304 32094.6408 47982.6827  49.5%     -   29s
     0     0 47320.0942    0 1259 32094.6408 47320.0942  47.4%     -   31s
     0     0 47208.0685    0 1296 32094.6408 47208.0685  47.1%     -   31s
     0     0 47167.6719    0 1294 32094.6408 47167.6719  47.0%     -   32s
     0     0 47152.0746    0 1181 32094.6408 47152.0746  46.9%     -   32s
     0     0 46802.7565    0 1286 32094.6408 46802.7565  45.8%     -   33s
     0     0 46734.3144    0 1295 32094.6408 46734.3144  45.6%     -   34s
     0     0 46701.9540    0 1299 32094.6408 46701.9540  45.5%     -   34s
     0     0 46693.0904    0 1311 32094.6408 46693.0904  45.5%     -   34s
H    0     0                    32113.547558 46388.0767  44.5%     -   36s
H    0     0                    32128.303733 46388.0767  44.4%     -   36s
H    0     0                    32128.902450 46388.0767  44.4%     -   36s
H    0     0                    32179.189293 46388.0767  44.2%     -   36s
     0     0 46388.0767    0 1283 32179.1893 46388.0767  44.2%     -   36s
H    0     0                    32209.339806 46306.2493  43.8%     -   36s
     0     0 46306.2493    0 1297 32209.3398 46306.2493  43.8%     -   36s
     0     0 46276.5563    0 1309 32209.3398 46276.5563  43.7%     -   37s
     0     0 46265.3749    0 1310 32209.3398 46265.3749  43.6%     -   37s
H    0     0                    32210.334068 46265.3749  43.6%     -   37s
     0     0 46058.0547    0 1276 32210.3341 46058.0547  43.0%     -   38s
     0     0 45988.1634    0 1259 32210.3341 45988.1634  42.8%     -   39s
     0     0 45971.3818    0 1293 32210.3341 45971.3818  42.7%     -   39s
     0     0 45789.4793    0 1199 32210.3341 45789.4793  42.2%     -   40s
     0     0 45789.3777    0 1199 32210.3341 45789.3777  42.2%     -   40s
     0     2 45789.1724    0 1199 32210.3341 45789.1724  42.2%     -   42s
     1     4 44888.6138    1 1134 32210.3341 45789.1724  42.2%  7014   45s
    15    26 41453.1616    4  749 32210.3341 44575.7664  38.4%  4460   57s
    87   113 39045.9075    7  646 32210.3341 43322.4789  34.5%  3175   60s
   371   250 33818.1860   13  578 32210.3341 42958.3147  33.4%  1352   65s
   759   496 32613.9757   18  474 32210.3341 42294.8372  31.3%  1060   70s
  1445   794 32667.2535   22  459 32210.3341 41167.5888  27.8%   854   75s
  2128   887 35170.7578   13  456 32210.3341 39668.7212  23.2%   789   80s
  2696   924 32549.8499   17  423 32210.3341 39657.8944  23.1%   781   85s
  3195   881 32510.2991   11  526 32210.3341 37399.8300  16.1%   780   90s
  3882   684     cutoff   19      32210.3341 36564.2659  13.5%   769   95s
  4672   190     cutoff   22      32210.3341 35657.1630  10.7%   738  100s

Cutting planes:
  Gomory: 3
  Implied bound: 491
  MIR: 2562
  Flow cover: 1312
  Zero half: 15
  RLT: 77
  Relax-and-lift: 904

Explored 5372 nodes (3759250 simplex iterations) in 101.29 seconds (215.60 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 32210.3 32209.3 32179.2 ... 30265.3

Optimal solution found (tolerance 1.00e-06)
Best objective 3.221033406784e+04, best bound 3.221033406784e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 101.30s
  Master Objective (UB) = 32210.33, θ = 153731.06
  Upper Bound (UB) = 32210.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153731.06
  [DEBUG]   ✓ Scenario 0: θ = 153731.06 ≤ Q = 153731.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x29bdce35
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd64231cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.286707e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7003398.1278
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.153204e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115320.45    0  121 7003398.13 -115320.45   102%     -    0s
H    0     0                    -80178.91786 -115320.45  43.8%     -    0s
H    0     0                    -81931.06665 -115320.45  40.8%     -    0s
*    0     0               0    -83094.69320 -83094.693  0.00%     -    0s

Cutting planes:
  Gomory: 20
  MIR: 186

Explored 1 nodes (378 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -83094.7 -81931.1 -80178.9 ... 1.28671e+13
No other solutions better than -83094.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.309469319947e+04, best bound -8.309469319947e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 116120.99
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83094.69
  [DEBUG]   S×d_nominal = 199215.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199215.69 + -83094.69 = 116120.99
  [DEBUG]   Current θ from Master = 153731.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 37610.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5399.73
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 37610.0640, Absolute Gap = 37610.0640, Relative Gap = 1.167640
  Not converged yet (gap = 37610.06 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x9de30a78
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -5399.73 (0.01s)
MIP start from previous solve produced solution with objective -5399.73 (0.01s)
Loaded MIP start from previous solve with objective -5399.73

Presolve removed 13827 rows and 5606 columns
Presolve time: 0.28s
Presolved: 18136 rows, 9134 columns, 100428 nonzeros
Variable types: 6875 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.286382e+04, 9489 iterations, 1.11 seconds (2.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22863.8165    0  420 -5399.7299 22863.8165   523%     -    1s
H    0     0                    -4263.947231 22863.8165   636%     -    1s
H    0     0                    -4228.483664 16091.1782   481%     -    3s
     0     0 16091.1782    0  625 -4228.4837 16091.1782   481%     -    3s
     0     0 15873.8213    0  666 -4228.4837 15873.8213   475%     -    3s
     0     0 15873.3549    0  664 -4228.4837 15873.3549   475%     -    3s
     0     0 15873.2057    0  664 -4228.4837 15873.2057   475%     -    3s
     0     0 12312.0727    0  648 -4228.4837 12312.0727   391%     -    5s
H    0     0                    -4226.765141 12310.3941   391%     -    5s
H    0     0                    -4209.595782 12310.3941   392%     -    5s
     0     0 12020.9946    0  661 -4209.5958 12020.9946   386%     -    5s
     0     0 12013.7802    0  662 -4209.5958 12013.7802   385%     -    5s
     0     0 12013.3369    0  668 -4209.5958 12013.3369   385%     -    5s
H    0     0                    -857.5660731 10036.3330  1270%     -    8s
H    0     0                     698.8474569 10036.3330  1336%     -    8s
H    0     0                     805.9842387 10036.3330  1145%     -    8s
     0     0 10036.3330    0  641  805.98424 10036.3330  1145%     -    8s
     0     0 9788.56917    0  611  805.98424 9788.56917  1114%     -    8s
     0     0 9717.35440    0  638  805.98424 9717.35440  1106%     -    9s
     0     0 9710.33599    0  642  805.98424 9710.33599  1105%     -    9s
     0     0 9709.80788    0  638  805.98424 9709.80788  1105%     -    9s
     0     0 8587.29616    0  610  805.98424 8587.29616   965%     -   11s
     0     0 8108.63238    0  704  805.98424 8108.63238   906%     -   12s
     0     0 7885.70532    0  800  805.98424 7885.70532   878%     -   13s
     0     0 7839.10350    0  794  805.98424 7839.10350   873%     -   13s
     0     0 7823.31322    0  791  805.98424 7823.31322   871%     -   14s
     0     0 7822.03798    0  805  805.98424 7822.03798   870%     -   14s
     0     0 7379.02965    0  632  805.98424 7379.02965   816%     -   15s
     0     0 7290.60684    0  548  805.98424 7290.60684   805%     -   15s
     0     0 7270.11730    0  644  805.98424 7270.11730   802%     -   16s
     0     0 7262.90829    0  561  805.98424 7262.90829   801%     -   16s
     0     0 7260.22984    0  565  805.98424 7260.22984   801%     -   16s
     0     0 7002.46455    0  733  805.98424 7002.46455   769%     -   17s
     0     0 6935.45518    0  655  805.98424 6935.45518   760%     -   18s
     0     0 6918.56037    0  648  805.98424 6918.56037   758%     -   18s
     0     0 6901.08424    0  898  805.98424 6901.08424   756%     -   18s
     0     0 6899.27517    0  843  805.98424 6899.27517   756%     -   19s
     0     0 6755.03005    0  630  805.98424 6755.03005   738%     -   19s
     0     0 6710.13724    0  575  805.98424 6710.13724   733%     -   20s
     0     0 6700.04383    0  654  805.98424 6700.04383   731%     -   20s
     0     0 6698.51156    0  649  805.98424 6698.51156   731%     -   20s
H    0     0                    1119.6758676 6523.25444   483%     -   21s
H    0     0                    1600.6379253 6523.25444   308%     -   21s
H    0     0                    1614.3130180 6523.25444   304%     -   21s
     0     0 6523.25444    0  644 1614.31302 6523.25444   304%     -   21s
     0     0 6474.39478    0  718 1614.31302 6474.39478   301%     -   22s
     0     0 6461.46159    0  649 1614.31302 6461.46159   300%     -   22s
     0     0 6456.94431    0  651 1614.31302 6456.94431   300%     -   22s
     0     0 6387.63913    0  557 1614.31302 6387.63913   296%     -   23s
H    0     0                    1660.7976743 6387.58970   285%     -   23s
H    0     0                    1661.5716965 6387.58970   284%     -   23s
     0     0 6368.10099    0  618 1661.57170 6368.10099   283%     -   23s
     0     0 6362.46612    0  543 1661.57170 6362.46612   283%     -   23s
     0     0 6343.32578    0  708 1661.57170 6343.32578   282%     -   24s
     0     0 6338.34341    0  708 1661.57170 6338.34341   281%     -   24s
     0     0 6280.23590    0  615 1661.57170 6280.23590   278%     -   25s
     0     0 6275.14052    0  629 1661.57170 6275.14052   278%     -   25s
     0     0 6261.33543    0  699 1661.57170 6261.33543   277%     -   26s
     0     0 6259.48334    0  685 1661.57170 6259.48334   277%     -   26s
     0     0 6233.72281    0  624 1661.57170 6233.72281   275%     -   26s
     0     0 6233.63599    0  624 1661.57170 6233.63599   275%     -   27s
H    0     0                    1686.3385193 6233.63599   270%     -   31s
     0     2 6233.63599    0  624 1686.33852 6233.63599   270%     -   31s
H   33    46                    1709.7861041 5673.40406   232%   877   34s
H   34    46                    1738.4023057 5673.40406   226%   868   34s
    63    75 5421.30390    6  512 1738.40231 5491.16172   216%   804   36s
   260   207 5000.80332   10  471 1738.40231 5449.00709   213%   746   40s
   651   436 3751.18435   15  300 1738.40231 5410.24233   211%   566   45s
  1026   524     cutoff   13      1738.40231 5252.43660   202%   521   50s
  1511   661     cutoff   13      1738.40231 5142.35205   196%   465   55s
  1967   822 2147.00166   12  254 1738.40231 5105.41795   194%   453   60s
  2784   942 1793.33175   30   82 1738.40231 4890.25661   181%   404   65s
  3465   838 2718.54331   15  445 1738.40231 4229.14158   143%   396   70s
  3969   595 infeasible    8      1738.40231 4051.88266   133%   386   75s
  5235  1013 1889.59926   23   96 1738.40231 3239.54865  86.4%   338   80s
  6200  1014 1940.09133   23  624 1738.40231 3022.16549  73.8%   295   90s
  6204  1017 2126.00754   23  499 1738.40231 3022.16549  73.8%   295   95s
  6213  1023 2219.67481   18  546 1738.40231 3022.16549  73.8%   295  100s
  6221  1028 1826.00210   23  609 1738.40231 3022.16549  73.8%   294  106s
  6227  1032 1749.33321   50  562 1738.40231 3022.16549  73.8%   294  111s
  6230  1034 1748.46939   37  553 1738.40231 3022.16549  73.8%   294  116s
  6234  1042 3022.16549   11  537 1738.40231 3022.16549  73.8%   300  121s
  6286  1047 3022.16549   16  456 1738.40231 3022.16549  73.8%   304  125s
H 6447   929                    1782.3543786 1872.95142  5.08%   304  128s
H 6459   876                    1803.2010870 1872.95142  3.87%   303  128s
H 6530   793                    1808.6948929 1827.35599  1.03%   300  128s
* 6586   722              49    1810.4823011 1810.65435  0.01%   298  129s
* 6588   679              49    1810.6543543 1810.65435  0.00%   298  129s

Cutting planes:
  Implied bound: 12
  Projected implied bound: 1
  MIR: 163
  Flow cover: 392
  Zero half: 1
  RLT: 5
  Relax-and-lift: 19

Explored 6589 nodes (2008486 simplex iterations) in 129.14 seconds (304.75 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 1810.65 1810.48 1803.2 ... 1614.31

Optimal solution found (tolerance 1.00e-06)
Best objective 1.810654354342e+03, best bound 1.810654354342e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 129.14s
  Master Objective (UB) = 1810.65, θ = 113730.87
  Upper Bound (UB) = 1810.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113730.87
  [DEBUG]   ✓ Scenario 0: θ = 113730.87 ≤ Q = 113730.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113730.87 ≤ Q = 113730.87 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x75f25665
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x75f25665
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476514e+13
Presolve removed 2594 rows and 1889 columns
Presolve time: 0.00s
Presolved: 499 rows, 500 columns, 1406 nonzeros
Found heuristic solution: objective 8333962.5318
Variable types: 336 continuous, 164 integer (164 binary)

Root relaxation: objective -1.210163e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121016.26    0  130 8333962.53 -121016.26   101%     -    0s
H    0     0                    -82770.58284 -121016.26  46.2%     -    0s
H    0     0                    -83142.05357 -121016.26  45.6%     -    0s
H    0     0                    -98275.70598 -121016.26  23.1%     -    0s
H    0     0                    -98366.59773 -121016.26  23.0%     -    0s
H    0     0                    -103875.9533 -121016.26  16.5%     -    0s
H    0     0                    -105538.9488 -107775.04  2.12%     -    0s
H    0     0                    -106280.1586 -107775.04  1.41%     -    0s
     0     0 -107775.04    0   60 -106280.16 -107775.04  1.41%     -    0s
H    0     0                    -106824.2449 -107686.67  0.81%     -    0s
     0     0 -107509.29    0   58 -106824.24 -107509.29  0.64%     -    0s
     0     0 -107197.28    0   47 -106824.24 -107197.28  0.35%     -    0s
     0     0 -107174.38    0   34 -106824.24 -107174.38  0.33%     -    0s
     0     0 -107170.04    0   33 -106824.24 -107170.04  0.32%     -    0s
     0     0 -107058.20    0   28 -106824.24 -107058.20  0.22%     -    0s
     0     0 -107028.50    0   20 -106824.24 -107028.50  0.19%     -    0s
     0     0 -107011.47    0   20 -106824.24 -107011.47  0.18%     -    0s
     0     0 -106987.83    0   20 -106824.24 -106987.83  0.15%     -    0s
     0     0 -106950.82    0   19 -106824.24 -106950.82  0.12%     -    0s
     0     0 -106920.38    0    9 -106824.24 -106920.38  0.09%     -    0s
     0     0 -106909.80    0   15 -106824.24 -106909.80  0.08%     -    0s
     0     0 -106906.42    0   15 -106824.24 -106906.42  0.08%     -    0s
     0     0 -106879.23    0    4 -106824.24 -106879.23  0.05%     -    0s
     0     0 -106879.23    0    8 -106824.24 -106879.23  0.05%     -    0s
H    0     0                    -106872.8525 -106879.23  0.01%     -    0s
     0     0 -106872.87    0    2 -106872.85 -106872.87  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 3
  Flow cover: 1
  RLT: 5
  Relax-and-lift: 1

Explored 1 nodes (649 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -106873 -106824 -106722 ... 8.33396e+06

Optimal solution found (tolerance 1.00e-06)
Best objective -1.068728524584e+05, best bound -1.068728673517e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 88666.93
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106872.85
  [DEBUG]   S×d_nominal = 195539.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195539.78 + -106872.85 = 88666.93
  [DEBUG]   Current θ from Master = 113730.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25063.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23253.29
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 7210.3843, Absolute Gap = 7210.3843, Relative Gap = 3.982198
  Not converged yet (gap = 7210.38 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0xf43b7c07
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -23253.3 (0.02s)
Loaded MIP start from previous solve with objective -23253.3

Presolve removed 20664 rows and 8394 columns
Presolve time: 0.35s
Presolved: 26589 rows, 12586 columns, 163679 nonzeros
Variable types: 10327 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44861    1.3911164e+04   0.000000e+00   3.796149e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19741    1.4436563e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 1.443656e+04, 19741 iterations, 5.72 seconds (11.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14436.5633    0  190 -23253.295 14436.5633   162%     -    6s
H    0     0                    -17659.90134 14436.5633   182%     -    6s
H    0     0                    -15546.97474 14436.5633   193%     -    6s
H    0     0                    -11410.49122 14436.5633   227%     -    6s
H    0     0                    -10712.05317 14436.5633   235%     -    6s
H    0     0                    -10290.77251 14436.5633   240%     -    6s
H    0     0                    -9133.666896 14436.5633   258%     -    6s
     0     0 11065.4526    0  403 -9133.6669 11065.4526   221%     -    8s
H    0     0                    -8819.753851 11063.1852   225%     -    8s
H    0     0                    -8552.601217 11063.1852   229%     -    8s
     0     0 10967.4114    0  425 -8552.6012 10967.4114   228%     -    9s
     0     0 10963.6848    0  425 -8552.6012 10963.6848   228%     -    9s
     0     0 10877.7523    0  430 -8552.6012 10877.7523   227%     -   10s
     0     0 10877.5195    0  433 -8552.6012 10877.5195   227%     -   10s
     0     0 9214.46042    0  409 -8552.6012 9214.46042   208%     -   12s
H    0     0                    -8541.627697 9212.67985   208%     -   12s
     0     0 9058.31275    0  419 -8541.6277 9058.31275   206%     -   12s
     0     0 8966.59746    0  413 -8541.6277 8966.59746   205%     -   13s
     0     0 8948.80121    0  411 -8541.6277 8948.80121   205%     -   13s
     0     0 8920.93821    0  409 -8541.6277 8920.93821   204%     -   13s
     0     0 8910.47424    0  415 -8541.6277 8910.47424   204%     -   13s
     0     0 8909.53989    0  420 -8541.6277 8909.53989   204%     -   13s
     0     0 8909.48339    0  420 -8541.6277 8909.48339   204%     -   13s
     0     0 8076.42782    0  405 -8541.6277 8076.42782   195%     -   16s
H    0     0                    -7029.285004 8076.29279   215%     -   16s
H    0     0                    -5104.176324 8076.29279   258%     -   16s
H    0     0                    -5020.051154 8076.29279   261%     -   16s
     0     0 7791.74303    0  501 -5020.0512 7791.74303   255%     -   17s
     0     0 7673.07454    0  380 -5020.0512 7673.07454   253%     -   18s
     0     0 7656.55283    0  493 -5020.0512 7656.55283   253%     -   18s
     0     0 7610.92105    0  398 -5020.0512 7610.92105   252%     -   19s
     0     0 7599.14101    0  490 -5020.0512 7599.14101   251%     -   20s
     0     0 7593.58895    0  495 -5020.0512 7593.58895   251%     -   20s
     0     0 7593.43932    0  491 -5020.0512 7593.43932   251%     -   20s
     0     0 7077.03393    0  503 -5020.0512 7077.03393   241%     -   23s
H    0     0                    -5002.881795 7076.97564   241%     -   23s
     0     0 6735.95312    0  490 -5002.8818 6735.95312   235%     -   24s
     0     0 6635.85195    0  402 -5002.8818 6635.85195   233%     -   25s
     0     0 6566.89842    0  506 -5002.8818 6566.89842   231%     -   25s
     0     0 6517.76239    0  565 -5002.8818 6517.76239   230%     -   26s
     0     0 6482.98304    0  411 -5002.8818 6482.98304   230%     -   26s
     0     0 6470.50242    0  506 -5002.8818 6470.50242   229%     -   27s
     0     0 6465.63420    0  510 -5002.8818 6465.63420   229%     -   27s
     0     0 6463.96593    0  428 -5002.8818 6463.96593   229%     -   27s
     0     0 6463.28564    0  430 -5002.8818 6463.28564   229%     -   27s
H    0     0                    -4298.270711 6275.91683   246%     -   29s
H    0     0                    -4262.033122 6275.91683   247%     -   29s
     0     0 6275.91683    0  514 -4262.0331 6275.91683   247%     -   29s
H    0     0                    -4219.434853 6275.77280   249%     -   29s
     0     0 6206.74604    0  546 -4219.4349 6206.74604   247%     -   30s
     0     0 6176.10070    0  532 -4219.4349 6176.10070   246%     -   30s
     0     0 6172.19325    0  527 -4219.4349 6172.19325   246%     -   30s
     0     0 6171.91961    0  531 -4219.4349 6171.91961   246%     -   30s
     0     0 6056.06610    0  523 -4219.4349 6056.06610   244%     -   31s
H    0     0                    -4205.166940 6055.70497   244%     -   32s
H    0     0                    -3829.157146 6055.70497   258%     -   33s
     0     0 6039.14922    0  532 -3829.1571 6039.14922   258%     -   33s
     0     0 6027.32720    0  533 -3829.1571 6027.32720   257%     -   33s
     0     0 6013.14844    0  533 -3829.1571 6013.14844   257%     -   34s
     0     0 6011.20005    0  543 -3829.1571 6011.20005   257%     -   34s
     0     0 6010.98560    0  548 -3829.1571 6010.98560   257%     -   34s
     0     0 5971.96790    0  530 -3829.1571 5971.96790   256%     -   35s
     0     0 5943.60119    0  546 -3829.1571 5943.60119   255%     -   36s
     0     0 5939.61974    0  550 -3829.1571 5939.61974   255%     -   36s
     0     0 5937.92915    0  547 -3829.1571 5937.92915   255%     -   36s
     0     0 5937.56856    0  545 -3829.1571 5937.56856   255%     -   36s
     0     0 5912.93031    0  610 -3829.1571 5912.93031   254%     -   37s
H    0     0                    -3829.083948 5912.91364   254%     -   37s
H    0     0                    -3829.075352 5912.91364   254%     -   37s
     0     0 5908.95036    0  612 -3829.0754 5908.95036   254%     -   38s
     0     0 5907.24589    0  617 -3829.0754 5907.24589   254%     -   38s
     0     0 5906.37885    0  613 -3829.0754 5906.37885   254%     -   38s
H    0     0                    -3750.938269 5896.86049   257%     -   38s
     0     0 5896.86049    0  610 -3750.9383 5896.86049   257%     -   38s
H    0     0                    -3749.716706 5896.77344   257%     -   39s
H    0     0                    -3739.502281 5896.77344   258%     -   39s
     0     0 5892.89652    0  609 -3739.5023 5892.89652   258%     -   39s
     0     0 5888.57480    0  557 -3739.5023 5888.57480   257%     -   39s
     0     0 5886.13920    0  616 -3739.5023 5886.13920   257%     -   39s
     0     0 5885.02451    0  620 -3739.5023 5885.02451   257%     -   39s
     0     0 5853.25498    0  619 -3739.5023 5853.25498   257%     -   41s
     0     0 5845.72009    0  618 -3739.5023 5845.72009   256%     -   41s
     0     0 5839.60493    0  623 -3739.5023 5839.60493   256%     -   41s
     0     0 5837.51771    0  626 -3739.5023 5837.51771   256%     -   42s
     0     0 5836.91768    0  570 -3739.5023 5836.91768   256%     -   42s
     0     0 5824.81506    0  634 -3739.5023 5824.81506   256%     -   43s
     0     0 5822.40090    0  581 -3739.5023 5822.40090   256%     -   43s
     0     0 5820.97460    0  640 -3739.5023 5820.97460   256%     -   43s
     0     0 5820.46652    0  641 -3739.5023 5820.46652   256%     -   43s
     0     0 5817.52679    0  578 -3739.5023 5817.52679   256%     -   44s
H    0     0                    -3731.971858 5817.31949   256%     -   45s
H    0     0                    -3727.253062 5817.31949   256%     -   45s
     0     0 5816.91575    0  587 -3727.2531 5816.91575   256%     -   45s
     0     0 5808.81239    0  577 -3727.2531 5808.81239   256%     -   45s
     0     0 5802.99056    0  583 -3727.2531 5802.99056   256%     -   46s
     0     0 5800.78927    0  648 -3727.2531 5800.78927   256%     -   46s
     0     0 5800.68636    0  648 -3727.2531 5800.68636   256%     -   46s
     0     0 5793.88537    0  576 -3727.2531 5793.88537   255%     -   47s
     0     0 5791.80916    0  579 -3727.2531 5791.80916   255%     -   47s
     0     0 5791.45104    0  589 -3727.2531 5791.45104   255%     -   47s
     0     0 5789.10710    0  587 -3727.2531 5789.10710   255%     -   47s
     0     0 5789.05912    0  588 -3727.2531 5789.05912   255%     -   48s
     0     0 5787.48930    0  590 -3727.2531 5787.48930   255%     -   48s
     0     0 5787.27844    0  587 -3727.2531 5787.27844   255%     -   48s
     0     0 5785.46127    0  590 -3727.2531 5785.46127   255%     -   49s
     0     0 5785.24265    0  590 -3727.2531 5785.24265   255%     -   49s
     0     2 5785.24265    0  590 -3727.2531 5785.24265   255%     -   57s
     7    16 5463.83098    3  582 -3727.2531 5636.95483   251%  1627   62s
    15    30 5192.32394    4  607 -3727.2531 5463.66297   247%  2805   65s
H   53    49                    1313.9476680 5090.67826   287%  2452   67s
    61    62 4798.74229    6  611 1313.94767 5090.67826   287%  2367   70s
H   63    62                    1345.6954399 5090.67826   278%  2327   70s
H   93    93                    1347.0366994 5078.09442   277%  1850   72s
H  114    93                    1402.5368536 5058.05871   261%  1800   72s
   176   119 4711.97127    9  568 1402.53685 5058.05871   261%  1446   75s
H  329   131                    1405.2130695 5011.67471   257%  1276   79s
   364   155     cutoff   11      1405.21307 5011.67471   257%  1239   81s
H  368   155                    1417.1623459 5011.67471   254%  1237   81s
   494   158 3697.04833   13  600 1417.16235 4802.29129   239%  1214   86s
   638   168 3133.66489   15  536 1417.16235 4724.64902   233%  1177   90s
   761   227 3023.60444   16  533 1417.16235 4714.05921   233%  1158   95s
   877   270 2270.19614   18  516 1417.16235 4714.05921   233%  1169  101s
  1013   331 2065.18089   19  432 1417.16235 4675.91264   230%  1171  105s
  1182   422     cutoff   20      1417.16235 4502.39537   218%  1145  110s
  1504   474     cutoff   26      1417.16235 4276.85813   202%  1064  116s
  1724   493 2268.40116   27  218 1417.16235 4244.22519   199%  1040  122s
  1995   522 1928.25653   23  160 1417.16235 4142.29595   192%   996  127s
  2127   510 1439.04187   15  216 1417.16235 4142.29595   192%   979  130s
H 2179   510                    1423.2886839 4142.29595   191%   971  130s
  2414   540 2266.18259   24  199 1423.28868 4142.29595   191%   940  135s
  2761   462 1899.90787   27  266 1423.28868 3691.06436   159%   906  140s
  3492   138     cutoff   29      1423.28868 2696.54296  89.5%   809  146s
H 4059   101                    1438.5823055 1979.94351  37.6%   719  148s
H 4143   101                    1440.8931999 1979.94351  37.4%   705  148s
H 4495    96                    1440.9893791 1954.02854  35.6%   655  149s
H 4745   238                    1441.5881835 1526.21969  5.87%   622  149s
  5461   172 1444.23353   32   32 1441.58818 1518.60996  5.34%   545  150s

Cutting planes:
  Implied bound: 11
  MIR: 262
  Flow cover: 764
  Zero half: 8
  RLT: 11
  Relax-and-lift: 34

Explored 7184 nodes (3106626 simplex iterations) in 151.30 seconds (409.82 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 1441.59 1440.99 1440.89 ... 1345.7

Optimal solution found (tolerance 1.00e-06)
Best objective 1.441588183489e+03, best bound 1.441588183489e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 151.31s
  Master Objective (UB) = 1441.59, θ = 113386.24
  Upper Bound (UB) = 1441.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113386.24
  [DEBUG]   ✓ Scenario 0: θ = 113386.24 ≤ Q = 113386.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113386.24 ≤ Q = 113386.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113386.24 ≤ Q = 113386.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35d41b50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca2be4b0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.472749e+13
Presolve removed 2594 rows and 1889 columns
Presolve time: 0.00s
Presolved: 499 rows, 500 columns, 1406 nonzeros
Found heuristic solution: objective 8285889.7621
Variable types: 336 continuous, 164 integer (164 binary)

Root relaxation: objective -1.163262e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116326.21    0  130 8285889.76 -116326.21   101%     -    0s
H    0     0                    -74318.91201 -116326.21  56.5%     -    0s
H    0     0                    -77263.06781 -116326.21  50.6%     -    0s
H    0     0                    -89882.29795 -116326.21  29.4%     -    0s
H    0     0                    -97130.13752 -116326.21  19.8%     -    0s
H    0     0                    -98178.77210 -106866.55  8.85%     -    0s
H    0     0                    -98589.07263 -106866.55  8.40%     -    0s
H    0     0                    -104285.2796 -106866.55  2.48%     -    0s
     0     0 -106866.55    0  121 -104285.28 -106866.55  2.48%     -    0s
H    0     0                    -104825.1773 -106650.13  1.74%     -    0s
     0     0 -106650.13    0  121 -104825.18 -106650.13  1.74%     -    0s
     0     0 -106268.72    0  108 -104825.18 -106268.72  1.38%     -    0s
H    0     0                    -105142.2346 -106169.71  0.98%     -    0s
     0     0 -105981.50    0   77 -105142.23 -105981.50  0.80%     -    0s
     0     0 -105955.14    0   86 -105142.23 -105955.14  0.77%     -    0s
     0     0 -105948.23    0   86 -105142.23 -105948.23  0.77%     -    0s
H    0     0                    -105148.8626 -105948.23  0.76%     -    0s
     0     0 -105587.22    0   52 -105148.86 -105587.22  0.42%     -    0s
     0     0 -105499.93    0   64 -105148.86 -105499.93  0.33%     -    0s
     0     0 -105475.26    0   30 -105148.86 -105475.26  0.31%     -    0s
     0     0 -105475.17    0   29 -105148.86 -105475.17  0.31%     -    0s
     0     0 -105458.00    0   55 -105148.86 -105458.00  0.29%     -    0s
     0     0 -105457.23    0   55 -105148.86 -105457.23  0.29%     -    0s
     0     0 -105338.53    0   23 -105148.86 -105338.53  0.18%     -    0s
     0     0 -105292.52    0   21 -105148.86 -105292.52  0.14%     -    0s
     0     0 -105291.87    0   23 -105148.86 -105291.87  0.14%     -    0s
     0     0 -105230.50    0   13 -105148.86 -105230.50  0.08%     -    0s
     0     0 -105218.70    0   11 -105148.86 -105218.70  0.07%     -    0s
     0     0 -105168.82    0    3 -105148.86 -105168.82  0.02%     -    0s
     0     0 -105163.69    0    2 -105148.86 -105163.69  0.01%     -    0s
H    0     0                    -105149.1544 -105163.69  0.01%     -    0s
     0     0 -105163.69    0    3 -105149.15 -105163.69  0.01%     -    0s
H    0     0                    -105160.6560 -105163.69  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 4
  MIR: 1
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (973 simplex iterations) in 0.10 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -105161 -105149 -105149 ... -89882.3
No other solutions better than -105161

Optimal solution found (tolerance 1.00e-06)
Best objective -1.051606559507e+05, best bound -1.051606559507e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 90311.68
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105160.66
  [DEBUG]   S×d_nominal = 195472.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195472.34 + -105160.66 = 90311.68
  [DEBUG]   Current θ from Master = 113386.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23074.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21632.97
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 6841.3181, Absolute Gap = 6841.3181, Relative Gap = 4.745681
  Not converged yet (gap = 6841.32 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x62c34e12
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -21633 (0.02s)
Loaded MIP start from previous solve with objective -21633

Presolve removed 27532 rows and 11182 columns
Presolve time: 0.46s
Presolved: 35011 rows, 16038 columns, 216459 nonzeros
Variable types: 13779 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35011 rows, 16038 columns, 216459 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42754    3.1808038e+03   0.000000e+00   7.359474e+05      5s
Concurrent spin time: 0.22s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 29906 iterations, 8.80 seconds (19.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -21632.969 12500.4674   158%     -    9s
H    0     0                    -20540.11240 12500.4674   161%     -    9s
H    0     0                    -20505.55656 12500.4674   161%     -    9s
H    0     0                    -7055.536634 12500.4674   277%     -    9s
H    0     0                    -4620.900470 12500.4674   371%     -    9s
H    0     0                    -4265.561058 12500.4674   393%     -    9s
H    0     0                    -4240.288381 8877.57275   309%     -   13s
     0     0 8469.88779    0  412 -4240.2884 8469.88779   300%     -   13s
     0     0 8234.56919    0  418 -4240.2884 8234.56919   294%     -   15s
     0     0 8234.56919    0  435 -4240.2884 8234.56919   294%     -   15s
     0     0 8234.56919    0  437 -4240.2884 8234.56919   294%     -   15s
     0     0 8234.56919    0  437 -4240.2884 8234.56919   294%     -   15s
     0     0 7200.73619    0  400 -4240.2884 7200.73619   270%     -   18s
H    0     0                    -4239.514358 7193.64330   270%     -   18s
H    0     0                    -4219.123971 6816.35057   262%     -   19s
     0     0 6816.35057    0  408 -4219.1240 6816.35057   262%     -   19s
     0     0 6780.51661    0  407 -4219.1240 6780.51661   261%     -   20s
     0     0 6764.74333    0  411 -4219.1240 6764.74333   260%     -   20s
     0     0 6744.87777    0  367 -4219.1240 6744.87777   260%     -   20s
H    0     0                    -4218.349949 6683.35041   258%     -   21s
     0     0 6683.35041    0  412 -4218.3499 6683.35041   258%     -   21s
     0     0 6680.63043    0  410 -4218.3499 6680.63043   258%     -   21s
     0     0 6678.98365    0  425 -4218.3499 6678.98365   258%     -   21s
     0     0 6678.66251    0  426 -4218.3499 6678.66251   258%     -   21s
     0     0 5206.83049    0  422 -4218.3499 5206.83049   223%     -   27s
     0     0 4977.59994    0  403 -4218.3499 4977.59994   218%     -   29s
     0     0 4594.49778    0  494 -4218.3499 4594.49778   209%     -   31s
     0     0 4389.08732    0  463 -4218.3499 4389.08732   204%     -   32s
     0     0 4344.31936    0  509 -4218.3499 4344.31936   203%     -   32s
     0     0 4274.10036    0  515 -4218.3499 4274.10036   201%     -   33s
     0     0 4255.14587    0  510 -4218.3499 4255.14587   201%     -   33s
     0     0 4251.03289    0  509 -4218.3499 4251.03289   201%     -   33s
     0     0 4250.97076    0  509 -4218.3499 4250.97076   201%     -   33s
     0     0 3726.31768    0  438 -4218.3499 3726.31768   188%     -   36s
     0     0 3610.95418    0  492 -4218.3499 3610.95418   186%     -   37s
     0     0 3562.84601    0  500 -4218.3499 3562.84601   184%     -   38s
     0     0 3450.50048    0  436 -4218.3499 3450.50048   182%     -   38s
     0     0 3423.06760    0  517 -4218.3499 3423.06760   181%     -   39s
     0     0 3415.26869    0  520 -4218.3499 3415.26869   181%     -   39s
     0     0 3409.04367    0  518 -4218.3499 3409.04367   181%     -   39s
     0     0 3409.02148    0  518 -4218.3499 3409.02148   181%     -   39s
     0     0 3289.09541    0  518 -4218.3499 3289.09541   178%     -   40s
     0     0 3184.25240    0  529 -4218.3499 3184.25240   175%     -   42s
     0     0 3176.00083    0  526 -4218.3499 3176.00083   175%     -   42s
     0     0 3164.95019    0  523 -4218.3499 3164.95019   175%     -   42s
     0     0 3159.46209    0  527 -4218.3499 3159.46209   175%     -   42s
     0     0 3157.19355    0  532 -4218.3499 3157.19355   175%     -   42s
     0     0 3156.50184    0  533 -4218.3499 3156.50184   175%     -   42s
     0     0 3105.88507    0  546 -4218.3499 3105.88507   174%     -   44s
     0     0 3098.78595    0  559 -4218.3499 3098.78595   173%     -   45s
     0     0 3098.12703    0  556 -4218.3499 3098.12703   173%     -   45s
     0     0 2995.78543    0  528 -4218.3499 2995.78543   171%     -   46s
     0     0 2947.58307    0  539 -4218.3499 2947.58307   170%     -   47s
     0     0 2943.22974    0  537 -4218.3499 2943.22974   170%     -   47s
     0     0 2940.53147    0  550 -4218.3499 2940.53147   170%     -   47s
     0     0 2940.08662    0  548 -4218.3499 2940.08662   170%     -   48s
     0     0 2899.09745    0  542 -4218.3499 2899.09745   169%     -   48s
     0     0 2889.20720    0  548 -4218.3499 2889.20720   168%     -   49s
     0     0 2887.42235    0  552 -4218.3499 2887.42235   168%     -   49s
     0     0 2874.37836    0  553 -4218.3499 2874.37836   168%     -   49s
     0     0 2872.43128    0  549 -4218.3499 2872.43128   168%     -   49s
     0     0 2870.76106    0  554 -4218.3499 2870.76106   168%     -   50s
     0     0 2870.66702    0  554 -4218.3499 2870.66702   168%     -   50s
     0     0 2859.49209    0  549 -4218.3499 2859.49209   168%     -   50s
     0     0 2857.35568    0  560 -4218.3499 2857.35568   168%     -   51s
     0     0 2829.83211    0  559 -4218.3499 2829.83211   167%     -   51s
     0     0 2818.90585    0  483 -4218.3499 2818.90585   167%     -   52s
     0     0 2817.54712    0  556 -4218.3499 2817.54712   167%     -   52s
     0     0 2817.02906    0  554 -4218.3499 2817.02906   167%     -   52s
     0     0 2806.60724    0  550 -4218.3499 2806.60724   167%     -   52s
     0     0 2806.35657    0  560 -4218.3499 2806.35657   167%     -   53s
     0     0 2798.35410    0  555 -4218.3499 2798.35410   166%     -   53s
     0     0 2795.68437    0  562 -4218.3499 2795.68437   166%     -   56s
     0     0 2795.32557    0  564 -4218.3499 2795.32557   166%     -   56s
     0     0 2789.57664    0  562 -4218.3499 2789.57664   166%     -   56s
     0     0 2788.50356    0  555 -4218.3499 2788.50356   166%     -   57s
     0     0 2787.09389    0  551 -4218.3499 2787.09389   166%     -   57s
     0     0 2786.55715    0  551 -4218.3499 2786.55715   166%     -   58s
H    0     0                    -4107.182620 2786.42960   168%     -   72s
H    0     0                    -4036.862156 2786.42960   169%     -   72s
H    0     0                    -4006.573521 2786.42960   170%     -   72s
     0     2 2786.42960    0  551 -4006.5735 2786.42960   170%     -   72s
     7    16 2229.95932    3  590 -4006.5735 2657.80726   166%  1473   76s
    31    58 1916.34226    5  601 -4006.5735 2093.92939   152%  2603   82s
    63    90 1811.68007    6  543 -4006.5735 1911.24151   148%  2330   85s
H   66    90                    -3986.527436 1911.24151   148%  2301   85s
H   70    90                    -3982.934241 1911.24151   148%  2257   85s
H   87    90                    -3972.825800 1911.24151   148%  2100   85s
   236   278 1275.03735    9  594 -3972.8258 1811.39171   146%  1440   92s
   306   346 1355.41543    9  580 -3972.8258 1771.12574   145%  1327   96s
   454   441 -1827.2052   11  588 -3972.8258 1771.12574   145%  1218  102s
   530   484  779.38716   12  528 -3972.8258 1771.12574   145%  1187  107s
   587   535 -298.43195   12  379 -3972.8258 1625.03674   141%  1194  111s
   690   601 -2715.0024   13  338 -3972.8258 1625.03674   141%  1192  118s
   747   622 -918.85257   14  386 -3972.8258 1625.03674   141%  1191  120s
   836   691   32.77712   15  621 -3972.8258 1551.90367   139%  1172  126s
   875   728 -1392.2565   15  275 -3972.8258 1551.90367   139%  1204  130s
   983   828 -1144.0409   17  596 -3972.8258 1551.90367   139%  1214  137s
  1068   885 -2077.0137   18  555 -3972.8258 1545.90079   139%  1196  140s
  1220   980 -2629.2809   19  504 -3972.8258 1500.01705   138%  1148  145s
  1407  1080 infeasible   22      -3972.8258 1463.59278   137%  1091  151s
  1544  1179     cutoff   24      -3972.8258 1463.59278   137%  1050  155s
  1752  1316 -2671.7986   14  391 -3972.8258 1463.59278   137%   985  161s
  1908  1401 -3387.1765   19  375 -3972.8258 1463.59278   137%   939  165s
  2080  1480 -3222.5234   18  145 -3972.8258 1345.47681   134%   901  170s
  2381  1593 -3134.6116    9  240 -3972.8258 1318.99146   133%   863  177s
  2505  1686 -3607.8365   11  244 -3972.8258 1310.84833   133%   862  181s
  2652  1811  298.75909   10  543 -3972.8258 1310.84833   133%   851  185s
  3044  2065 -880.16597   18  578 -3972.8258 1280.44560   132%   816  193s
  3271  2214 -1643.9026   21  527 -3972.8258 1280.44560   132%   800  198s
  3547  2317 -2260.8638   24  215 -3972.8258 1280.44560   132%   777  204s
  3792  2400 -2967.7834   31  289 -3972.8258 1077.53820   127%   773  208s
  4001  2470 -3833.0742   39  231 -3972.8258 1077.53820   127%   760  214s
  4194  2567 -1912.8365    9  373 -3972.8258  887.63243   122%   760  219s
  4388  2670 -2903.3542   16  365 -3972.8258  887.63243   122%   763  223s
  4651  2815 -1874.1444   12  421 -3972.8258  871.67296   122%   758  228s
  4939  2816 -370.75651   21  551 -3972.8258  871.67296   122%   749  246s
  4941  2817 -490.06981    8  362 -3972.8258  871.67296   122%   749  254s
  4942  2818 -3561.7026   34  456 -3972.8258  871.67296   122%   749  260s
  4944  2819 -1994.1038   16  523 -3972.8258  871.67296   122%   748  266s
  4947  2821 -3578.7593   31  545 -3972.8258  871.67296   122%   748  270s
  4954  2826 -2986.2250   14  594 -3972.8258  871.67296   122%   747  276s
  4956  2827 -2349.7217   36  595 -3972.8258  871.67296   122%   746  280s
  4962  2831 -811.45800   27  539 -3972.8258  871.67296   122%   746  285s
  4966  2834 -2852.1838   11  541 -3972.8258  871.67296   122%   745  290s
  4969  2836 -177.06795   17  556 -3972.8258  871.67296   122%   745  297s
  4971  2837 -1413.5455   12  550 -3972.8258  871.67296   122%   744  300s
  4975  2840 -1149.6757   27  567 -3972.8258  871.67296   122%   744  307s
  4977  2841 -346.00572   18  560 -3972.8258  871.67296   122%   743  310s
  4978  2842 -133.57848   16  560 -3972.8258  871.67296   122%   743  319s
  4979  2843 -1670.7964   22  560 -3972.8258  871.67296   122%   743  325s
  4980  2846  871.67296   11  533 -3972.8258  871.67296   122%   762  332s
  4982  2850  871.67296   12  511 -3972.8258  871.67296   122%   763  336s
  4986  2854  871.67296   13  508 -3972.8258  871.67296   122%   765  340s
  4994  2860  871.67296   14  530 -3972.8258  871.67296   122%   767  345s
  5008  2870  871.67296   15  527 -3972.8258  871.67296   122%   780  351s
  5029  2891  871.67296   16  527 -3972.8258  871.67296   122%   785  359s
  5061  2912 -637.59732   17  519 -3972.8258  871.67296   122%   810  365s
  5144  2931 -2951.2282   18  534 -3972.8258  871.67296   122%   843  374s
  5226  2944 -1477.3415   19  396 -3972.8258  871.67296   122%   854  379s
  5289  2966 -1576.9615   19  444 -3972.8258  871.67296   122%   874  383s
  5360  2968 -1719.9200   20  424 -3972.8258  742.68727   119%   885  387s
  5450  2964     cutoff   20      -3972.8258  603.65997   115%   890  390s
  5522  2961 -1812.7212   22  474 -3972.8258  447.30738   111%   897  396s
  5602  2947 infeasible   22      -3972.8258  352.05376   109%   903  401s
  5696  2946 -2272.3158   24  587 -3972.8258  352.05376   109%   915  408s
  5751  2939 -2158.7948   25  469 -3972.8258  352.05376   109%   916  411s
  5811  2938 -2216.6777   26  542 -3972.8258 -134.05890  96.6%   923  415s
  5953  2927 -2433.7985   28  404 -3972.8258 -134.05890  96.6%   930  423s
  6029  2901 -2622.7439   29  382 -3972.8258 -134.05890  96.6%   932  427s
  6117  2863     cutoff   29      -3972.8258 -259.08772  93.5%   937  431s
  6208  2847 -2725.9364   31  377 -3972.8258 -288.38337  92.7%   946  435s
  6384  2821     cutoff   36      -3972.8258 -288.38337  92.7%   957  444s
  6488  2799 -3144.6944   20  498 -3972.8258 -510.21893  87.2%   964  448s
  6617  2757 -3424.8776   24  380 -3972.8258 -510.21893  87.2%   971  453s
  6740  2711 -3739.9685   29  356 -3972.8258 -1284.3820  67.7%   975  458s
  6836  2693 -3863.6493   35  261 -3972.8258 -1285.8096  67.6%   980  462s
  6986  2634 -1778.9150   20  500 -3972.8258 -1285.8096  67.6%   980  467s
  7146  2554 -1956.4071   21  522 -3972.8258 -1387.9658  65.1%   981  472s
  7308  2473 -2312.2440   23  437 -3972.8258 -1387.9658  65.1%   986  477s
  7481  2388 -2601.8965   26  425 -3972.8258 -1387.9658  65.1%   988  483s
  7703  2282     cutoff   28      -3972.8258 -1453.1776  63.4%   983  489s
  7919  2135 -3631.5628   25  377 -3972.8258 -2061.5775  48.1%   977  494s
  8112  1960     cutoff   28      -3972.8258 -2061.5775  48.1%   972  498s
  8348  1788     cutoff   31      -3972.8258 -2433.2146  38.8%   962  501s
  8568  1650     cutoff   27      -3972.8258 -2578.1615  35.1%   949  506s

Cutting planes:
  Implied bound: 16
  MIR: 302
  Flow cover: 905
  Zero half: 1
  RLT: 16
  Relax-and-lift: 59

Explored 8693 nodes (8288520 simplex iterations) in 507.53 seconds (1391.20 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -3972.83 -3982.93 -3986.53 ... -4240.29
No other solutions better than -3972.83

Optimal solution found (tolerance 1.00e-06)
Best objective -3.972825800449e+03, best bound -3.972825800449e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 507.54s
  Master Objective (UB) = -3972.83, θ = 115916.16
  Upper Bound (UB) = -3972.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115916.16
  [DEBUG]   ✓ Scenario 0: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115916.16 ≤ Q = 115916.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115916.16 ≤ Q = 115916.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x148450b3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x148450b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270861e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 6980810.8539
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.162976e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116297.61    0  121 6980810.85 -116297.61   102%     -    0s
H    0     0                    -81024.48231 -116297.61  43.5%     -    0s
H    0     0                    -82656.36872 -116297.61  40.7%     -    0s
     0     0 -98925.447    0  103 -82656.369 -98925.447  19.7%     -    0s
H    0     0                    -94867.18314 -98888.468  4.24%     -    0s
H    0     0                    -96584.82362 -98888.468  2.39%     -    0s
     0     0 -98639.187    0  104 -96584.824 -98639.187  2.13%     -    0s
     0     0 -98584.777    0  102 -96584.824 -98584.777  2.07%     -    0s
     0     0 -98260.483    0  105 -96584.824 -98260.483  1.73%     -    0s
H    0     0                    -96885.49885 -98175.513  1.33%     -    0s
     0     0 -98175.513    0   97 -96885.499 -98175.513  1.33%     -    0s
     0     0 -98169.697    0  102 -96885.499 -98169.697  1.33%     -    0s
H    0     0                    -96919.06753 -98169.697  1.29%     -    0s
     0     0 -97981.323    0   85 -96919.068 -97981.323  1.10%     -    0s
H    0     0                    -96942.14671 -97977.996  1.07%     -    0s
     0     0 -97942.891    0   98 -96942.147 -97942.891  1.03%     -    0s
     0     0 -97869.798    0   67 -96942.147 -97869.798  0.96%     -    0s
     0     0 -97859.960    0   81 -96942.147 -97859.960  0.95%     -    0s
     0     0 -97656.986    0   74 -96942.147 -97656.986  0.74%     -    0s
     0     0 -97648.842    0   81 -96942.147 -97648.842  0.73%     -    0s
     0     0 -97578.336    0   62 -96942.147 -97578.336  0.66%     -    0s
     0     0 -97549.974    0   59 -96942.147 -97549.974  0.63%     -    0s
     0     0 -97549.370    0   59 -96942.147 -97549.370  0.63%     -    0s
     0     0 -97466.758    0   58 -96942.147 -97466.758  0.54%     -    0s
     0     0 -97457.345    0   58 -96942.147 -97457.345  0.53%     -    0s
     0     2 -97457.345    0   58 -96942.147 -97457.345  0.53%     -    0s
H    3     7                    -96956.51236 -97451.922  0.51%   9.3    0s
H   33    19                    -97007.00361 -97231.503  0.23%  22.7    0s
H   34    19                    -97027.57843 -97231.503  0.21%  22.1    0s
H   35    17                    -97093.41186 -97231.503  0.14%  21.7    0s

Cutting planes:
  Gomory: 24
  Implied bound: 1
  MIR: 140
  Flow cover: 6
  RLT: 70
  Relax-and-lift: 2
  BQP: 2

Explored 82 nodes (1820 simplex iterations) in 0.12 seconds (0.09 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -97093.4 -97027.6 -97007 ... -81024.5
No other solutions better than -97093.4

Optimal solution found (tolerance 1.00e-06)
Best objective -9.709341185717e+04, best bound -9.709341185717e+04, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 102630.58
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97093.41
  [DEBUG]   S×d_nominal = 199723.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199723.99 + -97093.41 = 102630.58
  [DEBUG]   Current θ from Master = 115916.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13285.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17258.41
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1426.9041, Absolute Gap = 1426.9041, Relative Gap = 0.359166
  Not converged yet (gap = 1426.90 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x8eaa74b7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34420 rows and 13980 columns
Presolve time: 0.59s
Presolved: 43413 rows, 19480 columns, 269179 nonzeros
Variable types: 17221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43413 rows, 19480 columns, 269179 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29352   -3.0841758e+03   0.000000e+00   3.018604e+06      5s
Concurrent spin time: 0.52s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 28602 iterations, 8.99 seconds (19.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -    9s
H    0     0                    -201986.3795 12500.4674   106%     -    9s
H    0     0                    -24246.51156 12500.4674   152%     -   10s
H    0     0                    -20885.29670 12500.4674   160%     -   10s
H    0     0                    -20505.55656 12500.4674   161%     -   10s
H    0     0                    -5617.695458 12500.4674   323%     -   10s
H    0     0                    -4518.605102 12500.4674   377%     -   10s
H    0     0                    -4265.561058 12500.4674   393%     -   10s
     0     0 8439.87917    0  423 -4265.5611 8439.87917   298%     -   16s
     0     0 8234.09809    0  411 -4265.5611 8234.09809   293%     -   18s
     0     0 8234.09809    0  420 -4265.5611 8234.09809   293%     -   18s
     0     0 8234.09809    0  427 -4265.5611 8234.09809   293%     -   19s
     0     0 8234.09809    0  430 -4265.5611 8234.09809   293%     -   19s
     0     0 8234.09809    0  428 -4265.5611 8234.09809   293%     -   19s
     0     0 8234.09809    0  437 -4265.5611 8234.09809   293%     -   19s
     0     0 8234.09809    0  437 -4265.5611 8234.09809   293%     -   19s
H    0     0                    -4254.587538 7199.28219   269%     -   24s
     0     0 7183.66874    0  394 -4254.5875 7183.66874   269%     -   24s
     0     0 6975.40486    0  425 -4254.5875 6975.40486   264%     -   25s
H    0     0                    -4253.813516 6769.28071   259%     -   27s
     0     0 6769.28071    0  358 -4253.8135 6769.28071   259%     -   28s
     0     0 6700.04070    0  413 -4253.8135 6700.04070   258%     -   28s
     0     0 6694.27233    0  417 -4253.8135 6694.27233   257%     -   29s
     0     0 6693.22915    0  423 -4253.8135 6693.22915   257%     -   29s
     0     0 6692.91007    0  421 -4253.8135 6692.91007   257%     -   29s
     0     0 5298.42892    0  398 -4253.8135 5298.42892   225%     -   37s
     0     0 4954.40230    0  398 -4253.8135 4954.40230   216%     -   40s
     0     0 4871.14023    0  396 -4253.8135 4871.14023   215%     -   41s
     0     0 4834.87540    0  398 -4253.8135 4834.87540   214%     -   42s
     0     0 4829.19210    0  413 -4253.8135 4829.19210   214%     -   42s
     0     0 4683.90536    0  399 -4253.8135 4683.90536   210%     -   44s
     0     0 4652.75197    0  412 -4253.8135 4652.75197   209%     -   44s
     0     0 4649.37514    0  418 -4253.8135 4649.37514   209%     -   44s
     0     0 4648.90875    0  420 -4253.8135 4648.90875   209%     -   44s
     0     0 4105.52044    0  527 -4253.8135 4105.52044   197%     -   48s
     0     0 3906.48722    0  524 -4253.8135 3906.48722   192%     -   50s
     0     0 3795.59270    0  511 -4253.8135 3795.59270   189%     -   51s
     0     0 3749.79482    0  510 -4253.8135 3749.79482   188%     -   52s
     0     0 3717.09288    0  517 -4253.8135 3717.09288   187%     -   52s
     0     0 3686.68616    0  522 -4253.8135 3686.68616   187%     -   53s
     0     0 3681.89797    0  534 -4253.8135 3681.89797   187%     -   53s
     0     0 3681.78920    0  533 -4253.8135 3681.78920   187%     -   53s
     0     0 3504.85197    0  533 -4253.8135 3504.85197   182%     -   56s
     0     0 3420.18153    0  538 -4253.8135 3420.18153   180%     -   57s
     0     0 3273.53062    0  520 -4253.8135 3273.53062   177%     -   59s
     0     0 3236.20796    0  511 -4253.8135 3236.20796   176%     -   60s
     0     0 3220.64863    0  528 -4253.8135 3220.64863   176%     -   61s
     0     0 3215.71606    0  522 -4253.8135 3215.71606   176%     -   62s
     0     0 3214.60672    0  525 -4253.8135 3214.60672   176%     -   62s
     0     0 3213.78460    0  541 -4253.8135 3213.78460   176%     -   62s
     0     0 3051.38097    0  526 -4253.8135 3051.38097   172%     -   65s
     0     0 3019.12424    0  539 -4253.8135 3019.12424   171%     -   67s
     0     0 3012.10437    0  552 -4253.8135 3012.10437   171%     -   67s
     0     0 3010.61798    0  557 -4253.8135 3010.61798   171%     -   68s
     0     0 3001.30400    0  544 -4253.8135 3001.30400   171%     -   68s
     0     0 3000.29651    0  554 -4253.8135 3000.29651   171%     -   68s
     0     0 2937.33639    0  545 -4253.8135 2937.33639   169%     -   70s
     0     0 2890.99188    0  597 -4253.8135 2890.99188   168%     -   71s
     0     0 2876.03821    0  541 -4253.8135 2876.03821   168%     -   71s
     0     0 2872.87777    0  595 -4253.8135 2872.87777   168%     -   71s
     0     0 2871.32652    0  603 -4253.8135 2871.32652   168%     -   71s
     0     0 2871.07311    0  600 -4253.8135 2871.07311   167%     -   71s
     0     0 2797.24403    0  543 -4253.8135 2797.24403   166%     -   73s
     0     0 2766.65507    0  605 -4253.8135 2766.65507   165%     -   77s
     0     0 2764.39263    0  601 -4253.8135 2764.39263   165%     -   77s
     0     0 2763.59269    0  608 -4253.8135 2763.59269   165%     -   77s
     0     0 2716.91340    0  567 -4253.8135 2716.91340   164%     -   79s
     0     0 2711.92071    0  567 -4253.8135 2711.92071   164%     -   79s
     0     0 2710.29983    0  566 -4253.8135 2710.29983   164%     -   79s
     0     0 2710.21920    0  572 -4253.8135 2710.21920   164%     -   79s
     0     0 2706.58799    0  570 -4253.8135 2706.58799   164%     -   80s
     0     0 2704.75019    0  578 -4253.8135 2704.75019   164%     -   80s
     0     0 2704.23295    0  578 -4253.8135 2704.23295   164%     -   81s
     0     0 2700.15807    0  578 -4253.8135 2700.15807   163%     -   81s
     0     0 2699.48377    0  570 -4253.8135 2699.48377   163%     -   82s
     0     0 2698.31924    0  622 -4253.8135 2698.31924   163%     -   83s
     0     0 2698.25362    0  622 -4253.8135 2698.25362   163%     -   83s
     0     2 2698.21195    0  622 -4253.8135 2698.21195   163%     -   94s
     1     4 2559.45417    1  616 -4253.8135 2698.21195   163%  1479   96s
     3     8 2332.58985    2  615 -4253.8135 2557.02045   160%  1802  100s
    15    32 2178.63745    4  617 -4253.8135 2252.94889   153%  2334  108s
    31    60 2113.43308    5  618 -4253.8135 2178.53709   151%  4149  111s
    63    92 2034.83238    6  621 -4253.8135 2113.16782   150%  2910  116s
    95   173 2002.37478    7  616 -4253.8135 2030.53782   148%  2515  122s
   237   252 1507.26641   10  551 -4253.8135 2030.53782   148%  1620  130s
   351   330 1936.29125   11  608 -4253.8135 1990.69704   147%  1660  139s
   411   363 1430.41207   14  542 -4253.8135 1935.62322   146%  1707  143s
   481   399 1206.77926   16  532 -4253.8135 1935.62322   146%  1596  147s
   540   432  870.35855   18  517 -4253.8135 1935.62322   146%  1579  151s
   599   466  626.07795   19  520 -4253.8135 1935.62322   146%  1548  156s
   725   558 -2688.8773   20  528 -4253.8135 1935.62322   146%  1474  164s
   786   588   -3.04143   21  588 -4253.8135 1935.62322   146%  1459  167s
   875   655 -470.70981   23  511 -4253.8135 1682.58818   140%  1428  172s
   912   713 -232.98441   23  576 -4253.8135 1682.58818   140%  1416  176s
  1065   909 -780.85940   28  479 -4253.8135 1669.61478   139%  1330  183s
  1199  1024 -983.66196   31  485 -4253.8135 1608.54138   138%  1238  188s
  1335  1112 -988.63843   32  482 -4253.8135 1596.46688   138%  1177  192s
  1451  1200 -1214.1589   33  494 -4253.8135 1596.46688   138%  1144  198s
  1591  1277 -1363.0160   35  494 -4253.8135 1596.46688   138%  1105  203s
  1748  1323 -3032.9468   39  277 -4253.8135 1569.94698   137%  1072  206s
  1860  1387 -2563.1060   40  237 -4253.8135 1506.61417   135%  1051  212s
  2013  1450 -2873.3268   45  203 -4253.8135 1506.61417   135%  1035  219s
  2151  1488 -3649.1128   56  183 -4253.8135 1466.38156   134%  1024  224s
  2223  1556 -3445.8234    7  200 -4253.8135 1466.38156   134%  1028  230s
  2330  1603     cutoff    8      -4253.8135 1466.38156   134%  1019  236s
  2450  1666 -794.49415   10  288 -4253.8135 1466.22536   134%  1015  243s
  2587  1740 -1230.8449   11  185 -4253.8135 1428.66440   134%  1008  250s
  2722  1791     cutoff   16      -4253.8135 1338.53827   131%  1008  257s
  2871  1878 -2360.2578   18   99 -4253.8135 1305.46309   131%  1004  261s
  3021  1921     cutoff   33      -4253.8135 1253.41409   129%   989  266s
  3157  1993  512.12158   10  390 -4253.8135 1253.41409   129%   987  272s
  3302  2066 -335.80758   15  368 -4253.8135 1226.90246   129%   987  278s
  3467  2195 -1584.7744   21  280 -4253.8135 1226.90246   129%   992  286s
  3660  2285 -3589.5739   35  239 -4253.8135 1226.90246   129%   984  293s
  3938  2340   30.24694   12  383 -4253.8135 1206.41842   128%   972  299s
  4119  2392 -724.91091   15  291 -4253.8135 1048.11229   125%   966  306s
  4292  2486 infeasible   19      -4253.8135 1008.91572   124%   962  315s
  4511  2562 infeasible   23      -4253.8135 1008.91572   124%   959  322s
  4722  2669 -3408.6074   28  186 -4253.8135 1008.91572   124%   964  331s
  5055  2739 -711.75906   14  369 -4253.8135  973.32211   123%   951  341s
  5350  2788 -1765.4795   20  301 -4253.8135  880.08056   121%   948  348s
  5528  2876 -3279.6783   11  498 -4253.8135  856.06908   120%   952  357s
  5756  2877 -1057.9955   23  622 -4253.8135  782.17029   118%   958  382s
  5758  2878 -2289.2876   33  362 -4253.8135  782.17029   118%   958  396s
  5759  2879 -2336.3899   19  441 -4253.8135  782.17029   118%   958  405s
  5761  2880 -2631.5540   46  483 -4253.8135  782.17029   118%   957  412s
  5763  2882 -729.16775   22  583 -4253.8135  782.17029   118%   957  418s
  5764  2882 -247.65427   16  595 -4253.8135  782.17029   118%   957  421s
  5766  2884 -2850.5926   32  547 -4253.8135  782.17029   118%   956  425s
  5769  2886 -2598.3036   40  556 -4253.8135  782.17029   118%   956  430s
  5772  2888 -3019.9457   19  546 -4253.8135  782.17029   118%   955  435s
  5777  2891 -2422.3732   21  656 -4253.8135  782.17029   118%   955  442s
  5779  2892 -2260.4510   17  548 -4253.8135  782.17029   118%   954  445s
  5782  2894  108.50272   17  543 -4253.8135  782.17029   118%   954  451s
  5784  2896 -106.20423   14  550 -4253.8135  782.17029   118%   953  455s
  5787  2898 -1229.9202   19  574 -4253.8135  782.17029   118%   953  460s
  5789  2899 -1819.8851   10  556 -4253.8135  782.17029   118%   953  465s
  5792  2901 -3685.1768   45  561 -4253.8135  782.17029   118%   952  471s
  5793  2902 -1394.2113   21  561 -4253.8135  782.17029   118%   952  486s
  5794  2902 -2736.7237   44  561 -4253.8135  782.17029   118%   952  495s
  5795  2906  782.17029   13  541 -4253.8135  782.17029   118%   974  508s
  5797  2909  782.17029   14  563 -4253.8135  782.17029   118%   975  514s
  5801  2916  782.17029   15  505 -4253.8135  782.17029   118%   977  521s
  5809  2929  782.17029   16  558 -4253.8135  782.17029   118%   982  530s
  5825  2939 -3343.6009   17  239 -4253.8135  782.17029   118%   996  546s
  5846  2943 -132.58815   18  472 -4253.8135  782.17029   118%  1020  553s
  5878  2975 -329.27542   19  452 -4253.8135  782.17029   118%  1029  563s
  5955  2999 -763.35492   21  458 -4253.8135  782.17029   118%  1048  570s
  6101  3016 -444.11420   20  482 -4253.8135  782.17029   118%  1061  582s
  6178  3011 -1062.0834   22  449 -4253.8135  782.17029   118%  1064  586s
H 6226  2849                    -4216.100621  782.17029   119%  1062  586s
  6261  2868 -3102.7547   22  460 -4216.1006  782.17029   119%  1061  594s
  6339  2851 -1059.5458   23  451 -4216.1006  782.17029   119%  1058  601s
  6404  2846 -1273.5271   24  439 -4216.1006  782.17029   119%  1059  609s
  6480  2842     cutoff   23      -4216.1006  782.17029   119%  1060  614s
  6515  2841 -1467.3319   26  455 -4216.1006  782.17029   119%  1063  619s
  6567  2854 -1643.6444   27  337 -4216.1006  782.17029   119%  1065  625s
  6625  2841 -1662.5027   28  331 -4216.1006  782.17029   119%  1065  630s
  6699  2832 -1734.7358   29  247 -4216.1006  782.17029   119%  1068  637s
  6760  2830 -1774.1303   30  241 -4216.1006  782.17029   119%  1069  644s
  6834  2823 -2058.7490   32  289 -4216.1006  782.17029   119%  1070  650s
  6997  2788 -2230.7640   35  277 -4216.1006  753.12604   118%  1070  661s
  7070  2774 -2527.9407   38  267 -4216.1006  596.37528   114%  1070  669s
  7166  2776 -2828.3783   42  286 -4216.1006  291.96612   107%  1074  676s
  7242  2762     cutoff   45      -4216.1006  142.35598   103%  1078  686s
  7341  2740 infeasible   46      -4216.1006  118.07388   103%  1080  694s
  7459  2715 -2856.5093   24  306 -4216.1006  118.07388   103%  1086  702s
  7571  2698 infeasible   25      -4216.1006  118.07388   103%  1090  710s
  7653  2685 -4082.9931   27  282 -4216.1006 -253.79153  94.0%  1095  717s
  7762  2659 -1479.9212   21  463 -4216.1006 -253.79153  94.0%  1101  726s
  7885  2645 -1791.4959   22  457 -4216.1006 -823.13556  80.5%  1104  734s
  8008  2589 -2689.7576   24  441 -4216.1006 -823.13556  80.5%  1104  743s
  8170  2574 -3037.5852   25  430 -4216.1006 -964.12636  77.1%  1103  750s
  8320  2555 -3362.9807   27  362 -4216.1006 -1357.9146  67.8%  1104  757s
  8505  2511 -3827.1792   30  321 -4216.1006 -1357.9146  67.8%  1099  764s
  8712  2448     cutoff   23      -4216.1006 -1587.0796  62.4%  1095  773s
  8928  2384 -3476.3694   27  260 -4216.1006 -1684.6398  60.0%  1092  781s
  9146  2309     cutoff   30      -4216.1006 -1762.1049  58.2%  1090  790s
  9203  2274 -3451.5514   30  273 -4216.1006 -1762.1049  58.2%  1090  797s
  9278  2235 -3463.6744   31  262 -4216.1006 -1874.4131  55.5%  1088  805s
  9369  2174 -3499.2877   32  246 -4216.1006 -1874.4131  55.5%  1084  813s
  9563  2044 -4127.1682   32  186 -4216.1006 -2126.2596  49.6%  1075  821s
  9854  1911     cutoff   29      -4216.1006 -2126.2596  49.6%  1065  830s
  9988  1821     cutoff   25      -4216.1006 -2126.2596  49.6%  1062  839s
 10281  1586 -3223.8577   23  370 -4216.1006 -2511.4099  40.4%  1052  849s
 10638  1264 -4177.8768   24  258 -4216.1006 -2630.1025  37.6%  1038  857s
 11102   987     cutoff   29      -4216.1006 -2921.5414  30.7%  1014  861s

Cutting planes:
  Gomory: 1
  Implied bound: 22
  Projected implied bound: 5
  MIR: 387
  Flow cover: 1434
  Zero half: 2
  RLT: 9
  Relax-and-lift: 75

Explored 11286 nodes (11454799 simplex iterations) in 861.32 seconds (2308.39 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4216.1 -4253.81 -4254.59 ... -201986
No other solutions better than -4216.1

Optimal solution found (tolerance 1.00e-06)
Best objective -4.216100621360e+03, best bound -4.216100621360e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 861.33s
  Master Objective (UB) = -4216.10, θ = 115995.20
  Upper Bound (UB) = -4216.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115995.20
  [DEBUG]   ✓ Scenario 0: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115995.20 ≤ Q = 115995.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115995.20 ≤ Q = 115995.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 115995.20 ≤ Q = 115995.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7afa8eda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7afa8eda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.283321e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7080275.9467
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.162287e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116228.65    0  121 7080275.95 -116228.65   102%     -    0s
H    0     0                    -80910.60613 -116228.65  43.7%     -    0s
H    0     0                    -82554.92556 -116228.65  40.8%     -    0s
     0     0 -98617.826    0  105 -82554.926 -98617.826  19.5%     -    0s
H    0     0                    -95523.65016 -98585.262  3.21%     -    0s
     0     0 -98445.942    0  106 -95523.650 -98445.942  3.06%     -    0s
     0     0 -98439.480    0  106 -95523.650 -98439.480  3.05%     -    0s
H    0     0                    -96822.93227 -98439.480  1.67%     -    0s
H    0     0                    -96868.65297 -98105.725  1.28%     -    0s
     0     0 -98105.725    0  109 -96868.653 -98105.725  1.28%     -    0s
     0     0 -98097.187    0  109 -96868.653 -98097.187  1.27%     -    0s
     0     0 -97824.847    0  101 -96868.653 -97824.847  0.99%     -    0s
     0     0 -97675.183    0   73 -96868.653 -97675.183  0.83%     -    0s
     0     0 -97639.907    0   76 -96868.653 -97639.907  0.80%     -    0s
     0     0 -97587.630    0   78 -96868.653 -97587.630  0.74%     -    0s
     0     0 -97585.931    0   78 -96868.653 -97585.931  0.74%     -    0s
     0     0 -97378.938    0   82 -96868.653 -97378.938  0.53%     -    0s
     0     0 -97350.374    0   72 -96868.653 -97350.374  0.50%     -    0s
     0     0 -97350.374    0   67 -96868.653 -97350.374  0.50%     -    0s
     0     0 -97250.822    0   64 -96868.653 -97250.822  0.39%     -    0s
     0     0 -97223.092    0   65 -96868.653 -97223.092  0.37%     -    0s
     0     0 -97222.378    0   65 -96868.653 -97222.378  0.37%     -    0s
     0     0 -97193.518    0   65 -96868.653 -97193.518  0.34%     -    0s
     0     0 -97187.081    0   65 -96868.653 -97187.081  0.33%     -    0s
H    0     0                    -96869.77811 -97187.081  0.33%     -    0s
H    0     0                    -96873.63606 -97187.081  0.32%     -    0s
     0     2 -97187.081    0   65 -96873.636 -97187.081  0.32%     -    0s
*   55     3              13    -96879.54623 -96894.820  0.02%   8.3    0s
*   62     0              14    -96893.60122 -96893.601  0.00%   7.6    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 153
  Flow cover: 22
  RLT: 40
  Relax-and-lift: 1

Explored 65 nodes (1188 simplex iterations) in 0.13 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -96893.6 -96879.5 -96873.6 ... 1.28332e+13
No other solutions better than -96893.6

Optimal solution found (tolerance 1.00e-06)
Best objective -9.689360121722e+04, best bound -9.689360121722e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 102807.98
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96893.60
  [DEBUG]   S×d_nominal = 199701.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199701.59 + -96893.60 = 102807.98
  [DEBUG]   Current θ from Master = 115995.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13187.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17403.32
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1183.6293, Absolute Gap = 1183.6293, Relative Gap = 0.280740
  Not converged yet (gap = 1183.63 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x388ee08a
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41288 rows and 16768 columns
Presolve time: 0.73s
Presolved: 51835 rows, 22932 columns, 321959 nonzeros
Variable types: 20673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -403085.5655
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51835 rows, 22932 columns, 321959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35214    3.8179440e+02   0.000000e+00   1.215379e+07      5s
   45896    6.2407657e+03   0.000000e+00   1.379296e+09     10s
Concurrent spin time: 0.83s

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 35732 iterations, 11.58 seconds (26.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -   12s
H    0     0                    -205738.3218 12500.4674   106%     -   12s
H    0     0                    -24246.51156 12500.4674   152%     -   12s
H    0     0                    -20885.29670 12500.4674   160%     -   12s
H    0     0                    -20505.55656 12500.4674   161%     -   12s
H    0     0                    -5617.695458 12500.4674   323%     -   13s
H    0     0                    -4727.634369 12500.4674   364%     -   13s
H    0     0                    -4265.561058 12500.4674   393%     -   13s
     0     0 8842.21611    0  405 -4265.5611 8842.21611   307%     -   18s
     0     0 8584.33190    0  400 -4265.5611 8584.33190   301%     -   20s
     0     0 8466.38822    0  408 -4265.5611 8466.38822   298%     -   20s
     0     0 8339.55188    0  420 -4265.5611 8339.55188   296%     -   21s
     0     0 8322.67312    0  420 -4265.5611 8322.67312   295%     -   21s
     0     0 7452.35687    0  407 -4265.5611 7452.35687   275%     -   25s
     0     0 7154.21104    0  356 -4265.5611 7154.21104   268%     -   28s
H    0     0                    -4254.587538 7118.40945   267%     -   28s
     0     0 7118.40945    0  405 -4254.5875 7118.40945   267%     -   28s
     0     0 6926.56951    0  342 -4254.5875 6926.56951   263%     -   30s
     0     0 6854.21328    0  339 -4254.5875 6854.21328   261%     -   31s
     0     0 6851.75406    0  343 -4254.5875 6851.75406   261%     -   31s
     0     0 6839.61850    0  350 -4254.5875 6839.61850   261%     -   31s
     0     0 6838.04898    0  344 -4254.5875 6838.04898   261%     -   31s
     0     0 6837.98781    0  344 -4254.5875 6837.98781   261%     -   31s
     0     0 5678.22692    0  376 -4254.5875 5678.22692   233%     -   39s
     0     0 5383.20207    0  391 -4254.5875 5383.20207   227%     -   42s
     0     0 5242.08902    0  396 -4254.5875 5242.08902   223%     -   44s
     0     0 5205.16087    0  497 -4254.5875 5205.16087   222%     -   44s
     0     0 5190.95576    0  398 -4254.5875 5190.95576   222%     -   45s
     0     0 5179.36790    0  491 -4254.5875 5179.36790   222%     -   45s
     0     0 5147.22223    0  406 -4254.5875 5147.22223   221%     -   46s
     0     0 5133.11916    0  410 -4254.5875 5133.11916   221%     -   46s
H    0     0                    -4253.813516 5073.47580   219%     -   48s
     0     0 5073.47580    0  403 -4253.8135 5073.47580   219%     -   48s
     0     0 5044.40319    0  414 -4253.8135 5044.40319   219%     -   48s
     0     0 5038.56709    0  414 -4253.8135 5038.56709   218%     -   49s
     0     0 5038.24225    0  408 -4253.8135 5038.24225   218%     -   49s
     0     0 4186.93362    0  514 -4253.8135 4186.93362   198%     -   55s
     0     0 3981.97370    0  507 -4253.8135 3981.97370   194%     -   57s
     0     0 3830.19641    0  450 -4253.8135 3830.19641   190%     -   59s
     0     0 3795.45813    0  505 -4253.8135 3795.45813   189%     -   60s
     0     0 3753.30718    0  506 -4253.8135 3753.30718   188%     -   61s
     0     0 3732.97573    0  523 -4253.8135 3732.97573   188%     -   62s
     0     0 3704.75793    0  524 -4253.8135 3704.75793   187%     -   62s
     0     0 3698.43499    0  522 -4253.8135 3698.43499   187%     -   63s
     0     0 3696.46146    0  525 -4253.8135 3696.46146   187%     -   63s
     0     0 3692.50172    0  519 -4253.8135 3692.50172   187%     -   63s
     0     0 3668.21862    0  535 -4253.8135 3668.21862   186%     -   64s
     0     0 3652.36877    0  522 -4253.8135 3652.36877   186%     -   65s
     0     0 3647.58269    0  534 -4253.8135 3647.58269   186%     -   65s
     0     0 3647.28015    0  533 -4253.8135 3647.28015   186%     -   65s
     0     0 3499.33350    0  538 -4253.8135 3499.33350   182%     -   68s
     0     0 3466.73028    0  562 -4253.8135 3466.73028   181%     -   69s
     0     0 3460.87161    0  482 -4253.8135 3460.87161   181%     -   69s
     0     0 3447.46747    0  565 -4253.8135 3447.46747   181%     -   70s
     0     0 3445.93022    0  567 -4253.8135 3445.93022   181%     -   70s
     0     0 3439.06807    0  562 -4253.8135 3439.06807   181%     -   70s
     0     0 3438.98271    0  560 -4253.8135 3438.98271   181%     -   70s
     0     0 3383.34951    0  476 -4253.8135 3383.34951   180%     -   72s
     0     0 3362.97654    0  564 -4253.8135 3362.97654   179%     -   75s
     0     0 3358.72908    0  560 -4253.8135 3358.72908   179%     -   76s
     0     0 3352.45183    0  486 -4253.8135 3352.45183   179%     -   76s
     0     0 3352.40569    0  486 -4253.8135 3352.40569   179%     -   77s
     0     0 3187.86796    0  594 -4253.8135 3187.86796   175%     -   79s
     0     0 3140.64805    0  596 -4253.8135 3140.64805   174%     -   81s
     0     0 3135.16928    0  605 -4253.8135 3135.16928   174%     -   81s
     0     0 3131.86877    0  617 -4253.8135 3131.86877   174%     -   81s
     0     0 3128.50094    0  614 -4253.8135 3128.50094   174%     -   82s
     0     0 3127.70784    0  613 -4253.8135 3127.70784   174%     -   82s
     0     0 3052.50252    0  564 -4253.8135 3052.50252   172%     -   83s
     0     0 3032.11390    0  583 -4253.8135 3032.11390   171%     -   87s
     0     0 3028.18857    0  584 -4253.8135 3028.18857   171%     -   87s
     0     0 3026.08952    0  580 -4253.8135 3026.08952   171%     -   87s
     0     0 3025.65395    0  585 -4253.8135 3025.65395   171%     -   87s
     0     0 3010.84503    0  489 -4253.8135 3010.84503   171%     -   88s
     0     0 2998.95097    0  567 -4253.8135 2998.95097   171%     -   89s
     0     0 2994.46691    0  579 -4253.8135 2994.46691   170%     -   90s
     0     0 2992.81963    0  582 -4253.8135 2992.81963   170%     -   90s
     0     0 2991.77863    0  578 -4253.8135 2991.77863   170%     -   90s
     0     0 2963.38747    0  574 -4253.8135 2963.38747   170%     -   91s
     0     0 2955.24221    0  584 -4253.8135 2955.24221   169%     -   91s
     0     0 2947.41465    0  575 -4253.8135 2947.41465   169%     -   92s
     0     0 2944.60777    0  580 -4253.8135 2944.60777   169%     -   92s
     0     0 2940.68901    0  577 -4253.8135 2940.68901   169%     -   92s
     0     0 2939.02798    0  575 -4253.8135 2939.02798   169%     -   92s
     0     0 2938.95669    0  580 -4253.8135 2938.95669   169%     -   93s
     0     0 2917.52843    0  499 -4253.8135 2917.52843   169%     -   94s
     0     0 2915.32729    0  589 -4253.8135 2915.32729   169%     -   94s
     0     0 2912.36234    0  597 -4253.8135 2912.36234   168%     -   94s
     0     0 2912.10773    0  589 -4253.8135 2912.10773   168%     -   94s
     0     0 2906.35067    0  586 -4253.8135 2906.35067   168%     -   95s
     0     0 2904.98533    0  592 -4253.8135 2904.98533   168%     -   96s
     0     0 2904.77394    0  594 -4253.8135 2904.77394   168%     -   96s
     0     0 2897.40077    0  582 -4253.8135 2897.40077   168%     -   97s
     0     0 2895.91048    0  587 -4253.8135 2895.91048   168%     -   98s
     0     0 2895.86497    0  591 -4253.8135 2895.86497   168%     -   98s
     0     0 2895.08167    0  595 -4253.8135 2895.08167   168%     -   98s
     0     0 2894.63158    0  595 -4253.8135 2894.63158   168%     -  100s
     0     2 2894.43149    0  595 -4253.8135 2894.43149   168%     -  127s
     1     4 2876.81575    1  585 -4253.8135 2892.48323   168%   660  132s
     3     8 2863.95612    2  582 -4253.8135 2876.76964   168%  3168  135s
     7    16 2779.18353    3  507 -4253.8135 2863.36966   167%  3048  141s
    15    30 2195.17491    4  566 -4253.8135 2778.95976   165%  4266  147s
    31    42 2501.94126    5  548 -4253.8135 2534.51586   160%  6053  163s
    47    63 2011.87080    6  532 -4253.8135 2534.51586   160%  6025  174s
    79   114 1863.93630    7  528 -4253.8135 2420.18264   157%  5022  187s
   155   170 1838.20480    8  526 -4253.8135 2294.80894   154%  3612  197s
   258   194 1675.96981    9  528 -4253.8135 2294.80894   154%  2979  204s
   334   240 1500.10210   10  504 -4253.8135 2294.80894   154%  2842  210s
   407   284 1344.10716   11  564 -4253.8135 2294.80894   154%  2790  216s
   478   319  962.91145   12  498 -4253.8135 2229.19522   152%  2694  222s
   555   347  922.74306   13  480 -4253.8135 2075.30132   149%  2656  229s
   615   400  726.65591   14  426 -4253.8135 2075.30132   149%  2683  236s
   686   440  667.48974   15  418 -4253.8135 2075.30132   149%  2664  242s
   741   495  294.54558   17  367 -4253.8135 2033.46059   148%  2681  247s
   811   534  137.21747   18  358 -4253.8135 2033.46059   148%  2649  251s
   876   573 -226.46020   19  306 -4253.8135 2033.46059   148%  2631  259s
   943   594 -655.97720   20  308 -4253.8135 1987.55886   147%  2600  264s
  1015   613 -826.77057   21  211 -4253.8135 1987.55886   147%  2554  271s
  1093   616 -1292.0907   22  195 -4253.8135 1934.79260   145%  2514  278s
  1177   649     cutoff   23      -4253.8135 1863.27304   144%  2520  284s
  1254   678     cutoff   24      -4253.8135 1832.41817   143%  2516  292s
  1337   712 -2709.9897   25  152 -4253.8135 1717.31560   140%  2527  299s
  1399   731 -3350.7081   26  281 -4253.8135 1717.31560   140%  2565  307s
  1454   748 -3636.8617   27  249 -4253.8135 1717.31560   140%  2603  314s
  1527   762     cutoff   30      -4253.8135 1559.25883   137%  2610  321s
  1621   792  -64.69550    9  403 -4253.8135 1559.25883   137%  2599  330s
  1699   823 -232.87952   11  312 -4253.8135 1497.25294   135%  2651  338s
  1783   862 -649.80510   13  251 -4253.8135 1496.45267   135%  2687  347s
  1886   900 -1386.0314   16  312 -4253.8135 1496.28981   135%  2702  355s
  1989   952 -2607.9395   20  272 -4253.8135 1359.05094   132%  2722  363s
  2101   968 -4226.0693   27  199 -4253.8135 1359.05094   132%  2723  372s
  2194  1022 -2089.2653    9  391 -4253.8135 1342.07246   132%  2717  382s
  2312  1064 -3172.8280   11  310 -4253.8135 1334.88815   131%  2700  394s
  2436  1126 -3436.5204   14  483 -4253.8135 1295.16237   130%  2710  403s
  2605  1193 -405.41503   10  441 -4253.8135 1295.16237   130%  2683  413s
  2740  1252 -716.66064   11  389 -4253.8135 1295.16237   130%  2707  425s
  2877  1327 -2684.7801   12  290 -4253.8135 1295.16237   130%  2735  436s
  3074  1383 -3151.4941   15  204 -4253.8135 1181.04643   128%  2705  449s
  3255  1422     cutoff   19      -4253.8135 1092.19179   126%  2702  460s
  3394  1491     cutoff   15      -4253.8135 1092.19179   126%  2695  470s
  3570  1560     cutoff   16      -4253.8135  889.46281   121%  2688  482s
  3753  1645 -1305.7880    9  317 -4253.8135  889.46281   121%  2685  495s
  4020  1660 -1630.4581   10  310 -4253.8135  776.14760   118%  2647  512s
  4069  1683 -1670.3841   11  257 -4253.8135  776.14760   118%  2654  542s
  4118  1686 -1864.4955   12  400 -4253.8135  776.14760   118%  2653  562s
  4190  1702 -1910.3340   13  392 -4253.8135  688.08441   116%  2660  575s
  4252  1725 -1935.6866   14  385 -4253.8135  610.45713   114%  2660  587s
  4339  1749 -1973.5670   15  387 -4253.8135  610.45713   114%  2655  598s
  4426  1767 -2215.3446   16  330 -4253.8135  485.72937   111%  2639  611s
  4482  1781 -2243.1898   17  276 -4253.8135  485.72937   111%  2637  622s
  4564  1819 infeasible   18      -4253.8135  485.72937   111%  2638  634s
  4684  1885 -2745.5717   19  400 -4253.8135  485.72937   111%  2626  646s
  4835  1907 -3137.8077   20  386 -4253.8135  358.01812   108%  2597  663s
  4945  1928 -3194.2612   21  351 -4253.8135  341.52753   108%  2584  678s
  5101  1981 -3229.3801   22  368 -4253.8135  332.24871   108%  2558  696s
  5235  1996 -3249.6725   23  317 -4253.8135  332.24871   108%  2543  712s
  5382  2005 -3367.1064   24  302 -4253.8135  326.04770   108%  2529  727s
  5544  2033 -3391.9150   25  258 -4253.8135  278.08176   107%  2521  744s
  5726  2064 -3523.6127   26  261 -4253.8135  154.68291   104%  2518  763s
  5961  2098 -3714.6473   27  267 -4253.8135  151.91652   104%  2499  780s
  6259  2185     cutoff   17      -4253.8135 -140.00135  96.7%  2483  801s
  6666  2202     cutoff   29      -4253.8135 -166.82047  96.1%  2464  820s
  7192  2230     cutoff   25      -4253.8135 -381.18906  91.0%  2421  840s
  7670  2261 -3482.2906   27  304 -4253.8135 -732.34808  82.8%  2389  859s
  8326  2185 -3461.8356   14  320 -4253.8135 -755.51599  82.2%  2331  879s
  8968  2175 -3720.4939   26  298 -4253.8135 -1352.7222  68.2%  2286  899s
  9447  2153 -3239.4470   16  396 -4253.8135 -1526.5147  64.1%  2249  926s
 10376  2006     cutoff   29      -4253.8135 -1843.8043  56.7%  2158  949s
 11614  1815     cutoff   31      -4253.8135 -2248.4480  47.1%  2028  969s
 13240  1152     cutoff   29      -4253.8135 -2441.5030  42.6%  1860  991s
 15328    84 -4073.2187   17  311 -4253.8135 -3070.8013  27.8%  1674 1007s
 17246    15     cutoff   14      -4253.8135 -3558.2306  16.4%  1519 1016s
 17323     0     cutoff   27      -4253.8135 -3831.3433  9.93%  1513 1024s

Cutting planes:
  Gomory: 2
  Implied bound: 24
  MIR: 396
  Flow cover: 1464
  Zero half: 5
  RLT: 29
  Relax-and-lift: 66

Explored 17350 nodes (26403476 simplex iterations) in 1024.81 seconds (2923.47 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4253.81 -4254.59 -4265.56 ... -211458
No other solutions better than -4253.81

Optimal solution found (tolerance 1.00e-06)
Best objective -4.253813515991e+03, best bound -4.253813515991e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1024.88s
  Master Objective (UB) = -4253.81, θ = 116970.77
  Upper Bound (UB) = -4253.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116970.77
  [DEBUG]   ✓ Scenario 0: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116970.77 ≤ Q = 116970.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116970.77 ≤ Q = 116970.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64244c2a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9bdbb3d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.303487e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7089054.6266
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.163647e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116364.71    0  121 7089054.63 -116364.71   102%     -    0s
H    0     0                    -81104.03043 -116364.71  43.5%     -    0s
H    0     0                    -82741.09133 -116364.71  40.6%     -    0s
     0     0 -93293.475    0  103 -82741.091 -93293.475  12.8%     -    0s
H    0     0                    -90183.83130 -93289.352  3.44%     -    0s
     0     0 -93085.408    0  107 -90183.831 -93085.408  3.22%     -    0s
     0     0 -93055.468    0  107 -90183.831 -93055.468  3.18%     -    0s
H    0     0                    -91525.56369 -93055.468  1.67%     -    0s
H    0     0                    -91552.36183 -93055.468  1.64%     -    0s
     0     0 -92996.395    0  107 -91552.362 -92996.395  1.58%     -    0s
     0     0 -92982.946    0  107 -91552.362 -92982.946  1.56%     -    0s
     0     2 -92982.946    0  107 -91552.362 -92982.946  1.56%     -    0s
H 3351   837                    -91559.96846 -91897.192  0.37%   3.6    0s
H 5079  1061                    -91565.47637 -91787.894  0.24%   3.6    0s
H 5137  1061                    -91566.34606 -91787.894  0.24%   3.6    0s

Cutting planes:
  Gomory: 102
  Implied bound: 2
  MIR: 216

Explored 9886 nodes (40089 simplex iterations) in 0.45 seconds (0.26 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -91566.3 -91565.5 -91560 ... 1.30349e+13
No other solutions better than -91566.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.156634605953e+04, best bound -9.156634605953e+04, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 109339.70
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91566.35
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -91566.35 = 109339.70
  [DEBUG]   Current θ from Master = 116970.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7631.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11884.88
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1145.9164, Absolute Gap = 1145.9164, Relative Gap = 0.269386
  Not converged yet (gap = 1145.92 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x899cfe95
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48156 rows and 19556 columns
Presolve time: 0.84s
Presolved: 60257 rows, 26384 columns, 374739 nonzeros
Variable types: 24125 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60257 rows, 26384 columns, 374739 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36456   -3.0212824e+04   0.000000e+00   6.337117e+07      5s
   46714   -2.1845707e+03   0.000000e+00   3.800844e+06     10s
   56360    4.0950154e+03   0.000000e+00   7.623134e+05     15s
   64210    4.9264167e+03   0.000000e+00   6.121832e+05     20s
   71168    6.1989143e+03   0.000000e+00   1.716686e+06     25s
Concurrent spin time: 6.33s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.250047e+04, 66604 iterations, 33.14 seconds (67.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12500.4674    0  362 -211458.27 12500.4674   106%     -   34s
H    0     0                    -205738.3218 12500.4674   106%     -   34s
H    0     0                    -24246.51156 12500.4674   152%     -   34s
H    0     0                    -20885.29670 12500.4674   160%     -   34s
H    0     0                    -20505.55656 12500.4674   161%     -   34s
H    0     0                    -15635.09650 12500.4674   180%     -   34s
H    0     0                    -4844.919863 12500.4674   358%     -   34s
H    0     0                    -4518.527142 12500.4674   377%     -   35s
H    0     0                    -4407.114750 12500.4674   384%     -   35s
     0     0 8875.74807    0  422 -4407.1148 8875.74807   301%     -   44s
H    0     0                    -4381.842072 8874.20925   303%     -   44s
H    0     0                    -4308.159327 8874.20925   306%     -   44s
     0     0 8683.39544    0  403 -4308.1593 8683.39544   302%     -   45s
     0     0 8440.84660    0  422 -4308.1593 8440.84660   296%     -   47s
     0     0 8408.97510    0  422 -4308.1593 8408.97510   295%     -   48s
     0     0 8408.97510    0  418 -4308.1593 8408.97510   295%     -   48s
     0     0 8331.04520    0  427 -4308.1593 8331.04520   293%     -   49s
     0     0 8331.04520    0  430 -4308.1593 8331.04520   293%     -   50s
     0     0 8331.04520    0  436 -4308.1593 8331.04520   293%     -   50s
     0     0 8331.04520    0  436 -4308.1593 8331.04520   293%     -   50s
H    0     0                    -4297.185806 8331.04520   294%     -   51s
     0     0 7050.24250    0  405 -4297.1858 7050.24250   264%     -   56s
     0     0 6995.47186    0  418 -4297.1858 6995.47186   263%     -   58s
     0     0 6780.35324    0  369 -4297.1858 6780.35324   258%     -   61s
     0     0 6751.87721    0  416 -4297.1858 6751.87721   257%     -   62s
     0     0 6738.37037    0  425 -4297.1858 6738.37037   257%     -   62s
     0     0 6737.79497    0  426 -4297.1858 6737.79497   257%     -   62s
     0     0 5525.26543    0  415 -4297.1858 5525.26543   229%     -   70s
H    0     0                    -4296.411784 5525.10231   229%     -   71s
     0     0 4899.10144    0  424 -4296.4118 4899.10144   214%     -   74s
     0     0 4578.65564    0  496 -4296.4118 4578.65564   207%     -   77s
     0     0 4534.67936    0  482 -4296.4118 4534.67936   206%     -   79s
     0     0 4508.44767    0  515 -4296.4118 4508.44767   205%     -   79s
     0     0 4475.42875    0  498 -4296.4118 4475.42875   204%     -   80s
     0     0 4427.94922    0  507 -4296.4118 4427.94922   203%     -   82s
     0     0 4419.72936    0  510 -4296.4118 4419.72936   203%     -   82s
     0     0 4418.22592    0  511 -4296.4118 4418.22592   203%     -   82s
     0     0 4416.43734    0  515 -4296.4118 4416.43734   203%     -   83s
     0     0 4408.85929    0  512 -4296.4118 4408.85929   203%     -   83s
     0     0 4407.96666    0  509 -4296.4118 4407.96666   203%     -   83s
     0     0 4404.57299    0  508 -4296.4118 4404.57299   203%     -   83s
     0     0 4403.26639    0  508 -4296.4118 4403.26639   202%     -   83s
     0     0 4403.23654    0  509 -4296.4118 4403.23654   202%     -   83s
     0     0 3969.20398    0  534 -4296.4118 3969.20398   192%     -   89s
     0     0 3663.46784    0  518 -4296.4118 3663.46784   185%     -   92s
     0     0 3603.67169    0  530 -4296.4118 3603.67169   184%     -   93s
     0     0 3587.98168    0  510 -4296.4118 3587.98168   184%     -   94s
     0     0 3573.65394    0  529 -4296.4118 3573.65394   183%     -   95s
     0     0 3567.29561    0  518 -4296.4118 3567.29561   183%     -   95s
     0     0 3555.70936    0  512 -4296.4118 3555.70936   183%     -   96s
     0     0 3549.02330    0  520 -4296.4118 3549.02330   183%     -   96s
     0     0 3537.58449    0  525 -4296.4118 3537.58449   182%     -   97s
     0     0 3530.18849    0  471 -4296.4118 3530.18849   182%     -   97s
     0     0 3513.14078    0  529 -4296.4118 3513.14078   182%     -   98s
     0     0 3510.85860    0  522 -4296.4118 3510.85860   182%     -   98s
     0     0 3510.03468    0  527 -4296.4118 3510.03468   182%     -   99s
     0     0 3387.67005    0  522 -4296.4118 3387.67005   179%     -  102s
     0     0 3366.49808    0  525 -4296.4118 3366.49808   178%     -  103s
     0     0 3357.96252    0  540 -4296.4118 3357.96252   178%     -  103s
     0     0 3352.02209    0  546 -4296.4118 3352.02209   178%     -  104s
     0     0 3348.85985    0  546 -4296.4118 3348.85985   178%     -  104s
     0     0 3344.48578    0  536 -4296.4118 3344.48578   178%     -  104s
     0     0 3344.43400    0  542 -4296.4118 3344.43400   178%     -  105s
     0     0 3279.17347    0  544 -4296.4118 3279.17347   176%     -  107s
     0     0 3249.20326    0  532 -4296.4118 3249.20326   176%     -  111s
     0     0 3246.21474    0  541 -4296.4118 3246.21474   176%     -  112s
     0     0 3240.48925    0  539 -4296.4118 3240.48925   175%     -  112s
     0     0 3237.26014    0  540 -4296.4118 3237.26014   175%     -  112s
     0     0 3236.20542    0  536 -4296.4118 3236.20542   175%     -  112s
     0     0 3170.31510    0  527 -4296.4118 3170.31510   174%     -  114s
     0     0 3158.64311    0  529 -4296.4118 3158.64311   174%     -  115s
     0     0 3155.73082    0  530 -4296.4118 3155.73082   173%     -  116s
     0     0 3148.01298    0  550 -4296.4118 3148.01298   173%     -  116s
     0     0 3147.31466    0  551 -4296.4118 3147.31466   173%     -  116s
     0     0 3114.97416    0  539 -4296.4118 3114.97416   173%     -  118s
     0     0 3101.27050    0  547 -4296.4118 3101.27050   172%     -  124s
     0     0 3090.60161    0  542 -4296.4118 3090.60161   172%     -  125s
     0     0 3082.97837    0  555 -4296.4118 3082.97837   172%     -  125s
     0     0 3081.76168    0  560 -4296.4118 3081.76168   172%     -  125s
     0     0 3081.21391    0  557 -4296.4118 3081.21391   172%     -  126s
     0     0 3059.99971    0  564 -4296.4118 3059.99971   171%     -  127s
     0     0 3054.74889    0  571 -4296.4118 3054.74889   171%     -  127s
     0     0 3053.65243    0  571 -4296.4118 3053.65243   171%     -  128s
     0     0 3028.89297    0  564 -4296.4118 3028.89297   170%     -  129s
     0     0 3024.02441    0  562 -4296.4118 3024.02441   170%     -  130s
     0     0 3022.62405    0  560 -4296.4118 3022.62405   170%     -  130s
     0     0 3022.32771    0  561 -4296.4118 3022.32771   170%     -  130s
     0     0 3015.27072    0  562 -4296.4118 3015.27072   170%     -  131s
     0     0 3011.31183    0  570 -4296.4118 3011.31183   170%     -  131s
     0     0 3009.92040    0  565 -4296.4118 3009.92040   170%     -  132s
     0     0 3009.76343    0  565 -4296.4118 3009.76343   170%     -  132s
     0     0 3005.88913    0  561 -4296.4118 3005.88913   170%     -  133s
     0     0 3004.29450    0  573 -4296.4118 3004.29450   170%     -  133s
     0     0 3003.49492    0  574 -4296.4118 3003.49492   170%     -  133s
     0     0 2999.20889    0  574 -4296.4118 2999.20889   170%     -  134s
     0     0 2997.53286    0  573 -4296.4118 2997.53286   170%     -  134s
     0     0 2997.29435    0  572 -4296.4118 2997.29435   170%     -  134s
     0     0 2995.60893    0  573 -4296.4118 2995.60893   170%     -  135s
     0     0 2995.56832    0  573 -4296.4118 2995.56832   170%     -  137s
     0     2 2995.21916    0  573 -4296.4118 2995.21916   170%     -  171s
     3     8 2746.70930    2  542 -4296.4118 2818.05133   166%  3911  177s
     7    16 2303.69643    3  560 -4296.4118 2745.18343   164%  3975  186s
    15    30 2144.52214    4  615 -4296.4118 2319.95733   154%  4941  190s
    31    42 -981.24632    5  512 -4296.4118 2214.06472   152%  6519  206s
    45    61     cutoff    6      -4296.4118 2214.06472   152%  7414  218s
    74   163     cutoff    6      -4296.4118 2214.06472   152%  5775  228s
   190   194     cutoff   12      -4296.4118 2144.13898   150%  3685  236s
   233   218  627.26543    6  332 -4296.4118 2144.13898   150%  3325  246s
   277   246  509.54602    7  326 -4296.4118 2144.13898   150%  3140  252s
   339   265  342.79063    8  328 -4296.4118 2144.13898   150%  2860  259s
   403   277  403.55179    7  326 -4296.4118 2144.13898   150%  2656  269s
   464   299 -1305.2073    9  400 -4296.4118 1927.87639   145%  2533  278s
   521   339  499.07206    7  329 -4296.4118 1927.87639   145%  2439  287s
   579   385  185.40627    8  324 -4296.4118 1927.87639   145%  2390  293s
   649   426 -1354.4451    9  325 -4296.4118 1927.87639   145%  2358  301s
   722   452     cutoff   10      -4296.4118 1927.87639   145%  2345  309s
   801   470     cutoff    8      -4296.4118 1798.04825   142%  2278  317s
   880   481 -2444.7281    6  128 -4296.4118 1798.04825   142%  2283  324s
   955   496 -2563.3884    7  134 -4296.4118 1798.04825   142%  2296  333s
  1037   499 -4023.1933   12   74 -4296.4118 1798.04825   142%  2292  341s
  1116   534 -1703.8519   11  466 -4296.4118 1798.04825   142%  2374  351s
  1175   573 -1821.7352   12  512 -4296.4118 1798.04825   142%  2465  359s
  1246   608 -2060.8649   13  438 -4296.4118 1798.04825   142%  2521  367s
  1331   647 -2799.3103   15  353 -4296.4118 1671.58504   139%  2545  376s
  1417   696 -3166.5066   17  416 -4296.4118 1567.37956   136%  2583  385s
  1506   711 -3291.1595   21  300 -4296.4118 1567.37956   136%  2589  393s
  1549   726 -3328.9628   22  301 -4296.4118 1520.25813   135%  2591  401s
  1602   752     cutoff   23      -4296.4118 1474.99394   134%  2607  409s
  1652   779 -3361.1737   19  329 -4296.4118 1474.99394   134%  2614  418s
  1694   811 -3361.5226   20  327 -4296.4118 1351.57352   131%  2624  424s
  1752   850 -3385.6955   21  265 -4296.4118 1351.57352   131%  2626  432s
  1831   881 -3506.4630   22  316 -4296.4118 1351.57352   131%  2595  441s
  1923   900 -3552.9779   23  216 -4296.4118 1349.08521   131%  2555  449s
  2024   914     cutoff   24      -4296.4118 1349.08521   131%  2544  459s
  2116   925     cutoff   23      -4296.4118 1315.22377   131%  2564  470s
  2209   955  834.94710   12  389 -4296.4118 1293.21186   130%  2577  481s
  2281   980  602.52185   13  288 -4296.4118 1293.21186   130%  2632  492s
  2396   987     cutoff   14      -4296.4118 1293.21186   130%  2632  502s
  2510  1008  260.80131   15  362 -4296.4118 1293.21186   130%  2647  514s
  2613  1075 -219.14476   17  405 -4296.4118 1293.21186   130%  2672  523s
  2758  1185 -1296.6574   22  278 -4296.4118 1003.65188   123%  2660  536s
  2965  1277 -2471.2820   27  299 -4296.4118  947.29742   122%  2621  549s
  3204  1374     cutoff   33      -4296.4118  809.41918   119%  2587  564s
  3443  1474     cutoff   19      -4296.4118  753.26609   118%  2567  577s
  3743  1518     cutoff   19      -4296.4118  530.10161   112%  2528  590s
  3959  1593 -562.53240   23  187 -4296.4118  511.92654   112%  2543  603s
  4179  1645 -2793.5754   18  352 -4296.4118  379.60712   109%  2570  618s
  4435  1718 -3308.4139   21  323 -4296.4118  379.60712   109%  2577  634s
  4705  1764     cutoff   25      -4296.4118  379.60712   109%  2565  647s
  4983  1840 -1969.2390    6  314 -4296.4118  379.60712   109%  2544  662s
  5165  1965 -4128.2775    7  418 -4296.4118 -139.32093  96.8%  2560  679s
  5472  1966 -1491.8635    8  573 -4296.4118 -142.27977  96.7%  2546  719s
  5474  1967 -2976.3908   39  362 -4296.4118 -142.27977  96.7%  2545  750s
  5475  1968 -2976.3908   39  470 -4296.4118 -142.27977  96.7%  2545  765s
  5476  1969 -3883.9938   25  498 -4296.4118 -142.27977  96.7%  2544  774s
  5477  1969 -3723.9083   57  527 -4296.4118 -142.27977  96.7%  2544  779s
  5478  1970 -2506.6622   13  467 -4296.4118 -142.27977  96.7%  2543  784s
  5479  1971 -1583.8791   10  539 -4296.4118 -142.27977  96.7%  2543  788s
  5480  1971 -2340.8460   30  539 -4296.4118 -142.27977  96.7%  2542  790s
  5482  1973 -3464.1950   20  526 -4296.4118 -142.27977  96.7%  2542  795s
  5486  1975 -1128.5667   14  537 -4296.4118 -142.27977  96.7%  2540  802s
  5487  1976 -2565.2505   26  549 -4296.4118 -142.27977  96.7%  2539  808s
  5488  1977 -2835.8130   19  552 -4296.4118 -142.27977  96.7%  2539  810s
  5491  1979 -3791.2121   26  546 -4296.4118 -142.27977  96.7%  2537  818s
  5492  1979 -3568.4596   10  545 -4296.4118 -142.27977  96.7%  2537  820s
  5494  1981 -2131.3322   26  614 -4296.4118 -142.27977  96.7%  2536  827s
  5496  1982 -3586.1168   31  568 -4296.4118 -142.27977  96.7%  2535  831s
  5499  1984 -3605.7721   40  556 -4296.4118 -142.27977  96.7%  2534  838s
  5500  1985 -655.01927   24  563 -4296.4118 -142.27977  96.7%  2533  840s
  5501  1985 -3211.2119   21  565 -4296.4118 -142.27977  96.7%  2533  845s
  5504  1987 -4002.7318   39  566 -4296.4118 -142.27977  96.7%  2531  851s
  5505  1988 -2432.0179    7  565 -4296.4118 -142.27977  96.7%  2531  856s
  5507  1989 -3254.6898   18  560 -4296.4118 -142.27977  96.7%  2530  861s
  5509  1991 -2739.6063   49  555 -4296.4118 -142.27977  96.7%  2529  866s
  5510  1991 -3947.3721   16  555 -4296.4118 -142.27977  96.7%  2529  895s
  5511  1992 -1512.3526   10  555 -4296.4118 -142.27977  96.7%  2528  912s
  5512  1996 -142.27977   15  607 -4296.4118 -142.27977  96.7%  2568  943s
  5514  1999 -142.27977   16  604 -4296.4118 -142.27977  96.7%  2569  949s
  5518  2006 -142.27977   17  588 -4296.4118 -142.27977  96.7%  2571  959s
  5526  2019 -142.27977   18  477 -4296.4118 -142.27977  96.7%  2573  970s
  5542  2025 -142.27977   19  446 -4296.4118 -142.27977  96.7%  2593  989s
  5560  2015 -142.27977   20  449 -4296.4118 -142.27977  96.7%  2612 1004s
  5592  2016 -1262.5808   21  368 -4296.4118 -142.27977  96.7%  2627 1018s
  5637  2025 -1365.1634   22  360 -4296.4118 -142.27977  96.7%  2663 1034s
  5679  2047 -1664.9963   23  397 -4296.4118 -142.27977  96.7%  2671 1050s
  5723  2038 -2499.9979   24  419 -4296.4118 -142.27977  96.7%  2688 1063s
  5791  2036 -2652.2267   25  415 -4296.4118 -142.27977  96.7%  2696 1075s
  5860  2041     cutoff   25      -4296.4118 -142.27977  96.7%  2704 1086s
  5930  2049 -3964.9989   28  277 -4296.4118 -142.27977  96.7%  2706 1098s
  6005  2041 -4206.5558   30  163 -4296.4118 -142.27977  96.7%  2704 1108s
  6044  2047     cutoff   31      -4296.4118 -142.27977  96.7%  2700 1125s
  6084  2055 -3242.3835   25  515 -4296.4118 -142.27977  96.7%  2700 1138s
  6133  2052 -3244.4195   26  516 -4296.4118 -142.27977  96.7%  2696 1148s
  6189  2039 -3327.9902   27  501 -4296.4118 -142.27977  96.7%  2693 1158s
  6249  2039 -3339.5822   28  496 -4296.4118 -142.27977  96.7%  2686 1168s
  6300  2035 -3511.8743   29  479 -4296.4118 -142.27977  96.7%  2685 1178s
  6357  2020     cutoff   30      -4296.4118 -142.27977  96.7%  2680 1189s
  6418  1999 -2472.4383   24  364 -4296.4118 -142.27977  96.7%  2677 1199s
  6484  1996 -3406.2525   25  365 -4296.4118 -142.27977  96.7%  2674 1212s
  6548  1987     cutoff   26      -4296.4118 -142.27977  96.7%  2665 1227s
  6612  1987 -3717.5341   26  354 -4296.4118 -142.27977  96.7%  2661 1239s
  6682  1982 -3800.1874   27  357 -4296.4118 -142.27977  96.7%  2654 1249s
  6753  1966     cutoff   28      -4296.4118 -142.27977  96.7%  2649 1262s
  6845  1923 -2340.4134   32  386 -4296.4118 -142.27977  96.7%  2642 1273s
  6948  1879 -2384.5034   33  379 -4296.4118 -142.27977  96.7%  2627 1285s
  7037  1837 -2399.7111   34  325 -4296.4118 -142.27977  96.7%  2618 1297s
  7143  1796 -2510.5509   35  435 -4296.4118 -381.03414  91.1%  2604 1310s
  7257  1730 -2663.9347   36  436 -4296.4118 -381.03414  91.1%  2590 1325s
  7401  1676     cutoff   36      -4296.4118 -381.03414  91.1%  2562 1339s
  7517  1597 -2723.3633   38  303 -4296.4118 -381.03414  91.1%  2555 1353s
  7697  1504 -3011.2385   39  306 -4296.4118 -381.03414  91.1%  2522 1367s
  7887  1402 -3093.5264   40  306 -4296.4118 -1030.4305  76.0%  2485 1380s
  8101  1316     cutoff   42      -4296.4118 -2127.1199  50.5%  2444 1393s
  8321  1161     cutoff   33      -4296.4118 -2409.7801  43.9%  2403 1407s
  8607   993     cutoff   42      -4296.4118 -2774.8812  35.4%  2346 1415s
  8765   916 -3891.5891   46  281 -4296.4118 -2779.1892  35.3%  2313 1424s
  8804   902 -3893.5417   47  277 -4296.4118 -3173.5458  26.1%  2305 1432s
  8821   891 -3900.9850   48  269 -4296.4118 -3338.5098  22.3%  2303 1439s
  8858   876 -4275.5016   55  203 -4296.4118 -3980.6911  7.35%  2295 1445s

Cutting planes:
  Gomory: 1
  MIR: 492
  Flow cover: 1492
  Zero half: 4
  RLT: 12
  Relax-and-lift: 83

Explored 8866 nodes (20542193 simplex iterations) in 1445.91 seconds (3851.49 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4296.41 -4297.19 -4308.16 ... -20885.3
No other solutions better than -4296.41

Optimal solution found (tolerance 1.00e-06)
Best objective -4.296411784230e+03, best bound -4.296411784230e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1445.92s
  Master Objective (UB) = -4296.41, θ = 116909.74
  Upper Bound (UB) = -4296.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116909.74
  [DEBUG]   ✓ Scenario 0: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116909.74 ≤ Q = 116909.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116909.74 ≤ Q = 116909.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5313a55e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5313a55e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.293740e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7005243.0121
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.164367e+05, 299 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116436.71    0  121 7005243.01 -116436.71   102%     -    0s
H    0     0                    -81165.05790 -116436.71  43.5%     -    0s
H    0     0                    -82802.11880 -116436.71  40.6%     -    0s
     0     0 -89089.729    0   40 -82802.119 -89089.729  7.59%     -    0s
H    0     0                    -88390.82839 -89033.500  0.73%     -    0s
     0     0 -88873.718    0   34 -88390.828 -88873.718  0.55%     -    0s
     0     0 -88776.919    0   18 -88390.828 -88776.919  0.44%     -    0s
H    0     0                    -88597.36761 -88766.774  0.19%     -    0s
H    0     0                    -88618.67217 -88766.774  0.17%     -    0s
     0     0 -88764.363    0   22 -88618.672 -88764.363  0.16%     -    0s
     0     0 -88739.556    0   14 -88618.672 -88739.556  0.14%     -    0s
     0     0 -88737.879    0   14 -88618.672 -88737.879  0.13%     -    0s
     0     0 -88737.140    0   14 -88618.672 -88737.140  0.13%     -    0s
     0     0 -88735.282    0   12 -88618.672 -88735.282  0.13%     -    0s
     0     0 -88734.138    0   12 -88618.672 -88734.138  0.13%     -    0s
     0     0     cutoff    0      -88618.672 -88618.672  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 8
  MIR: 110
  Flow cover: 5
  RLT: 18

Explored 1 nodes (548 simplex iterations) in 0.02 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -88618.7 -88597.4 -88390.8 ... 1.29374e+13
No other solutions better than -88618.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.861867216743e+04, best bound -8.861867216743e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 112287.37
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88618.67
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -88618.67 = 112287.37
  [DEBUG]   Current θ from Master = 116909.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4622.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8918.78
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1103.3181, Absolute Gap = 1103.3181, Relative Gap = 0.256800
  Not converged yet (gap = 1103.32 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x275b8408
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55044 rows and 22354 columns
Presolve time: 0.94s
Presolved: 68659 rows, 29826 columns, 427459 nonzeros
Variable types: 27567 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68659 rows, 29826 columns, 427459 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37916   -2.1690089e+04   0.000000e+00   3.301853e+06      5s
   48120    4.3509692e+02   0.000000e+00   8.105576e+07     10s
   54656    1.3501373e+03   0.000000e+00   1.526756e+07     15s
   62477    3.8180622e+03   0.000000e+00   8.936751e+07     20s
   69658    6.6810406e+03   0.000000e+00   3.245780e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.241465e+04, 58365 iterations, 28.00 seconds (64.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12414.6463    0  347 -211458.27 12414.6463   106%     -   29s
H    0     0                    -199177.5263 12414.6463   106%     -   29s
H    0     0                    -77283.42459 12414.6463   116%     -   29s
H    0     0                    -52310.89047 12414.6463   124%     -   29s
H    0     0                    -43356.84371 12414.6463   129%     -   29s
H    0     0                    -29046.58566 12414.6463   143%     -   29s
H    0     0                    -12926.15006 12414.6463   196%     -   30s
H    0     0                    -12335.95335 12414.6463   201%     -   30s
H    0     0                    -12144.61584 12414.6463   202%     -   30s
     0     0 7963.17236    0  445 -12144.616 7963.17236   166%     -   46s
H    0     0                    -12066.97661 7963.17236   166%     -   46s
H    0     0                    -12050.18964 7963.17236   166%     -   46s
     0     0 7963.17236    0  435 -12050.190 7963.17236   166%     -   49s
     0     0 7963.17236    0  436 -12050.190 7963.17236   166%     -   51s
     0     0 7963.17236    0  431 -12050.190 7963.17236   166%     -   51s
     0     0 7963.17236    0  439 -12050.190 7963.17236   166%     -   52s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   53s
     0     0 6821.06241    0  444 -12050.190 6821.06241   157%     -   53s
     0     0 6821.06241    0  446 -12050.190 6821.06241   157%     -   54s
     0     0 6821.06241    0  437 -12050.190 6821.06241   157%     -   54s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   54s
     0     0 6821.06241    0  441 -12050.190 6821.06241   157%     -   54s
     0     0 6821.06241    0  416 -12050.190 6821.06241   157%     -   62s
H    0     0                    -9886.364290 6821.06241   169%     -   63s
H    0     0                    -5884.786169 6821.06241   216%     -   63s
     0     0 6435.87968    0  379 -5884.7862 6435.87968   209%     -   70s
     0     0 6323.72455    0  393 -5884.7862 6323.72455   207%     -   72s
     0     0 6310.07814    0  399 -5884.7862 6310.07814   207%     -   73s
     0     0 6309.84621    0  398 -5884.7862 6309.84621   207%     -   73s
H    0     0                    -4816.959856 6309.84621   231%     -   76s
H    0     0                    -4758.323318 6309.84621   233%     -   76s
H    0     0                    -4689.185101 6309.84621   235%     -   76s
H    0     0                    -4467.227282 5759.17389   229%     -   81s
H    0     0                    -4408.915524 5759.17389   231%     -   81s
     0     0 5759.17389    0  438 -4408.9155 5759.17389   231%     -   81s
     0     0 5296.43066    0  489 -4408.9155 5296.43066   220%     -   85s
     0     0 5038.74819    0  487 -4408.9155 5038.74819   214%     -   88s
     0     0 4892.57685    0  501 -4408.9155 4892.57685   211%     -   90s
     0     0 4830.12333    0  564 -4408.9155 4830.12333   210%     -   92s
H    0     0                    -4396.141230 4799.91327   209%     -   93s
H    0     0                    -4395.367208 4799.91327   209%     -   93s
     0     0 4799.91327    0  556 -4395.3672 4799.91327   209%     -   94s
     0     0 4771.66783    0  556 -4395.3672 4771.66783   209%     -   95s
     0     0 4760.27665    0  558 -4395.3672 4760.27665   208%     -   96s
     0     0 4759.88662    0  556 -4395.3672 4759.88662   208%     -   96s
     0     0 4390.78948    0  527 -4395.3672 4390.78948   200%     -  102s
     0     0 4256.30609    0  462 -4395.3672 4256.30609   197%     -  106s
     0     0 4138.31123    0  541 -4395.3672 4138.31123   194%     -  108s
     0     0 4084.01963    0  469 -4395.3672 4084.01963   193%     -  110s
     0     0 4065.07263    0  551 -4395.3672 4065.07263   192%     -  112s
     0     0 4054.28284    0  469 -4395.3672 4054.28284   192%     -  113s
     0     0 4048.69163    0  560 -4395.3672 4048.69163   192%     -  113s
     0     0 4043.23172    0  474 -4395.3672 4043.23172   192%     -  114s
     0     0 4040.34453    0  482 -4395.3672 4040.34453   192%     -  114s
     0     0 4039.43906    0  485 -4395.3672 4039.43906   192%     -  115s
     0     0 3817.82764    0  566 -4395.3672 3817.82764   187%     -  118s
     0     0 3775.66679    0  555 -4395.3672 3775.66679   186%     -  120s
     0     0 3757.73242    0  557 -4395.3672 3757.73242   185%     -  121s
     0     0 3755.81477    0  575 -4395.3672 3755.81477   185%     -  121s
     0     0 3750.36524    0  568 -4395.3672 3750.36524   185%     -  121s
     0     0 3747.52907    0  555 -4395.3672 3747.52907   185%     -  122s
     0     0 3745.78375    0  561 -4395.3672 3745.78375   185%     -  122s
     0     0 3745.41622    0  564 -4395.3672 3745.41622   185%     -  122s
     0     0 3598.99104    0  551 -4395.3672 3598.99104   182%     -  126s
     0     0 3557.98663    0  558 -4395.3672 3557.98663   181%     -  133s
     0     0 3516.23101    0  577 -4395.3672 3516.23101   180%     -  134s
     0     0 3503.44244    0  569 -4395.3672 3503.44244   180%     -  135s
     0     0 3498.65292    0  574 -4395.3672 3498.65292   180%     -  136s
     0     0 3497.61310    0  576 -4395.3672 3497.61310   180%     -  136s
     0     0 3442.72113    0  590 -4395.3672 3442.72113   178%     -  138s
     0     0 3434.64688    0  592 -4395.3672 3434.64688   178%     -  139s
     0     0 3430.41399    0  591 -4395.3672 3430.41399   178%     -  140s
     0     0 3427.17026    0  597 -4395.3672 3427.17026   178%     -  140s
     0     0 3422.45168    0  589 -4395.3672 3422.45168   178%     -  141s
     0     0 3418.23362    0  589 -4395.3672 3418.23362   178%     -  141s
     0     0 3415.79103    0  594 -4395.3672 3415.79103   178%     -  141s
     0     0 3415.16634    0  595 -4395.3672 3415.16634   178%     -  142s
     0     0 3391.14631    0  611 -4395.3672 3391.14631   177%     -  144s
     0     0 3375.32380    0  602 -4395.3672 3375.32380   177%     -  145s
     0     0 3369.42162    0  607 -4395.3672 3369.42162   177%     -  146s
     0     0 3367.64136    0  601 -4395.3672 3367.64136   177%     -  146s
     0     0 3366.47388    0  608 -4395.3672 3366.47388   177%     -  146s
     0     0 3365.56886    0  604 -4395.3672 3365.56886   177%     -  146s
     0     0 3350.32476    0  603 -4395.3672 3350.32476   176%     -  148s
     0     0 3347.21532    0  606 -4395.3672 3347.21532   176%     -  150s
     0     0 3346.77332    0  609 -4395.3672 3346.77332   176%     -  150s
     0     0 3340.96198    0  519 -4395.3672 3340.96198   176%     -  152s
     0     0 3340.33214    0  613 -4395.3672 3340.33214   176%     -  154s
     0     0 3339.02996    0  615 -4395.3672 3339.02996   176%     -  155s
     0     0 3338.51848    0  526 -4395.3672 3338.51848   176%     -  156s
     0     0 3336.04312    0  537 -4395.3672 3336.04312   176%     -  157s
     0     0 3285.64817    0  650 -4395.3672 3285.64817   175%     -  160s
     0     0 3276.29018    0  613 -4395.3672 3276.29018   175%     -  162s
     0     0 3275.08713    0  621 -4395.3672 3275.08713   175%     -  162s
     0     0 3274.48619    0  618 -4395.3672 3274.48619   174%     -  163s
     0     0 3257.91824    0  614 -4395.3672 3257.91824   174%     -  165s
     0     0 3254.64395    0  615 -4395.3672 3254.64395   174%     -  166s
     0     0 3252.64267    0  613 -4395.3672 3252.64267   174%     -  167s
     0     0 3249.99331    0  619 -4395.3672 3249.99331   174%     -  167s
     0     0 3249.00049    0  611 -4395.3672 3249.00049   174%     -  168s
     0     0 3238.24375    0  611 -4395.3672 3238.24375   174%     -  169s
     0     0 3235.33455    0  615 -4395.3672 3235.33455   174%     -  202s
     0     0 3234.29029    0  608 -4395.3672 3234.29029   174%     -  203s
     0     0 3229.92878    0  613 -4395.3672 3229.92878   173%     -  205s
     0     0 3229.23340    0  623 -4395.3672 3229.23340   173%     -  206s
     0     0 3222.27481    0  610 -4395.3672 3222.27481   173%     -  208s
     0     0 3219.60998    0  610 -4395.3672 3219.60998   173%     -  209s
     0     0 3218.81701    0  617 -4395.3672 3218.81701   173%     -  209s
     0     0 3168.58603    0  578 -4395.3672 3168.58603   172%     -  212s
     0     0 3165.57665    0  588 -4395.3672 3165.57665   172%     -  212s
     0     0 3161.61088    0  593 -4395.3672 3161.61088   172%     -  213s
     0     0 3159.16502    0  591 -4395.3672 3159.16502   172%     -  213s
     0     0 3158.32656    0  598 -4395.3672 3158.32656   172%     -  213s
     0     0 3149.13976    0  595 -4395.3672 3149.13976   172%     -  215s
     0     0 3143.49536    0  599 -4395.3672 3143.49536   172%     -  216s
     0     0 3141.93789    0  600 -4395.3672 3141.93789   171%     -  216s
     0     0 3140.44828    0  601 -4395.3672 3140.44828   171%     -  216s
     0     0 3139.40038    0  611 -4395.3672 3139.40038   171%     -  216s
     0     0 3134.43124    0  608 -4395.3672 3134.43124   171%     -  218s
     0     0 3133.31934    0  607 -4395.3672 3133.31934   171%     -  219s
     0     0 3131.49638    0  613 -4395.3672 3131.49638   171%     -  220s
     0     0 3130.05533    0  609 -4395.3672 3130.05533   171%     -  220s
     0     0 3129.72337    0  614 -4395.3672 3129.72337   171%     -  220s
     0     0 3129.53620    0  611 -4395.3672 3129.53620   171%     -  221s
     0     0 3129.20270    0  611 -4395.3672 3129.20270   171%     -  223s
     0     2 3129.14149    0  611 -4395.3672 3129.14149   171%     -  246s
     3     8 3034.66938    2  578 -4395.3672 3055.07266   170%  2603  253s
     7    16 2785.62613    3  565 -4395.3672 3033.96653   169%  3539  257s
    15    32 2653.43836    4  586 -4395.3672 2787.64959   163%  4308  266s
    31    48 1539.78232    5  431 -4395.3672 2652.94778   160%  7126  325s
    47    80 1749.19896    6  549 -4395.3672 2652.94778   160%  6885  333s
    79   155 1728.88680    7  546 -4395.3672 2652.94778   160%  5560  349s
   156   269 1574.22817    9  510 -4395.3672 2652.94778   160%  3489  357s
   276   333 1627.84254   10  510 -4395.3672 2652.94778   160%  2551  366s
   362   374     cutoff   10      -4395.3672 2652.94778   160%  2320  375s
   451   380     cutoff   10      -4395.3672 2652.94778   160%  2119  385s
   531   383 1374.51748   11  501 -4395.3672 2652.94778   160%  2012  395s
   589   400 1408.21065   11  480 -4395.3672 2652.94778   160%  1993  403s
   647   414 1058.48961   12  437 -4395.3672 2652.94778   160%  1949  412s
   709   438  683.03262   13  404 -4395.3672 2652.94778   160%  1922  423s
   781   480  524.04697   15  443 -4395.3672 2652.94778   160%  1900  432s
   847   532  210.23261   18  275 -4395.3672 2652.94778   160%  1895  439s
   915   575 -235.83654   20  277 -4395.3672 2652.94778   160%  1883  448s
   986   620 -1541.8409   19  149 -4395.3672 2652.94778   160%  1878  457s
  1069   665 -346.15909   21  198 -4395.3672 2652.94778   160%  1851  464s
  1137   699     cutoff   22      -4395.3672 2652.94778   160%  1817  473s
  1230   741 -960.57806   21  262 -4395.3672 2652.94778   160%  1779  482s
  1310   769 -1354.8559   23  204 -4395.3672 2652.94778   160%  1777  493s
  1392   814     cutoff   25      -4395.3672 2652.94778   160%  1774  502s
  1475   842 -1529.7924   27  291 -4395.3672 2652.94778   160%  1789  508s
  1529   871 -1877.3191   28  248 -4395.3672 2652.94778   160%  1779  518s
  1588   911 -2523.7031   29  318 -4395.3672 2652.94778   160%  1782  527s
  1664   959 -4086.2676   28  122 -4395.3672 2652.94778   160%  1789  535s
  1771  1004 -2885.1553   30  271 -4395.3672 2652.94778   160%  1766  546s
  1887  1057 -3393.3563   32  235 -4395.3672 2652.94778   160%  1748  557s
  2025  1095     cutoff   37      -4395.3672 2652.94778   160%  1724  567s
  2171  1120     cutoff   10      -4395.3672 2587.03719   159%  1710  578s
  2264  1181     cutoff   11      -4395.3672 2587.03719   159%  1708  590s
  2405  1212 -738.86893    9  414 -4395.3672 2587.03719   159%  1691  603s
  2544  1265 -2175.7941   10  322 -4395.3672 2587.03719   159%  1686  616s
  2651  1324 -2268.4402   12  294 -4395.3672 2587.03719   159%  1707  629s
  2801  1411 -2773.4094   15  290 -4395.3672 2408.51388   155%  1704  642s
  2984  1435 -3078.7877   19  406 -4395.3672 1997.99179   145%  1696  650s
  3022  1474 -3333.0416   20  188 -4395.3672 1647.24487   137%  1707  661s
  3094  1504 -3370.0298   21  411 -4395.3672 1647.24487   137%  1703  672s
  3213  1553 -3560.4757   24  173 -4395.3672 1647.24487   137%  1698  686s
  3363  1629  385.50939   10  328 -4395.3672 1647.24487   137%  1701  700s
  3510  1710 infeasible   12      -4395.3672 1546.93614   135%  1718  716s
  3683  1740 -988.63840   11  214 -4395.3672 1546.93614   135%  1735  733s
  3873  1787 infeasible   16      -4395.3672 1460.86234   133%  1741  750s
  4070  1828     cutoff   19      -4395.3672 1422.02406   132%  1753  767s
  4277  1854     cutoff   23      -4395.3672 1398.73818   132%  1767  787s
  4511  1914 -3400.7672   14  366 -4395.3672 1398.73818   132%  1767  806s
  4727  1942 -4211.0863   17  364 -4395.3672 1337.51426   130%  1781  820s
  4789  1971     cutoff   18      -4395.3672 1337.51426   130%  1791  836s
  4886  2016     cutoff   19      -4395.3672 1337.51426   130%  1802  852s
  5042  2067 -2161.5750    8  330 -4395.3672 1254.16686   129%  1802  871s
  5229  2143 -3129.6534    9  341 -4395.3672 1254.16686   129%  1805  891s
  5485  2220     cutoff   10      -4395.3672 1157.86657   126%  1805  913s
  5771  2270 infeasible    9      -4395.3672 1080.36767   125%  1801  935s
  6040  2353 -2931.7594    9  196 -4395.3672  937.96067   121%  1809  960s
  6364  2484 -3804.1435   14  209 -4395.3672  766.12349   117%  1813  983s
  6804  2485 -1101.2550   16  611 -4395.3672  766.12349   117%  1788 1131s
  6806  2486 -3570.0588   30  347 -4395.3672  766.12349   117%  1787 1166s
  6807  2487 -1157.4628   12  497 -4395.3672  766.12349   117%  1787 1187s
  6808  2488 -3786.3182   34  502 -4395.3672  766.12349   117%  1787 1197s
  6809  2488 -644.38262   13  526 -4395.3672  766.12349   117%  1787 1204s
  6810  2489 -3156.8131   41  479 -4395.3672  766.12349   117%  1786 1210s
  6812  2490 -2810.2981   34  619 -4395.3672  766.12349   117%  1786 1220s
  6814  2492 -3332.6740   25  552 -4395.3672  766.12349   117%  1785 1226s
  6817  2494 -1327.4202   14  591 -4395.3672  766.12349   117%  1785 1232s
  6819  2495 -2123.9092   25  587 -4395.3672  766.12349   117%  1784 1235s
  6820  2496 -2808.0797   36  561 -4395.3672  766.12349   117%  1784 1241s
  6823  2498 -1487.9927   16  632 -4395.3672  766.12349   117%  1783 1247s
  6824  2498  -29.06468    8  571 -4395.3672  766.12349   117%  1783 1253s
  6825  2499 -1865.0777   19  566 -4395.3672  766.12349   117%  1783 1255s
  6828  2501 -2327.9973   21  557 -4395.3672  766.12349   117%  1782 1260s
  6829  2502 -2329.5300   19  552 -4395.3672  766.12349   117%  1781 1265s
  6831  2503  506.42194   12  555 -4395.3672  766.12349   117%  1781 1270s
  6832  2504 -3861.2834   29  549 -4395.3672  766.12349   117%  1781 1278s
  6833  2504 -3618.6283   33  543 -4395.3672  766.12349   117%  1780 1280s
  6834  2505 -3754.2742   18  612 -4395.3672  766.12349   117%  1780 1290s
  6836  2506 -1643.8365   14  557 -4395.3672  766.12349   117%  1780 1296s
  6837  2507 -2721.9170   24  551 -4395.3672  766.12349   117%  1779 1300s
  6839  2508 -771.99619   10  562 -4395.3672  766.12349   117%  1779 1307s
  6840  2509 -197.36415   17  567 -4395.3672  766.12349   117%  1779 1310s
  6842  2510 -3308.9463   39  570 -4395.3672  766.12349   117%  1778 1317s
  6843  2511 -2333.5675   27  587 -4395.3672  766.12349   117%  1778 1320s
  6844  2512 -3358.9204   34  587 -4395.3672  766.12349   117%  1778 1357s
  6845  2512 -957.23792   15  587 -4395.3672  766.12349   117%  1777 1382s
  6846  2516  766.12349   15  548 -4395.3672  766.12349   117%  1810 1428s
  6848  2519  766.12349   16  546 -4395.3672  766.12349   117%  1811 1446s
  6852  2526  766.12349   17  555 -4395.3672  766.12349   117%  1814 1458s
  6860  2539  766.12349   18  545 -4395.3672  766.12349   117%  1817 1470s
  6876  2549  766.12349   19  536 -4395.3672  766.12349   117%  1843 1500s
  6895  2560  766.12349   20  593 -4395.3672  766.12349   117%  1857 1519s
  6927  2625  766.12349   21  540 -4395.3672  766.12349   117%  1887 1538s
  7023  2644  766.12349   22  544 -4395.3672  766.12349   117%  1938 1556s
  7103  2630  766.12349   23  452 -4395.3672  766.12349   117%  1959 1570s
  7168  2623  233.66667   24  476 -4395.3672  766.12349   117%  1977 1589s
  7235  2614  199.03799   24  366 -4395.3672  766.12349   117%  1985 1600s
  7283  2617  188.71545   25  366 -4395.3672  766.12349   117%  2004 1609s
  7325  2621   69.70117   26  373 -4395.3672  766.12349   117%  2021 1622s
  7385  2613 -125.53424   27  342 -4395.3672  766.12349   117%  2028 1632s
  7438  2618 -375.01585   28  335 -4395.3672  766.12349   117%  2047 1646s
  7497  2620 -2799.4514   28  172 -4395.3672  766.12349   117%  2060 1657s
  7572  2633     cutoff   29      -4395.3672  766.12349   117%  2076 1666s
  7644  2638 -1133.1678   32  170 -4395.3672  766.12349   117%  2093 1682s
  7730  2618 -1592.0938   33  172 -4395.3672  766.12349   117%  2096 1694s
  7820  2608 -1757.8536   34  496 -4395.3672  766.12349   117%  2108 1707s
  7904  2592 -1822.6117   35  453 -4395.3672  766.12349   117%  2118 1719s
  7978  2595     cutoff   35      -4395.3672  766.12349   117%  2131 1735s
  8049  2591 -1907.0929   37  242 -4395.3672  766.12349   117%  2151 1753s
  8125  2602     cutoff   38      -4395.3672  766.12349   117%  2169 1768s
  8210  2613 infeasible   40      -4395.3672  766.12349   117%  2192 1781s
  8275  2605     cutoff   41      -4395.3672  766.12349   117%  2213 1797s
  8382  2579 -3726.5255   45  307 -4395.3672  766.12349   117%  2228 1811s
  8498  2580 -1187.5114   28  483 -4395.3672  766.12349   117%  2246 1830s
  8617  2571 -1524.3600   30  353 -4395.3672  766.12349   117%  2264 1848s
  8742  2538 -2108.8239   33  334 -4395.3672  766.12349   117%  2281 1860s
  8792  2548 -2493.0989   34  157 -4395.3672   -1.48334   100%  2297 1873s
  8882  2554 -2872.0439   35  219 -4395.3672 -136.13900  96.9%  2307 1890s
  8989  2581 -3944.2613   38  235 -4395.3672 -136.13900  96.9%  2316 1909s
  9145  2585 -1314.4782   22  243 -4395.3672 -523.85107  88.1%  2328 1930s
  9307  2569 -2863.9243   26  270 -4395.3672 -655.69541  85.1%  2340 1948s
  9474  2521 -3116.1196   30  271 -4395.3672 -707.72809  83.9%  2354 1967s
  9640  2501 -4140.7727   37  114 -4395.3672 -767.76507  82.5%  2372 1987s
  9822  2456 -2703.1884   29  410 -4395.3672 -767.76507  82.5%  2390 2008s
 10038  2383 -3710.1550   32  407 -4395.3672 -1085.8436  75.3%  2402 2029s
 10254  2339     cutoff   34      -4395.3672 -1085.8436  75.3%  2409 2051s
 10488  2271 -3389.2165   26  426 -4395.3672 -1218.7963  72.3%  2405 2076s
 10743  2189 -4111.7595   31  342 -4395.3672 -1367.7744  68.9%  2411 2103s
 11014  2101 -2077.8473   33  230 -4395.3672 -1460.7385  66.8%  2414 2125s
 11206  1998 -2922.9734   39  282 -4395.3672 -1688.6340  61.6%  2432 2150s
 11510  1817 -4190.6480   26  172 -4395.3672 -1879.5234  57.2%  2430 2176s
 11856  1590 -3140.2213   23  530 -4395.3672 -2203.2486  49.9%  2421 2204s
 12257  1287     cutoff   34      -4395.3672 -2400.1615  45.4%  2408 2229s
 12772   680 -4169.3778   45  180 -4395.3672 -2421.0208  44.9%  2375 2248s
 13485   315 -4158.8326   25  431 -4395.3672 -3080.3280  29.9%  2298 2266s
 13656   242     cutoff   33      -4395.3672 -3538.1098  19.5%  2280 2274s

Cutting planes:
  Gomory: 2
  Implied bound: 66
  Projected implied bound: 7
  MIR: 562
  Flow cover: 2168
  Zero half: 1
  RLT: 8
  Relax-and-lift: 103

Explored 13700 nodes (31451100 simplex iterations) in 2274.96 seconds (5951.45 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4395.37 -4396.14 -4408.92 ... -12050.2
No other solutions better than -4395.37

Optimal solution found (tolerance 1.00e-06)
Best objective -4.395367207764e+03, best bound -4.395367207764e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2275.00s
  Master Objective (UB) = -4395.37, θ = 116688.61
  Upper Bound (UB) = -4395.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116688.61
  [DEBUG]   ✓ Scenario 0: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116688.61 ≤ Q = 116688.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116688.61 ≤ Q = 116688.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116688.61 ≤ Q = 116730.71 (slack: 42.10)
  [DEBUG]   ✓ Scenario 7: θ = 116688.61 ≤ Q = 116688.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf9c0122
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf063fede
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.299970e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 7051692.7350
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.166251e+05, 303 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116625.06    0  121 7051692.74 -116625.06   102%     -    0s
H    0     0                    -81417.84641 -116625.06  43.2%     -    0s
H    0     0                    -83023.25264 -116625.06  40.5%     -    0s
     0     0 -89746.494    0   50 -83023.253 -89746.494  8.10%     -    0s
H    0     0                    -88051.20167 -89728.287  1.90%     -    0s
H    0     0                    -88094.62004 -89728.287  1.85%     -    0s
H    0     0                    -88622.72556 -89728.287  1.25%     -    0s
H    0     0                    -88666.14394 -89728.287  1.20%     -    0s
     0     0 -89535.943    0   43 -88666.144 -89535.943  0.98%     -    0s
     0     0 -89326.959    0   18 -88666.144 -89326.959  0.75%     -    0s
H    0     0                    -88963.23745 -89326.959  0.41%     -    0s
H    0     0                    -88971.58987 -89326.959  0.40%     -    0s
     0     0 -89133.957    0   14 -88971.590 -89133.957  0.18%     -    0s
     0     0 -89096.144    0   15 -88971.590 -89096.144  0.14%     -    0s
     0     0 -89085.050    0   14 -88971.590 -89085.050  0.13%     -    0s
     0     0 -89079.935    0   14 -88971.590 -89079.935  0.12%     -    0s
     0     0 -89077.612    0   14 -88971.590 -89077.612  0.12%     -    0s
     0     0 -89076.557    0   14 -88971.590 -89076.557  0.12%     -    0s
     0     0 -89076.503    0   14 -88971.590 -89076.503  0.12%     -    0s
     0     0 -89019.561    0    6 -88971.590 -89019.561  0.05%     -    0s
     0     0 -88995.363    0    7 -88971.590 -88995.363  0.03%     -    0s
H    0     0                    -88973.88284 -88995.363  0.02%     -    0s
     0     0 -88981.396    0    3 -88973.883 -88981.396  0.01%     -    0s
     0     0 -88974.828    0    2 -88973.883 -88974.828  0.00%     -    0s
*    0     0               0    -88974.73562 -88974.736  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 2
  Relax-and-lift: 1

Explored 1 nodes (638 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -88974.7 -88973.9 -88971.6 ... 1.29997e+13
No other solutions better than -88974.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.897473561504e+04, best bound -8.897473561504e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 111931.31
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88974.74
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -88974.74 = 111931.31
  [DEBUG]   Current θ from Master = 116688.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4757.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9152.67
  Lower Bound (LB) = -5399.73
  Gap (UB-LB) = 1004.3627, Absolute Gap = 1004.3627, Relative Gap = 0.228505
  Not converged yet (gap = 1004.36 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0xe32f5fa1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61952 rows and 25162 columns
Presolve time: 0.97s
Presolved: 77041 rows, 33258 columns, 472919 nonzeros
Variable types: 30999 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -410141.1274
Found heuristic solution: objective -405176.3109
Found heuristic solution: objective -211458.2747

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77041 rows, 33258 columns, 472919 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35059   -4.4918105e+04   0.000000e+00   1.178974e+08      5s
   48077   -2.8765949e+03   0.000000e+00   7.681873e+07     10s
   55213   -6.5697640e+02   0.000000e+00   1.150219e+07     15s
   63747    2.9586929e+03   0.000000e+00   2.225462e+06     20s
   70302    3.7984550e+03   0.000000e+00   1.019067e+06     25s
   75666    4.1236886e+03   0.000000e+00   5.932632e+06     30s
   81507    5.4884665e+03   0.000000e+00   1.374492e+06     35s
Concurrent spin time: 9.31s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.241642e+04, 72360 iterations, 44.69 seconds (85.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12416.4242    0  413 -211458.27 12416.4242   106%     -   46s
H    0     0                    -207203.4283 12416.4242   106%     -   46s
H    0     0                    -42617.90166 12416.4242   129%     -   46s
H    0     0                    -16044.61378 12416.4242   177%     -   46s
H    0     0                    -15827.69812 12416.4242   178%     -   46s
H    0     0                    -7234.520077 12416.4242   272%     -   48s
H    0     0                    -7144.183205 12416.4242   274%     -   48s
     0     0 8291.63856    0  493 -7144.1832 8291.63856   216%     -   62s
H    0     0                    -7042.010560 8291.63856   218%     -   62s
H    0     0                    -6349.202019 8291.63856   231%     -   62s
     0     0 7971.64963    0  488 -6349.2020 7971.64963   226%     -   66s
     0     0 7971.64963    0  505 -6349.2020 7971.64963   226%     -   70s
     0     0 7971.64963    0  500 -6349.2020 7971.64963   226%     -   71s
     0     0 7971.64963    0  497 -6349.2020 7971.64963   226%     -   74s
     0     0 7971.64963    0  507 -6349.2020 7971.64963   226%     -   75s
     0     0 6672.54756    0  515 -6349.2020 6672.54756   205%     -   76s
     0     0 6672.54756    0  511 -6349.2020 6672.54756   205%     -   76s
     0     0 6632.34594    0  482 -6349.2020 6632.34594   204%     -   92s
H    0     0                    -4864.679375 6631.80895   236%     -   92s
H    0     0                    -4451.513792 6631.80895   249%     -   92s
     0     0 6416.51360    0  370 -4451.5138 6416.51360   244%     -  100s
     0     0 6199.67535    0  487 -4451.5138 6199.67535   239%     -  106s
     0     0 6186.17089    0  570 -4451.5138 6186.17089   239%     -  109s
     0     0 6073.99752    0  383 -4451.5138 6073.99752   236%     -  113s
     0     0 6061.48186    0  390 -4451.5138 6061.48186   236%     -  115s
     0     0 6059.57110    0  389 -4451.5138 6059.57110   236%     -  115s
     0     0 6058.44329    0  385 -4451.5138 6058.44329   236%     -  116s
     0     0 6058.28632    0  387 -4451.5138 6058.28632   236%     -  116s
     0     0 4982.57955    0  404 -4451.5138 4982.57955   212%     -  131s
     0     0 4767.48157    0  475 -4451.5138 4767.48157   207%     -  135s
     0     0 4735.17461    0  398 -4451.5138 4735.17461   206%     -  137s
H    0     0                    -4438.739498 4552.68104   203%     -  142s
     0     0 4552.68104    0  495 -4438.7395 4552.68104   203%     -  142s
     0     0 4499.95499    0  650 -4438.7395 4499.95499   201%     -  145s
     0     0 4438.25978    0  644 -4438.7395 4438.25978   200%     -  148s
     0     0 4426.47484    0  507 -4438.7395 4426.47484   200%     -  150s
     0     0 4405.69823    0  505 -4438.7395 4405.69823   199%     -  152s
     0     0 4400.44145    0  503 -4438.7395 4400.44145   199%     -  153s
     0     0 4399.39622    0  501 -4438.7395 4399.39622   199%     -  153s
     0     0 4398.57514    0  505 -4438.7395 4398.57514   199%     -  154s
     0     0 4077.73469    0  654 -4438.7395 4077.73469   192%     -  164s
H    0     0                    -4437.965476 4077.58918   192%     -  165s
     0     0 3917.87719    0  647 -4437.9655 3917.87719   188%     -  169s
     0     0 3843.59961    0  675 -4437.9655 3843.59961   187%     -  172s
     0     0 3830.83251    0  613 -4437.9655 3830.83251   186%     -  173s
     0     0 3825.63109    0  680 -4437.9655 3825.63109   186%     -  174s
     0     0 3819.52389    0  681 -4437.9655 3819.52389   186%     -  175s
     0     0 3814.06456    0  682 -4437.9655 3814.06456   186%     -  176s
     0     0 3801.98147    0  689 -4437.9655 3801.98147   186%     -  177s
     0     0 3801.05559    0  696 -4437.9655 3801.05559   186%     -  178s
     0     0 3660.70868    0  534 -4437.9655 3660.70868   182%     -  182s
     0     0 3628.20684    0  544 -4437.9655 3628.20684   182%     -  185s
     0     0 3589.48903    0  616 -4437.9655 3589.48903   181%     -  187s
     0     0 3580.45368    0  556 -4437.9655 3580.45368   181%     -  189s
     0     0 3576.27069    0  553 -4437.9655 3576.27069   181%     -  190s
     0     0 3575.14234    0  555 -4437.9655 3575.14234   181%     -  190s
     0     0 3532.30483    0  560 -4437.9655 3532.30483   180%     -  194s
     0     0 3522.15586    0  490 -4437.9655 3522.15586   179%     -  198s
     0     0 3515.05985    0  570 -4437.9655 3515.05985   179%     -  200s
     0     0 3512.03597    0  702 -4437.9655 3512.03597   179%     -  201s
     0     0 3511.23011    0  568 -4437.9655 3511.23011   179%     -  201s
     0     0 3482.71951    0  566 -4437.9655 3482.71951   178%     -  204s
     0     0 3476.19794    0  629 -4437.9655 3476.19794   178%     -  205s
     0     0 3474.87014    0  583 -4437.9655 3474.87014   178%     -  206s
     0     0 3467.56430    0  494 -4437.9655 3467.56430   178%     -  207s
     0     0 3461.68320    0  496 -4437.9655 3461.68320   178%     -  209s
     0     0 3461.02062    0  494 -4437.9655 3461.02062   178%     -  209s
     0     0 3424.70744    0  699 -4437.9655 3424.70744   177%     -  214s
     0     0 3418.52046    0  558 -4437.9655 3418.52046   177%     -  216s
     0     0 3416.93271    0  566 -4437.9655 3416.93271   177%     -  216s
     0     0 3416.56121    0  564 -4437.9655 3416.56121   177%     -  216s
     0     0 3402.52030    0  575 -4437.9655 3402.52030   177%     -  218s
     0     0 3397.02253    0  564 -4437.9655 3397.02253   177%     -  219s
     0     0 3395.33431    0  565 -4437.9655 3395.33431   177%     -  220s
     0     0 3393.14144    0  577 -4437.9655 3393.14144   176%     -  220s
     0     0 3392.54425    0  578 -4437.9655 3392.54425   176%     -  221s
     0     0 3364.22231    0  583 -4437.9655 3364.22231   176%     -  223s
     0     0 3346.85923    0  737 -4437.9655 3346.85923   175%     -  225s
     0     0 3345.35256    0  729 -4437.9655 3345.35256   175%     -  226s
     0     0 3344.54106    0  726 -4437.9655 3344.54106   175%     -  226s
     0     0 3341.11739    0  586 -4437.9655 3341.11739   175%     -  228s
     0     0 3340.42157    0  591 -4437.9655 3340.42157   175%     -  229s
     0     0 3334.68471    0  741 -4437.9655 3334.68471   175%     -  231s
     0     0 3332.54269    0  603 -4437.9655 3332.54269   175%     -  236s
     0     0 3332.33927    0  598 -4437.9655 3332.33927   175%     -  237s
     0     0 3330.30795    0  593 -4437.9655 3330.30795   175%     -  239s
     0     0 3329.66443    0  599 -4437.9655 3329.66443   175%     -  240s
     0     0 3328.84179    0  600 -4437.9655 3328.84179   175%     -  241s
     0     0 3328.74846    0  600 -4437.9655 3328.74846   175%     -  243s
     0     2 3328.73246    0  600 -4437.9655 3328.73246   175%     -  297s
     1     4 3318.94631    1  581 -4437.9655 3328.31570   175%  2149  300s
     3     8 3220.96629    2  577 -4437.9655 3317.77482   175%  3225  312s
     7    14 3214.19841    3  576 -4437.9655 3220.30704   173%  5975  318s
    15    27 3190.85909    4  576 -4437.9655 3210.61591   172%  5004  327s
    28    40 1546.85764    5  438 -4437.9655 3210.61591   172%  6805  346s
    41    67 -451.83219    6  196 -4437.9655 3190.85609   172%  8583  412s
    72    99 -707.87351    7  177 -4437.9655 3190.85609   172%  9738  430s
   109   146 -1913.0951    9  170 -4437.9655 3190.85609   172%  8149  449s
   167   203 -2915.8119   14  163 -4437.9655 3190.85609   172%  7442  463s
   230   241 -3727.0377   16  156 -4437.9655 3190.85609   172%  6346  476s
   282   277 -4405.1289   10  258 -4437.9655 3150.22870   171%  6155  488s
   332   301 3138.33039    6  478 -4437.9655 3149.98922   171%  6090  499s
   385   331 2940.40708    7  619 -4437.9655 3149.98922   171%  6011  513s
   459   362 2829.90098    8  673 -4437.9655 3149.98922   171%  5833  523s
   518   394 2555.08767    9  502 -4437.9655 3149.98922   171%  5805  534s
   584   414 1970.67684   10  656 -4437.9655 3149.98922   171%  5756  546s
   642   448 1834.24117   11  630 -4437.9655 3149.98922   171%  5700  558s
   712   475 1786.29004   12  658 -4437.9655 3149.98922   171%  5635  568s
   777   513 1614.85004   13  629 -4437.9655 3149.98922   171%  5590  580s
   837   543 1445.46401   14  619 -4437.9655 3149.98922   171%  5538  593s
   904   582 1240.03927   15  634 -4437.9655 2904.73944   165%  5445  606s
   977   615  355.62854   15  373 -4437.9655 2904.73944   165%  5428  618s
  1044   635  773.44950   16  604 -4437.9655 2904.73944   165%  5432  629s
  1104   675  564.89541   17  616 -4437.9655 2904.73944   165%  5379  642s
  1170   714 -2447.9048   29  460 -4437.9655 2904.73944   165%  5337  655s
  1239   772 -1371.7015   16  506 -4437.9655 2904.73944   165%  5274  667s
  1330   843 -1574.8130   17  633 -4437.9655 2904.73944   165%  5177  681s
  1437   897 -2762.2439   18  293 -4437.9655 2333.95388   153%  5107  695s
  1534   984 infeasible   19      -4437.9655 2333.95388   153%  5051  709s
  1655  1030 -2629.7557   22  557 -4437.9655 2333.95388   153%  4992  722s
  1720  1082 -2699.8446   23  551 -4437.9655 2333.95388   153%  4945  736s
  1827  1131 -3204.8383   25  385 -4437.9655 2333.95388   153%  4869  750s
  1928  1186 -3755.4255   27  470 -4437.9655 2020.66829   146%  4857  765s
  2038  1251 infeasible   29      -4437.9655 1976.79169   145%  4841  782s
  2185  1278 infeasible   28      -4437.9655 1976.79169   145%  4761  801s
  2324  1354 -4183.3171   11  396 -4437.9655 1976.79169   145%  4715  819s
  2458  1470 infeasible   12      -4437.9655 1976.79169   145%  4669  837s
  2664  1602 -1533.0495   11  346 -4437.9655 1976.79169   145%  4550  853s
  2902  1726 -1809.9761   14  553 -4437.9655 1976.79169   145%  4413  873s
  3136  1837 -2013.5210   18  487 -4437.9655 1976.79169   145%  4308  893s
  3380  1914 -2385.6922   26  411 -4437.9655 1976.79169   145%  4205  913s
  3609  1961 -2772.0719   35  479 -4437.9655 1769.84939   140%  4140  933s
  3859  2062 -3220.0515   49  394 -4437.9655 1769.84939   140%  4078  955s
  4077  2161 -4065.8009   73  302 -4437.9655 1414.62082   132%  4062  976s
  4287  2234 infeasible   76      -4437.9655 1362.75651   131%  4061  997s
  4545  2279 -1188.9156    7  490 -4437.9655 1353.87051   131%  4039 1021s
  4696  2402 -1485.1836    8  414 -4437.9655 1094.57235   125%  4056 1048s
  4937  2547 infeasible   10      -4437.9655 1094.57235   125%  4036 1073s
  5271  2548 -309.10765   22  600 -4437.9655 1008.83578   123%  3948 1224s
  5273  2549 -109.48258   10  332 -4437.9655 1008.83578   123%  3947 1270s
  5274  2550 -3796.3732   73  535 -4437.9655 1008.83578   123%  3946 1296s
  5275  2551  451.07569   15  404 -4437.9655 1008.83578   123%  3945 1311s
  5276  2551  651.43547   12  499 -4437.9655 1008.83578   123%  3944 1323s
  5277  2552 -2316.6214   25  583 -4437.9655 1008.83578   123%  3944 1332s
  5278  2553 -1861.9389   75  528 -4437.9655 1008.83578   123%  3943 1338s
  5279  2553 -2606.1982   36  466 -4437.9655 1008.83578   123%  3942 1342s
  5280  2554 -3572.5415   58  529 -4437.9655 1008.83578   123%  3941 1346s
  5282  2555 -3861.0282   69  479 -4437.9655 1008.83578   123%  3940 1351s
  5284  2557 -3365.2318   44  483 -4437.9655 1008.83578   123%  3938 1358s
  5285  2557 -3654.5635   96  554 -4437.9655 1008.83578   123%  3938 1362s
  5286  2558 -1945.9762   30  565 -4437.9655 1008.83578   123%  3937 1366s
  5288  2559 -3496.2358   37  565 -4437.9655 1008.83578   123%  3935 1378s
  5289  2560   96.93338   17  609 -4437.9655 1008.83578   123%  3935 1384s
  5290  2561  661.49055   13  563 -4437.9655 1008.83578   123%  3934 1387s
  5292  2562 -4318.6916   20  570 -4437.9655 1008.83578   123%  3932 1391s
  5294  2563 -4275.0759   24  590 -4437.9655 1008.83578   123%  3931 1397s
  5295  2564 -3134.7273   54  541 -4437.9655 1008.83578   123%  3930 1405s
  5297  2565 -3146.2795   33  556 -4437.9655 1008.83578   123%  3929 1411s
  5298  2566 -3336.9365   22  543 -4437.9655 1008.83578   123%  3928 1420s
  5300  2567 -4238.8661   30  552 -4437.9655 1008.83578   123%  3927 1425s
  5301  2568 -1960.8030   31  561 -4437.9655 1008.83578   123%  3926 1430s
  5303  2569 -3528.1233   51  555 -4437.9655 1008.83578   123%  3924 1444s
  5304  2570 -1388.4186   43  556 -4437.9655 1008.83578   123%  3924 1446s
  5305  2571 -3231.7837   23  560 -4437.9655 1008.83578   123%  3923 1450s
  5306  2571 -988.20897   13  574 -4437.9655 1008.83578   123%  3922 1458s
  5307  2572 -3678.3169  107  577 -4437.9655 1008.83578   123%  3921 1461s
  5308  2573 -848.92530    8  576 -4437.9655 1008.83578   123%  3921 1469s
  5309  2573 -3375.1920   43  580 -4437.9655 1008.83578   123%  3920 1473s
  5311  2575 -1360.4173   18  547 -4437.9655 1008.83578   123%  3918 1477s
  5312  2575  171.64063   12  557 -4437.9655 1008.83578   123%  3918 1486s
  5314  2577 -109.62478   16  548 -4437.9655 1008.83578   123%  3916 1498s
  5315  2577 -1861.9389   75  543 -4437.9655 1008.83578   123%  3915 1501s
  5316  2578 -2317.1515   40  564 -4437.9655 1008.83578   123%  3915 1505s
  5317  2579 -3977.7697  104  539 -4437.9655 1008.83578   123%  3914 1512s
  5319  2580 -1780.1740   30  532 -4437.9655 1008.83578   123%  3913 1517s
  5320  2581 -2325.8834   15  542 -4437.9655 1008.83578   123%  3912 1527s
  5321  2581 -2334.9295   25  530 -4437.9655 1008.83578   123%  3911 1530s
  5322  2582 -3652.7540   17  540 -4437.9655 1008.83578   123%  3910 1538s
  5323  2583 -4339.3107   25  540 -4437.9655 1008.83578   123%  3910 1587s
  5324  2583 -4238.8661   30  540 -4437.9655 1008.83578   123%  3909 1616s
  5325  2587 1008.83578   12  537 -4437.9655 1008.83578   123%  3964 1632s
  5327  2590 1008.83578   13  523 -4437.9655 1008.83578   123%  3963 1643s
  5331  2597 1008.83578   14  443 -4437.9655 1008.83578   123%  3966 1657s
  5339  2610 1008.83578   15  589 -4437.9655 1008.83578   123%  3970 1670s
  5355  2609  814.06790   16  405 -4437.9655 1008.83578   123%  3996 1760s
  5371  2614 -1123.8406   17  312 -4437.9655 1008.83578   123%  4009 1799s
  5398  2621 -2632.6805   18  286 -4437.9655 1008.83578   123%  4044 1830s
  5454  2630 -3916.3370   20  339 -4437.9655 1008.83578   123%  4114 1854s
  5526  2624 infeasible   22      -4437.9655 1008.83578   123%  4123 1876s
  5598  2615 infeasible   24      -4437.9655 1008.83578   123%  4126 1902s
  5664  2595 -1305.5822   25  359 -4437.9655 1008.83578   123%  4123 1920s
  5737  2583 -2220.8080   27  409 -4437.9655 1008.83578   123%  4109 1940s
  5807  2577 -2518.3080   29  233 -4437.9655 1008.83578   123%  4102 1953s
  5849  2579 -2731.8247   30  451 -4437.9655 1008.83578   123%  4098 1966s
  5884  2576 -2849.7847   31  323 -4437.9655 1008.83578   123%  4092 1979s
  5923  2560 -2958.9014   32  331 -4437.9655 1008.83578   123%  4089 1994s
  5965  2554     cutoff   32      -4437.9655 1008.83578   123%  4083 2010s
  6008  2561 infeasible   30      -4437.9655 1008.83578   123%  4075 2023s
  6055  2557 -767.44692   21  412 -4437.9655 1008.83578   123%  4063 2036s
  6096  2552 -966.56622   22  410 -4437.9655 1008.83578   123%  4055 2048s
  6138  2551 -1717.9722   23  260 -4437.9655 1008.83578   123%  4046 2063s
  6191  2547 -1789.5774   24  259 -4437.9655 1008.83578   123%  4035 2077s
  6247  2557 -2073.9376   25  316 -4437.9655 1008.83578   123%  4024 2092s
  6301  2556     cutoff   26      -4437.9655 1008.83578   123%  4012 2107s
  6364  2544 -2866.4498   27  353 -4437.9655 1008.83578   123%  4002 2122s
  6416  2551 -3065.8412   28  297 -4437.9655 1008.83578   123%  3996 2137s
  6500  2541 -3093.4191   29  255 -4437.9655  563.51133   113%  3972 2153s
  6606  2538     cutoff   33      -4437.9655  563.51133   113%  3943 2172s
  6705  2527     cutoff   37      -4437.9655  563.51133   113%  3917 2190s
  6799  2509 infeasible   24      -4437.9655  175.14901   104%  3899 2207s
  6875  2498 -3821.2394   23  277 -4437.9655  175.14901   104%  3895 2225s
  6971  2470     cutoff   29      -4437.9655  175.14901   104%  3886 2247s
  7092  2450 -4279.8534   30  283 -4437.9655  175.14901   104%  3868 2276s
  7225  2400 -3315.6276   22  511 -4437.9655  175.14901   104%  3849 2298s
  7372  2363 infeasible   25      -4437.9655  175.14901   104%  3822 2321s
  7503  2296     cutoff   26      -4437.9655 -362.62044  91.8%  3813 2340s
  7571  2288     cutoff   28      -4437.9655 -368.47799  91.7%  3807 2362s
  7700  2214 -3127.7807   38  321 -4437.9655 -368.47799  91.7%  3782 2387s
  7923  2116 infeasible   41      -4437.9655 -1056.8659  76.2%  3728 2414s
  8171  2027 -2364.1781   23  416 -4437.9655 -1421.8811  68.0%  3670 2441s
  8426  1905 -3747.5481   24  412 -4437.9655 -1421.8811  68.0%  3612 2468s
  8730  1680 infeasible   25      -4437.9655 -1881.0860  57.6%  3538 2493s
  9034  1482 -2332.8805   24  523 -4437.9655 -1883.3351  57.6%  3460 2516s
  9363  1290 infeasible   26      -4437.9655 -2532.5519  42.9%  3379 2538s
  9593  1174 infeasible   29      -4437.9655 -3159.6189  28.8%  3330 2552s
  9680  1133 -3972.4846   42  188 -4437.9655 -3756.6212  15.4%  3310 2564s
  9726  1116 infeasible   49      -4437.9655 -4323.9264  2.57%  3297 2565s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 34
  MIR: 783
  Flow cover: 2147
  Zero half: 1
  RLT: 30
  Relax-and-lift: 138

Explored 9728 nodes (32388454 simplex iterations) in 2565.13 seconds (6543.89 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -4437.97 -4438.74 -4451.51 ... -16044.6
No other solutions better than -4437.97

Optimal solution found (tolerance 1.00e-06)
Best objective -4.437965476001e+03, best bound -4.437965476001e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2565.15s
  Master Objective (UB) = -4437.97, θ = 116627.58
  Upper Bound (UB) = -4437.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116627.58
  [DEBUG]   ✓ Scenario 0: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116627.58 ≤ Q = 116627.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116627.58 ≤ Q = 116627.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4b38859e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb4c77a62
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.290223e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 6967881.1205
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.166971e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116697.06    0  121 6967881.12 -116697.06   102%     -    0s
H    0     0                    -81478.87388 -116697.06  43.2%     -    0s
H    0     0                    -83084.28011 -116697.06  40.5%     -    0s
*    0     0               0    -84278.46524 -84278.465  0.00%     -    0s

Cutting planes:
  Gomory: 12
  MIR: 194

Explored 1 nodes (383 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -84278.5 -83084.3 -81478.9 ... 1.29022e+13
No other solutions better than -84278.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.427846523826e+04, best bound -8.427846523826e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 116627.58
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84278.47
  [DEBUG]   S×d_nominal = 200906.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200906.04 + -84278.47 = 116627.58
  [DEBUG]   Current θ from Master = 116627.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 0.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4437.97
  Lower Bound (LB) = -4437.97
  Gap (UB-LB) = 0.0000, Absolute Gap = 0.0000, Relative Gap = 0.000000
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 9065.16s
Converged: True
Final Lower Bound: -4437.9655
Final Upper Bound: -4437.9655
Final Gap: 0.000000
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 6] (3/10)
Active Routes (Plant→DC): 8
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 10 customers  Mode 1: 7 customers  Mode 2: 33 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-04 06:35:45
End Time: 2026-01-04 09:06:50
Total Time: 9065.16s
Optimal Value: -4437.97
Lower Bound: -4437.97
Upper Bound: -4437.97
Gap: 0.000000
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [1, 3, 6] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed34_LD_gamma20_20260104_090650.csv

Total Execution Time: 9065.38 seconds
End Time: 2026-01-04 09:06:50

All tasks completed successfully!

