
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 20
DI Scenario: Mixed
Start Time: 2026-01-03 10:49:11
================================================================================
Loading data from data/DH_data_full_seed20.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
  Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
  Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1737
  DC capacity (MC): min=437, max=799

Demand Structure (s_rk matrix):
  Total customer-product pairs: 88/150 (41.3% sparse)
  Average products per customer: 1.76

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.72, count=88
  Deviation (μ̂): min=4.13, max=9.94

Costs:
  Plant fixed cost: min=6305, max=9991
  DC fixed cost: min=3078, max=5751
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.340', '1.796'] (k=0.722)
    Product 2: ['1.000', '1.438', '2.069'] (k=0.896)
  MD:
    Product 0: ['1.000', '1.194', '1.425'] (k=0.437)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.168', '1.363'] (k=0.382)
  LD:
    Product 0: ['1.000', '1.028', '1.057'] (k=0.068)
    Product 1: ['1.000', '1.119', '1.252'] (k=0.277)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
  Mixed:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48774 nonzeros
Model fingerprint: 0xe2e746ea
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11543 rows and 2543 columns
Presolve time: 0.08s
Presolved: 5130 rows, 5957 columns, 35527 nonzeros
Variable types: 3698 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -292816.7553
Found heuristic solution: objective -207781.0263

Root relaxation: objective 1.284206e+05, 5367 iterations, 0.25 seconds (0.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 128420.585    0  664 -207781.03 128420.585   162%     -    0s
H    0     0                    -196076.9082 128420.585   165%     -    0s
H    0     0                    -188138.8151 111469.688   159%     -    1s
     0     0 111381.731    0  838 -188138.82 111381.731   159%     -    1s
     0     0 110927.370    0  837 -188138.82 110927.370   159%     -    1s
     0     0 110865.338    0  841 -188138.82 110865.338   159%     -    1s
     0     0 110846.468    0  834 -188138.82 110846.468   159%     -    1s
     0     0 110846.340    0  836 -188138.82 110846.340   159%     -    1s
H    0     0                    -179015.1245 104521.276   158%     -    2s
     0     0 104521.276    0  953 -179015.12 104521.276   158%     -    2s
H    0     0                    -150871.0466 104518.912   169%     -    3s
H    0     0                    -149122.0825 104212.647   170%     -    3s
     0     0 104212.647    0  960 -149122.08 104212.647   170%     -    3s
     0     0 104172.559    0 1030 -149122.08 104172.559   170%     -    3s
     0     0 104165.195    0 1037 -149122.08 104165.195   170%     -    3s
     0     0 104163.708    0  980 -149122.08 104163.708   170%     -    3s
H    0     0                    -115868.7562 100582.225   187%     -    4s
H    0     0                    -115391.8919 100582.225   187%     -    4s
H    0     0                    -95427.49977 100582.225   205%     -    4s
H    0     0                    -88347.80584 100582.225   214%     -    4s
H    0     0                    -80643.72618 100582.225   225%     -    4s
H    0     0                    -79603.81281 100582.225   226%     -    4s
H    0     0                    22238.993842 100582.225   352%     -    4s
     0     0 100582.225    0 1049 22238.9938 100582.225   352%     -    4s
     0     0 100363.863    0 1048 22238.9938 100363.863   351%     -    5s
     0     0 100342.405    0 1043 22238.9938 100342.405   351%     -    5s
     0     0 100331.578    0 1028 22238.9938 100331.578   351%     -    5s
     0     0 100331.077    0 1043 22238.9938 100331.077   351%     -    5s
H    0     0                    22462.374861 97792.1464   335%     -    6s
H    0     0                    22517.285121 97792.1464   334%     -    6s
H    0     0                    22545.639406 97792.1464   334%     -    6s
H    0     0                    22694.112354 97792.1464   331%     -    6s
H    0     0                    23373.582561 97792.1464   318%     -    6s
H    0     0                    24096.982466 97792.1464   306%     -    6s
H    0     0                    27942.780874 97792.1464   250%     -    6s
H    0     0                    37958.051099 97792.1464   158%     -    6s
H    0     0                    37971.533996 97792.1464   158%     -    6s
     0     0 97792.1464    0 1095 37971.5340 97792.1464   158%     -    6s
     0     0 97501.4063    0 1117 37971.5340 97501.4063   157%     -    7s
     0     0 97456.0183    0 1109 37971.5340 97456.0183   157%     -    7s
     0     0 97450.4008    0 1122 37971.5340 97450.4008   157%     -    7s
H    0     0                    38214.703520 94309.8518   147%     -    8s
H    0     0                    38366.257479 94309.8518   146%     -    8s
H    0     0                    38395.888227 94309.8518   146%     -    8s
H    0     0                    38446.760204 94309.8518   145%     -    8s
H    0     0                    38545.762480 94309.8518   145%     -    8s
H    0     0                    38558.150272 94309.8518   145%     -    8s
H    0     0                    38733.839470 94309.8518   143%     -    8s
H    0     0                    38836.671091 94309.8518   143%     -    8s
H    0     0                    38891.292877 94309.8518   142%     -    8s
H    0     0                    39034.465156 94309.8518   142%     -    8s
H    0     0                    39041.786620 94309.8518   142%     -    8s
H    0     0                    39074.420314 94309.8518   141%     -    8s
H    0     0                    39085.554096 94309.8518   141%     -    8s
H    0     0                    39169.341638 94309.8518   141%     -    8s
H    0     0                    39251.028537 94309.8518   140%     -    8s
H    0     0                    39270.554446 94309.8518   140%     -    8s
H    0     0                    39280.276193 94309.8518   140%     -    8s
     0     0 94309.8518    0  986 39280.2762 94309.8518   140%     -    8s
H    0     0                    39350.980474 93953.4645   139%     -    9s
H    0     0                    39357.820662 93953.4645   139%     -    9s
H    0     0                    39359.830740 93953.4645   139%     -    9s
H    0     0                    39386.503534 93953.4645   139%     -    9s
     0     0 93953.4645    0  992 39386.5035 93953.4645   139%     -    9s
     0     0 93873.6609    0 1017 39386.5035 93873.6609   138%     -    9s
     0     0 93854.6972    0 1018 39386.5035 93854.6972   138%     -    9s
     0     0 93848.7302    0 1031 39386.5035 93848.7302   138%     -    9s
H    0     0                    39455.142467 90552.1321   130%     -   11s
     0     0 90552.1321    0  989 39455.1425 90552.1321   130%     -   11s
     0     0 90045.5412    0  992 39455.1425 90045.5412   128%     -   12s
     0     0 89921.8552    0 1008 39455.1425 89921.8552   128%     -   12s
     0     0 89895.2499    0 1017 39455.1425 89895.2499   128%     -   12s
     0     0 89884.4844    0 1014 39455.1425 89884.4844   128%     -   12s
H    0     0                    39539.016184 84656.1807   114%     -   14s
H    0     0                    39621.760519 84656.1807   114%     -   14s
H    0     0                    39624.114544 84656.1807   114%     -   14s
H    0     0                    39688.726689 84656.1807   113%     -   14s
H    0     0                    39796.470784 84656.1807   113%     -   14s
H    0     0                    40075.998094 84656.1807   111%     -   14s
H    0     0                    40102.978806 84656.1807   111%     -   14s
H    0     0                    40302.216582 84656.1807   110%     -   14s
H    0     0                    40357.171850 84656.1807   110%     -   14s
H    0     0                    40444.326485 84656.1807   109%     -   14s
H    0     0                    40477.503258 84656.1807   109%     -   14s
H    0     0                    40585.597721 84656.1807   109%     -   14s
H    0     0                    40700.904595 84656.1807   108%     -   14s
     0     0 84656.1807    0  803 40700.9046 84656.1807   108%     -   14s
H    0     0                    40765.091181 83857.8941   106%     -   15s
     0     0 83857.8941    0  902 40765.0912 83857.8941   106%     -   15s
     0     0 83750.8550    0  920 40765.0912 83750.8550   105%     -   15s
     0     0 83719.1317    0  942 40765.0912 83719.1317   105%     -   15s
     0     0 83709.1457    0 1000 40765.0912 83709.1457   105%     -   15s
H    0     0                    40850.923486 74266.4308  81.8%     -   17s
H    0     0                    40860.778226 74266.4308  81.8%     -   17s
H    0     0                    41005.727183 74266.4308  81.1%     -   17s
H    0     0                    41069.449188 74266.4308  80.8%     -   17s
     0     0 74266.4308    0  636 41069.4492 74266.4308  80.8%     -   17s
     0     0 73228.7191    0  740 41069.4492 73228.7191  78.3%     -   18s
     0     0 72959.1494    0  716 41069.4492 72959.1494  77.6%     -   18s
     0     0 72857.1755    0  746 41069.4492 72857.1755  77.4%     -   18s
     0     0 72836.8608    0  731 41069.4492 72836.8608  77.4%     -   18s
H    0     0                    41069.884926 70198.6528  70.9%     -   20s
H    0     0                    41079.739666 70198.6528  70.9%     -   20s
H    0     0                    41202.735186 70198.6528  70.4%     -   20s
H    0     0                    41212.589926 70198.6528  70.3%     -   20s
H    0     0                    41306.183979 70198.6528  69.9%     -   20s
H    0     0                    41374.209901 70198.6528  69.7%     -   20s
H    0     0                    41377.001812 70198.6528  69.7%     -   20s
     0     0 70198.6528    0  741 41377.0018 70198.6528  69.7%     -   20s
H    0     0                    41589.948170 69432.6428  66.9%     -   21s
H    0     0                    41691.602160 69432.6428  66.5%     -   21s
     0     0 69432.6428    0  857 41691.6022 69432.6428  66.5%     -   21s
H    0     0                    42006.972246 69252.5483  64.9%     -   21s
     0     0 69252.5483    0  857 42006.9722 69252.5483  64.9%     -   21s
H    0     0                    42013.074800 69216.2887  64.7%     -   21s
     0     0 69216.2887    0  897 42013.0748 69216.2887  64.7%     -   21s
H    0     0                    42104.630514 67633.0994  60.6%     -   23s
     0     0 67633.0994    0  750 42104.6305 67633.0994  60.6%     -   23s
     0     0 67258.0798    0  792 42104.6305 67258.0798  59.7%     -   23s
     0     0 67173.6886    0  800 42104.6305 67173.6886  59.5%     -   24s
     0     0 67154.9838    0  816 42104.6305 67154.9838  59.5%     -   24s
     0     0 66060.7932    0  789 42104.6305 66060.7932  56.9%     -   25s
     0     0 65791.8862    0  835 42104.6305 65791.8862  56.3%     -   26s
     0     0 65711.6971    0  850 42104.6305 65711.6971  56.1%     -   26s
     0     0 65677.2060    0  857 42104.6305 65677.2060  56.0%     -   26s
H    0     0                    42169.372141 65022.5610  54.2%     -   27s
     0     0 65022.5610    0  759 42169.3721 65022.5610  54.2%     -   27s
     0     0 64853.2345    0  823 42169.3721 64853.2345  53.8%     -   28s
     0     0 64790.7568    0  817 42169.3721 64790.7568  53.6%     -   28s
     0     0 64769.4956    0  822 42169.3721 64769.4956  53.6%     -   28s
     0     0 64250.9121    0  793 42169.3721 64250.9121  52.4%     -   30s
     0     0 64116.5641    0  807 42169.3721 64116.5641  52.0%     -   30s
     0     0 64087.1527    0  826 42169.3721 64087.1527  52.0%     -   30s
     0     0 63742.0208    0  706 42169.3721 63742.0208  51.2%     -   31s
     0     0 63626.9123    0  734 42169.3721 63626.9123  50.9%     -   32s
     0     0 63598.9650    0  741 42169.3721 63598.9650  50.8%     -   32s
     0     0 63349.4598    0  762 42169.3721 63349.4598  50.2%     -   33s
     0     0 63349.3674    0  762 42169.3721 63349.3674  50.2%     -   33s
     0     2 63349.3674    0  762 42169.3721 63349.3674  50.2%     -   35s
    15    32 59203.9082    4  583 42169.3721 62402.3063  48.0%  3060   40s
H   31    64                    42220.912833 61863.2151  46.5%  3249   41s
H   61    64                    42239.976596 61804.9333  46.3%  2606   41s
H   95   220                    42380.580152 61804.9333  45.8%  2473   43s
H   99   220                    42420.490524 61804.9333  45.7%  2399   43s
H  108   220                    42776.670089 61804.9333  44.5%  2244   43s
H  319   362                    42966.226407 61804.9333  43.8%  1245   45s
H  319   362                    43241.687389 61804.9333  42.9%  1245   45s
H  579   563                    43361.919158 61804.9333  42.5%  1106   49s
H  600   563                    43392.271461 61804.9333  42.4%  1099   49s
   638   633 52717.2892   17  410 43392.2715 61617.0691  42.0%  1074   50s
H  792   728                    43517.951494 61521.9016  41.4%  1001   51s
H  798   728                    43670.393390 61521.9016  40.9%   999   51s
H  843   728                    43808.323083 61521.9016  40.4%   981   51s
  1121   959 49084.9453   25  244 43808.3231 61333.3082  40.0%   888   55s
H 1158  1004                    43879.281613 61302.2031  39.7%   886   56s
H 1363  1196                    43889.025155 61282.6822  39.6%   828   58s
  1622  1428 46896.3383   47  187 43889.0252 61230.3535  39.5%   770   60s
H 2013  1599                    43913.737049 61154.0047  39.3%   708   63s
  2172  1810 55472.0701   13  391 43913.7370 61154.0047  39.3%   700   65s
H 2174  1810                    43993.794731 61154.0047  39.0%   700   65s
  2734  2238 53757.9364   18  347 43993.7947 61154.0047  39.0%   649   71s
  3399  2769 52208.4944   23  320 43993.7947 61055.0247  38.8%   609   75s
H 3656  2761                    44210.880802 61055.0247  38.1%   593   83s
  3657  2761 50936.3620   24  762 44210.8808 61055.0247  38.1%   593   92s
  3678  2775 55392.2310   11  383 44210.8808 58704.4177  32.8%   589   95s
  3950  2862 46365.5130   23  326 44210.8808 53665.5435  21.4%   583  100s
H 3988  2710                    44313.712423 53665.5435  21.1%   581  100s
H 4040  2581                    44358.241373 53665.5435  21.0%   579  100s
H 4051  2452                    44369.143100 53665.5435  21.0%   578  100s
H 4153  2315                    44464.577652 52658.7430  18.4%   571  101s
H 4193  2187                    44523.937927 52658.7430  18.3%   568  101s
H 4205  2075                    44600.795099 52658.7430  18.1%   567  101s
H 4337  1941                    44603.178682 51784.1760  16.1%   558  103s
H 4347  1841                    44616.106842 51784.1760  16.1%   557  103s
H 4455  1718                    44711.541394 51784.1760  15.8%   549  104s
H 4646  1588                    44730.161993 51784.1760  15.8%   535  104s
  4745  1611 45983.4455   28  264 44730.1620 50831.4550  13.6%   527  105s
H 5503  1615                    45143.829957 50831.4550  12.6%   466  106s
H 5614  1498                    45416.430010 50831.4550  11.9%   458  106s
H 5622  1420                    45603.146056 50831.4550  11.5%   458  106s
H 5814  1242                    45621.234532 50001.1627  9.60%   446  106s
H 5820  1172                    45621.394226 50001.1627  9.60%   445  106s
H 6150  1103                    45627.846326 49469.3754  8.42%   425  106s
H 6850  1103                    45638.046337 49005.9259  7.38%   385  107s
H 9307  1763                    45658.136312 45963.7673  0.67%   289  109s
  9310  2249 45895.5053   50   29 45658.1363 45963.7673  0.67%   289  110s
H10778  2849                    45669.698491 45950.4533  0.61%   252  110s
H26295  5589                    45720.642196 45848.0960  0.28%   113  114s
 31690  5702     cutoff   50      45720.6422 45821.3773  0.22%  96.9  115s

Cutting planes:
  Gomory: 3
  Implied bound: 24
  Projected implied bound: 48
  MIR: 345
  Mixing: 1
  Flow cover: 486
  RLT: 28
  Relax-and-lift: 130
  BQP: 2

Explored 50472 nodes (3475071 simplex iterations) in 116.74 seconds (244.98 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 45720.6 45669.7 45658.1 ... 44730.2

Optimal solution found (tolerance 1.00e-06)
Best objective 4.572064219572e+04, best bound 4.572064219572e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 116.75s
  Master Objective (UB) = 45720.64, θ = 198526.13
  Upper Bound (UB) = 45720.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 198526.13
  [DEBUG]   ✓ Scenario 0: θ = 198526.13 ≤ Q = 198526.13 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x249fed3e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x249fed3e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.251091e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 7034304.8356
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.332465e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133246.48    0  122 7034304.84 -133246.48   102%     -    0s
H    0     0                    -96766.39712 -133246.48  37.7%     -    0s
H    0     0                    -98182.33661 -133246.48  35.7%     -    0s
*    0     0               0    -100859.8924 -100859.89  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 210

Explored 1 nodes (382 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -100860 -100860 -98182.3 ... 1.25109e+13
No other solutions better than -100860

Optimal solution found (tolerance 1.00e-06)
Best objective -1.008598923658e+05, best bound -1.008598923662e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 163909.48
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100859.89
  [DEBUG]   S×d_nominal = 264769.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 264769.37 + -100859.89 = 163909.48
  [DEBUG]   Current θ from Master = 198526.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34616.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11103.99
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 34616.6524, Absolute Gap = 34616.6524, Relative Gap = 0.757134
  Not converged yet (gap = 34616.65 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92029 nonzeros
Model fingerprint: 0x74256f3c
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 11104 (0.01s)
MIP start from previous solve produced solution with objective 11104 (0.01s)
Loaded MIP start from previous solve with objective 11104

Presolve removed 12525 rows and 5084 columns
Presolve time: 0.30s
Presolved: 19438 rows, 9656 columns, 107838 nonzeros
Variable types: 7397 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.246019e+04, 9318 iterations, 1.10 seconds (2.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 62460.1925    0  328 11103.9898 62460.1925   463%     -    1s
H    0     0                    11878.740071 62460.1925   426%     -    1s
H    0     0                    19458.303785 62460.1925   221%     -    1s
H    0     0                    20432.633504 62460.1925   206%     -    1s
H    0     0                    21586.589222 62460.1925   189%     -    1s
H    0     0                    21612.149851 62460.1925   189%     -    1s
H    0     0                    22122.468690 62460.1925   182%     -    1s
H    0     0                    22193.831709 62460.1925   181%     -    1s
     0     0 52517.9820    0  451 22193.8317 52517.9820   137%     -    2s
H    0     0                    22626.705692 52517.9820   132%     -    3s
     0     0 52106.5038    0  463 22626.7057 52106.5038   130%     -    3s
     0     0 52076.5112    0  466 22626.7057 52076.5112   130%     -    3s
     0     0 52076.5112    0  466 22626.7057 52076.5112   130%     -    3s
     0     0 45662.1394    0  452 22626.7057 45662.1394   102%     -    4s
H    0     0                    22627.276895 45660.1905   102%     -    4s
H    0     0                    22745.752881 45660.1905   101%     -    4s
H    0     0                    22795.786953 45660.1905   100%     -    4s
H    0     0                    22829.303908 45660.1905   100%     -    4s
H    0     0                    22840.602292 45660.1905   100%     -    4s
H    0     0                    22867.502004 45660.1905   100%     -    4s
H    0     0                    24181.325298 44978.0261  86.0%     -    5s
H    0     0                    24221.879228 44978.0261  85.7%     -    5s
     0     0 44978.0261    0  539 24221.8792 44978.0261  85.7%     -    5s
     0     0 44921.8648    0  529 24221.8792 44921.8648  85.5%     -    5s
     0     0 44916.2123    0  531 24221.8792 44916.2123  85.4%     -    5s
     0     0 44909.9977    0  534 24221.8792 44909.9977  85.4%     -    5s
     0     0 44909.9361    0  534 24221.8792 44909.9361  85.4%     -    5s
H    0     0                    24222.450431 41119.2568  69.8%     -    8s
H    0     0                    24257.832163 41119.2568  69.5%     -    8s
H    0     0                    24280.402452 41119.2568  69.4%     -    8s
H    0     0                    24298.073220 41119.2568  69.2%     -    8s
H    0     0                    24522.762023 41119.2568  67.7%     -    8s
H    0     0                    24568.399661 41119.2568  67.4%     -    8s
H    0     0                    24640.988696 41119.2568  66.9%     -    8s
H    0     0                    25177.879109 41119.2568  63.3%     -    8s
     0     0 41119.2568    0  486 25177.8791 41119.2568  63.3%     -    8s
     0     0 40556.0459    0  513 25177.8791 40556.0459  61.1%     -    8s
     0     0 40420.4184    0  509 25177.8791 40420.4184  60.5%     -    9s
     0     0 40402.6366    0  576 25177.8791 40402.6366  60.5%     -    9s
     0     0 40390.6486    0  521 25177.8791 40390.6486  60.4%     -    9s
     0     0 40390.5142    0  520 25177.8791 40390.5142  60.4%     -    9s
     0     0 38375.1557    0  444 25177.8791 38375.1557  52.4%     -   12s
     0     0 38045.7730    0  446 25177.8791 38045.7730  51.1%     -   12s
     0     0 37894.3604    0  539 25177.8791 37894.3604  50.5%     -   13s
     0     0 37856.5386    0  551 25177.8791 37856.5386  50.4%     -   13s
     0     0 37802.5294    0  481 25177.8791 37802.5294  50.1%     -   13s
     0     0 37717.2842    0  629 25177.8791 37717.2842  49.8%     -   14s
     0     0 37712.6671    0  545 25177.8791 37712.6671  49.8%     -   14s
     0     0 37040.0563    0  532 25177.8791 37040.0563  47.1%     -   15s
     0     0 36810.5644    0  562 25177.8791 36810.5644  46.2%     -   16s
     0     0 36786.4193    0  574 25177.8791 36786.4193  46.1%     -   16s
     0     0 36760.6508    0  580 25177.8791 36760.6508  46.0%     -   17s
     0     0 36735.5971    0  634 25177.8791 36735.5971  45.9%     -   17s
     0     0 36733.5576    0  637 25177.8791 36733.5576  45.9%     -   17s
     0     0 36323.5884    0  527 25177.8791 36323.5884  44.3%     -   19s
H    0     0                    25237.733476 36322.9038  43.9%     -   19s
     0     0 36246.4583    0  538 25237.7335 36246.4583  43.6%     -   19s
     0     0 36225.5464    0  579 25237.7335 36225.5464  43.5%     -   20s
     0     0 36211.1368    0  624 25237.7335 36211.1368  43.5%     -   20s
     0     0 36207.9200    0  635 25237.7335 36207.9200  43.5%     -   20s
     0     0 36028.6862    0  467 25237.7335 36028.6862  42.8%     -   21s
H    0     0                    25277.174181 36028.6112  42.5%     -   21s
     0     0 35979.3545    0  621 25277.1742 35979.3545  42.3%     -   22s
     0     0 35975.6466    0  539 25277.1742 35975.6466  42.3%     -   22s
     0     0 35975.6466    0  539 25277.1742 35975.6466  42.3%     -   22s
     0     0 35921.3327    0  477 25277.1742 35921.3327  42.1%     -   23s
     0     0 35905.4437    0  575 25277.1742 35905.4437  42.0%     -   23s
     0     0 35899.2526    0  477 25277.1742 35899.2526  42.0%     -   23s
     0     0 35834.2290    0  442 25277.1742 35834.2290  41.8%     -   24s
     0     0 35807.0074    0  448 25277.1742 35807.0074  41.7%     -   24s
     0     0 35800.3560    0  624 25277.1742 35800.3560  41.6%     -   24s
     0     0 35775.9032    0  464 25277.1742 35775.9032  41.5%     -   25s
     0     0 35772.0404    0  464 25277.1742 35772.0404  41.5%     -   25s
     0     2 35772.0404    0  464 25277.1742 35772.0404  41.5%     -   31s
    31    62 33058.0680    5  550 25277.1742 34490.3319  36.4%  1361   36s
    95   136 32627.6954    7  472 25277.1742 33681.0072  33.2%  1248   40s
   525   434 30440.9340   12  312 25277.1742 33385.6147  32.1%   678   45s
  1048   727 26141.5095   19  279 25277.1742 33057.3843  30.8%   547   50s
  1581   849     cutoff    7      25277.1742 32524.3852  28.7%   487   55s
  2318  1012 25386.7123   12  320 25277.1742 32061.8921  26.8%   457   61s
  2770  1005 29740.5062    8  390 25277.1742 31556.1949  24.8%   462   66s
  3265  1004 27203.7959   21  274 25277.1742 31008.4670  22.7%   467   71s
  3451   959 28716.7031    7  474 25277.1742 30677.4065  21.4%   473   75s
  4671   989 27524.3137    7  218 25277.1742 28500.4133  12.8%   444   81s
  6414  1092     cutoff   21      25277.1742 26919.6021  6.50%   395   85s
  8510   716     cutoff   20      25277.1742 26317.9891  4.12%   362   90s

Cutting planes:
  Gomory: 20
  MIR: 1777
  Flow cover: 1065
  RLT: 36
  Relax-and-lift: 436

Explored 10272 nodes (3456158 simplex iterations) in 93.09 seconds (250.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25277.2 25237.7 25177.9 ... 24222.5

Optimal solution found (tolerance 1.00e-06)
Best objective 2.527717418135e+04, best bound 2.527717418135e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 93.10s
  Master Objective (UB) = 25277.17, θ = 178680.32
  Upper Bound (UB) = 25277.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 178680.32
  [DEBUG]   ✓ Scenario 0: θ = 178680.32 ≤ Q = 178680.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 178680.32 ≤ Q = 178680.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e00e316
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1ff1cea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.250876e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6759844.8215
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.540855e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154085.55    0  134 6759844.82 -154085.55   102%     -    0s
H    0     0                    -113259.6790 -154085.55  36.0%     -    0s
H    0     0                    -114974.6715 -154085.55  34.0%     -    0s
H    0     0                    -128271.4642 -154085.55  20.1%     -    0s
     0     0 -140201.98    0  103 -128271.46 -140201.98  9.30%     -    0s
H    0     0                    -135887.3629 -140163.14  3.15%     -    0s
     0     0 -139451.72    0   99 -135887.36 -139451.72  2.62%     -    0s
     0     0 -139429.02    0   99 -135887.36 -139429.02  2.61%     -    0s
H    0     0                    -137619.9381 -139429.01  1.31%     -    0s
     0     0 -139429.01    0   98 -137619.94 -139429.01  1.31%     -    0s
H    0     0                    -137913.4691 -139429.01  1.10%     -    0s
     0     0 -138768.02    0   86 -137913.47 -138768.02  0.62%     -    0s
H    0     0                    -138094.5309 -138754.62  0.48%     -    0s
     0     0 -138709.06    0   85 -138094.53 -138709.06  0.45%     -    0s
     0     0 -138680.03    0   63 -138094.53 -138680.03  0.42%     -    0s
     0     0 -138669.68    0   60 -138094.53 -138669.68  0.42%     -    0s
H    0     0                    -138101.6921 -138669.68  0.41%     -    0s
     0     0 -138344.97    0   20 -138101.69 -138344.97  0.18%     -    0s
     0     0 -138344.73    0   19 -138101.69 -138344.73  0.18%     -    0s
     0     0 -138325.64    0   22 -138101.69 -138325.64  0.16%     -    0s
     0     0 -138324.99    0   21 -138101.69 -138324.99  0.16%     -    0s
     0     0 -138304.86    0   23 -138101.69 -138304.86  0.15%     -    0s
     0     0 -138304.35    0   22 -138101.69 -138304.35  0.15%     -    0s
     0     0 -138229.28    0   16 -138101.69 -138229.28  0.09%     -    0s
     0     0 -138229.28    0   26 -138131.25 -138229.28  0.07%     -    0s
     0     0 -138229.28    0   25 -138131.25 -138229.28  0.07%     -    0s
     0     0 -138194.40    0    4 -138131.25 -138194.40  0.05%     -    0s
H    0     0                    -138191.8495 -138193.66  0.00%     -    0s
     0     0 -138193.41    0    4 -138191.85 -138193.41  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 10
  Flow cover: 12
  Relax-and-lift: 4

Explored 1 nodes (929 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -138192 -138131 -138102 ... 6.75984e+06
No other solutions better than -138192

Optimal solution found (tolerance 1.00e-06)
Best objective -1.381918494539e+05, best bound -1.381918494539e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 155436.87
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138191.85
  [DEBUG]   S×d_nominal = 293628.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 293628.72 + -138191.85 = 155436.87
  [DEBUG]   Current θ from Master = 178680.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23243.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2033.72
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 14173.1844, Absolute Gap = 14173.1844, Relative Gap = 0.560711
  Not converged yet (gap = 14173.18 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135284 nonzeros
Model fingerprint: 0xf53e6ab1
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 2033.72 (0.02s)
Loaded MIP start from previous solve with objective 2033.72

Presolve removed 18786 rows and 7626 columns
Presolve time: 0.48s
Presolved: 28467 rows, 13354 columns, 175289 nonzeros
Variable types: 11095 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.649348e+04, 16187 iterations, 3.55 seconds (6.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46493.4770    0  121 2033.72454 46493.4770  2186%     -    4s
H    0     0                    12608.351303 46493.4770   269%     -    4s
H    0     0                    19501.246328 46493.4770   138%     -    4s
H    0     0                    21031.623266 46493.4770   121%     -    4s
H    0     0                    21127.816525 46493.4770   120%     -    4s
H    0     0                    21327.285389 46493.4770   118%     -    4s
H    0     0                    21463.016968 41333.8138  92.6%     -    6s
     0     0 41333.8138    0  226 21463.0170 41333.8138  92.6%     -    6s
     0     0 40736.7653    0  229 21463.0170 40736.7653  89.8%     -    7s
     0     0 40732.7414    0  233 21463.0170 40732.7414  89.8%     -    8s
     0     0 40729.0032    0  234 21463.0170 40729.0032  89.8%     -    8s
     0     0 40728.7406    0  237 21463.0170 40728.7406  89.8%     -    8s
     0     0 37790.6715    0  323 21463.0170 37790.6715  76.1%     -   10s
     0     0 37606.2081    0  317 21463.0170 37606.2081  75.2%     -   11s
     0     0 37430.3345    0  327 21463.0170 37430.3345  74.4%     -   12s
     0     0 37402.2875    0  331 21463.0170 37402.2875  74.3%     -   12s
     0     0 37391.4264    0  332 21463.0170 37391.4264  74.2%     -   12s
     0     0 37195.2601    0  322 21463.0170 37195.2601  73.3%     -   13s
     0     0 37171.0192    0  321 21463.0170 37171.0192  73.2%     -   13s
     0     0 37170.1031    0  327 21463.0170 37170.1031  73.2%     -   13s
     0     0 35668.3510    0  381 21463.0170 35668.3510  66.2%     -   16s
H    0     0                    21500.065678 35276.4121  64.1%     -   17s
H    0     0                    21580.284747 35276.4121  63.5%     -   17s
H    0     0                    21588.426363 35276.4121  63.4%     -   17s
H    0     0                    21605.637780 35276.4121  63.3%     -   17s
     0     0 35276.4121    0  357 21605.6378 35276.4121  63.3%     -   17s
     0     0 35198.5125    0  407 21605.6378 35198.5125  62.9%     -   18s
     0     0 35130.4418    0  405 21605.6378 35130.4418  62.6%     -   19s
H    0     0                    21968.360124 35109.4495  59.8%     -   19s
     0     0 35109.4495    0  413 21968.3601 35109.4495  59.8%     -   19s
     0     0 35093.4278    0  413 21968.3601 35093.4278  59.7%     -   19s
     0     0 35082.9716    0  413 21968.3601 35082.9716  59.7%     -   19s
     0     0 35071.1434    0  407 21968.3601 35071.1434  59.6%     -   20s
     0     0 35068.3337    0  422 21968.3601 35068.3337  59.6%     -   20s
     0     0 35067.3276    0  427 21968.3601 35067.3276  59.6%     -   20s
     0     0 34687.8390    0  403 21968.3601 34687.8390  57.9%     -   22s
     0     0 34571.9628    0  407 21968.3601 34571.9628  57.4%     -   23s
     0     0 34528.9795    0  421 21968.3601 34528.9795  57.2%     -   24s
     0     0 34504.2404    0  426 21968.3601 34504.2404  57.1%     -   24s
     0     0 34476.9840    0  421 21968.3601 34476.9840  56.9%     -   24s
     0     0 34469.7649    0  421 21968.3601 34469.7649  56.9%     -   24s
     0     0 34462.9923    0  422 21968.3601 34462.9923  56.9%     -   25s
     0     0 34461.6154    0  422 21968.3601 34461.6154  56.9%     -   25s
     0     0 34365.6175    0  410 21968.3601 34365.6175  56.4%     -   26s
     0     0 34335.2264    0  421 21968.3601 34335.2264  56.3%     -   26s
     0     0 34328.8969    0  421 21968.3601 34328.8969  56.3%     -   27s
     0     0 34326.2464    0  425 21968.3601 34326.2464  56.3%     -   27s
     0     0 34324.7952    0  427 21968.3601 34324.7952  56.2%     -   27s
H    0     0                    21983.097175 34296.6554  56.0%     -   27s
     0     0 34296.6554    0  411 21983.0972 34296.6554  56.0%     -   27s
H    0     0                    22021.051293 34296.4830  55.7%     -   28s
     0     0 34286.1579    0  435 22021.0513 34286.1579  55.7%     -   28s
     0     0 34283.9192    0  435 22021.0513 34283.9192  55.7%     -   28s
     0     0 34282.8271    0  436 22021.0513 34282.8271  55.7%     -   28s
H    0     0                    22239.043501 34268.6588  54.1%     -   29s
H    0     0                    22305.932621 34268.6588  53.6%     -   29s
     0     0 34268.6588    0  435 22305.9326 34268.6588  53.6%     -   29s
     0     0 34265.2818    0  430 22305.9326 34265.2818  53.6%     -   29s
     0     0 34259.5227    0  439 22305.9326 34259.5227  53.6%     -   29s
     0     0 34258.9541    0  444 22305.9326 34258.9541  53.6%     -   29s
     0     0 34246.5439    0  448 22305.9326 34246.5439  53.5%     -   30s
     0     0 34240.1990    0  448 22305.9326 34240.1990  53.5%     -   31s
     0     0 34239.3724    0  448 22305.9326 34239.3724  53.5%     -   31s
     0     0 34229.7602    0  437 22305.9326 34229.7602  53.5%     -   31s
     0     0 34227.0366    0  443 22305.9326 34227.0366  53.4%     -   32s
     0     0 34226.3915    0  448 22305.9326 34226.3915  53.4%     -   32s
     0     0 34217.8449    0  452 22305.9326 34217.8449  53.4%     -   32s
     0     0 34216.3596    0  449 22305.9326 34216.3596  53.4%     -   33s
     0     0 34211.8797    0  448 22305.9326 34211.8797  53.4%     -   34s
     0     0 34208.0288    0  449 22305.9326 34208.0288  53.4%     -   34s
     0     0 34205.7843    0  457 22305.9326 34205.7843  53.3%     -   34s
     0     0 34205.3575    0  456 22305.9326 34205.3575  53.3%     -   34s
     0     0 34201.7816    0  456 22305.9326 34201.7816  53.3%     -   35s
     0     0 34200.8516    0  456 22305.9326 34200.8516  53.3%     -   35s
H    0     0                    22461.525850 34200.8516  52.3%     -   40s
     0     2 34200.8516    0  456 22461.5259 34200.8516  52.3%     -   40s
    15    32 33315.3533    4  464 22461.5259 33614.2890  49.7%  2473   47s
H   35    64                    22487.763728 33313.4393  48.1%  3558   49s
H   36    64                    22681.045181 33313.4393  46.9%  3510   49s
    63    96 32624.6556    6  441 22681.0452 32907.0177  45.1%  3004   51s
H   69    96                    22843.793976 32907.0177  44.1%  2944   51s
H   75    96                    22913.692665 32907.0177  43.6%  2870   51s
H  117   175                    23118.463954 32907.0177  42.3%  2358   54s
   177   231 32092.0495    9  429 23118.4640 32907.0177  42.3%  2000   57s
H  262   253                    23236.984615 32664.8087  40.6%  1861   59s
   294   288 31814.9858   10  430 23236.9846 32624.6005  40.4%  1788   61s
   360   314 31237.3434   11  317 23236.9846 32624.6005  40.4%  1751   66s
   458   372 26185.9147   12  278 23236.9846 32362.0689  39.3%  1950   72s
   504   406 28092.0560   13  440 23236.9846 32306.2743  39.0%  2052   75s
   615   484 27995.8727   14  396 23236.9846 32306.2743  39.0%  1965   82s
   692   507 27959.4510   15  414 23236.9846 32306.2743  39.0%  1870   86s
   731   548 27912.8273   16  389 23236.9846 31993.6848  37.7%  1838   90s
H  755   548                    23285.887114 31993.6848  37.4%  1807   90s
H  854   610                    23302.493112 31992.9474  37.3%  1712   93s
   867   716 27710.3916   19  436 23302.4931 31992.9474  37.3%  1698   96s
  1123   884 27198.8570   24  348 23302.4931 31990.9405  37.3%  1455  101s
  1396  1012 26518.8627   30  330 23302.4931 31881.4022  36.8%  1299  105s
  1661  1146 25146.0181   38  229 23302.4931 31686.5412  36.0%  1225  112s
  1920  1251 25850.1887   13  272 23302.4931 31686.5412  36.0%  1157  116s
  1994  1288 25582.3565   14  254 23302.4931 31686.5412  36.0%  1147  121s
  2099  1315 24854.6543   15  250 23302.4931 31680.8696  36.0%  1138  126s
  2397  1463 23400.7682   28  266 23302.4931 31529.8747  35.3%  1112  132s
  2585  1488 29540.4591    8  305 23302.4931 31529.8747  35.3%  1085  136s
  2778  1525     cutoff   11      23302.4931 31498.5979  35.2%  1093  141s
  2847  1537     cutoff   11      23302.4931 31498.5979  35.2%  1096  146s
  2955  1555     cutoff   18      23302.4931 31196.1305  33.9%  1101  150s
  3198  1571 23943.8734   12  381 23302.4931 31091.2138  33.4%  1116  160s
  3410  1578     cutoff   13      23302.4931 31091.2138  33.4%  1103  165s
  3659  1565 24156.7393   12  237 23302.4931 30375.8164  30.4%  1109  173s
  3876  1547 23694.0853   13  176 23302.4931 30375.8164  30.4%  1103  177s
  4063  1530     cutoff   13      23302.4931 30172.7260  29.5%  1111  183s
  4239  1530     cutoff   15      23302.4931 29864.0363  28.2%  1124  188s
  4420  1496 25039.1378   12  314 23302.4931 29532.3794  26.7%  1135  194s
  4598  1465     cutoff   14      23302.4931 29527.9245  26.7%  1149  198s
  4814  1462 23643.9750   29  293 23302.4931 28916.0101  24.1%  1147  204s
  4965  1459 23662.0738   13  295 23302.4931 28853.2112  23.8%  1154  209s
  5173  1444 24577.9259   19  268 23302.4931 28679.8043  23.1%  1158  217s
  5416  1459 infeasible   22      23302.4931 28574.1631  22.6%  1159  222s
  5643  1455 25791.1416   17  400 23302.4931 28453.3197  22.1%  1164  227s
  5900  1455     cutoff   22      23302.4931 28232.2206  21.2%  1164  233s
  6171  1428     cutoff   17      23302.4931 27678.7337  18.8%  1161  239s
  6340  1421 25785.8930   23  378 23302.4931 27408.4931  17.6%  1160  244s
  6410  1426 25544.2414   24  359 23302.4931 27351.5650  17.4%  1160  250s
  6594  1408 25067.6476   26  334 23302.4931 27351.5650  17.4%  1152  256s
  6957  1376     cutoff   30      23302.4931 27010.4620  15.9%  1138  263s
  7318  1296 23462.9044   17  303 23302.4931 26624.4865  14.3%  1135  270s
  7763  1245     cutoff   18      23302.4931 26283.9484  12.8%  1121  276s
  8165  1173 23439.2419   17  284 23302.4931 26085.7163  11.9%  1107  283s
  8701  1050     cutoff   17      23302.4931 25852.5975  10.9%  1090  290s
  9293   939     cutoff   32      23302.4931 25542.0452  9.61%  1069  297s
  9841   748 infeasible   19      23302.4931 25260.4313  8.40%  1049  305s
 10797   453 23952.0323   17  276 23302.4931 24809.0684  6.47%  1004  311s
 11960    93     cutoff   29      23302.4931 24809.0684  6.47%   944  317s
 13047     0 23526.2289   26  131 23302.4931 24058.7162  3.25%   884  323s

Cutting planes:
  Learned: 1
  Implied bound: 5
  MIR: 382
  Flow cover: 665
  RLT: 41
  Relax-and-lift: 53

Explored 13264 nodes (11646947 simplex iterations) in 323.03 seconds (1041.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23302.5 23285.9 23237 ... 22305.9

Optimal solution found (tolerance 1.00e-06)
Best objective 2.330249311154e+04, best bound 2.330249311154e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 323.06s
  Master Objective (UB) = 23302.49, θ = 176083.30
  Upper Bound (UB) = 23302.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176083.30
  [DEBUG]   ✓ Scenario 0: θ = 176083.30 ≤ Q = 176083.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176083.30 ≤ Q = 176083.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176083.30 ≤ Q = 176083.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x9717da5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf68e825b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.242516e+13
Presolve removed 2559 rows and 1850 columns
Presolve time: 0.00s
Presolved: 534 rows, 539 columns, 1507 nonzeros
Found heuristic solution: objective 6786987.1492
Variable types: 364 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6786574.4355

Root relaxation: objective -1.458986e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145898.61    0  130 6786574.44 -145898.61   102%     -    0s
H    0     0                    -121475.8572 -145898.61  20.1%     -    0s
H    0     0                    -126715.4979 -145898.61  15.1%     -    0s
H    0     0                    -129347.8457 -134519.73  4.00%     -    0s
     0     0 -134519.73    0   97 -129347.85 -134519.73  4.00%     -    0s
H    0     0                    -132280.8799 -134518.84  1.69%     -    0s
     0     0 -134174.08    0   91 -132280.88 -134174.08  1.43%     -    0s
     0     0 -134164.83    0   91 -132280.88 -134164.83  1.42%     -    0s
H    0     0                    -132766.4654 -134164.83  1.05%     -    0s
     0     0 -133636.52    0   66 -132766.47 -133636.52  0.66%     -    0s
     0     0 -133564.58    0   55 -132766.47 -133564.58  0.60%     -    0s
     0     0 -133559.80    0   55 -132766.47 -133559.80  0.60%     -    0s
     0     0 -133280.16    0   30 -132766.47 -133280.16  0.39%     -    0s
H    0     0                    -132789.2969 -133153.85  0.27%     -    0s
     0     0 -133153.85    0   21 -132789.30 -133153.85  0.27%     -    0s
     0     0 -133153.84    0   19 -132789.30 -133153.84  0.27%     -    0s
     0     0 -133143.88    0   20 -132789.30 -133143.88  0.27%     -    0s
     0     0 -133111.77    0   18 -132789.30 -133111.77  0.24%     -    0s
H    0     0                    -132809.0857 -133095.30  0.22%     -    0s
     0     0 -133095.30    0   20 -132809.09 -133095.30  0.22%     -    0s
     0     0 -133095.30    0   20 -132809.09 -133095.30  0.22%     -    0s
     0     0 -133095.30    0   20 -132809.09 -133095.30  0.22%     -    0s
H    0     0                    -132819.9920 -133095.30  0.21%     -    0s
     0     0 -133095.30    0   60 -132819.99 -133095.30  0.21%     -    0s
     0     0 -133095.30    0   17 -132819.99 -133095.30  0.21%     -    0s
H    0     0                    -132869.6349 -133095.30  0.17%     -    0s
     0     0 -133005.21    0   13 -132869.63 -133005.21  0.10%     -    0s
     0     0 -133005.12    0   16 -132869.63 -133005.12  0.10%     -    0s
     0     0 -132928.07    0   15 -132869.63 -132928.07  0.04%     -    0s
     0     0 -132917.47    0   12 -132869.63 -132917.47  0.04%     -    0s
     0     0 -132910.81    0   12 -132869.63 -132910.81  0.03%     -    0s
H    0     0                    -132870.1955 -132898.77  0.02%     -    0s
     0     0 -132898.77    0   12 -132870.20 -132898.77  0.02%     -    0s
     0     0 -132897.46    0    7 -132870.20 -132897.46  0.02%     -    0s
     0     0 -132896.24    0   11 -132870.20 -132896.24  0.02%     -    0s
     0     0 -132888.00    0    8 -132870.20 -132888.00  0.01%     -    0s
     0     0 -132888.00    0    9 -132870.20 -132888.00  0.01%     -    0s
     0     0 -132882.92    0    6 -132870.20 -132882.92  0.01%     -    0s
H    0     0                    -132876.2408 -132880.98  0.00%     -    0s
     0     0 -132880.27    0    4 -132876.24 -132880.27  0.00%     -    0s
     0     0 -132877.41    0    2 -132876.24 -132877.41  0.00%     -    0s
H    0     0                    -132876.7994 -132877.41  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 4
  Flow cover: 5

Explored 1 nodes (1238 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -132877 -132876 -132870 ... -129348
No other solutions better than -132877

Optimal solution found (tolerance 1.00e-06)
Best objective -1.328767993890e+05, best bound -1.328767993890e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 154423.25
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132876.80
  [DEBUG]   S×d_nominal = 287300.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 287300.05 + -132876.80 = 154423.25
  [DEBUG]   Current θ from Master = 176083.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21660.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1642.44
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 12198.5033, Absolute Gap = 12198.5033, Relative Gap = 0.523485
  Not converged yet (gap = 12198.50 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178539 nonzeros
Model fingerprint: 0x6518f68f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 1642.44 (0.02s)
Loaded MIP start from previous solve with objective 1642.44

Presolve removed 25048 rows and 10168 columns
Presolve time: 0.57s
Presolved: 37495 rows, 17052 columns, 231879 nonzeros
Variable types: 14793 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37495 rows, 17052 columns, 231879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41723    3.4212521e+04   0.000000e+00   1.742946e+07      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.593143e+04, 22368 iterations, 6.34 seconds (12.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45931.4307    0  134 1642.43704 45931.4307  2697%     -    7s
H    0     0                    9023.8923489 45931.4307   409%     -    7s
H    0     0                    14418.238465 45931.4307   219%     -    7s
H    0     0                    16538.311269 45931.4307   178%     -    7s
H    0     0                    16772.508039 45931.4307   174%     -    7s
H    0     0                    18058.262396 45931.4307   154%     -    7s
H    0     0                    18182.361392 45931.4307   153%     -    7s
H    0     0                    18242.471372 45931.4307   152%     -    7s
H    0     0                    18535.694242 45931.4307   148%     -    7s
H    0     0                    19032.459969 45931.4307   141%     -    7s
     0     0 40561.6773    0  234 19032.4600 40561.6773   113%     -   12s
H    0     0                    19083.971300 40560.6421   113%     -   12s
     0     0 40016.1804    0  248 19083.9713 40016.1804   110%     -   13s
     0     0 40016.1804    0  245 19083.9713 40016.1804   110%     -   14s
     0     0 40016.1804    0  241 19083.9713 40016.1804   110%     -   14s
     0     0 37390.3113    0  327 19083.9713 37390.3113  95.9%     -   18s
H    0     0                    19229.793268 37390.3113  94.4%     -   18s
H    0     0                    19279.962411 37390.3113  93.9%     -   18s
H    0     0                    19280.233925 37390.3113  93.9%     -   18s
H    0     0                    19280.761699 37390.3113  93.9%     -   18s
H    0     0                    19345.581582 37390.3113  93.3%     -   18s
H    0     0                    19531.913960 36766.2376  88.2%     -   20s
H    0     0                    19560.774515 36766.2376  88.0%     -   20s
H    0     0                    19721.854830 36766.2376  86.4%     -   20s
H    0     0                    19852.884170 36766.2376  85.2%     -   20s
H    0     0                    19853.842703 36766.2376  85.2%     -   20s
     0     0 36766.2376    0  365 19853.8427 36766.2376  85.2%     -   20s
H    0     0                    20059.880007 36574.2473  82.3%     -   22s
H    0     0                    20082.028120 36574.2473  82.1%     -   22s
H    0     0                    20152.042666 36574.2473  81.5%     -   22s
H    0     0                    20237.651001 36574.2473  80.7%     -   22s
     0     0 36574.2473    0  377 20237.6510 36574.2473  80.7%     -   22s
     0     0 36450.0744    0  375 20237.6510 36450.0744  80.1%     -   22s
     0     0 36418.3860    0  335 20237.6510 36418.3860  80.0%     -   23s
     0     0 36409.9623    0  348 20237.6510 36409.9623  79.9%     -   23s
     0     0 36409.2759    0  352 20237.6510 36409.2759  79.9%     -   23s
     0     0 35009.7431    0  365 20237.6510 35009.7431  73.0%     -   30s
H    0     0                    20255.415326 35008.4138  72.8%     -   30s
H    0     0                    20333.724172 35008.4138  72.2%     -   30s
     0     0 34763.1575    0  378 20333.7242 34763.1575  71.0%     -   32s
     0     0 34639.1662    0  374 20333.7242 34639.1662  70.4%     -   34s
     0     0 34537.7637    0  369 20333.7242 34537.7637  69.9%     -   35s
     0     0 34507.5321    0  379 20333.7242 34507.5321  69.7%     -   36s
     0     0 34501.2477    0  381 20333.7242 34501.2477  69.7%     -   36s
     0     0 34488.9002    0  376 20333.7242 34488.9002  69.6%     -   36s
     0     0 34484.9728    0  372 20333.7242 34484.9728  69.6%     -   37s
     0     0 34484.4528    0  376 20333.7242 34484.4528  69.6%     -   37s
     0     0 33912.2518    0  403 20333.7242 33912.2518  66.8%     -   43s
     0     0 33826.1813    0  458 20333.7242 33826.1813  66.4%     -   44s
     0     0 33753.9872    0  449 20333.7242 33753.9872  66.0%     -   46s
     0     0 33722.7417    0  454 20333.7242 33722.7417  65.8%     -   46s
     0     0 33713.7002    0  460 20333.7242 33713.7002  65.8%     -   47s
     0     0 33707.2706    0  462 20333.7242 33707.2706  65.8%     -   47s
     0     0 33705.7335    0  458 20333.7242 33705.7335  65.8%     -   47s
     0     0 33702.3213    0  463 20333.7242 33702.3213  65.7%     -   47s
     0     0 33702.1327    0  467 20333.7242 33702.1327  65.7%     -   47s
H    0     0                    20493.827823 33652.7646  64.2%     -   49s
     0     0 33652.7646    0  417 20493.8278 33652.7646  64.2%     -   49s
H    0     0                    20545.829131 33652.6497  63.8%     -   49s
H    0     0                    20546.751645 33652.6497  63.8%     -   49s
     0     0 33648.2918    0  418 20546.7516 33648.2918  63.8%     -   49s
     0     0 33643.5232    0  428 20546.7516 33643.5232  63.7%     -   50s
     0     0 33643.1253    0  428 20546.7516 33643.1253  63.7%     -   50s
     0     0 33623.9929    0  420 20546.7516 33623.9929  63.6%     -   51s
H    0     0                    20644.561631 33618.9956  62.8%     -   51s
H    0     0                    20664.922280 33618.9956  62.7%     -   51s
H    0     0                    20680.399908 33618.9956  62.6%     -   51s
     0     0 33618.9956    0  430 20680.3999 33618.9956  62.6%     -   52s
     0     0 33611.4040    0  431 20680.3999 33611.4040  62.5%     -   52s
     0     0 33605.6730    0  436 20680.3999 33605.6730  62.5%     -   53s
     0     0 33601.2411    0  437 20680.3999 33601.2411  62.5%     -   53s
     0     0 33599.9494    0  437 20680.3999 33599.9494  62.5%     -   53s
     0     0 33595.9535    0  440 20680.3999 33595.9535  62.5%     -   54s
H    0     0                    20719.317452 33595.1718  62.1%     -   54s
H    0     0                    20720.620272 33595.1718  62.1%     -   54s
     0     0 33594.0426    0  438 20720.6203 33594.0426  62.1%     -   54s
     0     0 33593.7394    0  435 20720.6203 33593.7394  62.1%     -   54s
     0     0 33591.9111    0  437 20720.6203 33591.9111  62.1%     -   55s
     0     0 33589.9877    0  433 20720.6203 33589.9877  62.1%     -   55s
     0     0 33589.0283    0  438 20720.6203 33589.0283  62.1%     -   56s
     0     0 33588.4847    0  433 20720.6203 33588.4847  62.1%     -   56s
H    0     0                    21040.991443 33588.0857  59.6%     -   57s
H    0     0                    21089.051744 33588.0857  59.3%     -   57s
H    0     0                    21131.284227 33588.0857  58.9%     -   57s
     0     0 33588.0857    0  436 21131.2842 33588.0857  58.9%     -   57s
     0     0 33587.7412    0  449 21131.2842 33587.7412  58.9%     -   58s
     0     0 33587.6665    0  449 21131.2842 33587.6665  58.9%     -   58s
H    0     0                    21170.724932 33587.6665  58.7%     -   66s
H    0     0                    21172.808682 33587.6665  58.6%     -   67s
     0     2 33587.6665    0  449 21172.8087 33587.6665  58.6%     -   67s
     1     4 33295.8548    1  398 21172.8087 33587.0849  58.6%  2765   70s
     7    16 32460.1549    3  428 21172.8087 32930.1377  55.5%  2937   76s
    31    54 31752.0731    5  384 21172.8087 32367.6701  52.9%  4514   87s
    53    86 31642.3855    6  313 21172.8087 32367.6701  52.9%  5742   91s
H   55    86                    21182.782052 32367.6701  52.8%  5619   91s
H   56    86                    21227.334456 32367.6701  52.5%  5577   91s
H   63    86                    21357.251192 32367.6701  51.6%  5275   91s
H   71    86                    21360.458875 32367.6701  51.5%  4975   91s
H   84    86                    21614.829861 32367.6701  49.7%  4357   91s
    85   205 31630.4285    7  373 21614.8299 32367.6701  49.7%  4333   99s
H  204   274                    21615.854994 32367.6701  49.7%  2386  102s
H  224   274                    21626.768479 32367.6701  49.7%  2324  102s
H  226   274                    21643.964494 32367.6701  49.5%  2333  102s
   273   356 31480.2694    9  282 21643.9645 32367.6701  49.5%  2115  106s
   357   432 30847.2692   11  270 21643.9645 32367.6701  49.5%  2025  110s
   439   498 31370.4283   11  290 21643.9645 32367.6701  49.5%  1950  116s
   517   529 31318.5314   10  277 21643.9645 32367.6701  49.5%  1923  120s
H  582   571                    21720.673812 32022.1673  47.4%  1984  123s
   600   663 31253.9295   12  286 21720.6738 32022.1673  47.4%  1962  126s
   705   747 31035.5334   13  344 21720.6738 32022.1673  47.4%  1804  132s
   811   793 30657.6598   15  403 21720.6738 32022.1673  47.4%  1697  139s
   899   822 29346.8334   15  236 21720.6738 32022.1673  47.4%  1675  142s
   934   852 24575.5506   16  325 21720.6738 32022.1673  47.4%  1669  145s
H 1001   889                    21743.752706 32022.1673  47.3%  1673  148s
  1011   985 30389.2591   17  393 21743.7527 32022.1673  47.3%  1666  152s
  1135  1084 29562.5272   20  331 21743.7527 32022.1673  47.3%  1575  157s
  1261  1110 28015.0890   22  173 21743.7527 32022.1673  47.3%  1506  162s
  1387  1151 28772.8064   21  164 21743.7527 32022.1673  47.3%  1466  168s
  1468  1199 28899.5354   23  335 21743.7527 32022.1673  47.3%  1493  175s
  1649  1364 23283.7554   24  253 21743.7527 32022.1673  47.3%  1531  186s
  1775  1439 27132.8603   24  350 21743.7527 32022.1673  47.3%  1512  193s
  1869  1526 26470.0959   25  356 21743.7527 32022.1673  47.3%  1476  197s
  1994  1609     cutoff   25      21743.7527 32022.1673  47.3%  1451  205s
  2212  1728 24355.3274   27  202 21743.7527 32022.1673  47.3%  1408  216s
  2368  1830     cutoff   30      21743.7527 32022.1673  47.3%  1384  221s
  2554  1961 23907.8574   33  178 21743.7527 32022.1673  47.3%  1349  227s
  2787  2055 23379.5443   38  174 21743.7527 31504.7209  44.9%  1304  232s
  2999  2171     cutoff   41      21743.7527 31493.6669  44.8%  1279  238s
  3175  2255 23719.4440   12  225 21743.7527 31493.6669  44.8%  1273  243s
  3326  2338 23664.3739   13  222 21743.7527 31493.6669  44.8%  1250  250s
  3482  2431 22852.2538   18  140 21743.7527 31493.6669  44.8%  1254  256s
  3674  2523 28342.6860    8  289 21743.7527 31493.6669  44.8%  1249  264s
  3850  2589 24177.2586   10  258 21743.7527 31493.6669  44.8%  1249  272s
  4035  2658 25156.5826   15  316 21743.7527 31493.6669  44.8%  1250  281s
  4236  2745 23732.6226   18  207 21743.7527 31493.6669  44.8%  1249  289s
  4419  2798     cutoff   25      21743.7527 31110.2490  43.1%  1261  297s
  4532  2814 29090.2258    9  302 21743.7527 31110.2490  43.1%  1277  302s
  4580  2858 28705.5955   10  304 21743.7527 31094.7635  43.0%  1281  306s
H 4598  2858                    21754.831193 31094.7635  42.9%  1283  306s
H 4629  2857                    21758.821423 31094.7635  42.9%  1286  306s
  4639  2858 23478.2117   47  449 21758.8214 31094.7635  42.9%  1286  337s
  4641  2859 24166.3330   21  134 21758.8214 31094.7635  42.9%  1285  346s
  4642  2860 22846.1674   23  296 21758.8214 31094.7635  42.9%  1285  353s
  4643  2861 29126.2020   13  384 21758.8214 31094.7635  42.9%  1285  359s
  4644  2861 24319.3607   34  396 21758.8214 31094.7635  42.9%  1284  362s
  4645  2862 23512.3032   18  412 21758.8214 31094.7635  42.9%  1284  366s
  4648  2864 23424.2817   26  414 21758.8214 31094.7635  42.9%  1283  370s
  4651  2866 24739.7785   12  475 21758.8214 31094.7635  42.9%  1282  375s
  4656  2869 23000.0741   20  413 21758.8214 31094.7635  42.9%  1281  380s
  4659  2871 27286.3967   24  452 21758.8214 31094.7635  42.9%  1280  385s
  4663  2874 26741.9440   35  514 21758.8214 31094.7635  42.9%  1279  390s
  4666  2876 24357.8473   14  424 21758.8214 31094.7635  42.9%  1278  395s
  4670  2879 21941.9302   62  423 21758.8214 31094.7635  42.9%  1277  400s
  4673  2881 26202.2204   25  431 21758.8214 31094.7635  42.9%  1276  412s
  4674  2881 23664.0381   36  431 21758.8214 31094.7635  42.9%  1276  418s
  4675  2885 31094.7635   16  403 21758.8214 31094.7635  42.9%  1293  422s
  4677  2888 31094.7635   17  398 21758.8214 31094.7635  42.9%  1293  428s
  4681  2895 31094.7635   18  414 21758.8214 31094.7635  42.9%  1296  432s
  4689  2908 31094.7635   19  424 21758.8214 31094.7635  42.9%  1300  440s
  4705  2923 30171.1103   20  310 21758.8214 31094.7635  42.9%  1317  449s
  4725  2948 30758.5857   21  266 21758.8214 31094.7635  42.9%  1338  453s
  4757  3003 30050.1438   22  258 21758.8214 31094.7635  42.9%  1348  459s
  4847  3003 27994.0014   23  268 21758.8214 31094.7635  42.9%  1373  467s
  4939  2996 27841.2337   24  272 21758.8214 31094.7635  42.9%  1385  475s
  5017  2984 27501.5687   25  249 21758.8214 31094.7635  42.9%  1414  483s
  5061  2979 24560.4784   24  221 21758.8214 31094.7635  42.9%  1436  490s
  5114  2976 22648.9119   26  219 21758.8214 31094.7635  42.9%  1458  498s
  5157  2975 26356.4504   26  328 21758.8214 31094.7635  42.9%  1479  503s
  5202  2987     cutoff   25      21758.8214 31094.7635  42.9%  1503  510s
  5307  2989 22958.8581   29  114 21758.8214 31094.7635  42.9%  1527  519s
  5373  2979 infeasible   31      21758.8214 30274.1836  39.1%  1545  524s
  5432  2987 23297.5298   23  299 21758.8214 30274.1836  39.1%  1565  531s
  5490  2988 22858.4684   25  270 21758.8214 29869.9870  37.3%  1589  539s
  5544  2995 22747.5073   27  269 21758.8214 29789.8187  36.9%  1619  545s
  5629  2988 22565.4179   31  251 21758.8214 29789.8187  36.9%  1624  550s
  5718  2970     cutoff   32      21758.8214 29501.6777  35.6%  1626  555s
  5787  2951 27329.1894   22  298 21758.8214 29356.3500  34.9%  1626  560s
  5871  2932 26262.4829   23  290 21758.8214 29356.3500  34.9%  1623  567s
  5954  2923 24706.9865   25  268 21758.8214 29236.1799  34.4%  1622  573s
  6062  2903 23882.8318   27  305 21758.8214 29236.1799  34.4%  1618  580s
  6173  2877     cutoff   29      21758.8214 28743.9813  32.1%  1616  586s
  6292  2835 22293.8029   28  219 21758.8214 28641.1051  31.6%  1615  592s
  6431  2801     cutoff   29      21758.8214 27687.4561  27.2%  1610  598s
  6544  2777 22629.2116   29  265 21758.8214 27653.0624  27.1%  1614  606s
  6673  2740     cutoff   33      21758.8214 27653.0624  27.1%  1612  614s
  6798  2718     cutoff   33      21758.8214 27653.0624  27.1%  1617  620s
  6907  2698 22511.3001   25  263 21758.8214 26576.5719  22.1%  1614  626s
  7017  2674     cutoff   26      21758.8214 26576.5719  22.1%  1613  633s
  7172  2647     cutoff   26      21758.8214 26322.3598  21.0%  1613  641s
  7282  2624 23078.3534   28  225 21758.8214 25596.4370  17.6%  1612  651s
  7452  2558 21993.9353   30  280 21758.8214 25596.4370  17.6%  1610  658s
  7652  2517 23212.1930   28  175 21758.8214 25596.4370  17.6%  1607  666s
  7833  2431 21847.1324   38   99 21758.8214 24985.7007  14.8%  1606  673s
  7954  2379 23271.4309   23  387 21758.8214 24557.5311  12.9%  1605  682s
  8073  2339 22612.5371   24  365 21758.8214 24551.0132  12.8%  1601  689s
H 8152  2168                    21800.151066 24551.0132  12.6%  1600  689s
  8228  2119 22144.7249   27  292 21800.1511 24551.0132  12.6%  1598  700s
  8475  2027 22426.6846   26  208 21800.1511 24280.3177  11.4%  1592  707s
H 8477  1889                    21815.912288 24280.3177  11.3%  1592  707s
  8539  1822 22425.2621   27  210 21815.9123 24003.2838  10.0%  1593  715s
  8851  1641 22427.4122   30  143 21815.9123 23662.2531  8.46%  1580  725s
  9128  1374     cutoff   35      21815.9123 23482.8631  7.64%  1565  732s
  9481  1224     cutoff   28      21815.9123 23278.6506  6.70%  1534  738s
  9567  1093 22385.2055   31  279 21815.9123 23278.6506  6.70%  1532  748s
  9795   906 21828.0691   33  278 21815.9123 23107.5082  5.92%  1511  755s

Cutting planes:
  MIR: 266
  Mixing: 1
  Flow cover: 869
  RLT: 14
  Relax-and-lift: 65

Explored 10272 nodes (15014658 simplex iterations) in 756.49 seconds (2159.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21815.9 21800.2 21758.8 ... 21614.8

Optimal solution found (tolerance 1.00e-06)
Best objective 2.181591228817e+04, best bound 2.181591228817e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 756.50s
  Master Objective (UB) = 21815.91, θ = 174118.40
  Upper Bound (UB) = 21815.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 174118.40
  [DEBUG]   ✓ Scenario 0: θ = 174118.40 ≤ Q = 174118.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 174118.40 ≤ Q = 174118.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 174118.40 ≤ Q = 174118.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 174118.40 ≤ Q = 174118.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7f51d511
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x80ae2aef
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.258253e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6953730.2271
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.470736e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147073.58    0  126 6953730.23 -147073.58   102%     -    0s
H    0     0                    -108457.1462 -147073.58  35.6%     -    0s
H    0     0                    -109660.9796 -147073.58  34.1%     -    0s
H    0     0                    -115455.1610 -147073.58  27.4%     -    0s
H    0     0                    -125122.4701 -147073.58  17.5%     -    0s
     0     0 -131606.22    0   77 -125122.47 -131606.22  5.18%     -    0s
H    0     0                    -129858.4190 -131567.38  1.32%     -    0s
     0     0 -131235.17    0   79 -129858.42 -131235.17  1.06%     -    0s
     0     0 -131207.87    0   79 -129858.42 -131207.87  1.04%     -    0s
     0     0 -130735.20    0   66 -129858.42 -130735.20  0.68%     -    0s
H    0     0                    -130032.8901 -130680.14  0.50%     -    0s
     0     0 -130646.10    0   71 -130032.89 -130646.10  0.47%     -    0s
     0     0 -130491.76    0   58 -130032.89 -130491.76  0.35%     -    0s
     0     0 -130488.29    0   56 -130032.89 -130488.29  0.35%     -    0s
     0     0 -130417.23    0   57 -130032.89 -130417.23  0.30%     -    0s
     0     0 -130401.32    0   56 -130032.89 -130401.32  0.28%     -    0s
     0     0 -130399.70    0   56 -130032.89 -130399.70  0.28%     -    0s
     0     0 -130206.76    0    9 -130032.89 -130206.76  0.13%     -    0s
     0     0 -130206.37    0    9 -130032.89 -130206.37  0.13%     -    0s
H    0     0                    -130037.4915 -130184.36  0.11%     -    0s
     0     0 -130145.81    0    9 -130037.49 -130145.81  0.08%     -    0s
     0     0 -130145.54    0    6 -130037.49 -130145.54  0.08%     -    0s
     0     0 -130121.33    0    4 -130037.49 -130121.33  0.06%     -    0s
     0     0 -130121.33    0    6 -130045.46 -130121.33  0.06%     -    0s
H    0     0                    -130068.8197 -130121.33  0.04%     -    0s
H    0     0                    -130099.6786 -130121.33  0.02%     -    0s
     0     0 -130103.01    0    2 -130099.68 -130103.01  0.00%     -    0s
H    0     0                    -130100.7600 -130103.01  0.00%     -    0s

Explored 1 nodes (750 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130101 -130101 -130100 ... -125122
No other solutions better than -130101

Optimal solution found (tolerance 1.00e-06)
Best objective -1.301007600342e+05, best bound -1.301007600342e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 154021.69
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130100.76
  [DEBUG]   S×d_nominal = 284122.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 284122.45 + -130100.76 = 154021.69
  [DEBUG]   Current θ from Master = 174118.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20096.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1719.21
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 10711.9225, Absolute Gap = 10711.9225, Relative Gap = 0.491014
  Not converged yet (gap = 10711.92 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221794 nonzeros
Model fingerprint: 0x5040fbb0
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31310 rows and 12710 columns
Presolve time: 0.72s
Presolved: 46523 rows, 20750 columns, 288469 nonzeros
Variable types: 18491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46523 rows, 20750 columns, 288469 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30030    5.4074063e+03   0.000000e+00   8.412326e+07      5s
Concurrent spin time: 0.37s

Solved with dual simplex

Root relaxation: objective 4.586130e+04, 28318 iterations, 8.86 seconds (17.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45861.2968    0  141 -222897.65 45861.2968   121%     -    9s
H    0     0                    -211697.4339 45861.2968   122%     -    9s
H    0     0                    -192265.0850 45861.2968   124%     -   10s
H    0     0                    -191802.7653 45861.2968   124%     -   10s
H    0     0                    -180591.4237 45861.2968   125%     -   10s
H    0     0                    -162716.8962 45861.2968   128%     -   10s
H    0     0                    -157541.6174 45861.2968   129%     -   10s
H    0     0                    -153897.0853 45861.2968   130%     -   10s
H    0     0                    -151167.3633 45861.2968   130%     -   10s
H    0     0                    -151042.3970 45861.2968   130%     -   10s
H    0     0                    -150852.3561 45861.2968   130%     -   10s
H    0     0                    -150733.2751 45861.2968   130%     -   10s
H    0     0                    -83678.23185 45861.2968   155%     -   10s
H    0     0                    -83605.61546 45861.2968   155%     -   10s
H    0     0                    -26036.95646 45861.2968   276%     -   10s
H    0     0                    -8142.910096 45861.2968   663%     -   10s
H    0     0                    -1356.010339 45861.2968  3482%     -   10s
H    0     0                    12628.484175 45861.2968   263%     -   10s
H    0     0                    14839.027350 45861.2968   209%     -   10s
H    0     0                    17331.000321 45861.2968   165%     -   10s
H    0     0                    17354.205040 45861.2968   164%     -   10s
H    0     0                    17354.367775 45861.2968   164%     -   10s
H    0     0                    17390.013330 45861.2968   164%     -   11s
H    0     0                    17807.980195 40843.6385   129%     -   18s
H    0     0                    17959.363435 40843.6385   127%     -   18s
H    0     0                    18094.110661 40843.6385   126%     -   18s
H    0     0                    18133.985024 40843.6385   125%     -   18s
H    0     0                    18244.485152 40843.6385   124%     -   18s
H    0     0                    18258.446242 40843.6385   124%     -   18s
H    0     0                    18369.298845 40843.6385   122%     -   18s
     0     0 40843.6385    0  241 18369.2988 40843.6385   122%     -   18s
     0     0 39826.2527    0  225 18369.2988 39826.2527   117%     -   21s
     0     0 39826.2527    0  226 18369.2988 39826.2527   117%     -   23s
     0     0 39826.2527    0  236 18369.2988 39826.2527   117%     -   23s
     0     0 37331.7472    0  246 18369.2988 37331.7472   103%     -   24s
     0     0 37331.7472    0  246 18369.2988 37331.7472   103%     -   24s
     0     0 37331.7472    0  247 18369.2988 37331.7472   103%     -   25s
H    0     0                    18479.339279 37331.7472   102%     -   25s
H    0     0                    18528.896572 37331.7472   101%     -   25s
     0     0 37326.2552    0  336 18528.8966 37326.2552   101%     -   31s
     0     0 36681.0837    0  354 18528.8966 36681.0837  98.0%     -   34s
     0     0 36565.7473    0  360 18528.8966 36565.7473  97.3%     -   36s
     0     0 36536.8451    0  360 18528.8966 36536.8451  97.2%     -   37s
     0     0 36425.8017    0  367 18528.8966 36425.8017  96.6%     -   38s
     0     0 36424.2228    0  370 18528.8966 36424.2228  96.6%     -   39s
     0     0 36423.7572    0  369 18528.8966 36423.7572  96.6%     -   39s
H    0     0                    18742.117748 35076.0247  87.2%     -   47s
H    0     0                    18812.169682 35076.0247  86.5%     -   47s
H    0     0                    18813.309494 35076.0247  86.4%     -   47s
H    0     0                    18906.725040 35076.0247  85.5%     -   47s
H    0     0                    18985.279368 35076.0247  84.8%     -   47s
     0     0 35076.0247    0  355 18985.2794 35076.0247  84.8%     -   47s
H    0     0                    18988.130370 34685.8471  82.7%     -   51s
H    0     0                    20391.371727 34685.8471  70.1%     -   51s
H    0     0                    20447.377632 34685.8471  69.6%     -   51s
     0     0 34685.8471    0  393 20447.3776 34685.8471  69.6%     -   51s
     0     0 34602.5773    0  390 20447.3776 34602.5773  69.2%     -   52s
     0     0 34469.3630    0  395 20447.3776 34469.3630  68.6%     -   53s
     0     0 34415.7245    0  402 20447.3776 34415.7245  68.3%     -   55s
     0     0 34399.0760    0  394 20447.3776 34399.0760  68.2%     -   56s
     0     0 34382.4045    0  402 20447.3776 34382.4045  68.2%     -   57s
     0     0 34377.5407    0  403 20447.3776 34377.5407  68.1%     -   57s
     0     0 34356.5850    0  408 20447.3776 34356.5850  68.0%     -   58s
     0     0 34346.2488    0  415 20447.3776 34346.2488  68.0%     -   58s
     0     0 34340.8031    0  407 20447.3776 34340.8031  67.9%     -   58s
     0     0 34339.6465    0  402 20447.3776 34339.6465  67.9%     -   59s
H    0     0                    20700.352969 33864.0209  63.6%     -   66s
H    0     0                    20704.262358 33864.0209  63.6%     -   66s
     0     0 33864.0209    0  443 20704.2624 33864.0209  63.6%     -   66s
     0     0 33714.4825    0  442 20704.2624 33714.4825  62.8%     -   68s
     0     0 33689.2733    0  439 20704.2624 33689.2733  62.7%     -   69s
     0     0 33666.4986    0  415 20704.2624 33666.4986  62.6%     -   70s
     0     0 33656.1655    0  409 20704.2624 33656.1655  62.6%     -   71s
     0     0 33651.9531    0  466 20704.2624 33651.9531  62.5%     -   71s
     0     0 33650.1922    0  425 20704.2624 33650.1922  62.5%     -   72s
     0     0 33647.5333    0  426 20704.2624 33647.5333  62.5%     -   72s
     0     0 33646.0653    0  428 20704.2624 33646.0653  62.5%     -   72s
     0     0 33637.4860    0  432 20704.2624 33637.4860  62.5%     -   73s
     0     0 33634.2661    0  434 20704.2624 33634.2661  62.5%     -   73s
     0     0 33633.9764    0  432 20704.2624 33633.9764  62.4%     -   73s
     0     0 33591.7684    0  422 20704.2624 33591.7684  62.2%     -   75s
     0     0 33573.0356    0  430 20704.2624 33573.0356  62.2%     -   76s
     0     0 33569.0001    0  418 20704.2624 33569.0001  62.1%     -   76s
     0     0 33567.6003    0  426 20704.2624 33567.6003  62.1%     -   76s
     0     0 33547.1447    0  442 20704.2624 33547.1447  62.0%     -   78s
     0     0 33545.4511    0  444 20704.2624 33545.4511  62.0%     -   78s
     0     0 33543.8791    0  450 20704.2624 33543.8791  62.0%     -   78s
     0     0 33543.5009    0  452 20704.2624 33543.5009  62.0%     -   78s
     0     0 33534.0969    0  443 20704.2624 33534.0969  62.0%     -   79s
     0     0 33531.6273    0  448 20704.2624 33531.6273  62.0%     -   80s
     0     0 33531.2930    0  442 20704.2624 33531.2930  62.0%     -   80s
     0     0 33527.6773    0  444 20704.2624 33527.6773  61.9%     -   81s
H    0     0                    20784.605550 33525.1364  61.3%     -   81s
H    0     0                    20806.256816 33525.1364  61.1%     -   81s
     0     0 33525.1364    0  445 20806.2568 33525.1364  61.1%     -   81s
     0     0 33524.9110    0  449 20806.2568 33524.9110  61.1%     -   82s
     0     0 33522.8662    0  457 20806.2568 33522.8662  61.1%     -   82s
     0     0 33521.9673    0  454 20806.2568 33521.9673  61.1%     -   83s
     0     0 33521.5703    0  452 20806.2568 33521.5703  61.1%     -   83s
     0     0 33520.0507    0  452 20806.2568 33520.0507  61.1%     -   84s
H    0     0                    20861.243582 33520.0507  60.7%     -   95s
H    0     0                    20903.144582 33520.0507  60.4%     -   95s
H    0     2                    20914.129007 33520.0507  60.3%     -   96s
     0     2 33520.0507    0  452 20914.1290 33520.0507  60.3%     -   96s
     3     8 33300.8105    2  430 20914.1290 33423.4863  59.8%  1668  100s
    15    32 32789.5648    4  433 20914.1290 33161.7333  58.6%  4085  109s
    31    53 30294.8775    5  237 20914.1290 32809.2592  56.9%  6168  117s
    52    85 29208.2149    6  342 20914.1290 32809.2592  56.9%  6205  124s
H   59    85                    20926.544956 32809.2592  56.8%  6170  124s
H   63    85                    21162.970677 32809.2592  55.0%  6079  124s
    84   204 29101.2087    7  338 21162.9707 32809.2592  55.0%  5191  131s
H  207   300                    21211.362120 32809.2592  54.7%  2996  138s
H  231   300                    21238.528758 32809.2592  54.5%  2840  138s
   309   358 28896.8031   12  332 21238.5288 32809.2592  54.5%  2474  145s
   396   382 22244.3098   13  244 21238.5288 32809.2592  54.5%  2264  151s
   430   399 23499.4086   12  258 21238.5288 32809.2592  54.5%  2242  157s
   482   424 23498.6809   12  251 21238.5288 32809.2592  54.5%  2259  164s
   531   453 24100.3436   13  258 21238.5288 32809.2592  54.5%  2269  170s
   582   478 24163.9015   13  251 21238.5288 32809.2592  54.5%  2269  176s
   643   504 24044.3416   14  259 21238.5288 32809.2592  54.5%  2200  183s
   705   547 23594.2538   17  234 21238.5288 32809.2592  54.5%  2128  188s
   764   589 23311.9104   20  221 21238.5288 32809.2592  54.5%  2062  195s
   826   626 23129.5125   23  205 21238.5288 32809.2592  54.5%  2013  200s
H  874   626                    21271.885182 32788.5343  54.1%  1969  200s
   907   682 23099.5966   25  193 21271.8852 32187.6179  51.3%  1929  205s
   993   754 22097.8635   30  190 21271.8852 32187.6179  51.3%  1878  212s
  1101   837 22064.1751   31  190 21271.8852 32187.6179  51.3%  1804  218s
  1217   935 21972.2595   38  166 21271.8852 32187.6179  51.3%  1740  224s
  1358  1025 21805.6346   44  120 21271.8852 32187.6179  51.3%  1659  231s
  1498  1146 21631.4663   47   88 21271.8852 32187.6179  51.3%  1587  237s
  1652  1235 21466.5855   54   94 21271.8852 32187.6179  51.3%  1523  243s
  1821  1292 23961.7423   14  199 21271.8852 32187.6179  51.3%  1457  249s
  1943  1320 23117.7101   15  119 21271.8852 32187.6179  51.3%  1456  252s
  1979  1358 23081.7163   16   98 21271.8852 31676.9023  48.9%  1467  258s
  2019  1407     cutoff   17      21271.8852 31676.9023  48.9%  1484  264s
  2080  1484     cutoff   17      21271.8852 31676.9023  48.9%  1485  270s
  2177  1567 25201.8946   11  286 21271.8852 31676.9023  48.9%  1474  276s
  2311  1684 25070.6041   12  271 21271.8852 31676.9023  48.9%  1445  280s
  2499  1793 24980.2634   13  262 21271.8852 31538.6391  48.3%  1386  288s
  2674  1854 24790.3416   14  273 21271.8852 31538.6391  48.3%  1360  295s
  2810  1936 24660.3997   15  295 21271.8852 31538.6391  48.3%  1359  301s
  2986  2025 24341.9132   16  236 21271.8852 31456.9242  47.9%  1345  307s
  3128  2071 24154.3336   17  235 21271.8852 31395.0452  47.6%  1354  316s
  3224  2133 24033.2447   18  272 21271.8852 31330.2483  47.3%  1352  325s
  3360  2256 23317.5259   23  202 21271.8852 31314.8048  47.2%  1367  330s
  3498  2445 21491.6729   34  131 21271.8852 31314.8048  47.2%  1370  337s
  3757  2446 24794.1986   23  452 21271.8852 31314.8048  47.2%  1337  365s
  3759  2447 26512.6855   16  141 21271.8852 31314.8048  47.2%  1337  376s
  3760  2448 24115.3430   32  328 21271.8852 31314.8048  47.2%  1336  389s
  3761  2449 24699.7404   21  411 21271.8852 31314.8048  47.2%  1336  396s
  3762  2449 21880.9950   25  403 21271.8852 31314.8048  47.2%  1336  402s
  3763  2450 21591.7718   25  462 21271.8852 31314.8048  47.2%  1335  405s
  3765  2451 23837.3901   14  414 21271.8852 31314.8048  47.2%  1335  410s
  3769  2454 21824.6011   32  467 21271.8852 31314.8048  47.2%  1333  416s
  3770  2455 27624.7154   13  436 21271.8852 31314.8048  47.2%  1333  420s
  3774  2457 22960.9270   18  466 21271.8852 31314.8048  47.2%  1331  427s
  3776  2459 22641.0040   23  431 21271.8852 31314.8048  47.2%  1331  431s
  3779  2461 22143.3656   17  430 21271.8852 31314.8048  47.2%  1330  435s
  3782  2463 23734.5920   25  438 21271.8852 31314.8048  47.2%  1329  441s
  3784  2464 25156.2022   19  421 21271.8852 31314.8048  47.2%  1328  445s
  3787  2466 24238.2362   20  438 21271.8852 31314.8048  47.2%  1327  459s
  3788  2467 28636.4117   14  438 21271.8852 31314.8048  47.2%  1326  470s
  3789  2470 31314.8048   10  341 21271.8852 31314.8048  47.2%  1356  477s
  3791  2474 31314.8048   11  398 21271.8852 31314.8048  47.2%  1356  483s
  3795  2480 31314.8048   12  427 21271.8852 31314.8048  47.2%  1359  490s
  3803  2494 31314.8048   13  418 21271.8852 31314.8048  47.2%  1367  498s
  3819  2506 26897.5347   14  203 21271.8852 31314.8048  47.2%  1381  509s
  3837  2532 25513.1750   15  347 21271.8852 31314.8048  47.2%  1421  519s
H 3838  2408                    21333.016274 31314.8048  46.8%  1421  519s
  3869  2459 25161.8931   16  314 21333.0163 31314.8048  46.8%  1440  530s
  3977  2436 25132.6412   17  328 21333.0163 31314.8048  46.8%  1511  541s
  4035  2435 24425.4175   18  310 21333.0163 31314.8048  46.8%  1522  550s
  4124  2408     cutoff   19      21333.0163 31314.8048  46.8%  1535  559s
  4220  2387 27638.7372   15  301 21333.0163 31314.8048  46.8%  1545  566s
  4297  2384 24288.7762   17  270 21333.0163 31314.8048  46.8%  1560  571s
  4362  2385 22522.1852   18  252 21333.0163 31314.8048  46.8%  1575  578s
  4435  2371 21730.0594   19  234 21333.0163 31314.8048  46.8%  1584  585s
  4515  2343     cutoff   22      21333.0163 31314.8048  46.8%  1590  591s
  4568  2335     cutoff   22      21333.0163 31314.8048  46.8%  1593  600s
  4619  2351 31314.8048   15  352 21333.0163 31314.8048  46.8%  1605  605s
  4679  2356 26353.5911   15  308 21333.0163 31314.8048  46.8%  1614  613s
  4758  2352 28963.9779   16  402 21333.0163 31314.8048  46.8%  1617  621s
  4850  2349     cutoff   28      21333.0163 31314.8048  46.8%  1618  629s
  4927  2330 25781.4482   16  321 21333.0163 30995.8273  45.3%  1626  636s
  5024  2325 26173.9693   16  312 21333.0163 30995.8273  45.3%  1624  643s
  5082  2337 25871.9089   17  408 21333.0163 30995.8273  45.3%  1630  651s
  5171  2335 25045.0541   17  292 21333.0163 30995.8273  45.3%  1631  659s
  5290  2324 24742.8873   18  285 21333.0163 30995.8273  45.3%  1625  667s
  5396  2306 23465.8993   20  235 21333.0163 30995.8273  45.3%  1628  675s
  5520  2305 23104.4743   22  204 21333.0163 30186.5725  41.5%  1626  684s
  5635  2290     cutoff   26      21333.0163 27997.0085  31.2%  1629  693s
  5752  2277     cutoff   26      21333.0163 27997.0085  31.2%  1635  701s
  5869  2288     cutoff   27      21333.0163 27174.4860  27.4%  1643  710s
  6023  2268     cutoff   19      21333.0163 26413.9802  23.8%  1641  719s
  6186  2221 23606.7984   21  222 21333.0163 26242.2624  23.0%  1633  729s
  6287  2202     cutoff   23      21333.0163 26132.2728  22.5%  1636  739s
  6419  2172     cutoff   27      21333.0163 26132.2728  22.5%  1643  749s
  6521  2145     cutoff   30      21333.0163 26132.2728  22.5%  1646  757s
  6603  2112 21485.4562   31  379 21333.0163 25571.8280  19.9%  1650  767s
  6745  2075     cutoff   20      21333.0163 25301.5367  18.6%  1652  779s
  6884  2049 23003.9842   22  462 21333.0163 24955.9730  17.0%  1669  791s
  7056  2013     cutoff   25      21333.0163 24944.8332  16.9%  1675  802s
  7255  1960 23164.7445   28  355 21333.0163 24670.6747  15.6%  1678  815s
  7481  1917 21892.1599   28  221 21333.0163 24628.3775  15.4%  1676  825s
  7587  1865     cutoff   30      21333.0163 24628.3775  15.4%  1679  837s
  7845  1736 22117.7098   21  260 21333.0163 24077.7413  12.9%  1672  848s
  8120  1630 22869.1333   20  188 21333.0163 24062.3536  12.8%  1669  860s
  8410  1463     cutoff   24      21333.0163 24062.3536  12.8%  1668  873s
  8901  1244 21785.8645   23  244 21333.0163 23341.7879  9.42%  1631  884s
  9482   995 21903.7329   25  228 21333.0163 22933.6674  7.50%  1567  894s
H 9629   828                    21338.747208 22702.4344  6.39%  1552  894s
 10361   745 21383.4395   48   72 21338.7472 22614.3427  5.98%  1471  902s
H11361   711                    21373.129063 22178.4389  3.77%  1360  902s
 11672   927 21596.5457   54   29 21373.1291 21964.5082  2.77%  1329  906s
*12887   927              91    21407.894676 21856.9932  2.10%  1213  906s
*13397   892              69    21412.553891 21694.5307  1.32%  1170  908s
*14552   892              70    21461.558476 21675.6612  1.00%  1083  908s
*14553   892              70    21487.695412 21675.6612  0.87%  1083  908s
 15718     0     cutoff   59      21487.6954 21614.5592  0.59%  1006  910s

Cutting planes:
  MIR: 411
  Flow cover: 1254
  RLT: 18
  Relax-and-lift: 108

Explored 16207 nodes (15968748 simplex iterations) in 910.16 seconds (2621.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21487.7 21461.6 21412.6 ... 21211.4

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (1.4043e-09) exceeds tolerance
Best objective 2.148769541193e+04, best bound 2.148769541193e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 910.17s
  Master Objective (UB) = 21487.70, θ = 173936.07
  Upper Bound (UB) = 21487.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173936.07
  [DEBUG]   ✓ Scenario 0: θ = 173936.07 ≤ Q = 173936.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173936.07 ≤ Q = 173936.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173936.07 ≤ Q = 173936.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173936.07 ≤ Q = 173936.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173936.07 ≤ Q = 173936.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5cc7f59
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfa3380a7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.250883e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6913013.5660
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.431662e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143166.19    0  134 6913013.57 -143166.19   102%     -    0s
H    0     0                    -106916.6870 -143166.19  33.9%     -    0s
H    0     0                    -109472.8625 -143166.19  30.8%     -    0s
H    0     0                    -115256.3059 -128149.44  11.2%     -    0s
H    0     0                    -118559.8058 -128149.44  8.09%     -    0s
     0     0 -128149.44    0  110 -118559.81 -128149.44  8.09%     -    0s
H    0     0                    -124172.0625 -128144.35  3.20%     -    0s
H    0     0                    -124180.8379 -126842.99  2.14%     -    0s
     0     0 -126842.99    0  102 -124180.84 -126842.99  2.14%     -    0s
     0     0 -126841.91    0  102 -124180.84 -126841.91  2.14%     -    0s
     0     0 -126045.69    0   97 -124180.84 -126045.69  1.50%     -    0s
H    0     0                    -124442.7047 -125957.26  1.22%     -    0s
     0     0 -125957.26    0  104 -124442.70 -125957.26  1.22%     -    0s
     0     0 -125879.00    0   97 -124442.70 -125879.00  1.15%     -    0s
     0     0 -125548.94    0  103 -124442.70 -125548.94  0.89%     -    0s
H    0     0                    -124461.1976 -125505.42  0.84%     -    0s
     0     0 -125505.42    0  102 -124461.20 -125505.42  0.84%     -    0s
     0     0 -125036.51    0  102 -124461.20 -125036.51  0.46%     -    0s
     0     0 -125017.25    0   94 -124461.20 -125017.25  0.45%     -    0s
     0     0 -125017.25    0   94 -124461.20 -125017.25  0.45%     -    0s
     0     0 -124753.57    0   34 -124461.20 -124753.57  0.23%     -    0s
     0     0 -124743.57    0   23 -124461.20 -124743.57  0.23%     -    0s
     0     0 -124723.97    0   30 -124461.20 -124723.97  0.21%     -    0s
     0     0 -124637.91    0   22 -124461.20 -124637.91  0.14%     -    0s
     0     0 -124625.83    0   21 -124461.20 -124625.83  0.13%     -    0s
     0     0 -124625.83    0   21 -124461.20 -124625.83  0.13%     -    0s
     0     0 -124625.83    0   46 -124461.20 -124625.83  0.13%     -    0s
     0     0 -124499.60    0   10 -124461.20 -124499.60  0.03%     -    0s
H    0     0                    -124494.7563 -124497.89  0.00%     -    0s
     0     0 -124496.64    0    5 -124494.76 -124496.64  0.00%     -    0s
     0     0 -124495.95    0    2 -124494.76 -124495.95  0.00%     -    0s
*    0     0               0    -124495.4712 -124495.47  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 18
  Flow cover: 23
  RLT: 5
  Relax-and-lift: 8

Explored 1 nodes (1059 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -124495 -124495 -124495 ... -109473
No other solutions better than -124495

Optimal solution found (tolerance 1.00e-06)
Best objective -1.244954711606e+05, best bound -1.244954711606e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 159249.95
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124495.47
  [DEBUG]   S×d_nominal = 283745.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283745.42 + -124495.47 = 159249.95
  [DEBUG]   Current θ from Master = 173936.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14686.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6801.57
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 10383.7056, Absolute Gap = 10383.7056, Relative Gap = 0.483240
  Not converged yet (gap = 10383.71 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265049 nonzeros
Model fingerprint: 0xc2875113
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37572 rows and 15252 columns
Presolve time: 0.88s
Presolved: 55551 rows, 24448 columns, 345059 nonzeros
Variable types: 22189 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55551 rows, 24448 columns, 345059 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34783   -1.9935680e+04   0.000000e+00   1.853702e+07      5s
   50144    2.5737195e+04   0.000000e+00   2.155510e+06     10s
Concurrent spin time: 0.43s

Solved with dual simplex

Root relaxation: objective 4.585575e+04, 36274 iterations, 14.32 seconds (29.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45855.7505    0  130 -222897.65 45855.7505   121%     -   15s
H    0     0                    -216348.4431 45855.7505   121%     -   15s
H    0     0                    -95416.57212 45855.7505   148%     -   15s
H    0     0                    -74151.69326 45855.7505   162%     -   15s
H    0     0                    -71641.34890 45855.7505   164%     -   15s
H    0     0                    -61011.09408 45855.7505   175%     -   15s
H    0     0                    -30109.38305 45855.7505   252%     -   15s
H    0     0                    -16816.44367 45855.7505   373%     -   16s
H    0     0                    16881.716381 45855.7505   172%     -   16s
H    0     0                    16882.992161 45855.7505   172%     -   16s
H    0     0                    17102.239461 40976.0325   140%     -   24s
H    0     0                    17132.512210 40976.0325   139%     -   24s
H    0     0                    17233.209499 40976.0325   138%     -   24s
H    0     0                    18246.169701 40976.0325   125%     -   24s
H    0     0                    18278.985261 40976.0325   124%     -   24s
H    0     0                    18279.434510 40976.0325   124%     -   24s
H    0     0                    18292.252840 40976.0325   124%     -   24s
H    0     0                    18295.552761 40976.0325   124%     -   24s
H    0     0                    18361.248502 40976.0325   123%     -   24s
H    0     0                    18410.539213 40976.0325   123%     -   24s
H    0     0                    18518.339693 40976.0325   121%     -   24s
     0     0 40976.0325    0  238 18518.3397 40976.0325   121%     -   24s
     0     0 40756.8351    0  242 18518.3397 40756.8351   120%     -   25s
     0     0 40756.8351    0  236 18518.3397 40756.8351   120%     -   26s
     0     0 40646.3013    0  243 18518.3397 40646.3013   119%     -   26s
     0     0 40646.2197    0  246 18518.3397 40646.2197   119%     -   26s
     0     0 40646.2197    0  238 18518.3397 40646.2197   119%     -   27s
     0     0 40646.2197    0  235 18518.3397 40646.2197   119%     -   27s
     0     0 40646.2197    0  238 18518.3397 40646.2197   119%     -   27s
H    0     0                    18528.896572 37192.2965   101%     -   40s
     0     0 37192.2965    0  317 18528.8966 37192.2965   101%     -   40s
H    0     0                    18829.434322 37191.9541  97.5%     -   41s
H    0     0                    18906.821187 37191.9541  96.7%     -   41s
H    0     0                    19139.197427 37191.9541  94.3%     -   41s
H    0     0                    19313.686779 37191.9541  92.6%     -   41s
     0     0 36714.3403    0  346 19313.6868 36714.3403  90.1%     -   44s
     0     0 36618.4337    0  333 19313.6868 36618.4337  89.6%     -   46s
     0     0 36420.9346    0  339 19313.6868 36420.9346  88.6%     -   48s
     0     0 36413.1755    0  338 19313.6868 36413.1755  88.5%     -   48s
     0     0 36408.4760    0  339 19313.6868 36408.4760  88.5%     -   48s
     0     0 36407.2652    0  342 19313.6868 36407.2652  88.5%     -   49s
     0     0 36407.0657    0  343 19313.6868 36407.0657  88.5%     -   49s
     0     0 35036.1179    0  361 19313.6868 35036.1179  81.4%     -   58s
     0     0 34679.8910    0  372 19313.6868 34679.8910  79.6%     -   64s
     0     0 34582.4641    0  382 19313.6868 34582.4641  79.1%     -   67s
     0     0 34534.9437    0  389 19313.6868 34534.9437  78.8%     -   68s
     0     0 34508.3872    0  384 19313.6868 34508.3872  78.7%     -   69s
     0     0 34480.1099    0  381 19313.6868 34480.1099  78.5%     -   70s
     0     0 34470.5106    0  384 19313.6868 34470.5106  78.5%     -   70s
     0     0 34468.6334    0  384 19313.6868 34468.6334  78.5%     -   71s
     0     0 34467.3693    0  387 19313.6868 34467.3693  78.5%     -   71s
     0     0 34467.2429    0  387 19313.6868 34467.2429  78.5%     -   71s
     0     0 34115.5077    0  412 19313.6868 34115.5077  76.6%     -   77s
     0     0 34011.7677    0  399 19313.6868 34011.7677  76.1%     -   80s
     0     0 33899.1078    0  450 19313.6868 33899.1078  75.5%     -   82s
     0     0 33859.2225    0  411 19313.6868 33859.2225  75.3%     -   83s
     0     0 33842.7747    0  423 19313.6868 33842.7747  75.2%     -   85s
     0     0 33829.4737    0  453 19313.6868 33829.4737  75.2%     -   86s
     0     0 33825.5821    0  454 19313.6868 33825.5821  75.1%     -   87s
     0     0 33819.2553    0  425 19313.6868 33819.2553  75.1%     -   87s
     0     0 33810.0283    0  442 19313.6868 33810.0283  75.1%     -   88s
     0     0 33808.2590    0  445 19313.6868 33808.2590  75.0%     -   88s
     0     0 33806.7684    0  437 19313.6868 33806.7684  75.0%     -   89s
     0     0 33797.5719    0  436 19313.6868 33797.5719  75.0%     -   89s
     0     0 33794.0463    0  434 19313.6868 33794.0463  75.0%     -   90s
     0     0 33793.0455    0  447 19313.6868 33793.0455  75.0%     -   90s
     0     0 33754.9760    0  431 19313.6868 33754.9760  74.8%     -   92s
     0     0 33749.4072    0  429 19313.6868 33749.4072  74.7%     -   92s
     0     0 33745.6060    0  485 19313.6868 33745.6060  74.7%     -   93s
     0     0 33743.9205    0  439 19313.6868 33743.9205  74.7%     -   93s
     0     0 33743.2172    0  435 19313.6868 33743.2172  74.7%     -   94s
H    0     0                    19348.071094 33705.6729  74.2%     -   96s
     0     0 33705.6729    0  439 19348.0711 33705.6729  74.2%     -   96s
     0     0 33702.0739    0  448 19348.0711 33702.0739  74.2%     -   97s
     0     0 33700.2126    0  495 19348.0711 33700.2126  74.2%     -   98s
     0     0 33699.8111    0  484 19348.0711 33699.8111  74.2%     -   98s
     0     0 33680.8310    0  487 19348.0711 33680.8310  74.1%     -  100s
     0     0 33676.2588    0  457 19348.0711 33676.2588  74.1%     -  101s
     0     0 33673.7968    0  460 19348.0711 33673.7968  74.0%     -  102s
     0     0 33672.8871    0  456 19348.0711 33672.8871  74.0%     -  102s
     0     0 33669.0976    0  452 19348.0711 33669.0976  74.0%     -  103s
     0     0 33667.7488    0  449 19348.0711 33667.7488  74.0%     -  104s
     0     0 33662.8932    0  451 19348.0711 33662.8932  74.0%     -  105s
     0     0 33660.4514    0  457 19348.0711 33660.4514  74.0%     -  105s
     0     0 33658.6361    0  441 19348.0711 33658.6361  74.0%     -  106s
     0     0 33658.5310    0  451 19348.0711 33658.5310  74.0%     -  106s
H    0     0                    19413.437822 33658.5310  73.4%     -  106s
     0     0 33655.9842    0  441 19413.4378 33655.9842  73.4%     -  108s
     0     0 33655.8164    0  441 19413.4378 33655.8164  73.4%     -  109s
H    0     0                    19839.753415 33653.2323  69.6%     -  125s
H    0     0                    20102.465503 33653.2323  67.4%     -  125s
H    0     2                    20350.072253 33653.2323  65.4%     -  126s
     0     2 33653.2323    0  441 20350.0723 33653.2323  65.4%     -  126s
     1     4 33262.5957    1  466 20350.0723 33652.9311  65.4%  4274  131s
     3     8 33182.8493    2  441 20350.0723 33261.9074  63.4%  4765  135s
     7    16 32962.7555    3  402 20350.0723 33182.3150  63.1%  5068  141s
    15    32 32779.3694    4  435 20350.0723 32960.6221  62.0%  5854  147s
    31    52 31729.9733    5  381 20350.0723 32776.8849  61.1%  8308  162s
H   51    84                    20462.727257 32776.8809  60.2%  8084  171s
H   52    84                    20739.992502 32776.8809  58.0%  8025  171s
H   59    84                    20854.639413 32776.8809  57.2%  7803  171s
    83   228 31083.4141    7  324 20854.6394 32776.8809  57.2%  6593  180s
H  228   267                    20952.021336 32776.8809  56.4%  3658  184s
H  231   267                    21004.165302 32776.8809  56.0%  3628  184s
   268   348 31006.1448    8  423 21004.1653 32776.8809  56.0%  3489  189s
   351   404 30892.6460   10  299 21004.1653 32776.8809  56.0%  3328  194s
   427   436 30949.7643   10  373 21004.1653 32776.8809  56.0%  3140  202s
   493   462 30984.6735    9  364 21004.1653 32776.8809  56.0%  3062  207s
   531   488 29446.5304    9  268 21004.1653 32776.8809  56.0%  3089  214s
   583   508 30508.3595   11  359 21004.1653 32776.8809  56.0%  3021  220s
   637   529 30246.4207   11  369 21004.1653 32776.8809  56.0%  2925  227s
H  661   529                    21006.362515 32776.8809  56.0%  2872  227s
   700   563 28764.9401   11  261 21006.3625 32776.8809  56.0%  2838  233s
   777   607 24741.4641   11  274 21006.3625 32776.8809  56.0%  2738  240s
   849   623 24613.9800   11  278 21006.3625 32776.8809  56.0%  2670  247s
H  877   623                    21037.531791 32776.8809  55.8%  2653  247s
   891   684 28668.4173   12  295 21037.5318 32776.8809  55.8%  2662  254s
   977   749 27724.0072   13  328 21037.5318 32776.8809  55.8%  2579  260s
  1063   775 21166.5078   13  207 21037.5318 32776.8809  55.8%  2512  268s
H 1095   775                    21050.976511 32776.8809  55.7%  2498  268s
  1118   795 27716.2008   14  274 21050.9765 32415.5063  54.0%  2478  276s
  1155   831 26687.3086   15  432 21050.9765 32415.5063  54.0%  2494  282s
  1221   870 26149.9925   16  432 21050.9765 32415.5063  54.0%  2462  288s
  1308   923 25909.0877   17  384 21050.9765 32415.5063  54.0%  2410  296s
  1408   981 25764.2547   18  306 21050.9765 32415.5063  54.0%  2366  304s
  1501  1043 25671.5000   19  287 21050.9765 32415.5063  54.0%  2355  313s
  1605  1103 23779.2540   21  214 21050.9765 32415.5063  54.0%  2327  321s
  1718  1125 24851.2800   21  277 21050.9765 31735.3781  50.8%  2293  329s
  1757  1152 24882.2129   22  220 21050.9765 31633.1714  50.3%  2314  338s
  1808  1196 24880.4744   22  279 21050.9765 31628.6975  50.2%  2317  346s
H 1814  1196                    21069.771505 31628.6975  50.1%  2313  346s
  1882  1282 24620.2738   21  227 21069.7715 31628.6975  50.1%  2302  354s
  2054  1341 24238.8437   23  204 21069.7715 31329.0794  48.7%  2224  364s
  2191  1414 24195.2585   23  222 21069.7715 31186.1351  48.0%  2202  375s
  2329  1470 23749.7047   23  245 21069.7715 31186.1351  48.0%  2181  383s
H 2338  1470                    21093.686193 31173.9789  47.8%  2188  383s
  2445  1524 24137.4356   24  189 21093.6862 31167.4018  47.8%  2156  393s
  2561  1545     cutoff   24      21093.6862 31167.4018  47.8%  2179  401s
  2604  1568 infeasible   24      21093.6862 31136.6197  47.6%  2197  410s
  2661  1596 21483.5321   25   72 21093.6862 31136.6197  47.6%  2221  420s
  2709  1632     cutoff   26      21093.6862 31136.6197  47.6%  2242  426s
  2767  1672     cutoff   26      21093.6862 31136.6197  47.6%  2235  435s
  2874  1680 21613.7393   28  102 21093.6862 31136.2375  47.6%  2200  443s
  2930  1703     cutoff   28      21093.6862 31136.2375  47.6%  2193  454s
  3009  1734 21475.6971   30   86 21093.6862 31125.4910  47.6%  2180  464s
  3110  1782 21364.8999   31   79 21093.6862 31125.4910  47.6%  2166  476s
  3261  1845     cutoff   34      21093.6862 31074.9256  47.3%  2146  488s
  3401  1868 25398.6977    9  330 21093.6862 31074.9256  47.3%  2140  497s
  3446  1905 24406.9420   10  264 21093.6862 31074.9256  47.3%  2143  508s
  3531  2037 24382.4025   11  258 21093.6862 31074.9256  47.3%  2137  521s
  3779  2127     cutoff   14      21093.6862 31074.9256  47.3%  2069  534s
  4052  2231 21203.1940   32  116 21093.6862 30718.0569  45.6%  2018  546s
  4248  2320 23091.7648   10  302 21093.6862 30718.0569  45.6%  2022  560s
H 4318  2320                    21093.883185 30718.0569  45.6%  2028  560s
  4451  2437 21825.1125   14  166 21093.8832 30622.6285  45.2%  2028  575s
  4707  2438 22357.2524   19  441 21093.8832 30586.5498  45.0%  2023  606s
  4709  2439 22482.2887   14  130 21093.8832 30586.5498  45.0%  2022  626s
  4710  2440 24474.9708   20  294 21093.8832 30586.5498  45.0%  2022  640s
  4711  2441 24897.7835   14  387 21093.8832 30586.5498  45.0%  2021  652s
  4712  2441 21428.9510   24  408 21093.8832 30586.5498  45.0%  2021  660s
  4714  2443 21547.8447   38  457 21093.8832 30586.5498  45.0%  2020  667s
  4715  2443 21863.3002   26  407 21093.8832 30586.5498  45.0%  2019  670s
  4718  2445 24571.1658    8  448 21093.8832 30586.5498  45.0%  2018  676s
  4720  2447 21520.4264   19  436 21093.8832 30586.5498  45.0%  2017  680s
  4723  2449 29521.0775   13  447 21093.8832 30586.5498  45.0%  2016  686s
  4725  2450 24070.2000   12  452 21093.8832 30586.5498  45.0%  2015  691s
  4726  2451 23079.3762   30  438 21093.8832 30586.5498  45.0%  2015  695s
  4729  2453 22078.9921   27  467 21093.8832 30586.5498  45.0%  2013  701s
  4730  2453 24488.1650   17  457 21093.8832 30586.5498  45.0%  2013  705s
  4733  2455 23192.4677   22  473 21093.8832 30586.5498  45.0%  2012  712s
  4735  2457 27231.9330   17  448 21093.8832 30586.5498  45.0%  2011  715s
  4736  2457 21539.2692   47  436 21093.8832 30586.5498  45.0%  2010  720s
  4738  2459 24670.3838    8  475 21093.8832 30586.5498  45.0%  2010  725s
  4741  2461 23819.2027   23  406 21093.8832 30586.5498  45.0%  2008  750s
  4742  2461 24225.3519   18  406 21093.8832 30586.5498  45.0%  2008  762s
  4743  2465 30586.5498   12  399 21093.8832 30586.5498  45.0%  2043  774s
  4745  2468 30586.5498   13  426 21093.8832 30586.5498  45.0%  2045  783s
  4749  2475 30586.5498   14  421 21093.8832 30586.5498  45.0%  2048  792s
  4757  2488 30586.5498   15  484 21093.8832 30586.5498  45.0%  2055  802s
  4773  2500 30056.9326   16  316 21093.8832 30586.5498  45.0%  2083  820s
  4790  2526 28999.0055   17  358 21093.8832 30586.5498  45.0%  2100  829s
  4822  2601 28902.6060   18  317 21093.8832 30586.5498  45.0%  2117  841s
  4919  2628 23832.6856   21  302 21093.8832 30586.5498  45.0%  2174  850s
  5013  2623 25358.8283   21  315 21093.8832 30586.5498  45.0%  2183  860s
  5084  2614 23894.2191   22  279 21093.8832 30586.5498  45.0%  2189  870s
  5129  2618 23720.4907   22  264 21093.8832 30586.5498  45.0%  2201  880s
  5183  2617 21559.3469   22  292 21093.8832 30586.5498  45.0%  2211  888s
  5224  2610     cutoff   22      21093.8832 30586.5498  45.0%  2225  899s
  5285  2610 23542.4895   24  271 21093.8832 30586.5498  45.0%  2233  908s
  5329  2623 22933.1744   25  254 21093.8832 30586.5498  45.0%  2246  916s
  5380  2624 22499.4407   25  258 21093.8832 30586.5498  45.0%  2255  925s
  5434  2621     cutoff   26      21093.8832 30586.5498  45.0%  2261  933s
  5488  2618 22352.9542   27  240 21093.8832 30586.5498  45.0%  2264  941s
  5543  2617 22010.8671   28  228 21093.8832 30586.5498  45.0%  2267  949s
  5602  2608 21990.8959   29  226 21093.8832 30586.5498  45.0%  2273  958s
  5664  2602 21395.9839   32  182 21093.8832 30586.5498  45.0%  2275  967s
  5712  2598 21225.3656   33  217 21093.8832 30586.5498  45.0%  2280  975s
  5779  2594 22868.9890   22  197 21093.8832 30500.1514  44.6%  2285  985s
  5826  2597 22606.8079   23  196 21093.8832 30500.1514  44.6%  2291  994s
  5890  2590 22438.3042   24  195 21093.8832 30500.1514  44.6%  2299 1002s
H 5924  2454                    21093.883189 30247.3200  43.4%  2305 1002s
  5931  2478 22375.8216   25  168 21093.8832 30247.3200  43.4%  2308 1014s
  6038  2456 21456.0435   29  134 21093.8832 29737.7789  41.0%  2306 1025s
  6147  2429 21753.1150   23  301 21093.8832 29737.7789  41.0%  2308 1036s
  6256  2426     cutoff   24      21093.8832 29737.7789  41.0%  2307 1045s
  6363  2416     cutoff   21      21093.8832 29737.7789  41.0%  2312 1055s
  6483  2410 23637.9752   21  305 21093.8832 28336.8757  34.3%  2313 1066s
  6609  2390 21571.8068   24  263 21093.8832 28242.0119  33.9%  2312 1073s
  6649  2391 21329.6585   25  268 21093.8832 28242.0119  33.9%  2316 1080s
  6707  2390     cutoff   26      21093.8832 28242.0119  33.9%  2316 1092s
  6798  2388 25158.6081   25  379 21093.8832 27714.5681  31.4%  2319 1104s
  6897  2377 24874.3359   26  394 21093.8832 27714.5681  31.4%  2315 1116s
  7013  2359 24747.2417   27  369 21093.8832 27444.5495  30.1%  2304 1129s
  7108  2342 24459.8652   29  250 21093.8832 27363.3427  29.7%  2308 1142s
  7268  2318 22859.2179   34  176 21093.8832 27187.2534  28.9%  2304 1156s
  7461  2262     cutoff   38      21093.8832 27065.9480  28.3%  2293 1170s
  7689  2220 24626.0705   24  338 21093.8832 26649.1770  26.3%  2280 1192s
  7905  2171 23359.6985   27  345 21093.8832 26379.0404  25.1%  2270 1208s
  8146  2138 22872.5225   29  281 21093.8832 26379.0404  25.1%  2260 1223s
  8311  2078     cutoff   30      21093.8832 26379.0404  25.1%  2247 1245s
  8504  2043 23143.6778   20  172 21093.8832 25766.7549  22.2%  2247 1261s
  8690  1987     cutoff   24      21093.8832 25044.2863  18.7%  2259 1278s
  8910  1911 infeasible   32      21093.8832 24823.4490  17.7%  2265 1296s
  9140  1839 22235.0132   24  262 21093.8832 24488.6170  16.1%  2274 1314s
  9447  1746     cutoff   32      21093.8832 24488.6170  16.1%  2267 1332s
  9644  1615 21544.3468   23  359 21093.8832 24363.4839  15.5%  2272 1350s
 10000  1438     cutoff   27      21093.8832 23679.1415  12.3%  2254 1368s
 10399  1271 21698.0818   25  392 21093.8832 23370.3177  10.8%  2234 1388s
 10848  1024     cutoff   22      21093.8832 23089.0341  9.46%  2207 1409s
 11541   465     cutoff   37      21093.8832 22949.7991  8.80%  2133 1426s
 12562   203 21159.5708   55   27 21093.8832 22490.6952  6.62%  2003 1439s
 13807   261 21261.0399   45  100 21093.8832 21972.6465  4.17%  1840 1447s
 15143   244 21269.8419   56   22 21093.8832 21337.6761  1.16%  1686 1451s

Cutting planes:
  Learned: 1
  MIR: 456
  Mixing: 1
  Flow cover: 1430
  RLT: 17
  Relax-and-lift: 107

Explored 17995 nodes (25922847 simplex iterations) in 1453.92 seconds (4383.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21093.9 21093.7 21069.8 ... 20740

Optimal solution found (tolerance 1.00e-06)
Best objective 2.109388318868e+04, best bound 2.109388318868e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1453.93s
  Master Objective (UB) = 21093.88, θ = 173880.80
  Upper Bound (UB) = 21093.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173880.80
  [DEBUG]   ✓ Scenario 0: θ = 173880.80 ≤ Q = 173880.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173880.80 ≤ Q = 173880.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173880.80 ≤ Q = 173880.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173880.80 ≤ Q = 173880.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173880.80 ≤ Q = 173880.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173880.80 ≤ Q = 173880.80 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x249e2921
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdb61d6df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.255135e+13
Presolve removed 2551 rows and 1849 columns
Presolve time: 0.00s
Presolved: 542 rows, 540 columns, 1525 nonzeros
Found heuristic solution: objective 6400212.6434
Variable types: 364 continuous, 176 integer (176 binary)

Root relaxation: objective -1.430880e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143088.04    0  134 6400212.64 -143088.04   102%     -    0s
H    0     0                    -107040.5416 -143088.04  33.7%     -    0s
H    0     0                    -109432.5544 -143088.04  30.8%     -    0s
H    0     0                    -115229.7756 -123545.92  7.22%     -    0s
H    0     0                    -118782.3384 -123545.92  4.01%     -    0s
     0     0 -123545.92    0   91 -118782.34 -123545.92  4.01%     -    0s
H    0     0                    -121279.4074 -123519.72  1.85%     -    0s
     0     0 -123457.20    0   81 -121279.41 -123457.20  1.80%     -    0s
     0     0 -123456.14    0   86 -121279.41 -123456.14  1.79%     -    0s
     0     0 -123022.64    0   78 -121279.41 -123022.64  1.44%     -    0s
H    0     0                    -121818.1369 -123011.17  0.98%     -    0s
     0     0 -122988.49    0   78 -121818.14 -122988.49  0.96%     -    0s
     0     0 -122845.74    0   69 -121818.14 -122845.74  0.84%     -    0s
     0     0 -122818.46    0   68 -121818.14 -122818.46  0.82%     -    0s
     0     0 -122818.46    0   68 -121818.14 -122818.46  0.82%     -    0s
     0     0 -122600.85    0   77 -121818.14 -122600.85  0.64%     -    0s
H    0     0                    -121830.3961 -122599.24  0.63%     -    0s
H    0     0                    -121831.5653 -122599.24  0.63%     -    0s
     0     0 -122595.57    0   78 -121831.57 -122595.57  0.63%     -    0s
     0     0 -122506.00    0   84 -121831.57 -122506.00  0.55%     -    0s
     0     0 -122503.90    0   84 -121831.57 -122503.90  0.55%     -    0s
     0     2 -122503.84    0   84 -121831.57 -122503.84  0.55%     -    0s
H  387    35                    -121832.5556 -122064.71  0.19%  11.6    0s
H  491    49                    -121835.4606 -122022.98  0.15%  11.0    0s
*  832    24              26    -121837.1579 -121871.75  0.03%   9.0    0s
*  892    24              28    -121838.2415 -121860.38  0.02%   8.7    0s
*  899    24              29    -121839.9388 -121858.99  0.02%   8.7    0s

Cutting planes:
  Gomory: 26
  Implied bound: 3
  MIR: 189
  Flow cover: 8
  RLT: 44
  BQP: 2

Explored 964 nodes (8820 simplex iterations) in 0.12 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121840 -121838 -121837 ... -118782
No other solutions better than -121840

Optimal solution found (tolerance 1.00e-06)
Best objective -1.218399388369e+05, best bound -1.218399388369e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 161744.76
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121839.94
  [DEBUG]   S×d_nominal = 283584.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283584.70 + -121839.94 = 161744.76
  [DEBUG]   Current θ from Master = 173880.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12136.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8957.84
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 9989.8934, Absolute Gap = 9989.8934, Relative Gap = 0.473592
  Not converged yet (gap = 9989.89 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308304 nonzeros
Model fingerprint: 0x22965ca1
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43834 rows and 17794 columns
Presolve time: 1.05s
Presolved: 64579 rows, 28146 columns, 401649 nonzeros
Variable types: 25887 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 64579 rows, 28146 columns, 401649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36680   -3.0348150e+04   0.000000e+00   7.362335e+08      5s
   50923    2.0038701e+04   0.000000e+00   2.619176e+07     10s
   64938    2.7229637e+04   0.000000e+00   7.024425e+06     15s
Concurrent spin time: 1.37s

Solved with dual simplex

Root relaxation: objective 4.585575e+04, 45866 iterations, 19.78 seconds (40.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45855.7505    0  130 -222897.65 45855.7505   121%     -   21s
H    0     0                    -216348.4431 45855.7505   121%     -   21s
H    0     0                    -53495.87453 45855.7505   186%     -   21s
H    0     0                    -50882.72114 45855.7505   190%     -   21s
H    0     0                    -50852.29024 45855.7505   190%     -   21s
H    0     0                    -14352.11140 45855.7505   420%     -   21s
H    0     0                    -1426.836278 45855.7505  3314%     -   21s
H    0     0                    17760.350171 45855.7505   158%     -   21s
H    0     0                    17945.623682 45855.7505   156%     -   22s
H    0     0                    17993.164350 45855.7505   155%     -   22s
H    0     0                    18275.771375 45855.7505   151%     -   22s
H    0     0                    18340.813068 40606.8275   121%     -   33s
H    0     0                    18496.621807 40606.8275   120%     -   33s
H    0     0                    18748.472676 40606.8275   117%     -   33s
     0     0 40606.8275    0  237 18748.4727 40606.8275   117%     -   33s
     0     0 40068.9802    0  244 18748.4727 40068.9802   114%     -   37s
     0     0 39953.5262    0  239 18748.4727 39953.5262   113%     -   39s
     0     0 39953.5262    0  242 18748.4727 39953.5262   113%     -   41s
     0     0 39953.5262    0  246 18748.4727 39953.5262   113%     -   41s
     0     0 39953.5262    0  243 18748.4727 39953.5262   113%     -   43s
     0     0 39953.5262    0  236 18748.4727 39953.5262   113%     -   43s
     0     0 39953.5262    0  238 18748.4727 39953.5262   113%     -   44s
     0     0 39953.5262    0  245 18748.4727 39953.5262   113%     -   44s
H    0     0                    19107.728443 37147.1707  94.4%     -   55s
     0     0 37147.1707    0  332 19107.7284 37147.1707  94.4%     -   55s
H    0     0                    19317.246476 37147.0930  92.3%     -   55s
H    0     0                    19373.650229 37147.0930  91.7%     -   55s
     0     0 36704.6305    0  335 19373.6502 36704.6305  89.5%     -   59s
     0     0 36677.6716    0  329 19373.6502 36677.6716  89.3%     -   61s
     0     0 36552.5381    0  344 19373.6502 36552.5381  88.7%     -   62s
     0     0 36524.8641    0  333 19373.6502 36524.8641  88.5%     -   64s
     0     0 36381.6502    0  338 19373.6502 36381.6502  87.8%     -   67s
     0     0 36333.9935    0  353 19373.6502 36333.9935  87.5%     -   68s
     0     0 36326.9133    0  352 19373.6502 36326.9133  87.5%     -   69s
     0     0 36323.0520    0  350 19373.6502 36323.0520  87.5%     -   69s
     0     0 36322.8429    0  349 19373.6502 36322.8429  87.5%     -   70s
H    0     0                    19436.533252 34881.4441  79.5%     -   84s
     0     0 34881.4441    0  400 19436.5333 34881.4441  79.5%     -   85s
H    0     0                    19506.335513 34881.1560  78.8%     -   85s
H    0     0                    19519.245285 34881.1560  78.7%     -   85s
     0     0 34452.8175    0  400 19519.2453 34452.8175  76.5%     -   91s
     0     0 34307.2554    0  416 19519.2453 34307.2554  75.8%     -   94s
     0     0 34226.9272    0  421 19519.2453 34226.9272  75.3%     -   97s
     0     0 34194.1505    0  425 19519.2453 34194.1505  75.2%     -   99s
     0     0 34169.8292    0  423 19519.2453 34169.8292  75.1%     -  100s
     0     0 34164.6872    0  421 19519.2453 34164.6872  75.0%     -  101s
     0     0 34156.3932    0  426 19519.2453 34156.3932  75.0%     -  101s
     0     0 34152.2119    0  427 19519.2453 34152.2119  75.0%     -  101s
     0     0 34148.8905    0  425 19519.2453 34148.8905  74.9%     -  102s
     0     0 34144.5979    0  428 19519.2453 34144.5979  74.9%     -  102s
     0     0 34142.4766    0  428 19519.2453 34142.4766  74.9%     -  103s
     0     0 34141.5808    0  429 19519.2453 34141.5808  74.9%     -  103s
     0     0 33874.9814    0  457 19519.2453 33874.9814  73.5%     -  110s
     0     0 33790.0342    0  459 19519.2453 33790.0342  73.1%     -  113s
     0     0 33766.2128    0  431 19519.2453 33766.2128  73.0%     -  115s
     0     0 33753.4365    0  480 19519.2453 33753.4365  72.9%     -  116s
     0     0 33743.0018    0  464 19519.2453 33743.0018  72.9%     -  117s
     0     0 33741.5115    0  481 19519.2453 33741.5115  72.9%     -  117s
     0     0 33735.9233    0  480 19519.2453 33735.9233  72.8%     -  117s
     0     0 33732.0973    0  474 19519.2453 33732.0973  72.8%     -  118s
     0     0 33729.1335    0  476 19519.2453 33729.1335  72.8%     -  118s
     0     0 33727.0036    0  442 19519.2453 33727.0036  72.8%     -  119s
     0     0 33726.4815    0  444 19519.2453 33726.4815  72.8%     -  119s
     0     0 33682.3130    0  436 19519.2453 33682.3130  72.6%     -  122s
     0     0 33676.9655    0  439 19519.2453 33676.9655  72.5%     -  123s
     0     0 33672.3601    0  441 19519.2453 33672.3601  72.5%     -  124s
     0     0 33671.0091    0  440 19519.2453 33671.0091  72.5%     -  124s
     0     0 33657.1283    0  445 19519.2453 33657.1283  72.4%     -  126s
H    0     0                    19539.262692 33656.6707  72.3%     -  127s
     0     0 33654.3843    0  447 19539.2627 33654.3843  72.2%     -  127s
     0     0 33654.1207    0  438 19539.2627 33654.1207  72.2%     -  128s
     0     0 33641.6919    0  472 19539.2627 33641.6919  72.2%     -  130s
H    0     0                    19551.034997 33641.6581  72.1%     -  130s
     0     0 33637.5286    0  439 19551.0350 33637.5286  72.0%     -  131s
     0     0 33635.7443    0  468 19551.0350 33635.7443  72.0%     -  131s
     0     0 33634.4650    0  472 19551.0350 33634.4650  72.0%     -  132s
     0     0 33625.4777    0  467 19551.0350 33625.4777  72.0%     -  134s
H    0     0                    19558.264421 33624.0320  71.9%     -  134s
     0     0 33621.9738    0  427 19558.2644 33621.9738  71.9%     -  135s
     0     0 33620.7966    0  427 19558.2644 33620.7966  71.9%     -  135s
     0     0 33612.2861    0  426 19558.2644 33612.2861  71.9%     -  137s
     0     0 33610.4793    0  424 19558.2644 33610.4793  71.8%     -  138s
     0     0 33609.5233    0  429 19558.2644 33609.5233  71.8%     -  138s
     0     0 33604.5345    0  430 19558.2644 33604.5345  71.8%     -  139s
     0     0 33601.8764    0  431 19558.2644 33601.8764  71.8%     -  140s
     0     0 33601.4893    0  436 19558.2644 33601.4893  71.8%     -  141s
     0     0 33598.9456    0  436 19558.2644 33598.9456  71.8%     -  142s
     0     0 33598.5187    0  436 19558.2644 33598.5187  71.8%     -  143s
H    0     0                    19570.394107 33596.9765  71.7%     -  170s
H    0     2                    19606.247884 33596.9765  71.4%     -  171s
     0     2 33596.9765    0  436 19606.2479 33596.9765  71.4%     -  171s
     1     3 33166.9130    1  326 19606.2479 33596.9765  71.4%  6016  175s
     2     5 32636.8133    2  322 19606.2479 33596.9765  71.4%  6390  181s
     4     9 32483.3447    3  322 19606.2479 33523.3543  71.0%  4182  189s
     8    18 33146.2927    3  334 19606.2479 33521.9346  71.0%  4231  196s
    17    36 32979.3073    4  315 19606.2479 33427.6253  70.5%  5675  202s
    35    50 32526.0516    5  358 19606.2479 33265.2015  69.7%  7734  216s
    49    78 31622.2194    6  432 19606.2479 33265.2015  69.7%  8873  229s
H   64    78                    19716.485239 33265.2015  68.7%  8280  229s
H   66    78                    19888.823051 33265.2015  67.3%  8202  229s
    77   175 31452.8119    7  320 19888.8231 33265.2015  67.3%  7614  248s
   174   281 31328.6454    9  410 19888.8231 33265.2015  67.3%  5091  258s
H  264   281                    19892.370734 33265.2015  67.2%  4123  258s
   280   355 31173.4391   12  416 19892.3707 33265.2015  67.2%  4008  265s
   358   386 30772.9913   14  363 19892.3707 33265.2015  67.2%  3678  272s
   391   439 30673.6476   15  371 19892.3707 33265.2015  67.2%  3559  279s
H  440   439                    20014.053326 33265.2015  66.2%  3464  279s
   451   469 30457.5403   16  445 20014.0533 33265.2015  66.2%  3487  287s
H  455   469                    20068.948742 33265.2015  65.8%  3475  287s
H  471   469                    20195.108307 33265.2015  64.7%  3428  287s
   481   482 29284.5992   16  214 20195.1083 33265.2015  64.7%  3445  295s
H  513   482                    20345.746345 33265.2015  63.5%  3360  295s
   535   500 30164.8520   17  227 20345.7463 33265.2015  63.5%  3365  302s
   575   514 29291.0581   18  223 20345.7463 33265.2015  63.5%  3326  310s
H  577   514                    20412.860964 33265.2015  63.0%  3330  310s
H  581   514                    20475.077802 33265.2015  62.5%  3324  310s
   626   563 23787.9508   18  259 20475.0778 33265.2015  62.5%  3307  319s
   703   575 24420.0400   19  278 20475.0778 33265.2015  62.5%  3196  326s
   760   599 22629.8238   20  266 20475.0778 33265.2015  62.5%  3156  334s
   828   623 22213.6211   21  276 20475.0778 33265.2015  62.5%  3088  341s
   870   655 22145.8526   22  269 20475.0778 33265.2015  62.5%  3093  349s
   924   689 21872.4161   23  277 20475.0778 33265.2015  62.5%  3033  358s
   998   720 21806.8862   24  268 20475.0778 33265.2015  62.5%  2968  362s
  1051   760 21315.2153   25  268 20475.0778 33265.2015  62.5%  2940  370s
  1119   802     cutoff   26      20475.0778 33109.8064  61.7%  2914  379s
  1213   844     cutoff   26      20475.0778 33088.1771  61.6%  2840  389s
  1309   902     cutoff   25      20475.0778 33088.1771  61.6%  2768  397s
  1409   956 24823.2810    9  309 20475.0778 31898.5540  55.8%  2735  407s
  1509  1007 23803.1882   10  296 20475.0778 31898.5540  55.8%  2690  416s
  1615  1059 22544.8990   11  276 20475.0778 31670.9712  54.7%  2662  427s
  1711  1111 21510.7040   12  262 20475.0778 31626.3619  54.5%  2656  438s
  1801  1189     cutoff   13      20475.0778 31626.3619  54.5%  2679  447s
  1917  1281 20952.9628   13  124 20475.0778 31626.3619  54.5%  2656  457s
  2056  1388     cutoff   16      20475.0778 31324.2711  53.0%  2610  468s
  2219  1484     cutoff   31      20475.0778 31255.2797  52.7%  2547  480s
  2413  1553 29112.0405   11  273 20475.0778 31186.7869  52.3%  2480  491s
  2615  1612 24335.5841   13  279 20475.0778 31120.4131  52.0%  2405  505s
  2735  1688     cutoff   15      20475.0778 31120.4131  52.0%  2419  518s
  2861  1730 21425.5201   15  338 20475.0778 31120.4131  52.0%  2434  525s
  2929  1773     cutoff   16      20475.0778 31120.4131  52.0%  2436  538s
  3049  1811 24464.0206   14  259 20475.0778 31120.4131  52.0%  2439  550s
  3199  1868 23752.0315   16  246 20475.0778 31120.4131  52.0%  2442  564s
  3345  1938 21641.0245   20  181 20475.0778 30952.9261  51.2%  2455  578s
  3498  2027 21047.4716   23  147 20475.0778 30952.9261  51.2%  2465  593s
  3690  2110     cutoff   40      20475.0778 30952.9261  51.2%  2453  610s
  3918  2233     cutoff   29      20475.0778 30684.7531  49.9%  2423  627s
  4167  2269 24737.8187   11  213 20475.0778 30684.7531  49.9%  2401  642s
  4264  2325 infeasible   12      20475.0778 30573.9241  49.3%  2420  660s
  4451  2344 21645.2807   14  169 20475.0778 30573.9241  49.3%  2429  675s
  4584  2374 23170.2400   16  241 20475.0778 30548.7283  49.2%  2437  692s
  4696  2451     cutoff   19      20475.0778 30442.5263  48.7%  2447  711s
  4864  2536 21092.4813    8  265 20475.0778 30427.3005  48.6%  2466  731s
  5079  2615 23094.9125    9  180 20475.0778 30368.8020  48.3%  2478  753s
  5330  2650 26382.8666   11  270 20475.0778 30368.8020  48.3%  2480  771s
  5392  2651 23880.6048   16  436 20475.0778 30368.8020  48.3%  2496  807s
  5394  2652 21859.1026   32  130 20475.0778 30368.8020  48.3%  2495  842s
  5395  2653 20555.0659   74  332 20475.0778 30368.8020  48.3%  2495  869s
  5396  2654 24608.4195   13  386 20475.0778 30368.8020  48.3%  2495  882s
  5397  2654 21801.7798   24  401 20475.0778 30368.8020  48.3%  2494  894s
  5398  2655 29449.6325   11  418 20475.0778 30368.8020  48.3%  2494  900s
  5400  2656 29855.2240    6  443 20475.0778 30368.8020  48.3%  2493  906s
  5402  2658 23080.4411   54  451 20475.0778 30368.8020  48.3%  2492  911s
  5404  2659 21655.8124   31  410 20475.0778 30368.8020  48.3%  2491  918s
  5405  2660 24216.2766   10  403 20475.0778 30368.8020  48.3%  2490  921s
  5407  2661 20928.8128   26  418 20475.0778 30368.8020  48.3%  2489  926s
  5409  2662 26188.7474   18  412 20475.0778 30368.8020  48.3%  2489  933s
  5410  2663 21324.7438   19  431 20475.0778 30368.8020  48.3%  2488  935s
  5411  2664 24216.2766   10  412 20475.0778 30368.8020  48.3%  2488  940s
  5413  2665 21290.5935   20  426 20475.0778 30368.8020  48.3%  2487  947s
  5415  2666 21836.0029   19  426 20475.0778 30368.8020  48.3%  2486  953s
  5416  2667 24105.3094   14  435 20475.0778 30368.8020  48.3%  2485  955s
  5417  2668 26535.8353   12  425 20475.0778 30368.8020  48.3%  2485  960s
  5419  2669 20702.9081   40  425 20475.0778 30368.8020  48.3%  2484  965s
  5421  2670 21020.9675   25  426 20475.0778 30368.8020  48.3%  2483  970s
  5422  2671 23093.3140   12  426 20475.0778 30368.8020  48.3%  2483 1003s
  5423  2672 21206.9892   20  426 20475.0778 30368.8020  48.3%  2482 1030s
  5424  2675 30368.8020   16  411 20475.0778 30368.8020  48.3%  2520 1043s
  5426  2679 30368.8020   17  395 20475.0778 30368.8020  48.3%  2521 1053s
  5430  2685 30368.8020   18  403 20475.0778 30368.8020  48.3%  2525 1069s
  5438  2699 30368.8020   19  427 20475.0778 30368.8020  48.3%  2533 1085s
  5454  2709 30279.0595   20  255 20475.0778 30368.8020  48.3%  2571 1111s
  5470  2736 30240.3205   21  323 20475.0778 30368.8020  48.3%  2587 1126s
  5502  2829 29964.6141   22  305 20475.0778 30368.8020  48.3%  2614 1142s
  5606  2842 28695.0794   25  255 20475.0778 30368.8020  48.3%  2667 1154s
  5679  2844 28706.2889   24  250 20475.0778 30368.8020  48.3%  2680 1164s
  5750  2841 27685.9233   26  204 20475.0778 30368.8020  48.3%  2691 1174s
  5809  2829 27661.9410   27  243 20475.0778 30368.8020  48.3%  2696 1190s
  5891  2816 27270.0015   29  226 20475.0778 30368.8020  48.3%  2691 1200s
  5960  2797     cutoff   28      20475.0778 30368.8020  48.3%  2697 1212s
  6030  2790 21595.4504   31  199 20475.0778 30368.8020  48.3%  2701 1226s
  6084  2791 21199.7642   32  173 20475.0778 30368.8020  48.3%  2710 1239s
  6150  2798 20672.3367   35  141 20475.0778 30368.8020  48.3%  2713 1250s
  6208  2810 26091.5212   23  272 20475.0778 30368.8020  48.3%  2720 1261s
  6267  2809 22281.3508   25  233 20475.0778 30368.8020  48.3%  2727 1271s
  6344  2810 21877.7457   26  224 20475.0778 30368.8020  48.3%  2724 1281s
  6411  2807 21707.0575   27  216 20475.0778 30368.8020  48.3%  2731 1291s
  6475  2806 21698.7920   28  213 20475.0778 30368.8020  48.3%  2738 1300s
  6525  2790 infeasible   30      20475.0778 30368.8020  48.3%  2745 1311s
  6591  2782     cutoff   32      20475.0778 30368.8020  48.3%  2744 1321s
  6669  2783     cutoff   35      20475.0778 30368.8020  48.3%  2744 1332s
  6747  2787 24783.1867   22  362 20475.0778 30031.7976  46.7%  2749 1342s
  6828  2791 24457.7607   23  359 20475.0778 29513.3530  44.1%  2755 1352s
  6909  2781 24334.6694   24  320 20475.0778 29234.8260  42.8%  2754 1369s
  7015  2794 23754.0087   25  250 20475.0778 29234.8260  42.8%  2756 1380s
  7105  2792 23629.8814   26  298 20475.0778 29234.8260  42.8%  2764 1392s
  7233  2780 21475.7143   26  269 20475.0778 29198.6406  42.6%  2758 1408s
  7370  2774     cutoff   27      20475.0778 29198.6406  42.6%  2749 1422s
  7512  2727 22121.8467   28  237 20475.0778 28850.5010  40.9%  2747 1434s
  7566  2725     cutoff   29      20475.0778 28850.5010  40.9%  2748 1443s
  7612  2728 22028.3810   28  274 20475.0778 28850.5010  40.9%  2756 1456s
  7658  2721     cutoff   29      20475.0778 28850.5010  40.9%  2757 1470s
  7724  2717 22264.5482   27  334 20475.0778 28850.5010  40.9%  2756 1485s
  7825  2721 21717.9334   28  280 20475.0778 28850.5010  40.9%  2748 1498s
H 7841  2581                    20515.794561 28850.5010  40.6%  2743 1498s
  7938  2594     cutoff   29      20515.7946 27883.9120  35.9%  2742 1515s
H 7942  2466                    20788.768788 27883.9120  34.1%  2741 1515s
H 7967  2337                    20795.961601 27622.6850  32.8%  2735 1515s
H 8057  2192                    20823.881172 27622.6850  32.6%  2727 1515s
H 8103  2067                    20867.734273 27622.6850  32.4%  2723 1515s
  8140  2113     cutoff   32      20867.7343 27564.4163  32.1%  2721 1532s
  8363  2057     cutoff   36      20867.7343 27410.7931  31.4%  2703 1552s
  8521  2069 infeasible   25      20867.7343 27304.0339  30.8%  2703 1569s
  8719  2077 21496.5986   28  164 20867.7343 27163.3683  30.2%  2696 1590s
  8952  2094 21846.3286   36  210 20867.7343 27028.4759  29.5%  2678 1614s
  9221  2055     cutoff   25      20867.7343 26850.2905  28.7%  2656 1634s
  9436  2045 21689.5867   26  201 20867.7343 26573.3347  27.3%  2638 1654s
  9701  2026 22779.8149   27  261 20867.7343 26260.8719  25.8%  2623 1675s
 10004  1953 21445.8605   33  176 20867.7343 26260.8719  25.8%  2598 1695s
 10333  1873     cutoff   57      20867.7343 25639.5218  22.9%  2580 1716s
 10682  1758 23090.8374   29  386 20867.7343 25423.0886  21.8%  2567 1740s
 10958  1656 22257.4252   32  171 20867.7343 25246.9213  21.0%  2575 1759s
 11039  1668 21399.4308   33  160 20867.7343 25246.9213  21.0%  2578 1781s
H11042  1563                    20884.973145 25246.9213  20.9%  2578 1781s
 11119  1594 21175.1868   34  103 20884.9731 25246.9213  20.9%  2577 1806s
 11527  1544 21232.9847   32  218 20884.9731 24210.3828  15.9%  2557 1830s
 11934  1543     cutoff   29      20884.9731 23682.4005  13.4%  2544 1859s
 12356  1546     cutoff   28      20884.9731 23478.9632  12.4%  2532 1884s
 12727  1574 21306.9736   27  142 20884.9731 23161.9142  10.9%  2521 1912s
 13284  1473 20970.9304   28  163 20884.9731 23015.9603  10.2%  2489 1939s
 13985  1280     cutoff   26      20884.9731 22681.9752  8.60%  2438 1966s
 14895  1037     cutoff   37      20884.9731 22279.8540  6.68%  2355 1993s
 16463  1337 21146.8836   49   57 20884.9731 21886.7781  4.80%  2183 2012s
 18632  1824 21085.2984   50   47 20884.9731 21343.3217  2.19%  1953 2026s
 20700  2015 21004.1369   53   48 20884.9731 21319.4536  2.08%  1772 2037s
 21780  2808 20931.2319   54   27 20884.9731 21319.4536  2.08%  1691 2049s
*23557  2743              76    20902.995506 21319.4536  1.99%  1572 2049s
*24513  2547              75    20929.887735 21259.3787  1.57%  1516 2049s
 24946  2445     cutoff   54      20929.8877 21170.2133  1.15%  1492 2057s
*26075  2399              90    20933.969416 21170.2133  1.13%  1433 2057s
*28816  2359              95    20936.935948 21087.5656  0.72%  1308 2057s
 28882  1574 20966.1316   61   22 20936.9359 21085.0668  0.71%  1306 2064s
*29828   921              76    20968.658498 21082.6349  0.54%  1268 2064s
*31766   921             104    20970.950919 21072.5246  0.48%  1196 2065s
*32442   921              69    20985.593169 21058.4828  0.35%  1174 2065s

Cutting planes:
  Learned: 2
  MIR: 591
  Mixing: 3
  Flow cover: 1827
  RLT: 18
  Relax-and-lift: 194

Explored 34269 nodes (38392265 simplex iterations) in 2066.89 seconds (6380.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20985.6 20985.6 20971 ... 20867.7

Optimal solution found (tolerance 1.00e-06)
Best objective 2.098559316898e+04, best bound 2.098559316898e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2066.95s
  Master Objective (UB) = 20985.59, θ = 174741.20
  Upper Bound (UB) = 20985.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 174741.20
  [DEBUG]   ✓ Scenario 0: θ = 174741.20 ≤ Q = 184300.38 (slack: 9559.18)
  [DEBUG]   ✓ Scenario 1: θ = 174741.20 ≤ Q = 174741.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 174741.20 ≤ Q = 174771.83 (slack: 30.63)
  [DEBUG]   ✓ Scenario 3: θ = 174741.20 ≤ Q = 174757.12 (slack: 15.92)
  [DEBUG]   ✓ Scenario 4: θ = 174741.20 ≤ Q = 174758.29 (slack: 17.09)
  [DEBUG]   ✓ Scenario 5: θ = 174741.20 ≤ Q = 174741.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 174741.20 ≤ Q = 174741.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x43edd918
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x43edd918
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.251091e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6896122.9615
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.422798e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142279.81    0  135 6896122.96 -142279.81   102%     -    0s
H    0     0                    -107091.5327 -142279.81  32.9%     -    0s
H    0     0                    -109475.0080 -142279.81  30.0%     -    0s
H    0     0                    -113685.6370 -124181.54  9.23%     -    0s
H    0     0                    -117254.0019 -124181.54  5.91%     -    0s
     0     0 -124181.54    0   87 -117254.00 -124181.54  5.91%     -    0s
H    0     0                    -120433.1355 -124128.46  3.07%     -    0s
     0     0 -124120.92    0   89 -120433.14 -124120.92  3.06%     -    0s
     0     0 -124120.09    0   83 -120433.14 -124120.09  3.06%     -    0s
H    0     0                    -122655.0722 -124120.09  1.19%     -    0s
     0     0 -123707.31    0   77 -122655.07 -123707.31  0.86%     -    0s
H    0     0                    -122682.9635 -123666.99  0.80%     -    0s
     0     0 -123600.70    0   73 -122682.96 -123600.70  0.75%     -    0s
     0     0 -123574.98    0   73 -122682.96 -123574.98  0.73%     -    0s
     0     0 -123183.04    0   60 -122682.96 -123183.04  0.41%     -    0s
H    0     0                    -122686.3871 -123173.25  0.40%     -    0s
     0     0 -123053.86    0   43 -122686.39 -123053.86  0.30%     -    0s
     0     0 -123041.31    0   39 -122686.39 -123041.31  0.29%     -    0s
     0     0 -123039.70    0   23 -122686.39 -123039.70  0.29%     -    0s
     0     0 -123011.03    0   27 -122686.39 -123011.03  0.26%     -    0s
     0     0 -123004.05    0   44 -122686.39 -123004.05  0.26%     -    0s
     0     0 -122859.08    0   16 -122686.39 -122859.08  0.14%     -    0s
     0     0 -122858.55    0   14 -122686.39 -122858.55  0.14%     -    0s
     0     0 -122820.54    0   14 -122686.39 -122820.54  0.11%     -    0s
     0     0 -122802.07    0   11 -122686.39 -122802.07  0.09%     -    0s
H    0     0                    -122701.9808 -122802.07  0.08%     -    0s
     0     0 -122768.78    0   10 -122701.98 -122768.78  0.05%     -    0s
     0     0 -122762.66    0    8 -122701.98 -122762.66  0.05%     -    0s
     0     0 -122729.64    0    8 -122701.98 -122729.64  0.02%     -    0s
     0     0 -122729.64    0    8 -122701.98 -122729.64  0.02%     -    0s
*    0     0               0    -122705.4044 -122705.40  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  MIR: 2
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (775 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122705 -122702 -122686 ... 6.89612e+06
No other solutions better than -122705

Optimal solution found (tolerance 1.00e-06)
Best objective -1.227054043872e+05, best bound -1.227054043872e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 161075.80
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122705.40
  [DEBUG]   S×d_nominal = 283781.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283781.21 + -122705.40 = 161075.80
  [DEBUG]   Current θ from Master = 174741.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13665.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7320.20
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 9881.6033, Absolute Gap = 9881.6033, Relative Gap = 0.470876
  Not converged yet (gap = 9881.60 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351559 nonzeros
Model fingerprint: 0xf1c3503c
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50096 rows and 20336 columns
Presolve time: 1.21s
Presolved: 73607 rows, 31844 columns, 458239 nonzeros
Variable types: 29585 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73607 rows, 31844 columns, 458239 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36487   -8.5799000e+04   0.000000e+00   1.544418e+07      5s
   50376   -5.3857519e+03   0.000000e+00   1.236969e+07     10s
   59381    2.0618714e+04   0.000000e+00   2.912928e+07     15s
   67841    2.6681342e+04   0.000000e+00   2.315597e+06     20s
   73775    3.1024427e+04   0.000000e+00   4.493650e+06     25s
   80619    3.5492533e+04   0.000000e+00   2.437466e+06     30s
   89171    3.7440433e+04   0.000000e+00   3.105976e+06     35s
   95663    3.9237116e+04   0.000000e+00   4.688194e+06     40s
Concurrent spin time: 2.69s

Solved with dual simplex

Root relaxation: objective 4.525742e+04, 66115 iterations, 43.16 seconds (82.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45257.4244    0  142 -222897.65 45257.4244   120%     -   44s
H    0     0                    -212361.1544 45257.4244   121%     -   44s
H    0     0                    -140355.6210 45257.4244   132%     -   45s
H    0     0                    -133897.3052 45257.4244   134%     -   45s
H    0     0                    -129750.3474 45257.4244   135%     -   45s
H    0     0                    -59707.28668 45257.4244   176%     -   45s
H    0     0                    -21228.85933 45257.4244   313%     -   45s
H    0     0                    -6989.002155 45257.4244   748%     -   45s
H    0     0                     323.6882490 45257.4244      -     -   46s
H    0     0                    16962.256224 45257.4244   167%     -   46s
H    0     0                    16979.659870 45257.4244   167%     -   46s
H    0     0                    17208.120678 45257.4244   163%     -   46s
H    0     0                    17354.179233 45257.4244   161%     -   46s
H    0     0                    17479.262281 45257.4244   159%     -   46s
H    0     0                    17498.115461 45257.4244   159%     -   46s
H    0     0                    18167.550898 40363.6099   122%     -   57s
H    0     0                    18528.642749 40363.6099   118%     -   57s
H    0     0                    18626.426080 40363.6099   117%     -   57s
     0     0 40292.3876    0  240 18626.4261 40292.3876   116%     -   57s
     0     0 39372.7390    0  236 18626.4261 39372.7390   111%     -   65s
     0     0 39105.7980    0  248 18626.4261 39105.7980   110%     -   70s
     0     0 39036.8515    0  257 18626.4261 39036.8515   110%     -   71s
     0     0 39017.0217    0  244 18626.4261 39017.0217   109%     -   74s
     0     0 39017.0217    0  240 18626.4261 39017.0217   109%     -   75s
     0     0 39017.0217    0  258 18626.4261 39017.0217   109%     -   77s
     0     0 39017.0217    0  251 18626.4261 39017.0217   109%     -   78s
     0     0 39016.9606    0  255 18626.4261 39016.9606   109%     -   79s
     0     0 36734.8949    0  380 18626.4261 36734.8949  97.2%     -   90s
H    0     0                    19033.449514 36734.7094  93.0%     -   91s
     0     0 36217.2653    0  361 19033.4495 36217.2653  90.3%     -   98s
     0     0 36069.9532    0  365 19033.4495 36069.9532  89.5%     -  102s
     0     0 35976.5798    0  370 19033.4495 35976.5798  89.0%     -  105s
     0     0 35967.1676    0  374 19033.4495 35967.1676  89.0%     -  106s
     0     0 35916.7819    0  374 19033.4495 35916.7819  88.7%     -  109s
     0     0 35905.3674    0  377 19033.4495 35905.3674  88.6%     -  111s
     0     0 35820.2299    0  411 19033.4495 35820.2299  88.2%     -  113s
     0     0 35804.4067    0  423 19033.4495 35804.4067  88.1%     -  115s
     0     0 35801.8530    0  413 19033.4495 35801.8530  88.1%     -  115s
     0     0 35799.5353    0  382 19033.4495 35799.5353  88.1%     -  115s
     0     0 35799.3924    0  380 19033.4495 35799.3924  88.1%     -  115s
     0     0 34363.1488    0  427 19033.4495 34363.1488  80.5%     -  133s
H    0     0                    19236.061310 34363.1282  78.6%     -  134s
H    0     0                    19375.775246 34363.1282  77.4%     -  134s
     0     0 34009.4270    0  418 19375.7752 34009.4270  75.5%     -  139s
     0     0 33869.9667    0  434 19375.7752 33869.9667  74.8%     -  145s
     0     0 33784.6652    0  434 19375.7752 33784.6652  74.4%     -  150s
     0     0 33751.6593    0  400 19375.7752 33751.6593  74.2%     -  153s
     0     0 33731.5801    0  433 19375.7752 33731.5801  74.1%     -  154s
     0     0 33689.9059    0  433 19375.7752 33689.9059  73.9%     -  157s
     0     0 33681.8186    0  447 19375.7752 33681.8186  73.8%     -  159s
     0     0 33677.1722    0  444 19375.7752 33677.1722  73.8%     -  160s
     0     0 33675.8956    0  445 19375.7752 33675.8956  73.8%     -  160s
     0     0 33674.9512    0  447 19375.7752 33674.9512  73.8%     -  161s
     0     0 33384.2391    0  444 19375.7752 33384.2391  72.3%     -  173s
     0     0 33297.1020    0  409 19375.7752 33297.1020  71.8%     -  177s
     0     0 33241.4404    0  401 19375.7752 33241.4404  71.6%     -  180s
     0     0 33224.6925    0  424 19375.7752 33224.6925  71.5%     -  182s
     0     0 33213.5663    0  422 19375.7752 33213.5663  71.4%     -  183s
     0     0 33208.4557    0  426 19375.7752 33208.4557  71.4%     -  184s
     0     0 33207.4441    0  425 19375.7752 33207.4441  71.4%     -  184s
     0     0 33163.6817    0  438 19375.7752 33163.6817  71.2%     -  189s
     0     0 33149.4670    0  445 19375.7752 33149.4670  71.1%     -  191s
     0     0 33145.3014    0  444 19375.7752 33145.3014  71.1%     -  192s
     0     0 33143.5308    0  444 19375.7752 33143.5308  71.1%     -  192s
     0     0 33141.5487    0  441 19375.7752 33141.5487  71.0%     -  192s
     0     0 33141.4294    0  447 19375.7752 33141.4294  71.0%     -  193s
     0     0 33113.9097    0  431 19375.7752 33113.9097  70.9%     -  195s
     0     0 33105.1168    0  438 19375.7752 33105.1168  70.9%     -  197s
     0     0 33103.7067    0  440 19375.7752 33103.7067  70.9%     -  197s
     0     0 33103.0993    0  448 19375.7752 33103.0993  70.8%     -  198s
     0     0 33078.6435    0  448 19375.7752 33078.6435  70.7%     -  201s
     0     0 33074.8771    0  448 19375.7752 33074.8771  70.7%     -  203s
     0     0 33073.7630    0  443 19375.7752 33073.7630  70.7%     -  203s
     0     0 33062.4835    0  451 19375.7752 33062.4835  70.6%     -  205s
     0     0 33059.2212    0  450 19375.7752 33059.2212  70.6%     -  206s
     0     0 33057.6244    0  454 19375.7752 33057.6244  70.6%     -  207s
     0     0 33057.2336    0  455 19375.7752 33057.2336  70.6%     -  207s
     0     0 33053.3524    0  449 19375.7752 33053.3524  70.6%     -  209s
     0     0 33050.4170    0  450 19375.7752 33050.4170  70.6%     -  210s
     0     0 33049.5349    0  441 19375.7752 33049.5349  70.6%     -  211s
     0     0 33045.8047    0  453 19375.7752 33045.8047  70.6%     -  212s
     0     0 33043.1165    0  447 19375.7752 33043.1165  70.5%     -  214s
     0     0 33042.1671    0  448 19375.7752 33042.1671  70.5%     -  214s
     0     0 33039.8028    0  449 19375.7752 33039.8028  70.5%     -  215s
     0     0 33038.8092    0  449 19375.7752 33038.8092  70.5%     -  217s
H    0     0                    19582.100875 33038.8092  68.7%     -  236s
H    0     0                    20025.805139 33038.8092  65.0%     -  254s
     0     2 33038.8092    0  449 20025.8051 33038.8092  65.0%     -  255s
     3     8 32859.2954    2  426 20025.8051 32959.7952  64.6%  3909  269s
     7    16 32779.9715    3  436 20025.8051 32858.6434  64.1%  5821  277s
    15    32 32693.4980    4  438 20025.8051 32779.8598  63.7%  6605  289s
    31    48 31744.7003    5  361 20025.8051 32693.0903  63.3%  9328  312s
H   47    80                    20411.921602 32693.0903  60.2% 10530  327s
H   52    80                    20496.747433 32693.0903  59.5% 10515  327s
H   52    80                    20515.855110 32693.0903  59.4% 10515  327s
H   53    80                    20551.542435 32693.0903  59.1% 10442  327s
H   67    80                    20593.639082 32693.0903  58.8%  9483  327s
    79   141 30664.3756    7  369 20593.6391 32693.0903  58.8%  8558  360s
   142   259 30502.1711    9  309 20593.6391 32693.0903  58.8%  6527  374s
H  213   259                    20622.616636 32693.0903  58.5%  5023  374s
   260   359 30365.6159   11  283 20622.6166 32693.0903  58.5%  4605  384s
   362   443 30176.9558   12  288 20622.6166 32693.0903  58.5%  4008  392s
H  398   443                    20628.965081 32693.0903  58.5%  3826  392s
H  441   443                    20637.508816 32693.0903  58.4%  3649  392s
   452   517 30199.5502   12  266 20637.5088 32693.0903  58.4%  3638  401s
   534   545 30166.8804   12  266 20637.5088 32693.0903  58.4%  3422  410s
   568   579 29905.7571   13  268 20637.5088 32693.0903  58.4%  3350  418s
   602   608 29901.7745   13  341 20637.5088 32693.0903  58.4%  3325  426s
   635   641 30026.3999   13  267 20637.5088 32693.0903  58.4%  3278  432s
H  637   641                    20673.347093 32693.0903  58.1%  3270  432s
H  675   641                    20743.592114 32693.0903  57.6%  3191  432s
   676   716 30057.0637   14  268 20743.5921 32693.0903  57.6%  3193  440s
   769   770 29909.5447   13  276 20743.5921 32693.0903  57.6%  3001  448s
   860   807 29877.4070   14  262 20743.5921 32693.0903  57.6%  2845  458s
   941   870 29905.5030   14  266 20743.5921 32693.0903  57.6%  2744  467s
H  959   870                    20849.040207 32693.0903  56.8%  2702  467s
  1012   937 29373.9697   14  259 20849.0402 32693.0903  56.8%  2713  477s
  1099  1012 29099.8737   15  257 20849.0402 32693.0903  56.8%  2657  486s
H 1100  1012                    20893.550634 32693.0903  56.5%  2654  486s
H 1120  1012                    20933.969416 32693.0903  56.2%  2635  486s
  1202  1044 29936.8602   15  331 20933.9694 32693.0903  56.2%  2574  495s
  1260  1070 27803.3707   15  260 20933.9694 32693.0903  56.2%  2540  505s
  1324  1123 29681.9768   15  250 20933.9694 32693.0903  56.2%  2516  516s
  1405  1180 28898.7420   16  292 20933.9694 32693.0903  56.2%  2489  527s
  1496  1264 27976.2403   15  212 20933.9694 32693.0903  56.2%  2453  538s
  1598  1347 29711.2357   16  326 20933.9694 32693.0903  56.2%  2411  549s
  1727  1429 28796.2457   18  276 20933.9694 32693.0903  56.2%  2367  560s
  1853  1536 28726.7656   19  315 20933.9694 32693.0903  56.2%  2330  570s
  1994  1673 28532.7798   21  202 20933.9694 32515.2297  55.3%  2274  582s
  2169  1704 27465.5559   24  284 20933.9694 32515.2297  55.3%  2202  594s
  2257  1710 27653.6702   23  229 20933.9694 32515.2297  55.3%  2183  606s
  2327  1729 27030.3404   24  182 20933.9694 32515.2297  55.3%  2192  620s
  2388  1769 27211.1202   25  248 20933.9694 32515.2297  55.3%  2248  634s
  2472  1810 infeasible   24      20933.9694 32515.2297  55.3%  2267  647s
  2557  1856     cutoff   26      20933.9694 32505.5860  55.3%  2277  662s
  2648  1894     cutoff   26      20933.9694 32194.5983  53.8%  2317  677s
  2724  2004 22408.2456   27  260 20933.9694 31852.8925  52.2%  2334  692s
  2882  2109 22058.1269   28  276 20933.9694 31772.3014  51.8%  2302  708s
  3064  2193 21403.9154   30  191 20933.9694 31772.3014  51.8%  2275  726s
  3232  2261 21798.2383   30  260 20933.9694 31772.3014  51.8%  2249  743s
  3370  2320     cutoff   35      20933.9694 31772.3014  51.8%  2273  762s
  3514  2347 25429.7776   14  239 20933.9694 31772.3014  51.8%  2299  779s
  3599  2384 25141.9349   16  229 20933.9694 31772.3014  51.8%  2318  798s
  3696  2401 23318.1836   22  207 20933.9694 31772.3014  51.8%  2348  816s
  3741  2430 23059.2339   23  196 20933.9694 31215.8737  49.1%  2388  835s
  3796  2475 22722.1573   24  195 20933.9694 31215.8737  49.1%  2410  854s
  3883  2516 22168.8029   25  197 20933.9694 31215.8737  49.1%  2429  874s
  3996  2581 22145.5631   26  225 20933.9694 31215.8737  49.1%  2442  894s
  4180  2648 21797.8408   28  153 20933.9694 31215.8737  49.1%  2431  918s
  4355  2701 29752.0763   13  269 20933.9694 31215.8737  49.1%  2441  942s
  4508  2756 24436.9103   15  295 20933.9694 31045.4931  48.3%  2488  966s
  4683  2808 22728.4138   17  421 20933.9694 30904.9192  47.6%  2520  993s
  4795  2846     cutoff   18      20933.9694 30771.6448  47.0%  2544 1029s
  4978  2880 22225.9289   17  301 20933.9694 30736.7581  46.8%  2568 1056s
  5127  2947     cutoff   18      20933.9694 30696.4312  46.6%  2607 1084s
  5294  2997 28635.0761   12  306 20933.9694 30695.8487  46.6%  2641 1114s
  5502  3078 23779.3486   14  246 20933.9694 30608.7858  46.2%  2664 1152s
  5720  3079 21933.7282   25  449 20933.9694 30608.7858  46.2%  2691 1209s
  5722  3080 28352.1988   10  142 20933.9694 30608.7858  46.2%  2691 1243s
  5723  3081 22427.8311   21  349 20933.9694 30608.7858  46.2%  2690 1270s
  5724  3082 24691.6513   17  413 20933.9694 30608.7858  46.2%  2690 1293s
  5725  3082 26077.7277   25  392 20933.9694 30608.7858  46.2%  2689 1304s
  5726  3083 21615.1783   49  401 20933.9694 30608.7858  46.2%  2689 1313s
  5727  3084 23243.4611   22  431 20933.9694 30608.7858  46.2%  2688 1319s
  5728  3084 28651.7382   21  475 20933.9694 30608.7858  46.2%  2688 1325s
  5729  3085 23081.5467   47  432 20933.9694 30608.7858  46.2%  2687 1330s
  5731  3086 28777.5830   12  477 20933.9694 30608.7858  46.2%  2686 1337s
  5732  3087 24740.6758   16  432 20933.9694 30608.7858  46.2%  2686 1340s
  5734  3088 27850.4395   37  445 20933.9694 30608.7858  46.2%  2685 1351s
  5735  3089 24917.0739   11  489 20933.9694 30608.7858  46.2%  2684 1355s
  5737  3090 23990.4127   14  444 20933.9694 30608.7858  46.2%  2684 1364s
  5738  3091 20954.8356   67  445 20933.9694 30608.7858  46.2%  2683 1367s
  5739  3092 22326.1086   30  478 20933.9694 30608.7858  46.2%  2683 1373s
  5740  3092 22679.3391   13  449 20933.9694 30608.7858  46.2%  2682 1375s
  5741  3093 25121.1550    9  486 20933.9694 30608.7858  46.2%  2682 1380s
  5743  3094 24963.2980   17  469 20933.9694 30608.7858  46.2%  2681 1392s
  5744  3095 22271.5440   44  481 20933.9694 30608.7858  46.2%  2680 1395s
  5746  3096 21362.6938   25  532 20933.9694 30608.7858  46.2%  2679 1404s
  5747  3097 24105.0989   18  545 20933.9694 30608.7858  46.2%  2679 1407s
  5748  3098 23466.3593   65  477 20933.9694 30608.7858  46.2%  2678 1413s
  5749  3098 21838.6943   20  508 20933.9694 30608.7858  46.2%  2678 1416s
  5750  3099 22961.8943   28  494 20933.9694 30608.7858  46.2%  2677 1421s
  5751  3100 23071.5480   21  494 20933.9694 30608.7858  46.2%  2677 1453s
  5752  3100 21298.3486   55  494 20933.9694 30608.7858  46.2%  2677 1492s
  5753  3103 30608.7858   10  426 20933.9694 30608.7858  46.2%  2716 1511s
  5754  3106 30608.7858   11  330 20933.9694 30608.7858  46.2%  2717 1527s
  5757  3111 30608.7858   12  328 20933.9694 30608.7858  46.2%  2720 1552s
  5763  3121 30493.2558   13  281 20933.9694 30608.7858  46.2%  2727 1571s
  5775  3130 23626.1652   14  187 20933.9694 30608.7858  46.2%  2758 1608s
  5788  3157 28323.0906   14  250 20933.9694 30608.7858  46.2%  2782 1645s
  5820  3231 27990.1863   15  266 20933.9694 30608.7858  46.2%  2835 1670s
  5926  3239 27567.5202   16  264 20933.9694 30608.7858  46.2%  2889 1697s
  6011  3241 24785.3665   19  237 20933.9694 30608.7858  46.2%  2924 1713s
  6074  3241 22605.6935   19  231 20933.9694 30608.7858  46.2%  2982 1727s
  6111  3239     cutoff   21      20933.9694 30608.7858  46.2%  3031 1741s
  6154  3232 22038.2210   20  195 20933.9694 30608.7858  46.2%  3057 1754s
  6206  3211     cutoff   21      20933.9694 30608.7858  46.2%  3085 1769s
  6264  3208     cutoff   21      20933.9694 30608.7858  46.2%  3114 1784s
  6306  3220 21255.1116   22  175 20933.9694 30608.7858  46.2%  3150 1797s
  6353  3222     cutoff   21      20933.9694 30608.7858  46.2%  3189 1812s
  6396  3226 25575.2317   18  402 20933.9694 30608.7858  46.2%  3212 1825s
  6442  3229 25489.9722   19  396 20933.9694 30608.7858  46.2%  3234 1839s
  6486  3238 25310.0392   20  419 20933.9694 30608.7858  46.2%  3256 1851s
  6537  3239 25142.2534   21  408 20933.9694 30608.7858  46.2%  3276 1871s
  6594  3243 24898.3431   22  405 20933.9694 30608.7858  46.2%  3301 1886s
  6648  3244 24867.7819   23  344 20933.9694 30608.7858  46.2%  3329 1898s
  6706  3233 23400.3115   24  375 20933.9694 30608.7858  46.2%  3342 1912s
  6760  3228 23383.2563   25  370 20933.9694 30608.7858  46.2%  3359 1926s
  6803  3233 23251.8902   26  359 20933.9694 30172.0361  44.1%  3390 1942s
  6844  3236 22773.2266   27  270 20933.9694 30172.0361  44.1%  3411 1957s
  6896  3232 22395.4441   28  248 20933.9694 29714.1141  41.9%  3426 1974s
  6958  3240 21981.6824   29  227 20933.9694 29714.1141  41.9%  3439 1990s
  7031  3243 21920.7667   30  295 20933.9694 29714.1141  41.9%  3463 2012s
  7122  3228 infeasible   31      20933.9694 29010.2593  38.6%  3484 2031s
  7215  3230 22728.4107   20  212 20933.9694 29010.2593  38.6%  3509 2049s
  7313  3228     cutoff   22      20933.9694 29005.1237  38.6%  3543 2068s
  7424  3217 21064.9899   25  118 20933.9694 29005.1237  38.6%  3580 2087s
  7537  3225 21963.0495   23  260 20933.9694 28892.0749  38.0%  3616 2111s
  7675  3204 21324.8447   30   99 20933.9694 28892.0749  38.0%  3638 2132s
  7838  3166     cutoff   17      20933.9694 28892.0749  38.0%  3668 2156s
  7993  3150     cutoff   18      20933.9694 28892.0749  38.0%  3702 2180s
  8138  3127 21711.8578   20  280 20933.9694 27502.7873  31.4%  3737 2204s
  8308  3074 20980.6603   22  172 20933.9694 27269.3791  30.3%  3760 2235s
  8445  3026     cutoff   18      20933.9694 26600.0733  27.1%  3795 2264s
  8571  2999 24438.1671   18  313 20933.9694 26600.0733  27.1%  3853 2293s
  8712  2960     cutoff   19      20933.9694 26600.0733  27.1%  3901 2321s
  8891  2899 23660.5029   22  526 20933.9694 26011.8289  24.3%  3941 2350s
  9053  2847 23314.1032   25  340 20933.9694 25575.1954  22.2%  3985 2379s
  9237  2798     cutoff   27      20933.9694 25575.1954  22.2%  4028 2409s
  9425  2744 22068.2729   19  232 20933.9694 25132.0518  20.1%  4065 2433s
  9487  2728     cutoff   23      20933.9694 24952.4954  19.2%  4077 2462s
  9673  2703 22926.1283   30  326 20933.9694 24850.6034  18.7%  4088 2497s
  9907  2614     cutoff   25      20933.9694 24705.5943  18.0%  4106 2530s
 10162  2530     cutoff   25      20933.9694 24498.3468  17.0%  4143 2567s
 10456  2445 21962.0734   26  235 20933.9694 24498.3468  17.0%  4168 2606s
 10746  2344     cutoff   29      20933.9694 24498.3468  17.0%  4191 2644s
 11077  2249     cutoff   25      20933.9694 23843.6730  13.9%  4206 2683s
 11483  2051 infeasible   19      20933.9694 23450.0913  12.0%  4204 2723s
 11886  1867     cutoff   20      20933.9694 23233.7759  11.0%  4214 2764s
 12299  1556 20978.8601   21  144 20933.9694 22977.2473  9.76%  4192 2806s
 12814  1090 21472.0441   20  273 20933.9694 22575.7300  7.84%  4173 2847s
 13863   621     cutoff   24      20933.9694 21919.8804  4.71%  3965 2870s
 15090   275 21059.5994   44  121 20933.9694 21274.9114  1.63%  3677 2896s
 15411   333     cutoff   54      20933.9694 21218.7534  1.36%  3605 2910s
 17060    94 20947.7135   49   39 20933.9694 21154.2405  1.05%  3275 2917s
 18414    35     cutoff   51      20933.9694 21052.8705  0.57%  3043 2920s

Cutting planes:
  Learned: 2
  MIR: 594
  Flow cover: 2203
  RLT: 24
  Relax-and-lift: 113

Explored 18910 nodes (56349489 simplex iterations) in 2921.06 seconds (8659.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20934 20893.6 20743.6 ... 20515.9

Optimal solution found (tolerance 1.00e-06)
Best objective 2.093396941643e+04, best bound 2.093396941643e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2921.08s
  Master Objective (UB) = 20933.97, θ = 173540.18
  Upper Bound (UB) = 20933.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173540.18
  [DEBUG]   ✓ Scenario 0: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173540.18 ≤ Q = 173540.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173540.18 ≤ Q = 173540.18 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x356f3325
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca90ccdb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.257279e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6827593.1850
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.430531e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143053.06    0  123 6827593.19 -143053.06   102%     -    0s
H    0     0                    -106699.0764 -143053.06  34.1%     -    0s
H    0     0                    -108061.8582 -143053.06  32.4%     -    0s
     0     0 -123960.96    0   99 -108061.86 -123960.96  14.7%     -    0s
H    0     0                    -119938.7049 -123911.20  3.31%     -    0s
H    0     0                    -121507.4650 -123911.20  1.98%     -    0s
     0     0 -123041.57    0   96 -121507.46 -123041.57  1.26%     -    0s
H    0     0                    -121729.7413 -123033.16  1.07%     -    0s
     0     0 -122446.97    0   97 -121729.74 -122446.97  0.59%     -    0s
     0     0 -122420.16    0   96 -121729.74 -122420.16  0.57%     -    0s
     0     0 -122396.16    0   78 -121729.74 -122396.16  0.55%     -    0s
H    0     0                    -121773.1715 -122379.65  0.50%     -    0s
     0     0 -122342.14    0   78 -121773.17 -122342.14  0.47%     -    0s
     0     0 -122327.01    0   76 -121773.17 -122327.01  0.45%     -    0s
     0     0 -122256.13    0   69 -121773.17 -122256.13  0.40%     -    0s
     0     0 -122200.88    0   75 -121773.17 -122200.88  0.35%     -    0s
     0     0 -122196.94    0   70 -121773.17 -122196.94  0.35%     -    0s
     0     0 -122100.04    0   73 -121773.17 -122100.04  0.27%     -    0s
     0     0 -122076.11    0   73 -121773.17 -122076.11  0.25%     -    0s
     0     0 -122076.11    0   52 -121773.17 -122076.11  0.25%     -    0s
     0     0 -122076.11    0   91 -121773.17 -122076.11  0.25%     -    0s
     0     0 -122076.11    0   52 -121773.17 -122076.11  0.25%     -    0s
H    0     0                    -121774.6254 -122076.11  0.25%     -    0s
     0     0 -122047.12    0   47 -121774.63 -122047.12  0.22%     -    0s
     0     0 -122019.93    0   44 -121774.63 -122019.93  0.20%     -    0s
     0     0 -122019.67    0   44 -121774.63 -122019.67  0.20%     -    0s
H    0     0                    -121774.7047 -122019.67  0.20%     -    0s
     0     0 -121970.45    0   35 -121774.70 -121970.45  0.16%     -    0s
     0     0 -121958.80    0   43 -121774.70 -121958.80  0.15%     -    0s
     0     0 -121950.45    0   47 -121774.70 -121950.45  0.14%     -    0s
     0     0 -121922.65    0   42 -121774.70 -121922.65  0.12%     -    0s
     0     0 -121922.38    0   42 -121774.70 -121922.38  0.12%     -    0s
     0     0 -121903.73    0   43 -121774.70 -121903.73  0.11%     -    0s
     0     0 -121901.40    0   43 -121774.70 -121901.40  0.10%     -    0s
     0     0 -121899.45    0   43 -121774.70 -121899.45  0.10%     -    0s
     0     0 -121897.38    0   43 -121774.70 -121897.38  0.10%     -    0s
H    0     0                    -121783.2561 -121896.39  0.09%     -    0s
     0     0 -121896.39    0   50 -121783.26 -121896.39  0.09%     -    0s
     0     0 -121896.39    0   42 -121783.26 -121896.39  0.09%     -    0s
H    0     0                    -121787.6534 -121896.39  0.09%     -    0s
     0     0 -121896.39    0   43 -121787.65 -121896.39  0.09%     -    0s
     0     0 -121876.01    0   14 -121787.65 -121876.01  0.07%     -    0s
     0     0 -121852.12    0   12 -121787.65 -121852.12  0.05%     -    0s
     0     0 -121839.85    0   11 -121787.65 -121839.85  0.04%     -    0s
     0     0 -121809.45    0   10 -121787.65 -121809.45  0.02%     -    0s
     0     0 -121799.58    0    3 -121787.65 -121799.58  0.01%     -    0s
     0     0 -121799.58    0    5 -121787.65 -121799.58  0.01%     -    0s
H    0     0                    -121795.1739 -121799.58  0.00%     -    0s
     0     0     cutoff    0      -121795.17 -121795.17  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 4
  RLT: 1

Explored 1 nodes (1546 simplex iterations) in 0.15 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121795 -121788 -121783 ... -106699
No other solutions better than -121795

Optimal solution found (tolerance 1.00e-06)
Best objective -1.217951738937e+05, best bound -1.217951738937e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 162086.04
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121795.17
  [DEBUG]   S×d_nominal = 283881.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283881.21 + -121795.17 = 162086.04
  [DEBUG]   Current θ from Master = 173540.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11454.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9479.83
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 9829.9796, Absolute Gap = 9829.9796, Relative Gap = 0.469571
  Not converged yet (gap = 9829.98 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394814 nonzeros
Model fingerprint: 0x550a0c63
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56358 rows and 22878 columns
Presolve time: 1.18s
Presolved: 82635 rows, 35542 columns, 505019 nonzeros
Variable types: 33283 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.430e+06
 Factor NZ  : 7.396e+06 (roughly 100 MB of memory)
 Factor Ops : 1.199e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.54555321e+07  1.49817564e+08  9.91e+04 2.17e+01  7.46e+04     3s
   1  -1.14420685e+07  1.30932151e+08  6.69e+04 6.85e+01  4.96e+04     3s
   2  -4.45487096e+06  9.95292796e+07  2.52e+04 3.32e+00  1.92e+04     3s
   3  -7.55916789e+05  7.62264163e+07  9.37e+02 1.47e+00  1.18e+03     3s
   4  -5.12035831e+05  3.28715556e+07  3.00e+02 4.56e-01  4.07e+02     3s
   5  -3.82284389e+05  2.18728849e+07  9.95e+01 2.77e-01  2.03e+02     3s
   6  -2.45344984e+05  1.54849544e+07  2.05e+01 1.86e-01  1.13e+02     3s
   7  -1.50524009e+05  1.18843045e+07  7.65e+00 1.40e-01  8.23e+01     3s
   8  -1.06089668e+05  4.83601565e+06  4.43e+00 5.43e-02  3.34e+01     3s
   9  -8.00991993e+04  2.83441021e+06  2.23e+00 3.13e-02  1.95e+01     3s
  10  -3.46007366e+04  6.62933385e+05  5.35e-01 6.80e-03  4.61e+00     3s
  11  -8.46832595e+03  3.15935329e+05  2.71e-01 3.04e-03  2.14e+00     3s
  12   4.66108334e+03  1.91997845e+05  1.84e-01 1.66e-03  1.24e+00     3s
  13   1.02018938e+04  1.56147090e+05  1.52e-01 1.56e-03  9.63e-01     3s
  14   1.63210563e+04  1.39024108e+05  1.19e-01 1.51e-03  8.10e-01     3s
  15   2.11445082e+04  1.19305983e+05  9.63e-02 1.60e-03  6.48e-01     3s
  16   2.54227843e+04  1.04833460e+05  7.75e-02 1.29e-03  5.24e-01     3s
  17   2.92536143e+04  9.14131050e+04  6.18e-02 1.40e-03  4.10e-01     3s
  18   3.30925682e+04  8.30435926e+04  4.82e-02 1.49e-03  3.29e-01     3s
  19   3.64340321e+04  7.73022796e+04  3.78e-02 1.57e-03  2.70e-01     3s
  20   3.82049175e+04  6.72517740e+04  3.26e-02 1.57e-03  1.92e-01     3s
  21   4.03902769e+04  6.54602808e+04  2.66e-02 1.40e-03  1.65e-01     3s
  22   4.25126555e+04  6.39305331e+04  2.08e-02 1.26e-03  1.41e-01     3s
  23   4.35593566e+04  6.17517559e+04  1.79e-02 1.07e-03  1.20e-01     3s
  24   4.45619663e+04  6.04769663e+04  1.52e-02 9.51e-04  1.05e-01     4s
  25   4.65950217e+04  5.81597509e+04  1.01e-02 7.08e-04  7.62e-02     4s
  26   4.72629900e+04  5.73571159e+04  8.51e-03 6.25e-04  6.65e-02     4s
  27   4.79848918e+04  5.52818891e+04  6.75e-03 4.44e-04  4.81e-02     4s
  28   4.86751429e+04  5.45725076e+04  5.21e-03 3.65e-04  3.89e-02     4s
  29   4.91223064e+04  5.40902675e+04  4.26e-03 3.12e-04  3.28e-02     4s
  30   4.96477829e+04  5.31739350e+04  3.14e-03 2.13e-04  2.32e-02     4s
  31   5.00749228e+04  5.27753233e+04  2.24e-03 1.68e-04  1.78e-02     4s
  32   5.04170241e+04  5.23419930e+04  1.50e-03 1.20e-04  1.27e-02     4s
  33   5.05539229e+04  5.21407368e+04  1.24e-03 9.84e-05  1.05e-02     4s
  34   5.06508505e+04  5.17547592e+04  1.05e-03 5.59e-05  7.28e-03     4s
  35   5.08469124e+04  5.16636045e+04  6.82e-04 4.58e-05  5.38e-03     4s
  36   5.09606904e+04  5.14326783e+04  4.68e-04 2.05e-05  3.11e-03     4s
  37   5.10020150e+04  5.13796018e+04  3.95e-04 1.47e-05  2.49e-03     4s
  38   5.10411074e+04  5.13621711e+04  3.30e-04 1.27e-05  2.12e-03     4s
  39   5.11155813e+04  5.13357355e+04  2.06e-04 9.91e-06  1.45e-03     4s
  40   5.11316822e+04  5.13226691e+04  1.77e-04 8.52e-06  1.26e-03     4s
  41   5.11918200e+04  5.12808495e+04  7.78e-05 4.16e-06  5.87e-04     4s
  42   5.12248279e+04  5.12676162e+04  2.02e-05 2.82e-06  2.82e-04     4s
  43   5.12353931e+04  5.12552302e+04  3.95e-06 1.58e-06  1.31e-04     4s
  44   5.12368705e+04  5.12436600e+04  2.30e-06 4.04e-07  4.47e-05     4s
  45   5.12386238e+04  5.12401313e+04  3.99e-07 7.29e-08  9.95e-06     4s
  46   5.12389906e+04  5.12393498e+04  1.77e-07 3.62e-09  2.38e-06     4s
  47   5.12392285e+04  5.12393253e+04  1.07e-07 2.21e-09  6.40e-07     4s
  48   5.12392574e+04  5.12393171e+04  5.42e-08 1.70e-09  3.94e-07     5s
  49   5.12392576e+04  5.12393169e+04  1.44e-07 1.69e-09  3.91e-07     5s
  50   5.12392857e+04  5.12392877e+04  7.84e-08 1.37e-09  1.38e-08     5s
  51   5.12392858e+04  5.12392877e+04  6.28e-07 1.19e-09  1.28e-08     5s
  52   5.12392866e+04  5.12392871e+04  2.14e-07 7.01e-09  2.97e-09     5s

Barrier solved model in 52 iterations and 4.74 seconds (7.88 work units)
Optimal objective 5.12392866e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

   14446 PPushes remaining with PInf 7.0548520e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4329096e+04      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50925    5.1239287e+04   0.000000e+00   1.432910e+04      8s
   51114    5.1239287e+04   0.000000e+00   0.000000e+00      8s
   51114    5.1239287e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.60s

Solved with barrier

Root relaxation: objective 5.123929e+04, 51114 iterations, 6.78 seconds (15.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51239.2871    0  275 -222897.65 51239.2871   123%     -    9s
H    0     0                    -212871.0974 51239.2871   124%     -    9s
H    0     0                    -194751.9723 51239.2871   126%     -    9s
H    0     0                    -192667.2308 51239.2871   127%     -    9s
H    0     0                    -189126.3442 51239.2871   127%     -    9s
H    0     0                    -111283.3417 51239.2871   146%     -    9s
H    0     0                    -108893.5878 51239.2871   147%     -    9s
H    0     0                    -80408.29162 51239.2871   164%     -    9s
H    0     0                    -80377.79892 51239.2871   164%     -    9s
H    0     0                    -2833.762931 51239.2871  1908%     -    9s
H    0     0                    4890.1067632 51239.2871   948%     -    9s
H    0     0                    5212.0817813 51239.2871   883%     -    9s
H    0     0                    5322.3455057 51239.2871   863%     -   10s
H    0     0                    5370.2258110 51239.2871   854%     -   10s
H    0     0                    5388.3190311 51239.2871   851%     -   10s
H    0     0                    6418.1730277 51239.2871   698%     -   11s
H    0     0                    6726.5057638 51239.2871   662%     -   11s
H    0     0                    7932.1637918 43569.4765   449%     -   40s
     0     0 43235.6283    0  351 7932.16379 43235.6283   445%     -   41s
H    0     0                    8200.0155088 43235.6283   427%     -   41s
H    0     0                    8294.7478713 43235.6283   421%     -   41s
     0     0 42598.5644    0  336 8294.74787 42598.5644   414%     -   51s
     0     0 42466.8907    0  331 8294.74787 42466.8907   412%     -   60s
     0     0 42466.8907    0  337 8294.74787 42466.8907   412%     -   66s
     0     0 42466.8907    0  333 8294.74787 42466.8907   412%     -   66s
     0     0 38551.5307    0  333 8294.74787 38551.5307   365%     -  100s
H    0     0                    10159.962332 38551.5009   279%     -  101s
H    0     0                    11240.733660 38551.5009   243%     -  101s
H    0     0                    12831.300066 38551.5009   200%     -  101s
H    0     0                    13115.964873 38551.5009   194%     -  101s
H    0     0                    13297.322542 38551.5009   190%     -  101s
H    0     0                    13548.223685 38551.5009   185%     -  102s
H    0     0                    13555.346724 38551.5009   184%     -  102s
H    0     0                    13591.339090 38551.5009   184%     -  102s
H    0     0                    13676.528975 38551.5009   182%     -  102s
H    0     0                    13735.852928 38551.5009   181%     -  102s
     0     0 37808.6967    0  361 13735.8529 37808.6967   175%     -  122s
     0     0 37500.2477    0  438 13735.8529 37500.2477   173%     -  138s
     0     0 37182.2179    0  474 13735.8529 37182.2179   171%     -  152s
     0     0 37114.7031    0  454 13735.8529 37114.7031   170%     -  158s
     0     0 37098.7987    0  457 13735.8529 37098.7987   170%     -  162s
     0     0 37092.5570    0  458 13735.8529 37092.5570   170%     -  164s
     0     0 37086.5311    0  454 13735.8529 37086.5311   170%     -  166s
     0     0 37083.1067    0  470 13735.8529 37083.1067   170%     -  167s
     0     0 37081.5259    0  473 13735.8529 37081.5259   170%     -  168s
H    0     0                    13812.924838 37081.5259   168%     -  179s
H    0     0                    13817.053853 37081.5259   168%     -  179s
H    0     0                    13935.635931 35213.4249   153%     -  242s
H    0     0                    14699.566651 35213.4249   140%     -  242s
H    0     0                    14703.256699 35213.4249   139%     -  242s
H    0     0                    14806.537069 35213.4249   138%     -  242s
H    0     0                    14846.910955 35213.4249   137%     -  242s
     0     0 35213.4249    0  364 14846.9110 35213.4249   137%     -  242s
H    0     0                    15299.859250 35213.1486   130%     -  242s
H    0     0                    15788.547103 35213.1486   123%     -  242s
H    0     0                    16082.435429 35213.1486   119%     -  242s
H    0     0                    16402.239321 35213.1486   115%     -  242s
H    0     0                    16730.585810 35213.1486   110%     -  242s
H    0     0                    17019.457738 35213.1486   107%     -  242s
H    0     0                    17617.338370 35213.1486   100%     -  242s
H    0     0                    18768.496762 35213.1486  87.6%     -  242s
H    0     0                    18844.683436 35213.1486  86.9%     -  242s
H    0     0                    18960.262430 35213.1486  85.7%     -  242s
H    0     0                    19005.329690 35213.1486  85.3%     -  242s
     0     0 34794.1120    0  382 19005.3297 34794.1120  83.1%     -  254s
     0     0 34588.4054    0  392 19005.3297 34588.4054  82.0%     -  263s
     0     0 34441.4839    0  406 19005.3297 34441.4839  81.2%     -  268s
     0     0 34407.9195    0  404 19005.3297 34407.9195  81.0%     -  273s
     0     0 34309.7842    0  461 19005.3297 34309.7842  80.5%     -  279s
     0     0 34259.6064    0  454 19005.3297 34259.6064  80.3%     -  285s
     0     0 34249.1455    0  460 19005.3297 34249.1455  80.2%     -  288s
     0     0 34239.9127    0  456 19005.3297 34239.9127  80.2%     -  290s
     0     0 34208.4688    0  460 19005.3297 34208.4688  80.0%     -  294s
     0     0 34203.0105    0  464 19005.3297 34203.0105  80.0%     -  295s
     0     0 34200.7746    0  466 19005.3297 34200.7746  80.0%     -  296s
     0     0 33729.8797    0  417 19005.3297 33729.8797  77.5%     -  315s
H    0     0                    19097.414940 33729.7287  76.6%     -  316s
     0     0 33588.1955    0  436 19097.4149 33588.1955  75.9%     -  323s
     0     0 33494.3380    0  439 19097.4149 33494.3380  75.4%     -  329s
     0     0 33467.0924    0  432 19097.4149 33467.0924  75.2%     -  332s
     0     0 33450.2429    0  445 19097.4149 33450.2429  75.2%     -  336s
     0     0 33434.2593    0  487 19097.4149 33434.2593  75.1%     -  340s
     0     0 33426.1635    0  523 19097.4149 33426.1635  75.0%     -  343s
     0     0 33420.5359    0  485 19097.4149 33420.5359  75.0%     -  344s
     0     0 33416.7993    0  477 19097.4149 33416.7993  75.0%     -  346s
     0     0 33411.5450    0  426 19097.4149 33411.5450  75.0%     -  347s
     0     0 33410.3064    0  483 19097.4149 33410.3064  74.9%     -  348s
     0     0 33290.3793    0  432 19097.4149 33290.3793  74.3%     -  357s
H    0     0                    19578.839247 33288.6068  70.0%     -  357s
     0     0 33254.5660    0  442 19578.8392 33254.5660  69.8%     -  362s
     0     0 33245.5738    0  447 19578.8392 33245.5738  69.8%     -  364s
     0     0 33240.2205    0  447 19578.8392 33240.2205  69.8%     -  365s
     0     0 33236.9018    0  450 19578.8392 33236.9018  69.8%     -  366s
     0     0 33234.8813    0  448 19578.8392 33234.8813  69.7%     -  367s
     0     0 33152.6009    0  426 19578.8392 33152.6009  69.3%     -  375s
H    0     0                    19608.453200 33150.4774  69.1%     -  376s
     0     0 33140.6002    0  438 19608.4532 33140.6002  69.0%     -  379s
     0     0 33129.4872    0  500 19608.4532 33129.4872  69.0%     -  382s
     0     0 33118.9111    0  440 19608.4532 33118.9111  68.9%     -  385s
     0     0 33112.0091    0  488 19608.4532 33112.0091  68.9%     -  387s
     0     0 33106.2435    0  432 19608.4532 33106.2435  68.8%     -  389s
     0     0 33103.4468    0  447 19608.4532 33103.4468  68.8%     -  391s
     0     0 33091.8018    0  482 19608.4532 33091.8018  68.8%     -  396s
H    0     0                    19753.053038 33091.7800  67.5%     -  396s
     0     0 33085.2706    0  491 19753.0530 33085.2706  67.5%     -  398s
     0     0 33081.0529    0  438 19753.0530 33081.0529  67.5%     -  399s
     0     0 33078.5070    0  440 19753.0530 33078.5070  67.5%     -  400s
     0     0 33070.8395    0  435 19753.0530 33070.8395  67.4%     -  403s
     0     0 33068.7107    0  437 19753.0530 33068.7107  67.4%     -  405s
     0     0 33061.8195    0  472 19753.0530 33061.8195  67.4%     -  409s
     0     0 33056.2592    0  473 19753.0530 33056.2592  67.3%     -  411s
     0     0 33054.3373    0  429 19753.0530 33054.3373  67.3%     -  412s
     0     0 33051.1667    0  476 19753.0530 33051.1667  67.3%     -  415s
     0     0 33050.8284    0  476 19753.0530 33050.8284  67.3%     -  417s
H    0     0                    19869.038544 33050.8284  66.3%     -  442s
     0     2 33050.8284    0  476 19869.0385 33050.8284  66.3%     -  478s
     1     3 32698.1200    1  429 19869.0385 33050.8284  66.3%  9059  487s
     2     4 32774.6117    1  436 19869.0385 32774.6117  65.0%  6828  496s
     3     8 31910.2167    2  414 19869.0385 32772.2806  64.9%  8758  508s
     7    16 31824.3234    3  382 19869.0385 32664.2717  64.4%  7141  520s
    15    31 31319.4154    4  402 19869.0385 32617.6814  64.2%  8435  534s
    30    46 32082.5585    5  374 19869.0385 32617.0536  64.2% 10377  564s
    45    75 30670.2626    5  457 19869.0385 32242.2969  62.3% 11879  608s
H   48    75                    19904.690008 32242.2969  62.0% 11698  608s
H   61    75                    19984.856931 32242.2969  61.3% 10638  608s
H   66    75                    20014.188198 32242.2969  61.1% 10223  608s
    74   135 30414.0049    6  397 20014.1882 32242.2969  61.1% 10470  638s
   134   264 30277.8342    7  388 20014.1882 32242.2969  61.1%  8026  657s
H  218   264                    20052.101477 32242.2969  60.8%  5945  657s
H  250   264                    20052.180080 32242.2969  60.8%  5506  657s
H  253   264                    20052.576826 32242.2969  60.8%  5487  657s
   263   349 29830.2221   11  363 20052.5768 32242.2969  60.8%  5438  669s
   348   380 29713.3360   14  354 20052.5768 32242.2969  60.8%  4744  680s
   379   414 29573.6869   15  345 20052.5768 32242.2969  60.8%  4615  691s
   413   446 29555.8534   16  348 20052.5768 32242.2969  60.8%  4495  702s
   445   480 29395.8531   17  275 20052.5768 32242.2969  60.8%  4447  713s
   479   511 29290.2725   18  288 20052.5768 32242.2969  60.8%  4390  724s
   512   536 26147.9583   19  273 20052.5768 32242.2969  60.8%  4276  735s
   539   570 25605.7700   20  275 20052.5768 32242.2969  60.8%  4292  747s
   573   599 25279.6178   21  272 20052.5768 32242.2969  60.8%  4382  760s
   604   629 25181.9818   22  269 20052.5768 32242.2969  60.8%  4354  771s
   634   656 24740.3462   23  261 20052.5768 32242.2969  60.8%  4328  783s
   663   688 24677.0874   24  274 20052.5768 32242.2969  60.8%  4337  795s
   697   728 24627.3738   25  278 20052.5768 32242.2969  60.8%  4397  805s
   740   760 24601.2955   26  258 20052.5768 32242.2969  60.8%  4417  816s
   788   791 24580.9626   27  253 20052.5768 32242.2969  60.8%  4453  829s
   829   838 24396.6328   28  226 20052.5768 32242.2969  60.8%  4499  839s
   882   890 24342.2336   29  311 20052.5768 32242.2969  60.8%  4465  854s
   952   940 24325.0042   30  305 20052.5768 32242.2969  60.8%  4330  865s
  1025   964 23985.1743   31  205 20052.5768 32242.2969  60.8%  4229  881s
  1093   992 23336.6264   32  237 20052.5768 32210.6465  60.6%  4151  896s
  1157  1019     cutoff   33      20052.5768 32210.6465  60.6%  4193  911s
  1230  1029     cutoff   34      20052.5768 32210.6465  60.6%  4268  927s
  1294  1047 30888.7008   11  370 20052.5768 32210.6465  60.6%  4345  943s
  1341  1063 25625.9574    9  267 20052.5768 32210.6465  60.6%  4476  961s
  1379  1105 25973.6117   12  306 20052.5768 32210.6465  60.6%  4516  978s
  1437  1156 25314.8138   13  341 20052.5768 32210.6465  60.6%  4646  996s
  1518  1211 25096.0557   14  268 20052.5768 32167.0005  60.4%  4659 1013s
  1600  1266 25054.9483   15  337 20052.5768 32166.4780  60.4%  4737 1032s
  1671  1323 24698.0240   16  239 20052.5768 32166.4780  60.4%  4869 1053s
  1752  1407 24671.4521   17  243 20052.5768 32166.4780  60.4%  4964 1070s
  1844  1520 24539.8594   18  261 20052.5768 32166.4780  60.4%  5018 1092s
  1986  1643 24415.7146   19  263 20052.5768 32166.4780  60.4%  4952 1113s
  2139  1673 24042.3589   22  229 20052.5768 32166.4780  60.4%  4930 1130s
  2183  1718 23970.4486   23  219 20052.5768 32166.4780  60.4%  4941 1156s
  2230  1747 23915.0923   24  201 20052.5768 32166.4780  60.4%  4945 1175s
  2281  1788 23908.6648   25  204 20052.5768 32166.4780  60.4%  4939 1195s
  2326  1826 21383.9166   26  244 20052.5768 32166.4780  60.4%  4968 1212s
  2391  1862 20858.0127   27  181 20052.5768 32166.4780  60.4%  4970 1242s
  2451  1904     cutoff   28      20052.5768 31671.2747  57.9%  4967 1264s
  2513  1977 22871.6917   27  185 20052.5768 31671.2747  57.9%  4996 1286s
H 2620  1977                    20103.880865 31671.2747  57.5%  4930 1286s
  2627  2117 22819.3248   28  168 20103.8809 31671.2747  57.5%  4931 1312s
  2839  2264 22256.7593   35  144 20103.8809 31671.2747  57.5%  4914 1344s
  3108  2345 20309.5031   50   77 20103.8809 31671.2747  57.5%  4809 1375s
  3313  2463 21535.9410   38  131 20103.8809 31632.3259  57.3%  4785 1403s
  3535  2578 21029.7857   44  290 20103.8809 31632.3259  57.3%  4781 1434s
  3745  2673 25378.1079    9  242 20103.8809 31610.2479  57.2%  4797 1465s
  3933  2763 23160.1653   15  161 20103.8809 31610.2479  57.2%  4847 1496s
  4202  2839 22127.4417   20  237 20103.8809 31610.2479  57.2%  4847 1532s
  4401  2965 21416.9062   29  171 20103.8809 31404.0431  56.2%  4905 1570s
  4630  2966 20614.2277   30  476 20103.8809 31404.0431  56.2%  4918 1694s
  4632  2967 29076.7610   17  188 20103.8809 31404.0431  56.2%  4916 1705s
  4633  2968 20260.7182   47  335 20103.8809 31404.0431  56.2%  4915 1746s
  4634  2969 28841.9351   16  354 20103.8809 31404.0431  56.2%  4914 1774s
  4635  2969 21790.3692   50  452 20103.8809 31404.0431  56.2%  4913 1794s
  4636  2970 22856.2279   31  409 20103.8809 31404.0431  56.2%  4912 1809s
  4637  2971 23300.8311   17  474 20103.8809 31404.0431  56.2%  4911 1821s
  4638  2971 21121.9901   56  425 20103.8809 31404.0431  56.2%  4910 1831s
  4639  2972 22337.9496   53  490 20103.8809 31404.0431  56.2%  4909 1840s
  4640  2973 29079.1792   12  447 20103.8809 31404.0431  56.2%  4907 1845s
  4641  2973 29193.6780    9  434 20103.8809 31404.0431  56.2%  4906 1850s
  4643  2975 20993.3325   37  432 20103.8809 31404.0431  56.2%  4904 1859s
  4644  2975 21029.5233   45  496 20103.8809 31404.0431  56.2%  4903 1863s
  4645  2976 22436.9936   41  450 20103.8809 31404.0431  56.2%  4902 1866s
  4646  2977 29329.0769   15  494 20103.8809 31404.0431  56.2%  4901 1876s
  4647  2977 21290.7750   42  503 20103.8809 31404.0431  56.2%  4900 1881s
  4648  2978 22246.1843   28  458 20103.8809 31404.0431  56.2%  4899 1885s
  4649  2979 23660.7602   15  457 20103.8809 31404.0431  56.2%  4898 1894s
  4650  2979 27995.6266   23  495 20103.8809 31404.0431  56.2%  4897 1898s
  4651  2980 20952.6185   87  496 20103.8809 31404.0431  56.2%  4896 1903s
  4652  2981 21651.5065   19  459 20103.8809 31404.0431  56.2%  4895 1905s
  4654  2982 20692.9714   43  447 20103.8809 31404.0431  56.2%  4893 1918s
  4655  2983 30216.2704    7  447 20103.8809 31404.0431  56.2%  4892 1921s
  4657  2984 23541.3519   25  530 20103.8809 31404.0431  56.2%  4890 1934s
  4658  2985 27826.1203   35  444 20103.8809 31404.0431  56.2%  4888 1937s
  4659  2985 24510.3348   14  441 20103.8809 31404.0431  56.2%  4887 1944s
  4660  2986 21611.4965   49  445 20103.8809 31404.0431  56.2%  4886 1948s
  4661  2987 21159.9997   20  449 20103.8809 31404.0431  56.2%  4885 1954s
  4662  2987 20918.2413   33  452 20103.8809 31404.0431  56.2%  4884 1957s
  4663  2988 20631.7329   33  444 20103.8809 31404.0431  56.2%  4883 1962s
  4665  2989 28844.1387   23  443 20103.8809 31404.0431  56.2%  4881 1970s
  4667  2991 20631.7329   33  458 20103.8809 31404.0431  56.2%  4879 1977s
  4668  2991 20804.2786   39  458 20103.8809 31404.0431  56.2%  4878 1994s
  4669  2992 27890.2954   18  458 20103.8809 31404.0431  56.2%  4877 2034s
  4670  2995 31404.0431   16  484 20103.8809 31404.0431  56.2%  4935 2054s
  4671  2997 31404.0431   17  382 20103.8809 31404.0431  56.2%  4936 2075s
  4674  3002 31225.7269   18  384 20103.8809 31404.0431  56.2%  4936 2108s
  4680  3012 30653.5941   19  361 20103.8809 31404.0431  56.2%  4945 2136s
  4692  3020 30608.8297   20  287 20103.8809 31404.0431  56.2%  4972 2187s
  4704  3048 29438.3274   20  424 20103.8809 31404.0431  56.2%  5003 2254s
  4705  3048 29897.6275   21  293 20103.8809 31404.0431  56.2%  5004 2255s
  4736  3159 28836.3357   21  399 20103.8809 31404.0431  56.2%  5103 2290s
  4859  3173 27815.3445   24  215 20103.8809 31404.0431  56.2%  5133 2309s
  4918  3184 28507.8666   22  390 20103.8809 31404.0431  56.2%  5148 2328s
  4968  3193 23072.5032   23  357 20103.8809 31404.0431  56.2%  5179 2344s
  5002  3215 27697.4188   25  339 20103.8809 31404.0431  56.2%  5211 2362s
  5050  3219 22982.6726   26  291 20103.8809 31404.0431  56.2%  5233 2377s
  5077  3218 22679.5353   25  336 20103.8809 31404.0431  56.2%  5253 2393s
  5127  3217 22704.0744   27  285 20103.8809 31404.0431  56.2%  5267 2416s
  5191  3211 21370.4268   29  273 20103.8809 31404.0431  56.2%  5288 2433s
  5243  3222     cutoff   30      20103.8809 31404.0431  56.2%  5320 2458s
  5304  3242 20870.6567   31  203 20103.8809 31404.0431  56.2%  5323 2478s
  5366  3247 20494.5445   32  147 20103.8809 31312.1557  55.8%  5335 2495s
  5438  3251 22547.8479   30  256 20103.8809 30890.9744  53.7%  5329 2522s
  5493  3242 21760.9134   31  217 20103.8809 30890.9744  53.7%  5329 2538s
  5555  3240     cutoff   32      20103.8809 30890.9744  53.7%  5345 2554s
  5616  3245 23442.9507   29  286 20103.8809 30673.8128  52.6%  5348 2572s
  5678  3241     cutoff   31      20103.8809 30673.8128  52.6%  5350 2593s
  5758  3229     cutoff   32      20103.8809 30292.4640  50.7%  5347 2619s
  5824  3226 27068.7415   24  417 20103.8809 30292.4640  50.7%  5374 2638s
  5893  3221 23001.4535   25  280 20103.8809 30292.4640  50.7%  5388 2658s
  5961  3223 26490.0302   25  342 20103.8809 30292.4640  50.7%  5399 2688s
  6030  3237 25387.1997   26  340 20103.8809 30292.4640  50.7%  5407 2712s
  6110  3249 21818.4594   28  317 20103.8809 29926.1191  48.9%  5429 2736s
  6196  3261 20674.8446   32  227 20103.8809 29926.1191  48.9%  5464 2758s
  6296  3262     cutoff   38      20103.8809 29926.1191  48.9%  5479 2792s
  6389  3236 21955.7901   27  294 20103.8809 29807.7693  48.3%  5502 2815s
  6467  3233 20223.6142   28  212 20103.8809 29807.7693  48.3%  5519 2839s
  6556  3217 21381.5916   32  171 20103.8809 29499.3121  46.7%  5523 2872s
  6655  3226 infeasible   35      20103.8809 29499.3121  46.7%  5538 2901s
  6775  3236 20475.5374   24  296 20103.8809 29499.3121  46.7%  5571 2931s
  6911  3215 23003.2196   23  273 20103.8809 29499.3121  46.7%  5581 2968s
  7050  3201 20899.4810   25  264 20103.8809 29499.3121  46.7%  5597 3002s
  7179  3185 20714.7200   27  270 20103.8809 29499.3121  46.7%  5620 3032s
  7325  3169 26041.9947   23  291 20103.8809 28602.2525  42.3%  5647 3072s
  7461  3149 22045.7908   24  241 20103.8809 28170.5462  40.1%  5669 3102s
  7551  3166     cutoff   25      20103.8809 28128.6659  39.9%  5695 3142s
  7697  3176     cutoff   25      20103.8809 28128.6659  39.9%  5707 3178s
  7912  3150 21732.8443   27  182 20103.8809 28072.6684  39.6%  5683 3217s
  8120  3164 20421.5253   39  108 20103.8809 28072.6684  39.6%  5678 3256s
  8323  3136 24406.7384   23  302 20103.8809 28072.6684  39.6%  5677 3303s
  8589  3111 20482.5809   25  242 20103.8809 27481.7246  36.7%  5635 3345s
  8790  3113 21663.9022   26  184 20103.8809 27456.8113  36.6%  5617 3408s
  9032  3078     cutoff   27      20103.8809 27079.0020  34.7%  5603 3455s
  9294  3058     cutoff   32      20103.8809 26794.3279  33.3%  5585 3509s
  9553  3023     cutoff   36      20103.8809 26588.5297  32.3%  5582 3557s
  9791  3052     cutoff   29      20103.8809 26484.2014  31.7%  5599 3600s

Cutting planes:
  Gomory: 20
  Implied bound: 20
  Projected implied bound: 113
  MIR: 1164
  Mixing: 8
  Flow cover: 2423
  RLT: 30
  Relax-and-lift: 240

Explored 10009 nodes (56327397 simplex iterations) in 3600.07 seconds (10159.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20103.9 20052.6 20014.2 ... 19097.4

Time limit reached
Best objective 2.010388086457e+04, best bound 2.648420139053e+04, gap 31.7368%
  WARNING: Time limit reached. Using best solution found (gap: 31.74%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 20103.88, θ = 171661.29
  Upper Bound (UB) = 20103.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171661.29
  [DEBUG]   ✓ Scenario 0: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 171661.29 ≤ Q = 171661.29 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4c667b13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb39984ed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.282033e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6945031.1932
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.533705e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153370.49    0  133 6945031.19 -153370.49   102%     -    0s
H    0     0                    -118567.0065 -153370.49  29.4%     -    0s
H    0     0                    -120012.4928 -153370.49  27.8%     -    0s
H    0     0                    -121566.1916 -131976.77  8.56%     -    0s
H    0     0                    -126066.1530 -131976.77  4.69%     -    0s
     0     0 -131976.77    0  114 -126066.15 -131976.77  4.69%     -    0s
H    0     0                    -129237.6724 -131974.72  2.12%     -    0s
H    0     0                    -129480.9397 -131905.08  1.87%     -    0s
     0     0 -131884.73    0  113 -129480.94 -131884.73  1.86%     -    0s
     0     0 -131884.73    0  104 -129480.94 -131884.73  1.86%     -    0s
     0     0 -130836.85    0   77 -129480.94 -130836.85  1.05%     -    0s
H    0     0                    -129647.2099 -130805.86  0.89%     -    0s
     0     0 -130805.86    0   64 -129647.21 -130805.86  0.89%     -    0s
H    0     0                    -129834.3920 -130805.86  0.75%     -    0s
     0     0 -130798.00    0   63 -129834.39 -130798.00  0.74%     -    0s
     0     0 -130793.30    0   62 -129834.39 -130793.30  0.74%     -    0s
     0     0 -130790.92    0   56 -129834.39 -130790.92  0.74%     -    0s
     0     0 -130788.45    0   57 -129834.39 -130788.45  0.73%     -    0s
     0     0 -130788.28    0   57 -129834.39 -130788.28  0.73%     -    0s
     0     2 -130788.28    0   57 -129834.39 -130788.28  0.73%     -    0s
H   34    25                    -130314.0513 -130500.09  0.14%  11.1    0s

Cutting planes:
  Gomory: 20
  Implied bound: 3
  MIR: 157
  Flow cover: 13
  RLT: 25

Explored 81 nodes (1113 simplex iterations) in 0.08 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130314 -129834 -129481 ... 1.28203e+13
No other solutions better than -130314

Optimal solution found (tolerance 1.00e-06)
Best objective -1.303140512710e+05, best bound -1.303140512710e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 159558.34
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130314.05
  [DEBUG]   S×d_nominal = 289872.39
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 289872.39 + -130314.05 = 159558.34
  [DEBUG]   Current θ from Master = 171661.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12102.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8000.93
  Lower Bound (LB) = 11103.99
  Gap (UB-LB) = 8999.8910, Absolute Gap = 8999.8910, Relative Gap = 0.447669
  Not converged yet (gap = 8999.89 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438069 nonzeros
Model fingerprint: 0x8013b609
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 62620 rows and 25420 columns
Presolve time: 1.30s
Presolved: 91663 rows, 39240 columns, 556559 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -358681.9240
Found heuristic solution: objective -222897.6514

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.989e+06
 Factor NZ  : 8.640e+06 (roughly 120 MB of memory)
 Factor Ops : 1.489e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.54795846e+07  1.63991172e+08  9.94e+04 2.06e+01  7.44e+04     2s
   1  -1.15138399e+07  1.43649286e+08  6.74e+04 7.88e+01  4.96e+04     2s
   2  -4.66825255e+06  1.09853356e+08  2.65e+04 2.70e+00  2.00e+04     2s
   3  -7.71589485e+05  8.21795832e+07  9.00e+02 1.73e+00  1.16e+03     3s
   4  -5.14950390e+05  3.11291979e+07  3.01e+02 4.16e-01  3.80e+02     3s
   5  -3.90812895e+05  2.26002885e+07  1.21e+02 2.77e-01  2.08e+02     3s
   6  -2.50886274e+05  1.60670282e+07  3.38e+01 1.83e-01  1.14e+02     3s
   7  -1.32436281e+05  1.14772617e+07  1.07e+01 1.25e-01  7.34e+01     3s
   8  -9.48879710e+04  6.29633016e+06  6.44e+00 6.56e-02  3.96e+01     3s
   9  -8.08416983e+04  4.74071408e+06  4.13e+00 4.89e-02  2.95e+01     3s
  10  -4.13445771e+04  8.19921921e+05  1.60e+00 7.41e-03  5.20e+00     3s
  11  -1.09740795e+04  3.94684741e+05  9.11e-01 3.37e-03  2.44e+00     3s
  12   2.70727746e+03  2.00993992e+05  5.20e-01 1.73e-03  1.19e+00     3s
  13   1.18512616e+04  1.38876409e+05  3.72e-01 2.81e-03  7.59e-01     3s
  14   1.86655052e+04  1.21916464e+05  2.91e-01 1.56e-03  6.17e-01     3s
  15   2.31837040e+04  1.02575788e+05  2.43e-01 1.26e-03  4.74e-01     3s
  16   2.89521745e+04  8.65909146e+04  1.87e-01 1.17e-03  3.44e-01     3s
  17   3.40749274e+04  7.62605772e+04  1.36e-01 1.30e-03  2.52e-01     3s
  18   3.67118477e+04  7.30262603e+04  1.14e-01 1.11e-03  2.17e-01     3s
  19   3.98522383e+04  6.86632747e+04  8.69e-02 1.04e-03  1.72e-01     3s
  20   4.23577735e+04  6.64604595e+04  6.81e-02 1.05e-03  1.44e-01     3s
  21   4.41185641e+04  6.23170620e+04  5.49e-02 1.32e-03  1.09e-01     3s
  22   4.61644924e+04  6.04716343e+04  4.01e-02 1.20e-03  8.53e-02     3s
  23   4.71778413e+04  5.87385902e+04  3.33e-02 1.48e-03  6.89e-02     3s
  24   4.85537927e+04  5.68143312e+04  2.43e-02 1.72e-03  4.92e-02     3s
  25   4.95224525e+04  5.57057690e+04  1.82e-02 1.16e-03  3.69e-02     3s
  26   5.04798588e+04  5.47059070e+04  1.24e-02 7.56e-04  2.52e-02     3s
  27   5.11133751e+04  5.44188350e+04  8.62e-03 6.49e-04  1.97e-02     3s
  28   5.13822901e+04  5.38309064e+04  7.09e-03 4.31e-04  1.46e-02     3s
  29   5.16919210e+04  5.34951600e+04  5.30e-03 2.87e-04  1.07e-02     3s
  30   5.20030879e+04  5.33221378e+04  3.55e-03 2.24e-04  7.86e-03     4s
  31   5.21922378e+04  5.30960869e+04  2.52e-03 2.10e-04  5.39e-03     4s
  32   5.22972462e+04  5.30013049e+04  1.96e-03 1.62e-04  4.20e-03     4s
  33   5.24679090e+04  5.29002914e+04  1.08e-03 1.03e-04  2.58e-03     4s
  34   5.25438716e+04  5.28210911e+04  7.01e-04 7.25e-05  1.65e-03     4s
  35   5.25927651e+04  5.27816839e+04  4.62e-04 5.00e-05  1.13e-03     4s
  36   5.26276873e+04  5.27716826e+04  2.94e-04 4.43e-05  8.58e-04     4s
  37   5.26508345e+04  5.27389738e+04  1.87e-04 2.56e-05  5.25e-04     4s
  38   5.26767323e+04  5.27061978e+04  7.08e-05 7.24e-06  1.76e-04     4s
  39   5.26859918e+04  5.26969658e+04  3.33e-05 1.40e-06  6.54e-05     4s
  40   5.26936368e+04  5.26950482e+04  2.14e-06 3.71e-07  8.40e-06     4s
  41   5.26943147e+04  5.26944349e+04  4.22e-08 5.17e-08  7.14e-07     4s
  42   5.26943313e+04  5.26943352e+04  3.51e-09 7.62e-09  2.31e-08     4s
  43   5.26943325e+04  5.26943328e+04  1.01e-07 4.38e-09  1.58e-09     4s

Barrier solved model in 43 iterations and 4.11 seconds (7.40 work units)
Optimal objective 5.26943325e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 8s

   13487 PPushes remaining with PInf 7.2895532e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2076899e+03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49822    5.2694333e+04   0.000000e+00   3.207690e+03      9s
   50198    5.2694333e+04   0.000000e+00   0.000000e+00     10s
   50198    5.2694333e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 2.30s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.269433e+04, 50198 iterations, 10.11 seconds (20.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52694.3327    0  353 -222897.65 52694.3327   124%     -   12s
H    0     0                    -217143.1315 52694.3327   124%     -   12s
H    0     0                    -159665.3288 52694.3327   133%     -   12s
H    0     0                    -159651.0762 52694.3327   133%     -   13s
H    0     0                    -77528.67451 52694.3327   168%     -   13s
H    0     0                    -77052.31196 52694.3327   168%     -   13s
H    0     0                    -75537.40671 52694.3327   170%     -   13s
H    0     0                    -75476.63246 52694.3327   170%     -   13s
H    0     0                    -70139.62589 52694.3327   175%     -   13s
H    0     0                    -69984.56492 52694.3327   175%     -   13s
H    0     0                    -69589.96543 52694.3327   176%     -   13s
H    0     0                    -35904.40049 52694.3327   247%     -   14s
H    0     0                    -8149.926266 52694.3327   747%     -   14s
H    0     0                    -4959.598538 52694.3327  1162%     -   14s
H    0     0                    -4333.668889 52694.3327  1316%     -   14s
     0     0 46133.7968    0  401 -4333.6689 46133.7968  1165%     -   59s
H    0     0                    -4236.197703 46133.7968  1189%     -   60s
H    0     0                    -4232.106953 46133.7968  1190%     -   60s
     0     0 45432.9380    0  409 -4232.1070 45432.9380  1174%     -   84s
     0     0 45260.4713    0  394 -4232.1070 45260.4713  1169%     -   93s
     0     0 45180.3060    0  417 -4232.1070 45180.3060  1168%     -   99s
     0     0 45082.1085    0  390 -4232.1070 45082.1085  1165%     -  102s
     0     0 44972.8217    0  405 -4232.1070 44972.8217  1163%     -  112s
H    0     0                    3311.7441631 44972.8217  1258%     -  118s
H    0     0                    4668.7542548 44972.8217   863%     -  118s
H    0     0                    4703.7238208 44972.8217   856%     -  118s
H    0     0                    4805.5239121 44972.8217   836%     -  118s
H    0     0                    10740.529722 44972.8217   319%     -  118s
H    0     0                    10787.547054 44972.8217   317%     -  118s
H    0     0                    10915.577538 44972.8217   312%     -  118s
H    0     0                    10939.658665 44972.8217   311%     -  118s
     0     0 44921.5508    0  414 10939.6587 44921.5508   311%     -  120s
     0     0 44921.5508    0  414 10939.6587 44921.5508   311%     -  122s
     0     0 44921.5508    0  463 10939.6587 44921.5508   311%     -  127s
H    0     0                    11091.466353 44921.5508   305%     -  132s
H    0     0                    11092.349079 44921.5508   305%     -  132s
H    0     0                    11112.196481 44921.5508   304%     -  132s
H    0     0                    11116.388034 44921.5508   304%     -  132s
H    0     0                    11133.048654 44921.5508   303%     -  132s
     0     0 44921.5508    0  421 11133.0487 44921.5508   303%     -  132s
     0     0 44921.5508    0  410 11133.0487 44921.5508   303%     -  133s
     0     0 44921.5508    0  403 11133.0487 44921.5508   303%     -  134s
     0     0 44921.5508    0  409 11133.0487 44921.5508   303%     -  134s
     0     0 41203.7731    0  395 11133.0487 41203.7731   270%     -  184s
H    0     0                    11214.141799 41203.7652   267%     -  185s
     0     0 39933.4400    0  454 11214.1418 39933.4400   256%     -  222s
     0     0 39387.9680    0  470 11214.1418 39387.9680   251%     -  251s
H    0     0                    11253.791041 39193.6135   248%     -  269s
H    0     0                    11282.041068 39193.6135   247%     -  269s
H    0     0                    11297.504679 39193.6135   247%     -  269s
     0     0 39193.6135    0  489 11297.5047 39193.6135   247%     -  269s
     0     0 39149.8261    0  456 11297.5047 39149.8261   247%     -  278s
     0     0 39121.2752    0  492 11297.5047 39121.2752   246%     -  286s
     0     0 39113.1398    0  508 11297.5047 39113.1398   246%     -  290s
     0     0 39109.5523    0  501 11297.5047 39109.5523   246%     -  293s
     0     0 39105.9877    0  458 11297.5047 39105.9877   246%     -  295s
     0     0 39096.1264    0  504 11297.5047 39096.1264   246%     -  298s
     0     0 39093.9873    0  502 11297.5047 39093.9873   246%     -  300s
     0     0 39085.6805    0  506 11297.5047 39085.6805   246%     -  301s
     0     0 39085.4552    0  504 11297.5047 39085.4552   246%     -  302s
H    0     0                    15001.118216 39085.4552   161%     -  319s
H    0     0                    15380.183769 39085.4552   154%     -  319s
H    0     0                    15948.737881 39085.4552   145%     -  319s
H    0     0                    16198.347728 39085.4552   141%     -  319s
H    0     0                    16436.920427 39085.4552   138%     -  319s
H    0     0                    16439.107995 39085.4552   138%     -  319s
H    0     0                    16630.667078 36181.3259   118%     -  385s
H    0     0                    16799.487353 36181.3259   115%     -  385s
H    0     0                    16817.278145 36181.3259   115%     -  385s
H    0     0                    16928.757999 36181.3259   114%     -  385s
H    0     0                    17047.250784 36181.3259   112%     -  385s
H    0     0                    17128.587857 36181.3259   111%     -  385s
H    0     0                    17331.751937 36181.3259   109%     -  385s
H    0     0                    17660.395042 36181.3259   105%     -  385s
H    0     0                    17660.845238 36181.3259   105%     -  385s
H    0     0                    17713.007559 36181.3259   104%     -  385s
H    0     0                    17729.811710 36181.3259   104%     -  385s
H    0     0                    17745.759282 36181.3259   104%     -  385s
H    0     0                    17755.691129 36181.3259   104%     -  385s
H    0     0                    17789.831726 36181.3259   103%     -  385s
     0     0 36181.3259    0  464 17789.8317 36181.3259   103%     -  385s
H    0     0                    17883.679606 36181.3195   102%     -  385s
H    0     0                    18001.127192 36181.3195   101%     -  385s
H    0     0                    18086.065672 36181.3195   100%     -  385s
H    0     0                    19010.454136 36181.3195  90.3%     -  385s
     0     0 35468.4317    0  421 19010.4541 35468.4317  86.6%     -  424s
     0     0 35232.1177    0  460 19010.4541 35232.1177  85.3%     -  445s
     0     0 35087.9004    0  459 19010.4541 35087.9004  84.6%     -  459s
     0     0 34984.2609    0  468 19010.4541 34984.2609  84.0%     -  470s
H    0     0                    20107.891648 34923.7817  73.7%     -  479s
H    0     0                    20132.231414 34923.7817  73.5%     -  479s
H    0     0                    20184.417863 34923.7817  73.0%     -  479s
     0     0 34923.7817    0  460 20184.4179 34923.7817  73.0%     -  479s
     0     0 34897.3545    0  463 20184.4179 34897.3545  72.9%     -  485s
     0     0 34851.8662    0  467 20184.4179 34851.8662  72.7%     -  493s
     0     0 34834.5410    0  465 20184.4179 34834.5410  72.6%     -  500s
     0     0 34802.2563    0  468 20184.4179 34802.2563  72.4%     -  505s
     0     0 34791.5917    0  449 20184.4179 34791.5917  72.4%     -  509s
     0     0 34789.3551    0  448 20184.4179 34789.3551  72.4%     -  510s
     0     0 33700.3689    0  456 20184.4179 33700.3689  67.0%     -  558s
     0     0 33452.9056    0  468 20184.4179 33452.9056  65.7%     -  580s
     0     0 33298.3995    0  495 20184.4179 33298.3995  65.0%     -  594s
     0     0 33274.4571    0  487 20184.4179 33274.4571  64.9%     -  599s
     0     0 33263.0277    0  497 20184.4179 33263.0277  64.8%     -  602s
     0     0 33210.1497    0  492 20184.4179 33210.1497  64.5%     -  609s
     0     0 33194.9512    0  492 20184.4179 33194.9512  64.5%     -  611s
     0     0 33186.1158    0  490 20184.4179 33186.1158  64.4%     -  613s
     0     0 33173.2775    0  489 20184.4179 33173.2775  64.4%     -  616s
     0     0 33160.1454    0  487 20184.4179 33160.1454  64.3%     -  618s
     0     0 33153.1767    0  489 20184.4179 33153.1767  64.3%     -  619s
     0     0 33150.4710    0  492 20184.4179 33150.4710  64.2%     -  620s
     0     0 32954.7928    0  438 20184.4179 32954.7928  63.3%     -  636s
H    0     0                    20250.457052 32954.4466  62.7%     -  636s
H    0     0                    20482.190574 32954.4466  60.9%     -  636s
     0     0 32907.0368    0  432 20482.1906 32907.0368  60.7%     -  644s
     0     0 32878.8459    0  473 20482.1906 32878.8459  60.5%     -  648s
     0     0 32866.3865    0  464 20482.1906 32866.3865  60.5%     -  651s
     0     0 32864.4457    0  436 20482.1906 32864.4457  60.5%     -  652s
     0     0 32804.9276    0  445 20482.1906 32804.9276  60.2%     -  660s
     0     0 32794.4652    0  563 20482.1906 32794.4652  60.1%     -  666s
     0     0 32777.7319    0  557 20482.1906 32777.7319  60.0%     -  672s
     0     0 32773.4637    0  505 20482.1906 32773.4637  60.0%     -  675s
     0     0 32772.3451    0  507 20482.1906 32772.3451  60.0%     -  676s
     0     0 32758.2302    0  461 20482.1906 32758.2302  59.9%     -  682s
     0     0 32755.4902    0  444 20482.1906 32755.4902  59.9%     -  685s
     0     0 32743.0304    0  489 20482.1906 32743.0304  59.9%     -  689s
     0     0 32741.7530    0  494 20482.1906 32741.7530  59.9%     -  693s
     0     0 32739.1692    0  452 20482.1906 32739.1692  59.8%     -  696s
     0     0 32738.3952    0  482 20482.1906 32738.3952  59.8%     -  698s
     0     0 32738.1762    0  446 20482.1906 32738.1762  59.8%     -  700s
     0     0 32737.9665    0  446 20482.1906 32737.9665  59.8%     -  703s
H    0     0                    20585.793499 32737.9410  59.0%     -  782s
H    0     0                    20618.203943 32737.9410  58.8%     -  784s
H    0     0                    20654.988813 32737.9410  58.5%     -  787s
H    0     2                    20705.096616 32737.9410  58.1%     -  828s
     0     2 32737.9410    0  446 20705.0966 32737.9410  58.1%     -  828s
     1     4 32631.7987    1  443 20705.0966 32737.1528  58.1%  9953  841s
     3     8 32358.2027    2  441 20705.0966 32626.3621  57.6% 10727  857s
     7    15 31830.0287    3  444 20705.0966 32357.7090  56.3% 11796  890s
    14    30 31772.7524    4  455 20705.0966 32323.2876  56.1% 13020  912s
    29    45 31713.6781    5  422 20705.0966 31921.3517  54.2% 16674 1148s
    44    77 28714.9661    6  327 20705.0966 31921.3517  54.2% 19617 1216s
    76   198 28694.3090    7  317 20705.0966 31809.7546  53.6% 17211 1272s
   197   230 28317.9551   12  300 20705.0966 31809.7546  53.6%  9574 1285s
   229   270 28204.8913   13  281 20705.0966 31809.7546  53.6%  9010 1302s
   269   306 28191.8870   14  289 20705.0966 31809.7546  53.6%  8493 1321s
   311   359 26827.5984   16  256 20705.0966 31809.7546  53.6%  8151 1343s
   368   430 26552.7410   20  276 20705.0966 31809.7546  53.6%  7924 1363s
   439   462 26357.5915   25  323 20705.0966 31809.7546  53.6%  7592 1378s
   471   514 26220.9186   26  282 20705.0966 31809.7546  53.6%  7693 1395s
   523   575 26219.5293   27  286 20705.0966 31809.7546  53.6%  7446 1411s
   584   635 26184.4971   28  285 20705.0966 31809.7546  53.6%  7177 1426s
   646   693 26024.7703   29  166 20705.0966 31809.7546  53.6%  7050 1441s
   714   721 25995.9670   30  291 20705.0966 31809.7546  53.6%  6912 1458s
   774   762 25635.3641   31  301 20705.0966 31809.7546  53.6%  6697 1475s
   829   804 25492.9787   32  234 20705.0966 31809.7546  53.6%  6569 1489s
   885   857 25272.3251   33  219 20705.0966 31809.7546  53.6%  6531 1506s
   952   893 25253.3125   34  134 20705.0966 31809.7546  53.6%  6459 1523s
  1030   942 25230.1258   35  127 20705.0966 31809.7546  53.6%  6359 1541s
  1109  1018 24999.8242   38  111 20705.0966 31809.7546  53.6%  6289 1560s
  1193  1097 24411.1629   45   81 20705.0966 31809.7546  53.6%  6274 1577s
  1298  1119 24113.1628   53   74 20705.0966 31809.7546  53.6%  6118 1598s
  1403  1134 24154.3254   24  142 20705.0966 31809.7546  53.6%  5961 1618s
  1489  1160     cutoff   26      20705.0966 31809.7546  53.6%  5952 1641s
  1555  1193 30381.8694   10  352 20705.0966 31809.7546  53.6%  6034 1665s
  1624  1239 25916.0304   10  373 20705.0966 31809.7546  53.6%  6140 1688s
  1706  1283 25679.3873   11  300 20705.0966 31809.7546  53.6%  6209 1714s
  1788  1341 25378.7750   11  250 20705.0966 31809.7546  53.6%  6268 1736s
  1898  1391 25076.6399   12  325 20705.0966 31809.7546  53.6%  6267 1763s
  2010  1436 25080.9080   12  257 20705.0966 31809.7546  53.6%  6254 1790s
  2116  1479 23862.7566   14  249 20705.0966 31809.7546  53.6%  6305 1819s
  2213  1514     cutoff   15      20705.0966 31772.6330  53.5%  6366 1851s
  2314  1541 22065.1922   23  229 20705.0966 31772.6330  53.5%  6433 1882s
  2401  1570 21200.7014   26  318 20705.0966 31772.6330  53.5%  6500 1913s
  2504  1634 24070.6635    9  345 20705.0966 31772.6330  53.5%  6585 1945s
  2642  1695 23851.0082   10  330 20705.0966 31772.6330  53.5%  6591 1980s
  2763  1756 22356.0966   12  138 20705.0966 31772.6330  53.5%  6604 2014s
  2888  1821 21276.2629   28   71 20705.0966 31772.6330  53.5%  6662 2053s
  3020  1862 26313.9317   15  365 20705.0966 31772.6330  53.5%  6751 2094s
  3137  1899 26152.1543   16  340 20705.0966 31772.6330  53.5%  6833 2136s
  3281  1942 22846.9885   17  337 20705.0966 31772.6330  53.5%  6869 2178s
  3398  1959     cutoff   18      20705.0966 31395.6925  51.6%  6959 2212s
  3445  1995 23521.7098   17  530 20705.0966 31394.5137  51.6%  7083 2255s
  3501  2033 22788.1049   18  532 20705.0966 31394.5137  51.6%  7186 2301s
  3598  2061 20919.6545   19  529 20705.0966 31394.5137  51.6%  7267 2349s
  3706  2120     cutoff   20      20705.0966 31394.5137  51.6%  7300 2394s
  3811  2158 21103.8605   20  433 20705.0966 31394.5137  51.6%  7420 2441s
  3967  2221 20942.3907   21  357 20705.0966 30464.9344  47.1%  7435 2491s
  4112  2280 27573.7828   19  261 20705.0966 30423.9517  46.9%  7504 2541s
  4251  2372 23453.0251   21  220 20705.0966 30423.9517  46.9%  7619 2596s
  4437  2411     cutoff   24      20705.0966 30308.6232  46.4%  7699 2648s
  4573  2469 22763.7853   13  345 20705.0966 30308.6232  46.4%  7726 2707s
  4765  2558 23381.3376   15  249 20705.0966 30171.3118  45.7%  7777 2775s
  4970  2656     cutoff   19      20705.0966 30129.7788  45.5%  7844 2836s
  5207  2657 24792.0874   23  446 20705.0966 30129.6859  45.5%  7895 2947s
  5209  2658 22561.0767   20  218 20705.0966 30129.6859  45.5%  7891 2958s
  5210  2659 21569.8528   23  358 20705.0966 30129.6859  45.5%  7890 3018s
  5211  2660 22051.8490   14  408 20705.0966 30129.6859  45.5%  7888 3074s
  5212  2660 23824.9467   29  414 20705.0966 30129.6859  45.5%  7887 3115s
  5213  2661 24376.8724   16  424 20705.0966 30129.6859  45.5%  7885 3135s
  5214  2662 28048.2620   19  443 20705.0966 30129.6859  45.5%  7884 3153s
  5215  2662 23628.4578   20  464 20705.0966 30129.6859  45.5%  7882 3167s
  5216  2663 21479.8934   29  464 20705.0966 30129.6859  45.5%  7881 3185s
  5217  2664 24091.1532   10  415 20705.0966 30129.6859  45.5%  7879 3194s
  5218  2664 26458.6600   22  424 20705.0966 30129.6859  45.5%  7878 3203s
  5219  2665 24025.1367   22  415 20705.0966 30129.6859  45.5%  7876 3213s
  5220  2666 28326.5618   16  450 20705.0966 30129.6859  45.5%  7875 3223s
  5221  2666 25053.1040   24  463 20705.0966 30129.6859  45.5%  7873 3232s
  5222  2667 21836.1999   34  437 20705.0966 30129.6859  45.5%  7872 3239s
  5223  2668 21083.2010   25  436 20705.0966 30129.6859  45.5%  7870 3243s
  5224  2668 27127.3631   13  422 20705.0966 30129.6859  45.5%  7869 3248s
  5225  2669 24203.2540   16  466 20705.0966 30129.6859  45.5%  7867 3254s
  5226  2670 24272.2863   15  470 20705.0966 30129.6859  45.5%  7866 3259s
  5227  2670 23674.2931   26  414 20705.0966 30129.6859  45.5%  7864 3272s
  5228  2671 21882.4879   39  414 20705.0966 30129.6859  45.5%  7863 3280s
  5229  2672 22771.0142   23  408 20705.0966 30129.6859  45.5%  7861 3285s
  5230  2672 23655.4423   13  414 20705.0966 30129.6859  45.5%  7860 3295s
  5232  2674 23913.0466   14  430 20705.0966 30129.6859  45.5%  7857 3306s
  5233  2674 29314.2125   26  392 20705.0966 30129.6859  45.5%  7855 3311s
  5234  2675 28100.4085   15  430 20705.0966 30129.6859  45.5%  7854 3317s
  5235  2676 24048.8094   20  443 20705.0966 30129.6859  45.5%  7852 3322s
  5236  2676 24182.6986   52  439 20705.0966 30129.6859  45.5%  7851 3328s
  5237  2677 20953.9108   16  439 20705.0966 30129.6859  45.5%  7849 3330s
  5238  2678 21305.6099   29  395 20705.0966 30129.6859  45.5%  7848 3339s
  5239  2678 25137.7112   28  437 20705.0966 30129.6859  45.5%  7846 3345s
  5240  2679 26047.0794   12  435 20705.0966 30129.6859  45.5%  7845 3352s
  5241  2680 24114.4230   53  435 20705.0966 30129.6859  45.5%  7843 3369s
  5242  2680 23331.6393   12  435 20705.0966 30129.6859  45.5%  7842 3429s
  5243  2684 30129.6859   13  433 20705.0966 30129.6859  45.5%  7905 3468s
  5245  2687 30129.6859   14  408 20705.0966 30129.6859  45.5%  7904 3508s
  5249  2694 30129.6859   15  393 20705.0966 30129.6859  45.5%  7908 3537s
  5257  2707 30129.6859   16  439 20705.0966 30129.6859  45.5%  7917 3585s

Cutting planes:
  Learned: 2
  Gomory: 11
  Implied bound: 30
  Projected implied bound: 169
  MIR: 1161
  Mixing: 6
  Flow cover: 1290
  RLT: 71
  Relax-and-lift: 406

Explored 5273 nodes (42548362 simplex iterations) in 3600.06 seconds (9137.47 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20705.1 20655 20618.2 ... 19010.5

Time limit reached
Best objective 2.070509661586e+04, best bound 3.012968585225e+04, gap 45.5182%
  WARNING: Time limit reached. Using best solution found (gap: 45.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 20705.10, θ = 173580.63
  Upper Bound (UB) = 20705.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173580.63
  [DEBUG]   ✓ Scenario 0: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173580.63 ≤ Q = 173580.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173580.63 ≤ Q = 173580.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173580.63 ≤ Q = 173580.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2876ede0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd7891220
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.257071e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6847660.0824
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.428767e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142876.74    0  122 6847660.08 -142876.74   102%     -    0s
H    0     0                    -106491.9039 -142876.74  34.2%     -    0s
H    0     0                    -108048.1471 -142876.74  32.2%     -    0s
     0     0 -122284.98    0  134 -108048.15 -122284.98  13.2%     -    0s
H    0     0                    -117044.5534 -122235.22  4.43%     -    0s
     0     0 -121115.83    0  129 -117044.55 -121115.83  3.48%     -    0s
H    0     0                    -119034.9775 -121111.46  1.74%     -    0s
     0     0 -121058.34    0  129 -119034.98 -121058.34  1.70%     -    0s
H    0     0                    -119052.0581 -121058.34  1.69%     -    0s
     0     0 -120432.43    0  110 -119052.06 -120432.43  1.16%     -    0s
     0     0 -120405.50    0  120 -119052.06 -120405.50  1.14%     -    0s
     0     0 -120249.73    0   97 -119052.06 -120249.73  1.01%     -    0s
H    0     0                    -119056.4805 -120228.87  0.98%     -    0s
     0     0 -120228.87    0  103 -119056.48 -120228.87  0.98%     -    0s
     0     0 -120124.83    0   95 -119056.48 -120124.83  0.90%     -    0s
     0     0 -120111.56    0   95 -119056.48 -120111.56  0.89%     -    0s
     0     2 -120110.80    0   95 -119056.48 -120110.80  0.89%     -    0s
H 1245   538                    -119098.3429 -119582.89  0.41%   7.8    0s
H 2990   793                    -119099.4258 -119294.64  0.16%   7.6    0s

Cutting planes:
  Gomory: 37
  Implied bound: 5
  MIR: 255
  Flow cover: 10
  RLT: 16
  BQP: 1

Explored 6688 nodes (47045 simplex iterations) in 0.26 seconds (0.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119099 -119098 -119056 ... 1.25707e+13
No other solutions better than -119099

Optimal solution found (tolerance 1.00e-06)
Best objective -1.190994257661e+05, best bound -1.190994257661e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 164686.70
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119099.43
  [DEBUG]   S×d_nominal = 283786.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283786.12 + -119099.43 = 164686.70
  [DEBUG]   Current θ from Master = 173580.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8893.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11811.17
  Lower Bound (LB) = 11811.17
  Gap (UB-LB) = 8893.9281, Absolute Gap = 8893.9281, Relative Gap = 0.429553
  Not converged yet (gap = 8893.93 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481324 nonzeros
Model fingerprint: 0x7ef42514
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68882 rows and 27962 columns
Presolve time: 1.45s
Presolved: 100691 rows, 42938 columns, 607109 nonzeros
Variable types: 40679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361301.9191
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.524e+06
 Factor NZ  : 1.006e+07 (roughly 140 MB of memory)
 Factor Ops : 1.834e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59961653e+07  1.79277188e+08  1.09e+05 2.05e+01  7.64e+04     3s
   1  -1.19050092e+07  1.58159056e+08  7.37e+04 7.77e+01  5.07e+04     3s
   2  -5.10170280e+06  1.23048284e+08  3.12e+04 5.27e+00  2.19e+04     3s
   3  -1.09882857e+06  9.88335767e+07  3.19e+03 1.76e+00  2.69e+03     3s
   4  -5.30189456e+05  3.90447941e+07  5.49e+02 3.16e-01  5.44e+02     3s
   5  -4.21085767e+05  2.55125508e+07  2.87e+02 1.85e-01  2.99e+02     3s
   6  -2.93468276e+05  1.81187722e+07  7.78e+01 1.16e-01  1.39e+02     3s
   7  -1.94596586e+05  1.38947152e+07  4.10e+01 8.45e-02  9.42e+01     3s
   8  -1.29065626e+05  1.08553521e+07  2.33e+01 6.34e-02  6.81e+01     3s
   9  -8.95650317e+04  6.59657021e+06  1.41e+01 3.59e-02  3.98e+01     3s
  10  -7.52791309e+04  3.13644153e+06  8.40e+00 1.55e-02  1.86e+01     3s
  11  -1.98667553e+04  5.53860434e+05  2.15e+00 1.69e-03  3.19e+00     3s
  12  -6.30414654e+03  2.92281948e+05  1.36e+00 1.27e-03  1.65e+00     3s
  13  -3.93532750e+02  1.91637168e+05  1.09e+00 1.29e-03  1.06e+00     3s
  14   8.88013694e+03  1.36772484e+05  7.85e-01 2.89e-03  7.02e-01     3s
  15   1.66567512e+04  1.13759772e+05  5.98e-01 1.89e-03  5.32e-01     3s
  16   2.29974424e+04  9.74763499e+04  4.69e-01 1.27e-03  4.07e-01     3s
  17   2.77653447e+04  8.66991164e+04  3.71e-01 1.23e-03  3.22e-01     3s
  18   3.18444443e+04  7.97121017e+04  2.91e-01 1.24e-03  2.61e-01     3s
  19   3.52214371e+04  7.22160429e+04  2.31e-01 1.19e-03  2.02e-01     3s
  20   3.74878010e+04  6.89212460e+04  1.94e-01 1.48e-03  1.71e-01     4s
  21   4.05318967e+04  6.50274894e+04  1.47e-01 1.87e-03  1.34e-01     4s
  22   4.29827201e+04  6.16880606e+04  1.13e-01 1.77e-03  1.02e-01     4s
  23   4.45657944e+04  5.93761193e+04  9.27e-02 1.32e-03  8.07e-02     4s
  24   4.59110672e+04  5.72847902e+04  7.59e-02 1.51e-03  6.20e-02     4s
  25   4.76978494e+04  5.63585821e+04  5.45e-02 1.12e-03  4.72e-02     4s
  26   4.87631815e+04  5.59007205e+04  4.22e-02 1.15e-03  3.89e-02     4s
  27   4.89436089e+04  5.56146074e+04  4.02e-02 1.13e-03  3.63e-02     4s
  28   4.95736057e+04  5.54787049e+04  3.31e-02 1.03e-03  3.22e-02     4s
  29   5.02524854e+04  5.44204772e+04  2.54e-02 1.33e-03  2.27e-02     4s
  30   5.08499649e+04  5.39487051e+04  1.90e-02 7.28e-04  1.69e-02     4s
  31   5.12549950e+04  5.36744536e+04  1.45e-02 1.14e-03  1.32e-02     4s
  32   5.15421711e+04  5.34651085e+04  1.14e-02 1.37e-03  1.05e-02     4s
  33   5.17201387e+04  5.34108103e+04  9.69e-03 1.24e-03  9.21e-03     4s
  34   5.19717268e+04  5.30784746e+04  7.10e-03 8.50e-04  6.03e-03     4s
  35   5.20394935e+04  5.30372025e+04  6.42e-03 8.01e-04  5.44e-03     4s
  36   5.23103953e+04  5.29593411e+04  3.65e-03 6.04e-04  3.53e-03     4s
  37   5.24222951e+04  5.29102888e+04  2.53e-03 4.91e-04  2.66e-03     4s
  38   5.24528961e+04  5.28748992e+04  2.23e-03 4.10e-04  2.30e-03     4s
  39   5.25180611e+04  5.27994223e+04  1.60e-03 2.35e-04  1.53e-03     4s
  40   5.25555874e+04  5.27936558e+04  1.27e-03 2.21e-04  1.30e-03     4s
  41   5.25868744e+04  5.27639040e+04  9.73e-04 1.53e-04  9.64e-04     5s
  42   5.26383256e+04  5.27390841e+04  4.96e-04 9.38e-05  5.48e-04     5s
  43   5.26637771e+04  5.27276045e+04  2.61e-04 6.94e-05  3.47e-04     5s
  44   5.26743837e+04  5.27128641e+04  1.72e-04 3.46e-05  2.09e-04     5s
  45   5.26885784e+04  5.27081264e+04  5.71e-05 2.53e-05  1.06e-04     5s
  46   5.26919570e+04  5.27033644e+04  3.13e-05 1.50e-05  6.20e-05     5s
  47   5.26937476e+04  5.27017587e+04  1.77e-05 1.15e-05  4.35e-05     5s
  48   5.26941132e+04  5.26997760e+04  1.53e-05 7.15e-06  3.08e-05     5s
  49   5.26950426e+04  5.26982200e+04  8.75e-06 3.86e-06  1.73e-05     5s
  50   5.26955816e+04  5.26966665e+04  5.14e-06 5.43e-07  5.90e-06     5s
  51   5.26959391e+04  5.26964381e+04  2.78e-06 1.06e-07  2.72e-06     5s
  52   5.26963758e+04  5.26963828e+04  2.70e-07 2.48e-07  3.83e-08     5s
  53   5.26963818e+04  5.26963819e+04  6.82e-09 1.81e-11  1.04e-10     5s

Barrier solved model in 53 iterations and 5.11 seconds (8.92 work units)
Optimal objective 5.26963818e+04


Root crossover log...

   83629 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2450 PPushes remaining with PInf 3.5312753e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0403121e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34761    5.2696382e+04   0.000000e+00   0.000000e+00      7s
   34761    5.2696382e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.269638e+04, 34761 iterations, 5.51 seconds (11.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52696.3819    0  360 -233202.98 52696.3819   123%     -    7s
H    0     0                    -229187.9400 52696.3819   123%     -    7s
H    0     0                    -140405.3685 52696.3819   138%     -    8s
H    0     0                    -133311.2863 52696.3819   140%     -    8s
H    0     0                    -87411.33915 52696.3819   160%     -    8s
H    0     0                    -83854.54879 52696.3819   163%     -    8s
H    0     0                    -83700.03641 52696.3819   163%     -    8s
H    0     0                    -75105.15234 52696.3819   170%     -    8s
H    0     0                    -74948.16809 52696.3819   170%     -    8s
H    0     0                    -50122.60346 52696.3819   205%     -    8s
H    0     0                    -28946.88513 45033.0625   256%     -   39s
H    0     0                    -25421.46807 45033.0625   277%     -   39s
H    0     0                    -21380.36254 45033.0625   311%     -   39s
     0     0 45024.4177    0  462 -21380.363 45024.4177   311%     -   40s
H    0     0                    -20705.67841 45024.4177   317%     -   41s
H    0     0                    -20309.70363 45024.4177   322%     -   41s
H    0     0                    -20219.97961 45024.4177   323%     -   41s
H    0     0                    -20203.47419 45024.4177   323%     -   41s
H    0     0                    -20184.92527 45024.4177   323%     -   41s
H    0     0                    -20125.63892 45024.4177   324%     -   41s
H    0     0                    -20107.58239 45024.4177   324%     -   41s
     0     0 44415.1635    0  449 -20107.582 44415.1635   321%     -   51s
     0     0 44275.7366    0  433 -20107.582 44275.7366   320%     -   58s
     0     0 44214.7430    0  450 -20107.582 44214.7430   320%     -   62s
     0     0 44206.1649    0  458 -20107.582 44206.1649   320%     -   65s
     0     0 44202.7432    0  449 -20107.582 44202.7432   320%     -   66s
     0     0 44196.6151    0  450 -20107.582 44196.6151   320%     -   66s
     0     0 44188.4091    0  446 -20107.582 44188.4091   320%     -   69s
     0     0 44186.4555    0  457 -20107.582 44186.4555   320%     -   69s
     0     0 44186.4288    0  452 -20107.582 44186.4288   320%     -   70s
H    0     0                    -18318.74096 40258.2229   320%     -  116s
H    0     0                    -18295.67013 40258.2229   320%     -  116s
H    0     0                    -18144.55462 40258.2229   322%     -  116s
H    0     0                    -17792.92122 40258.2229   326%     -  116s
H    0     0                    -17270.93548 40258.2229   333%     -  116s
H    0     0                    -17085.39520 40258.2229   336%     -  116s
H    0     0                    -16851.98957 40258.2229   339%     -  116s
H    0     0                    -16767.08505 40258.2229   340%     -  116s
H    0     0                    -16312.93853 40258.2229   347%     -  116s
     0     0 40258.2229    0  423 -16312.939 40258.2229   347%     -  116s
H    0     0                    -3018.166687 40255.6518  1434%     -  117s
H    0     0                    -1368.894158 40255.6518  3041%     -  117s
H    0     0                    -1238.660944 40255.6518  3350%     -  117s
H    0     0                    -1196.148115 40255.6518  3465%     -  117s
H    0     0                    4855.0361202 39277.6432   709%     -  142s
H    0     0                    4870.6896893 39277.6432   706%     -  142s
H    0     0                    4881.9767784 39277.6432   705%     -  142s
H    0     0                    5406.9287827 39277.6432   626%     -  142s
H    0     0                    5745.2488505 39277.6432   584%     -  142s
H    0     0                    5798.1291729 39277.6432   577%     -  142s
H    0     0                    8025.1193389 39277.6432   389%     -  142s
H    0     0                    10963.805779 39277.6432   258%     -  142s
H    0     0                    10986.376068 39277.6432   258%     -  142s
H    0     0                    11655.820045 39277.6432   237%     -  142s
H    0     0                    11712.554711 39277.6432   235%     -  142s
H    0     0                    11725.064456 39277.6432   235%     -  142s
     0     0 39277.6432    0  422 11725.0645 39277.6432   235%     -  142s
     0     0 38889.4438    0  544 11725.0645 38889.4438   232%     -  165s
     0     0 38751.9306    0  537 11725.0645 38751.9306   231%     -  181s
     0     0 38722.1262    0  552 11725.0645 38722.1262   230%     -  189s
     0     0 38607.0154    0  533 11725.0645 38607.0154   229%     -  199s
     0     0 38592.2549    0  551 11725.0645 38592.2549   229%     -  203s
     0     0 38561.7564    0  544 11725.0645 38561.7564   229%     -  211s
     0     0 38548.1287    0  548 11725.0645 38548.1287   229%     -  216s
     0     0 38546.8993    0  547 11725.0645 38546.8993   229%     -  218s
H    0     0                    12488.592556 38546.8993   209%     -  231s
H    0     0                    12796.993183 38546.8993   201%     -  231s
H    0     0                    12867.861534 38546.8993   200%     -  231s
H    0     0                    13582.484422 38546.8993   184%     -  231s
H    0     0                    13614.809090 38546.8993   183%     -  231s
H    0     0                    14338.537721 35453.5532   147%     -  288s
H    0     0                    15060.649312 35453.5532   135%     -  288s
H    0     0                    15125.579481 35453.5532   134%     -  288s
     0     0 35453.5532    0  466 15125.5795 35453.5532   134%     -  288s
H    0     0                    15357.034674 35453.4003   131%     -  288s
H    0     0                    15613.603451 35453.4003   127%     -  288s
H    0     0                    15715.429767 35453.4003   126%     -  289s
H    0     0                    15765.633597 35453.4003   125%     -  289s
H    0     0                    16123.415765 35453.4003   120%     -  289s
H    0     0                    16266.493061 35453.4003   118%     -  289s
H    0     0                    16345.074293 35453.4003   117%     -  289s
     0     0 34964.7618    0  497 16345.0743 34964.7618   114%     -  327s
     0     0 34834.4995    0  484 16345.0743 34834.4995   113%     -  343s
     0     0 34636.6024    0  495 16345.0743 34636.6024   112%     -  360s
     0     0 34520.3854    0  511 16345.0743 34520.3854   111%     -  376s
H    0     0                    16359.922029 34425.7897   110%     -  393s
     0     0 34425.7897    0  505 16359.9220 34425.7897   110%     -  394s
H    0     0                    16372.196163 34313.8250   110%     -  407s
H    0     0                    16385.557802 34313.8250   109%     -  407s
H    0     0                    16461.767925 34313.8250   108%     -  407s
H    0     0                    16488.920210 34313.8250   108%     -  407s
     0     0 34313.8250    0  485 16488.9202 34313.8250   108%     -  407s
     0     0 34246.2685    0  496 16488.9202 34246.2685   108%     -  420s
     0     0 34223.3525    0  489 16488.9202 34223.3525   108%     -  424s
     0     0 34204.4809    0  495 16488.9202 34204.4809   107%     -  429s
     0     0 34138.7130    0  508 16488.9202 34138.7130   107%     -  435s
     0     0 34132.4927    0  503 16488.9202 34132.4927   107%     -  437s
     0     0 34129.3718    0  506 16488.9202 34129.3718   107%     -  439s
     0     0 34127.4016    0  503 16488.9202 34127.4016   107%     -  439s
     0     0 32506.0388    0  468 16488.9202 32506.0388  97.1%     -  496s
     0     0 32290.1560    0  520 16488.9202 32290.1560  95.8%     -  517s
     0     0 32115.9310    0  583 16488.9202 32115.9310  94.8%     -  533s
     0     0 32050.6048    0  599 16488.9202 32050.6048  94.4%     -  542s
     0     0 31984.3482    0  508 16488.9202 31984.3482  94.0%     -  552s
     0     0 31952.7050    0  486 16488.9202 31952.7050  93.8%     -  557s
     0     0 31933.1930    0  478 16488.9202 31933.1930  93.7%     -  562s
     0     0 31927.7973    0  484 16488.9202 31927.7973  93.6%     -  564s
     0     0 31924.5105    0  482 16488.9202 31924.5105  93.6%     -  565s
     0     0 31603.3272    0  465 16488.9202 31603.3272  91.7%     -  582s
H    0     0                    16496.601367 31602.4290  91.6%     -  583s
H    0     0                    16539.647584 31602.4290  91.1%     -  583s
H    0     0                    16560.676025 31602.4290  90.8%     -  583s
     0     0 31551.1988    0  465 16560.6760 31551.1988  90.5%     -  591s
     0     0 31524.1428    0  492 16560.6760 31524.1428  90.4%     -  596s
     0     0 31502.3013    0  493 16560.6760 31502.3013  90.2%     -  601s
     0     0 31490.0088    0  523 16560.6760 31490.0088  90.1%     -  606s
     0     0 31476.3754    0  534 16560.6760 31476.3754  90.1%     -  610s
     0     0 31469.4079    0  496 16560.6760 31469.4079  90.0%     -  612s
     0     0 31458.9175    0  490 16560.6760 31458.9175  90.0%     -  625s
     0     0 31455.5941    0  485 16560.6760 31455.5941  89.9%     -  628s
     0     0 31372.8142    0  479 16560.6760 31372.8142  89.4%     -  638s
H    0     0                    16674.933227 31372.1285  88.1%     -  641s
     0     0 31361.8121    0  581 16674.9332 31361.8121  88.1%     -  646s
     0     0 31357.5242    0  577 16674.9332 31357.5242  88.1%     -  649s
     0     0 31355.2267    0  515 16674.9332 31355.2267  88.0%     -  651s
     0     0 31272.9751    0  510 16674.9332 31272.9751  87.5%     -  663s
     0     0 31250.0395    0  525 16674.9332 31250.0395  87.4%     -  669s
     0     0 31239.2323    0  523 16674.9332 31239.2323  87.3%     -  673s
     0     0 31223.0452    0  520 16674.9332 31223.0452  87.2%     -  676s
     0     0 31218.5388    0  526 16674.9332 31218.5388  87.2%     -  678s
     0     0 31218.2070    0  531 16674.9332 31218.2070  87.2%     -  679s
     0     0 31144.9293    0  499 16674.9332 31144.9293  86.8%     -  690s
     0     0 31135.6039    0  506 16674.9332 31135.6039  86.7%     -  695s
     0     0 31132.1167    0  514 16674.9332 31132.1167  86.7%     -  696s
     0     0 31109.5676    0  515 16674.9332 31109.5676  86.6%     -  701s
     0     0 31102.9863    0  521 16674.9332 31102.9863  86.5%     -  704s
     0     0 31100.9903    0  521 16674.9332 31100.9903  86.5%     -  705s
     0     0 31084.7312    0  503 16674.9332 31084.7312  86.4%     -  709s
     0     0 31084.2270    0  503 16674.9332 31084.2270  86.4%     -  712s
H    0     0                    16728.871810 31084.2270  85.8%     -  748s
     0     2 31084.2270    0  503 16728.8718 31084.2270  85.8%     -  803s
     1     3 30535.2043    1  410 16728.8718 31084.2270  85.8% 10444  813s
     2     5 30156.6214    2  442 16728.8718 31084.2270  85.8% 11118  828s
     4    10 30233.8291    2  454 16728.8718 30623.4004  83.1%  9396  863s
     9    20 30018.6191    3  429 16728.8718 30436.9036  81.9% 11072  883s
    19    40 29846.3096    4  447 16728.8718 30190.7057  80.5% 10911  908s
    39    52 28127.7946    5  409 16728.8718 29997.6567  79.3% 17672  982s
    51    76 29302.8163    7  404 16728.8718 29997.6567  79.3% 17765 1027s
    75   185 29131.6633    8  328 16728.8718 29997.6567  79.3% 14958 1068s
H  184   262                    16835.241626 29997.6567  78.2%  9308 1089s
   261   319 28517.3751   16  376 16835.2416 29997.6567  78.2%  8733 1109s
   318   345 28336.9729   19  358 16835.2416 29997.6567  78.2%  8222 1126s
   344   382 28300.0141   20  351 16835.2416 29997.6567  78.2%  8049 1144s
   381   410 28039.1518   21  428 16835.2416 29997.6567  78.2%  7901 1160s
H  397   410                    16859.995016 29997.6567  77.9%  7906 1160s
   409   438 28027.8216   22  436 16859.9950 29997.6567  77.9%  7889 1186s
   437   476 28025.6811   23  432 16859.9950 29997.6567  77.9%  7770 1222s
   475   521 27999.4655   24  392 16859.9950 29997.6567  77.9%  7650 1239s
   520   567 27660.8566   25  392 16859.9950 29997.6567  77.9%  7351 1257s
H  544   567                    16897.709757 29997.6567  77.5%  7228 1257s
   566   659 27635.7166   26  387 16897.7098 29997.6567  77.5%  7088 1276s
   660   755 26682.3173   28  197 16897.7098 29997.6567  77.5%  6558 1292s
   760   802 26649.7787   29  323 16897.7098 29997.6567  77.5%  6062 1306s
   807   832 26626.0830   30  183 16897.7098 29997.6567  77.5%  5840 1320s
   841   867 26620.0510   31  268 16897.7098 29997.6567  77.5%  5722 1336s
   884   909 26212.8824   37  151 16897.7098 29997.6567  77.5%  5661 1351s
   932   969 26121.3876   43  188 16897.7098 29997.6567  77.5%  5563 1365s
   995  1024 25457.0537   47  160 16897.7098 29997.6567  77.5%  5411 1390s
  1062  1104 25259.2361   50  191 16897.7098 29997.6567  77.5%  5209 1408s
  1166  1177 24643.5485   57  107 16897.7098 29997.6567  77.5%  4980 1429s
  1303  1254 23892.9461   65  154 16897.7098 29997.6567  77.5%  4679 1450s
  1414  1309 23455.5730   74   64 16897.7098 29997.6567  77.5%  4529 1471s
  1555  1311 infeasible   81      16897.7098 29997.6567  77.5%  4365 1496s
  1663  1342 17626.8550   78  127 16897.7098 29997.6567  77.5%  4263 1522s
  1746  1354 19088.7518   18  265 16897.7098 29997.6567  77.5%  4253 1547s
  1828  1397 18975.3209   19  323 16897.7098 29997.6567  77.5%  4267 1573s
  1915  1470 18237.3680   20  250 16897.7098 29997.6567  77.5%  4278 1600s
  2042  1545 18006.8294   22  245 16897.7098 29997.6567  77.5%  4259 1625s
  2195  1633 17736.5338   24  250 16897.7098 29997.6567  77.5%  4175 1652s
  2365  1729 infeasible   27      16897.7098 29852.6149  76.7%  4078 1684s
  2528  1879     cutoff   32      16897.7098 29852.6149  76.7%  4015 1714s
  2733  2003 24118.3008   13  352 16897.7098 29852.6149  76.7%  3911 1747s
  2958  2038 24061.6533   14  354 16897.7098 29852.6149  76.7%  3803 1775s
  3019  2093 23007.3203   15  358 16897.7098 29852.6149  76.7%  3804 1805s
  3151  2221 22827.3874   16  366 16897.7098 29713.0243  75.8%  3749 1836s
  3319  2337 18223.6879   18  322 16897.7098 29713.0243  75.8%  3726 1869s
  3477  2407 17512.1956   20  312 16897.7098 29295.4593  73.4%  3716 1903s
  3593  2538 infeasible   25      16897.7098 29295.4593  73.4%  3709 1942s
H 3602  2533                    16963.079024 29295.4593  72.7%  3712 1942s
H 3777  2510                    17131.486670 29295.4593  71.0%  3676 1955s
H 3777  2372                    17441.010569 29295.4593  68.0%  3676 1958s
H 3777  2319                    17536.903825 29295.4593  67.1%  3676 1963s
  3778  2307 19947.3967   26  503 17536.9038 29295.4593  67.1%  3675 2091s
H 3779  2192                    17623.977184 29295.4593  66.2%  3674 2105s
H 3779  2082                    17630.485531 29295.4593  66.2%  3674 2105s
H 3779  1978                    17655.627546 29295.4593  65.9%  3674 2105s
  3781  1979 26755.8537   17  386 17655.6275 29295.4593  65.9%  3672 2184s
  3782  1980 18793.1498   39  419 17655.6275 29295.4593  65.9%  3671 2271s
  3783  1980 24015.2995   48  409 17655.6275 29295.4593  65.9%  3670 2318s
  3784  1981 25336.2434   16  419 17655.6275 29295.4593  65.9%  3669 2347s
  3785  1982 24688.6270   17  450 17655.6275 29295.4593  65.9%  3668 2362s
  3786  1982 18934.7500   28  455 17655.6275 29295.4593  65.9%  3667 2374s
  3787  1983 23333.1297   34  419 17655.6275 29295.4593  65.9%  3666 2385s
  3788  1984 24013.8950   25  442 17655.6275 29295.4593  65.9%  3666 2394s
  3789  1984 19823.8050   21  469 17655.6275 29295.4593  65.9%  3665 2400s
  3790  1985 18315.0146   77  431 17655.6275 29295.4593  65.9%  3664 2409s
  3791  1986 27981.9341   11  513 17655.6275 29295.4593  65.9%  3663 2414s
  3792  1986 18290.8337   58  424 17655.6275 29295.4593  65.9%  3662 2418s
  3793  1987 19005.4074   45  420 17655.6275 29295.4593  65.9%  3661 2422s
  3794  1988 25361.9374   26  467 17655.6275 29295.4593  65.9%  3660 2438s
  3795  1988 26297.2026   12  426 17655.6275 29295.4593  65.9%  3659 2443s
  3796  1989 18076.7444   55  463 17655.6275 29295.4593  65.9%  3658 2450s
  3798  1990 27430.3323   13  418 17655.6275 29295.4593  65.9%  3656 2457s
  3799  1991 19264.9364   42  493 17655.6275 29295.4593  65.9%  3655 2474s
  3800  1992 23744.8799   24  484 17655.6275 29295.4593  65.9%  3654 2480s
  3801  1992 29070.9887    7  429 17655.6275 29295.4593  65.9%  3653 2485s
  3803  1994 24398.1335   27  474 17655.6275 29295.4593  65.9%  3651 2503s
  3804  1994 24293.7643   22  501 17655.6275 29295.4593  65.9%  3650 2510s
  3805  1995 19396.2436   19  444 17655.6275 29295.4593  65.9%  3649 2517s
  3806  1996 22762.8816   15  494 17655.6275 29295.4593  65.9%  3648 2523s
  3807  1996 26689.5637    9  501 17655.6275 29295.4593  65.9%  3647 2538s
  3808  1997 18713.7775   38  495 17655.6275 29295.4593  65.9%  3646 2543s
  3809  1998 22895.0075   42  487 17655.6275 29295.4593  65.9%  3645 2549s
  3810  1998 23984.5417   40  498 17655.6275 29295.4593  65.9%  3644 2552s
  3811  1999 24353.6473   26  488 17655.6275 29295.4593  65.9%  3643 2570s
  3812  2000 23001.2993   55  499 17655.6275 29295.4593  65.9%  3642 2577s
  3813  2000 24946.8344   32  501 17655.6275 29295.4593  65.9%  3641 2584s
  3814  2001 19088.4797   35  496 17655.6275 29295.4593  65.9%  3641 2588s
  3815  2002 18539.2685   69  502 17655.6275 29295.4593  65.9%  3640 2594s
  3816  2002 17855.2980   49  502 17655.6275 29295.4593  65.9%  3639 2618s
  3817  2003 26062.9889   18  502 17655.6275 29295.4593  65.9%  3638 2680s
  3818  2006 29295.4593   11  377 17655.6275 29295.4593  65.9%  3752 2711s
  3819  2007 28252.9344   12  288 17655.6275 29295.4593  65.9%  3753 2738s
  3821  2012 27721.2846   13  315 17655.6275 29295.4593  65.9%  3756 2771s
  3826  2020 26274.1596   14  298 17655.6275 29295.4593  65.9%  3767 2799s
  3836  2037 25707.2015   15  290 17655.6275 29295.4593  65.9%  3796 2831s
  3856  2041 28145.1740   15  482 17655.6275 29295.4593  65.9%  3852 3600s

Cutting planes:
  Gomory: 10
  Implied bound: 23
  Projected implied bound: 156
  MIR: 1211
  Mixing: 4
  Flow cover: 1616
  RLT: 58
  Relax-and-lift: 306

Explored 3867 nodes (15822576 simplex iterations) in 3600.05 seconds (7928.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17655.6 17630.5 17624 ... 16835.2

Time limit reached
Best objective 1.765562754584e+04, best bound 2.929545926184e+04, gap 65.9270%
  WARNING: Time limit reached. Using best solution found (gap: 65.93%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 17655.63, θ = 167573.74
  Upper Bound (UB) = 17655.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167573.74
  [DEBUG]   ✓ Scenario 0: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167573.74 ≤ Q = 167573.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167573.74 ≤ Q = 167573.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167573.74 ≤ Q = 167573.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167573.74 ≤ Q = 167573.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 167573.74 ≤ Q = 167573.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x28149d6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x028149d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.273064e+13
Presolve removed 2565 rows and 1855 columns
Presolve time: 0.00s
Presolved: 528 rows, 534 columns, 1494 nonzeros
Found heuristic solution: objective 6661765.0539
Variable types: 360 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6661054.3160

Root relaxation: objective -1.498776e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149877.59    0  126 6661054.32 -149877.59   102%     -    0s
H    0     0                    -108997.2927 -149877.59  37.5%     -    0s
H    0     0                    -117963.7308 -149877.59  27.1%     -    0s
H    0     0                    -118177.3458 -149693.35  26.7%     -    0s
     0     0 -127266.42    0   79 -118177.35 -127266.42  7.69%     -    0s
H    0     0                    -125074.5201 -127130.68  1.64%     -    0s
H    0     0                    -125122.9924 -127130.68  1.60%     -    0s
     0     0 -127130.68    0   76 -125122.99 -127130.68  1.60%     -    0s
     0     0 -127130.68    0   76 -125122.99 -127130.68  1.60%     -    0s
     0     0 -126683.76    0   75 -125122.99 -126683.76  1.25%     -    0s
H    0     0                    -125546.7261 -126574.72  0.82%     -    0s
H    0     0                    -125553.2871 -126574.72  0.81%     -    0s
     0     0 -126574.72    0   78 -125553.29 -126574.72  0.81%     -    0s
     0     0 -126058.86    0   79 -125553.29 -126058.86  0.40%     -    0s
H    0     0                    -125564.7870 -126055.65  0.39%     -    0s
     0     0 -126014.68    0   52 -125564.79 -126014.68  0.36%     -    0s
     0     0 -126005.57    0   61 -125564.79 -126005.57  0.35%     -    0s
     0     0 -125855.03    0   60 -125564.79 -125855.03  0.23%     -    0s
     0     0 -125828.36    0   48 -125564.79 -125828.36  0.21%     -    0s
     0     0 -125794.83    0   55 -125564.79 -125794.83  0.18%     -    0s
     0     0 -125781.48    0   48 -125564.79 -125781.48  0.17%     -    0s
     0     0 -125771.07    0   51 -125564.79 -125771.07  0.16%     -    0s
     0     0 -125733.42    0   48 -125564.79 -125733.42  0.13%     -    0s
H    0     0                    -125593.3803 -125725.18  0.10%     -    0s
     0     0 -125725.18    0   49 -125593.38 -125725.18  0.10%     -    0s
     0     0 -125711.30    0   34 -125593.38 -125711.30  0.09%     -    0s
     0     0 -125711.30    0   50 -125593.38 -125711.30  0.09%     -    0s
     0     0 -125647.17    0   10 -125593.38 -125647.17  0.04%     -    0s
     0     0 -125620.95    0    8 -125593.38 -125620.95  0.02%     -    0s
     0     0 -125616.55    0    8 -125593.38 -125616.55  0.02%     -    0s
     0     0 -125607.97    0    6 -125593.38 -125607.97  0.01%     -    0s
     0     0 -125607.97    0    5 -125593.38 -125607.97  0.01%     -    0s
H    0     0                    -125594.5964 -125607.97  0.01%     -    0s
     0     0 -125601.11    0    5 -125594.60 -125601.11  0.01%     -    0s
     0     0 -125599.93    0    7 -125594.60 -125599.93  0.00%     -    0s
     0     0 -125599.53    0    8 -125594.60 -125599.53  0.00%     -    0s
     0     0 -125598.40    0    8 -125594.60 -125598.40  0.00%     -    0s
     0     0 -125598.27    0    8 -125594.60 -125598.27  0.00%     -    0s
     0     0 -125597.69    0    8 -125594.60 -125597.69  0.00%     -    0s
     0     0 -125597.50    0    8 -125594.60 -125597.50  0.00%     -    0s
     0     0 -125595.94    0    6 -125594.60 -125595.94  0.00%     -    0s
     0     0 -125595.55    0    2 -125594.60 -125595.55  0.00%     -    0s
     0     0 -125595.44    0    2 -125594.60 -125595.44  0.00%     -    0s
     0     0 -125595.44    0    2 -125594.60 -125595.44  0.00%     -    0s
     0     0 -125595.44    0    2 -125594.60 -125595.44  0.00%     -    0s
H    0     0                    -125595.0031 -125595.44  0.00%     -    0s

Explored 1 nodes (1018 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125595 -125595 -125593 ... -117964
No other solutions better than -125595

Optimal solution found (tolerance 1.00e-06)
Best objective -1.255950030621e+05, best bound -1.255950030621e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 156677.21
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125595.00
  [DEBUG]   S×d_nominal = 282272.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282272.21 + -125595.00 = 156677.21
  [DEBUG]   Current θ from Master = 167573.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10896.54 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6759.09
  Lower Bound (LB) = 11811.17
  Gap (UB-LB) = 5844.4590, Absolute Gap = 5844.4590, Relative Gap = 0.331025
  Not converged yet (gap = 5844.46 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524579 nonzeros
Model fingerprint: 0x8926e247
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75144 rows and 30504 columns
Presolve time: 1.64s
Presolved: 109719 rows, 46636 columns, 659903 nonzeros
Variable types: 44377 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -360898.1780
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.767e+06
 Factor NZ  : 9.135e+06 (roughly 140 MB of memory)
 Factor Ops : 1.748e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.65634276e+07  1.93458267e+08  1.13e+05 2.03e+01  7.86e+04     3s
   1  -1.23796635e+07  1.71742579e+08  7.64e+04 7.77e+01  5.23e+04     3s
   2  -5.51125538e+06  1.34966147e+08  3.37e+04 7.35e-01  2.39e+04     3s
   3  -9.08380693e+05  1.04283223e+08  2.31e+03 2.41e+00  2.07e+03     3s
   4  -5.42948014e+05  4.16569348e+07  4.78e+02 4.87e-01  4.96e+02     3s
   5  -4.00382139e+05  2.74400059e+07  1.40e+02 2.76e-01  2.15e+02     3s
   6  -3.29891300e+05  1.97110949e+07  7.03e+01 1.82e-01  1.34e+02     3s
   7  -2.44467315e+05  1.58960576e+07  3.96e+01 1.41e-01  9.75e+01     3s
   8  -1.11474761e+05  1.07806702e+07  1.05e+01 8.98e-02  5.77e+01     3s
   9  -9.47478522e+04  6.90696613e+06  7.50e+00 5.57e-02  3.66e+01     3s
  10  -7.84759859e+04  3.36849270e+06  5.01e+00 2.61e-02  1.78e+01     3s
  11  -1.65977270e+04  5.77142253e+05  1.21e+00 3.49e-03  2.99e+00     3s
  12  -2.86531519e+03  3.38343596e+05  7.81e-01 1.80e-03  1.71e+00     3s
  13   3.65820667e+03  2.05375390e+05  6.05e-01 1.37e-03  1.01e+00     3s
  14   1.18929206e+04  1.59728439e+05  4.59e-01 1.40e-03  7.40e-01     3s
  15   1.91472418e+04  1.35336843e+05  3.52e-01 1.19e-03  5.81e-01     3s
  16   2.65637268e+04  1.14392811e+05  2.53e-01 1.11e-03  4.39e-01     3s
  17   3.06337436e+04  9.67928661e+04  1.95e-01 1.53e-03  3.31e-01     4s
  18   3.48093344e+04  8.29871427e+04  1.50e-01 1.94e-03  2.41e-01     4s
  19   3.76790431e+04  7.36867157e+04  1.23e-01 1.94e-03  1.80e-01     4s
  20   4.04689087e+04  6.90816576e+04  9.84e-02 2.19e-03  1.43e-01     4s
  21   4.37349916e+04  6.59662238e+04  7.18e-02 1.85e-03  1.11e-01     4s
  22   4.54437345e+04  6.35736192e+04  5.83e-02 1.60e-03  9.05e-02     4s
  23   4.77101385e+04  6.20913688e+04  4.12e-02 1.83e-03  7.18e-02     4s
  24   4.89830691e+04  5.98707616e+04  3.21e-02 1.22e-03  5.43e-02     4s
  25   4.99440882e+04  5.85806775e+04  2.54e-02 1.23e-03  4.31e-02     4s
  26   5.04902583e+04  5.74664034e+04  2.17e-02 1.49e-03  3.48e-02     4s
  27   5.10054935e+04  5.66686775e+04  1.84e-02 1.56e-03  2.83e-02     4s
  28   5.19156190e+04  5.57043039e+04  1.25e-02 9.39e-04  1.89e-02     4s
  29   5.24885675e+04  5.51872017e+04  8.96e-03 6.52e-04  1.35e-02     4s
  30   5.30957920e+04  5.49328451e+04  5.25e-03 5.00e-04  9.17e-03     4s
  31   5.34707199e+04  5.45273064e+04  3.06e-03 2.86e-04  5.27e-03     4s
  32   5.35789306e+04  5.44282938e+04  2.47e-03 2.26e-04  4.24e-03     4s
  33   5.36920350e+04  5.43309852e+04  1.83e-03 1.68e-04  3.19e-03     4s
  34   5.38136987e+04  5.42179517e+04  1.17e-03 1.03e-04  2.02e-03     4s
  35   5.38556655e+04  5.41884947e+04  9.36e-04 8.64e-05  1.66e-03     4s
  36   5.39335008e+04  5.41311019e+04  5.23e-04 5.23e-05  9.86e-04     4s
  37   5.40061557e+04  5.40742643e+04  1.60e-04 7.25e-05  3.40e-04     4s
  38   5.40293820e+04  5.40522869e+04  4.84e-05 1.37e-05  1.14e-04     4s
  39   5.40339977e+04  5.40487211e+04  2.64e-05 9.75e-06  7.34e-05     4s
  40   5.40363731e+04  5.40410653e+04  1.51e-05 1.42e-06  2.34e-05     4s
  41   5.40392555e+04  5.40396505e+04  1.28e-06 1.50e-06  1.97e-06     5s
  42   5.40395931e+04  5.40396013e+04  5.02e-09 1.85e-07  4.10e-08     5s
  43   5.40395979e+04  5.40395980e+04  7.45e-10 3.53e-11  8.13e-11     5s

Barrier solved model in 43 iterations and 4.63 seconds (8.32 work units)
Optimal objective 5.40395979e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2698 PPushes remaining with PInf 9.0717564e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.7776792e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35613    5.4039598e+04   0.000000e+00   0.000000e+00      7s
   35613    5.4039598e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.25s

Solved with barrier

Root relaxation: objective 5.403960e+04, 35613 iterations, 5.09 seconds (10.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54039.5980    0  398 -233202.98 54039.5980   123%     -    7s
H    0     0                    -183800.5439 54039.5980   129%     -    8s
H    0     0                    -161154.4733 54039.5980   134%     -    8s
H    0     0                    -99993.87435 54039.5980   154%     -    8s
H    0     0                    -84519.79435 54039.5980   164%     -    8s
H    0     0                    -84428.42906 54039.5980   164%     -    8s
H    0     0                    -81442.64919 54039.5980   166%     -    8s
H    0     0                    -58980.45155 54039.5980   192%     -    8s
H    0     0                    -50550.25748 54039.5980   207%     -    8s
H    0     0                    -50465.95356 54039.5980   207%     -    9s
H    0     0                    -50276.64319 54039.5980   207%     -    9s
H    0     0                    -49996.03243 54039.5980   208%     -    9s
H    0     0                    -49160.41887 54039.5980   210%     -    9s
H    0     0                    -49083.75022 54039.5980   210%     -    9s
H    0     0                    -49066.36602 54039.5980   210%     -    9s
H    0     0                    -49002.24115 54039.5980   210%     -    9s
H    0     0                    -45129.02013 54039.5980   220%     -   10s
H    0     0                    -23639.29789 54039.5980   329%     -   10s
H    0     0                    -23564.10849 54039.5980   329%     -   10s
H    0     0                    -22233.75633 54039.5980   343%     -   10s
H    0     0                    -21986.37879 54039.5980   346%     -   10s
H    0     0                    -21942.99024 54039.5980   346%     -   10s
H    0     0                    -21938.38030 54039.5980   346%     -   10s
H    0     0                    -21786.88564 54039.5980   348%     -   10s
H    0     0                    -21561.33386 54039.5980   351%     -   10s
H    0     0                    -21320.90654 54039.5980   353%     -   10s
H    0     0                    -21254.56276 54039.5980   354%     -   10s
H    0     0                    -21131.02835 54039.5980   356%     -   10s
H    0     0                    -20940.75548 54039.5980   358%     -   10s
     0     0 45888.1977    0  441 -20940.755 45888.1977   319%     -   38s
H    0     0                    -15560.01231 45888.1977   395%     -   39s
H    0     0                    -15038.46139 45888.1977   405%     -   39s
     0     0 45264.0896    0  439 -15038.461 45264.0896   401%     -   56s
     0     0 45199.3670    0  429 -15038.461 45199.3670   401%     -   63s
     0     0 45199.3670    0  428 -15038.461 45199.3670   401%     -   68s
     0     0 45199.3670    0  427 -15038.461 45199.3670   401%     -   69s
     0     0 41060.2159    0  409 -15038.461 41060.2159   373%     -  113s
H    0     0                    -13527.74432 41056.1259   403%     -  115s
H    0     0                    -13177.50362 41056.1259   412%     -  115s
H    0     0                    -5555.186216 41056.1259   839%     -  115s
H    0     0                    -5084.795338 41056.1259   907%     -  115s
H    0     0                    -4907.026664 41056.1259   937%     -  115s
H    0     0                    -4857.991718 41056.1259   945%     -  115s
H    0     0                    -4828.266253 41056.1259   950%     -  115s
H    0     0                    -4812.386448 41056.1259   953%     -  115s
H    0     0                    -1143.147932 39687.2967  3572%     -  152s
H    0     0                     -50.0261497 39687.2967      -     -  152s
     0     0 39687.2967    0  488  -50.02615 39687.2967      -     -  153s
     0     0 39339.2029    0  509  -50.02615 39339.2029      -     -  176s
H    0     0                     404.8830140 39164.1260  9573%     -  196s
H    0     0                     476.4990119 39164.1260  8119%     -  196s
H    0     0                     727.9006484 39164.1260  5280%     -  196s
H    0     0                     991.7342898 39164.1260  3849%     -  196s
     0     0 39164.1260    0  558  991.73429 39164.1260  3849%     -  197s
     0     0 39043.6554    0  535  991.73429 39043.6554  3837%     -  215s
     0     0 38982.8724    0  524  991.73429 38982.8724  3831%     -  228s
H    0     0                    2480.8281431 38961.8369  1471%     -  236s
H    0     0                    2624.4823994 38961.8369  1385%     -  236s
H    0     0                    4535.6444445 38961.8369   759%     -  236s
H    0     0                    4545.0559031 38961.8369   757%     -  236s
H    0     0                    4548.0563108 38961.8369   757%     -  236s
     0     0 38961.8369    0  571 4548.05631 38961.8369   757%     -  236s
H    0     0                    4602.0186521 38820.4262   744%     -  250s
H    0     0                    5839.8974294 38820.4262   565%     -  250s
     0     0 38820.4262    0  568 5839.89743 38820.4262   565%     -  250s
     0     0 38779.1223    0  541 5839.89743 38779.1223   564%     -  257s
H    0     0                    12177.692624 38768.8708   218%     -  261s
H    0     0                    12186.559121 38768.8708   218%     -  261s
H    0     0                    12704.609974 38768.8708   205%     -  261s
H    0     0                    12737.568060 38768.8708   204%     -  261s
H    0     0                    12761.013727 38768.8708   204%     -  261s
H    0     0                    13080.557364 38768.8708   196%     -  261s
     0     0 38768.8708    0  587 13080.5574 38768.8708   196%     -  261s
     0     0 38765.0460    0  529 13080.5574 38765.0460   196%     -  262s
     0     0 38764.6083    0  560 13080.5574 38764.6083   196%     -  264s
H    0     0                    13190.353689 35727.7266   171%     -  344s
H    0     0                    13365.802395 35727.7266   167%     -  344s
H    0     0                    13453.227658 35727.7266   166%     -  344s
H    0     0                    13767.039819 35727.7266   160%     -  344s
H    0     0                    13877.561110 35727.7266   157%     -  344s
H    0     0                    14173.845060 35727.7266   152%     -  344s
H    0     0                    14180.186394 35727.7266   152%     -  344s
     0     0 35727.7266    0  477 14180.1864 35727.7266   152%     -  344s
H    0     0                    14800.399440 35727.5873   141%     -  344s
H    0     0                    15783.836678 35727.5873   126%     -  345s
H    0     0                    15900.119041 35727.5873   125%     -  345s
H    0     0                    15908.541055 35727.5873   125%     -  345s
H    0     0                    15912.248728 35727.5873   125%     -  345s
H    0     0                    15975.706650 35727.5873   124%     -  345s
H    0     0                    15994.265093 35727.5873   123%     -  345s
     0     0 35021.7254    0  591 15994.2651 35021.7254   119%     -  384s
H    0     0                    16067.409642 34709.1276   116%     -  420s
     0     0 34709.1276    0  523 16067.4096 34709.1276   116%     -  420s
     0     0 34588.6094    0  607 16067.4096 34588.6094   115%     -  438s
H    0     0                    16080.851692 34523.0627   115%     -  449s
     0     0 34523.0627    0  571 16080.8517 34523.0627   115%     -  449s
     0     0 34464.9439    0  528 16080.8517 34464.9439   114%     -  457s
     0     0 34439.6794    0  584 16080.8517 34439.6794   114%     -  467s
     0     0 34330.0701    0  644 16080.8517 34330.0701   113%     -  481s
H    0     0                    16112.471620 34274.8888   113%     -  488s
     0     0 34274.8888    0  599 16112.4716 34274.8888   113%     -  488s
     0     0 34228.8277    0  638 16112.4716 34228.8277   112%     -  493s
     0     0 34210.7035    0  584 16112.4716 34210.7035   112%     -  498s
     0     0 34179.9528    0  567 16112.4716 34179.9528   112%     -  506s
H    0     0                    16375.775150 34079.1853   108%     -  514s
H    0     0                    16526.249544 34079.1853   106%     -  514s
     0     0 34079.1853    0  536 16526.2495 34079.1853   106%     -  514s
     0     0 34066.2788    0  585 16526.2495 34066.2788   106%     -  519s
     0     0 34061.0528    0  581 16526.2495 34061.0528   106%     -  522s
     0     0 34001.7736    0  591 16526.2495 34001.7736   106%     -  530s
     0     0 33977.7429    0  583 16526.2495 33977.7429   106%     -  536s
     0     0 33943.1668    0  586 16526.2495 33943.1668   105%     -  542s
     0     0 33930.6422    0  640 16526.2495 33930.6422   105%     -  547s
     0     0 33922.2883    0  641 16526.2495 33922.2883   105%     -  550s
     0     0 33914.5713    0  641 16526.2495 33914.5713   105%     -  553s
     0     0 33913.0419    0  638 16526.2495 33913.0419   105%     -  555s
H    0     0                    16546.374940 32269.3615  95.0%     -  610s
H    0     0                    16587.112560 32269.3615  94.5%     -  610s
     0     0 32269.3615    0  466 16587.1126 32269.3615  94.5%     -  610s
H    0     0                    16675.721809 32269.3297  93.5%     -  611s
     0     0 31880.3821    0  492 16675.7218 31880.3821  91.2%     -  641s
     0     0 31761.2326    0  450 16675.7218 31761.2326  90.5%     -  653s
     0     0 31730.9991    0  448 16675.7218 31730.9991  90.3%     -  658s
     0     0 31714.3709    0  436 16675.7218 31714.3709  90.2%     -  663s
     0     0 31703.8869    0  443 16675.7218 31703.8869  90.1%     -  665s
     0     0 31701.4560    0  436 16675.7218 31701.4560  90.1%     -  668s
     0     0 31418.4932    0  401 16675.7218 31418.4932  88.4%     -  685s
     0     0 31364.6685    0  432 16675.7218 31364.6685  88.1%     -  693s
     0     0 31329.9532    0  416 16675.7218 31329.9532  87.9%     -  698s
H    0     0                    16681.263472 31313.5860  87.7%     -  701s
     0     0 31313.5860    0  424 16681.2635 31313.5860  87.7%     -  701s
H    0     0                    16688.821295 31307.0933  87.6%     -  706s
H    0     0                    16690.622196 31307.0933  87.6%     -  706s
     0     0 31307.0933    0  429 16690.6222 31307.0933  87.6%     -  706s
     0     0 31299.9400    0  422 16690.6222 31299.9400  87.5%     -  709s
     0     0 31296.1085    0  415 16690.6222 31296.1085  87.5%     -  713s
     0     0 31202.5406    0  429 16690.6222 31202.5406  86.9%     -  722s
H    0     0                    16696.370468 31202.3277  86.9%     -  723s
H    0     0                    16905.225367 31202.3277  84.6%     -  724s
H    0     0                    16925.251060 31202.3277  84.4%     -  724s
H    0     0                    16949.497634 31202.3277  84.1%     -  724s
H    0     0                    16962.212238 31202.3277  84.0%     -  724s
H    0     0                    16976.127000 31202.3277  83.8%     -  724s
H    0     0                    16987.419813 31202.3277  83.7%     -  724s
     0     0 31179.5513    0  449 16987.4198 31179.5513  83.5%     -  729s
     0     0 31166.0727    0  451 16987.4198 31166.0727  83.5%     -  733s
     0     0 31161.2428    0  449 16987.4198 31161.2428  83.4%     -  736s
     0     0 31160.1524    0  459 16987.4198 31160.1524  83.4%     -  737s
     0     0 31115.6654    0  507 16987.4198 31115.6654  83.2%     -  744s
     0     0 31084.2111    0  452 16987.4198 31084.2111  83.0%     -  752s
     0     0 31075.0491    0  444 16987.4198 31075.0491  82.9%     -  755s
     0     0 31066.7777    0  455 16987.4198 31066.7777  82.9%     -  758s
     0     0 31058.4468    0  509 16987.4198 31058.4468  82.8%     -  761s
     0     0 31056.6841    0  462 16987.4198 31056.6841  82.8%     -  763s
     0     0 31024.5890    0  474 16987.4198 31024.5890  82.6%     -  772s
     0     0 31016.1930    0  472 16987.4198 31016.1930  82.6%     -  776s
     0     0 31012.2313    0  479 16987.4198 31012.2313  82.6%     -  778s
     0     0 30991.6686    0  464 16987.4198 30991.6686  82.4%     -  785s
     0     0 30989.2513    0  455 16987.4198 30989.2513  82.4%     -  790s
     0     0 30980.0515    0  478 16987.4198 30980.0515  82.4%     -  795s
     0     0 30980.0234    0  478 16987.4198 30980.0234  82.4%     -  799s
H    0     0                    17002.068340 30980.0135  82.2%     -  916s
H    0     0                    17077.888210 30980.0135  81.4%     -  921s
H    0     0                    17134.386170 30980.0135  80.8%     -  922s
H    0     0                    17307.818624 30980.0135  79.0%     -  922s
H    0     0                    17581.941115 30980.0135  76.2%     -  922s
H    0     0                    17606.460443 30980.0135  76.0%     -  924s
H    0     0                    17662.364845 30980.0135  75.4%     -  924s
H    0     0                    17694.361627 30980.0135  75.1%     -  924s
H    0     2                    17739.149202 30980.0135  74.6%     -  939s
     0     2 30980.0135    0  478 17739.1492 30980.0135  74.6%     -  939s
     1     4 30904.2580    1  463 17739.1492 30980.0135  74.6%  9433  949s
     3     8 30811.3245    2  446 17739.1492 30925.8343  74.3%  7988  959s
     7    16 30491.7670    3  456 17739.1492 30809.9759  73.7%  9274  983s
    15    32 29949.0581    4  469 17739.1492 30549.0798  72.2% 13586 1010s
    31    48 29274.0945    5  431 17739.1492 30139.9668  69.9% 19993 2166s
    47    80 28110.2112    6  350 17739.1492 30139.9668  69.9% 22823 2203s
H   48    80                    17801.587752 30139.9668  69.3% 22348 2203s
H   55    80                    17822.173249 30139.9668  69.1% 21475 2203s
    79   143 27860.3528    7  339 17822.1732 30139.9668  69.1% 18483 2314s
   142   174 27353.3588    9  339 17822.1732 30139.9668  69.1% 15065 2356s
   173   207 27474.7080    8  325 17822.1732 30139.9668  69.1% 13303 2405s
   206   241 27559.2811    9  391 17822.1732 30139.9668  69.1% 12360 2438s
H  223   241                    17822.416344 30139.9668  69.1% 11919 2438s
H  234   241                    17846.440446 30139.9668  68.9% 11651 2438s
   240   376 27040.8041   10  387 17846.4404 30139.9668  68.9% 11584 2476s
   375   479 27011.8218    9  319 17846.4404 30139.9668  68.9%  9514 2502s
   478   571 27140.4192   12  367 17846.4404 30139.9668  68.9%  8696 2530s
   570   652 26934.3634   11  391 17846.4404 30139.9668  68.9%  8129 2562s
   651   751 26845.5204   12  294 17846.4404 30139.9668  68.9%  7795 2579s
   750   851 26661.8253   13  297 17846.4404 30139.9668  68.9%  7361 2596s
   850   883 26442.6826   13  331 17846.4404 30139.9668  68.9%  7020 2607s
   882   933 26524.6885   13  329 17846.4404 30139.9668  68.9%  6953 2617s
H  888   933                    17856.815132 30139.9668  68.8%  6927 2617s
H  929   933                    17882.646271 30139.9668  68.5%  6838 2617s
   932  1046 26522.1368   13  295 17882.6463 30139.9668  68.5%  6834 2630s
  1051  1162 26848.0724   14  413 17882.6463 30139.9668  68.5%  6568 2646s
  1185  1270 26232.9923   14  320 17882.6463 30139.9668  68.5%  6273 2665s
  1325  1364 25851.9349   14  317 17882.6463 30139.9668  68.5%  6019 2682s
  1465  1479 25388.5215   15  262 17882.6463 30139.9668  68.5%  5841 2699s
  1600  1574 25134.6879   16  306 17882.6463 30139.9668  68.5%  5671 2716s
  1767  1574 24657.3954   18  309 17882.6463 30139.9668  68.5%  5427 2738s
  1877  1581 24146.9584   19  277 17882.6463 30139.9668  68.5%  5381 2759s
  1941  1597 20341.1965   19  286 17882.6463 30139.9668  68.5%  5481 2780s
  1983  1642 18895.6235   20  232 17882.6463 30139.9668  68.5%  5571 2802s
  2070  1665 20167.5509   20  286 17882.6463 30139.9668  68.5%  5571 2825s
  2173  1704 20027.3691   21  232 17882.6463 30139.9668  68.5%  5517 2846s
  2244  1769 19862.0825   22  213 17882.6463 30139.9668  68.5%  5599 2869s
  2339  1828 19383.6654   23  208 17882.6463 30139.9668  68.5%  5641 2892s
  2450  1905     cutoff   23      17882.6463 30139.9668  68.5%  5638 2917s
  2583  1961     cutoff   48      17882.6463 30139.9668  68.5%  5574 2943s
  2719  2019 18982.8907   21  160 17882.6463 30139.9668  68.5%  5502 2970s
  2829  2077 18219.2876   23  221 17882.6463 30139.9668  68.5%  5507 2999s
  2981  2150 19358.0211   23  226 17882.6463 30113.0920  68.4%  5486 3029s
  3100  2260 18731.1700   28  198 17882.6463 30113.0920  68.4%  5519 3060s
  3257  2385 18180.6682   35  147 17882.6463 29986.9046  67.7%  5525 3090s
  3486  2451     cutoff   47      17882.6463 29986.9046  67.7%  5431 3123s
  3673  2525     cutoff   66      17882.6463 29949.0183  67.5%  5430 3156s
  3813  2623 28819.7622    6  396 17882.6463 29775.3696  66.5%  5551 3189s
  3991  2707 24173.5870    7  335 17882.6463 29775.3696  66.5%  5610 3223s
  4125  2821 23175.6204    9  325 17882.6463 29775.3696  66.5%  5727 3259s
  4306  2822 23491.0163   34  478 17882.6463 29571.6705  65.4%  5827 3482s
  4308  2823 23926.9601   45  203 17882.6463 29571.6705  65.4%  5824 3500s
  4309  2824 19646.5223   77  359 17882.6463 29571.6705  65.4%  5823 3566s

Cutting planes:
  Learned: 2
  Gomory: 54
  Implied bound: 58
  Projected implied bound: 194
  MIR: 987
  Mixing: 26
  Flow cover: 694
  RLT: 47
  Relax-and-lift: 210

Explored 4309 nodes (26048280 simplex iterations) in 3600.08 seconds (7759.80 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17882.6 17856.8 17846.4 ... 17606.5

Time limit reached
Best objective 1.788264627147e+04, best bound 2.957167046444e+04, gap 65.3652%
  WARNING: Time limit reached. Using best solution found (gap: 65.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 17882.65, θ = 170596.69
  Upper Bound (UB) = 17882.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170596.69
  [DEBUG]   ✓ Scenario 0: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170596.69 ≤ Q = 170596.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170596.69 ≤ Q = 170596.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170596.69 ≤ Q = 170596.69 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x39ddd5b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x39ddd5b5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.257078e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 7013038.0556
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.385564e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138556.37    0  122 7013038.06 -138556.37   102%     -    0s
H    0     0                    -101945.1551 -138556.37  35.9%     -    0s
H    0     0                    -103566.5505 -138556.37  33.8%     -    0s
     0     0 -112788.96    0   70 -103566.55 -112788.96  8.90%     -    0s
H    0     0                    -110719.4650 -112782.44  1.86%     -    0s
H    0     0                    -111390.8121 -112348.36  0.86%     -    0s
     0     0 -112348.36    0   62 -111390.81 -112348.36  0.86%     -    0s
     0     0 -112212.20    0   64 -111390.81 -112212.20  0.74%     -    0s
     0     0 -112193.51    0   64 -111390.81 -112193.51  0.72%     -    0s
     0     2 -112193.51    0   64 -111390.81 -112193.51  0.72%     -    0s
H  337    83                    -111427.5429 -111620.06  0.17%   4.6    0s
* 1048    91              40    -111441.1995 -111567.02  0.11%   3.9    0s
H 1081    66                    -111447.8956 -111567.02  0.11%   3.9    0s
H 1121    66                    -111449.9749 -111567.02  0.11%   3.8    0s
* 1285    37              43    -111458.9738 -111553.94  0.09%   3.7    0s
* 1434     6              43    -111459.9859 -111509.18  0.04%   3.5    0s
* 1435     6              43    -111460.7504 -111509.18  0.04%   3.5    0s
* 1444     6              42    -111470.9062 -111509.18  0.03%   3.5    0s
* 1475     6              41    -111472.2846 -111490.95  0.02%   3.5    0s

Cutting planes:
  Gomory: 29
  Implied bound: 4
  MIR: 164
  Flow cover: 2
  RLT: 2

Explored 1494 nodes (5779 simplex iterations) in 0.14 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -111472 -111472 -111471 ... -111428
No other solutions better than -111472

Optimal solution found (tolerance 1.00e-06)
Best objective -1.114722846166e+05, best bound -1.114722846166e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 165179.49
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111472.28
  [DEBUG]   S×d_nominal = 276651.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276651.77 + -111472.28 = 165179.49
  [DEBUG]   Current θ from Master = 170596.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5417.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12465.45
  Lower Bound (LB) = 12465.45
  Gap (UB-LB) = 5417.1972, Absolute Gap = 5417.1972, Relative Gap = 0.302930
  Not converged yet (gap = 5417.20 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567834 nonzeros
Model fingerprint: 0xc2acf111
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81406 rows and 33046 columns
Presolve time: 1.68s
Presolved: 118747 rows, 50334 columns, 728993 nonzeros
Variable types: 48075 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 4.700e+06
 Factor NZ  : 1.105e+07 (roughly 160 MB of memory)
 Factor Ops : 2.611e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73154999e+07  2.07010565e+08  1.19e+05 2.01e+01  8.17e+04     3s
   1  -1.31300708e+07  1.83979655e+08  8.22e+04 7.31e+01  5.55e+04     3s
   2  -5.74297818e+06  1.46690604e+08  3.46e+04 6.91e-01  2.45e+04     3s
   3  -8.69434749e+05  1.10286448e+08  1.94e+03 1.70e+00  1.82e+03     3s
   4  -5.51283931e+05  3.95593492e+07  4.38e+02 2.82e-01  4.38e+02     3s
   5  -4.17881829e+05  2.82783007e+07  1.20e+02 1.81e-01  1.97e+02     3s
   6  -3.45954569e+05  1.99624751e+07  5.86e+01 1.18e-01  1.21e+02     3s
   7  -2.46648924e+05  1.59327033e+07  2.40e+01 9.06e-02  8.45e+01     3s
   8  -1.45227605e+05  1.19150090e+07  9.21e+00 6.57e-02  5.87e+01     3s
   9  -1.24403873e+05  8.27686146e+06  6.65e+00 4.48e-02  4.03e+01     3s
  10  -1.04797007e+05  4.34325248e+06  4.12e+00 2.29e-02  2.11e+01     4s
  11  -8.51369443e+04  1.31301581e+06  2.11e+00 6.47e-03  6.55e+00     4s
  12  -4.93185781e+04  4.84385187e+05  9.73e-01 2.16e-03  2.48e+00     4s
  13  -2.78602189e+04  3.75023517e+05  6.14e-01 1.75e-03  1.87e+00     4s
  14  -7.26552948e+03  2.44959901e+05  3.78e-01 1.38e-03  1.17e+00     4s
  15  -2.71880021e+03  2.23055640e+05  3.34e-01 1.41e-03  1.04e+00     4s
  16   5.03429076e+03  1.51448807e+05  2.65e-01 2.80e-03  6.78e-01     4s
  17   1.53684307e+04  1.19709910e+05  1.88e-01 2.34e-03  4.83e-01     4s
  18   2.02508468e+04  9.78019145e+04  1.55e-01 2.68e-03  3.59e-01     4s
  19   2.51731572e+04  8.34023934e+04  1.22e-01 4.70e-03  2.70e-01     4s
  20   2.87879080e+04  7.86463408e+04  9.90e-02 4.16e-03  2.31e-01     4s
  21   3.25809812e+04  7.27287753e+04  7.72e-02 3.31e-03  1.86e-01     4s
  22   3.53140242e+04  6.52287558e+04  6.18e-02 2.27e-03  1.38e-01     4s
  23   3.70614475e+04  6.02526663e+04  5.26e-02 1.91e-03  1.07e-01     4s
  24   3.97082000e+04  5.79776247e+04  3.98e-02 1.72e-03  8.46e-02     4s
  25   4.13638169e+04  5.55820716e+04  3.20e-02 1.45e-03  6.58e-02     4s
  26   4.32911368e+04  5.41829179e+04  2.33e-02 1.34e-03  5.04e-02     4s
  27   4.40460796e+04  5.27031795e+04  2.00e-02 1.38e-03  4.01e-02     4s
  28   4.52839396e+04  5.19317364e+04  1.47e-02 1.09e-03  3.08e-02     4s
  29   4.59214177e+04  5.10072536e+04  1.19e-02 7.82e-04  2.35e-02     4s
  30   4.68184962e+04  5.02277387e+04  8.10e-03 4.06e-04  1.58e-02     4s
  31   4.71638534e+04  4.97626629e+04  6.68e-03 2.71e-04  1.20e-02     5s
  32   4.74444628e+04  4.96497177e+04  5.54e-03 2.35e-04  1.02e-02     5s
  33   4.75249242e+04  4.94755354e+04  5.22e-03 1.87e-04  9.04e-03     5s
  34   4.77657727e+04  4.93346015e+04  4.26e-03 1.65e-04  7.27e-03     5s
  35   4.78771360e+04  4.92707767e+04  3.80e-03 1.40e-04  6.46e-03     5s
  36   4.81875234e+04  4.92027547e+04  2.59e-03 1.20e-04  4.70e-03     5s
  37   4.83452908e+04  4.91193651e+04  2.00e-03 8.91e-05  3.59e-03     5s
  38   4.84503242e+04  4.90259822e+04  1.57e-03 5.57e-05  2.67e-03     5s
  39   4.85250140e+04  4.89581567e+04  1.28e-03 5.53e-05  2.01e-03     5s
  40   4.86726581e+04  4.89091711e+04  7.13e-04 2.46e-05  1.10e-03     5s
  41   4.87295161e+04  4.89013201e+04  4.94e-04 1.98e-05  7.97e-04     5s
  42   4.87633293e+04  4.88847139e+04  3.68e-04 9.81e-06  5.63e-04     5s
  43   4.88071174e+04  4.88737861e+04  2.07e-04 3.51e-06  3.09e-04     5s
  44   4.88307124e+04  4.88694208e+04  1.24e-04 1.39e-06  1.80e-04     5s
  45   4.88523708e+04  4.88683417e+04  4.67e-05 1.56e-06  7.41e-05     5s
  46   4.88603960e+04  4.88676420e+04  1.87e-05 9.29e-07  3.36e-05     5s
  47   4.88640948e+04  4.88669714e+04  6.85e-06 4.97e-07  1.33e-05     6s
  48   4.88661236e+04  4.88662432e+04  1.00e-07 8.82e-08  5.53e-07     6s
  49   4.88661354e+04  4.88662348e+04  4.13e-07 7.33e-08  4.60e-07     6s
  50   4.88661753e+04  4.88662260e+04  8.80e-07 5.77e-08  2.34e-07     6s
  51   4.88661948e+04  4.88661966e+04  6.82e-08 1.45e-08  7.96e-09     6s
  52   4.88661964e+04  4.88661965e+04  1.10e-06 8.28e-08  4.30e-10     6s

Barrier solved model in 52 iterations and 5.87 seconds (10.63 work units)
Optimal objective 4.88661964e+04


Root crossover log...

  102281 DPushes remaining with DInf 0.0000000e+00                 6s
    1225 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    5052 PPushes remaining with PInf 3.8619541e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7668282e+01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53333    4.8866197e+04   0.000000e+00   3.766828e+01     11s
   53378    4.8866197e+04   0.000000e+00   0.000000e+00     11s
   53378    4.8866197e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 3.51s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.886620e+04, 53378 iterations, 12.48 seconds (22.00 work units)
Total elapsed time = 15.04s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48866.1965    0  269 -233202.98 48866.1965   121%     -   15s
H    0     0                    -165921.4698 48866.1965   129%     -   15s
H    0     0                    -145255.9497 48866.1965   134%     -   16s
H    0     0                    -131116.4100 48866.1965   137%     -   16s
H    0     0                    -128227.4719 48866.1965   138%     -   16s
H    0     0                    -126516.8552 48866.1965   139%     -   16s
H    0     0                    -125308.9301 48866.1965   139%     -   16s
H    0     0                    -125097.8791 48866.1965   139%     -   16s
H    0     0                    -124590.0063 48866.1965   139%     -   16s
H    0     0                    -85374.88366 48866.1965   157%     -   16s
H    0     0                    -85355.96507 48866.1965   157%     -   17s
H    0     0                    -50795.91253 48866.1965   196%     -   17s
H    0     0                    -50640.85155 48866.1965   196%     -   17s
H    0     0                    -44430.97745 48866.1965   210%     -   17s
H    0     0                    -44081.44772 48866.1965   211%     -   17s
H    0     0                    -43875.84622 48866.1965   211%     -   17s
H    0     0                    -36796.15230 48866.1965   233%     -   17s
H    0     0                    -36630.07383 48866.1965   233%     -   19s
H    0     0                    -6750.186350 48866.1965   824%     -   19s
H    0     0                    -5472.825798 48866.1965   993%     -   19s
H    0     0                    -5392.445903 48866.1965  1006%     -   19s
H    0     0                    -5280.889757 48866.1965  1025%     -   19s
H    0     0                    1978.1172695 42411.2261  2044%     -   52s
H    0     0                    2103.7316057 42411.2261  1916%     -   52s
H    0     0                    2505.5121161 42411.2261  1593%     -   52s
H    0     0                    2532.6867598 42411.2261  1575%     -   52s
H    0     0                    2585.0551612 42411.2261  1541%     -   52s
H    0     0                    3542.3745811 42411.2261  1097%     -   52s
H    0     0                    3551.6526801 42411.2261  1094%     -   52s
H    0     0                    3658.6582034 42411.2261  1059%     -   52s
H    0     0                    3673.1985169 42411.2261  1055%     -   52s
H    0     0                    3890.5693448 42411.2261   990%     -   52s
     0     0 42324.9043    0  265 3890.56934 42324.9043   988%     -   53s
H    0     0                    4019.7553168 42324.9043   953%     -   54s
H    0     0                    4170.3940904 42324.9043   915%     -   54s
H    0     0                    4323.3524629 42324.9043   879%     -   54s
H    0     0                    4553.4358112 42324.9043   830%     -   54s
     0     0 41484.8479    0  287 4553.43581 41484.8479   811%     -   69s
     0     0 41368.4517    0  282 4553.43581 41368.4517   809%     -   83s
     0     0 41368.4517    0  289 4553.43581 41368.4517   809%     -   90s
     0     0 41356.9536    0  291 4553.43581 41356.9536   808%     -   92s
     0     0 41354.8771    0  300 4553.43581 41354.8771   808%     -   93s
     0     0 41342.7929    0  293 4553.43581 41342.7929   808%     -   95s
     0     0 41341.9541    0  300 4553.43581 41341.9541   808%     -   96s
     0     0 41240.8886    0  296 4553.43581 41240.8886   806%     -  101s
     0     0 41237.5984    0  293 4553.43581 41237.5984   806%     -  102s
     0     0 41237.5984    0  293 4553.43581 41237.5984   806%     -  102s
H    0     0                    4974.3192721 37682.4796   658%     -  148s
     0     0 37682.4796    0  319 4974.31927 37682.4796   658%     -  148s
H    0     0                    13050.659261 37682.0153   189%     -  148s
H    0     0                    14099.972581 37682.0153   167%     -  148s
H    0     0                    14161.650888 37682.0153   166%     -  149s
H    0     0                    14314.997728 37682.0153   163%     -  149s
H    0     0                    14320.616713 37682.0153   163%     -  149s
H    0     0                    14369.963528 37682.0153   162%     -  149s
H    0     0                    14409.471087 37682.0153   162%     -  149s
     0     0 36977.2083    0  324 14409.4711 36977.2083   157%     -  174s
     0     0 36619.9457    0  376 14409.4711 36619.9457   154%     -  192s
     0     0 36471.3590    0  375 14409.4711 36471.3590   153%     -  203s
     0     0 36402.5055    0  398 14409.4711 36402.5055   153%     -  212s
     0     0 36160.7809    0  420 14409.4711 36160.7809   151%     -  230s
     0     0 36138.4183    0  421 14409.4711 36138.4183   151%     -  235s
     0     0 36130.7163    0  425 14409.4711 36130.7163   151%     -  237s
     0     0 36125.2071    0  427 14409.4711 36125.2071   151%     -  239s
     0     0 36120.8923    0  430 14409.4711 36120.8923   151%     -  241s
     0     0 36102.1054    0  414 14409.4711 36102.1054   151%     -  245s
     0     0 36101.0775    0  414 14409.4711 36101.0775   151%     -  246s
     0     0 33403.2633    0  404 14409.4711 33403.2633   132%     -  303s
H    0     0                    14758.392395 33402.8705   126%     -  304s
H    0     0                    14815.703861 33402.8705   125%     -  304s
H    0     0                    14986.050621 33402.8705   123%     -  304s
H    0     0                    15101.553858 33402.8705   121%     -  304s
H    0     0                    15266.355744 33402.8705   119%     -  304s
H    0     0                    15359.166875 33402.8705   117%     -  304s
H    0     0                    15443.516499 33402.8705   116%     -  304s
H    0     0                    15499.049005 33402.8705   116%     -  304s
     0     0 33084.8821    0  420 15499.0490 33084.8821   113%     -  328s
     0     0 32975.3569    0  418 15499.0490 32975.3569   113%     -  339s
     0     0 32883.4938    0  459 15499.0490 32883.4938   112%     -  345s
     0     0 32771.3067    0  419 15499.0490 32771.3067   111%     -  354s
     0     0 32667.8629    0  419 15499.0490 32667.8629   111%     -  365s
     0     0 32651.9750    0  428 15499.0490 32651.9750   111%     -  368s
     0     0 32642.7035    0  438 15499.0490 32642.7035   111%     -  370s
     0     0 32640.2814    0  432 15499.0490 32640.2814   111%     -  371s
     0     0 32639.1650    0  429 15499.0490 32639.1650   111%     -  372s
     0     0 31793.6443    0  464 15499.0490 31793.6443   105%     -  404s
     0     0 31504.4049    0  462 15499.0490 31504.4049   103%     -  416s
     0     0 31396.9723    0  430 15499.0490 31396.9723   103%     -  424s
     0     0 31376.8882    0  443 15499.0490 31376.8882   102%     -  428s
     0     0 31364.3247    0  425 15499.0490 31364.3247   102%     -  431s
     0     0 31354.4973    0  435 15499.0490 31354.4973   102%     -  433s
     0     0 31328.0610    0  443 15499.0490 31328.0610   102%     -  437s
     0     0 31311.8127    0  451 15499.0490 31311.8127   102%     -  440s
     0     0 31300.7755    0  455 15499.0490 31300.7755   102%     -  440s
     0     0 31292.3407    0  470 15499.0490 31292.3407   102%     -  441s
     0     0 31280.6694    0  465 15499.0490 31280.6694   102%     -  444s
     0     0 31279.6478    0  468 15499.0490 31279.6478   102%     -  445s
     0     0 31159.3194    0  447 15499.0490 31159.3194   101%     -  455s
     0     0 31110.1457    0  450 15499.0490 31110.1457   101%     -  460s
     0     0 31067.4656    0  494 15499.0490 31067.4656   100%     -  466s
     0     0 31053.2747    0  497 15499.0490 31053.2747   100%     -  469s
     0     0 31046.0315    0  502 15499.0490 31046.0315   100%     -  471s
     0     0 31045.2748    0  505 15499.0490 31045.2748   100%     -  473s
     0     0 31005.7828    0  485 15499.0490 31005.7828   100%     -  483s
H    0     0                    15502.894363 31004.3130   100%     -  484s
     0     0 30984.7979    0  492 15502.8944 30984.7979   100%     -  489s
     0     0 30952.4957    0  428 15502.8944 30952.4957   100%     -  493s
H    0     0                    15675.464206 30945.6702  97.4%     -  496s
H    0     0                    15786.584626 30945.6702  96.0%     -  496s
     0     0 30945.6702    0  485 15786.5846 30945.6702  96.0%     -  496s
     0     0 30942.0686    0  492 15786.5846 30942.0686  96.0%     -  497s
     0     0 30939.8452    0  491 15786.5846 30939.8452  96.0%     -  498s
     0     0 30910.3060    0  447 15786.5846 30910.3060  95.8%     -  505s
H    0     0                    16241.084293 30910.0449  90.3%     -  506s
     0     0 30907.8037    0  447 16241.0843 30907.8037  90.3%     -  507s
     0     0 30896.6321    0  425 16241.0843 30896.6321  90.2%     -  512s
     0     0 30890.3117    0  433 16241.0843 30890.3117  90.2%     -  515s
     0     0 30889.1979    0  437 16241.0843 30889.1979  90.2%     -  517s
     0     0 30860.5045    0  477 16241.0843 30860.5045  90.0%     -  523s
     0     0 30857.4187    0  440 16241.0843 30857.4187  90.0%     -  525s
     0     0 30855.5081    0  433 16241.0843 30855.5081  90.0%     -  527s
     0     0 30846.5030    0  479 16241.0843 30846.5030  89.9%     -  531s
     0     0 30845.8464    0  486 16241.0843 30845.8464  89.9%     -  532s
     0     0 30838.4829    0  442 16241.0843 30838.4829  89.9%     -  536s
     0     0 30838.0484    0  442 16241.0843 30838.0484  89.9%     -  540s
H    0     0                    16506.277327 30838.0484  86.8%     -  629s
     0     2 30838.0484    0  442 16506.2773 30838.0484  86.8%     -  631s
     1     3 30580.6640    1  455 16506.2773 30838.0484  86.8% 11717  643s
     2     4 30517.6585    1  424 16506.2773 30579.4450  85.3% 12697  655s
     3     7 29875.6652    2  412 16506.2773 30578.9229  85.3% 11465  670s
     6    14 30025.7532    3  452 16506.2773 30511.7969  84.8% 11372  687s
    13    28 29954.1206    4  440 16506.2773 30158.4883  82.7% 10677  714s
    27    42 28231.7716    5  387 16506.2773 30072.5815  82.2% 15987  762s
    41    74 28339.4133    6  424 16506.2773 30072.5815  82.2% 18179  875s
H   42    74                    16690.479460 30072.5815  80.2% 17746  875s
H   44    74                    16745.991892 30072.5815  79.6% 17639  875s
H   46    74                    17144.813742 30072.5815  75.4% 17381  875s
    73   169 28263.0536    7  405 17144.8137 29772.7451  73.7% 17828  927s
   168   249 28172.5215    9  407 17144.8137 29772.7451  73.7% 10857  953s
H  170   249                    17341.525044 29772.7451  71.7% 10740  953s
H  172   249                    17474.837210 29772.7451  70.4% 10632  953s
   248   324 28082.0378   12  356 17474.8372 29772.7451  70.4%  8392  975s
   323   353 28209.0285   11  416 17474.8372 29772.7451  70.4%  7368  995s
   352   390 28154.1763   10  398 17474.8372 29772.7451  70.4%  7296 1033s
   389   431 26795.9121   10  341 17474.8372 29772.7451  70.4%  7196 1071s
   430   474 28011.2557   11  383 17474.8372 29772.7451  70.4%  7060 1089s
   473   515 28107.6584   12  399 17474.8372 29772.7451  70.4%  6885 1105s
   514   562 27909.7644   12  405 17474.8372 29772.7451  70.4%  6744 1121s
   561   606 27934.7733   13  382 17474.8372 29772.7451  70.4%  6630 1136s
   605   650 27746.0617   12  359 17474.8372 29772.7451  70.4%  6619 1152s
   649   694 27722.4605   13  402 17474.8372 29772.7451  70.4%  6653 1168s
H  667   694                    17542.503337 29772.7451  69.7%  6626 1168s
   693   794 27674.3975   12  377 17542.5033 29772.7451  69.7%  6671 1185s
   793   886 27874.1145   13  404 17542.5033 29772.7451  69.7%  6370 1200s
   887  1008 27803.2124   14  358 17542.5033 29772.7451  69.7%  6209 1215s
  1013  1085 27684.3076   17  380 17542.5033 29772.7451  69.7%  5848 1230s
  1096  1171 26573.4296   16  299 17542.5033 29772.7451  69.7%  5823 1245s
  1194  1282 27572.7640   18  376 17542.5033 29772.7451  69.7%  5744 1262s
  1325  1404 25185.9047   18  347 17542.5033 29772.7451  69.7%  5545 1283s
  1459  1464 27406.7560   19  380 17542.5033 29772.7451  69.7%  5310 1303s
  1571  1485 27345.4605   20  326 17542.5033 29772.7451  69.7%  5315 1324s
  1608  1541 21013.9455   19  259 17542.5033 29772.7451  69.7%  5350 1342s
  1690  1554 17854.2291   30  266 17542.5033 29772.7451  69.7%  5337 1363s
  1727  1568 22617.0514   20  337 17542.5033 29772.7451  69.7%  5415 1387s
  1788  1587 21952.3493   21  356 17542.5033 29643.8977  69.0%  5469 1412s
  1859  1628 21641.0724   21  262 17542.5033 29643.8977  69.0%  5510 1436s
  1956  1665 21367.7889   23  300 17542.5033 29643.8977  69.0%  5524 1458s
  2043  1704 21126.9487   25  264 17542.5033 29643.8977  69.0%  5624 1484s
  2124  1751 20720.4252   28  236 17542.5033 29643.8977  69.0%  5737 1511s
  2203  1797 20135.9969   29  231 17542.5033 29643.8977  69.0%  5837 1537s
  2285  1839 19696.4765   32  218 17542.5033 29643.8977  69.0%  5939 1569s
  2383  1889 19619.6189   33  196 17542.5033 29643.8977  69.0%  6021 1604s
  2508  1930 18776.8410   39  158 17542.5033 29643.8977  69.0%  6025 1635s
  2646  1985 18371.1509   41  130 17542.5033 29643.8977  69.0%  6052 1671s
  2755  2010 18311.7495   48  145 17542.5033 29292.7368  67.0%  6107 1703s
H 2769  2010                    17570.887591 29292.7368  66.7%  6121 1703s
  2792  2084 18296.6256   49  140 17570.8876 29292.7368  66.7%  6198 1737s
  2896  2174     cutoff   58      17570.8876 28945.1559  64.7%  6324 1773s
  3048  2245 23253.3765    7  307 17570.8876 28945.1559  64.7%  6380 1810s
  3193  2324 21338.2982    9  325 17570.8876 28945.1559  64.7%  6451 1849s
  3348  2395 21679.0261    9  258 17570.8876 28945.1559  64.7%  6495 1889s
  3547  2450 20490.4228   12  304 17570.8876 28945.1559  64.7%  6476 1931s
  3726  2532 19907.1317   19  232 17570.8876 28772.8533  63.8%  6501 1976s
  3880  2575 19710.4655   27  131 17570.8876 28772.8533  63.8%  6600 2015s
  3935  2635 19672.5654   31  175 17570.8876 28772.8533  63.8%  6661 2055s
  4043  2689 19572.4203   37   41 17570.8876 28772.8533  63.8%  6720 2098s
H 4048  2663                    17796.522858 28772.8533  61.7%  6713 2098s
  4135  2823 19478.8572   42  117 17796.5229 28672.8219  61.1%  6765 2144s
  4380  2824 19663.3116   34  442 17796.5229 28672.8219  61.1%  6751 2373s
  4382  2825 19764.4665   63  196 17796.5229 28672.8219  61.1%  6748 2393s
H 4382  2683                    18106.180145 28672.8219  58.4%  6748 2476s
  4384  2685 18106.1801   34  396 18106.1801 28672.8219  58.4%  6745 2535s
  4385  2685 25997.1356   10  370 18106.1801 28672.8219  58.4%  6743 2569s
  4386  2686 18405.3086   35  395 18106.1801 28672.8219  58.4%  6742 2599s
  4387  2687 26246.1593   21  404 18106.1801 28672.8219  58.4%  6740 2615s
  4388  2687 25843.2658   19  402 18106.1801 28672.8219  58.4%  6739 2633s
  4389  2688 18793.3604   19  458 18106.1801 28672.8219  58.4%  6737 2644s
  4390  2689 18608.5633   65  471 18106.1801 28672.8219  58.4%  6736 2655s
  4391  2689 22446.1155   14  489 18106.1801 28672.8219  58.4%  6734 2668s
  4392  2690 22935.1769   16  482 18106.1801 28672.8219  58.4%  6732 2678s
  4393  2691 23779.6818   31  416 18106.1801 28672.8219  58.4%  6731 2686s
  4394  2691 26670.3721   29  480 18106.1801 28672.8219  58.4%  6729 2693s
H 4394  2556                    18167.540163 28672.8219  57.8%  6729 2713s
H 4394  2428                    18200.457075 28672.8219  57.5%  6729 2713s
  4396  2430 27921.5039   11  436 18200.4571 28672.8219  57.5%  6726 2721s
  4397  2430 27569.2714   19  429 18200.4571 28672.8219  57.5%  6725 2730s
  4398  2431 28065.0124   18  435 18200.4571 28672.8219  57.5%  6723 2738s
  4399  2432 24576.0048   27  453 18200.4571 28672.8219  57.5%  6722 2745s
  4400  2432 22488.0423   15  485 18200.4571 28672.8219  57.5%  6720 2766s
  4401  2433 21960.3586   30  453 18200.4571 28672.8219  57.5%  6719 2770s
  4402  2434 18466.9940   22  446 18200.4571 28672.8219  57.5%  6717 2775s
  4403  2434 21779.4700    8  479 18200.4571 28672.8219  57.5%  6716 2780s
  4404  2435 21321.9524   25  535 18200.4571 28672.8219  57.5%  6714 2794s
  4405  2436 20637.8003   39  531 18200.4571 28672.8219  57.5%  6713 2800s
  4406  2436 20123.0710   46  536 18200.4571 28672.8219  57.5%  6711 2808s
  4407  2437 18200.4571   42  486 18200.4571 28672.8219  57.5%  6710 2819s
  4408  2438 24241.6074   52  463 18200.4571 28672.8219  57.5%  6708 2825s
  4409  2438 25958.9131   17  456 18200.4571 28672.8219  57.5%  6706 2835s
  4410  2439 20904.6308   36  451 18200.4571 28672.8219  57.5%  6705 2842s
  4411  2440 18200.4571   34  434 18200.4571 28672.8219  57.5%  6703 2856s
  4412  2440 22818.6623   68  452 18200.4571 28672.8219  57.5%  6702 2861s
  4413  2441 19684.6210   15  457 18200.4571 28672.8219  57.5%  6700 2869s
  4414  2442 24754.1585   30  456 18200.4571 28672.8219  57.5%  6699 2873s
  4415  2442 24627.6128    8  442 18200.4571 28672.8219  57.5%  6697 2883s
  4416  2443 27350.8395   15  435 18200.4571 28672.8219  57.5%  6696 2888s
  4417  2444 27758.0533   20  446 18200.4571 28672.8219  57.5%  6694 2895s
  4418  2444 18409.8263   22  446 18200.4571 28672.8219  57.5%  6693 2921s
  4419  2445 24029.2288   11  446 18200.4571 28672.8219  57.5%  6691 3000s
  4420  2448 28672.8219   12  405 18200.4571 28672.8219  57.5%  6773 3039s
  4421  2450 28576.6104   13  323 18200.4571 28672.8219  57.5%  6775 3057s
  4424  2455 28520.3133   14  357 18200.4571 28672.8219  57.5%  6774 3091s
  4430  2465 27882.1298   15  329 18200.4571 28672.8219  57.5%  6783 3125s
  4442  2473 28672.8219   15  406 18200.4571 28672.8219  57.5%  6822 3198s
H 4454  2378                    18214.639824 28672.8219  57.4%  6852 3566s
H 4459  2261                    18252.474457 28672.8219  57.1%  6863 3566s
H 4461  2149                    18296.416170 28672.8219  56.7%  6865 3566s
  4486  2227 26881.4090   17  319 18296.4162 28672.8219  56.7%  7016 3600s

Cutting planes:
  Gomory: 8
  Implied bound: 23
  Projected implied bound: 84
  MIR: 1135
  Mixing: 3
  Flow cover: 1979
  RLT: 18
  Relax-and-lift: 237

Explored 4572 nodes (32673296 simplex iterations) in 3600.06 seconds (8629.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18296.4 18252.5 18214.6 ... 17474.8

Time limit reached
Best objective 1.829641617014e+04, best bound 2.867282185165e+04, gap 56.7128%
  WARNING: Time limit reached. Using best solution found (gap: 56.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 18296.42, θ = 166326.72
  Upper Bound (UB) = 18296.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166326.72
  [DEBUG]   ✓ Scenario 0: θ = 166326.72 ≤ Q = 166326.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166326.72 ≤ Q = 166326.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166326.72 ≤ Q = 166326.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166326.72 ≤ Q = 166326.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166326.72 ≤ Q = 166326.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 166326.72 ≤ Q = 166326.72 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x435d9769
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x435d9769
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.267845e+13
Presolve removed 2565 rows and 1855 columns
Presolve time: 0.01s
Presolved: 528 rows, 534 columns, 1491 nonzeros
Found heuristic solution: objective 6750340.1535
Variable types: 360 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6749579.9543

Root relaxation: objective -1.503513e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150351.26    0  121 6749579.95 -150351.26   102%     -    0s
H    0     0                    -100434.7209 -150351.26  49.7%     -    0s
H    0     0                    -101917.5557 -150351.26  47.5%     -    0s
H    0     0                    -102741.8375 -150351.26  46.3%     -    0s
H    0     0                    -112943.2034 -150351.26  33.1%     -    0s
H    0     0                    -119694.7010 -125447.27  4.81%     -    0s
     0     0 -125447.27    0   98 -119694.70 -125447.27  4.81%     -    0s
H    0     0                    -119910.1484 -125322.71  4.51%     -    0s
H    0     0                    -122105.4631 -125322.71  2.63%     -    0s
H    0     0                    -122320.9104 -125322.71  2.45%     -    0s
     0     0 -124342.25    0  102 -122320.91 -124342.25  1.65%     -    0s
H    0     0                    -122576.0959 -124342.25  1.44%     -    0s
     0     0 -124274.42    0  102 -122576.10 -124274.42  1.39%     -    0s
H    0     0                    -122603.9942 -124274.42  1.36%     -    0s
     0     0 -123736.66    0   73 -122603.99 -123736.66  0.92%     -    0s
     0     0 -123574.30    0   96 -122603.99 -123574.30  0.79%     -    0s
     0     0 -123557.44    0   85 -122603.99 -123557.44  0.78%     -    0s
     0     0 -123439.57    0   88 -122603.99 -123439.57  0.68%     -    0s
     0     0 -123433.24    0   85 -122603.99 -123433.24  0.68%     -    0s
     0     0 -123273.78    0   84 -122603.99 -123273.78  0.55%     -    0s
     0     0 -123271.28    0   84 -122603.99 -123271.28  0.54%     -    0s
     0     2 -123261.05    0   84 -122603.99 -123261.05  0.54%     -    0s
H   31    40                    -122922.5559 -123122.68  0.16%  19.0    0s
H   37    37                    -122991.3103 -123122.68  0.11%  17.8    0s
*   91    17               9    -122996.0165 -123064.18  0.06%  12.1    0s
*   98    17              10    -123021.3188 -123064.18  0.03%  11.4    0s

Cutting planes:
  Gomory: 32
  Implied bound: 3
  MIR: 203
  Flow cover: 8
  RLT: 13
  Relax-and-lift: 2
  BQP: 2

Explored 151 nodes (2125 simplex iterations) in 0.11 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123021 -122996 -122991 ... -102742
No other solutions better than -123021

Optimal solution found (tolerance 1.00e-06)
Best objective -1.230213187926e+05, best bound -1.230213187926e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 160090.55
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123021.32
  [DEBUG]   S×d_nominal = 283111.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283111.86 + -123021.32 = 160090.55
  [DEBUG]   Current θ from Master = 166326.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6236.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12060.24
  Lower Bound (LB) = 12465.45
  Gap (UB-LB) = 5830.9671, Absolute Gap = 5830.9671, Relative Gap = 0.318694
  Not converged yet (gap = 5830.97 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611089 nonzeros
Model fingerprint: 0x57b25b96
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87668 rows and 35588 columns
Presolve time: 2.46s
Presolved: 127775 rows, 54032 columns, 784527 nonzeros
Variable types: 51773 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 5.356e+06
 Factor NZ  : 1.236e+07 (roughly 170 MB of memory)
 Factor Ops : 2.687e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78562039e+07  2.20888329e+08  1.24e+05 1.96e+01  8.38e+04     4s
   1  -1.36057697e+07  1.97227965e+08  8.55e+04 7.26e+01  5.72e+04     4s
   2  -6.05389215e+06  1.57292760e+08  3.67e+04 7.22e-01  2.57e+04     4s
   3  -9.11430351e+05  1.19156788e+08  2.17e+03 1.74e+00  1.96e+03     4s
   4  -5.66911168e+05  4.32739912e+07  4.90e+02 2.86e-01  4.72e+02     4s
   5  -4.28772851e+05  3.30048739e+07  1.32e+02 1.91e-01  2.16e+02     4s
   6  -3.63909554e+05  2.17130254e+07  6.33e+01 1.16e-01  1.24e+02     4s
   7  -2.27063569e+05  1.75805509e+07  1.92e+01 9.04e-02  8.43e+01     4s
   8  -1.47303922e+05  1.32254646e+07  8.33e+00 6.63e-02  6.01e+01     4s
   9  -1.26299550e+05  8.45325429e+06  6.16e+00 4.14e-02  3.82e+01     5s
  10  -1.00456852e+05  4.27850172e+06  3.11e+00 2.02e-02  1.92e+01     5s
  11  -6.95068208e+04  2.72665592e+06  1.02e+00 1.27e-02  1.21e+01     5s
  12  -4.25229529e+04  8.12355110e+05  3.97e-01 3.68e-03  3.67e+00     5s
  13  -2.95418295e+04  3.56726409e+05  2.81e-01 1.55e-03  1.66e+00     5s
  14  -8.36984294e+03  2.34689011e+05  1.74e-01 1.56e-03  1.04e+00     5s
  15   1.57406597e+03  1.78663445e+05  1.35e-01 1.92e-03  7.60e-01     5s
  16   7.24777542e+03  1.50510611e+05  1.15e-01 2.12e-03  6.15e-01     5s
  17   1.61951170e+04  1.25871654e+05  8.51e-02 2.48e-03  4.71e-01     5s
  18   2.01480589e+04  1.03540692e+05  7.19e-02 2.43e-03  3.58e-01     5s
  19   2.48918574e+04  9.48477729e+04  5.71e-02 1.77e-03  3.00e-01     5s
  20   2.85808285e+04  7.79528689e+04  4.64e-02 1.70e-03  2.12e-01     5s
  21   3.24004937e+04  7.35097305e+04  3.63e-02 1.87e-03  1.76e-01     5s
  22   3.47222361e+04  6.58675998e+04  3.04e-02 1.78e-03  1.34e-01     5s
  23   3.70107886e+04  6.09057557e+04  2.49e-02 1.26e-03  1.03e-01     5s
  24   3.91630640e+04  5.75624790e+04  2.00e-02 9.40e-04  7.90e-02     5s
  25   4.13615395e+04  5.44593719e+04  1.52e-02 6.24e-04  5.62e-02     5s
  26   4.26822453e+04  5.34407983e+04  1.25e-02 5.05e-04  4.62e-02     5s
  27   4.32518062e+04  5.25774502e+04  1.13e-02 4.01e-04  4.01e-02     5s
  28   4.45992354e+04  5.13131625e+04  8.49e-03 4.60e-04  2.88e-02     6s
  29   4.52160054e+04  5.06762630e+04  7.24e-03 3.37e-04  2.35e-02     6s
  30   4.60259937e+04  5.00855561e+04  5.58e-03 2.20e-04  1.74e-02     6s
  31   4.64142319e+04  4.97032016e+04  4.76e-03 1.48e-04  1.41e-02     6s
  32   4.69480838e+04  4.95449567e+04  3.70e-03 1.15e-04  1.12e-02     6s
  33   4.73424693e+04  4.94140471e+04  2.95e-03 9.09e-05  8.90e-03     6s
  34   4.75636772e+04  4.93630806e+04  2.54e-03 8.20e-05  7.73e-03     6s
  35   4.77591102e+04  4.92455552e+04  2.15e-03 6.21e-05  6.39e-03     6s
  36   4.79421720e+04  4.91063838e+04  1.81e-03 3.72e-05  5.00e-03     6s
  37   4.82509400e+04  4.90288266e+04  1.20e-03 1.69e-05  3.34e-03     6s
  38   4.84605778e+04  4.89785858e+04  7.89e-04 1.08e-05  2.23e-03     6s
  39   4.85713279e+04  4.89381712e+04  5.83e-04 6.19e-06  1.58e-03     6s
  40   4.87120431e+04  4.89286540e+04  3.04e-04 5.06e-06  9.31e-04     6s
  41   4.87997257e+04  4.89048257e+04  1.50e-04 2.09e-06  4.52e-04     6s
  42   4.88223443e+04  4.88971412e+04  1.09e-04 1.15e-06  3.21e-04     6s
  43   4.88404958e+04  4.88943051e+04  7.70e-05 8.12e-07  2.31e-04     7s
  44   4.88465433e+04  4.88934342e+04  6.71e-05 7.46e-07  2.02e-04     7s
  45   4.88534073e+04  4.88928522e+04  5.53e-05 1.23e-06  1.70e-04     7s
  46   4.88585940e+04  4.88920453e+04  4.64e-05 1.03e-06  1.44e-04     7s
  47   4.88648225e+04  4.88913431e+04  3.62e-05 1.50e-06  1.14e-04     7s
  48   4.88654018e+04  4.88899812e+04  3.53e-05 1.15e-06  1.06e-04     7s
  49   4.88706007e+04  4.88895764e+04  2.69e-05 1.72e-06  8.15e-05     7s
  50   4.88726762e+04  4.88891751e+04  2.36e-05 1.25e-06  7.09e-05     7s
  51   4.88766833e+04  4.88885416e+04  1.70e-05 1.22e-06  5.10e-05     7s
  52   4.88789300e+04  4.88884697e+04  1.34e-05 1.07e-06  4.10e-05     7s
  53   4.88826591e+04  4.88873306e+04  7.24e-06 1.81e-07  2.01e-05     7s
  54   4.88859298e+04  4.88871630e+04  1.61e-06 2.33e-08  5.30e-06     7s
  55   4.88869546e+04  4.88870915e+04  1.60e-07 5.39e-09  5.89e-07     7s
  56   4.88870808e+04  4.88870809e+04  4.35e-08 5.17e-09  6.44e-10     8s

Barrier solved model in 56 iterations and 7.55 seconds (13.13 work units)
Optimal objective 4.88870808e+04


Root crossover log...

  109890 DPushes remaining with DInf 0.0000000e+00                 8s
   19989 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    7661 PPushes remaining with PInf 6.9201256e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.5529960e+02     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60636    4.8887081e+04   0.000000e+00   9.552996e+02     13s
   60756    4.8887081e+04   0.000000e+00   0.000000e+00     14s
   60756    4.8887081e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 6.26s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.888708e+04, 60756 iterations, 16.73 seconds (26.51 work units)
Total elapsed time = 20.18s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48887.0809    0  272 -233202.98 48887.0809   121%     -   20s
H    0     0                    -189741.6968 48887.0809   126%     -   21s
H    0     0                    -168643.7862 48887.0809   129%     -   21s
H    0     0                    -144770.2259 48887.0809   134%     -   21s
H    0     0                    -143531.3543 48887.0809   134%     -   21s
H    0     0                    -137828.3824 48887.0809   135%     -   21s
H    0     0                    -129016.2780 48887.0809   138%     -   21s
H    0     0                    -127391.2111 48887.0809   138%     -   21s
H    0     0                    -127255.9694 48887.0809   138%     -   21s
H    0     0                    -126850.2502 48887.0809   139%     -   21s
H    0     0                    -83204.59791 48887.0809   159%     -   21s
H    0     0                    -82348.46828 48887.0809   159%     -   22s
H    0     0                    -50154.09901 48887.0809   197%     -   22s
H    0     0                    -49521.25585 48887.0809   199%     -   22s
H    0     0                    -43509.45036 48887.0809   212%     -   22s
H    0     0                    -42038.49389 48887.0809   216%     -   22s
H    0     0                    -41888.54063 48887.0809   217%     -   22s
H    0     0                    -41881.42639 48887.0809   217%     -   22s
H    0     0                    -34801.73246 48887.0809   240%     -   22s
H    0     0                    -13190.46631 48887.0809   471%     -   25s
H    0     0                    -9934.047352 48887.0809   592%     -   25s
H    0     0                    -9162.313120 48887.0809   634%     -   25s
H    0     0                    -6524.026812 48887.0809   849%     -   25s
H    0     0                    -6333.099378 48887.0809   872%     -   25s
H    0     0                    -6157.939452 48887.0809   894%     -   25s
H    0     0                    -6156.973912 48887.0809   894%     -   25s
H    0     0                    -5954.283255 48887.0809   921%     -   25s
     0     0 40882.5901    0  304 -5954.2833 40882.5901   787%     -  124s
H    0     0                    4051.0905019 40882.5901   909%     -  125s
H    0     0                    5485.6399320 40882.5901   645%     -  125s
H    0     0                    9406.7573343 40882.5901   335%     -  125s
H    0     0                    10934.595102 40882.5901   274%     -  125s
H    0     0                    11104.617641 40882.5901   268%     -  125s
H    0     0                    11131.146239 40882.5901   267%     -  125s
     0     0 40882.4144    0  320 11131.1462 40882.4144   267%     -  156s
     0     0 37865.1916    0  314 11131.1462 37865.1916   240%     -  181s
     0     0 37863.7399    0  352 11131.1462 37863.7399   240%     -  189s
     0     0 37863.7399    0  315 11131.1462 37863.7399   240%     -  195s
     0     0 37863.7399    0  317 11131.1462 37863.7399   240%     -  196s
     0     0 37863.7399    0  319 11131.1462 37863.7399   240%     -  198s
     0     0 37863.7399    0  317 11131.1462 37863.7399   240%     -  198s
     0     0 37539.1862    0  338 11131.1462 37539.1862   237%     -  255s
H    0     0                    14642.917568 37538.6452   156%     -  256s
H    0     0                    14734.813423 37538.6452   155%     -  256s
     0     0 36774.0003    0  357 14734.8134 36774.0003   150%     -  293s
     0     0 36324.8056    0  432 14734.8134 36324.8056   147%     -  321s
     0     0 36150.1274    0  397 14734.8134 36150.1274   145%     -  337s
     0     0 36052.7068    0  421 14734.8134 36052.7068   145%     -  348s
     0     0 35959.5299    0  409 14734.8134 35959.5299   144%     -  359s
     0     0 35917.8637    0  415 14734.8134 35917.8637   144%     -  368s
     0     0 35901.9484    0  407 14734.8134 35901.9484   144%     -  373s
     0     0 35847.2233    0  407 14734.8134 35847.2233   143%     -  384s
     0     0 35831.5101    0  401 14734.8134 35831.5101   143%     -  389s
     0     0 35825.9987    0  418 14734.8134 35825.9987   143%     -  392s
     0     0 35820.8655    0  406 14734.8134 35820.8655   143%     -  394s
     0     0 35819.9694    0  414 14734.8134 35819.9694   143%     -  395s
     0     0 33247.1677    0  474 14734.8134 33247.1677   126%     -  487s
H    0     0                    14923.465676 33246.7029   123%     -  488s
H    0     0                    14974.610029 33246.7029   122%     -  488s
H    0     0                    15020.620105 33246.7029   121%     -  488s
H    0     0                    15112.196509 33246.7029   120%     -  488s
     0     0 32904.3537    0  430 15112.1965 32904.3537   118%     -  511s
     0     0 32727.5979    0  411 15112.1965 32727.5979   117%     -  529s
     0     0 32620.6310    0  432 15112.1965 32620.6310   116%     -  540s
     0     0 32583.2462    0  432 15112.1965 32583.2462   116%     -  547s
     0     0 32549.0811    0  444 15112.1965 32549.0811   115%     -  554s
     0     0 32496.8646    0  439 15112.1965 32496.8646   115%     -  564s
     0     0 32476.7065    0  443 15112.1965 32476.7065   115%     -  568s
     0     0 32441.6744    0  451 15112.1965 32441.6744   115%     -  574s
     0     0 32434.4366    0  446 15112.1965 32434.4366   115%     -  577s
     0     0 32424.1135    0  465 15112.1965 32424.1135   115%     -  580s
     0     0 32418.6341    0  449 15112.1965 32418.6341   115%     -  582s
     0     0 32417.9725    0  453 15112.1965 32417.9725   115%     -  584s
     0     0 31596.6625    0  461 15112.1965 31596.6625   109%     -  618s
H    0     0                    15115.974568 31596.0045   109%     -  621s
     0     0 31499.6330    0  450 15115.9746 31499.6330   108%     -  630s
     0     0 31440.0458    0  469 15115.9746 31440.0458   108%     -  639s
     0     0 31400.3033    0  467 15115.9746 31400.3033   108%     -  644s
     0     0 31370.7243    0  465 15115.9746 31370.7243   108%     -  649s
     0     0 31357.6959    0  474 15115.9746 31357.6959   107%     -  651s
     0     0 31343.3797    0  473 15115.9746 31343.3797   107%     -  654s
     0     0 31327.5495    0  473 15115.9746 31327.5495   107%     -  657s
     0     0 31325.5123    0  478 15115.9746 31325.5123   107%     -  659s
     0     0 31183.7351    0  421 15115.9746 31183.7351   106%     -  677s
H    0     0                    15137.987306 31183.6594   106%     -  678s
     0     0 31159.0567    0  430 15137.9873 31159.0567   106%     -  684s
     0     0 31131.5725    0  450 15137.9873 31131.5725   106%     -  691s
     0     0 31126.1702    0  449 15137.9873 31126.1702   106%     -  693s
     0     0 31119.7583    0  455 15137.9873 31119.7583   106%     -  695s
     0     0 31115.0386    0  456 15137.9873 31115.0386   106%     -  697s
     0     0 31108.9063    0  460 15137.9873 31108.9063   106%     -  699s
     0     0 31090.1311    0  435 15137.9873 31090.1311   105%     -  705s
     0     0 31084.4422    0  451 15137.9873 31084.4422   105%     -  706s
     0     0 31082.3341    0  443 15137.9873 31082.3341   105%     -  707s
     0     0 31040.2097    0  440 15137.9873 31040.2097   105%     -  714s
     0     0 31019.8580    0  433 15137.9873 31019.8580   105%     -  728s
     0     0 31013.2947    0  442 15137.9873 31013.2947   105%     -  731s
     0     0 31009.6857    0  438 15137.9873 31009.6857   105%     -  736s
     0     0 31000.9196    0  438 15137.9873 31000.9196   105%     -  740s
     0     0 31000.5899    0  398 15137.9873 31000.5899   105%     -  742s
     0     0 30968.4981    0  426 15137.9873 30968.4981   105%     -  753s
     0     0 30962.0729    0  471 15137.9873 30962.0729   105%     -  759s
     0     0 30961.5511    0  466 15137.9873 30961.5511   105%     -  759s
     0     0 30954.1078    0  423 15137.9873 30954.1078   104%     -  763s
H    0     0                    15356.435088 30953.2599   102%     -  765s
     0     0 30952.6979    0  479 15356.4351 30952.6979   102%     -  768s
     0     0 30948.3393    0  476 15356.4351 30948.3393   102%     -  773s
     0     0 30944.7670    0  415 15356.4351 30944.7670   102%     -  778s
     0     0 30944.0772    0  472 15356.4351 30944.0772   102%     -  780s
     0     0 30939.8862    0  430 15356.4351 30939.8862   101%     -  785s
     0     0 30939.2287    0  430 15356.4351 30939.2287   101%     -  790s
H    0     0                    16023.563917 30939.2287  93.1%     -  876s
H    0     0                    16333.465644 30939.2287  89.4%     -  876s
H    0     0                    16374.091421 30939.2287  89.0%     -  879s
H    0     0                    16381.933837 30939.2287  88.9%     -  880s
H    0     0                    16460.416489 30939.2287  88.0%     -  880s
H    0     0                    16482.506807 30939.2287  87.7%     -  880s
H    0     2                    16871.814577 30939.2287  83.4%     -  902s
     0     2 30939.2287    0  430 16871.8146 30939.2287  83.4%     -  902s
     1     4 30709.4082    1  417 16871.8146 30939.0789  83.4%  6577  916s
     3     8 30616.9364    2  427 16871.8146 30709.3851  82.0%  8475  935s
     7    16 30418.9017    3  402 16871.8146 30608.8562  81.4% 10908  956s
    15    32 30044.8839    4  524 16871.8146 30418.3193  80.3% 12975  975s
    31    48 28915.2918    5  411 16871.8146 30042.8472  78.1% 16052 1028s
    47    78 28515.4310    6  368 16871.8146 30042.8472  78.1% 17347 1069s
H   49    78                    16875.259455 30042.8472  78.0% 16950 1069s
H   56    78                    16943.552216 30042.8472  77.3% 16717 1069s
    77   171 28448.7909    7  340 16943.5522 30042.8472  77.3% 14317 1146s
   170   264 28190.0995    9  295 16943.5522 30042.8472  77.3%  9668 1179s
H  173   264                    16969.074248 30042.8472  77.0%  9550 1179s
H  234   264                    16969.466393 30042.8472  77.0%  8247 1179s
   263   332 27814.7384   10  319 16969.4664 30042.8472  77.0%  7782 1201s
   331   400 28045.0113   11  391 16969.4664 30042.8472  77.0%  6982 1223s
   399   456 28146.4021   11  392 16969.4664 30042.8472  77.0%  6661 1243s
   455   483 27713.7486   11  344 16969.4664 30042.8472  77.0%  6335 1265s
   482   525 27643.1609   11  301 16969.4664 30042.8472  77.0%  6279 1282s
   526   577 23272.7011   24  246 16969.4664 30042.8472  77.0%  6294 1303s
   578   624 27992.9818   12  388 16969.4664 30042.8472  77.0%  6109 1318s
H  592   624                    17129.452008 30042.8472  75.4%  6046 1318s
   629   713 22772.0717   31  294 17129.4520 30042.8472  75.4%  5882 1335s
   720   797 27557.8086   13  368 17129.4520 30042.8472  75.4%  5435 1351s
   808   871 21795.2266   35  228 17129.4520 30042.8472  75.4%  5103 1373s
   884   953 21753.6648   36  227 17129.4520 30042.8472  75.4%  4861 1398s
   968  1011 27488.4310   14  361 17129.4520 30042.8472  75.4%  4645 1423s
  1054  1067 18862.6725   44  118 17129.4520 30042.8472  75.4%  4444 1444s
  1151  1134 22217.3908   15  297 17129.4520 30042.8472  75.4%  4245 1463s
  1271  1145 22187.4294   16  251 17129.4520 30042.8472  75.4%  4022 1485s
  1368  1172 21527.5833   17  263 17129.4520 30042.8472  75.4%  3934 1510s
  1419  1228 21292.6726   18  271 17129.4520 30042.8472  75.4%  3974 1534s
  1497  1268 20344.8723   19  239 17129.4520 30042.8472  75.4%  3948 1558s
  1623  1286 20337.1668   20  231 17129.4520 30042.8472  75.4%  3819 1582s
H 1639  1286                    17199.968730 30042.8472  74.7%  3815 1582s
  1657  1352 20291.1016   21  232 17199.9687 30042.8472  74.7%  3840 1606s
  1768  1445 20211.3724   23  232 17199.9687 30042.8472  74.7%  3754 1631s
  1914  1469 19779.0277   26  200 17199.9687 30042.8472  74.7%  3669 1659s
H 1916  1469                    17452.243473 30042.8472  72.1%  3672 1659s
H 1958  1469                    17501.085705 30042.8472  71.7%  3638 1659s
  1996  1498 19628.6360   26  196 17501.0857 30042.8472  71.7%  3663 1695s
  2069  1572 19170.2409   25  236 17501.0857 30042.8472  71.7%  3679 1735s
  2182  1668 19027.0198   27  182 17501.0857 30042.8472  71.7%  3652 1768s
  2327  1758 19017.6561   28  177 17501.0857 30042.8472  71.7%  3584 1801s
  2485  1740 18889.9676   31  195 17501.0857 30042.8472  71.7%  3504 1834s
  2603  1769 infeasible   33      17501.0857 30042.8472  71.7%  3505 1870s
  2700  1826 infeasible   33      17501.0857 30042.8472  71.7%  3539 1909s
  2808  1849 22874.8763   10  392 17501.0857 29689.4052  69.6%  3577 1948s
  2847  1875 21906.3550   11  343 17501.0857 29689.4052  69.6%  3620 1985s
H 2856  1875                    17501.089723 29689.4052  69.6%  3625 1985s
H 2859  1856                    17552.188557 29689.4052  69.1%  3627 1985s
  2879  1961 21695.6006   12  347 17552.1886 29689.4052  69.1%  3662 2022s
  3005  1986 21010.0831   14  285 17552.1886 29689.4052  69.1%  3656 2055s
H 3013  1968                    17596.219723 29689.4052  68.7%  3662 2055s
  3042  2106 20551.3841   15  313 17596.2197 29689.4052  68.7%  3694 2095s
  3207  2279 20270.7303   18  248 17596.2197 29689.4052  68.7%  3689 2140s
  3416  2465 18394.5020   19  217 17596.2197 29689.4052  68.7%  3634 2183s
  3663  2466 19718.8465   42  430 17596.2197 29689.4052  68.7%  3550 2317s
  3665  2467 28027.6815   13  184 17596.2197 29689.4052  68.7%  3548 2334s
  3666  2468 18881.9012   29  287 17596.2197 29689.4052  68.7%  3547 2415s
  3667  2469 20471.1384   31  393 17596.2197 29689.4052  68.7%  3546 2479s
  3668  2469 28337.1594   11  402 17596.2197 29689.4052  68.7%  3545 2515s
  3669  2470 18645.9635   47  443 17596.2197 29689.4052  68.7%  3544 2543s
  3670  2471 23225.5909   11  439 17596.2197 29689.4052  68.7%  3543 2563s
  3671  2471 17657.8200   59  377 17596.2197 29689.4052  68.7%  3542 2585s
  3672  2472 18716.3915   68  441 17596.2197 29689.4052  68.7%  3541 2612s
  3673  2473 20168.8726   19  445 17596.2197 29689.4052  68.7%  3541 2626s
  3674  2473 17864.9044   53  436 17596.2197 29689.4052  68.7%  3540 2642s
  3675  2474 18246.9218   44  471 17596.2197 29689.4052  68.7%  3539 2653s
  3676  2475 20268.6460   26  433 17596.2197 29689.4052  68.7%  3538 2664s
  3677  2475 25141.9838   24  424 17596.2197 29689.4052  68.7%  3537 2673s
  3678  2476 19626.1041   24  422 17596.2197 29689.4052  68.7%  3536 2682s
  3679  2477 20906.6960   15  423 17596.2197 29689.4052  68.7%  3535 2695s
  3680  2477 19333.7241   30  427 17596.2197 29689.4052  68.7%  3534 2700s
  3682  2479 18093.0870   41  430 17596.2197 29689.4052  68.7%  3532 2706s
  3683  2479 17843.4714   39  442 17596.2197 29689.4052  68.7%  3531 2711s
  3684  2480 18031.0393   33  436 17596.2197 29689.4052  68.7%  3530 2729s
  3685  2481 23238.9233   50  473 17596.2197 29689.4052  68.7%  3529 2741s
  3686  2481 20317.3762   14  425 17596.2197 29689.4052  68.7%  3528 2748s
  3687  2482 18922.8506   62  431 17596.2197 29689.4052  68.7%  3527 2753s
  3688  2483 18328.5606   41  442 17596.2197 29689.4052  68.7%  3526 2758s
H 3688  2358                    17606.182719 29689.4052  68.6%  3526 2770s
  3689  2358 18372.8037   39  436 17606.1827 29689.4052  68.6%  3525 2779s
  3690  2359 26010.5823   22  428 17606.1827 29689.4052  68.6%  3524 2786s
  3691  2360 20157.6141   27  422 17606.1827 29689.4052  68.6%  3523 2792s
  3692  2360 26575.3148   13  447 17606.1827 29689.4052  68.6%  3522 2805s
  3693  2361 17892.5979   60  444 17606.1827 29689.4052  68.6%  3521 2811s
  3694  2362 22113.4013    9  440 17606.1827 29689.4052  68.6%  3520 2825s
  3696  2363 18815.0252   46  478 17606.1827 29689.4052  68.6%  3519 2833s
  3697  2364 26797.0783    9  478 17606.1827 29689.4052  68.6%  3518 2838s
  3698  2364 18082.2573   32  449 17606.1827 29689.4052  68.6%  3517 2849s
  3699  2365 17991.1359   86  446 17606.1827 29689.4052  68.6%  3516 2853s
  3700  2366 20431.3043   15  448 17606.1827 29689.4052  68.6%  3515 2862s
  3701  2366 19518.6611   47  452 17606.1827 29689.4052  68.6%  3514 2866s
  3702  2367 20834.8316   22  448 17606.1827 29689.4052  68.6%  3513 2874s
  3703  2368 20278.3389   37  445 17606.1827 29689.4052  68.6%  3512 2878s
  3704  2368 20485.5158   51  437 17606.1827 29689.4052  68.6%  3511 2885s
  3706  2370 18107.9505   81  440 17606.1827 29689.4052  68.6%  3509 2898s
  3707  2370 27439.5474   13  440 17606.1827 29689.4052  68.6%  3508 2915s
  3708  2371 21623.6051   65  440 17606.1827 29689.4052  68.6%  3507 3016s
  3709  2374 29689.4052   15  383 17606.1827 29689.4052  68.6%  3608 3053s
  3710  2376 29440.1474   16  290 17606.1827 29689.4052  68.6%  3610 3090s
  3713  2381 28821.1126   17  370 17606.1827 29689.4052  68.6%  3615 3130s
  3719  2391 28492.2116   18  325 17606.1827 29689.4052  68.6%  3632 3166s
  3731  2399 28532.3137   18  415 17606.1827 29396.9031  67.0%  3694 3243s
  3743  2427 25954.2529   19  312 17606.1827 29396.9031  67.0%  3760 3381s
  3775  2524 25149.9878   20  313 17606.1827 29215.6538  65.9%  3967 3442s
  3882  2531 23412.6004   22  233 17606.1827 29215.5499  65.9%  4170 3474s
  3925  2566 22591.9151   24  229 17606.1827 29215.5499  65.9%  4237 3507s
  3976  2579 22400.2780   23  208 17606.1827 29215.5499  65.9%  4343 3534s
  4007  2594 22286.6590   24  195 17606.1827 29215.5499  65.9%  4431 3564s
  4044  2600 18851.8107   25  227 17606.1827 29215.5499  65.9%  4531 3590s
  4074  2605 19238.0289   26  248 17606.1827 29215.5499  65.9%  4625 3600s

Cutting planes:
  Learned: 2
  Gomory: 13
  Implied bound: 21
  Projected implied bound: 160
  MIR: 1255
  Mixing: 1
  Flow cover: 2640
  RLT: 19
  Relax-and-lift: 308

Explored 4091 nodes (19570407 simplex iterations) in 3600.07 seconds (8126.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17606.2 17596.2 17552.2 ... 16969.1

Time limit reached
Best objective 1.760618271886e+04, best bound 2.921554993995e+04, gap 65.9391%
  WARNING: Time limit reached. Using best solution found (gap: 65.94%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 17606.18, θ = 170169.25
  Upper Bound (UB) = 17606.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170169.25
  [DEBUG]   ✓ Scenario 0: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170169.25 ≤ Q = 170192.96 (slack: 23.71)
  [DEBUG]   ✓ Scenario 2: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 170169.25 ≤ Q = 170169.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 170169.25 ≤ Q = 170169.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x27df6e02
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd82091fe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6898315.3976
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.390896e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139089.59    0  122 6898315.40 -139089.59   102%     -    0s
H    0     0                    -102610.1923 -139089.59  35.6%     -    0s
H    0     0                    -104151.5004 -139089.59  33.5%     -    0s
     0     0 -112773.28    0  103 -104151.50 -112773.28  8.28%     -    0s
H    0     0                    -107038.4387 -112723.52  5.31%     -    0s
     0     0 -112723.52    0  103 -107038.44 -112723.52  5.31%     -    0s
     0     0 -111693.88    0   90 -107038.44 -111693.88  4.35%     -    0s
H    0     0                    -111174.0319 -111690.31  0.46%     -    0s
     0     0 -111661.74    0   87 -111174.03 -111661.74  0.44%     -    0s
H    0     0                    -111210.2229 -111502.96  0.26%     -    0s
     0     0 -111502.96    0   26 -111210.22 -111502.96  0.26%     -    0s
     0     0 -111497.56    0   25 -111210.22 -111497.56  0.26%     -    0s
     0     0 -111492.83    0   24 -111210.22 -111492.83  0.25%     -    0s
     0     0 -111410.70    0   29 -111210.22 -111410.70  0.18%     -    0s
     0     0 -111407.88    0   26 -111210.22 -111407.88  0.18%     -    0s
     0     0 -111407.28    0   19 -111210.22 -111407.28  0.18%     -    0s
     0     0 -111331.11    0    8 -111210.22 -111331.11  0.11%     -    0s
H    0     0                    -111232.6783 -111314.04  0.07%     -    0s
     0     0 -111298.45    0   12 -111232.68 -111298.45  0.06%     -    0s
     0     0 -111275.57    0   13 -111232.68 -111275.57  0.04%     -    0s
     0     0 -111275.57    0   21 -111232.68 -111275.57  0.04%     -    0s
     0     0 -111275.57    0   14 -111232.68 -111275.57  0.04%     -    0s
     0     0 -111247.66    0    4 -111232.68 -111247.66  0.01%     -    0s
     0     0 -111241.31    0    5 -111232.68 -111241.31  0.01%     -    0s
     0     0 -111232.97    0    2 -111232.68 -111232.97  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 6
  Flow cover: 10
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (832 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -111233 -111210 -111174 ... 1.2561e+13
No other solutions better than -111233

Optimal solution found (tolerance 1.00e-06)
Best objective -1.112326783291e+05, best bound -1.112326783291e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 165580.55
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111232.68
  [DEBUG]   S×d_nominal = 276813.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276813.23 + -111232.68 = 165580.55
  [DEBUG]   Current θ from Master = 170169.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4588.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13017.48
  Lower Bound (LB) = 13017.48
  Gap (UB-LB) = 4588.7024, Absolute Gap = 4588.7024, Relative Gap = 0.260630
  Not converged yet (gap = 4588.70 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654344 nonzeros
Model fingerprint: 0xc24becc7
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93930 rows and 38130 columns
Presolve time: 2.81s
Presolved: 136803 rows, 57730 columns, 839639 nonzeros
Variable types: 55471 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.101e+06
 Factor NZ  : 1.405e+07 (roughly 200 MB of memory)
 Factor Ops : 3.189e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83160570e+07  2.34286449e+08  1.27e+05 1.94e+01  8.55e+04     5s
   1  -1.40515851e+07  2.09888804e+08  8.82e+04 7.22e+01  5.87e+04     5s
   2  -6.36809678e+06  1.67519013e+08  3.86e+04 8.10e-01  2.69e+04     5s
   3  -9.95847025e+05  1.28305857e+08  2.68e+03 2.18e+00  2.30e+03     5s
   4  -5.85511667e+05  4.41630605e+07  5.72e+02 1.95e-01  5.10e+02     5s
   5  -4.67446657e+05  2.98519882e+07  2.52e+02 1.06e-01  2.57e+02     5s
   6  -3.70140165e+05  2.10459484e+07  9.32e+01 6.78e-02  1.31e+02     5s
   7  -2.37813994e+05  1.76869340e+07  4.68e+01 5.54e-02  9.26e+01     5s
   8  -1.67425265e+05  1.23397070e+07  2.22e+01 3.66e-02  5.79e+01     5s
   9  -1.26898687e+05  9.11861139e+06  1.30e+01 2.61e-02  4.06e+01     5s
  10  -1.21498682e+05  6.85818762e+06  1.04e+01 1.93e-02  3.03e+01     5s
  11  -9.18969569e+04  2.62682484e+06  4.32e+00 6.56e-03  1.13e+01     5s
  12  -5.93597356e+04  8.16486807e+05  1.29e+00 1.86e-03  3.56e+00     5s
  13  -4.44555646e+04  4.88136991e+05  8.41e-01 1.22e-03  2.15e+00     5s
  14  -2.84677594e+04  3.90826993e+05  5.91e-01 9.61e-04  1.69e+00     5s
  15  -6.09953624e+03  2.10535264e+05  3.10e-01 1.14e-03  8.72e-01     5s
  16  -1.60481792e+03  1.51310622e+05  2.76e-01 1.20e-03  6.16e-01     5s
  17   4.94939991e+03  1.29444887e+05  2.35e-01 2.12e-03  5.01e-01     5s
  18   1.26342126e+04  1.10816205e+05  1.84e-01 2.25e-03  3.95e-01     6s
  19   1.74639076e+04  1.01718298e+05  1.55e-01 1.99e-03  3.39e-01     6s
  20   2.05404430e+04  9.17820878e+04  1.36e-01 2.54e-03  2.87e-01     6s
  21   2.42930117e+04  7.57888052e+04  1.16e-01 2.13e-03  2.07e-01     6s
  22   2.66661037e+04  7.36883419e+04  1.03e-01 2.15e-03  1.89e-01     6s
  23   3.11414604e+04  6.83830972e+04  7.80e-02 1.42e-03  1.50e-01     6s
  24   3.24910227e+04  6.53237519e+04  7.11e-02 1.59e-03  1.32e-01     6s
  25   3.59101474e+04  6.20560381e+04  5.39e-02 1.60e-03  1.05e-01     6s
  26   3.74176823e+04  5.89294076e+04  4.70e-02 1.73e-03  8.66e-02     6s
  27   3.86478517e+04  5.70462983e+04  4.16e-02 2.32e-03  7.41e-02     6s
  28   4.03800331e+04  5.51229086e+04  3.41e-02 3.15e-03  5.94e-02     6s
  29   4.22244160e+04  5.38586732e+04  2.65e-02 2.54e-03  4.68e-02     6s
  30   4.31701079e+04  5.29428393e+04  2.26e-02 2.27e-03  3.93e-02     6s
  31   4.40408144e+04  5.18295575e+04  1.92e-02 1.57e-03  3.14e-02     6s
  32   4.48571372e+04  5.14831475e+04  1.61e-02 1.36e-03  2.67e-02     6s
  33   4.59042659e+04  5.09015551e+04  1.20e-02 1.01e-03  2.01e-02     6s
  34   4.66245223e+04  5.04236684e+04  9.30e-03 6.93e-04  1.53e-02     6s
  35   4.68060175e+04  5.01841529e+04  8.60e-03 5.62e-04  1.36e-02     7s
  36   4.74016445e+04  4.99707949e+04  6.40e-03 4.37e-04  1.03e-02     7s
  37   4.77736983e+04  4.98383588e+04  5.04e-03 3.61e-04  8.31e-03     7s
  38   4.81996343e+04  4.96749221e+04  3.50e-03 2.64e-04  5.94e-03     7s
  39   4.85427136e+04  4.95552112e+04  2.23e-03 2.00e-04  4.07e-03     7s
  40   4.86187466e+04  4.94884543e+04  1.97e-03 1.62e-04  3.50e-03     7s
  41   4.88580590e+04  4.94008966e+04  1.15e-03 1.06e-04  2.18e-03     7s
  42   4.90252789e+04  4.93761787e+04  6.20e-04 9.17e-05  1.41e-03     7s
  43   4.90407144e+04  4.93733435e+04  5.72e-04 9.00e-05  1.34e-03     7s
  44   4.90825268e+04  4.92575503e+04  4.34e-04 4.89e-05  7.05e-04     7s
  45   4.91403524e+04  4.92452199e+04  2.48e-04 3.58e-05  4.22e-04     7s
  46   4.92116594e+04  4.92308473e+04  3.09e-05 1.27e-05  7.71e-05     7s
  47   4.92188579e+04  4.92243121e+04  8.83e-06 2.51e-06  2.19e-05     7s
  48   4.92222220e+04  4.92227199e+04  1.89e-07 3.85e-07  2.00e-06     7s
  49   4.92223474e+04  4.92223878e+04  4.55e-08 9.58e-10  1.63e-07     7s
  50   4.92223769e+04  4.92223875e+04  4.05e-07 8.90e-10  4.25e-08     7s
  51   4.92223862e+04  4.92223874e+04  1.46e-07 4.65e-10  4.84e-09     8s
  52   4.92223866e+04  4.92223874e+04  1.21e-06 2.67e-09  3.32e-09     8s
  53   4.92223868e+04  4.92223874e+04  3.57e-06 2.43e-07  2.53e-09     8s
  54   4.92223872e+04  4.92223874e+04  1.50e-06 6.58e-09  1.06e-09     8s

Barrier solved model in 54 iterations and 7.71 seconds (13.09 work units)
Optimal objective 4.92223872e+04


Root crossover log...

  117894 DPushes remaining with DInf 0.0000000e+00                 8s
   31001 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   15312 PPushes remaining with PInf 1.0730314e-04                14s
    4633 PPushes remaining with PInf 7.0782132e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3761751e+05     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77307    4.9222387e+04   0.000000e+00   1.376175e+05     16s
   77802    4.9222387e+04   0.000000e+00   0.000000e+00     17s
   77802    4.9222387e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 9.04s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.922239e+04, 77802 iterations, 22.15 seconds (34.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49222.3874    0  267 -233202.98 49222.3874   121%     -   26s
H    0     0                    -173495.6443 49222.3874   128%     -   27s
H    0     0                    -173160.4981 49222.3874   128%     -   29s
H    0     0                    -172448.2039 49222.3874   129%     -   29s
H    0     0                    -171588.6174 49222.3874   129%     -   29s
H    0     0                    -170047.9683 49222.3874   129%     -   29s
H    0     0                    -169935.1882 49222.3874   129%     -   29s
H    0     0                    -169828.6286 49222.3874   129%     -   29s
H    0     0                    -169448.4431 49222.3874   129%     -   29s
H    0     0                    -169293.3821 49222.3874   129%     -   30s
H    0     0                    -67724.34811 49222.3874   173%     -   30s
H    0     0                    -45549.77320 49222.3874   208%     -   30s
H    0     0                    -41560.29623 49222.3874   218%     -   30s
H    0     0                    -41293.68958 49222.3874   219%     -   30s
H    0     0                    -41277.00999 49222.3874   219%     -   30s
     0     0 42305.4744    0  313 -41277.010 42305.4744   202%     -   79s
H    0     0                    -39163.66689 42305.4615   208%     -   80s
H    0     0                    -39110.16967 42305.4615   208%     -   81s
H    0     0                    -36882.15747 42305.4615   215%     -   81s
H    0     0                    -36237.38379 42305.4615   217%     -   81s
H    0     0                    -36226.38866 42305.4615   217%     -   81s
     0     0 41443.1336    0  348 -36226.389 41443.1336   214%     -  111s
     0     0 41348.1452    0  342 -36226.389 41348.1452   214%     -  118s
     0     0 41315.8910    0  341 -36226.389 41315.8910   214%     -  123s
     0     0 41315.6723    0  341 -36226.389 41315.6723   214%     -  126s
     0     0 38362.9176    0  308 -36226.389 38362.9176   206%     -  173s
H    0     0                    -30081.84406 38362.8687   228%     -  174s
H    0     0                    -29185.30883 38362.8687   231%     -  174s
H    0     0                    -28750.95152 38362.8687   233%     -  174s
H    0     0                    -28746.15391 38362.8687   233%     -  174s
H    0     0                    -28678.75553 38362.8687   234%     -  174s
H    0     0                    -28503.10664 38362.8687   235%     -  174s
     0     0 37539.6968    0  328 -28503.107 37539.6968   232%     -  207s
     0     0 37255.8410    0  323 -28503.107 37255.8410   231%     -  229s
     0     0 37191.7068    0  329 -28503.107 37191.7068   230%     -  240s
     0     0 36950.4844    0  337 -28503.107 36950.4844   230%     -  261s
     0     0 36823.8853    0  324 -28503.107 36823.8853   229%     -  276s
     0     0 36784.9507    0  339 -28503.107 36784.9507   229%     -  283s
     0     0 36742.7719    0  339 -28503.107 36742.7719   229%     -  291s
     0     0 36598.0432    0  333 -28503.107 36598.0432   228%     -  305s
     0     0 36583.5823    0  332 -28503.107 36583.5823   228%     -  309s
     0     0 36582.2732    0  332 -28503.107 36582.2732   228%     -  311s
     0     0 33831.4053    0  430 -28503.107 33831.4053   219%     -  369s
H    0     0                    -23384.22487 33830.1658   245%     -  370s
H    0     0                    -23282.88697 33830.1658   245%     -  370s
H    0     0                    -23267.44531 33830.1658   245%     -  370s
     0     0 33328.3980    0  444 -23267.445 33328.3980   243%     -  392s
     0     0 32991.4686    0  441 -23267.445 32991.4686   242%     -  406s
     0     0 32874.3775    0  433 -23267.445 32874.3775   241%     -  416s
     0     0 32822.5098    0  438 -23267.445 32822.5098   241%     -  423s
     0     0 32757.9882    0  490 -23267.445 32757.9882   241%     -  431s
     0     0 32660.9026    0  453 -23267.445 32660.9026   240%     -  440s
     0     0 32617.8413    0  438 -23267.445 32617.8413   240%     -  447s
     0     0 32594.9911    0  441 -23267.445 32594.9911   240%     -  450s
     0     0 32588.3852    0  451 -23267.445 32588.3852   240%     -  453s
     0     0 32555.0066    0  452 -23267.445 32555.0066   240%     -  459s
     0     0 32541.9884    0  444 -23267.445 32541.9884   240%     -  463s
     0     0 32521.0848    0  444 -23267.445 32521.0848   240%     -  467s
     0     0 32508.1055    0  451 -23267.445 32508.1055   240%     -  470s
     0     0 32498.7638    0  461 -23267.445 32498.7638   240%     -  473s
     0     0 32481.6335    0  452 -23267.445 32481.6335   240%     -  477s
     0     0 32477.7046    0  454 -23267.445 32477.7046   240%     -  479s
     0     0 32476.8099    0  451 -23267.445 32476.8099   240%     -  481s
     0     0 31653.8278    0  409 -23267.445 31653.8278   236%     -  519s
H    0     0                    -21644.71584 31653.8032   246%     -  520s
H    0     0                    -19937.01232 31653.8032   259%     -  520s
H    0     0                    -19510.92347 31653.8032   262%     -  520s
H    0     0                    -19382.10158 31653.8032   263%     -  520s
H    0     0                    -19361.83082 31653.8032   263%     -  520s
H    0     0                    -19331.36645 31653.8032   264%     -  520s
     0     0 31484.8487    0  412 -19331.366 31484.8487   263%     -  532s
     0     0 31423.9310    0  427 -19331.366 31423.9310   263%     -  539s
     0     0 31384.1188    0  435 -19331.366 31384.1188   262%     -  544s
     0     0 31347.0654    0  433 -19331.366 31347.0654   262%     -  552s
     0     0 31291.0389    0  443 -19331.366 31291.0389   262%     -  560s
     0     0 31270.9621    0  459 -19331.366 31270.9621   262%     -  564s
     0     0 31254.1928    0  473 -19331.366 31254.1928   262%     -  569s
     0     0 31240.9853    0  470 -19331.366 31240.9853   262%     -  571s
     0     0 31237.9573    0  474 -19331.366 31237.9573   262%     -  573s
     0     0 31233.9533    0  467 -19331.366 31233.9533   262%     -  575s
     0     0 31223.2898    0  466 -19331.366 31223.2898   262%     -  578s
     0     0 31220.4279    0  462 -19331.366 31220.4279   262%     -  579s
     0     0 31219.3641    0  464 -19331.366 31219.3641   261%     -  579s
     0     0 31083.6829    0  452 -19331.366 31083.6829   261%     -  593s
H    0     0                    -18056.72207 31083.6463   272%     -  594s
H    0     0                    -18037.97130 31083.6463   272%     -  594s
H    0     0                    -17915.73100 31083.6463   273%     -  594s
     0     0 31046.4837    0  478 -17915.731 31046.4837   273%     -  602s
     0     0 31035.3064    0  462 -17915.731 31035.3064   273%     -  606s
     0     0 31032.7816    0  498 -17915.731 31032.7816   273%     -  608s
     0     0 30968.3983    0  507 -17915.731 30968.3983   273%     -  620s
H    0     0                    -16429.35671 30967.9641   288%     -  621s
H    0     0                    -16381.12654 30967.9641   289%     -  621s
     0     0 30957.7760    0  502 -16381.127 30957.7760   289%     -  626s
     0     0 30954.9544    0  475 -16381.127 30954.9544   289%     -  629s
     0     0 30953.6799    0  485 -16381.127 30953.6799   289%     -  630s
     0     0 30922.9706    0  467 -16381.127 30922.9706   289%     -  640s
     0     0 30913.1911    0  462 -16381.127 30913.1911   289%     -  645s
     0     0 30907.6798    0  475 -16381.127 30907.6798   289%     -  649s
     0     0 30902.6574    0  475 -16381.127 30902.6574   289%     -  653s
     0     0 30901.1340    0  472 -16381.127 30901.1340   289%     -  654s
     0     0 30881.4080    0  435 -16381.127 30881.4080   289%     -  665s
H    0     0                    -16364.02868 30880.5967   289%     -  666s
H    0     0                    -15709.85870 30880.5967   297%     -  666s
     0     0 30874.9716    0  458 -15709.859 30874.9716   297%     -  669s
     0     0 30870.3726    0  482 -15709.859 30870.3726   297%     -  672s
     0     0 30870.0077    0  487 -15709.859 30870.0077   297%     -  673s
     0     0 30867.4427    0  479 -15709.859 30867.4427   296%     -  680s
H    0     0                    -15660.11972 30867.3159   297%     -  681s
H    0     0                    -15549.86958 30867.3159   299%     -  681s
H    0     0                    -15528.90759 30867.3159   299%     -  681s
H    0     0                    -15520.50333 30867.3159   299%     -  681s
     0     0 30865.8797    0  478 -15520.503 30865.8797   299%     -  684s
     0     0 30861.4901    0  480 -15520.503 30861.4901   299%     -  688s
H    0     0                    -15463.50963 30860.9792   300%     -  690s
H    0     0                    -15453.01981 30860.9792   300%     -  690s
H    0     0                    -15427.78523 30860.9792   300%     -  690s
H    0     0                    -15309.54361 30860.9792   302%     -  690s
     0     0 30859.4605    0  475 -15309.544 30859.4605   302%     -  693s
     0     0 30858.2714    0  473 -15309.544 30858.2714   302%     -  696s
     0     0 30858.1898    0  473 -15309.544 30858.1898   302%     -  701s
H    0     0                    -9320.049906 30857.8241   431%     -  747s
H    0     0                    2367.2088474 30857.8241  1204%     -  754s
H    0     0                    2716.8421912 30857.8241  1036%     -  754s
H    0     0                    3046.5257787 30857.8241   913%     -  754s
H    0     0                    3440.5033339 30857.8241   797%     -  754s
H    0     0                    3475.2702340 30857.8241   788%     -  754s
H    0     0                    3481.1818246 30857.8241   786%     -  754s
H    0     0                    5101.3262737 30857.8241   505%     -  808s
H    0     0                    7637.8866601 30857.8241   304%     -  808s
H    0     0                    8279.0371934 30857.8241   273%     -  808s
H    0     0                    8540.5595766 30857.8241   261%     -  808s
H    0     0                    11131.736621 30857.8241   177%     -  820s
H    0     0                    11148.014525 30857.8241   177%     -  821s
H    0     0                    11303.035290 30857.8241   173%     -  821s
H    0     2                    12366.524475 30857.8241   150%     -  824s
     0     2 30857.8241    0  473 12366.5245 30857.8241   150%     -  824s
     1     3 30296.7052    1  430 12366.5245 30857.8241   150% 14948  844s
     2     4 30612.8625    1  455 12366.5245 30612.8625   148% 13892  860s
     3     7 29903.3509    2  435 12366.5245 30612.8048   148% 12109  874s
     6    13 29688.2658    3  426 12366.5245 30612.7930   148% 11887  897s
    12    26 28974.0498    3  351 12366.5245 30403.1399   146% 14138  918s
    25    39 29275.7854    4  439 12366.5245 30113.3037   144% 19187  972s
H   38    71                    13766.219300 30113.3037   119% 21541 1089s
H   38    71                    14793.752906 30113.3037   104% 21541 1089s
H   42    71                    15230.458374 30113.3037  97.7% 20604 1089s
H   42    71                    15554.270288 30113.3037  93.6% 20604 1089s
H   43    71                    15603.428925 30113.3037  93.0% 20338 1089s
H   46    71                    15966.550824 30113.3037  88.6% 19884 1089s
H   46    71                    16021.689491 30113.3037  88.0% 19884 1089s
H   47    71                    16432.211680 30113.3037  83.3% 19668 1089s
H   55    71                    16591.567769 30113.3037  81.5% 18192 1089s
    70   162 28845.7232    6  412 16591.5678 29802.7044  79.6% 21490 1137s
H  161   264                    16647.718578 29802.7044  79.0% 13101 1165s
H  174   264                    16891.422875 29802.7044  76.4% 12388 1165s
H  180   264                    16928.317990 29802.7044  76.1% 12131 1165s
H  189   264                    16997.774739 29802.7044  75.3% 11813 1165s
H  233   264                    17144.285914 29802.7044  73.8% 10206 1165s
H  258   264                    17237.486926 29802.7044  72.9%  9633 1165s
   263   335 28098.9681   14  401 17237.4869 29802.7044  72.9%  9521 1188s
   334   393 27643.7383   15  376 17237.4869 29802.7044  72.9%  8693 1208s
H  340   393                    17336.706770 29802.7044  71.9%  8633 1208s
H  355   393                    17460.225587 29802.7044  70.7%  8485 1208s
H  382   393                    17483.762370 29802.7044  70.5%  8190 1208s
   392   447 27541.8361   17  389 17483.7624 29802.7044  70.5%  8225 1230s
   448   493 26338.7910   18  344 17483.7624 29802.7044  70.5%  7870 1252s
H  460   493                    17488.531849 29802.7044  70.4%  7902 1252s
   496   543 26151.1765   19  342 17488.5318 29802.7044  70.4%  7728 1274s
   548   571 25869.5953   21  343 17488.5318 29802.7044  70.4%  7663 1295s
H  556   571                    17712.755836 29802.7044  68.3%  7669 1295s
   576   647 25169.8953   22  347 17712.7558 29802.7044  68.3%  7667 1314s
   654   716 infeasible   24      17712.7558 29802.7044  68.3%  7657 1332s
   733   769 23749.1486   25  241 17712.7558 29802.7044  68.3%  7579 1348s
   802   811     cutoff   26      17712.7558 29802.7044  68.3%  7462 1366s
   869   831 22168.8794   26  187 17712.7558 29802.7044  68.3%  7391 1383s
   903   854 22026.4850   27  180 17712.7558 29802.7044  68.3%  7564 1399s
H  930   854                    17743.386157 29802.7044  68.0%  7565 1399s
   945   872     cutoff   28      17743.3862 29802.7044  68.0%  7581 1418s
  1019   906 infeasible   28      17743.3862 29802.7044  68.0%  7461 1438s
  1083   947 infeasible   28      17743.3862 29802.7044  68.0%  7458 1463s
  1146   991 18158.8609   19  214 17743.3862 29802.7044  68.0%  7628 1484s
  1232  1051     cutoff   21      17743.3862 29802.7044  68.0%  7619 1506s
  1322  1138 17940.8557   26  155 17743.3862 29802.7044  68.0%  7632 1530s
  1447  1218 17839.9168   29  115 17743.3862 29802.7044  68.0%  7441 1554s
H 1563  1240                    17765.466407 29802.7044  67.8%  7298 1581s
H 1618  1240                    17837.106567 29802.7044  67.1%  7182 1581s
  1669  1247 18335.6118   16  271 17837.1066 29802.7044  67.1%  7122 1608s
  1762  1270 infeasible   18      17837.1066 29802.7044  67.1%  7085 1633s
  1830  1296 infeasible   20      17837.1066 29802.7044  67.1%  7269 1662s
  1896  1326 26997.4342   11  445 17837.1066 29245.1171  64.0%  7436 1691s
H 1899  1326                    17953.122330 29245.1171  62.9%  7445 1691s
H 1902  1326                    18009.526083 29245.1171  62.4%  7466 1691s
  1936  1363 23506.3163    7  369 18009.5261 29245.1171  62.4%  7635 1718s
  1985  1417 21312.5400   12  300 18009.5261 28979.4784  60.9%  7762 1751s
H 1986  1417                    18069.452285 28979.4784  60.4%  7758 1751s
  2067  1466 21099.5337   13  285 18069.4523 28979.4784  60.4%  7819 1783s
  2166  1474     cutoff   15      18069.4523 28920.8715  60.1%  7890 1813s
  2213  1509 19222.2622   13  296 18069.4523 28920.8715  60.1%  7989 1844s
  2284  1548     cutoff   14      18069.4523 28920.8715  60.1%  8091 1877s
H 2293  1548                    18098.237935 28920.8715  59.8%  8112 1877s
H 2334  1548                    18119.221852 28920.8715  59.6%  8135 1877s
  2363  1602 20563.0732   13  318 18119.2219 28920.8715  59.6%  8139 1913s
  2488  1622 infeasible   15      18119.2219 28920.8715  59.6%  8114 1949s
H 2502  1622                    18140.235481 28920.8715  59.4%  8184 1949s
  2526  1657 infeasible   20      18140.2355 28920.8715  59.4%  8284 1992s
  2609  1732 23478.8486   14  490 18140.2355 28920.8715  59.4%  8385 2033s
  2724  1737 22782.7159   16  480 18140.2355 28920.8715  59.4%  8463 2073s
H 2784  1737                    18144.515895 28920.8715  59.4%  8498 2073s
  2806  1797 23285.8955   15  482 18144.5159 28920.8715  59.4%  8494 2115s
  2930  1898 22214.6364   20  367 18144.5159 28812.0349  58.8%  8591 2159s
  3077  1990 21748.1330   25  334 18144.5159 28670.2960  58.0%  8678 2207s
  3260  2089 21292.8998   30  317 18144.5159 28670.2960  58.0%  8675 2257s
  3429  2169 20275.2734   32  323 18144.5159 28670.2960  58.0%  8706 2308s
  3597  2262 20392.9456   38  210 18144.5159 28536.6927  57.3%  8707 2361s
  3781  2334 21822.7020    8  283 18144.5159 28536.6927  57.3%  8761 2413s
  3985  2405 infeasible   13      18144.5159 28536.6927  57.3%  8766 2493s
  4171  2484 18473.7846   14  240 18144.5159 28536.6927  57.3%  8802 2552s
  4333  2502 22723.7921   11  344 18144.5159 28536.6927  57.3%  8916 2613s
  4379  2527 22592.7128   12  345 18144.5159 28536.6927  57.3%  8974 2689s
  4418  2553 21991.5100   13  333 18144.5159 28536.6927  57.3%  9027 2743s
  4455  2554 21984.1510   15  473 18144.5159 28536.6927  57.3%  9074 2921s
  4457  2555 26276.5259   14  198 18144.5159 28536.6927  57.3%  9070 2943s
  4458  2556 26653.5451   24  312 18144.5159 28536.6927  57.3%  9068 3087s
  4459  2557 26210.0697   18  412 18144.5159 28536.6927  57.3%  9066 3182s
  4460  2557 19087.0256   16  367 18144.5159 28536.6927  57.3%  9063 3246s
  4461  2558 19443.8681   21  371 18144.5159 28536.6927  57.3%  9061 3288s
  4462  2559 19272.7142   16  430 18144.5159 28536.6927  57.3%  9059 3306s
  4463  2559 26942.8309   12  404 18144.5159 28536.6927  57.3%  9057 3338s
  4464  2560 24942.1951   25  461 18144.5159 28536.6927  57.3%  9055 3372s
  4465  2561 18545.9829   21  417 18144.5159 28536.6927  57.3%  9053 3390s
  4466  2561 19562.1628   24  438 18144.5159 28536.6927  57.3%  9051 3402s
  4467  2562 24367.0826   24  477 18144.5159 28536.6927  57.3%  9049 3412s
  4468  2563 22255.0771   20  447 18144.5159 28536.6927  57.3%  9047 3426s
  4469  2563 20241.8521   19  440 18144.5159 28536.6927  57.3%  9045 3430s
  4470  2564 27005.4427   18  487 18144.5159 28536.6927  57.3%  9043 3456s
  4471  2565 19086.3722   23  456 18144.5159 28536.6927  57.3%  9041 3473s
  4472  2565 18157.2570   21  461 18144.5159 28536.6927  57.3%  9039 3479s
  4473  2566 18471.7590   52  458 18144.5159 28536.6927  57.3%  9037 3501s
  4474  2567 19058.9516   30  480 18144.5159 28536.6927  57.3%  9035 3508s
  4475  2567 22260.1787   19  483 18144.5159 28536.6927  57.3%  9033 3515s
  4476  2568 18472.0986   46  489 18144.5159 28536.6927  57.3%  9031 3528s
  4477  2569 22672.4519   34  442 18144.5159 28536.6927  57.3%  9029 3534s
  4478  2569 21546.6372   72  451 18144.5159 28536.6927  57.3%  9027 3547s
  4479  2570 22074.2983   13  444 18144.5159 28536.6927  57.3%  9025 3554s
  4480  2571 20166.0030   21  514 18144.5159 28536.6927  57.3%  9023 3569s
  4481  2571 18848.3722   16  454 18144.5159 28536.6927  57.3%  9021 3578s
  4482  2572 18641.5152   40  420 18144.5159 28536.6927  57.3%  9019 3584s
  4483  2573 19234.3999   19  455 18144.5159 28536.6927  57.3%  9017 3596s

Cutting planes:
  Gomory: 11
  Implied bound: 6
  Projected implied bound: 176
  MIR: 1002
  Mixing: 1
  Flow cover: 1251
  RLT: 20
  Relax-and-lift: 176

Explored 4483 nodes (41480247 simplex iterations) in 3600.09 seconds (9044.16 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18144.5 18140.2 18119.2 ... 17743.4

Time limit reached
Best objective 1.814451589504e+04, best bound 2.853669266216e+04, gap 57.2745%
  WARNING: Time limit reached. Using best solution found (gap: 57.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.27s
  Master Objective (UB) = 18144.52, θ = 166089.14
  Upper Bound (UB) = 18144.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166089.14
  [DEBUG]   ✓ Scenario 0: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 166089.14 ≤ Q = 166089.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 166089.14 ≤ Q = 166089.14 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1b38ac28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1b38ac28
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.276997e+13
Presolve removed 2565 rows and 1855 columns
Presolve time: 0.00s
Presolved: 528 rows, 534 columns, 1491 nonzeros
Found heuristic solution: objective 6768305.9569
Variable types: 360 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6767545.7577

Root relaxation: objective -1.508795e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150879.52    0  121 6767545.76 -150879.52   102%     -    0s
H    0     0                    -101727.7920 -150879.52  48.3%     -    0s
H    0     0                    -105110.7871 -150879.52  43.5%     -    0s
H    0     0                    -118783.6903 -150879.52  27.0%     -    0s
     0     0 -124597.82    0   84 -118783.69 -124597.82  4.89%     -    0s
H    0     0                    -120467.8324 -124577.29  3.41%     -    0s
H    0     0                    -122845.8605 -124577.29  1.41%     -    0s
H    0     0                    -123261.7122 -124577.29  1.07%     -    0s
H    0     0                    -123589.9764 -124577.29  0.80%     -    0s
     0     0 -124202.74    0   48 -123589.98 -124202.74  0.50%     -    0s
H    0     0                    -123850.7618 -124197.51  0.28%     -    0s
H    0     0                    -123885.6817 -124064.00  0.14%     -    0s
     0     0 -124064.00    0   30 -123885.68 -124064.00  0.14%     -    0s
     0     0 -124063.77    0   30 -123885.68 -124063.77  0.14%     -    0s
     0     0 -124050.73    0   30 -123885.68 -124050.73  0.13%     -    0s
     0     0 -124049.56    0   30 -123885.68 -124049.56  0.13%     -    0s
     0     0 -123972.59    0    7 -123885.68 -123972.59  0.07%     -    0s
     0     0 -123970.97    0    6 -123885.68 -123970.97  0.07%     -    0s
H    0     0                    -123930.6811 -123970.97  0.03%     -    0s
H    0     0                    -123931.6936 -123970.97  0.03%     -    0s
     0     0 -123963.64    0    6 -123931.69 -123963.64  0.03%     -    0s
     0     0 -123963.64    0   25 -123931.69 -123963.64  0.03%     -    0s
     0     0 -123963.64    0   25 -123931.69 -123963.64  0.03%     -    0s
     0     0 -123941.38    0    4 -123931.69 -123941.38  0.01%     -    0s
*    0     0               0    -123941.0325 -123941.03  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 21
  Flow cover: 5
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (601 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123941 -123932 -123931 ... -101728
No other solutions better than -123941

Optimal solution found (tolerance 1.00e-06)
Best objective -1.239410324627e+05, best bound -1.239410324627e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 159496.02
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123941.03
  [DEBUG]   S×d_nominal = 283437.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283437.05 + -123941.03 = 159496.02
  [DEBUG]   Current θ from Master = 166089.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6593.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11551.40
  Lower Bound (LB) = 13017.48
  Gap (UB-LB) = 5127.0356, Absolute Gap = 5127.0356, Relative Gap = 0.282567
  Not converged yet (gap = 5127.04 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697599 nonzeros
Model fingerprint: 0x7e82a2d4
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100192 rows and 40672 columns
Presolve time: 2.49s
Presolved: 145831 rows, 61428 columns, 895429 nonzeros
Variable types: 59169 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.852e+06
 Factor NZ  : 1.717e+07 (roughly 220 MB of memory)
 Factor Ops : 6.984e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87402530e+07  2.47054360e+08  1.29e+05 1.91e+01  8.69e+04     4s
   1  -1.44960997e+07  2.21873328e+08  9.07e+04 7.13e+01  6.02e+04     4s
   2  -6.81290536e+06  1.77227729e+08  4.11e+04 6.53e-01  2.86e+04     4s
   3  -1.06780931e+06  1.37358666e+08  3.10e+03 1.86e+00  2.58e+03     4s
   4  -5.98778840e+05  4.72269108e+07  6.23e+02 2.91e-01  5.42e+02     5s
   5  -4.97736882e+05  3.45119474e+07  3.37e+02 1.80e-01  3.16e+02     5s
   6  -3.65822156e+05  2.51707779e+07  9.67e+01 1.19e-01  1.45e+02     5s
   7  -2.53833125e+05  1.89034354e+07  4.18e+01 8.46e-02  9.02e+01     5s
   8  -1.50727289e+05  1.63465419e+07  1.41e+01 7.15e-02  6.76e+01     5s
   9  -1.18812591e+05  6.67926125e+06  8.37e+00 2.60e-02  2.72e+01     5s
  10  -1.00258684e+05  3.09332175e+06  4.81e+00 1.14e-02  1.25e+01     5s
  11  -6.86491782e+04  1.34634349e+06  1.83e+00 4.76e-03  5.41e+00     5s
  12  -4.25369141e+04  5.16511611e+05  8.21e-01 1.73e-03  2.12e+00     5s
  13  -3.42815138e+04  3.60352965e+05  6.85e-01 1.65e-03  1.50e+00     5s
  14  -9.76906603e+03  2.25001935e+05  3.90e-01 1.06e-03  8.88e-01     5s
  15  -1.83265490e+03  1.78288701e+05  3.20e-01 9.61e-04  6.81e-01     5s
  16   9.35537746e+03  1.39633694e+05  2.38e-01 2.50e-03  4.92e-01     5s
  17   1.30826953e+04  1.08868833e+05  2.10e-01 2.80e-03  3.62e-01     5s
  18   1.78828948e+04  9.92378795e+04  1.78e-01 3.41e-03  3.08e-01     5s
  19   2.16238721e+04  8.70629833e+04  1.53e-01 2.88e-03  2.47e-01     5s
  20   2.60105709e+04  7.80085185e+04  1.25e-01 2.61e-03  1.97e-01     5s
  21   2.89509823e+04  7.28011379e+04  1.06e-01 1.98e-03  1.66e-01     6s
  22   3.03363051e+04  6.91968755e+04  9.72e-02 1.85e-03  1.47e-01     6s
  23   3.38695139e+04  6.64003651e+04  7.58e-02 1.68e-03  1.23e-01     6s
  24   3.61313194e+04  6.12837420e+04  6.26e-02 1.00e-03  9.51e-02     6s
  25   3.70545581e+04  5.92593700e+04  5.76e-02 9.48e-04  8.40e-02     6s
  26   3.83498326e+04  5.77894657e+04  5.10e-02 9.44e-04  7.35e-02     6s
  27   3.97729367e+04  5.57985569e+04  4.38e-02 1.03e-03  6.06e-02     6s
  28   4.13819530e+04  5.42556795e+04  3.59e-02 1.44e-03  4.87e-02     6s
  29   4.23030286e+04  5.31115729e+04  3.14e-02 9.19e-04  4.09e-02     6s
  30   4.35335123e+04  5.28189165e+04  2.56e-02 8.90e-04  3.51e-02     6s
  31   4.44945416e+04  5.18598994e+04  2.10e-02 6.98e-04  2.79e-02     6s
  32   4.51584854e+04  5.12097874e+04  1.80e-02 1.01e-03  2.29e-02     6s
  33   4.60255562e+04  5.09221048e+04  1.39e-02 8.61e-04  1.85e-02     6s
  34   4.66081928e+04  5.04140153e+04  1.11e-02 6.07e-04  1.44e-02     6s
  35   4.73257304e+04  4.99874303e+04  7.88e-03 3.85e-04  1.01e-02     7s
  36   4.77173448e+04  4.97759828e+04  6.16e-03 2.71e-04  7.79e-03     7s
  37   4.81804927e+04  4.96649539e+04  4.23e-03 2.15e-04  5.62e-03     7s
  38   4.83596013e+04  4.94642438e+04  3.45e-03 1.24e-04  4.18e-03     7s
  39   4.87237531e+04  4.93857059e+04  1.90e-03 8.97e-05  2.50e-03     7s
  40   4.89101324e+04  4.93376233e+04  1.12e-03 6.35e-05  1.62e-03     7s
  41   4.89544075e+04  4.92739726e+04  9.46e-04 3.46e-05  1.21e-03     7s
  42   4.90110892e+04  4.92656624e+04  7.23e-04 3.06e-05  9.63e-04     7s
  43   4.90593720e+04  4.92401114e+04  5.28e-04 1.89e-05  6.84e-04     7s
  44   4.91341302e+04  4.92201517e+04  2.30e-04 1.99e-05  3.25e-04     7s
  45   4.91610158e+04  4.92074042e+04  1.28e-04 8.62e-06  1.76e-04     7s
  46   4.91671667e+04  4.92040945e+04  1.05e-04 5.88e-06  1.40e-04     7s
  47   4.91864692e+04  4.92003352e+04  3.44e-05 2.70e-06  5.24e-05     7s
  48   4.91893053e+04  4.91979973e+04  2.46e-05 9.34e-07  3.29e-05     8s
  49   4.91956400e+04  4.91971116e+04  2.82e-06 2.57e-07  5.56e-06     8s
  50   4.91961287e+04  4.91967910e+04  1.57e-06 3.41e-07  2.51e-06     8s
  51   4.91967439e+04  4.91967513e+04  2.68e-08 4.40e-08  2.81e-08     8s
  52   4.91967511e+04  4.91967513e+04  2.57e-07 1.67e-07  5.91e-10     8s

Barrier solved model in 52 iterations and 7.87 seconds (14.04 work units)
Optimal objective 4.91967511e+04


Root crossover log...

  125536 DPushes remaining with DInf 0.0000000e+00                 8s
   30652 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    9076 PPushes remaining with PInf 8.3130455e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3542750e+01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70256    4.9196751e+04   0.000000e+00   2.354275e+01     14s
   70305    4.9196751e+04   0.000000e+00   0.000000e+00     14s
   70305    4.9196751e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 1.72s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.919675e+04, 70305 iterations, 12.80 seconds (27.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49196.7513    0  267 -233202.98 49196.7513   121%     -   16s
H    0     0                    -182560.8042 49196.7513   127%     -   17s
H    0     0                    -170553.4178 49196.7513   129%     -   17s
H    0     0                    -157874.1346 49196.7513   131%     -   18s
H    0     0                    -157823.6508 49196.7513   131%     -   18s
H    0     0                    -157402.8902 49196.7513   131%     -   19s
H    0     0                    -155642.3911 49196.7513   132%     -   19s
H    0     0                    -154671.9333 49196.7513   132%     -   19s
H    0     0                    -154414.0959 49196.7513   132%     -   19s
H    0     0                    -82788.47868 49196.7513   159%     -   19s
H    0     0                    -12427.73163 49196.7513   496%     -   19s
H    0     0                    -4236.062859 49196.7513  1261%     -   19s
H    0     0                    -4129.860701 49196.7513  1291%     -   19s
     0     0 42206.1855    0  317 -4129.8607 42206.1855  1122%     -   93s
H    0     0                    -2224.962173 42205.6700  1997%     -   94s
H    0     0                    -1857.788272 42205.6700  2372%     -   94s
     0     0 41631.4565    0  306 -1857.7883 41631.4565  2341%     -  120s
     0     0 41281.5642    0  293 -1857.7883 41281.5642  2322%     -  140s
     0     0 41225.4171    0  305 -1857.7883 41225.4171  2319%     -  147s
     0     0 41218.6848    0  294 -1857.7883 41218.6848  2319%     -  149s
     0     0 41190.7645    0  296 -1857.7883 41190.7645  2317%     -  152s
     0     0 41189.6923    0  297 -1857.7883 41189.6923  2317%     -  153s
     0     0 41188.6861    0  304 -1857.7883 41188.6861  2317%     -  155s
     0     0 41052.7995    0  337 -1857.7883 41052.7995  2310%     -  163s
     0     0 41048.9402    0  334 -1857.7883 41048.9402  2310%     -  164s
     0     0 41047.9155    0  340 -1857.7883 41047.9155  2310%     -  167s
     0     0 41047.6031    0  341 -1857.7883 41047.6031  2309%     -  168s
     0     0 37700.7326    0  367 -1857.7883 37700.7326  2129%     -  226s
H    0     0                    1639.0006003 37700.5568  2200%     -  227s
H    0     0                    2315.2629971 37700.5568  1528%     -  227s
H    0     0                    3585.1177085 37700.5568   952%     -  227s
H    0     0                    3904.4215069 37700.5568   866%     -  227s
H    0     0                    4447.8672079 37700.5568   748%     -  227s
H    0     0                    4459.3623653 37700.5568   745%     -  227s
     0     0 37112.9422    0  385 4459.36237 37112.9422   732%     -  265s
     0     0 36991.3108    0  395 4459.36237 36991.3108   730%     -  284s
     0     0 36666.3926    0  387 4459.36237 36666.3926   722%     -  308s
     0     0 36541.9663    0  372 4459.36237 36541.9663   719%     -  322s
     0     0 36464.6401    0  397 4459.36237 36464.6401   718%     -  334s
     0     0 36442.5071    0  401 4459.36237 36442.5071   717%     -  342s
     0     0 36422.9793    0  395 4459.36237 36422.9793   717%     -  351s
     0     0 36395.1923    0  401 4459.36237 36395.1923   716%     -  357s
     0     0 36385.3383    0  401 4459.36237 36385.3383   716%     -  360s
     0     0 36362.6669    0  401 4459.36237 36362.6669   715%     -  366s
     0     0 36361.7356    0  401 4459.36237 36361.7356   715%     -  368s
     0     0 33824.5947    0  378 4459.36237 33824.5947   659%     -  449s
H    0     0                    4564.0493849 33824.3638   641%     -  450s
     0     0 33297.1670    0  383 4564.04938 33297.1670   630%     -  479s
     0     0 33140.2681    0  393 4564.04938 33140.2681   626%     -  496s
     0     0 32978.4114    0  399 4564.04938 32978.4114   623%     -  511s
     0     0 32773.7753    0  433 4564.04938 32773.7753   618%     -  531s
     0     0 32705.6012    0  434 4564.04938 32705.6012   617%     -  539s
     0     0 32638.0241    0  423 4564.04938 32638.0241   615%     -  551s
     0     0 32539.6641    0  381 4564.04938 32539.6641   613%     -  560s
     0     0 32526.1684    0  415 4564.04938 32526.1684   613%     -  564s
     0     0 32521.1569    0  422 4564.04938 32521.1569   613%     -  566s
     0     0 32502.9227    0  426 4564.04938 32502.9227   612%     -  572s
     0     0 32495.0105    0  425 4564.04938 32495.0105   612%     -  576s
     0     0 32488.9422    0  418 4564.04938 32488.9422   612%     -  578s
     0     0 32486.9435    0  416 4564.04938 32486.9435   612%     -  580s
     0     0 31660.6289    0  458 4564.04938 31660.6289   594%     -  617s
H    0     0                    5477.6967314 31660.2157   478%     -  618s
H    0     0                    6384.8184627 31660.2157   396%     -  618s
H    0     0                    6616.6758504 31660.2157   378%     -  619s
H    0     0                    6902.0928223 31660.2157   359%     -  619s
H    0     0                    7173.8369702 31660.2157   341%     -  619s
H    0     0                    7460.6639086 31660.2157   324%     -  619s
H    0     0                    7878.7236348 31660.2157   302%     -  619s
H    0     0                    7969.9595584 31660.2157   297%     -  619s
H    0     0                    8136.8165018 31660.2157   289%     -  619s
H    0     0                    8248.5261265 31660.2157   284%     -  619s
     0     0 31487.3094    0  451 8248.52613 31487.3094   282%     -  635s
     0     0 31359.2606    0  465 8248.52613 31359.2606   280%     -  645s
     0     0 31311.5442    0  477 8248.52613 31311.5442   280%     -  655s
     0     0 31287.0682    0  477 8248.52613 31287.0682   279%     -  660s
     0     0 31275.5366    0  482 8248.52613 31275.5366   279%     -  664s
     0     0 31264.7234    0  491 8248.52613 31264.7234   279%     -  667s
     0     0 31222.1168    0  512 8248.52613 31222.1168   279%     -  673s
     0     0 31210.5824    0  482 8248.52613 31210.5824   278%     -  677s
     0     0 31204.4184    0  491 8248.52613 31204.4184   278%     -  681s
     0     0 31200.1384    0  491 8248.52613 31200.1384   278%     -  683s
     0     0 31199.6132    0  500 8248.52613 31199.6132   278%     -  684s
     0     0 31085.0136    0  446 8248.52613 31085.0136   277%     -  696s
H    0     0                    8251.4856556 31084.3478   277%     -  697s
     0     0 31047.8811    0  493 8251.48566 31047.8811   276%     -  704s
     0     0 31029.5225    0  452 8251.48566 31029.5225   276%     -  708s
     0     0 31026.3950    0  455 8251.48566 31026.3950   276%     -  710s
     0     0 31020.0011    0  457 8251.48566 31020.0011   276%     -  713s
     0     0 31016.3761    0  506 8251.48566 31016.3761   276%     -  715s
     0     0 31016.1110    0  512 8251.48566 31016.1110   276%     -  715s
     0     0 30968.3176    0  440 8251.48566 30968.3176   275%     -  726s
H    0     0                    9066.8417886 30968.1273   242%     -  728s
H    0     0                    9070.1327715 30968.1273   241%     -  728s
H    0     0                    9106.2324112 30968.1273   240%     -  729s
H    0     0                    9110.0814996 30968.1273   240%     -  729s
     0     0 30956.3487    0  494 9110.08150 30956.3487   240%     -  735s
     0     0 30952.9472    0  489 9110.08150 30952.9472   240%     -  738s
     0     0 30947.9144    0  455 9110.08150 30947.9144   240%     -  741s
     0     0 30945.3370    0  500 9110.08150 30945.3370   240%     -  743s
     0     0 30877.1739    0  513 9110.08150 30877.1739   239%     -  758s
     0     0 30867.9192    0  509 9110.08150 30867.9192   239%     -  764s
     0     0 30860.6219    0  510 9110.08150 30860.6219   239%     -  768s
     0     0 30858.2907    0  556 9110.08150 30858.2907   239%     -  770s
     0     0 30830.2138    0  502 9110.08150 30830.2138   238%     -  780s
     0     0 30820.4734    0  500 9110.08150 30820.4734   238%     -  786s
     0     0 30814.3262    0  508 9110.08150 30814.3262   238%     -  789s
     0     0 30813.2469    0  503 9110.08150 30813.2469   238%     -  791s
     0     0 30790.7383    0  513 9110.08150 30790.7383   238%     -  800s
     0     0 30788.8463    0  520 9110.08150 30788.8463   238%     -  803s
     0     0 30783.2102    0  528 9110.08150 30783.2102   238%     -  812s
H    0     0                    9374.1587909 30783.1889   228%     -  819s
H    0     0                    9745.6314011 30783.1889   216%     -  820s
     0     0 30780.6451    0  516 9745.63140 30780.6451   216%     -  823s
     0     0 30779.0563    0  513 9745.63140 30779.0563   216%     -  827s
H    0     0                    9943.3406607 30778.9504   210%     -  828s
H    0     0                    10018.084343 30778.9504   207%     -  828s
H    0     0                    10171.727710 30778.9504   203%     -  828s
H    0     0                    10253.062390 30778.9504   200%     -  828s
     0     0 30778.8080    0  566 10253.0624 30778.8080   200%     -  829s
     0     0 30777.9241    0  567 10253.0624 30777.9241   200%     -  832s
     0     0 30777.7002    0  567 10253.0624 30777.7002   200%     -  838s
H    0     0                    10504.123836 30776.1742   193%     -  878s
H    0     0                    11025.135316 30776.1742   179%     -  960s
H    0     0                    11168.545496 30776.1742   176%     -  962s
H    0     0                    11540.266215 30776.1742   167%     -  962s
H    0     0                    12036.740642 30776.1742   156%     -  962s
H    0     0                    12101.241177 30776.1742   154%     -  962s
H    0     0                    12735.484874 30776.1742   142%     -  962s
H    0     0                    12801.812584 30776.1742   140%     -  962s
H    0     0                    13431.619082 30776.1742   129%     -  980s
H    0     0                    13493.300475 30776.1742   128%     -  981s
H    0     2                    13735.302465 30776.1742   124%     -  995s
     0     2 30776.1742    0  567 13735.3025 30776.1742   124%     -  995s
     1     4 30600.2436    1  494 13735.3025 30774.7972   124%  9502 1006s
     3     8 30306.5574    2  453 13735.3025 30606.7963   123% 10358 1026s
     7    15 29968.1509    3  436 13735.3025 30306.5039   121% 12410 1049s
    14    30 29536.0541    4  434 13735.3025 30170.6897   120% 14217 1077s
    29    45 28985.2051    4  489 13735.3025 29796.4072   117% 20126 1138s
H   44    76                    13806.365289 29796.4072   116% 21749 1297s
H   45    76                    13835.430244 29796.4072   115% 21486 1297s
H   66    76                    13968.871440 29796.4072   113% 19232 1297s
    75   108 29016.4384    7  362 13968.8714 29677.5148   112% 20849 1351s
   107   148 28662.4582    8  414 13968.8714 29677.5148   112% 18507 1389s
H  108   148                    15554.159997 29677.5148  90.8% 18335 1389s
H  109   148                    16522.674653 29677.5148  79.6% 18289 1389s
H  117   148                    16563.061461 29677.5148  79.2% 17667 1389s
   147   257 28515.5888    9  431 16563.0615 29677.5148  79.2% 15869 1433s
   256   339 27892.6258   14  405 16563.0615 29677.5148  79.2% 11640 1463s
   338   404 27663.7860   17  370 16563.0615 29677.5148  79.2% 10295 1490s
   403   454 27499.4825   18  420 16563.0615 29677.5148  79.2%  9656 1516s
   453   504 27447.8483   20  412 16563.0615 29677.5148  79.2%  9436 1540s
   503   552 22279.5300   21  378 16563.0615 29677.5148  79.2%  9325 1565s
   551   601 22105.6043   23  364 16563.0615 29677.5148  79.2%  9202 1589s
   604   643 20874.2181   25  381 16563.0615 29677.5148  79.2%  9278 1613s
   652   667 17082.4722   27  313 16563.0615 29677.5148  79.2%  9449 1641s
   710   698 17076.3785   28  312 16563.0615 29677.5148  79.2%  9454 1666s
   769   727     cutoff   31      16563.0615 29677.5148  79.2%  9496 1691s
   833   772 infeasible   18      16563.0615 29677.5148  79.2%  9458 1718s
   904   793 22648.5012   11  379 16563.0615 29677.5148  79.2%  9296 1741s
H  905   793                    16754.061948 29677.5148  77.1%  9286 1741s
H  916   793                    16765.895110 29677.5148  77.0%  9279 1741s
   931   878 22514.1054   12  369 16765.8951 29677.5148  77.0%  9265 1763s
  1055   951 20983.7237   18  310 16765.8951 29677.5148  77.0%  8795 1789s
  1193  1002 18400.6955   14  322 16765.8951 29677.5148  77.0%  8258 1816s
  1306  1034 18077.1356   17  301 16765.8951 29677.5148  77.0%  8022 1841s
  1405  1112 17900.7869   21  308 16765.8951 29677.5148  77.0%  7870 1868s
  1507  1215 17345.6464   26  240 16765.8951 29677.5148  77.0%  7721 1893s
  1661  1305 infeasible   28      16765.8951 29677.5148  77.0%  7445 1921s
  1826  1425 19474.6081   13  237 16765.8951 29677.5148  77.0%  7179 1947s
  2015  1551 18449.9439   16  214 16765.8951 29677.5148  77.0%  6844 1977s
  2202  1618 infeasible   20      16765.8951 29677.5148  77.0%  6567 2002s
H 2205  1618                    16862.315416 29677.5148  76.0%  6569 2002s
H 2215  1618                    17032.628009 29677.5148  74.2%  6553 2002s
H 2253  1618                    17150.345033 29677.5148  73.0%  6490 2002s
H 2292  1618                    17173.664610 29677.5148  72.8%  6452 2002s
H 2293  1618                    17197.171501 29677.5148  72.6%  6451 2002s
  2335  1663 18121.4111   21  228 17197.1715 29677.5148  72.6%  6394 2033s
  2492  1680 17802.7566   25  214 17197.1715 29677.5148  72.6%  6276 2065s
  2602  1701 22809.2033   14  359 17197.1715 29677.5148  72.6%  6305 2098s
  2686  1743 22563.9275   16  338 17197.1715 29677.5148  72.6%  6435 2133s
  2774  1777 21725.8877   20  278 17197.1715 29677.5148  72.6%  6577 2166s
H 2862  1739                    17406.120772 29677.5148  70.5%  6732 2199s
H 2866  1739                    17424.888292 29677.5148  70.3%  6750 2199s
H 2898  1739                    17478.080465 29677.5148  69.8%  6827 2199s
  2903  1822 21280.8540   25  264 17478.0805 29677.5148  69.8%  6851 2232s
  3037  1821 20840.3887   31  251 17478.0805 29646.3512  69.6%  6914 2269s
  3198  1884 19794.0078   37  312 17478.0805 29646.3512  69.6%  6916 2303s
  3314  2021 19659.8292   39  330 17478.0805 29646.3512  69.6%  6867 2348s
  3519  2162 18946.9569   47  178 17478.0805 29623.5438  69.5%  6745 2392s
  3708  2240 18169.2288   64  204 17478.0805 29355.1315  68.0%  6701 2430s
  3859  2241 21033.9205   13  567 17478.0805 29355.1315  68.0%  6665 2671s
  3861  2242 17724.7474   43  199 17478.0805 29355.1315  68.0%  6661 2691s
  3862  2243 21070.9183   26  361 17478.0805 29355.1315  68.0%  6660 2783s
  3863  2244 19274.3019   16  411 17478.0805 29355.1315  68.0%  6658 2853s
  3864  2244 18419.2665   85  470 17478.0805 29355.1315  68.0%  6656 2909s
  3865  2245 24241.1737   23  442 17478.0805 29355.1315  68.0%  6654 2950s
  3866  2246 18219.4815   95  444 17478.0805 29355.1315  68.0%  6653 2975s
  3867  2246 28312.9404   11  448 17478.0805 29355.1315  68.0%  6651 3006s
  3868  2247 26968.8969   16  475 17478.0805 29355.1315  68.0%  6649 3022s
  3869  2248 18570.7976   80  467 17478.0805 29355.1315  68.0%  6648 3031s
  3870  2248 19950.2144   34  474 17478.0805 29355.1315  68.0%  6646 3044s
  3871  2249 20854.8583   26  470 17478.0805 29355.1315  68.0%  6644 3062s
  3872  2250 22112.0868   20  480 17478.0805 29355.1315  68.0%  6642 3073s
  3873  2250 21689.9601   25  478 17478.0805 29355.1315  68.0%  6641 3079s
  3874  2251 27494.6579   17  526 17478.0805 29355.1315  68.0%  6639 3088s
  3875  2252 27739.7143   14  497 17478.0805 29355.1315  68.0%  6637 3108s
  3876  2252 21413.4810   19  484 17478.0805 29355.1315  68.0%  6636 3117s
  3877  2253 19518.5713   23  503 17478.0805 29355.1315  68.0%  6634 3123s
  3878  2254 17802.9981   51  455 17478.0805 29355.1315  68.0%  6632 3127s
  3879  2254 28377.4893    7  536 17478.0805 29355.1315  68.0%  6630 3132s
  3880  2255 21647.1517   22  500 17478.0805 29355.1315  68.0%  6629 3138s
  3881  2256 21187.3347   25  489 17478.0805 29355.1315  68.0%  6627 3143s
  3882  2256 17897.8286   24  498 17478.0805 29355.1315  68.0%  6625 3158s
  3883  2257 22653.5490    8  456 17478.0805 29355.1315  68.0%  6624 3162s
  3884  2258 17780.4070   35  445 17478.0805 29355.1315  68.0%  6622 3166s
  3885  2258 20141.6427   31  446 17478.0805 29355.1315  68.0%  6620 3178s
  3886  2259 20840.9273   23  490 17478.0805 29355.1315  68.0%  6619 3186s
  3887  2260 23444.3677   25  502 17478.0805 29355.1315  68.0%  6617 3200s
  3888  2260 19386.7053   36  424 17478.0805 29355.1315  68.0%  6615 3206s
  3889  2261 19473.9372   26  435 17478.0805 29355.1315  68.0%  6613 3211s
  3890  2262 18132.8892   57  434 17478.0805 29355.1315  68.0%  6612 3224s
  3891  2262 18195.6574   75  449 17478.0805 29355.1315  68.0%  6610 3229s
  3892  2263 18143.0795   42  433 17478.0805 29355.1315  68.0%  6608 3237s
  3893  2264 26520.9505   11  432 17478.0805 29355.1315  68.0%  6607 3241s
  3894  2264 17695.6506   66  436 17478.0805 29355.1315  68.0%  6605 3249s
  3895  2265 17953.7815   83  444 17478.0805 29355.1315  68.0%  6603 3254s
  3896  2266 26044.8230   30  442 17478.0805 29355.1315  68.0%  6602 3263s
  3897  2266 18268.8292   62  430 17478.0805 29355.1315  68.0%  6600 3269s
  3898  2267 22660.5859   13  434 17478.0805 29355.1315  68.0%  6598 3277s
  3899  2268 18097.2806   33  434 17478.0805 29355.1315  68.0%  6596 3298s
H 3899  2153                    17510.662748 29355.1315  67.6%  6596 3383s
  3900  2153 20677.1557   29  434 17510.6627 29355.1315  67.6%  6595 3385s
  3901  2156 29355.1315   10  373 17510.6627 29355.1315  67.6%  6706 3433s
  3902  2159 29251.8221   11  307 17510.6627 29355.1315  67.6%  6707 3461s
  3905  2164 29012.2780   12  384 17510.6627 29355.1315  67.6%  6710 3502s
  3911  2174 28780.6449   13  385 17510.6627 29355.1315  67.6%  6722 3543s
  3923  2176 27349.5911   13  343 17510.6627 29355.1315  67.6%  6775 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  Projected implied bound: 189
  MIR: 1188
  Flow cover: 1882
  RLT: 29
  Relax-and-lift: 268

Explored 3929 nodes (27438654 simplex iterations) in 3600.11 seconds (9179.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17510.7 17478.1 17424.9 ... 16765.9

Time limit reached
Best objective 1.751066274753e+04, best bound 2.935513153755e+04, gap 67.6415%
  WARNING: Time limit reached. Using best solution found (gap: 67.64%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 17510.66, θ = 169639.87
  Upper Bound (UB) = 17510.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169639.87
  [DEBUG]   ✓ Scenario 0: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169639.87 ≤ Q = 170493.35 (slack: 853.48)
  [DEBUG]   ✓ Scenario 4: θ = 169639.87 ≤ Q = 170430.76 (slack: 790.89)
  [DEBUG]   ✓ Scenario 5: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169639.87 ≤ Q = 169639.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169639.87 ≤ Q = 169639.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169639.87 ≤ Q = 169639.87 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x517e973c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x517e973c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.259221e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6978176.1556
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.396494e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139649.42    0  123 6978176.16 -139649.42   102%     -    0s
H    0     0                    -103065.8184 -139649.42  35.5%     -    0s
H    0     0                    -104711.8686 -139649.42  33.4%     -    0s
     0     0 -113770.53    0  108 -104711.87 -113770.53  8.65%     -    0s
H    0     0                    -111121.9084 -113720.77  2.34%     -    0s
     0     0 -113009.81    0   99 -111121.91 -113009.81  1.70%     -    0s
H    0     0                    -111395.8652 -113004.50  1.44%     -    0s
     0     0 -112901.36    0   97 -111395.87 -112901.36  1.35%     -    0s
H    0     0                    -111437.1782 -112901.36  1.31%     -    0s
H    0     0                    -111451.5002 -112901.36  1.30%     -    0s
     0     0 -112210.83    0   92 -111451.50 -112210.83  0.68%     -    0s
     0     0 -112194.96    0   90 -111451.50 -112194.96  0.67%     -    0s
     0     0 -112034.97    0   85 -111451.50 -112034.97  0.52%     -    0s
     0     0 -112033.22    0   85 -111451.50 -112033.22  0.52%     -    0s
     0     2 -112033.22    0   85 -111451.50 -112033.22  0.52%     -    0s
H   39    16                    -111505.8061 -111837.26  0.30%  14.3    0s
H  121    81                    -111506.2696 -111755.61  0.22%   8.9    0s
H 1338   350                    -111518.9687 -111755.61  0.21%   5.0    0s
H 1401   350                    -111519.2139 -111755.61  0.21%   4.9    0s

Cutting planes:
  Gomory: 60
  Implied bound: 8
  MIR: 198
  Flow cover: 9
  RLT: 5
  BQP: 1

Explored 3657 nodes (17122 simplex iterations) in 0.18 seconds (0.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -111519 -111519 -111506 ... 6.97818e+06
No other solutions better than -111519

Optimal solution found (tolerance 1.00e-06)
Best objective -1.115192139216e+05, best bound -1.115192139216e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 165289.95
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111519.21
  [DEBUG]   S×d_nominal = 276809.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276809.16 + -111519.21 = 165289.95
  [DEBUG]   Current θ from Master = 169639.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4349.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13160.74
  Lower Bound (LB) = 13160.74
  Gap (UB-LB) = 4349.9235, Absolute Gap = 4349.9235, Relative Gap = 0.248416
  Not converged yet (gap = 4349.92 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740854 nonzeros
Model fingerprint: 0x16077010
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106454 rows and 43214 columns
Presolve time: 2.81s
Presolved: 154859 rows, 65126 columns, 950925 nonzeros
Variable types: 62867 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 7.642e+06
 Factor NZ  : 1.757e+07 (roughly 230 MB of memory)
 Factor Ops : 4.349e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91895118e+07  2.60457912e+08  1.33e+05 1.87e+01  8.86e+04     5s
   1  -1.48883311e+07  2.35015023e+08  9.34e+04 7.03e+01  6.16e+04     5s
   2  -7.11241638e+06  1.87386533e+08  4.31e+04 9.92e-01  2.98e+04     5s
   3  -1.05183398e+06  1.45812692e+08  2.95e+03 2.27e+00  2.47e+03     5s
   4  -6.06226548e+05  5.11794002e+07  6.33e+02 3.43e-01  5.51e+02     5s
   5  -5.05310027e+05  3.72244221e+07  3.41e+02 2.12e-01  3.20e+02     5s
   6  -3.78876824e+05  2.71552685e+07  9.75e+01 1.41e-01  1.47e+02     5s
   7  -2.74818760e+05  2.03048235e+07  4.23e+01 9.86e-02  9.12e+01     5s
   8  -2.04595769e+05  1.77753006e+07  2.46e+01 8.52e-02  7.35e+01     5s
   9  -1.56860103e+05  1.27915454e+07  1.62e+01 5.89e-02  5.09e+01     5s
  10  -1.20292760e+05  5.68455776e+06  9.22e+00 2.36e-02  2.21e+01     5s
  11  -8.76241860e+04  2.03827534e+06  3.76e+00 7.68e-03  7.80e+00     5s
  12  -5.64870609e+04  7.18526560e+05  1.41e+00 2.49e-03  2.79e+00     6s
  13  -4.11794165e+04  3.97623157e+05  9.27e-01 1.34e-03  1.57e+00     6s
  14  -2.09098480e+04  3.20293146e+05  6.05e-01 1.22e-03  1.22e+00     6s
  15  -6.98919586e+03  1.95454347e+05  4.00e-01 9.40e-04  7.22e-01     6s
  16   3.36196301e+03  1.31282927e+05  3.04e-01 1.51e-03  4.56e-01     6s
  17   9.67995632e+03  1.14227458e+05  2.59e-01 1.92e-03  3.73e-01     6s
  18   1.59503873e+04  9.85969593e+04  2.14e-01 2.33e-03  2.95e-01     6s
  19   1.96635812e+04  8.86214136e+04  1.87e-01 2.52e-03  2.46e-01     6s
  20   2.56248308e+04  8.15469018e+04  1.43e-01 1.99e-03  1.99e-01     6s
  21   2.83607237e+04  7.72841213e+04  1.22e-01 1.85e-03  1.74e-01     6s
  22   2.91145096e+04  7.48927464e+04  1.16e-01 1.88e-03  1.63e-01     6s
  23   3.20825486e+04  6.89810377e+04  9.58e-02 1.53e-03  1.32e-01     6s
  24   3.55744790e+04  6.54930943e+04  7.24e-02 1.40e-03  1.07e-01     6s
  25   3.73236771e+04  6.12343370e+04  6.16e-02 1.35e-03  8.52e-02     6s
  26   3.86582320e+04  5.92608401e+04  5.38e-02 1.36e-03  7.34e-02     6s
  27   4.03005834e+04  5.73704893e+04  4.44e-02 1.11e-03  6.08e-02     6s
  28   4.15880751e+04  5.59223070e+04  3.74e-02 9.30e-04  5.11e-02     7s
  29   4.23478087e+04  5.49143305e+04  3.32e-02 9.78e-04  4.48e-02     7s
  30   4.38581797e+04  5.37579214e+04  2.54e-02 9.96e-04  3.53e-02     7s
  31   4.51088880e+04  5.27637698e+04  1.91e-02 9.14e-04  2.73e-02     7s
  32   4.57081452e+04  5.16204047e+04  1.61e-02 7.02e-04  2.11e-02     7s
  33   4.66383999e+04  5.10990303e+04  1.16e-02 5.16e-04  1.59e-02     7s
  34   4.67722144e+04  5.05357534e+04  1.10e-02 3.52e-04  1.34e-02     7s
  35   4.75140694e+04  5.02376947e+04  7.56e-03 2.78e-04  9.71e-03     7s
  36   4.76713699e+04  5.00941295e+04  6.86e-03 2.22e-04  8.64e-03     7s
  37   4.82491969e+04  4.98219847e+04  4.29e-03 3.48e-04  5.61e-03     7s
  38   4.84489456e+04  4.95989467e+04  3.41e-03 2.11e-04  4.10e-03     7s
  39   4.88271028e+04  4.94814612e+04  1.83e-03 8.63e-05  2.33e-03     7s
  40   4.89682925e+04  4.93931766e+04  1.21e-03 1.18e-04  1.51e-03     7s
  41   4.90770319e+04  4.93484193e+04  7.55e-04 7.67e-05  9.68e-04     7s
  42   4.91348012e+04  4.93210816e+04  5.26e-04 5.12e-05  6.64e-04     8s
  43   4.91446200e+04  4.93124028e+04  4.86e-04 4.28e-05  5.98e-04     8s
  44   4.91849291e+04  4.92994860e+04  3.27e-04 2.99e-05  4.08e-04     8s
  45   4.92404144e+04  4.92762268e+04  1.04e-04 6.64e-06  1.28e-04     8s
  46   4.92663166e+04  4.92720477e+04  7.30e-06 5.25e-06  2.04e-05     8s
  47   4.92683838e+04  4.92694313e+04  1.38e-07 1.40e-06  3.71e-06     8s
  48   4.92684125e+04  4.92684781e+04  7.52e-08 2.75e-08  2.34e-07     8s
  49   4.92684589e+04  4.92684624e+04  5.22e-08 4.13e-09  1.27e-08     8s
  50   4.92684604e+04  4.92684614e+04  4.65e-07 4.77e-10  3.47e-09     8s
  51   4.92684614e+04  4.92684614e+04  3.75e-08 1.18e-09  4.72e-11     8s

Barrier solved model in 51 iterations and 8.26 seconds (14.74 work units)
Optimal objective 4.92684614e+04


Root crossover log...

  133255 DPushes remaining with DInf 0.0000000e+00                 8s
   31269 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2843 PPushes remaining with PInf 8.3675379e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0805715e-01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59778    4.9268461e+04   0.000000e+00   1.080572e-01     14s
   59779    4.9268461e+04   0.000000e+00   0.000000e+00     14s
   59779    4.9268461e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 1.26s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.926846e+04, 59779 iterations, 11.36 seconds (24.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49268.4614    0  269 -233202.98 49268.4614   121%     -   15s
H    0     0                    -229187.9400 49268.4614   121%     -   15s
H    0     0                    -141108.7201 49268.4614   135%     -   16s
H    0     0                    -139686.5113 49268.4614   135%     -   16s
H    0     0                    -136695.2047 49268.4614   136%     -   16s
H    0     0                    -136430.7215 49268.4614   136%     -   16s
H    0     0                    -136353.3541 49268.4614   136%     -   16s
H    0     0                    -136184.0654 49268.4614   136%     -   16s
H    0     0                    -82283.44073 49268.4614   160%     -   16s
H    0     0                    -4306.192408 49268.4614  1244%     -   17s
H    0     0                    -4303.411016 49268.4614  1245%     -   17s
H    0     0                    -4129.860701 49268.4614  1293%     -   17s
     0     0 42021.6482    0  322 -4129.8607 42021.6482  1118%     -   93s
H    0     0                    -2406.239044 42021.6422  1846%     -   93s
H    0     0                    -1905.230220 42021.6422  2306%     -   94s
H    0     0                    -1882.324079 42021.6422  2332%     -   94s
H    0     0                    -1870.023437 42021.6422  2347%     -   94s
     0     0 41216.4378    0  332 -1870.0234 41216.4378  2304%     -  128s
     0     0 41175.0617    0  322 -1870.0234 41175.0617  2302%     -  136s
     0     0 41115.8278    0  324 -1870.0234 41115.8278  2299%     -  145s
     0     0 41112.8491    0  328 -1870.0234 41112.8491  2299%     -  147s
     0     0 40935.9693    0  354 -1870.0234 40935.9693  2289%     -  154s
     0     0 40933.0334    0  355 -1870.0234 40933.0334  2289%     -  158s
     0     0 40930.1142    0  354 -1870.0234 40930.1142  2289%     -  161s
     0     0 40930.1142    0  354 -1870.0234 40930.1142  2289%     -  162s
     0     0 37693.7895    0  368 -1870.0234 37693.7895  2116%     -  219s
H    0     0                    1355.8401546 37693.6047  2680%     -  220s
H    0     0                    1630.2290370 37693.6047  2212%     -  220s
H    0     0                    1797.1677484 37693.6047  1997%     -  220s
H    0     0                    1944.1027332 37693.6047  1839%     -  220s
H    0     0                    1945.5707118 37693.6047  1837%     -  220s
H    0     0                    1986.0769709 37693.6047  1798%     -  220s
H    0     0                    2072.4330601 37693.6047  1719%     -  220s
     0     0 36515.5947    0  378 2072.43306 36515.5947  1662%     -  256s
     0     0 36296.0714    0  385 2072.43306 36296.0714  1651%     -  275s
     0     0 36281.8091    0  388 2072.43306 36281.8091  1651%     -  279s
     0     0 36271.9915    0  386 2072.43306 36271.9915  1650%     -  283s
     0     0 36265.7953    0  389 2072.43306 36265.7953  1650%     -  286s
     0     0 36258.0030    0  393 2072.43306 36258.0030  1650%     -  290s
     0     0 36191.6074    0  387 2072.43306 36191.6074  1646%     -  303s
     0     0 36179.3613    0  385 2072.43306 36179.3613  1646%     -  306s
     0     0 36177.6929    0  381 2072.43306 36177.6929  1646%     -  310s
     0     0 36177.2399    0  383 2072.43306 36177.2399  1646%     -  311s
     0     0 33499.6074    0  407 2072.43306 33499.6074  1516%     -  394s
     0     0 33166.6514    0  416 2072.43306 33166.6514  1500%     -  420s
     0     0 33062.5538    0  435 2072.43306 33062.5538  1495%     -  436s
     0     0 33009.9929    0  424 2072.43306 33009.9929  1493%     -  448s
     0     0 32977.9521    0  427 2072.43306 32977.9521  1491%     -  457s
     0     0 32922.3135    0  434 2072.43306 32922.3135  1489%     -  472s
     0     0 32901.9732    0  430 2072.43306 32901.9732  1488%     -  480s
     0     0 32813.6742    0  397 2072.43306 32813.6742  1483%     -  489s
     0     0 32787.5897    0  469 2072.43306 32787.5897  1482%     -  495s
     0     0 32780.3633    0  458 2072.43306 32780.3633  1482%     -  499s
     0     0 32698.4248    0  457 2072.43306 32698.4248  1478%     -  508s
     0     0 32644.3182    0  465 2072.43306 32644.3182  1475%     -  517s
     0     0 32628.4815    0  463 2072.43306 32628.4815  1474%     -  523s
     0     0 32588.4267    0  452 2072.43306 32588.4267  1472%     -  530s
     0     0 32576.8301    0  451 2072.43306 32576.8301  1472%     -  535s
     0     0 32571.9230    0  455 2072.43306 32571.9230  1472%     -  538s
     0     0 32570.0143    0  459 2072.43306 32570.0143  1472%     -  538s
     0     0 31707.7997    0  412 2072.43306 31707.7997  1430%     -  584s
H    0     0                    3600.0194700 31707.1547   781%     -  585s
H    0     0                    4758.6729606 31707.1547   566%     -  585s
H    0     0                    8055.2436568 31707.1547   294%     -  586s
H    0     0                    8137.7687920 31707.1547   290%     -  586s
H    0     0                    8160.5475895 31707.1547   289%     -  586s
H    0     0                    8174.6377891 31707.1547   288%     -  586s
H    0     0                    8250.5169679 31707.1547   284%     -  586s
H    0     0                    8313.1576581 31707.1547   281%     -  586s
H    0     0                    8417.8923680 31707.1547   277%     -  586s
H    0     0                    8439.5201285 31707.1547   276%     -  586s
H    0     0                    8504.4937788 31707.1547   273%     -  586s
     0     0 31571.9904    0  421 8504.49378 31571.9904   271%     -  602s
     0     0 31480.5071    0  423 8504.49378 31480.5071   270%     -  617s
     0     0 31421.9184    0  439 8504.49378 31421.9184   269%     -  624s
     0     0 31378.5916    0  423 8504.49378 31378.5916   269%     -  633s
     0     0 31354.3337    0  443 8504.49378 31354.3337   269%     -  639s
     0     0 31335.8414    0  450 8504.49378 31335.8414   268%     -  646s
     0     0 31330.0079    0  444 8504.49378 31330.0079   268%     -  650s
     0     0 31329.3840    0  450 8504.49378 31329.3840   268%     -  651s
     0     0 31183.8348    0  475 8504.49378 31183.8348   267%     -  674s
     0     0 31156.6567    0  480 8504.49378 31156.6567   266%     -  685s
     0     0 31143.1696    0  435 8504.49378 31143.1696   266%     -  690s
     0     0 31119.9870    0  483 8504.49378 31119.9870   266%     -  697s
     0     0 31114.4496    0  499 8504.49378 31114.4496   266%     -  700s
     0     0 31113.2997    0  497 8504.49378 31113.2997   266%     -  701s
     0     0 31077.3690    0  515 8504.49378 31077.3690   265%     -  713s
H    0     0                    9720.3547044 31077.2664   220%     -  717s
H    0     0                    10058.289070 31077.2664   209%     -  717s
     0     0 31065.6767    0  531 10058.2891 31065.6767   209%     -  725s
     0     0 31053.6538    0  529 10058.2891 31053.6538   209%     -  729s
     0     0 31050.5784    0  537 10058.2891 31050.5784   209%     -  732s
     0     0 31045.9842    0  448 10058.2891 31045.9842   209%     -  736s
     0     0 31042.8184    0  542 10058.2891 31042.8184   209%     -  738s
     0     0 31041.7470    0  452 10058.2891 31041.7470   209%     -  739s
     0     0 31001.8492    0  485 10058.2891 31001.8492   208%     -  751s
     0     0 30996.7731    0  451 10058.2891 30996.7731   208%     -  755s
     0     0 30995.2586    0  500 10058.2891 30995.2586   208%     -  757s
     0     0 30960.9376    0  442 10058.2891 30960.9376   208%     -  767s
H    0     0                    10387.002126 30960.8705   198%     -  769s
H    0     0                    10618.454696 30960.8705   192%     -  770s
     0     0 30940.6109    0  450 10618.4547 30940.6109   191%     -  776s
     0     0 30932.6694    0  448 10618.4547 30932.6694   191%     -  779s
     0     0 30927.8437    0  446 10618.4547 30927.8437   191%     -  782s
     0     0 30925.3455    0  452 10618.4547 30925.3455   191%     -  784s
     0     0 30903.9394    0  433 10618.4547 30903.9394   191%     -  792s
H    0     0                    10697.950690 30903.9272   189%     -  792s
     0     0 30896.2913    0  492 10697.9507 30896.2913   189%     -  798s
     0     0 30893.5605    0  448 10697.9507 30893.5605   189%     -  800s
     0     0 30892.0876    0  504 10697.9507 30892.0876   189%     -  802s
     0     0 30884.6247    0  497 10697.9507 30884.6247   189%     -  811s
H    0     0                    10933.889403 30884.5450   182%     -  813s
H    0     0                    11550.889609 30884.5450   167%     -  813s
H    0     0                    11618.444938 30884.5450   166%     -  813s
     0     0 30883.5764    0  503 11618.4449 30883.5764   166%     -  816s
     0     0 30880.0223    0  453 11618.4449 30880.0223   166%     -  822s
     0     0 30879.5576    0  461 11618.4449 30879.5576   166%     -  824s
     0     0 30878.6811    0  455 11618.4449 30878.6811   166%     -  829s
     0     0 30877.6109    0  455 11618.4449 30877.6109   166%     -  835s
H    0     0                    11672.252470 30877.6109   165%     -  970s
H    0     0                    15252.460028 30877.6109   102%     -  983s
H    0     2                    15858.449648 30877.6109  94.7%     - 1003s
     0     2 30877.6109    0  455 15858.4496 30877.6109  94.7%     - 1003s
     1     3 30563.0491    1  440 15858.4496 30877.6109  94.7% 23274 1029s
     2     6 29812.7148    2  437 15858.4496 30877.6109  94.7% 23124 1055s
     5    12 29701.0110    3  448 15858.4496 30499.0567  92.3% 17712 1115s
    11    24 29567.3880    4  446 15858.4496 30310.8219  91.1% 18819 1144s
    23    36 28874.0496    5  361 15858.4496 29983.7246  89.1% 23086 1205s
H   35    67                    16142.301288 29983.7246  85.7% 24720 1370s
H   38    67                    16419.292116 29983.7246  82.6% 24491 1370s
H   42    67                    16572.491739 29983.7246  80.9% 23515 1370s
H   43    67                    16597.144380 29983.7246  80.7% 23282 1370s
H   57    67                    16616.017656 29983.7246  80.5% 20290 1370s
H   66   114                    16680.873210 29801.0474  78.7% 28950 1428s
H   71   114                    16893.748057 29801.0474  76.4% 27386 1428s
H   72   114                    16897.642942 29801.0474  76.4% 27119 1428s
H   81   114                    17135.327934 29800.9150  73.9% 25208 1428s
H  109   114                    17206.670947 29780.7359  73.1% 20975 1428s
H  113   255                    17207.733012 29780.7359  73.1% 20641 1484s
H  127   255                    17305.658876 29780.7359  72.1% 19194 1484s
   254   319 28103.4881   10  299 17305.6589 29780.7359  72.1% 12994 1527s
   318   379 27125.5936   10  305 17305.6589 29780.7359  72.1% 11604 1561s
   380   428 27526.4420   12  309 17305.6589 29780.7359  72.1% 11054 1597s
   429   457 27664.6903   12  296 17305.6589 29780.7359  72.1% 11082 1625s
   458   491 26718.5291   13  292 17305.6589 29780.7359  72.1% 11065 1654s
   492   530 27136.1993   13  305 17305.6589 29780.7359  72.1% 10963 1687s
H  520   530                    17395.700532 29780.7359  71.2% 10820 1687s
   531   584 25764.5387   14  285 17395.7005 29780.7359  71.2% 10844 1726s
   585   642 21252.8936   29  357 17395.7005 29780.7359  71.2% 10601 1752s
   643   701 25232.1834   15  295 17395.7005 29780.7359  71.2% 10476 1772s
   710   763 25191.2883   16  264 17395.7005 29780.7359  71.2% 10301 1796s
   778   813 21034.8998   17  270 17395.7005 29780.7359  71.2% 10115 1819s
   838   864 20976.2993   18  249 17395.7005 29780.7359  71.2%  9948 1843s
   893   937 infeasible   18      17395.7005 29780.7359  71.2%  9900 1866s
   978   988 20416.5227   20  244 17395.7005 29780.7359  71.2%  9777 1889s
  1033  1040 19416.5741   22  232 17395.7005 29780.7359  71.2%  9764 1908s
  1093  1138 19246.1498   23  219 17395.7005 29780.7359  71.2%  9722 1929s
  1205  1200 18932.0134   24  230 17395.7005 29753.3428  71.0%  9338 1953s
  1310  1248 infeasible   24      17395.7005 29753.3428  71.0%  9066 1981s
  1402  1288 18390.5591   26  233 17395.7005 29753.3428  71.0%  8858 2009s
  1482  1348 18255.7419   27  226 17395.7005 29753.3428  71.0%  8969 2039s
  1552  1373 infeasible   29      17395.7005 29753.3428  71.0%  9065 2062s
  1593  1404     cutoff   30      17395.7005 29753.3428  71.0%  9188 2088s
  1647  1417 infeasible   34      17395.7005 29686.6310  70.7%  9178 2126s
  1700  1437 24483.9268    6  336 17395.7005 29648.7932  70.4%  9250 2156s
H 1715  1437                    17443.547879 29648.7932  70.0%  9269 2156s
  1746  1497 24195.0231    7  326 17443.5479 29648.7932  70.0%  9350 2189s
  1860  1546 22473.6125    9  271 17443.5479 29648.7932  70.0%  9333 2222s
  1967  1610 22446.8554   10  266 17443.5479 29616.4206  69.8%  9348 2260s
  2085  1672 21470.7492   12  221 17443.5479 29616.4206  69.8%  9402 2302s
  2189  1695 19168.5126   15  224 17443.5479 29405.3558  68.6%  9480 2344s
H 2217  1695                    17456.149890 29375.2656  68.3%  9557 2344s
  2226  1813 19167.4122   16  220 17456.1499 29375.2656  68.3%  9569 2384s
  2370  1836 17863.0152   21  187 17456.1499 29262.3930  67.6%  9526 2423s
  2407  1859 17593.7017   22  150 17456.1499 29262.3930  67.6%  9565 2457s
H 2415  1857                    17477.296152 29262.3930  67.4%  9561 2457s
  2444  1985     cutoff   23      17477.2962 29262.3930  67.4%  9590 2498s
  2632  2085 17656.3155   25  150 17477.2962 29262.3930  67.4%  9489 2542s
  2830  2157 23101.3909   13  406 17477.2962 29182.0951  67.0%  9312 2589s
  3006  2223 22823.7396   15  307 17477.2962 29182.0951  67.0%  9263 2637s
  3112  2340 21555.8675   16  269 17477.2962 29028.0479  66.1%  9290 2687s
  3313  2438 20071.3080   18  231 17477.2962 29028.0479  66.1%  9208 2741s
  3473  2452     cutoff   21      17477.2962 29028.0479  66.1%  9247 2786s
H 3503  2452                    17483.713406 29028.0479  66.0%  9294 2786s
  3523  2552 infeasible   20      17483.7134 28983.7356  65.8%  9309 2846s
  3714  2636 24457.5893   14  283 17483.7134 28983.7356  65.8%  9301 2912s
  3890  2752     cutoff   15      17483.7134 28934.5203  65.5%  9341 2974s
  4080  2782 27491.1099    8  341 17483.7134 28906.2648  65.3%  9383 3023s
H 4083  2782                    17503.995434 28906.2648  65.1%  9381 3023s
H 4084  2777                    17562.392193 28906.2648  64.6%  9379 3023s
H 4102  2769                    17615.210175 28906.2648  64.1%  9408 3023s
  4135  2766 27937.1892    8  455 17615.2102 28906.2648  64.1%  9403 3339s
  4137  2767 27846.7396   16  197 17615.2102 28906.2648  64.1%  9399 3361s
  4138  2768 26841.7822   12  320 17615.2102 28906.2648  64.1%  9397 3468s
  4139  2769 18968.9496   29  436 17615.2102 28906.2648  64.1%  9394 3556s

Cutting planes:
  Gomory: 21
  Implied bound: 2
  Projected implied bound: 214
  MIR: 1111
  Mixing: 2
  Flow cover: 1113
  RLT: 19
  Relax-and-lift: 179

Explored 4139 nodes (39797082 simplex iterations) in 3600.08 seconds (9338.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17615.2 17562.4 17504 ... 17207.7

Time limit reached
Best objective 1.761521017520e+04, best bound 2.890626477004e+04, gap 64.0983%
  WARNING: Time limit reached. Using best solution found (gap: 64.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 17615.21, θ = 169627.84
  Upper Bound (UB) = 17615.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169627.84
  [DEBUG]   ✓ Scenario 0: θ = 169627.84 ≤ Q = 169627.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169627.84 ≤ Q = 169627.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169627.84 ≤ Q = 169627.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169627.84 ≤ Q = 169627.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x49f5fb2c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb60a04d4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.251091e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6933981.9558
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.394582e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139458.18    0  122 6933981.96 -139458.18   102%     -    0s
H    0     0                    -102927.6955 -139458.18  35.5%     -    0s
H    0     0                    -104432.2437 -139458.18  33.5%     -    0s
     0     0 -113043.47    0   56 -104432.24 -113043.47  8.25%     -    0s
H    0     0                    -111143.0837 -113025.50  1.69%     -    0s
H    0     0                    -112345.1513 -113025.50  0.61%     -    0s
     0     0 -112559.95    0   50 -112345.15 -112559.95  0.19%     -    0s
     0     0 -112536.36    0   33 -112345.15 -112536.36  0.17%     -    0s
     0     0 -112528.12    0   26 -112345.15 -112528.12  0.16%     -    0s
     0     0 -112526.87    0   25 -112345.15 -112526.87  0.16%     -    0s
     0     0 -112410.49    0   10 -112345.15 -112410.49  0.06%     -    0s
     0     0 -112410.49    0   23 -112345.15 -112410.49  0.06%     -    0s
*    0     0               0    -112367.4955 -112367.50  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 19
  Flow cover: 6
  RLT: 1

Explored 1 nodes (608 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -112367 -112345 -104432 ... 1.25109e+13
No other solutions better than -112367

Optimal solution found (tolerance 1.00e-06)
Best objective -1.123674955267e+05, best bound -1.123674955267e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 164196.54
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112367.50
  [DEBUG]   S×d_nominal = 276564.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276564.04 + -112367.50 = 164196.54
  [DEBUG]   Current θ from Master = 169627.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5431.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12183.91
  Lower Bound (LB) = 13160.74
  Gap (UB-LB) = 4454.4710, Absolute Gap = 4454.4710, Relative Gap = 0.252876
  Not converged yet (gap = 4454.47 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 784109 nonzeros
Model fingerprint: 0xdcc5d3e0
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 112716 rows and 45756 columns
Presolve time: 2.98s
Presolved: 163887 rows, 68824 columns, 1006437 nonzeros
Variable types: 66565 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 8.478e+06
 Factor NZ  : 1.948e+07 (roughly 250 MB of memory)
 Factor Ops : 5.057e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.95894233e+07  2.73058757e+08  1.36e+05 1.84e+01  8.99e+04     5s
   1  -1.52800378e+07  2.47096206e+08  9.59e+04 7.06e+01  6.28e+04     5s
   2  -6.96532336e+06  1.97973918e+08  4.33e+04 1.16e+00  2.98e+04     5s
   3  -1.20054226e+06  1.57560278e+08  3.18e+03 1.83e+00  2.62e+03     5s
   4  -6.71050213e+05  6.46175939e+07  6.43e+02 3.78e-01  5.96e+02     5s
   5  -5.88118013e+05  4.44184199e+07  3.31e+02 2.19e-01  3.32e+02     5s
   6  -4.24414064e+05  3.10005422e+07  9.44e+01 1.35e-01  1.53e+02     5s
   7  -3.14566831e+05  2.30237897e+07  3.97e+01 9.43e-02  9.55e+01     6s
   8  -2.09747004e+05  1.69101744e+07  1.34e+01 6.65e-02  6.21e+01     6s
   9  -1.62462578e+05  1.26433961e+07  8.46e+00 4.84e-02  4.53e+01     6s
  10  -1.35129763e+05  7.63749360e+06  5.90e+00 2.84e-02  2.71e+01     6s
  11  -1.05514963e+05  2.63632489e+06  2.85e+00 8.83e-03  9.40e+00     6s
  12  -6.85285786e+04  1.32492329e+06  9.57e-01 4.29e-03  4.71e+00     6s
  13  -4.35416482e+04  5.35648347e+05  4.81e-01 1.74e-03  1.95e+00     6s
  14  -2.69348513e+04  3.94191214e+05  3.13e-01 1.36e-03  1.41e+00     6s
  15  -7.34563010e+03  2.76304610e+05  1.87e-01 1.20e-03  9.52e-01     6s
  16   4.00440089e+03  1.70549103e+05  1.37e-01 2.24e-03  5.59e-01     6s
  17   9.02278018e+03  1.45089670e+05  1.18e-01 2.27e-03  4.57e-01     6s
  18   1.82224028e+04  1.16825303e+05  8.53e-02 1.84e-03  3.31e-01     6s
  19   2.14076021e+04  9.09397254e+04  7.40e-02 1.69e-03  2.33e-01     6s
  20   2.48321767e+04  8.01293041e+04  6.37e-02 1.50e-03  1.86e-01     6s
  21   2.98448212e+04  7.59569630e+04  4.83e-02 1.51e-03  1.55e-01     6s
  22   3.14873839e+04  7.30976166e+04  4.33e-02 1.35e-03  1.40e-01     6s
  23   3.38341014e+04  6.67848403e+04  3.66e-02 1.56e-03  1.11e-01     7s
  24   3.56735732e+04  6.34110601e+04  3.17e-02 1.24e-03  9.31e-02     7s
  25   3.77744273e+04  6.04414614e+04  2.63e-02 9.88e-04  7.61e-02     7s
  26   3.82056647e+04  5.98965260e+04  2.51e-02 9.46e-04  7.28e-02     7s
  27   4.04404846e+04  5.73867251e+04  1.95e-02 7.57e-04  5.69e-02     7s
  28   4.14931722e+04  5.59573225e+04  1.70e-02 6.22e-04  4.86e-02     7s
  29   4.26655265e+04  5.47561890e+04  1.42e-02 4.98e-04  4.06e-02     7s
  30   4.43610718e+04  5.32457534e+04  1.03e-02 3.59e-04  2.98e-02     7s
  31   4.52801390e+04  5.22282885e+04  8.27e-03 2.72e-04  2.33e-02     7s
  32   4.61399104e+04  5.18807988e+04  6.33e-03 2.48e-04  1.93e-02     7s
  33   4.67710961e+04  5.10640853e+04  4.95e-03 1.71e-04  1.44e-02     7s
  34   4.74145894e+04  5.04034529e+04  3.59e-03 1.09e-04  1.00e-02     7s
  35   4.79415539e+04  5.00810766e+04  2.52e-03 7.41e-05  7.18e-03     8s
  36   4.83580194e+04  4.96400793e+04  1.69e-03 6.78e-05  4.31e-03     8s
  37   4.87514090e+04  4.95079500e+04  9.26e-04 1.19e-04  2.54e-03     8s
  38   4.88752920e+04  4.94330226e+04  6.93e-04 7.72e-05  1.87e-03     8s
  39   4.89959927e+04  4.93784965e+04  4.70e-04 5.13e-05  1.28e-03     8s
  40   4.90746498e+04  4.93436872e+04  3.27e-04 3.50e-05  9.03e-04     8s
  41   4.91464848e+04  4.93222512e+04  1.98e-04 2.50e-05  5.90e-04     8s
  42   4.92509265e+04  4.92785203e+04  1.64e-05 4.85e-06  9.25e-05     8s
  43   4.92589018e+04  4.92665832e+04  6.62e-06 5.39e-07  2.58e-05     8s
  44   4.92608167e+04  4.92649835e+04  4.35e-06 1.13e-07  1.40e-05     8s
  45   4.92610178e+04  4.92649715e+04  4.13e-06 1.27e-07  1.33e-05     8s
  46   4.92644500e+04  4.92648076e+04  2.17e-07 2.75e-08  1.20e-06     8s
  47   4.92647422e+04  4.92647465e+04  2.38e-08 3.31e-08  1.41e-08     8s
  48   4.92647448e+04  4.92647463e+04  5.76e-07 3.62e-08  5.19e-09     9s
  49   4.92647463e+04  4.92647463e+04  4.40e-09 6.36e-08  5.05e-12     9s

Barrier solved model in 49 iterations and 8.59 seconds (15.93 work units)
Optimal objective 4.92647463e+04


Root crossover log...

  141161 DPushes remaining with DInf 2.6064247e-08                 9s
   41370 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2300 PPushes remaining with PInf 7.1354263e-07                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1779345e-10     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64328    4.9264746e+04   0.000000e+00   0.000000e+00     13s
   64328    4.9264746e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.51s

Solved with barrier

Root relaxation: objective 4.926475e+04, 64328 iterations, 9.87 seconds (20.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49264.7463    0  270 -233202.98 49264.7463   121%     -   14s
H    0     0                    -111832.7538 49264.7463   144%     -   15s
H    0     0                    -110837.4998 49264.7463   144%     -   15s
H    0     0                    -84706.45947 49264.7463   158%     -   15s
H    0     0                    -82283.44073 49264.7463   160%     -   15s
H    0     0                    -12427.73163 49264.7463   496%     -   15s
H    0     0                    -4306.192408 49264.7463  1244%     -   15s
H    0     0                    -4236.062859 49264.7463  1263%     -   15s
H    0     0                    -4197.208858 49264.7463  1274%     -   15s
H    0     0                    -4129.860701 49264.7463  1293%     -   15s
     0     0 42181.6499    0  332 -4129.8607 42181.6499  1121%     -  109s
H    0     0                    -1792.140904 42181.6411  2454%     -  110s
H    0     0                    -1309.268583 42181.6411  3322%     -  110s
H    0     0                    -1118.229626 42181.6411  3872%     -  110s
     0     0 41598.9397    0  321 -1118.2296 41598.9397  3820%     -  155s
     0     0 41405.0602    0  315 -1118.2296 41405.0602  3803%     -  174s
     0     0 41008.1353    0  319 -1118.2296 41008.1353  3767%     -  194s
     0     0 40981.1348    0  312 -1118.2296 40981.1348  3765%     -  200s
     0     0 40980.6260    0  320 -1118.2296 40980.6260  3765%     -  203s
     0     0 37299.9115    0  355 -1118.2296 37299.9115  3436%     -  265s
H    0     0                    6992.2834704 37298.8489   433%     -  266s
H    0     0                    7065.9303406 37298.8489   428%     -  266s
H    0     0                    8721.9292473 37298.8489   328%     -  266s
H    0     0                    8800.7753931 37298.8489   324%     -  266s
H    0     0                    9276.8287907 37298.8489   302%     -  266s
     0     0 36832.6095    0  352 9276.82879 36832.6095   297%     -  292s
     0     0 36384.6281    0  386 9276.82879 36384.6281   292%     -  317s
     0     0 36225.7908    0  401 9276.82879 36225.7908   290%     -  345s
     0     0 36050.8462    0  438 9276.82879 36050.8462   289%     -  371s
     0     0 35982.9197    0  450 9276.82879 35982.9197   288%     -  391s
     0     0 35971.4755    0  455 9276.82879 35971.4755   288%     -  397s
     0     0 35959.9361    0  457 9276.82879 35959.9361   288%     -  404s
     0     0 35918.0163    0  451 9276.82879 35918.0163   287%     -  415s
     0     0 35885.9659    0  454 9276.82879 35885.9659   287%     -  423s
     0     0 35884.0541    0  452 9276.82879 35884.0541   287%     -  425s
     0     0 35879.5779    0  451 9276.82879 35879.5779   287%     -  428s
     0     0 35869.5899    0  454 9276.82879 35869.5899   287%     -  432s
     0     0 35852.6949    0  461 9276.82879 35852.6949   286%     -  438s
     0     0 35849.6627    0  460 9276.82879 35849.6627   286%     -  441s
     0     0 35848.7538    0  466 9276.82879 35848.7538   286%     -  443s
     0     0 33612.4657    0  421 9276.82879 33612.4657   262%     -  538s
H    0     0                    9481.2883002 33612.2102   255%     -  539s
     0     0 33270.8336    0  437 9481.28830 33270.8336   251%     -  569s
     0     0 33166.1014    0  437 9481.28830 33166.1014   250%     -  587s
     0     0 33120.2925    0  442 9481.28830 33120.2925   249%     -  597s
     0     0 33046.4366    0  442 9481.28830 33046.4366   249%     -  606s
     0     0 33006.6482    0  442 9481.28830 33006.6482   248%     -  615s
     0     0 32993.5293    0  451 9481.28830 32993.5293   248%     -  619s
     0     0 32981.0962    0  456 9481.28830 32981.0962   248%     -  625s
     0     0 32913.4439    0  441 9481.28830 32913.4439   247%     -  637s
     0     0 32899.3348    0  451 9481.28830 32899.3348   247%     -  643s
     0     0 32868.2126    0  445 9481.28830 32868.2126   247%     -  649s
     0     0 32862.2640    0  452 9481.28830 32862.2640   247%     -  651s
     0     0 32847.7904    0  444 9481.28830 32847.7904   246%     -  655s
     0     0 32844.5347    0  442 9481.28830 32844.5347   246%     -  657s
     0     0 32804.0294    0  427 9481.28830 32804.0294   246%     -  668s
     0     0 32781.9781    0  444 9481.28830 32781.9781   246%     -  676s
     0     0 32761.4694    0  431 9481.28830 32761.4694   246%     -  682s
     0     0 32748.0634    0  438 9481.28830 32748.0634   245%     -  687s
     0     0 32741.4767    0  441 9481.28830 32741.4767   245%     -  693s
     0     0 32730.1951    0  446 9481.28830 32730.1951   245%     -  699s
     0     0 32701.7538    0  444 9481.28830 32701.7538   245%     -  706s
     0     0 32693.7813    0  443 9481.28830 32693.7813   245%     -  711s
     0     0 32689.1108    0  443 9481.28830 32689.1108   245%     -  714s
     0     0 32688.7345    0  446 9481.28830 32688.7345   245%     -  716s
     0     0 31728.4212    0  448 9481.28830 31728.4212   235%     -  780s
H    0     0                    9634.4182365 31728.3993   229%     -  781s
H    0     0                    10007.298837 31728.3993   217%     -  781s
H    0     0                    10057.040211 31728.3993   215%     -  782s
H    0     0                    10091.413990 31728.3993   214%     -  782s
H    0     0                    10099.139491 31728.3993   214%     -  782s
     0     0 31567.9063    0  414 10099.1395 31567.9063   213%     -  802s
     0     0 31434.9198    0  418 10099.1395 31434.9198   211%     -  822s
     0     0 31413.5566    0  429 10099.1395 31413.5566   211%     -  830s
     0     0 31402.7581    0  426 10099.1395 31402.7581   211%     -  836s
     0     0 31393.5385    0  475 10099.1395 31393.5385   211%     -  842s
     0     0 31382.8706    0  424 10099.1395 31382.8706   211%     -  848s
     0     0 31375.9086    0  422 10099.1395 31375.9086   211%     -  855s
     0     0 31369.2372    0  431 10099.1395 31369.2372   211%     -  858s
     0     0 31366.6602    0  432 10099.1395 31366.6602   211%     -  862s
     0     0 31364.5006    0  443 10099.1395 31364.5006   211%     -  866s
     0     0 31224.8286    0  445 10099.1395 31224.8286   209%     -  884s
     0     0 31188.6372    0  426 10099.1395 31188.6372   209%     -  893s
     0     0 31174.5476    0  434 10099.1395 31174.5476   209%     -  899s
     0     0 31150.5100    0  420 10099.1395 31150.5100   208%     -  907s
     0     0 31145.7737    0  429 10099.1395 31145.7737   208%     -  911s
     0     0 31122.1135    0  433 10099.1395 31122.1135   208%     -  922s
     0     0 31117.7241    0  445 10099.1395 31117.7241   208%     -  927s
     0     0 31117.4910    0  437 10099.1395 31117.4910   208%     -  928s
     0     0 31020.9619    0  422 10099.1395 31020.9619   207%     -  948s
H    0     0                    10234.447156 31020.6681   203%     -  950s
H    0     0                    10267.809188 31020.6681   202%     -  951s
     0     0 30992.0526    0  419 10267.8092 30992.0526   202%     -  958s
     0     0 30972.2350    0  433 10267.8092 30972.2350   202%     -  970s
     0     0 30966.7323    0  437 10267.8092 30966.7323   202%     -  974s
     0     0 30965.7133    0  447 10267.8092 30965.7133   202%     -  976s
     0     0 30925.2652    0  425 10267.8092 30925.2652   201%     -  989s
     0     0 30908.1123    0  437 10267.8092 30908.1123   201%     - 1000s
     0     0 30900.0952    0  441 10267.8092 30900.0952   201%     - 1005s
     0     0 30897.1421    0  423 10267.8092 30897.1421   201%     - 1007s
     0     0 30896.9013    0  430 10267.8092 30896.9013   201%     - 1008s
     0     0 30872.4926    0  437 10267.8092 30872.4926   201%     - 1018s
H    0     0                    10427.488591 30872.1487   196%     - 1019s
     0     0 30867.8949    0  442 10427.4886 30867.8949   196%     - 1021s
     0     0 30865.4443    0  428 10427.4886 30865.4443   196%     - 1024s
     0     0 30861.2429    0  444 10427.4886 30861.2429   196%     - 1032s
     0     0 30860.1450    0  439 10427.4886 30860.1450   196%     - 1035s
     0     0 30856.9588    0  444 10427.4886 30856.9588   196%     - 1040s
     0     0 30856.6444    0  444 10427.4886 30856.6444   196%     - 1048s
H    0     0                    13940.598563 30856.6444   121%     - 1196s
H    0     0                    14397.651877 30856.6444   114%     - 1197s
H    0     0                    14543.894070 30856.6444   112%     - 1198s
H    0     0                    14772.608124 30856.6444   109%     - 1199s
H    0     2                    15926.023248 30856.6444  93.7%     - 1231s
     0     2 30856.6444    0  444 15926.0232 30856.6444  93.7%     - 1231s
     1     4 30781.5313    1  416 15926.0232 30856.6444  93.7%  6374 1245s
     3     8 30630.3373    2  449 15926.0232 30781.3435  93.3% 10601 1267s
     7    14 30390.1183    3  462 15926.0232 30630.3301  92.3% 13198 1305s
    13    26 29872.7428    4  425 15926.0232 30621.2632  92.3% 17020 1343s
    25    38 29167.8220    5  398 15926.0232 30389.6221  90.8% 22142 1470s
    37    68 28960.5905    5  411 15926.0232 30089.1838  88.9% 20319 1617s
H   39    68                    16457.678917 30089.1838  82.8% 19722 1617s
H   39    68                    16713.863895 30089.1838  80.0% 19722 1617s
H   42    68                    16825.290266 30089.1838  78.8% 18850 1617s
H   49    68                    16933.272584 30089.1838  77.7% 18393 1617s
H   51    68                    17087.329675 30089.1838  76.1% 18133 1617s
    67   147 28788.0962    6  421 17087.3297 30089.1838  76.1% 22013 1687s
   146   231 28392.2366   10  416 17087.3297 30089.1838  76.1% 15257 1735s
H  149   231                    17089.909747 30089.1838  76.1% 15030 1735s
H  151   231                    17175.153573 30089.1838  75.2% 14991 1735s
   230   301 28190.1893   11  403 17175.1536 30089.1838  75.2% 13193 1774s
   300   357 27866.9234   13  409 17175.1536 30089.1838  75.2% 11807 1805s
H  336   357                    17193.402038 30089.1838  75.0% 11308 1805s
   356   413 27714.6294   14  450 17193.4020 30089.1838  75.0% 11255 1838s
   412   464 27673.3437   16  445 17193.4020 30089.1838  75.0% 10647 1868s
H  422   464                    17250.503074 30089.1838  74.4% 10515 1868s
   463   523 27438.4247   18  433 17250.5031 30089.1838  74.4% 10288 1896s
   522   584 27355.0453   20  421 17250.5031 30089.1838  74.4% 10138 1924s
   583   636 27174.4880   23  407 17250.5031 30089.1838  74.4%  9966 1953s
   641   656 24430.7766   31  278 17250.5031 30089.1838  74.4% 10142 1975s
   665   679 27026.5541   23  395 17250.5031 30089.1838  74.4% 10257 2000s
   698   711     cutoff   33      17250.5031 30089.1838  74.4% 10358 2024s
   742   740 17402.1946   19  283 17250.5031 30089.1838  74.4% 10304 2049s
   800   767 19441.6766   16  269 17250.5031 30089.1838  74.4% 10283 2076s
   858   786 19343.8815   17  258 17250.5031 30089.1838  74.4% 10245 2100s
H  875   786                    17344.242562 30089.1838  73.5% 10252 2100s
   893   864 18761.1091   18  227 17344.2426 30089.1838  73.5% 10231 2126s
   998   944 18186.8114   21  208 17344.2426 30089.1838  73.5%  9852 2154s
  1128  1015 27962.6224    7  337 17344.2426 30089.1838  73.5%  9381 2184s
  1273  1067     cutoff   53      17344.2426 30089.1838  73.5%  8833 2211s
  1389  1122 infeasible   15      17344.2426 30089.1838  73.5%  8519 2241s
  1504  1154 23383.1142    7  373 17344.2426 30089.1838  73.5%  8374 2272s
  1615  1220 23020.9102    8  298 17344.2426 30089.1838  73.5%  8266 2305s
  1717  1304 22688.7013    9  254 17344.2426 30089.1838  73.5%  8271 2336s
  1825  1331 22513.6892   11  313 17344.2426 30089.1838  73.5%  8295 2369s
  1858  1366 22475.0567   12  313 17344.2426 30089.1838  73.5%  8317 2393s
  1897  1406 22359.0362   13  305 17344.2426 30089.1838  73.5%  8309 2421s
  1940  1488 22338.7563   14  304 17344.2426 30089.1838  73.5%  8286 2452s
  2062  1618 22102.3233   15  313 17344.2426 30089.1838  73.5%  8108 2486s
  2248  1707 18566.1240   16  235 17344.2426 30089.1838  73.5%  7821 2521s
  2380  1739 18538.3464   17  220 17344.2426 29490.9735  70.0%  7584 2548s
  2416  1884 18315.5746   18  212 17344.2426 29490.9735  70.0%  7606 2581s
  2580  2115 17788.2583   23  200 17344.2426 29248.0189  68.6%  7359 2621s
  2874  2276 17558.8067   30  244 17344.2426 29248.0189  68.6%  6977 2657s
  3156  2302 17806.4208   42  156 17344.2426 29248.0189  68.6%  6683 2703s
  3312  2367 infeasible   42      17344.2426 29204.5469  68.4%  6688 2746s
  3431  2429 23110.2342    7  338 17344.2426 29126.9821  67.9%  6775 2793s
  3535  2510 22473.2605    8  337 17344.2426 29126.9821  67.9%  6905 2840s
  3638  2587     cutoff    8      17344.2426 29057.2657  67.5%  7059 2892s
  3756  2683 infeasible   35      17344.2426 29057.2657  67.5%  7193 2938s
  3928  2684 19864.1837   67  444 17344.2426 29057.2657  67.5%  7238 3200s
  3930  2685 18063.9554   64  196 17344.2426 29057.2657  67.5%  7234 3222s
  3931  2686 19974.9832   65  320 17344.2426 29057.2657  67.5%  7232 3356s
  3932  2687 20911.7750   22  396 17344.2426 29057.2657  67.5%  7230 3453s
  3933  2687 17828.2166   52  410 17344.2426 29057.2657  67.5%  7228 3527s
  3934  2688 27437.6537   19  433 17344.2426 29057.2657  67.5%  7227 3564s
  3935  2689 18463.3999   46  459 17344.2426 29057.2657  67.5%  7225 3588s

Cutting planes:
  Gomory: 25
  Projected implied bound: 181
  MIR: 1042
  Mixing: 1
  Flow cover: 1148
  RLT: 23
  Relax-and-lift: 188

Explored 3935 nodes (29475291 simplex iterations) in 3600.04 seconds (8901.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17344.2 17250.5 17193.4 ... 16457.7

Time limit reached
Best objective 1.734424256236e+04, best bound 2.905726566514e+04, gap 67.5326%
  WARNING: Time limit reached. Using best solution found (gap: 67.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 17344.24, θ = 168400.10
  Upper Bound (UB) = 17344.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168400.10
  [DEBUG]   ✓ Scenario 0: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 168400.10 ≤ Q = 168400.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 168400.10 ≤ Q = 168400.10 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2bd272f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfd42d8d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.284783e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 7004047.5323
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.484174e+05, 266 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148417.37    0  124 7004047.53 -148417.37   102%     -    0s
H    0     0                    -111322.3252 -148417.37  33.3%     -    0s
H    0     0                    -112831.4850 -148417.37  31.5%     -    0s
     0     0 -125252.09    0   79 -112831.48 -125252.09  11.0%     -    0s
H    0     0                    -119931.5103 -125121.72  4.33%     -    0s
H    0     0                    -120494.3381 -125121.72  3.84%     -    0s
H    0     0                    -121603.6891 -125121.72  2.89%     -    0s
H    0     0                    -122208.7483 -125121.72  2.38%     -    0s
     0     0 -123836.62    0   89 -122208.75 -123836.62  1.33%     -    0s
     0     0 -123831.04    0   89 -122208.75 -123831.04  1.33%     -    0s
H    0     0                    -122383.7946 -123831.04  1.18%     -    0s
H    0     0                    -122402.0309 -123831.04  1.17%     -    0s
     0     0 -123206.53    0   69 -122402.03 -123206.53  0.66%     -    0s
     0     0 -123153.47    0   39 -122402.03 -123153.47  0.61%     -    0s
     0     0 -123139.42    0   36 -122402.03 -123139.42  0.60%     -    0s
H    0     0                    -122485.9866 -123116.97  0.52%     -    0s
     0     0 -123065.86    0   64 -122485.99 -123065.86  0.47%     -    0s
     0     0 -122998.46    0   65 -122485.99 -122998.46  0.42%     -    0s
     0     0 -122978.47    0   65 -122485.99 -122978.47  0.40%     -    0s
H    0     0                    -122534.9082 -122978.47  0.36%     -    0s
     0     2 -122978.47    0   65 -122534.91 -122978.47  0.36%     -    0s
H   29    28                    -122563.8159 -122870.88  0.25%   9.3    0s
H   30    28                    -122603.1651 -122861.36  0.21%   9.2    0s
H  120    77                    -122616.6720 -122819.00  0.17%   7.3    0s
*  349    40              21    -122632.6065 -122779.71  0.12%   6.0    0s
H  372    40                    -122671.9557 -122779.71  0.09%   5.8    0s

Cutting planes:
  Gomory: 19
  Implied bound: 7
  MIR: 187
  Flow cover: 16
  RLT: 34
  Relax-and-lift: 1

Explored 496 nodes (3271 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122672 -122633 -122617 ... -121604
No other solutions better than -122672

Optimal solution found (tolerance 1.00e-06)
Best objective -1.226719557442e+05, best bound -1.226719557442e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 161291.23
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122671.96
  [DEBUG]   S×d_nominal = 283963.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 283963.19 + -122671.96 = 161291.23
  [DEBUG]   Current θ from Master = 168400.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7108.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10235.38
  Lower Bound (LB) = 13160.74
  Gap (UB-LB) = 4183.5034, Absolute Gap = 4183.5034, Relative Gap = 0.241204
  Not converged yet (gap = 4183.50 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827364 nonzeros
Model fingerprint: 0x9f5d6d9e
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118978 rows and 48298 columns
Presolve time: 3.51s
Presolved: 172915 rows, 72522 columns, 1062056 nonzeros
Variable types: 70263 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.55s

Barrier statistics:
 Dense cols : 697
 AA' NZ     : 9.317e+06
 Factor NZ  : 2.134e+07 (roughly 270 MB of memory)
 Factor Ops : 5.726e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.99671300e+07  2.85676142e+08  1.38e+05 1.80e+01  9.12e+04     6s
   1  -1.56654006e+07  2.59132387e+08  9.84e+04 6.74e+01  6.41e+04     6s
   2  -6.65461377e+06  2.07236667e+08  4.13e+04 7.89e-01  2.83e+04     6s
   3  -1.22713801e+06  1.66768137e+08  3.21e+03 1.28e+00  2.64e+03     6s
   4  -7.14520712e+05  7.37595946e+07  6.65e+02 3.39e-01  6.29e+02     6s
   5  -6.18587240e+05  4.90842202e+07  3.49e+02 1.94e-01  3.49e+02     6s
   6  -4.30392887e+05  3.57092823e+07  9.61e+01 1.25e-01  1.64e+02     6s
   7  -3.44699257e+05  2.64412620e+07  4.32e+01 8.74e-02  1.04e+02     6s
   8  -2.16912563e+05  2.29802841e+07  1.27e+01 7.45e-02  7.88e+01     6s
   9  -1.72427913e+05  1.56331820e+07  6.61e+00 4.93e-02  5.22e+01     7s
  10  -1.41566728e+05  1.20636389e+07  4.27e+00 3.83e-02  3.98e+01     7s
  11  -1.07244301e+05  5.97133369e+06  1.95e+00 1.85e-02  1.96e+01     7s
  12  -8.52913943e+04  2.73471084e+06  6.95e-01 8.79e-03  9.00e+00     7s
  13  -5.54467743e+04  9.87155456e+05  2.94e-01 3.06e-03  3.32e+00     7s
  14  -3.73998155e+04  5.44738591e+05  1.71e-01 1.70e-03  1.85e+00     7s
  15  -2.54854735e+04  4.86551552e+05  1.22e-01 1.50e-03  1.63e+00     7s
  16  -6.93262131e+03  2.46502611e+05  6.91e-02 1.60e-03  8.05e-01     7s
  17   3.71544588e+03  1.95411625e+05  5.25e-02 1.35e-03  6.09e-01     7s
  18   1.07281236e+04  1.44029653e+05  4.23e-02 2.85e-03  4.24e-01     7s
  19   1.93385256e+04  1.19334891e+05  3.03e-02 2.09e-03  3.18e-01     7s
  20   2.24838626e+04  1.04294451e+05  2.62e-02 1.68e-03  2.60e-01     7s
  21   2.63758214e+04  9.01880234e+04  2.15e-02 1.27e-03  2.03e-01     7s
  22   2.91853500e+04  8.27056090e+04  1.83e-02 1.04e-03  1.70e-01     8s
  23   3.18850164e+04  7.63819996e+04  1.52e-02 8.53e-04  1.41e-01     8s
  24   3.45439554e+04  7.10252678e+04  1.25e-02 6.95e-04  1.16e-01     8s
  25   3.64702611e+04  6.52300364e+04  1.06e-02 5.13e-04  9.14e-02     8s
  26   3.82624931e+04  6.21829986e+04  8.89e-03 4.17e-04  7.60e-02     8s
  27   3.95349258e+04  5.97281654e+04  7.73e-03 3.47e-04  6.42e-02     8s
  28   4.22419241e+04  5.82447113e+04  5.33e-03 2.98e-04  5.08e-02     8s
  29   4.30657284e+04  5.61977338e+04  4.62e-03 2.33e-04  4.17e-02     8s
  30   4.46118658e+04  5.41888035e+04  3.34e-03 1.68e-04  3.04e-02     8s
  31   4.58869664e+04  5.27356393e+04  2.36e-03 1.18e-04  2.18e-02     8s
  32   4.67287225e+04  5.18784721e+04  1.72e-03 8.78e-05  1.64e-02     9s
  33   4.74491674e+04  5.12510323e+04  1.18e-03 6.70e-05  1.21e-02     9s
  34   4.77224464e+04  5.07517571e+04  9.84e-04 5.14e-05  9.62e-03     9s
  35   4.79712732e+04  5.02111489e+04  8.10e-04 3.30e-05  7.12e-03     9s
  36   4.83267660e+04  5.00973300e+04  5.65e-04 2.89e-05  5.63e-03     9s
  37   4.84860442e+04  4.98877508e+04  4.53e-04 1.87e-05  4.45e-03     9s
  38   4.87884375e+04  4.96867092e+04  2.55e-04 1.32e-05  2.85e-03     9s
  39   4.89336694e+04  4.95235644e+04  1.67e-04 8.51e-06  1.87e-03     9s
  40   4.90556309e+04  4.94469726e+04  9.10e-05 6.34e-06  1.24e-03     9s
  41   4.90807248e+04  4.93926423e+04  7.53e-05 4.85e-06  9.91e-04     9s
  42   4.91276279e+04  4.93511199e+04  4.80e-05 3.69e-06  7.10e-04    10s
  43   4.91502096e+04  4.93008802e+04  3.47e-05 2.38e-06  4.79e-04    10s
  44   4.91978484e+04  4.92595260e+04  9.60e-06 1.18e-06  1.96e-04    10s
  45   4.92047103e+04  4.92351803e+04  5.70e-06 5.28e-07  9.68e-05    10s
  46   4.92071210e+04  4.92312214e+04  4.46e-06 4.10e-07  7.66e-05    10s
  47   4.92104950e+04  4.92283347e+04  2.74e-06 3.29e-07  5.67e-05    10s
  48   4.92145149e+04  4.92263629e+04  8.29e-07 2.74e-07  3.76e-05    10s
  49   4.92153271e+04  4.92259827e+04  5.13e-07 2.63e-07  3.38e-05    10s
  50   4.92160584e+04  4.92170485e+04  1.65e-07 7.14e-09  3.15e-06    10s
  51   4.92166157e+04  4.92166756e+04  4.61e-08 1.58e-08  1.91e-07    10s
  52   4.92166586e+04  4.92166674e+04  8.16e-07 5.71e-09  2.83e-08    11s
  53   4.92166627e+04  4.92166671e+04  4.40e-07 1.68e-07  1.41e-08    11s
  54   4.92166657e+04  4.92166671e+04  3.52e-07 1.03e-07  4.66e-09    11s
  55   4.92166663e+04  4.92166671e+04  2.99e-07 4.81e-08  2.52e-09    11s
  56   4.92166666e+04  4.92166671e+04  2.92e-07 3.28e-08  1.57e-09    11s

Barrier solved model in 56 iterations and 10.92 seconds (20.07 work units)
Optimal objective 4.92166666e+04


Root crossover log...

  148829 DPushes remaining with DInf 0.0000000e+00                11s
   41052 DPushes remaining with DInf 0.0000000e+00                15s
    2174 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

   37102 PPushes remaining with PInf 2.4768424e-04                22s
    9561 PPushes remaining with PInf 2.1890864e-04                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1190703e+04     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  120509    4.9216667e+04   0.000000e+00   1.119070e+04     27s
  121721    4.9216667e+04   0.000000e+00   0.000000e+00     28s
  121721    4.9216667e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 6.81s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.921667e+04, 121721 iterations, 30.75 seconds (62.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49216.6671    0  266 -233202.98 49216.6671   121%     -   36s
H    0     0                    -181036.4186 49216.6671   127%     -   38s
H    0     0                    -173296.5690 49216.6671   128%     -   38s
H    0     0                    -170150.2464 49216.6671   129%     -   39s
H    0     0                    -169230.7608 49216.6671   129%     -   40s
H    0     0                    -169087.4952 49216.6671   129%     -   40s
H    0     0                    -169055.5778 49216.6671   129%     -   40s
H    0     0                    -81736.89375 49216.6671   160%     -   40s
H    0     0                    -11439.41245 49216.6671   530%     -   41s
H    0     0                    -2751.371326 49216.6671  1889%     -   41s
H    0     0                    -2645.450659 49216.6671  1960%     -   41s
     0     0 41959.7251    0  311 -2645.4507 41959.7251  1686%     -  126s
H    0     0                    -1924.934720 41959.6391  2280%     -  128s
H    0     0                    -1051.793148 41959.6391  4089%     -  128s
H    0     0                    -823.9894798 41959.6391  5192%     -  128s
H    0     0                    -788.7826969 41959.6391  5420%     -  128s
     0     0 41302.2110    0  315 -788.78270 41302.2110  5336%     -  170s
     0     0 41202.4119    0  320 -788.78270 41202.4119  5324%     -  184s
     0     0 40904.3981    0  321 -788.78270 40904.3981  5286%     -  205s
     0     0 40867.3521    0  319 -788.78270 40867.3521  5281%     -  213s
     0     0 40830.1434    0  317 -788.78270 40830.1434  5276%     -  217s
     0     0 40701.8627    0  314 -788.78270 40701.8627  5260%     -  227s
     0     0 40691.6823    0  321 -788.78270 40691.6823  5259%     -  237s
     0     0 40686.6239    0  319 -788.78270 40686.6239  5258%     -  244s
     0     0 40684.6503    0  323 -788.78270 40684.6503  5258%     -  245s
     0     0 40684.5320    0  322 -788.78270 40684.5320  5258%     -  246s
     0     0 37314.6958    0  358 -788.78270 37314.6958  4831%     -  345s
H    0     0                    4963.1188485 37314.5978   652%     -  346s
H    0     0                    6558.1975953 37314.5978   469%     -  347s
H    0     0                    6601.0883918 37314.5978   465%     -  347s
H    0     0                    6821.6043494 37314.5978   447%     -  347s
H    0     0                    7071.7153686 37314.5978   428%     -  347s
H    0     0                    7307.6540815 37314.5978   411%     -  347s
H    0     0                    8251.7684777 37314.5978   352%     -  347s
H    0     0                    8264.7734286 37314.5978   351%     -  347s
H    0     0                    8404.0136638 37314.5978   344%     -  347s
H    0     0                    8827.2741319 37314.5978   323%     -  347s
     0     0 36863.6946    0  361 8827.27413 36863.6946   318%     -  391s
     0     0 36454.0155    0  366 8827.27413 36454.0155   313%     -  441s
     0     0 36317.0757    0  374 8827.27413 36317.0757   311%     -  467s
     0     0 36243.5975    0  402 8827.27413 36243.5975   311%     -  488s
     0     0 36208.9649    0  378 8827.27413 36208.9649   310%     -  506s
     0     0 36179.6401    0  380 8827.27413 36179.6401   310%     -  524s
     0     0 36160.7170    0  420 8827.27413 36160.7170   310%     -  537s
     0     0 36088.4861    0  446 8827.27413 36088.4861   309%     -  555s
     0     0 36078.6774    0  451 8827.27413 36078.6774   309%     -  560s
     0     0 36066.0139    0  450 8827.27413 36066.0139   309%     -  567s
     0     0 36065.6329    0  453 8827.27413 36065.6329   309%     -  571s
     0     0 33693.2880    0  389 8827.27413 33693.2880   282%     -  696s
     0     0 33324.9275    0  399 8827.27413 33324.9275   278%     -  736s
     0     0 33156.8298    0  399 8827.27413 33156.8298   276%     -  763s
     0     0 32975.0127    0  435 8827.27413 32975.0127   274%     -  790s
     0     0 32921.5876    0  452 8827.27413 32921.5876   273%     -  809s
     0     0 32900.7425    0  459 8827.27413 32900.7425   273%     -  822s
     0     0 32887.5591    0  491 8827.27413 32887.5591   273%     -  832s
     0     0 32710.1427    0  489 8827.27413 32710.1427   271%     -  858s
     0     0 32656.9416    0  476 8827.27413 32656.9416   270%     -  875s
     0     0 32608.1404    0  455 8827.27413 32608.1404   269%     -  891s
     0     0 32565.1615    0  465 8827.27413 32565.1615   269%     -  904s
     0     0 32539.9294    0  500 8827.27413 32539.9294   269%     -  914s
     0     0 32524.1990    0  512 8827.27413 32524.1990   268%     -  922s
     0     0 32488.8707    0  500 8827.27413 32488.8707   268%     -  934s
     0     0 32456.1092    0  496 8827.27413 32456.1092   268%     -  946s
     0     0 32446.7527    0  492 8827.27413 32446.7527   268%     -  951s
     0     0 32444.2162    0  506 8827.27413 32444.2162   268%     -  954s
     0     0 32442.4752    0  471 8827.27413 32442.4752   268%     -  957s
     0     0 31723.9988    0  449 8827.27413 31723.9988   259%     - 1015s
H    0     0                    8936.4524189 31723.4276   255%     - 1017s
H    0     0                    9046.4263340 31723.4276   251%     - 1018s
H    0     0                    9209.4947626 31723.4276   244%     - 1018s
H    0     0                    9221.1382180 31723.4276   244%     - 1018s
H    0     0                    9234.1556179 31723.4276   244%     - 1018s
H    0     0                    9263.7443916 31723.4276   242%     - 1018s
     0     0 31566.0122    0  467 9263.74439 31566.0122   241%     - 1040s
     0     0 31490.4017    0  466 9263.74439 31490.4017   240%     - 1053s
     0     0 31444.4484    0  479 9263.74439 31444.4484   239%     - 1065s
     0     0 31424.4791    0  480 9263.74439 31424.4791   239%     - 1072s
     0     0 31413.7056    0  478 9263.74439 31413.7056   239%     - 1078s
     0     0 31396.3374    0  476 9263.74439 31396.3374   239%     - 1083s
     0     0 31381.0272    0  477 9263.74439 31381.0272   239%     - 1088s
     0     0 31347.7525    0  476 9263.74439 31347.7525   238%     - 1095s
     0     0 31336.2567    0  437 9263.74439 31336.2567   238%     - 1104s
     0     0 31326.0734    0  448 9263.74439 31326.0734   238%     - 1117s
     0     0 31315.6675    0  452 9263.74439 31315.6675   238%     - 1125s
     0     0 31312.8156    0  460 9263.74439 31312.8156   238%     - 1130s
     0     0 31298.3833    0  453 9263.74439 31298.3833   238%     - 1140s
     0     0 31295.7378    0  454 9263.74439 31295.7378   238%     - 1144s
     0     0 31292.6442    0  501 9263.74439 31292.6442   238%     - 1148s
     0     0 31291.3620    0  498 9263.74439 31291.3620   238%     - 1151s
     0     0 31136.6368    0  461 9263.74439 31136.6368   236%     - 1173s
H    0     0                    9860.2212466 31135.7828   216%     - 1174s
H    0     0                    9965.8214563 31135.7828   212%     - 1174s
     0     0 31115.3925    0  465 9965.82146 31115.3925   212%     - 1182s
     0     0 31112.5726    0  462 9965.82146 31112.5726   212%     - 1184s
     0     0 31093.5978    0  471 9965.82146 31093.5978   212%     - 1190s
     0     0 31080.8852    0  460 9965.82146 31080.8852   212%     - 1195s
     0     0 31079.5657    0  466 9965.82146 31079.5657   212%     - 1198s
     0     0 31034.5505    0  444 9965.82146 31034.5505   211%     - 1213s
H    0     0                    10490.615014 31033.6085   196%     - 1216s
     0     0 31025.4195    0  450 10490.6150 31025.4195   196%     - 1224s
     0     0 31013.7931    0  458 10490.6150 31013.7931   196%     - 1231s
     0     0 30991.2714    0  474 10490.6150 30991.2714   195%     - 1241s
     0     0 30964.2205    0  462 10490.6150 30964.2205   195%     - 1252s
     0     0 30959.1472    0  466 10490.6150 30959.1472   195%     - 1255s
     0     0 30953.5634    0  452 10490.6150 30953.5634   195%     - 1258s
     0     0 30949.6154    0  458 10490.6150 30949.6154   195%     - 1262s
     0     0 30948.2977    0  465 10490.6150 30948.2977   195%     - 1263s
     0     0 30897.7328    0  457 10490.6150 30897.7328   195%     - 1274s
     0     0 30886.8663    0  469 10490.6150 30886.8663   194%     - 1284s
     0     0 30879.8694    0  520 10490.6150 30879.8694   194%     - 1289s
     0     0 30875.7571    0  560 10490.6150 30875.7571   194%     - 1293s
     0     0 30874.2716    0  558 10490.6150 30874.2716   194%     - 1295s
     0     0 30858.1143    0  498 10490.6150 30858.1143   194%     - 1303s
     0     0 30848.5591    0  454 10490.6150 30848.5591   194%     - 1310s
     0     0 30845.9829    0  498 10490.6150 30845.9829   194%     - 1313s
     0     0 30840.6487    0  505 10490.6150 30840.6487   194%     - 1321s
     0     0 30839.0757    0  506 10490.6150 30839.0757   194%     - 1325s
     0     0 30834.4435    0  458 10490.6150 30834.4435   194%     - 1333s
H    0     0                    10654.001351 30834.3850   189%     - 1338s
     0     0 30833.4541    0  453 10654.0014 30833.4541   189%     - 1342s
     0     0 30831.6790    0  508 10654.0014 30831.6790   189%     - 1348s
     0     0 30831.6181    0  508 10654.0014 30831.6181   189%     - 1358s
H    0     0                    10902.164391 30831.5393   183%     - 1513s
H    0     0                    11744.195394 30831.5393   163%     - 1517s
H    0     0                    14287.850012 30831.5393   116%     - 1518s
H    0     0                    14611.092856 30831.5393   111%     - 1518s
H    0     0                    15320.379467 30831.5393   101%     - 1518s
H    0     0                    15815.380125 30831.5393  94.9%     - 1522s
H    0     0                    15975.202604 30831.5393  93.0%     - 1522s
H    0     0                    15995.530397 30831.5393  92.8%     - 1522s
     0     2 30831.5393    0  508 15995.5304 30831.5393  92.8%     - 1525s
     1     3 30481.0648    1  411 15995.5304 30831.3915  92.8% 13845 1543s
     2     4 30603.8365    1  454 15995.5304 30603.8365  91.3% 14918 1562s
     3     7 29921.4418    2  472 15995.5304 30603.3632  91.3% 13460 1580s
     6    14 30283.9794    3  494 15995.5304 30603.0806  91.3% 13095 1610s
    13    28 29984.6834    4  488 15995.5304 30358.1475  89.8% 15504 1634s
    27    42 29402.6046    5  433 15995.5304 30087.8632  88.1% 21933 1720s
H   41    73                    16169.237149 30087.8632  86.1% 24449 1956s
H   53    73                    16527.831096 30087.8632  82.0% 22724 1956s
H   54    73                    16875.448329 30087.8632  78.3% 22512 1956s
    72   188 28867.7273    7  423 16875.4483 29333.0143  73.8% 25907 2021s
   187   248 28721.8874    9  411 16875.4483 29333.0143  73.8% 15500 2054s
H  200   248                    17093.087459 29333.0143  71.6% 14977 2054s
   247   306 28562.9149    9  399 17093.0875 29333.0143  71.6% 14114 2082s
   305   345 28612.2963   10  396 17093.0875 29333.0143  71.6% 12824 2111s
H  326   345                    17199.997557 29333.0143  70.5% 12355 2111s
   352   372 28572.3657   10  415 17199.9976 29333.0143  70.5% 12265 2137s
H  356   372                    17212.663049 29333.0143  70.4% 12247 2137s
H  358   372                    17220.054071 29333.0143  70.3% 12193 2137s
   381   409 28567.6089   10  414 17220.0541 29333.0143  70.3% 12047 2174s
   418   452 28351.6555   11  389 17220.0541 29333.0143  70.3% 11970 2205s
   463   472 28382.9953   11  385 17220.0541 29333.0143  70.3% 12220 2272s
   483   505 28338.4851   11  405 17220.0541 29333.0143  70.3% 12307 2411s
   520   538 28348.5731   11  395 17220.0541 29333.0143  70.3% 12558 2459s
   555   575 20953.9703   22  286 17220.0541 29333.0143  70.3% 12491 2542s
   596   620 20830.7137   15  308 17220.0541 29333.0143  70.3% 12349 2570s
   653   678 20787.8076   16  295 17220.0541 29333.0143  70.3% 12042 2598s
   723   736 20508.0052   18  231 17220.0541 29333.0143  70.3% 11632 2626s
   799   791 20230.7839   22  267 17220.0541 29333.0143  70.3% 11206 2648s
   868   810 19995.0629   25  197 17220.0541 29333.0143  70.3% 10955 2685s
H  876   810                    17231.931328 29333.0143  70.2% 10931 2685s
H  882   810                    17244.522288 29333.0143  70.1% 10910 2685s
   909   849 19999.0588   25  197 17244.5223 29333.0143  70.1% 10852 2726s
   955   938 infeasible   24      17244.5223 29333.0143  70.1% 10750 2753s
  1066  1019 infeasible   30      17244.5223 29333.0143  70.1% 10245 2785s
  1187  1108 19745.9351   35  219 17244.5223 29333.0143  70.1%  9851 2812s
  1333  1180 19570.2273   40  159 17244.5223 29333.0143  70.1%  9322 2844s
  1475  1242     cutoff   41      17244.5223 29333.0143  70.1%  8960 2875s
  1643  1299 19209.1244   45  164 17244.5223 29333.0143  70.1%  8471 2909s
  1765  1309 18406.2717   50  155 17244.5223 29333.0143  70.1%  8283 2941s
  1803  1356 18851.7702   48  157 17244.5223 29333.0143  70.1%  8277 2971s
  1912  1373 18482.4324   56  155 17244.5223 29333.0143  70.1%  8068 3004s
  1946  1389 18480.8836   57  154 17244.5223 29333.0143  70.1%  8078 3039s
  1990  1417 18478.4810   58  156 17244.5223 29333.0143  70.1%  8085 3077s
  2052  1456 18454.8156   59  154 17244.5223 29333.0143  70.1%  8047 3113s
  2123  1478 18438.8164   60  151 17244.5223 29333.0143  70.1%  8051 3151s
  2183  1504 17888.7349   61  157 17244.5223 29333.0143  70.1%  8063 3195s
  2243  1540 18347.6160   60  147 17244.5223 29333.0143  70.1%  8080 3239s
  2302  1567 18423.8453   59  156 17244.5223 29333.0143  70.1%  8088 3281s
H 2346  1567                    17279.734746 29333.0143  69.8%  8049 3281s
  2374  1641 infeasible   66      17279.7347 29333.0143  69.8%  8067 3329s
  2537  1730 17344.2004   71  148 17279.7347 29333.0143  69.8%  7926 3377s
  2671  1850 23170.5041    8  309 17279.7347 29333.0143  69.8%  7951 3425s
  2831  1993 23082.9740    9  318 17279.7347 29333.0143  69.8%  7927 3473s
  3018  2114 20860.4196   11  387 17279.7347 29333.0143  69.8%  7918 3524s
  3204  2227 20785.8018   12  333 17279.7347 29333.0143  69.8%  7851 3580s
  3393  2260 20165.2657   15  241 17279.7347 29333.0143  69.8%  7810 3600s

Cutting planes:
  Learned: 3
  Gomory: 11
  Implied bound: 304
  MIR: 4287
  Flow cover: 4216
  RLT: 98
  Relax-and-lift: 832

Explored 3508 nodes (27921471 simplex iterations) in 3600.08 seconds (8803.95 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17279.7 17244.5 17231.9 ... 16169.2

Time limit reached
Best objective 1.727973474618e+04, best bound 2.933301427809e+04, gap 69.7538%
  WARNING: Time limit reached. Using best solution found (gap: 69.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 17279.73, θ = 169608.52
  Upper Bound (UB) = 17279.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169608.52
  [DEBUG]   ✓ Scenario 0: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169608.52 ≤ Q = 169608.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169608.52 ≤ Q = 169608.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x405ac250
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x405ac250
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6880328.5190
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.402663e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140266.31    0  122 6880328.52 -140266.31   102%     -    0s
H    0     0                    -103714.6058 -140266.31  35.2%     -    0s
H    0     0                    -105204.7301 -140266.31  33.3%     -    0s
     0     0 -112710.13    0   91 -105204.73 -112710.13  7.13%     -    0s
H    0     0                    -107391.6431 -112596.19  4.85%     -    0s
H    0     0                    -107982.8753 -112596.19  4.27%     -    0s
H    0     0                    -108388.9998 -112596.19  3.88%     -    0s
H    0     0                    -108980.2320 -112596.19  3.32%     -    0s
     0     0 -111605.35    0   86 -108980.23 -111605.35  2.41%     -    0s
     0     0 -111549.77    0   86 -108980.23 -111549.77  2.36%     -    0s
H    0     0                    -109015.6068 -111549.77  2.32%     -    0s
     0     0 -111056.24    0   90 -109015.61 -111056.24  1.87%     -    0s
     0     0 -111022.87    0   90 -109015.61 -111022.87  1.84%     -    0s
     0     0 -111020.67    0   89 -109015.61 -111020.67  1.84%     -    0s
     0     0 -110846.22    0   78 -109015.61 -110846.22  1.68%     -    0s
H    0     0                    -110300.4119 -110775.46  0.43%     -    0s
     0     0 -110775.46    0   46 -110300.41 -110775.46  0.43%     -    0s
     0     0 -110731.14    0   73 -110300.41 -110731.14  0.39%     -    0s
     0     0 -110682.54    0   73 -110300.41 -110682.54  0.35%     -    0s
H    0     0                    -110357.6018 -110682.54  0.29%     -    0s
     0     2 -110682.54    0   73 -110357.60 -110682.54  0.29%     -    0s
H   43    18                    -110376.5330 -110573.45  0.18%  14.8    0s
*  117    33              11    -110381.3439 -110476.47  0.09%   8.6    0s

Cutting planes:
  Gomory: 40
  Implied bound: 3
  MIR: 191
  Flow cover: 1
  RLT: 1

Explored 356 nodes (2831 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -110381 -110377 -110358 ... 6.88033e+06
No other solutions better than -110381

Optimal solution found (tolerance 1.00e-06)
Best objective -1.103813439281e+05, best bound -1.103813439281e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 167033.38
  Scenario: 3 demand increases, 57 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110381.34
  [DEBUG]   S×d_nominal = 277414.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 277414.73 + -110381.34 = 167033.38
  [DEBUG]   Current θ from Master = 169608.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2575.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14704.60
  Lower Bound (LB) = 14704.60
  Gap (UB-LB) = 2575.1382, Absolute Gap = 2575.1382, Relative Gap = 0.149026
  Not converged yet (gap = 2575.14 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 3 increases, 57 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870619 nonzeros
Model fingerprint: 0xe3446adb
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 125240 rows and 50840 columns
Presolve time: 3.61s
Presolved: 181943 rows, 76220 columns, 1117243 nonzeros
Variable types: 73961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.74s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 1.026e+07
 Factor NZ  : 2.306e+07 (roughly 300 MB of memory)
 Factor Ops : 6.170e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.03777624e+07  2.98532074e+08  1.41e+05 1.79e+01  9.26e+04     7s
   1  -1.60879118e+07  2.71330876e+08  1.01e+05 6.92e+01  6.56e+04     7s
   2  -5.87864682e+06  2.16130058e+08  3.64e+04 9.85e-01  2.50e+04     7s
   3  -1.01994003e+06  1.63881977e+08  2.72e+03 1.74e+00  2.28e+03     8s
   4  -6.26506743e+05  8.94339641e+07  6.82e+02 7.33e-01  6.79e+02     8s
   5  -5.31511515e+05  5.79996961e+07  3.76e+02 3.96e-01  3.84e+02     8s
   6  -4.20757934e+05  4.35412018e+07  1.09e+02 2.71e-01  1.89e+02     8s
   7  -3.67210621e+05  3.05335611e+07  5.68e+01 1.79e-01  1.19e+02     8s
   8  -2.38740877e+05  2.35312986e+07  1.01e+01 1.32e-01  7.56e+01     8s
   9  -1.94579193e+05  1.40611406e+07  6.03e+00 7.65e-02  4.45e+01     8s
  10  -1.37862403e+05  8.14806546e+06  2.95e+00 4.28e-02  2.55e+01     8s
  11  -1.00069556e+05  4.53356277e+06  1.18e+00 2.30e-02  1.41e+01     8s
  12  -7.51911196e+04  3.09729656e+06  4.24e-01 1.56e-02  9.60e+00     8s
  13  -5.22045718e+04  8.94615782e+05  1.85e-01 4.35e-03  2.86e+00     8s
  14  -3.85723415e+04  3.68169307e+05  1.26e-01 1.73e-03  1.23e+00     8s
  15  -1.27765285e+04  3.06188671e+05  6.82e-02 1.36e-03  9.63e-01     8s
  16   2.84158549e+03  2.09233101e+05  4.46e-02 1.65e-03  6.23e-01     8s
  17   7.51379395e+03  1.63538892e+05  3.86e-02 1.66e-03  4.71e-01     8s
  18   1.75129338e+04  1.37201525e+05  2.69e-02 1.76e-03  3.61e-01     9s
  19   2.38375005e+04  1.01006957e+05  1.98e-02 1.07e-03  2.33e-01     9s
  20   2.50195257e+04  9.53412055e+04  1.86e-02 9.65e-04  2.12e-01     9s
  21   2.94918300e+04  8.74155701e+04  1.41e-02 8.05e-04  1.75e-01     9s
  22   3.16889809e+04  7.67184209e+04  1.22e-02 5.93e-04  1.36e-01     9s
  23   3.47406997e+04  7.15140859e+04  9.66e-03 4.86e-04  1.11e-01     9s
  24   3.66361108e+04  6.69168818e+04  8.19e-03 3.90e-04  9.15e-02     9s
  25   3.80443556e+04  6.18210302e+04  7.16e-03 2.87e-04  7.18e-02     9s
  26   3.92205593e+04  5.92870081e+04  6.33e-03 2.31e-04  6.06e-02     9s
  27   4.07072249e+04  5.71462016e+04  5.30e-03 1.83e-04  4.97e-02     9s
  28   4.26297798e+04  5.54132365e+04  4.01e-03 1.47e-04  3.86e-02     9s
  29   4.36467210e+04  5.35512431e+04  3.34e-03 1.06e-04  2.99e-02    10s
  30   4.50404222e+04  5.24866079e+04  2.48e-03 7.97e-05  2.25e-02    10s
  31   4.58458173e+04  5.17075388e+04  1.97e-03 6.21e-05  1.77e-02    10s
  32   4.66858794e+04  5.10644353e+04  1.45e-03 4.35e-05  1.32e-02    10s
  33   4.69732686e+04  5.08371956e+04  1.27e-03 3.83e-05  1.17e-02    10s
  34   4.74282028e+04  5.05081221e+04  9.93e-04 3.08e-05  9.30e-03    10s
  35   4.77502007e+04  5.02588725e+04  8.02e-04 2.48e-05  7.58e-03    10s
  36   4.80290353e+04  4.98706329e+04  6.41e-04 1.51e-05  5.56e-03    10s
  37   4.83281526e+04  4.97453236e+04  4.70e-04 1.23e-05  4.28e-03    10s
  38   4.84218884e+04  4.96391269e+04  4.16e-04 9.97e-06  3.68e-03    11s
  39   4.86144163e+04  4.95140098e+04  3.08e-04 7.07e-06  2.72e-03    11s
  40   4.87984900e+04  4.94258276e+04  2.10e-04 5.07e-06  1.89e-03    11s
  41   4.88674352e+04  4.93775193e+04  1.72e-04 3.96e-06  1.54e-03    11s
  42   4.90137323e+04  4.93178758e+04  9.20e-05 2.63e-06  9.19e-04    11s
  43   4.90702898e+04  4.93060242e+04  6.19e-05 2.36e-06  7.12e-04    11s
  44   4.91243192e+04  4.92143990e+04  3.49e-05 3.89e-07  2.72e-04    11s
  45   4.91539367e+04  4.92072076e+04  2.04e-05 6.02e-07  1.61e-04    11s
  46   4.91606665e+04  4.92050895e+04  1.69e-05 4.98e-07  1.34e-04    11s
  47   4.91812403e+04  4.92031091e+04  6.56e-06 3.86e-07  6.61e-05    11s
  48   4.91854846e+04  4.91996916e+04  4.55e-06 2.07e-07  4.29e-05    11s
  49   4.91928015e+04  4.91961996e+04  1.14e-06 2.16e-08  1.03e-05    12s
  50   4.91951761e+04  4.91956108e+04  1.59e-07 1.26e-09  1.31e-06    12s
  51   4.91951764e+04  4.91956108e+04  1.51e-05 1.21e-09  1.31e-06    12s
  52   4.91952720e+04  4.91956076e+04  1.06e-05 1.47e-08  1.01e-06    12s
  53   4.91952933e+04  4.91956054e+04  1.18e-05 9.14e-09  9.41e-07    12s
  54   4.91953380e+04  4.91956037e+04  2.72e-05 1.45e-07  8.03e-07    12s
  55   4.91953408e+04  4.91956035e+04  2.79e-05 1.36e-07  7.95e-07    12s
  56   4.91954641e+04  4.91955991e+04  1.41e-05 7.09e-08  4.09e-07    12s
  57   4.91955053e+04  4.91955984e+04  2.60e-05 1.03e-07  2.83e-07    12s
  58   4.91955188e+04  4.91955973e+04  2.41e-05 6.76e-08  2.39e-07    12s
  59   4.91955190e+04  4.91955973e+04  2.40e-05 6.83e-08  2.38e-07    13s
  60   4.91955222e+04  4.91955968e+04  2.29e-05 5.50e-08  2.27e-07    13s
  61   4.91955322e+04  4.91955964e+04  1.98e-05 4.91e-08  1.96e-07    13s
  62   4.91955362e+04  4.91955962e+04  1.84e-05 4.56e-08  1.83e-07    13s
  63   4.91955382e+04  4.91955960e+04  1.81e-05 3.99e-08  1.76e-07    13s
  64   4.91955427e+04  4.91955958e+04  1.66e-05 3.74e-08  1.62e-07    13s
  65   4.91955589e+04  4.91955936e+04  1.03e-05 9.62e-08  1.06e-07    13s
  66   4.91955781e+04  4.91955935e+04  7.50e-06 7.21e-08  4.72e-08    13s
  67   4.91955782e+04  4.91955935e+04  7.48e-06 7.17e-08  4.70e-08    13s
  68   4.91955785e+04  4.91955938e+04  7.98e-06 6.28e-08  4.72e-08    14s
  69   4.91955827e+04  4.91955932e+04  6.01e-06 6.88e-08  3.23e-08    14s
  70   4.91955829e+04  4.91955932e+04  5.88e-06 6.74e-08  3.15e-08    14s
  71   4.91955837e+04  4.91955932e+04  5.41e-06 5.85e-08  2.90e-08    14s
  72   4.91955837e+04  4.91955932e+04  5.36e-06 5.85e-08  2.88e-08    14s
  73   4.91955839e+04  4.91955932e+04  6.01e-06 5.78e-08  2.87e-08    14s
  74   4.91955873e+04  4.91955931e+04  3.32e-06 3.46e-08  1.80e-08    14s
  75   4.91955895e+04  4.91955929e+04  2.53e-06 5.22e-08  1.06e-08    14s
  76   4.91955920e+04  4.91955929e+04  2.98e-06 5.61e-08  2.91e-09    14s
  77   4.91955925e+04  4.91955929e+04  1.54e-06 2.70e-08  1.51e-09    14s

Barrier solved model in 77 iterations and 14.39 seconds (28.72 work units)
Optimal objective 4.91955925e+04


Root crossover log...

  156338 DPushes remaining with DInf 0.0000000e+00                14s
   85976 DPushes remaining with DInf 0.0000000e+00                15s
   34306 DPushes remaining with DInf 0.0000000e+00                20s
    6617 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

   36490 PPushes remaining with PInf 1.8297165e-02                28s
    7506 PPushes remaining with PInf 1.7931092e-04                30s
       0 PPushes remaining with PInf 3.5917229e-08                31s

  Push phase complete: Pinf 3.5917229e-08, Dinf 5.4741693e+07     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  123899    4.9195555e+04   0.000000e+00   5.474169e+07     32s
  125259    4.9195593e+04   0.000000e+00   0.000000e+00     34s
  125259    4.9195593e+04   0.000000e+00   0.000000e+00     34s
Concurrent spin time: 11.97s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.919559e+04, 125259 iterations, 41.08 seconds (78.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49195.5929    0  271 -233202.98 49195.5929   121%     -   46s
H    0     0                    -199046.5954 49195.5929   125%     -   47s
H    0     0                    -196386.3791 49195.5929   125%     -   47s
H    0     0                    -187070.4921 49195.5929   126%     -   48s
H    0     0                    -180765.2436 49195.5929   127%     -   48s
H    0     0                    -177145.8101 49195.5929   128%     -   49s
H    0     0                    -158317.0435 49195.5929   131%     -   50s
H    0     0                    -82283.44073 49195.5929   160%     -   50s
H    0     0                    -39962.67805 49195.5929   223%     -   50s
H    0     0                    -9885.469092 49195.5929   598%     -   50s
H    0     0                    -4236.062859 49195.5929  1261%     -   50s
H    0     0                    -4129.860701 49195.5929  1291%     -   50s
     0     0 42394.0633    0  313 -4129.8607 42394.0633  1127%     -  164s
H    0     0                    -1990.183220 42393.8861  2230%     -  165s
H    0     0                    -1956.201417 42393.8861  2267%     -  166s
H    0     0                    -1945.175928 42393.8861  2279%     -  166s
     0     0 41805.1698    0  311 -1945.1759 41805.1698  2249%     -  222s
     0     0 41656.0150    0  314 -1945.1759 41656.0150  2242%     -  248s
     0     0 41396.1465    0  344 -1945.1759 41396.1465  2228%     -  277s
     0     0 41392.2051    0  346 -1945.1759 41392.2051  2228%     -  282s
     0     0 41385.9587    0  348 -1945.1759 41385.9587  2228%     -  289s
     0     0 41248.4324    0  338 -1945.1759 41248.4324  2221%     -  305s
     0     0 41237.7778    0  341 -1945.1759 41237.7778  2220%     -  310s
     0     0 41202.8584    0  343 -1945.1759 41202.8584  2218%     -  319s
     0     0 41196.2635    0  343 -1945.1759 41196.2635  2218%     -  323s
     0     0 41184.4457    0  341 -1945.1759 41184.4457  2217%     -  330s
     0     0 41184.0329    0  342 -1945.1759 41184.0329  2217%     -  331s
     0     0 37821.6767    0  369 -1945.1759 37821.6767  2044%     -  456s
     0     0 37464.5154    0  386 -1945.1759 37464.5154  2026%     -  492s
     0     0 37102.6822    0  403 -1945.1759 37102.6822  2007%     -  536s
     0     0 36814.2142    0  385 -1945.1759 36814.2142  1993%     -  571s
     0     0 36729.2307    0  403 -1945.1759 36729.2307  1988%     -  593s
     0     0 36709.2461    0  389 -1945.1759 36709.2461  1987%     -  606s
     0     0 36661.1964    0  360 -1945.1759 36661.1964  1985%     -  616s
     0     0 36553.2574    0  350 -1945.1759 36553.2574  1979%     -  633s
     0     0 36535.8809    0  352 -1945.1759 36535.8809  1978%     -  639s
     0     0 36524.2073    0  361 -1945.1759 36524.2073  1978%     -  648s
     0     0 36470.7294    0  383 -1945.1759 36470.7294  1975%     -  666s
     0     0 36346.7308    0  386 -1945.1759 36346.7308  1969%     -  692s
     0     0 36339.6474    0  389 -1945.1759 36339.6474  1968%     -  698s
     0     0 36333.9536    0  393 -1945.1759 36333.9536  1968%     -  704s
     0     0 36332.8830    0  393 -1945.1759 36332.8830  1968%     -  707s
     0     0 33932.2229    0  462 -1945.1759 33932.2229  1844%     -  825s
H    0     0                    -1843.352281 33932.0825  1941%     -  826s
H    0     0                    -1824.276429 33932.0825  1960%     -  826s
     0     0 33484.0915    0  478 -1824.2764 33484.0915  1935%     -  877s
     0     0 33147.3450    0  482 -1824.2764 33147.3450  1917%     -  918s
     0     0 32915.5472    0  475 -1824.2764 32915.5472  1904%     -  948s
     0     0 32753.1575    0  483 -1824.2764 32753.1575  1895%     -  975s
     0     0 32726.3099    0  490 -1824.2764 32726.3099  1894%     -  989s
     0     0 32723.2140    0  487 -1824.2764 32723.2140  1894%     -  997s
     0     0 32722.0081    0  488 -1824.2764 32722.0081  1894%     -  999s
     0     0 32025.0052    0  419 -1824.2764 32025.0052  1855%     - 1086s
H    0     0                    -1246.403349 32024.5849  2669%     - 1086s
     0     0 31780.9084    0  464 -1246.4033 31780.9084  2650%     - 1128s
     0     0 31695.1042    0  430 -1246.4033 31695.1042  2643%     - 1151s
     0     0 31568.9275    0  438 -1246.4033 31568.9275  2633%     - 1174s
     0     0 31509.3077    0  443 -1246.4033 31509.3077  2628%     - 1195s
     0     0 31479.3497    0  483 -1246.4033 31479.3497  2626%     - 1211s
     0     0 31462.0137    0  452 -1246.4033 31462.0137  2624%     - 1221s
     0     0 31446.3326    0  454 -1246.4033 31446.3326  2623%     - 1228s
     0     0 31437.4106    0  458 -1246.4033 31437.4106  2622%     - 1234s
     0     0 31434.9752    0  466 -1246.4033 31434.9752  2622%     - 1238s
     0     0 31251.6895    0  457 -1246.4033 31251.6895  2607%     - 1268s
     0     0 31199.7163    0  432 -1246.4033 31199.7163  2603%     - 1290s
     0     0 31169.3731    0  528 -1246.4033 31169.3731  2601%     - 1306s
     0     0 31155.5787    0  530 -1246.4033 31155.5787  2600%     - 1316s
     0     0 31152.3114    0  468 -1246.4033 31152.3114  2599%     - 1321s
     0     0 31140.4574    0  484 -1246.4033 31140.4574  2598%     - 1330s
     0     0 31126.4704    0  476 -1246.4033 31126.4704  2597%     - 1341s
     0     0 31123.7873    0  474 -1246.4033 31123.7873  2597%     - 1344s
     0     0 31062.5732    0  473 -1246.4033 31062.5732  2592%     - 1369s
H    0     0                    -568.8873540 31062.5213  5560%     - 1372s
H    0     0                    -296.8006811 31062.5213      -     - 1372s
H    0     0                    -281.2456064 31062.5213      -     - 1372s
     0     0 31027.0547    0  527 -281.24561 31027.0547      -     - 1388s
     0     0 31020.2933    0  481 -281.24561 31020.2933      -     - 1394s
     0     0 31002.8954    0  434 -281.24561 31002.8954      -     - 1407s
     0     0 30993.2105    0  451 -281.24561 30993.2105      -     - 1414s
     0     0 30989.0875    0  466 -281.24561 30989.0875      -     - 1419s
     0     0 30984.2558    0  462 -281.24561 30984.2558      -     - 1425s
     0     0 30973.8754    0  478 -281.24561 30973.8754      -     - 1431s
     0     0 30969.3889    0  474 -281.24561 30969.3889      -     - 1437s
     0     0 30967.5662    0  470 -281.24561 30967.5662      -     - 1451s
     0     0 30933.9015    0  497 -281.24561 30933.9015      -     - 1471s
     0     0 30925.8180    0  516 -281.24561 30925.8180      -     - 1481s
     0     0 30923.3659    0  526 -281.24561 30923.3659      -     - 1484s
     0     0 30908.4593    0  543 -281.24561 30908.4593      -     - 1499s
H    0     0                     548.1746740 30908.3920  5538%     - 1500s
H    0     0                     589.7193805 30908.3920  5141%     - 1500s
H    0     0                     648.1508055 30908.3920  4669%     - 1500s
H    0     0                    1114.6109660 30908.3920  2673%     - 1501s
H    0     0                    1473.9563558 30908.3920  1997%     - 1501s
H    0     0                    3475.0097903 30908.3920   789%     - 1501s
H    0     0                    3950.7314124 30908.3920   682%     - 1501s
H    0     0                    4341.5601105 30908.3920   612%     - 1501s
H    0     0                    4484.1899393 30908.3920   589%     - 1501s
H    0     0                    5121.9542547 30908.3920   503%     - 1501s
     0     0 30905.9633    0  490 5121.95425 30905.9633   503%     - 1505s
     0     0 30895.8849    0  469 5121.95425 30895.8849   503%     - 1520s
H    0     0                    5194.6354327 30895.1436   495%     - 1521s
H    0     0                    5509.0284378 30895.1436   461%     - 1521s
H    0     0                    5540.7255389 30895.1436   458%     - 1521s
H    0     0                    5577.3008207 30895.1436   454%     - 1521s
H    0     0                    5719.6707243 30895.1436   440%     - 1521s
     0     0 30888.7203    0  484 5719.67072 30888.7203   440%     - 1528s
     0     0 30887.1873    0  472 5719.67072 30887.1873   440%     - 1531s
     0     0 30884.3638    0  488 5719.67072 30884.3638   440%     - 1538s
     0     0 30883.4753    0  488 5719.67072 30883.4753   440%     - 1550s
H    0     0                    10484.425105 30883.4753   195%     - 1778s
H    0     0                    10784.443048 30883.4753   186%     - 1778s
H    0     0                    13266.502178 30883.4753   133%     - 1780s
H    0     0                    14744.989328 30883.4753   109%     - 1780s
H    0     0                    14923.606405 30883.4753   107%     - 1780s
H    0     0                    15160.732416 30883.4753   104%     - 1780s
H    0     0                    15306.790972 30883.4753   102%     - 1783s
H    0     0                    15311.616096 30883.4753   102%     - 1783s
H    0     0                    15372.708068 30883.4753   101%     - 1783s
H    0     0                    15621.076020 30883.4753  97.7%     - 1790s
H    0     2                    16004.889965 30883.4753  93.0%     - 1800s
     0     2 30883.4753    0  488 16004.8900 30883.4753  93.0%     - 1800s
     1     3 30518.0714    1  415 16004.8900 30883.4753  93.0% 17665 1828s
     2     5 30293.9584    2  411 16004.8900 30883.4753  93.0% 16324 1851s
     4     9 30164.0733    3  444 16004.8900 30659.4094  91.6% 14387 1897s
     8    17 29795.7144    4  425 16004.8900 30659.4094  91.6% 16403 1951s
    16    34 29552.7578    5  421 16004.8900 30288.4934  89.2% 17478 1997s
    33    49 29645.5394    4  442 16004.8900 29988.0199  87.4% 24382 2100s
H   48    73                    16035.864594 29988.0199  87.0% 27380 2179s
H   51    73                    16979.608837 29988.0199  76.6% 27382 2179s
    72   105 27804.2263    6  337 16979.6088 29988.0199  76.6% 23407 2308s
   104   240 27740.7613    7  330 16979.6088 29988.0199  76.6% 21783 2398s
   239   296 27421.6127    9  305 16979.6088 29988.0199  76.6% 12448 2441s
   295   321 27606.7411   11  313 16979.6088 29988.0199  76.6% 11118 2479s
   320   358 27197.5042   10  307 16979.6088 29988.0199  76.6% 10915 2515s
   357   400 27515.2800   12  252 16979.6088 29988.0199  76.6% 10438 2549s
H  398   400                    17097.915874 29988.0199  75.4% 10562 2549s
   399   461 26719.6730   12  310 17097.9159 29988.0199  75.4% 10584 2588s
   460   532 24495.9395   19  259 17097.9159 29988.0199  75.4%  9940 2626s
   531   615 27229.8101   13  224 17097.9159 29988.0199  75.4%  9194 2662s
   614   699 27141.0502   12  308 17097.9159 29988.0199  75.4%  8568 2698s
   698   788 26845.7956   14  180 17097.9159 29988.0199  75.4%  8025 2728s
   787   867 27072.0048   14  217 17097.9159 29988.0199  75.4%  7448 2758s
   868   939 23487.7757   27  255 17097.9159 29988.0199  75.4%  7061 2786s
   944  1009 26773.9115   15  190 17097.9159 29988.0199  75.4%  6762 2817s
  1025  1063 25315.5919   16  264 17097.9159 29988.0199  75.4%  6489 2850s
  1106  1085 25451.4420   16  170 17097.9159 29988.0199  75.4%  6215 2885s
  1172  1116 23264.1662   31  240 17097.9159 29988.0199  75.4%  6123 2919s
  1253  1133 20063.8470   17  191 17097.9159 29988.0199  75.4%  5896 2959s
  1334  1149 19820.3148   18  201 17097.9159 29988.0199  75.4%  5733 2999s
  1398  1163 19646.9052   20  265 17097.9159 29988.0199  75.4%  5673 3040s
  1426  1205 19427.7162   21  137 17097.9159 29988.0199  75.4%  5718 3079s
  1470  1281 19368.9345   22  147 17097.9159 29988.0199  75.4%  5703 3115s
H 1560  1281                    17126.229597 29988.0199  75.1%  5527 3115s
  1570  1301 infeasible   26      17126.2296 29988.0199  75.1%  5512 3153s
H 1594  1301                    17231.509847 29988.0199  74.0%  5500 3153s
  1618  1370 18982.0155   25  122 17231.5098 29988.0199  74.0%  5501 3196s
  1759  1422     cutoff   26      17231.5098 29988.0199  74.0%  5354 3243s
  1891  1459 18900.6766   25  114 17231.5098 29988.0199  74.0%  5208 3287s
  2003  1500 18970.9178   27  120 17231.5098 29988.0199  74.0%  5156 3337s
  2123  1546 18464.7663   29  129 17231.5098 29988.0199  74.0%  5075 3386s
  2238  1613 18205.3213   31  136 17231.5098 29988.0199  74.0%  5044 3442s
  2355  1634 17553.4128   36  101 17231.5098 29988.0199  74.0%  5025 3502s
  2457  1688 22382.3553   10  251 17231.5098 29988.0199  74.0%  5008 3581s
  2533  1714 22271.7625   11  319 17231.5098 29988.0199  74.0%  5074 3600s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 300
  MIR: 4736
  Flow cover: 4123
  RLT: 120
  Relax-and-lift: 847

Explored 2568 nodes (14027340 simplex iterations) in 3600.04 seconds (8299.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17231.5 17126.2 17097.9 ... 15306.8

Time limit reached
Best objective 1.723150984669e+04, best bound 2.998801985172e+04, gap 74.0301%
  WARNING: Time limit reached. Using best solution found (gap: 74.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 17231.51, θ = 170893.22
  Upper Bound (UB) = 17231.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170893.22
  [DEBUG]   ✓ Scenario 0: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170893.22 ≤ Q = 170893.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170893.22 ≤ Q = 170893.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170893.22 ≤ Q = 170893.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 170893.22 ≤ Q = 170893.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 170893.22 ≤ Q = 171842.72 (slack: 949.49)
  [DEBUG]   ✓ Scenario 16: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 170893.22 ≤ Q = 170893.22 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41ae091f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41ae091f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256110e+13
Presolve removed 2553 rows and 1845 columns
Presolve time: 0.00s
Presolved: 540 rows, 544 columns, 1526 nonzeros
Found heuristic solution: objective 6988642.5842
Variable types: 368 continuous, 176 integer (176 binary)

Root relaxation: objective -1.382309e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138230.90    0  122 6988642.58 -138230.90   102%     -    0s
H    0     0                    -101488.8199 -138230.90  36.2%     -    0s
H    0     0                    -103138.3807 -138230.90  34.0%     -    0s
     0     0 -110138.18    0  121 -103138.38 -110138.18  6.79%     -    0s
H    0     0                    -107875.6600 -110126.81  2.09%     -    0s
     0     0 -109825.86    0  115 -107875.66 -109825.86  1.81%     -    0s
H    0     0                    -108254.0540 -109807.80  1.44%     -    0s
H    0     0                    -108308.7549 -109807.80  1.38%     -    0s
     0     0 -109807.78    0  115 -108308.75 -109807.78  1.38%     -    0s
     0     0 -109659.73    0   68 -108308.75 -109659.73  1.25%     -    0s
H    0     0                    -108329.5020 -109632.50  1.20%     -    0s
     0     0 -109632.50    0   67 -108329.50 -109632.50  1.20%     -    0s
     0     0 -109572.20    0   75 -108329.50 -109572.20  1.15%     -    0s
     0     0 -109566.99    0   75 -108329.50 -109566.99  1.14%     -    0s
     0     2 -109566.83    0   75 -108329.50 -109566.83  1.14%     -    0s
H    3     8                    -108935.6831 -109511.96  0.53%  17.0    0s
H   35    13                    -108986.7242 -109342.98  0.33%  13.6    0s
H   96    32                    -109007.4713 -109240.58  0.21%   8.2    0s
*  497     9              35    -109008.4588 -109121.16  0.10%   4.8    0s
*  544     5              32    -109030.9116 -109030.91  0.00%   4.7    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 212
  Flow cover: 2
  RLT: 3

Explored 563 nodes (3164 simplex iterations) in 0.10 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109031 -109008 -109007 ... -103138
No other solutions better than -109031

Optimal solution found (tolerance 1.00e-06)
Best objective -1.090309116060e+05, best bound -1.090309116060e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 167947.84
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109030.91
  [DEBUG]   S×d_nominal = 276978.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276978.75 + -109030.91 = 167947.84
  [DEBUG]   Current θ from Master = 170893.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2945.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14286.13
  Lower Bound (LB) = 14704.60
  Gap (UB-LB) = 2526.9133, Absolute Gap = 2526.9133, Relative Gap = 0.146645
  Not converged yet (gap = 2526.91 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913874 nonzeros
Model fingerprint: 0x507eec89
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 131502 rows and 53382 columns
Presolve time: 3.77s
Presolved: 190971 rows, 79918 columns, 1172559 nonzeros
Variable types: 77659 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.59s

Barrier statistics:
 Dense cols : 1259
 AA' NZ     : 4.343e+06
 Factor NZ  : 1.272e+07 (roughly 200 MB of memory)
 Factor Ops : 4.650e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.10427775e+07  3.10946817e+08  1.46e+05 1.75e+01  9.51e+04     7s
   1  -1.66898940e+07  2.83902837e+08  1.05e+05 6.97e+01  6.78e+04     7s
   2  -6.22062938e+06  2.26107650e+08  3.86e+04 1.15e+00  2.64e+04     7s
   3  -1.09015038e+06  1.73021589e+08  3.04e+03 2.70e+00  2.49e+03     7s
   4  -6.37984325e+05  9.94170512e+07  7.05e+02 9.45e-01  7.10e+02     8s
   5  -5.39311344e+05  5.97778576e+07  3.95e+02 4.68e-01  3.89e+02     8s
   6  -4.23956595e+05  4.49674645e+07  1.20e+02 3.21e-01  1.92e+02     8s
   7  -3.68094288e+05  3.12803174e+07  6.27e+01 2.09e-01  1.19e+02     8s
   8  -2.38789823e+05  2.54671249e+07  1.07e+01 1.64e-01  7.82e+01     8s
   9  -1.70692150e+05  9.51245690e+06  5.19e+00 5.65e-02  2.88e+01     8s
  10  -1.24431927e+05  6.15924173e+06  2.85e+00 3.51e-02  1.84e+01     8s
  11  -1.00815470e+05  3.85418540e+06  1.65e+00 2.14e-02  1.15e+01     8s
  12  -7.93479492e+04  2.53776420e+06  8.49e-01 1.37e-02  7.58e+00     8s
  13  -5.42351432e+04  8.27454210e+05  3.98e-01 4.40e-03  2.55e+00     8s
  14  -3.70201878e+04  3.26849131e+05  2.46e-01 1.88e-03  1.05e+00     8s
  15  -2.11867338e+04  2.46130819e+05  1.81e-01 1.89e-03  7.71e-01     8s
  16  -3.78908787e+03  1.77269211e+05  1.24e-01 4.45e-03  5.22e-01     8s
  17   1.54018093e+03  1.39136905e+05  1.09e-01 6.11e-03  3.97e-01     8s
  18   1.29580794e+04  1.16570807e+05  8.12e-02 9.11e-03  2.99e-01     8s
  19   1.77106404e+04  9.79115651e+04  6.92e-02 9.18e-03  2.31e-01     8s
  20   2.19708678e+04  8.45361240e+04  5.88e-02 4.54e-03  1.80e-01     9s
  21   2.56949608e+04  7.62396990e+04  5.00e-02 5.40e-03  1.46e-01     9s
  22   2.97917329e+04  7.22267424e+04  4.01e-02 4.63e-03  1.22e-01     9s
  23   3.11403787e+04  6.92361463e+04  3.69e-02 4.09e-03  1.10e-01     9s
  24   3.34528688e+04  6.41743819e+04  3.17e-02 3.07e-03  8.86e-02     9s
  25   3.55557289e+04  6.30404614e+04  2.71e-02 2.86e-03  7.93e-02     9s
  26   3.68466089e+04  6.01754260e+04  2.43e-02 2.27e-03  6.73e-02     9s
  27   3.94596182e+04  5.86431839e+04  1.88e-02 1.95e-03  5.53e-02     9s
  28   4.03648892e+04  5.61988456e+04  1.69e-02 1.49e-03  4.57e-02     9s
  29   4.11742815e+04  5.56004675e+04  1.53e-02 1.36e-03  4.16e-02     9s
  30   4.23907866e+04  5.42310528e+04  1.28e-02 1.06e-03  3.41e-02     9s
  31   4.40198657e+04  5.32092938e+04  9.63e-03 8.43e-04  2.65e-02     9s
  32   4.47802911e+04  5.23474322e+04  8.17e-03 6.58e-04  2.18e-02    10s
  33   4.54359220e+04  5.16529193e+04  6.93e-03 5.11e-04  1.79e-02    10s
  34   4.58530767e+04  5.13557888e+04  6.11e-03 4.48e-04  1.59e-02    10s
  35   4.63929008e+04  5.07134432e+04  5.09e-03 3.21e-04  1.25e-02    10s
  36   4.65253044e+04  5.04403422e+04  4.84e-03 2.68e-04  1.13e-02    10s
  37   4.71312090e+04  5.00956268e+04  3.72e-03 1.90e-04  8.55e-03    10s
  38   4.76238882e+04  4.98620887e+04  2.81e-03 1.38e-04  6.46e-03    10s
  39   4.80256474e+04  4.97851475e+04  2.11e-03 1.18e-04  5.08e-03    10s
  40   4.82564908e+04  4.96835548e+04  1.69e-03 9.78e-05  4.12e-03    10s
  41   4.84352840e+04  4.95580983e+04  1.37e-03 1.05e-04  3.24e-03    10s
  42   4.86910927e+04  4.94605029e+04  9.13e-04 7.33e-05  2.22e-03    10s
  43   4.87788000e+04  4.93715447e+04  7.55e-04 4.61e-05  1.71e-03    10s
  44   4.88934565e+04  4.92990645e+04  5.60e-04 2.96e-05  1.17e-03    11s
  45   4.89408767e+04  4.92886444e+04  4.78e-04 2.46e-05  1.00e-03    11s
  46   4.90140456e+04  4.92600979e+04  3.50e-04 1.89e-05  7.10e-04    11s
  47   4.91155421e+04  4.92518055e+04  1.70e-04 1.72e-05  3.93e-04    11s
  48   4.91568337e+04  4.92409597e+04  1.02e-04 2.26e-05  2.43e-04    11s
  49   4.91623303e+04  4.92347167e+04  9.29e-05 1.48e-05  2.09e-04    11s
  50   4.91696571e+04  4.92298301e+04  8.11e-05 8.49e-06  1.74e-04    11s
  51   4.91845419e+04  4.92258182e+04  5.76e-05 3.53e-06  1.19e-04    11s
  52   4.92127985e+04  4.92240851e+04  1.58e-05 2.84e-06  3.26e-05    11s
  53   4.92182000e+04  4.92233202e+04  6.68e-06 1.62e-06  1.48e-05    11s
  54   4.92202760e+04  4.92224714e+04  3.17e-06 3.05e-07  6.34e-06    11s
  55   4.92217754e+04  4.92223203e+04  7.46e-07 6.34e-08  1.57e-06    11s
  56   4.92222314e+04  4.92222815e+04  4.17e-08 1.18e-08  1.45e-07    12s
  57   4.92222596e+04  4.92222663e+04  3.02e-08 1.69e-09  1.95e-08    12s
  58   4.92222620e+04  4.92222663e+04  3.11e-06 1.55e-08  1.24e-08    12s
  59   4.92222661e+04  4.92222662e+04  1.97e-07 4.10e-08  4.10e-10    12s

Barrier solved model in 59 iterations and 11.76 seconds (19.66 work units)
Optimal objective 4.92222661e+04


Root crossover log...

  163398 DPushes remaining with DInf 0.0000000e+00                12s
   51629 DPushes remaining with DInf 0.0000000e+00                15s
     875 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   10937 PPushes remaining with PInf 1.2231085e-04                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3921872e+02     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   88562    4.9222266e+04   0.000000e+00   1.392187e+02     22s
   88625    4.9222266e+04   0.000000e+00   0.000000e+00     22s
   88625    4.9222266e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 5.17s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.922227e+04, 88625 iterations, 22.75 seconds (41.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49222.2662    0  275 -233202.98 49222.2662   121%     -   28s
H    0     0                    -231320.2533 49222.2662   121%     -   29s
H    0     0                    -207802.0976 49222.2662   124%     -   29s
H    0     0                    -207283.7895 49222.2662   124%     -   29s
H    0     0                    -202422.0532 49222.2662   124%     -   30s
H    0     0                    -202095.3937 49222.2662   124%     -   30s
H    0     0                    -200152.8970 49222.2662   125%     -   30s
H    0     0                    -182610.7486 49222.2662   127%     -   30s
H    0     0                    -182090.9847 49222.2662   127%     -   30s
H    0     0                    -174717.8078 49222.2662   128%     -   30s
H    0     0                    -173420.0621 49222.2662   128%     -   31s
H    0     0                    -169474.9662 49222.2662   129%     -   31s
H    0     0                    -169031.5621 49222.2662   129%     -   31s
H    0     0                    -168905.6709 49222.2662   129%     -   31s
H    0     0                    -168821.8808 49222.2662   129%     -   31s
H    0     0                    -82788.47868 49222.2662   159%     -   31s
H    0     0                    -13413.78588 49222.2662   467%     -   32s
H    0     0                    -5500.261894 49222.2662   995%     -   32s
H    0     0                    -5341.198927 49222.2662  1022%     -   32s
H    0     0                    -5230.333402 49222.2662  1041%     -   32s
     0     0 41747.0085    0  317 -5230.3334 41747.0085   898%     -  169s
H    0     0                    -3082.308441 41746.9908  1454%     -  170s
H    0     0                    -2672.192606 41746.9908  1662%     -  171s
H    0     0                    -2367.710155 41746.9908  1863%     -  171s
     0     0 41172.9885    0  324 -2367.7102 41172.9885  1839%     -  217s
     0     0 41065.6853    0  334 -2367.7102 41065.6853  1834%     -  248s
     0     0 40975.9972    0  326 -2367.7102 40975.9972  1831%     -  271s
     0     0 40891.4316    0  331 -2367.7102 40891.4316  1827%     -  284s
     0     0 40713.7706    0  332 -2367.7102 40713.7706  1820%     -  304s
     0     0 40699.7124    0  342 -2367.7102 40699.7124  1819%     -  318s
     0     0 40414.0020    0  330 -2367.7102 40414.0020  1807%     -  349s
     0     0 40392.4045    0  330 -2367.7102 40392.4045  1806%     -  358s
     0     0 40391.9107    0  329 -2367.7102 40391.9107  1806%     -  360s
     0     0 37174.0589    0  413 -2367.7102 37174.0589  1670%     -  497s
H    0     0                    1601.9347475 37174.0241  2221%     -  498s
H    0     0                    2357.2298915 37174.0241  1477%     -  498s
H    0     0                    2518.5352589 37174.0241  1376%     -  498s
     0     0 36651.5108    0  424 2518.53526 36651.5108  1355%     -  568s
     0     0 36439.9519    0  421 2518.53526 36439.9519  1347%     -  607s
     0     0 36345.4404    0  416 2518.53526 36345.4404  1343%     -  641s
     0     0 36164.4365    0  416 2518.53526 36164.4365  1336%     -  683s
     0     0 36048.1458    0  453 2518.53526 36048.1458  1331%     -  720s
     0     0 36022.8326    0  474 2518.53526 36022.8326  1330%     -  738s
     0     0 36018.8257    0  472 2518.53526 36018.8257  1330%     -  746s
     0     0 36009.5623    0  482 2518.53526 36009.5623  1330%     -  755s
     0     0 35987.2433    0  487 2518.53526 35987.2433  1329%     -  769s
     0     0 35981.9703    0  479 2518.53526 35981.9703  1329%     -  776s
     0     0 35977.3155    0  448 2518.53526 35977.3155  1329%     -  780s
     0     0 35965.2210    0  443 2518.53526 35965.2210  1328%     -  786s
     0     0 35943.3415    0  485 2518.53526 35943.3415  1327%     -  801s
     0     0 35937.0545    0  486 2518.53526 35937.0545  1327%     -  807s
     0     0 35933.3989    0  486 2518.53526 35933.3989  1327%     -  811s
     0     0 35930.7843    0  487 2518.53526 35930.7843  1327%     -  814s
     0     0 35930.3731    0  492 2518.53526 35930.3731  1327%     -  817s
     0     0 33313.7889    0  470 2518.53526 33313.7889  1223%     - 1001s
H    0     0                    2547.1226447 33312.4088  1208%     - 1003s
     0     0 32935.1137    0  466 2547.12264 32935.1137  1193%     - 1066s
     0     0 32726.0246    0  520 2547.12264 32726.0246  1185%     - 1104s
     0     0 32628.3499    0  535 2547.12264 32628.3499  1181%     - 1133s
     0     0 32526.7582    0  503 2547.12264 32526.7582  1177%     - 1164s
     0     0 32481.0954    0  500 2547.12264 32481.0954  1175%     - 1188s
     0     0 32455.5123    0  546 2547.12264 32455.5123  1174%     - 1206s
     0     0 32444.7674    0  551 2547.12264 32444.7674  1174%     - 1215s
     0     0 32407.1439    0  549 2547.12264 32407.1439  1172%     - 1232s
     0     0 32400.4580    0  513 2547.12264 32400.4580  1172%     - 1244s
     0     0 32394.7682    0  554 2547.12264 32394.7682  1172%     - 1255s
     0     0 32382.3979    0  541 2547.12264 32382.3979  1171%     - 1264s
     0     0 32375.1107    0  516 2547.12264 32375.1107  1171%     - 1272s
     0     0 32367.5302    0  515 2547.12264 32367.5302  1171%     - 1280s
     0     0 32364.6656    0  515 2547.12264 32364.6656  1171%     - 1286s
     0     0 32349.9393    0  559 2547.12264 32349.9393  1170%     - 1296s
     0     0 32346.8319    0  521 2547.12264 32346.8319  1170%     - 1300s
     0     0 32343.9667    0  523 2547.12264 32343.9667  1170%     - 1302s
     0     0 32319.4871    0  526 2547.12264 32319.4871  1169%     - 1311s
     0     0 32304.1123    0  522 2547.12264 32304.1123  1168%     - 1319s
     0     0 32302.6319    0  532 2547.12264 32302.6319  1168%     - 1322s
     0     0 31575.3145    0  461 2547.12264 31575.3145  1140%     - 1418s
H    0     0                    2870.3906984 31575.2691  1000%     - 1419s
H    0     0                    5433.0328492 31575.2691   481%     - 1420s
H    0     0                    5518.4376549 31575.2691   472%     - 1420s
H    0     0                    5680.7871999 31575.2691   456%     - 1420s
H    0     0                    5868.9742372 31575.2691   438%     - 1420s
H    0     0                    6061.2128461 31575.2691   421%     - 1420s
H    0     0                    6590.6700217 31575.2691   379%     - 1420s
H    0     0                    6682.3818217 31575.2691   373%     - 1420s
H    0     0                    6730.8817120 31575.2691   369%     - 1420s
     0     0 31418.3775    0  437 6730.88171 31418.3775   367%     - 1457s
     0     0 31357.4324    0  438 6730.88171 31357.4324   366%     - 1474s
     0     0 31334.7701    0  451 6730.88171 31334.7701   366%     - 1487s
     0     0 31310.8168    0  445 6730.88171 31310.8168   365%     - 1497s
     0     0 31252.9862    0  450 6730.88171 31252.9862   364%     - 1515s
     0     0 31243.1021    0  446 6730.88171 31243.1021   364%     - 1524s
     0     0 31235.0692    0  453 6730.88171 31235.0692   364%     - 1528s
     0     0 31229.8991    0  443 6730.88171 31229.8991   364%     - 1533s
     0     0 31225.2621    0  436 6730.88171 31225.2621   364%     - 1539s
     0     0 31222.1683    0  442 6730.88171 31222.1683   364%     - 1545s
     0     0 31221.7637    0  442 6730.88171 31221.7637   364%     - 1548s
     0     0 31130.5922    0  458 6730.88171 31130.5922   363%     - 1578s
H    0     0                    6870.1150320 31130.5166   353%     - 1579s
     0     0 31102.9115    0  468 6870.11503 31102.9115   353%     - 1600s
     0     0 31092.9510    0  468 6870.11503 31092.9510   353%     - 1612s
     0     0 31090.1963    0  470 6870.11503 31090.1963   353%     - 1617s
     0     0 31041.2581    0  460 6870.11503 31041.2581   352%     - 1642s
H    0     0                    7331.8972024 31041.1250   323%     - 1645s
H    0     0                    7457.4818440 31041.1250   316%     - 1645s
H    0     0                    7518.7976408 31041.1250   313%     - 1645s
     0     0 31025.0792    0  455 7518.79764 31025.0792   313%     - 1657s
     0     0 31021.0423    0  468 7518.79764 31021.0423   313%     - 1666s
     0     0 31018.6104    0  469 7518.79764 31018.6104   313%     - 1670s
     0     0 31000.6691    0  467 7518.79764 31000.6691   312%     - 1682s
     0     0 30990.1731    0  475 7518.79764 30990.1731   312%     - 1693s
     0     0 30982.4630    0  468 7518.79764 30982.4630   312%     - 1700s
     0     0 30979.4108    0  475 7518.79764 30979.4108   312%     - 1704s
     0     0 30978.1404    0  474 7518.79764 30978.1404   312%     - 1710s
     0     0 30969.9502    0  482 7518.79764 30969.9502   312%     - 1723s
     0     0 30968.6901    0  479 7518.79764 30968.6901   312%     - 1728s
     0     0 30963.6038    0  485 7518.79764 30963.6038   312%     - 1736s
     0     0 30962.8485    0  483 7518.79764 30962.8485   312%     - 1739s
     0     0 30961.3610    0  471 7518.79764 30961.3610   312%     - 1745s
     0     0 30961.3389    0  471 7518.79764 30961.3389   312%     - 1758s
H    0     0                    7529.1661143 30961.1611   311%     - 1884s
H    0     0                    9662.1805592 30961.1611   220%     - 2006s
H    0     0                    13250.607229 30961.1611   134%     - 2008s
H    0     0                    14804.981319 30961.1611   109%     - 2011s
H    0     0                    14922.277687 30961.1611   107%     - 2011s
H    0     0                    15107.090154 30961.1611   105%     - 2014s
H    0     2                    16155.885837 30961.1611  91.6%     - 2094s
     0     2 30961.1611    0  471 16155.8858 30961.1611  91.6%     - 2094s
     1     4 30811.1248    1  449 16155.8858 30961.1611  91.6% 19279 2126s
     3     8 30717.0626    2  455 16155.8858 30810.6684  90.7% 13670 2157s
     7    15 30146.7475    3  480 16155.8858 30716.9561  90.1% 15001 2257s
    14    30 29992.1202    4  354 16155.8858 30716.9561  90.1% 20915 2312s
    29    45 29912.5816    4  457 16155.8858 30371.7144  88.0% 27952 2466s
    44    74 29417.2125    6  455 16155.8858 30371.7144  88.0% 31568 2854s
H   46    74                    16247.258102 30371.7144  86.9% 30584 2854s
H   56    74                    16310.545609 30371.7144  86.2% 29579 2854s
H   58    74                    16347.705450 30371.7144  85.8% 28890 2854s
H   62    74                    17428.531123 30371.7144  74.3% 28091 2854s
    73   162 29305.4164    7  432 17428.5311 30058.8585  72.5% 30477 3023s
   161   194 29176.2065   10  420 17428.5311 30058.8585  72.5% 20925 3071s
H  164   194                    17672.235420 30058.8585  70.1% 20667 3071s
   193   279 28786.8030   11  409 17672.2354 30058.8585  70.1% 19742 3148s
   278   357 28763.1155   12  416 17672.2354 30058.8585  70.1% 16253 3205s
   356   426 28355.4267   14  412 17672.2354 30058.8585  70.1% 14549 3255s
   425   491 28331.2450   15  409 17672.2354 30058.8585  70.1% 13385 3305s
   490   551 28308.8921   16  405 17672.2354 30058.8585  70.1% 12665 3348s
   550   603 27778.7974   17  360 17672.2354 30058.8585  70.1% 12187 3391s
   604   687 27623.5528   18  370 17672.2354 30058.8585  70.1% 11879 3434s
   688   745 27353.2576   21  350 17672.2354 30058.8585  70.1% 11665 3472s
   748   812 28537.5174   15  408 17672.2354 30058.8585  70.1% 11629 3506s
   815   890 24268.6603   36  292 17672.2354 30058.8585  70.1% 11375 3542s
   895   961 24421.6503   34  311 17672.2354 30058.8585  70.1% 11049 3579s
   968  1027 23701.4390   35  298 17672.2354 30058.8585  70.1% 10790 3600s

Cutting planes:
  Gomory: 8
  Implied bound: 358
  MIR: 4840
  Flow cover: 4232
  RLT: 109
  Relax-and-lift: 1022

Explored 1036 nodes (11856858 simplex iterations) in 3600.10 seconds (8624.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17672.2 17428.5 16347.7 ... 13250.6

Time limit reached
Best objective 1.767223542003e+04, best bound 3.005885850192e+04, gap 70.0909%
  WARNING: Time limit reached. Using best solution found (gap: 70.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 17672.24, θ = 165784.47
  Upper Bound (UB) = 17672.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 165784.47
  [DEBUG]   ✓ Scenario 0: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 165784.47 ≤ Q = 165784.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 165784.47 ≤ Q = 165784.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 165784.47 ≤ Q = 165784.47 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x856db48
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0856db48
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.276789e+13
Presolve removed 2565 rows and 1855 columns
Presolve time: 0.00s
Presolved: 528 rows, 534 columns, 1491 nonzeros
Found heuristic solution: objective 6755391.0303
Variable types: 360 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6754630.8311

Root relaxation: objective -1.499390e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149939.05    0  121 6754630.83 -149939.05   102%     -    0s
H    0     0                    -101317.4366 -149939.05  48.0%     -    0s
H    0     0                    -102434.6254 -149939.05  46.4%     -    0s
H    0     0                    -111132.0116 -149939.05  34.9%     -    0s
H    0     0                    -114652.7313 -149939.05  30.8%     -    0s
     0     0 -123645.91    0   73 -114652.73 -123645.91  7.84%     -    0s
H    0     0                    -119906.3175 -123639.75  3.11%     -    0s
H    0     0                    -122068.2762 -123639.75  1.29%     -    0s
     0     0 -123141.97    0   75 -122068.28 -123141.97  0.88%     -    0s
     0     0 -123076.74    0   75 -122068.28 -123076.74  0.83%     -    0s
H    0     0                    -122118.3271 -122861.87  0.61%     -    0s
     0     0 -122861.87    0   51 -122118.33 -122861.87  0.61%     -    0s
     0     0 -122818.57    0   49 -122118.33 -122818.57  0.57%     -    0s
     0     0 -122798.40    0   51 -122118.33 -122798.40  0.56%     -    0s
     0     0 -122595.22    0   48 -122118.33 -122595.22  0.39%     -    0s
     0     0 -122555.12    0   51 -122118.33 -122555.12  0.36%     -    0s
     0     0 -122546.85    0   49 -122118.33 -122546.85  0.35%     -    0s
     0     0 -122500.24    0   49 -122118.33 -122500.24  0.31%     -    0s
     0     0 -122487.91    0   49 -122118.33 -122487.91  0.30%     -    0s
H    0     0                    -122198.1755 -122482.92  0.23%     -    0s
H    0     0                    -122212.8990 -122482.92  0.22%     -    0s
     0     0 -122482.92    0   89 -122212.90 -122482.92  0.22%     -    0s
     0     0 -122482.92    0   47 -122212.90 -122482.92  0.22%     -    0s
     0     0 -122482.92    0   49 -122212.90 -122482.92  0.22%     -    0s
     0     0 -122480.78    0   49 -122212.90 -122480.78  0.22%     -    0s
     0     0 -122475.31    0   48 -122212.90 -122475.31  0.21%     -    0s
     0     0 -122475.24    0   49 -122212.90 -122475.24  0.21%     -    0s
     0     0 -122418.76    0   45 -122212.90 -122418.76  0.17%     -    0s
     0     0 -122411.62    0   46 -122212.90 -122411.62  0.16%     -    0s
     0     0 -122411.45    0   46 -122212.90 -122411.45  0.16%     -    0s
     0     0 -122377.91    0   45 -122212.90 -122377.91  0.14%     -    0s
     0     0 -122375.64    0   45 -122212.90 -122375.64  0.13%     -    0s
     0     2 -122374.94    0   45 -122212.90 -122374.94  0.13%     -    0s
H   75     1                    -122216.0623 -122223.26  0.01%   5.1    0s
*   83     1              17    -122218.6711 -122218.67  0.00%   4.8    0s

Cutting planes:
  Gomory: 18
  Implied bound: 12
  MIR: 80
  Flow cover: 22
  RLT: 3
  Relax-and-lift: 3

Explored 87 nodes (1530 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122219 -122216 -122213 ... -102435
No other solutions better than -122219

Optimal solution found (tolerance 1.00e-06)
Best objective -1.222186710815e+05, best bound -1.222186710815e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 160033.91
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122218.67
  [DEBUG]   S×d_nominal = 282252.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282252.59 + -122218.67 = 160033.91
  [DEBUG]   Current θ from Master = 165784.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5750.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11921.68
  Lower Bound (LB) = 14704.60
  Gap (UB-LB) = 2967.6389, Absolute Gap = 2967.6389, Relative Gap = 0.167927
  Not converged yet (gap = 2967.64 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 957129 nonzeros
Model fingerprint: 0x907fcfaa
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 137764 rows and 55924 columns
Presolve time: 4.09s
Presolved: 199999 rows, 83616 columns, 1228049 nonzeros
Variable types: 81357 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.73s

Barrier statistics:
 Dense cols : 1260
 AA' NZ     : 4.676e+06
 Factor NZ  : 1.373e+07 (roughly 230 MB of memory)
 Factor Ops : 5.147e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.17642809e+07  3.23284362e+08  1.51e+05 1.74e+01  9.79e+04     8s
   1  -1.73467828e+07  2.96557221e+08  1.09e+05 7.07e+01  7.01e+04     8s
   2  -6.59618265e+06  2.36133145e+08  4.10e+04 1.40e+00  2.79e+04     8s
   3  -1.21295281e+06  1.82971512e+08  3.66e+03 2.70e+00  2.89e+03     8s
   4  -6.59189262e+05  1.05207710e+08  7.51e+02 9.14e-01  7.43e+02     8s
   5  -5.42599027e+05  6.45845645e+07  4.01e+02 4.70e-01  4.00e+02     8s
   6  -4.31716638e+05  4.76634509e+07  1.29e+02 3.18e-01  1.99e+02     8s
   7  -3.74703126e+05  3.32082416e+07  6.48e+01 2.07e-01  1.21e+02     8s
   8  -2.50436604e+05  2.29565694e+07  1.00e+01 1.36e-01  6.75e+01     8s
   9  -1.54491647e+05  1.05262382e+07  2.61e+00 5.75e-02  2.99e+01     8s
  10  -1.22663664e+05  7.18709798e+06  1.51e+00 3.84e-02  2.03e+01     8s
  11  -1.08248638e+05  5.46653232e+06  8.87e-01 2.89e-02  1.54e+01     9s
  12  -9.16558977e+04  4.19756763e+06  5.33e-01 2.21e-02  1.18e+01     9s
  13  -7.13603291e+04  1.86825959e+06  2.50e-01 9.40e-03  5.34e+00     9s
  14  -4.37337695e+04  5.41068413e+05  9.84e-02 2.78e-03  1.61e+00     9s
  15  -3.70067622e+04  3.87372905e+05  8.49e-02 2.15e-03  1.17e+00     9s
  16  -7.88527060e+03  2.52622534e+05  4.20e-02 2.38e-03  7.16e-01     9s
  17  -3.29343261e+02  1.87384976e+05  3.45e-02 2.52e-03  5.16e-01     9s
  18   7.24660321e+03  1.47124798e+05  2.85e-02 1.79e-03  3.85e-01     9s
  19   1.65905256e+04  1.16888743e+05  2.11e-02 1.25e-03  2.76e-01     9s
  20   2.10520180e+04  9.88452372e+04  1.77e-02 9.45e-04  2.14e-01     9s
  21   2.39328174e+04  8.69199108e+04  1.56e-02 7.47e-04  1.73e-01     9s
  22   2.66573856e+04  7.94038969e+04  1.37e-02 5.97e-04  1.45e-01     9s
  23   2.86242915e+04  7.31726673e+04  1.23e-02 4.76e-04  1.22e-01    10s
  24   3.33847947e+04  7.08571833e+04  9.04e-03 4.31e-04  1.03e-01    10s
  25   3.44244808e+04  6.71158854e+04  8.36e-03 3.98e-04  8.99e-02    10s
  26   3.64077029e+04  6.32537053e+04  7.06e-03 3.17e-04  7.38e-02    10s
  27   3.77166942e+04  6.20909395e+04  6.24e-03 2.93e-04  6.70e-02    10s
  28   3.81299140e+04  6.03247061e+04  5.98e-03 2.56e-04  6.10e-02    10s
  29   4.03266101e+04  5.98772892e+04  4.66e-03 2.46e-04  5.38e-02    10s
  30   4.09510912e+04  5.73116537e+04  4.30e-03 1.97e-04  4.50e-02    10s
  31   4.18283214e+04  5.61252098e+04  3.81e-03 1.69e-04  3.93e-02    10s
  32   4.27923123e+04  5.44516713e+04  3.27e-03 1.27e-04  3.21e-02    10s
  33   4.35390209e+04  5.42107093e+04  2.87e-03 1.21e-04  2.93e-02    10s
  34   4.46714011e+04  5.28522647e+04  2.28e-03 8.76e-05  2.25e-02    11s
  35   4.50279134e+04  5.19739825e+04  2.09e-03 7.44e-05  1.91e-02    11s
  36   4.61349868e+04  5.15223364e+04  1.52e-03 6.14e-05  1.48e-02    11s
  37   4.64225108e+04  5.09685301e+04  1.37e-03 6.98e-05  1.25e-02    11s
  38   4.68287829e+04  5.06668528e+04  1.16e-03 6.08e-05  1.06e-02    11s
  39   4.73098146e+04  5.03137506e+04  9.17e-04 4.53e-05  8.26e-03    11s
  40   4.76874733e+04  5.01025161e+04  7.26e-04 3.63e-05  6.64e-03    11s
  41   4.81435045e+04  4.99122298e+04  5.09e-04 2.80e-05  4.86e-03    11s
  42   4.83626510e+04  4.97447963e+04  4.01e-04 2.14e-05  3.80e-03    11s
  43   4.85613633e+04  4.97062206e+04  3.08e-04 1.98e-05  3.15e-03    11s
  44   4.87583629e+04  4.94828900e+04  2.11e-04 1.03e-05  1.99e-03    11s
  45   4.88097740e+04  4.94116225e+04  1.87e-04 8.47e-06  1.65e-03    12s
  46   4.89161489e+04  4.93868151e+04  1.39e-04 7.77e-06  1.29e-03    12s
  47   4.89471293e+04  4.93136706e+04  1.24e-04 4.14e-06  1.01e-03    12s
  48   4.90946745e+04  4.92817978e+04  5.51e-05 3.14e-06  5.15e-04    12s
  49   4.91489307e+04  4.92735482e+04  3.03e-05 2.79e-06  3.43e-04    12s
  50   4.91743071e+04  4.92315045e+04  1.91e-05 5.62e-07  1.57e-04    12s
  51   4.91946920e+04  4.92275611e+04  1.04e-05 3.40e-07  9.04e-05    12s
  52   4.91949534e+04  4.92247015e+04  1.03e-05 2.04e-07  8.18e-05    12s
  53   4.92074389e+04  4.92229044e+04  5.11e-06 1.12e-07  4.25e-05    12s
  54   4.92154070e+04  4.92212582e+04  1.93e-06 3.35e-08  1.61e-05    12s
  55   4.92197610e+04  4.92206536e+04  2.55e-07 5.63e-09  2.46e-06    12s
  56   4.92204976e+04  4.92205144e+04  1.28e-08 3.88e-08  4.64e-08    13s
  57   4.92205103e+04  4.92205111e+04  2.56e-08 5.60e-08  2.10e-09    13s
  58   4.92205110e+04  4.92205111e+04  1.21e-07 1.17e-09  1.23e-10    13s

Barrier solved model in 58 iterations and 12.73 seconds (21.43 work units)
Optimal objective 4.92205110e+04


Root crossover log...

  171192 DPushes remaining with DInf 0.0000000e+00                13s
   65438 DPushes remaining with DInf 0.0000000e+00                15s
    8575 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

    5081 PPushes remaining with PInf 2.9684462e-05                23s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3800624e+00     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80650    4.9220511e+04   0.000000e+00   1.380062e+00     24s
   80652    4.9220511e+04   0.000000e+00   0.000000e+00     24s
   80652    4.9220511e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 7.66s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.922051e+04, 80652 iterations, 26.81 seconds (48.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49220.5111    0  275 -233202.98 49220.5111   121%     -   32s
H    0     0                    -172787.2674 49220.5111   128%     -   34s
H    0     0                    -147438.2208 49220.5111   133%     -   34s
H    0     0                    -145100.4301 49220.5111   134%     -   35s
H    0     0                    -144006.9753 49220.5111   134%     -   35s
H    0     0                    -143480.8406 49220.5111   134%     -   35s
H    0     0                    -141632.5690 49220.5111   135%     -   35s
H    0     0                    -141154.0461 49220.5111   135%     -   35s
H    0     0                    -141030.6206 49220.5111   135%     -   35s
H    0     0                    -140838.9288 49220.5111   135%     -   36s
H    0     0                    -82241.93171 49220.5111   160%     -   36s
H    0     0                    -15751.97101 49220.5111   412%     -   36s
H    0     0                    -11149.04353 49220.5111   541%     -   36s
H    0     0                    -3744.833708 49220.5111  1414%     -   36s
     0     0 41697.2851    0  307 -3744.8337 41697.2851  1213%     -  161s
H    0     0                    -2271.061004 41697.2718  1936%     -  163s
H    0     0                    -1888.331550 41697.2718  2308%     -  163s
H    0     0                    -1385.797350 41697.2718  3109%     -  163s
H    0     0                    -1178.679857 41697.2718  3638%     -  163s
H    0     0                    -1146.170161 41697.2718  3738%     -  163s
     0     0 41170.4417    0  313 -1146.1702 41170.4417  3692%     -  211s
     0     0 40737.1274    0  305 -1146.1702 40737.1274  3654%     -  241s
     0     0 40607.9542    0  319 -1146.1702 40607.9542  3643%     -  264s
     0     0 40577.4700    0  315 -1146.1702 40577.4700  3640%     -  272s
     0     0 40559.6411    0  316 -1146.1702 40559.6411  3639%     -  284s
     0     0 40524.7147    0  328 -1146.1702 40524.7147  3636%     -  300s
     0     0 40523.5042    0  327 -1146.1702 40523.5042  3636%     -  302s
     0     0 40405.5544    0  329 -1146.1702 40405.5544  3625%     -  326s
     0     0 40404.6319    0  336 -1146.1702 40404.6319  3625%     -  330s
     0     0 40403.7109    0  334 -1146.1702 40403.7109  3625%     -  333s
     0     0 40403.7049    0  334 -1146.1702 40403.7049  3625%     -  334s
     0     0 37001.2559    0  393 -1146.1702 37001.2559  3328%     -  441s
H    0     0                    5300.1798507 37000.8806   598%     -  442s
H    0     0                    7263.2852647 37000.8806   409%     -  443s
H    0     0                    7839.6110446 37000.8806   372%     -  443s
H    0     0                    8098.8261945 37000.8806   357%     -  443s
H    0     0                    8275.6057445 37000.8806   347%     -  443s
     0     0 36566.6007    0  396 8275.60574 36566.6007   342%     -  527s
     0     0 36410.3393    0  418 8275.60574 36410.3393   340%     -  570s
     0     0 36230.9334    0  427 8275.60574 36230.9334   338%     -  619s
     0     0 36145.3488    0  434 8275.60574 36145.3488   337%     -  641s
     0     0 36005.7357    0  431 8275.60574 36005.7357   335%     -  671s
     0     0 35974.1159    0  429 8275.60574 35974.1159   335%     -  688s
     0     0 35636.5645    0  429 8275.60574 35636.5645   331%     -  730s
     0     0 35601.4692    0  444 8275.60574 35601.4692   330%     -  746s
     0     0 35528.5174    0  431 8275.60574 35528.5174   329%     -  775s
     0     0 35510.0544    0  450 8275.60574 35510.0544   329%     -  790s
     0     0 35508.3913    0  453 8275.60574 35508.3913   329%     -  794s
     0     0 35506.4874    0  450 8275.60574 35506.4874   329%     -  797s
     0     0 35503.9518    0  450 8275.60574 35503.9518   329%     -  800s
     0     0 35488.7020    0  453 8275.60574 35488.7020   329%     -  807s
     0     0 35488.3251    0  460 8275.60574 35488.3251   329%     -  809s
     0     0 33603.0417    0  403 8275.60574 33603.0417   306%     -  963s
     0     0 33185.3354    0  439 8275.60574 33185.3354   301%     - 1026s
     0     0 33074.0270    0  426 8275.60574 33074.0270   300%     - 1055s
     0     0 32970.5338    0  430 8275.60574 32970.5338   298%     - 1086s
     0     0 32954.8929    0  425 8275.60574 32954.8929   298%     - 1101s
     0     0 32940.1606    0  434 8275.60574 32940.1606   298%     - 1111s
     0     0 32934.8793    0  435 8275.60574 32934.8793   298%     - 1120s
     0     0 32897.6578    0  430 8275.60574 32897.6578   298%     - 1137s
     0     0 32875.5209    0  430 8275.60574 32875.5209   297%     - 1153s
     0     0 32822.9169    0  440 8275.60574 32822.9169   297%     - 1177s
     0     0 32795.8313    0  439 8275.60574 32795.8313   296%     - 1193s
     0     0 32788.3718    0  441 8275.60574 32788.3718   296%     - 1201s
     0     0 32783.0327    0  433 8275.60574 32783.0327   296%     - 1205s
     0     0 32772.7159    0  439 8275.60574 32772.7159   296%     - 1215s
     0     0 32748.5049    0  441 8275.60574 32748.5049   296%     - 1229s
     0     0 32743.6842    0  453 8275.60574 32743.6842   296%     - 1236s
     0     0 32741.5045    0  447 8275.60574 32741.5045   296%     - 1242s
     0     0 31881.0711    0  424 8275.60574 31881.0711   285%     - 1330s
H    0     0                    8740.8957997 31880.9476   265%     - 1333s
H    0     0                    8815.1016224 31880.9476   262%     - 1333s
     0     0 31622.4494    0  445 8815.10162 31622.4494   259%     - 1386s
     0     0 31500.8612    0  474 8815.10162 31500.8612   257%     - 1428s
     0     0 31467.6902    0  432 8815.10162 31467.6902   257%     - 1448s
     0     0 31442.4791    0  441 8815.10162 31442.4791   257%     - 1462s
     0     0 31415.0968    0  440 8815.10162 31415.0968   256%     - 1478s
     0     0 31397.2624    0  510 8815.10162 31397.2624   256%     - 1495s
     0     0 31379.7613    0  517 8815.10162 31379.7613   256%     - 1505s
     0     0 31310.5062    0  498 8815.10162 31310.5062   255%     - 1525s
     0     0 31290.5766    0  491 8815.10162 31290.5766   255%     - 1540s
     0     0 31283.3500    0  504 8815.10162 31283.3500   255%     - 1548s
     0     0 31270.3387    0  498 8815.10162 31270.3387   255%     - 1557s
     0     0 31266.0912    0  495 8815.10162 31266.0912   255%     - 1565s
     0     0 31257.9719    0  498 8815.10162 31257.9719   255%     - 1569s
     0     0 31255.8584    0  501 8815.10162 31255.8584   255%     - 1572s
     0     0 31138.5162    0  435 8815.10162 31138.5162   253%     - 1609s
H    0     0                    9092.0625431 31138.4081   242%     - 1610s
     0     0 31108.5962    0  450 9092.06254 31108.5962   242%     - 1625s
     0     0 31082.5004    0  448 9092.06254 31082.5004   242%     - 1636s
     0     0 31067.2543    0  449 9092.06254 31067.2543   242%     - 1643s
     0     0 31045.1028    0  442 9092.06254 31045.1028   241%     - 1654s
     0     0 31041.3057    0  444 9092.06254 31041.3057   241%     - 1659s
     0     0 31040.8772    0  439 9092.06254 31040.8772   241%     - 1660s
     0     0 30982.7500    0  509 9092.06254 30982.7500   241%     - 1682s
H    0     0                    9321.9635768 30982.5659   232%     - 1685s
H    0     0                    9354.0914581 30982.5659   231%     - 1686s
     0     0 30973.6463    0  468 9354.09146 30973.6463   231%     - 1696s
     0     0 30968.2815    0  459 9354.09146 30968.2815   231%     - 1704s
     0     0 30964.9883    0  465 9354.09146 30964.9883   231%     - 1708s
     0     0 30963.5426    0  460 9354.09146 30963.5426   231%     - 1710s
     0     0 30932.7839    0  465 9354.09146 30932.7839   231%     - 1730s
     0     0 30921.6440    0  465 9354.09146 30921.6440   231%     - 1744s
     0     0 30920.7340    0  453 9354.09146 30920.7340   231%     - 1748s
     0     0 30906.6431    0  460 9354.09146 30906.6431   230%     - 1769s
     0     0 30904.5622    0  463 9354.09146 30904.5622   230%     - 1776s
     0     0 30897.1796    0  470 9354.09146 30897.1796   230%     - 1787s
     0     0 30892.9431    0  478 9354.09146 30892.9431   230%     - 1794s
     0     0 30890.9316    0  468 9354.09146 30890.9316   230%     - 1800s
     0     0 30888.3249    0  463 9354.09146 30888.3249   230%     - 1807s
     0     0 30888.1208    0  463 9354.09146 30888.1208   230%     - 1821s
H    0     0                    10937.748409 30888.1208   182%     - 2129s
H    0     0                    12631.184165 30888.1208   145%     - 2132s
H    0     0                    13041.907553 30888.1208   137%     - 2132s
H    0     0                    13187.966108 30888.1208   134%     - 2137s
H    0     0                    13496.901451 30888.1208   129%     - 2137s
H    0     0                    13497.845504 30888.1208   129%     - 2137s
H    0     0                    13569.012721 30888.1208   128%     - 2137s
H    0     0                    13737.641565 30888.1208   125%     - 2138s
H    0     2                    16720.153950 30888.1208  84.7%     - 2256s
     0     2 30888.1208    0  463 16720.1540 30888.1208  84.7%     - 2256s
     1     4 30836.1984    1  438 16720.1540 30888.1208  84.7% 11729 2276s
     3     8 30749.5616    2  439 16720.1540 30833.7193  84.4% 11599 2364s
     7    16 30329.8505    3  433 16720.1540 30747.4286  83.9% 20692 2505s
    15    32 29909.9890    4  434 16720.1540 30329.7454  81.4% 29253 2560s
    31    48 29438.4310    5  410 16720.1540 30074.4659  79.9% 32728 2685s
H   47    76                    16749.580672 30074.4659  79.6% 34423 2782s
H   49    76                    16771.513522 30074.4659  79.3% 34077 2782s
H   54    76                    16781.003417 30074.4659  79.2% 33373 2782s
H   55    76                    16822.251591 30074.4659  78.8% 33225 2782s
H   59    76                    16860.920395 30074.4659  78.4% 32348 2782s
H   61    76                    16862.618772 30074.4659  78.3% 31765 2782s
H   69    76                    16892.567499 30074.4659  78.0% 29801 2782s
    75   193 28523.6041    7  334 16892.5675 30074.4659  78.0% 28970 2868s
   192   267 28229.4021   10  314 16892.5675 30074.4659  78.0% 16666 2928s
H  216   267                    16915.944250 30074.4659  77.8% 15576 2928s
   266   311 28190.3009   13  294 16915.9442 30074.4659  77.8% 14412 2967s
   310   339 27942.3553   14  293 16915.9442 30074.4659  77.8% 13643 3002s
H  314   339                    16932.292417 30074.4659  77.6% 13570 3002s
H  316   339                    16963.122436 30074.4659  77.3% 13536 3002s
   338   381 27913.8519   15  282 16963.1224 30074.4659  77.3% 13434 3043s
H  380   433                    17038.401419 30074.4659  76.5% 12874 3093s
   432   491 26429.7625   10  364 17038.4014 30074.4659  76.5% 12488 3132s
   494   551 27634.9231   20  326 17038.4014 30074.4659  76.5% 12283 3163s
   554   636 27241.1865   22  321 17038.4014 30074.4659  76.5% 11883 3195s
   639   663 26791.9035   26  236 17038.4014 30074.4659  76.5% 11448 3264s
   670   692 26759.7028   27  241 17038.4014 30074.4659  76.5% 11386 3348s
   699   722 26419.6786   28  247 17038.4014 30074.4659  76.5% 11331 3449s
   733   749 26310.7899   29  236 17038.4014 30074.4659  76.5% 11344 3477s
   762   779 26259.3358   30  234 17038.4014 30074.4659  76.5% 11317 3507s
   794   809 26199.3587   31  296 17038.4014 30074.4659  76.5% 11279 3534s
   826   843 26074.7199   32  296 17038.4014 30074.4659  76.5% 11227 3561s
   860   878 26014.9104   33  288 17038.4014 30074.4659  76.5% 11068 3590s
   895   898 24463.2460   34  366 17038.4014 30074.4659  76.5% 10944 3600s

Cutting planes:
  Learned: 2
  Gomory: 8
  Implied bound: 324
  MIR: 4545
  Flow cover: 4282
  RLT: 121
  Relax-and-lift: 753

Explored 917 nodes (10967746 simplex iterations) in 3600.10 seconds (8727.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17038.4 16963.1 16932.3 ... 16771.5

Time limit reached
Best objective 1.703840141901e+04, best bound 3.007446588319e+04, gap 76.5099%
  WARNING: Time limit reached. Using best solution found (gap: 76.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 17038.40, θ = 169564.92
  Upper Bound (UB) = 17038.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169564.92
  [DEBUG]   ✓ Scenario 0: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169564.92 ≤ Q = 169564.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169564.92 ≤ Q = 169564.92 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2c6e8537
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd3917ac9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6862195.4313
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.394055e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139405.49    0  122 6862195.43 -139405.49   102%     -    0s
H    0     0                    -102786.8115 -139405.49  35.6%     -    0s
H    0     0                    -104297.9857 -139405.49  33.7%     -    0s
     0     0 -110212.56    0  131 -104297.99 -110212.56  5.67%     -    0s
H    0     0                    -107372.9195 -110206.09  2.64%     -    0s
H    0     0                    -107446.6434 -110206.09  2.57%     -    0s
     0     0 -109305.81    0  126 -107446.64 -109305.81  1.73%     -    0s
H    0     0                    -107959.3972 -109301.78  1.24%     -    0s
     0     0 -109300.18    0   99 -107959.40 -109300.18  1.24%     -    0s
     0     0 -108643.02    0  101 -107959.40 -108643.02  0.63%     -    0s
     0     0 -108640.04    0  126 -107959.40 -108640.04  0.63%     -    0s
     0     0 -108487.89    0   90 -107959.40 -108487.89  0.49%     -    0s
     0     0 -108484.15    0   90 -107959.40 -108484.15  0.49%     -    0s
     0     0 -108427.13    0   87 -107959.40 -108427.13  0.43%     -    0s
     0     0 -108424.07    0   87 -107959.40 -108424.07  0.43%     -    0s
H    0     0                    -108062.7708 -108424.07  0.33%     -    0s
     0     2 -108424.07    0   87 -108062.77 -108424.07  0.33%     -    0s
H   36    21                    -108082.7157 -108297.06  0.20%  12.6    0s
H   38    20                    -108087.2183 -108297.06  0.19%  12.6    0s
H   56    17                    -108222.2000 -108252.72  0.03%  11.7    0s

Cutting planes:
  Gomory: 17
  Implied bound: 1
  MIR: 182
  Flow cover: 7
  RLT: 3
  BQP: 1

Explored 96 nodes (1439 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -108222 -108087 -108083 ... 6.8622e+06
No other solutions better than -108222

Optimal solution found (tolerance 1.00e-06)
Best objective -1.082222000497e+05, best bound -1.082222000497e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 168317.17
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108222.20
  [DEBUG]   S×d_nominal = 276539.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276539.37 + -108222.20 = 168317.17
  [DEBUG]   Current θ from Master = 169564.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1247.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15790.65
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 1247.7500, Absolute Gap = 1247.7500, Relative Gap = 0.073232
  Not converged yet (gap = 1247.75 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000384 nonzeros
Model fingerprint: 0xcc63f3fc
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 144026 rows and 58466 columns
Presolve time: 4.58s
Presolved: 209027 rows, 87314 columns, 1283467 nonzeros
Variable types: 85055 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.05s

Barrier statistics:
 Dense cols : 1259
 AA' NZ     : 5.025e+06
 Factor NZ  : 1.474e+07 (roughly 240 MB of memory)
 Factor Ops : 5.667e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.25890849e+07  3.35167785e+08  1.56e+05 1.72e+01  1.01e+05     9s
   1  -1.80647041e+07  3.09154000e+08  1.14e+05 7.03e+01  7.27e+04     9s
   2  -7.00728167e+06  2.46278413e+08  4.36e+04 1.90e+00  2.95e+04     9s
   3  -1.33706258e+06  1.95365353e+08  4.03e+03 3.14e+00  3.13e+03     9s
   4  -7.24952066e+05  1.10460510e+08  7.96e+02 9.02e-01  7.70e+02     9s
   5  -5.90256531e+05  6.85218681e+07  4.29e+02 4.79e-01  4.19e+02     9s
   6  -4.50650699e+05  5.23609071e+07  1.32e+02 3.37e-01  2.08e+02     9s
   7  -3.93344863e+05  3.64997877e+07  6.39e+01 2.17e-01  1.26e+02     9s
   8  -2.74769029e+05  2.88125100e+07  9.78e+00 1.66e-01  8.04e+01     9s
   9  -1.99648711e+05  1.27415351e+07  3.09e+00 6.90e-02  3.47e+01     9s
  10  -1.43701378e+05  7.63901953e+06  1.60e+00 4.14e-02  2.07e+01    10s
  11  -1.19136847e+05  6.14949909e+06  1.09e+00 3.31e-02  1.66e+01    10s
  12  -1.03905164e+05  4.46398503e+06  7.12e-01 2.37e-02  1.21e+01    10s
  13  -7.72837028e+04  3.01912683e+06  3.12e-01 1.56e-02  8.16e+00    10s
  14  -4.87497960e+04  1.04553403e+06  1.01e-01 4.78e-03  2.88e+00    10s
  15  -3.58615437e+04  4.91714669e+05  6.43e-02 2.47e-03  1.39e+00    10s
  16  -1.79637799e+04  3.10259537e+05  3.73e-02 1.80e-03  8.64e-01    10s
  17  -1.02125406e+03  2.09593429e+05  2.31e-02 1.71e-03  5.54e-01    10s
  18   6.67027348e+03  1.54391440e+05  1.85e-02 1.15e-03  3.89e-01    10s
  19   1.24081873e+04  1.29607537e+05  1.54e-02 9.11e-04  3.08e-01    10s
  20   1.60459605e+04  1.09173925e+05  1.36e-02 7.32e-04  2.45e-01    10s
  21   2.08129444e+04  9.90882181e+04  1.14e-02 6.08e-04  2.06e-01    10s
  22   2.20949061e+04  8.86107375e+04  1.08e-02 5.48e-04  1.75e-01    10s
  23   2.36436189e+04  8.07550087e+04  1.01e-02 4.23e-04  1.50e-01    11s
  24   2.68386815e+04  7.73250108e+04  8.70e-03 3.78e-04  1.33e-01    11s
  25   2.92120079e+04  7.11586718e+04  7.67e-03 3.21e-04  1.10e-01    11s
  26   3.09716903e+04  6.91311747e+04  6.91e-03 2.95e-04  1.00e-01    11s
  27   3.26603324e+04  6.66216582e+04  6.18e-03 3.41e-04  8.94e-02    11s
  28   3.51116757e+04  6.41080857e+04  5.15e-03 2.93e-04  7.63e-02    11s
  29   3.61779736e+04  6.15578371e+04  4.72e-03 2.38e-04  6.68e-02    11s
  30   3.78238762e+04  5.97771553e+04  4.05e-03 2.04e-04  5.78e-02    11s
  31   3.87305955e+04  5.85979823e+04  3.69e-03 1.84e-04  5.23e-02    11s
  32   3.97542984e+04  5.73105228e+04  3.30e-03 1.59e-04  4.62e-02    11s
  33   4.08169386e+04  5.57654246e+04  2.91e-03 1.28e-04  3.93e-02    12s
  34   4.22346255e+04  5.46518597e+04  2.39e-03 1.22e-04  3.27e-02    12s
  35   4.30894946e+04  5.33078908e+04  2.08e-03 9.16e-05  2.69e-02    12s
  36   4.36761137e+04  5.25165660e+04  1.87e-03 7.37e-05  2.33e-02    12s
  37   4.43391073e+04  5.16989111e+04  1.63e-03 5.42e-05  1.94e-02    12s
  38   4.50373661e+04  5.12211356e+04  1.39e-03 4.37e-05  1.63e-02    12s
  39   4.54493742e+04  5.08684700e+04  1.25e-03 3.63e-05  1.43e-02    12s
  40   4.56626346e+04  5.07202722e+04  1.18e-03 3.29e-05  1.33e-02    12s
  41   4.63181709e+04  5.04255587e+04  9.58e-04 2.62e-05  1.08e-02    12s
  42   4.69884157e+04  5.03478394e+04  7.36e-04 2.44e-05  8.84e-03    13s
  43   4.74322798e+04  5.00548749e+04  5.84e-04 1.82e-05  6.90e-03    13s
  44   4.78810595e+04  4.99199206e+04  4.32e-04 1.51e-05  5.36e-03    13s
  45   4.79726943e+04  4.97137827e+04  4.01e-04 1.08e-05  4.58e-03    13s
  46   4.81992212e+04  4.96218726e+04  3.25e-04 1.10e-05  3.74e-03    13s
  47   4.85464757e+04  4.94836773e+04  2.11e-04 9.81e-06  2.47e-03    13s
  48   4.86919925e+04  4.94251489e+04  1.63e-04 7.69e-06  1.93e-03    13s
  49   4.89019490e+04  4.93781041e+04  9.56e-05 5.83e-06  1.25e-03    13s
  50   4.89817688e+04  4.93514684e+04  6.93e-05 4.82e-06  9.73e-04    13s
  51   4.90823618e+04  4.92955403e+04  3.89e-05 2.57e-06  5.61e-04    13s
  52   4.91306783e+04  4.92709910e+04  2.43e-05 1.74e-06  3.69e-04    14s
  53   4.91766151e+04  4.92440682e+04  1.14e-05 7.78e-07  1.77e-04    14s
  54   4.91976359e+04  4.92309278e+04  5.71e-06 3.92e-07  8.76e-05    14s
  55   4.91981758e+04  4.92280558e+04  5.57e-06 2.82e-07  7.86e-05    14s
  56   4.92022186e+04  4.92251533e+04  4.52e-06 1.69e-07  6.04e-05    14s
  57   4.92107938e+04  4.92220833e+04  2.36e-06 5.02e-08  2.97e-05    14s
  58   4.92197837e+04  4.92209727e+04  2.12e-07 4.02e-07  3.13e-06    14s
  59   4.92204988e+04  4.92205158e+04  7.95e-09 3.05e-08  4.49e-08    14s
  60   4.92205110e+04  4.92205111e+04  2.28e-09 1.04e-08  2.56e-10    14s

Barrier solved model in 60 iterations and 14.22 seconds (23.36 work units)
Optimal objective 4.92205110e+04


Root crossover log...

  178732 DPushes remaining with DInf 0.0000000e+00                14s
   99053 DPushes remaining with DInf 0.0000000e+00                16s
   37211 DPushes remaining with DInf 0.0000000e+00                20s
    4346 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

    8499 PPushes remaining with PInf 7.0121911e-05                28s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6685096e+02     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   91035    4.9220511e+04   0.000000e+00   2.668510e+02     29s
   91172    4.9220511e+04   0.000000e+00   0.000000e+00     29s
   91172    4.9220511e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 5.59s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.922051e+04, 91172 iterations, 28.80 seconds (58.67 work units)
Total elapsed time = 35.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49220.5111    0  275 -233202.98 49220.5111   121%     -   35s
H    0     0                    -152060.6586 49220.5111   132%     -   37s
H    0     0                    -130621.5720 49220.5111   138%     -   37s
H    0     0                    -130499.2133 49220.5111   138%     -   37s
H    0     0                    -130227.7989 49220.5111   138%     -   37s
H    0     0                    -129864.2396 49220.5111   138%     -   37s
H    0     0                    -129855.3983 49220.5111   138%     -   37s
H    0     0                    -129810.8605 49220.5111   138%     -   37s
H    0     0                    -82241.93171 49220.5111   160%     -   37s
H    0     0                    -15751.97101 49220.5111   412%     -   38s
H    0     0                    -11149.04353 49220.5111   541%     -   38s
H    0     0                    -3744.833708 49220.5111  1414%     -   38s
     0     0 42261.8203    0  305 -3744.8337 42261.8203  1229%     -  136s
H    0     0                    -1337.384964 42261.4240  3260%     -  138s
H    0     0                    -1158.039823 42261.4240  3749%     -  138s
     0     0 41616.1019    0  288 -1158.0398 41616.1019  3694%     -  170s
     0     0 41149.9472    0  293 -1158.0398 41149.9472  3653%     -  211s
     0     0 41127.9411    0  310 -1158.0398 41127.9411  3652%     -  223s
     0     0 41034.4028    0  297 -1158.0398 41034.4028  3643%     -  241s
     0     0 41010.3516    0  309 -1158.0398 41010.3516  3641%     -  251s
     0     0 40991.1990    0  311 -1158.0398 40991.1990  3640%     -  257s
     0     0 40991.1389    0  311 -1158.0398 40991.1389  3640%     -  258s
     0     0 37980.7760    0  404 -1158.0398 37980.7760  3380%     -  409s
H    0     0                    -385.2281734 37973.9178  9958%     -  411s
H    0     0                    1652.2885144 37973.9178  2198%     -  411s
H    0     0                    1881.3132400 37973.9178  1918%     -  411s
H    0     0                    1896.2654083 37973.9178  1903%     -  411s
     0     0 37267.6228    0  382 1896.26541 37267.6228  1865%     -  476s
     0     0 36731.5561    0  418 1896.26541 36731.5561  1837%     -  534s
     0     0 36626.6352    0  429 1896.26541 36626.6352  1832%     -  569s
     0     0 36583.5758    0  422 1896.26541 36583.5758  1829%     -  594s
     0     0 36543.1344    0  416 1896.26541 36543.1344  1827%     -  613s
     0     0 36434.6614    0  421 1896.26541 36434.6614  1821%     -  643s
     0     0 36314.2329    0  429 1896.26541 36314.2329  1815%     -  678s
     0     0 36294.2926    0  435 1896.26541 36294.2926  1814%     -  692s
     0     0 36291.0363    0  432 1896.26541 36291.0363  1814%     -  696s
     0     0 36289.0274    0  431 1896.26541 36289.0274  1814%     -  699s
     0     0 36241.2387    0  433 1896.26541 36241.2387  1811%     -  715s
     0     0 36187.3077    0  439 1896.26541 36187.3077  1808%     -  730s
     0     0 36175.8766    0  441 1896.26541 36175.8766  1808%     -  737s
     0     0 36174.9492    0  445 1896.26541 36174.9492  1808%     -  740s
     0     0 33705.2558    0  462 1896.26541 33705.2558  1677%     -  913s
H    0     0                    1937.5984437 33705.1132  1640%     -  914s
     0     0 33296.7221    0  453 1937.59844 33296.7221  1618%     -  981s
     0     0 33141.8336    0  451 1937.59844 33141.8336  1610%     - 1038s
     0     0 33035.2212    0  439 1937.59844 33035.2212  1605%     - 1087s
     0     0 32947.7188    0  442 1937.59844 32947.7188  1600%     - 1131s
     0     0 32933.1855    0  486 1937.59844 32933.1855  1600%     - 1152s
     0     0 32853.8697    0  485 1937.59844 32853.8697  1596%     - 1178s
     0     0 32844.5860    0  487 1937.59844 32844.5860  1595%     - 1188s
     0     0 32842.4858    0  486 1937.59844 32842.4858  1595%     - 1195s
     0     0 32123.1247    0  408 1937.59844 32123.1247  1558%     - 1301s
H    0     0                    2268.2161315 32122.9674  1316%     - 1302s
H    0     0                    2411.5152423 32122.9674  1232%     - 1303s
H    0     0                    2491.4154471 32122.9674  1189%     - 1303s
H    0     0                    3708.5429602 32122.9674   766%     - 1303s
H    0     0                    3944.4816731 32122.9674   714%     - 1303s
H    0     0                    3965.4940045 32122.9674   710%     - 1303s
H    0     0                    5164.1019096 32122.9674   522%     - 1303s
H    0     0                    5501.2953299 32122.9674   484%     - 1303s
H    0     0                    5678.0748800 32122.9674   466%     - 1303s
     0     0 31804.2776    0  422 5678.07488 31804.2776   460%     - 1362s
     0     0 31747.8953    0  421 5678.07488 31747.8953   459%     - 1386s
     0     0 31711.5920    0  422 5678.07488 31711.5920   458%     - 1404s
     0     0 31643.7363    0  428 5678.07488 31643.7363   457%     - 1432s
     0     0 31590.7154    0  435 5678.07488 31590.7154   456%     - 1455s
     0     0 31548.0311    0  445 5678.07488 31548.0311   456%     - 1479s
     0     0 31515.8194    0  455 5678.07488 31515.8194   455%     - 1496s
     0     0 31503.2167    0  460 5678.07488 31503.2167   455%     - 1506s
     0     0 31486.8320    0  450 5678.07488 31486.8320   455%     - 1518s
     0     0 31473.1977    0  453 5678.07488 31473.1977   454%     - 1527s
     0     0 31432.6447    0  455 5678.07488 31432.6447   454%     - 1541s
     0     0 31423.2841    0  444 5678.07488 31423.2841   453%     - 1551s
     0     0 31421.1522    0  442 5678.07488 31421.1522   453%     - 1557s
     0     0 31269.0160    0  424 5678.07488 31269.0160   451%     - 1603s
H    0     0                    5687.0831828 31268.4396   450%     - 1605s
     0     0 31210.8585    0  438 5687.08318 31210.8585   449%     - 1636s
     0     0 31189.6079    0  439 5687.08318 31189.6079   448%     - 1651s
     0     0 31167.1176    0  436 5687.08318 31167.1176   448%     - 1672s
     0     0 31160.8222    0  443 5687.08318 31160.8222   448%     - 1678s
     0     0 31156.9035    0  439 5687.08318 31156.9035   448%     - 1684s
     0     0 31154.6229    0  450 5687.08318 31154.6229   448%     - 1688s
     0     0 31058.6676    0  461 5687.08318 31058.6676   446%     - 1730s
H    0     0                    6463.7630827 31058.4953   381%     - 1732s
H    0     0                    6603.3273794 31058.4953   370%     - 1733s
H    0     0                    6746.6703028 31058.4953   360%     - 1733s
     0     0 31033.9028    0  454 6746.67030 31033.9028   360%     - 1749s
     0     0 31027.5134    0  461 6746.67030 31027.5134   360%     - 1757s
     0     0 31025.2828    0  464 6746.67030 31025.2828   360%     - 1762s
     0     0 30985.7078    0  449 6746.67030 30985.7078   359%     - 1787s
     0     0 30967.4466    0  472 6746.67030 30967.4466   359%     - 1803s
     0     0 30962.3275    0  470 6746.67030 30962.3275   359%     - 1811s
     0     0 30959.0854    0  459 6746.67030 30959.0854   359%     - 1822s
     0     0 30957.9655    0  460 6746.67030 30957.9655   359%     - 1826s
     0     0 30936.8052    0  455 6746.67030 30936.8052   359%     - 1851s
H    0     0                    6860.3010703 30936.7893   351%     - 1853s
     0     0 30928.8496    0  519 6860.30107 30928.8496   351%     - 1870s
     0     0 30926.7593    0  469 6860.30107 30926.7593   351%     - 1875s
     0     0 30917.8836    0  493 6860.30107 30917.8836   351%     - 1895s
H    0     0                    8125.8171651 30917.8562   280%     - 1897s
H    0     0                    8162.0081358 30917.8562   279%     - 1897s
H    0     0                    8626.5940727 30917.8562   258%     - 1897s
H    0     0                    8776.2908579 30917.8562   252%     - 1897s
H    0     0                    8799.6186301 30917.8562   251%     - 1897s
H    0     0                    8917.5580243 30917.8562   247%     - 1897s
     0     0 30911.5519    0  474 8917.55802 30911.5519   247%     - 1912s
     0     0 30909.7885    0  489 8917.55802 30909.7885   247%     - 1918s
     0     0 30897.3828    0  534 8917.55802 30897.3828   246%     - 1944s
     0     0 30897.3407    0  534 8917.55802 30897.3407   246%     - 1957s
H    0     0                    9138.7329360 30897.3407   238%     - 2122s
H    0     0                    9141.0307388 30897.3407   238%     - 2122s
H    0     0                    10103.005189 30897.3407   206%     - 2320s
H    0     0                    15661.178902 30897.3407  97.3%     - 2324s
H    0     0                    15868.057382 30897.3407  94.7%     - 2324s
H    0     0                    16045.810364 30897.3407  92.6%     - 2329s
H    0     0                    16161.330622 30897.3407  91.2%     - 2329s
H    0     2                    16350.580488 30897.3407  89.0%     - 2391s
     0     2 30897.3407    0  534 16350.5805 30897.3407  89.0%     - 2391s
     1     4 30834.3833    1  515 16350.5805 30897.1359  89.0% 11878 2450s
     3     8 30767.0133    2  513 16350.5805 30834.3208  88.6% 16706 2500s
     7    15 30641.4877    3  510 16350.5805 30766.9056  88.2% 19237 2603s
    14    30 30293.1204    4  503 16350.5805 30640.3674  87.4% 23129 2669s
    29    45 28463.3829    5  387 16350.5805 30293.0330  85.3% 31763 3007s
H   44    75                    16646.511606 30293.0330  82.0% 35329 3349s
H   45    75                    17094.236792 30293.0330  77.2% 35174 3349s
    74   144 29070.8320    7  420 17094.2368 30139.1580  76.3% 33982 3541s
   143   230 28802.3965    9  401 17094.2368 29991.8898  75.5% 25421 3600s
H  153   230                    17172.716090 29991.8898  74.6% 24283 3600s
H  158   230                    17225.061773 29991.8898  74.1% 23679 3600s
H  192   230                    17276.358205 29991.8898  73.6% 21154 3600s

Cutting planes:
  Gomory: 8
  Implied bound: 322
  MIR: 5187
  Flow cover: 4727
  RLT: 98
  Relax-and-lift: 894

Explored 229 nodes (5478625 simplex iterations) in 3600.07 seconds (8017.61 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17276.4 17225.1 17172.7 ... 15661.2

Time limit reached
Best objective 1.727635820515e+04, best bound 2.999188977551e+04, gap 73.6008%
  WARNING: Time limit reached. Using best solution found (gap: 73.60%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 17276.36, θ = 169067.77
  Upper Bound (UB) = 17276.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169067.77
  [DEBUG]   ✓ Scenario 0: θ = 169067.77 ≤ Q = 169067.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169067.77 ≤ Q = 169067.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169067.77 ≤ Q = 169067.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169067.77 ≤ Q = 169067.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169067.77 ≤ Q = 169067.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6948bba2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x96b7445e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.257078e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6971789.3840
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.401097e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140109.75    0  122 6971789.38 -140109.75   102%     -    0s
H    0     0                    -103544.5522 -140109.75  35.3%     -    0s
H    0     0                    -105146.6416 -140109.75  33.3%     -    0s
     0     0 -113695.83    0  108 -105146.64 -113695.83  8.13%     -    0s
H    0     0                    -109917.2253 -113582.14  3.33%     -    0s
H    0     0                    -110427.8537 -112772.32  2.12%     -    0s
     0     0 -112772.32    0  105 -110427.85 -112772.32  2.12%     -    0s
H    0     0                    -111362.4846 -112769.51  1.26%     -    0s
     0     0 -112768.08    0  105 -111362.48 -112768.08  1.26%     -    0s
     0     0 -111982.74    0  107 -111362.48 -111982.74  0.56%     -    0s
     0     0 -111827.90    0   47 -111362.48 -111827.90  0.42%     -    0s
     0     0 -111815.97    0   55 -111362.48 -111815.97  0.41%     -    0s
     0     0 -111599.18    0   30 -111362.48 -111599.18  0.21%     -    0s
     0     0 -111586.42    0   30 -111362.48 -111586.42  0.20%     -    0s
     0     0 -111556.93    0   29 -111362.48 -111556.93  0.17%     -    0s
     0     0 -111519.44    0    9 -111362.48 -111519.44  0.14%     -    0s
     0     0 -111519.10    0    9 -111362.48 -111519.10  0.14%     -    0s
     0     0 -111519.10    0   66 -111362.48 -111519.10  0.14%     -    0s
     0     0 -111519.10    0   49 -111362.48 -111519.10  0.14%     -    0s
     0     0 -111391.18    0   15 -111362.48 -111391.18  0.03%     -    0s
     0     0 -111381.51    0    6 -111362.48 -111381.51  0.02%     -    0s
     0     0 -111378.67    0    5 -111362.48 -111378.67  0.01%     -    0s
     0     0 -111375.05    0    5 -111362.48 -111375.05  0.01%     -    0s
     0     0 -111368.61    0    4 -111362.48 -111368.61  0.01%     -    0s
     0     0 -111366.88    0    2 -111362.48 -111366.88  0.00%     -    0s
     0     0 -111363.95    0    2 -111362.48 -111363.95  0.00%     -    0s
H    0     0                    -111363.2060 -111363.95  0.00%     -    0s

Explored 1 nodes (935 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -111363 -111363 -111362 ... 1.25708e+13
No other solutions better than -111363

Optimal solution found (tolerance 1.00e-06)
Best objective -1.113632059937e+05, best bound -1.113632059937e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 165211.77
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111363.21
  [DEBUG]   S×d_nominal = 276574.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276574.98 + -111363.21 = 165211.77
  [DEBUG]   Current θ from Master = 169067.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3856.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13420.36
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 1485.7068, Absolute Gap = 1485.7068, Relative Gap = 0.085997
  Not converged yet (gap = 1485.71 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043639 nonzeros
Model fingerprint: 0xa39e570b
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 150288 rows and 61008 columns
Presolve time: 4.39s
Presolved: 218055 rows, 91012 columns, 1339434 nonzeros
Variable types: 88753 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.72s

Barrier statistics:
 Dense cols : 1258
 AA' NZ     : 5.387e+06
 Factor NZ  : 1.568e+07 (roughly 250 MB of memory)
 Factor Ops : 5.894e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.35078596e+07  3.48369017e+08  1.63e+05 1.70e+01  1.05e+05     8s
   1  -1.88340178e+07  3.23232430e+08  1.18e+05 6.87e+01  7.54e+04     8s
   2  -7.43862416e+06  2.57685425e+08  4.63e+04 2.16e+00  3.12e+04     8s
   3  -1.75059264e+06  2.29416257e+08  6.15e+03 2.36e+00  4.60e+03     8s
   4  -8.76710547e+05  1.80530120e+08  9.16e+02 1.33e+00  1.04e+03     9s
   5  -7.92599997e+05  1.25280034e+08  4.79e+02 8.55e-01  6.03e+02     9s
   6  -5.77463028e+05  9.21574834e+07  3.80e+02 5.47e-01  4.47e+02     9s
   7  -5.47423649e+05  7.47899610e+07  3.15e+02 4.25e-01  3.59e+02     9s
   8  -4.68750524e+05  4.91236249e+07  1.17e+02 2.57e-01  1.83e+02     9s
   9  -3.60146515e+05  3.68358838e+07  1.31e+01 1.82e-01  9.96e+01     9s
  10  -2.33468077e+05  2.40140193e+07  1.48e+00 1.17e-01  6.16e+01     9s
  11  -2.06139122e+05  1.54923080e+07  1.02e+00 7.55e-02  3.98e+01     9s
  12  -1.67469757e+05  1.28152227e+07  6.95e-01 6.20e-02  3.29e+01     9s
  13  -1.34485973e+05  9.60178052e+06  4.60e-01 4.61e-02  2.46e+01     9s
  14  -1.14705893e+05  6.84292046e+06  3.24e-01 3.40e-02  1.76e+01     9s
  15  -9.97279492e+04  3.56777601e+06  2.09e-01 1.84e-02  9.26e+00     9s
  16  -6.41441984e+04  1.96404836e+06  7.67e-02 1.00e-02  5.12e+00     9s
  17  -3.43299401e+04  5.87652392e+05  2.77e-02 2.73e-03  1.57e+00    10s
  18  -2.82794825e+04  3.99438609e+05  2.36e-02 2.00e-03  1.08e+00    10s
  19  -1.04970540e+04  2.73215297e+05  1.45e-02 1.44e-03  7.16e-01    10s
  20   3.59590060e+02  1.86851536e+05  1.10e-02 1.76e-03  4.70e-01    10s
  21   7.12835460e+03  1.43659124e+05  9.24e-03 2.74e-03  3.44e-01    10s
  22   1.67844196e+04  1.18065178e+05  6.79e-03 2.08e-03  2.56e-01    10s
  23   1.86973112e+04  1.09303221e+05  6.31e-03 1.83e-03  2.29e-01    10s
  24   2.19719999e+04  9.33421468e+04  5.55e-03 1.40e-03  1.80e-01    10s
  25   2.63090416e+04  8.70484154e+04  4.52e-03 1.20e-03  1.53e-01    10s
  26   2.93288781e+04  7.94963665e+04  3.82e-03 9.90e-04  1.27e-01    10s
  27   3.12409141e+04  7.60050089e+04  3.38e-03 8.87e-04  1.13e-01    10s
  28   3.32057849e+04  7.16473776e+04  2.95e-03 7.55e-04  9.70e-02    11s
  29   3.59849706e+04  6.71328420e+04  2.34e-03 6.18e-04  7.86e-02    11s
  30   3.66151090e+04  6.53701866e+04  2.22e-03 5.64e-04  7.25e-02    11s
  31   3.84710444e+04  6.34844035e+04  1.84e-03 5.00e-04  6.31e-02    11s
  32   3.91360285e+04  6.13182272e+04  1.70e-03 5.00e-04  5.60e-02    11s
  33   4.01152424e+04  5.90869981e+04  1.52e-03 3.68e-04  4.79e-02    11s
  34   4.14402371e+04  5.64840579e+04  1.28e-03 2.85e-04  3.80e-02    11s
  35   4.24313875e+04  5.45868985e+04  1.11e-03 2.14e-04  3.07e-02    11s
  36   4.35558705e+04  5.32648397e+04  9.14e-04 1.58e-04  2.45e-02    11s
  37   4.42515285e+04  5.25121951e+04  7.94e-04 1.40e-04  2.08e-02    12s
  38   4.56967724e+04  5.19325625e+04  5.55e-04 1.15e-04  1.57e-02    12s
  39   4.63709484e+04  5.13985447e+04  4.43e-04 8.99e-05  1.27e-02    12s
  40   4.66041988e+04  5.09033209e+04  4.04e-04 7.05e-05  1.08e-02    12s
  41   4.71122525e+04  5.08491363e+04  3.25e-04 6.91e-05  9.43e-03    12s
  42   4.73018045e+04  5.03841044e+04  2.93e-04 5.01e-05  7.78e-03    12s
  43   4.77525577e+04  5.01476016e+04  2.21e-04 4.06e-05  6.04e-03    12s
  44   4.80116901e+04  4.98633984e+04  1.80e-04 2.58e-05  4.67e-03    12s
  45   4.84887521e+04  4.96476455e+04  1.06e-04 1.69e-05  2.92e-03    12s
  46   4.86922275e+04  4.95018738e+04  7.54e-05 1.11e-05  2.04e-03    13s
  47   4.89118702e+04  4.94297063e+04  4.26e-05 8.19e-06  1.31e-03    13s
  48   4.89611194e+04  4.94167228e+04  3.54e-05 7.69e-06  1.15e-03    13s
  49   4.89895866e+04  4.93878339e+04  3.13e-05 6.57e-06  1.00e-03    13s
  50   4.90869711e+04  4.92945354e+04  1.76e-05 2.90e-06  5.24e-04    13s
  51   4.91573888e+04  4.92761339e+04  7.91e-06 2.15e-06  3.00e-04    13s
  52   4.92000924e+04  4.92438807e+04  2.41e-06 9.08e-07  1.10e-04    13s
  53   4.92064253e+04  4.92261979e+04  1.66e-06 1.95e-07  4.99e-05    13s
  54   4.92078252e+04  4.92239494e+04  1.49e-06 1.19e-07  4.07e-05    13s
  55   4.92125278e+04  4.92220141e+04  9.39e-07 4.96e-08  2.39e-05    13s
  56   4.92194945e+04  4.92208632e+04  1.09e-07 1.10e-08  3.45e-06    14s
  57   4.92202812e+04  4.92205264e+04  5.35e-08 2.07e-08  6.19e-07    14s
  58   4.92205110e+04  4.92205111e+04  1.38e-10 7.80e-11  9.78e-11    14s

Barrier solved model in 58 iterations and 13.71 seconds (23.31 work units)
Optimal objective 4.92205110e+04


Root crossover log...

  186364 DPushes remaining with DInf 0.0000000e+00                14s
   92694 DPushes remaining with DInf 0.0000000e+00                15s
   16804 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    4346 PPushes remaining with PInf 2.3342956e-05                24s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9204646e-10     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82771    4.9220511e+04   0.000000e+00   0.000000e+00     25s
   82771    4.9220511e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 5.83s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.922051e+04, 82771 iterations, 25.48 seconds (47.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49220.5111    0  275 -233202.98 49220.5111   121%     -   32s
H    0     0                    -202525.1207 49220.5111   124%     -   33s
H    0     0                    -199986.1095 49220.5111   125%     -   33s
H    0     0                    -195489.8691 49220.5111   125%     -   33s
H    0     0                    -191291.4419 49220.5111   126%     -   34s
H    0     0                    -82788.47868 49220.5111   159%     -   34s
H    0     0                    -37331.58540 49220.5111   232%     -   34s
H    0     0                    -13413.78588 49220.5111   467%     -   34s
H    0     0                    -5410.347182 49220.5111  1010%     -   34s
H    0     0                    -5341.198927 49220.5111  1022%     -   35s
H    0     0                    -5230.333402 49220.5111  1041%     -   35s
     0     0 41531.1796    0  322 -5230.3334 41531.1796   894%     -  179s
H    0     0                    -3784.501197 41530.2896  1197%     -  181s
     0     0 41090.8781    0  312 -3784.5012 41090.8781  1186%     -  242s
     0     0 41024.1255    0  316 -3784.5012 41024.1255  1184%     -  275s
     0     0 40779.5555    0  324 -3784.5012 40779.5555  1178%     -  327s
     0     0 40669.3500    0  317 -3784.5012 40669.3500  1175%     -  361s
     0     0 40627.3211    0  319 -3784.5012 40627.3211  1174%     -  380s
     0     0 40615.0320    0  326 -3784.5012 40615.0320  1173%     -  389s
     0     0 40492.4377    0  322 -3784.5012 40492.4377  1170%     -  407s
     0     0 40482.7648    0  318 -3784.5012 40482.7648  1170%     -  415s
     0     0 40481.8696    0  319 -3784.5012 40481.8696  1170%     -  417s
     0     0 37852.4150    0  391 -3784.5012 37852.4150  1100%     -  560s
H    0     0                    5125.1113430 37852.4040   639%     -  562s
H    0     0                    5762.8377417 37852.4040   557%     -  562s
H    0     0                    6018.6623320 37852.4040   529%     -  562s
H    0     0                    6198.4539209 37852.4040   511%     -  562s
H    0     0                    6293.0774988 37852.4040   501%     -  562s
H    0     0                    6466.1912539 37852.4040   485%     -  562s
     0     0 37403.7732    0  425 6466.19125 37403.7732   478%     -  649s
     0     0 37098.2600    0  443 6466.19125 37098.2600   474%     -  700s
     0     0 37006.0512    0  452 6466.19125 37006.0512   472%     -  750s
     0     0 36881.6374    0  449 6466.19125 36881.6374   470%     -  799s
     0     0 36792.5775    0  462 6466.19125 36792.5775   469%     -  833s
     0     0 36751.1513    0  457 6466.19125 36751.1513   468%     -  865s
     0     0 36327.9580    0  428 6466.19125 36327.9580   462%     -  918s
     0     0 36258.5106    0  430 6466.19125 36258.5106   461%     -  953s
     0     0 36177.4498    0  475 6466.19125 36177.4498   459%     -  993s
     0     0 36166.6617    0  475 6466.19125 36166.6617   459%     - 1012s
     0     0 36159.5394    0  480 6466.19125 36159.5394   459%     - 1020s
     0     0 36119.8626    0  475 6466.19125 36119.8626   459%     - 1041s
     0     0 36114.6979    0  479 6466.19125 36114.6979   459%     - 1051s
     0     0 36103.9179    0  480 6466.19125 36103.9179   458%     - 1061s
     0     0 36102.0832    0  483 6466.19125 36102.0832   458%     - 1067s
     0     0 36087.1644    0  475 6466.19125 36087.1644   458%     - 1085s
     0     0 36084.3678    0  475 6466.19125 36084.3678   458%     - 1091s
     0     0 36082.4723    0  482 6466.19125 36082.4723   458%     - 1095s
     0     0 36078.9024    0  474 6466.19125 36078.9024   458%     - 1101s
     0     0 36076.8590    0  479 6466.19125 36076.8590   458%     - 1106s
     0     0 36074.2456    0  481 6466.19125 36074.2456   458%     - 1112s
     0     0 36073.8462    0  480 6466.19125 36073.8462   458%     - 1116s
     0     0 33705.7087    0  426 6466.19125 33705.7087   421%     - 1339s
H    0     0                    6808.3084454 33705.6442   395%     - 1341s
H    0     0                    7042.7766070 33705.6442   379%     - 1341s
H    0     0                    7069.8369708 33705.6442   377%     - 1341s
     0     0 33373.6617    0  427 7069.83697 33373.6617   372%     - 1409s
     0     0 33163.2487    0  457 7069.83697 33163.2487   369%     - 1464s
     0     0 33071.7915    0  439 7069.83697 33071.7915   368%     - 1495s
     0     0 33015.7833    0  445 7069.83697 33015.7833   367%     - 1521s
     0     0 32937.3221    0  462 7069.83697 32937.3221   366%     - 1558s
     0     0 32857.1118    0  455 7069.83697 32857.1118   365%     - 1592s
     0     0 32763.5753    0  459 7069.83697 32763.5753   363%     - 1622s
     0     0 32676.6293    0  447 7069.83697 32676.6293   362%     - 1652s
     0     0 32635.2300    0  455 7069.83697 32635.2300   362%     - 1670s
     0     0 32627.1676    0  456 7069.83697 32627.1676   361%     - 1677s
     0     0 32617.4236    0  465 7069.83697 32617.4236   361%     - 1683s
     0     0 32608.6263    0  463 7069.83697 32608.6263   361%     - 1689s
     0     0 32583.5419    0  459 7069.83697 32583.5419   361%     - 1707s
     0     0 32566.1580    0  461 7069.83697 32566.1580   361%     - 1717s
     0     0 32540.1132    0  466 7069.83697 32540.1132   360%     - 1735s
     0     0 32534.2723    0  466 7069.83697 32534.2723   360%     - 1744s
     0     0 32533.0395    0  466 7069.83697 32533.0395   360%     - 1748s
     0     0 31623.8960    0  414 7069.83697 31623.8960   347%     - 1879s
H    0     0                    9022.1201210 31623.6742   251%     - 1882s
     0     0 31477.6247    0  406 9022.12012 31477.6247   249%     - 1915s
     0     0 31426.2954    0  422 9022.12012 31426.2954   248%     - 1945s
     0     0 31403.8245    0  434 9022.12012 31403.8245   248%     - 1962s
     0     0 31397.9366    0  435 9022.12012 31397.9366   248%     - 1967s
     0     0 31360.9914    0  432 9022.12012 31360.9914   248%     - 1982s
     0     0 31344.1306    0  433 9022.12012 31344.1306   247%     - 1990s
     0     0 31334.0123    0  434 9022.12012 31334.0123   247%     - 1995s
     0     0 31329.6618    0  438 9022.12012 31329.6618   247%     - 1999s
     0     0 31325.2889    0  438 9022.12012 31325.2889   247%     - 2003s
     0     0 31323.8687    0  437 9022.12012 31323.8687   247%     - 2006s
     0     0 31206.3035    0  432 9022.12012 31206.3035   246%     - 2048s
H    0     0                    9394.4822233 31205.9558   232%     - 2049s
H    0     0                    9540.5407788 31205.9558   227%     - 2049s
     0     0 31176.4347    0  469 9540.54078 31176.4347   227%     - 2071s
     0     0 31153.9033    0  516 9540.54078 31153.9033   227%     - 2090s
     0     0 31138.5259    0  426 9540.54078 31138.5259   226%     - 2103s
     0     0 31133.3137    0  431 9540.54078 31133.3137   226%     - 2111s
     0     0 31109.6112    0  446 9540.54078 31109.6112   226%     - 2125s
     0     0 31100.5428    0  444 9540.54078 31100.5428   226%     - 2134s
     0     0 31096.4617    0  443 9540.54078 31096.4617   226%     - 2138s
     0     0 31091.8906    0  448 9540.54078 31091.8906   226%     - 2143s
     0     0 31091.3914    0  443 9540.54078 31091.3914   226%     - 2146s
     0     0 31014.9475    0  452 9540.54078 31014.9475   225%     - 2179s
H    0     0                    9904.1048937 31013.9044   213%     - 2181s
H    0     0                    10035.345608 31013.9044   209%     - 2183s
     0     0 30997.6286    0  443 10035.3456 30997.6286   209%     - 2202s
     0     0 30992.1461    0  505 10035.3456 30992.1461   209%     - 2214s
     0     0 30988.9090    0  450 10035.3456 30988.9090   209%     - 2221s
     0     0 30987.1415    0  451 10035.3456 30987.1415   209%     - 2230s
     0     0 30955.5475    0  498 10035.3456 30955.5475   208%     - 2255s
     0     0 30944.3489    0  443 10035.3456 30944.3489   208%     - 2272s
     0     0 30939.4215    0  443 10035.3456 30939.4215   208%     - 2280s
     0     0 30935.1075    0  500 10035.3456 30935.1075   208%     - 2291s
     0     0 30933.0937    0  504 10035.3456 30933.0937   208%     - 2298s
     0     0 30928.9626    0  448 10035.3456 30928.9626   208%     - 2310s
     0     0 30926.4371    0  449 10035.3456 30926.4371   208%     - 2321s
     0     0 30918.7054    0  446 10035.3456 30918.7054   208%     - 2339s
     0     0 30917.6732    0  449 10035.3456 30917.6732   208%     - 2345s
     0     0 30915.6223    0  455 10035.3456 30915.6223   208%     - 2353s
     0     0 30915.4694    0  455 10035.3456 30915.4694   208%     - 2369s
H    0     0                    10362.207081 30915.4694   198%     - 2698s
H    0     0                    11498.894027 30915.4694   169%     - 2698s
H    0     0                    11644.952583 30915.4694   165%     - 2702s
H    0     0                    11870.344800 30915.4694   160%     - 2702s
H    0     0                    11996.475570 30915.4694   158%     - 2702s
H    0     0                    12002.194579 30915.4694   158%     - 2709s
H    0     0                    12770.766434 30915.4694   142%     - 2712s
H    0     0                    13016.413577 30915.4694   138%     - 2713s
H    0     0                    13169.552281 30915.4694   135%     - 2713s
H    0     0                    13316.316329 30915.4694   132%     - 2713s
H    0     0                    13634.787903 30915.4694   127%     - 2713s
H    0     0                    13887.515194 30915.4694   123%     - 2714s
H    0     0                    14092.156796 30915.4694   119%     - 2714s
H    0     0                    14157.506141 30915.4694   118%     - 2714s
H    0     2                    16034.972800 30915.4694  92.8%     - 2867s
     0     2 30915.4694    0  455 16034.9728 30915.4694  92.8%     - 2867s
     1     4 30810.8153    1  434 16034.9728 30915.4694  92.8% 20851 2904s
     3     8 30449.3216    2  445 16034.9728 30810.7063  92.1% 21026 2953s
     7    15 30029.4127    3  493 16034.9728 30455.5167  89.9% 21368 3047s
    14    30 28967.6697    4  479 16034.9728 30449.3172  89.9% 26022 3117s
    29    44 29258.9868    4  404 16034.9728 29884.3514  86.4% 36943 3600s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 367
  MIR: 4956
  Flow cover: 4311
  RLT: 98
  Relax-and-lift: 1002

Explored 43 nodes (2806493 simplex iterations) in 3600.16 seconds (7683.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16035 14157.5 14092.2 ... 12002.2

Time limit reached
Best objective 1.603497279991e+04, best bound 2.988435144160e+04, gap 86.3698%
  WARNING: Time limit reached. Using best solution found (gap: 86.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 16034.97, θ = 169692.60
  Upper Bound (UB) = 16034.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169692.60
  [DEBUG]   ✓ Scenario 0: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169692.60 ≤ Q = 169692.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 169692.60 ≤ Q = 169692.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x42ecfea8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbd130158
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.264233e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6907355.0839
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.395683e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139568.30    0  122 6907355.08 -139568.30   102%     -    0s
H    0     0                    -103217.3068 -139568.30  35.2%     -    0s
H    0     0                    -104632.5185 -139568.30  33.4%     -    0s
     0     0 -118705.90    0   54 -104632.52 -118705.90  13.5%     -    0s
H    0     0                    -116935.9686 -118593.44  1.42%     -    0s
     0     0 -117847.01    0   38 -116935.97 -117847.01  0.78%     -    0s
H    0     0                    -117329.6868 -117804.23  0.40%     -    0s
     0     0 -117591.05    0   19 -117329.69 -117591.05  0.22%     -    0s
     0     0 -117576.60    0   13 -117329.69 -117576.60  0.21%     -    0s
     0     0 -117483.56    0   19 -117329.69 -117483.56  0.13%     -    0s
     0     0 -117475.33    0   18 -117329.69 -117475.33  0.12%     -    0s
     0     0 -117474.68    0   18 -117329.69 -117474.68  0.12%     -    0s
     0     0 -117473.85    0   18 -117329.69 -117473.85  0.12%     -    0s
     0     0 -117347.67    0    3 -117329.69 -117347.67  0.02%     -    0s
*    0     0               0    -117338.8208 -117338.82  0.00%     -    0s

Explored 1 nodes (567 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -117339 -117330 -117225 ... 1.26423e+13
No other solutions better than -117339

Optimal solution found (tolerance 1.00e-06)
Best objective -1.173388208253e+05, best bound -1.173388208253e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 159321.74
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117338.82
  [DEBUG]   S×d_nominal = 276660.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276660.56 + -117338.82 = 159321.74
  [DEBUG]   Current θ from Master = 169692.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10370.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5664.11
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 244.3214, Absolute Gap = 244.3214, Relative Gap = 0.015237
  Not converged yet (gap = 244.32 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086894 nonzeros
Model fingerprint: 0xb8218911
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 156550 rows and 63550 columns
Presolve time: 4.89s
Presolved: 227083 rows, 94710 columns, 1396575 nonzeros
Variable types: 92451 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.04s

Barrier statistics:
 Dense cols : 1269
 AA' NZ     : 5.673e+06
 Factor NZ  : 1.651e+07 (roughly 260 MB of memory)
 Factor Ops : 6.602e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.41442000e+07  3.59716767e+08  1.67e+05 1.66e+01  1.07e+05     9s
   1  -1.95407888e+07  3.34896790e+08  1.23e+05 7.43e+01  7.80e+04     9s
   2  -7.74532258e+06  2.66012049e+08  4.83e+04 8.16e+00  3.25e+04     9s
   3  -1.78904832e+06  2.36222365e+08  6.49e+03 4.03e+00  4.81e+03     9s
   4  -8.60094187e+05  1.82473797e+08  9.51e+02 2.35e+00  1.04e+03     9s
   5  -7.54930309e+05  1.00640731e+08  6.97e+02 1.06e+00  6.43e+02     9s
   6  -5.64665421e+05  7.29606989e+07  2.94e+02 7.06e-01  3.36e+02    10s
   7  -4.65943114e+05  5.50238663e+07  1.52e+02 4.97e-01  2.11e+02    10s
   8  -3.92453609e+05  3.87237991e+07  4.60e+01 3.28e-01  1.15e+02    10s
   9  -2.79589642e+05  2.70700518e+07  1.03e+01 2.23e-01  7.01e+01    10s
  10  -2.14966497e+05  1.56702362e+07  5.13e+00 1.25e-01  3.97e+01    10s
  11  -1.67575403e+05  1.12886222e+07  3.19e+00 8.81e-02  2.83e+01    10s
  12  -1.43121690e+05  8.78006005e+06  2.28e+00 6.76e-02  2.19e+01    10s
  13  -1.23232256e+05  6.66029911e+06  1.58e+00 5.07e-02  1.66e+01    10s
  14  -9.17626282e+04  4.06609873e+06  5.88e-01 3.03e-02  1.01e+01    10s
  15  -5.94719807e+04  1.72585498e+06  1.74e-01 1.25e-02  4.33e+00    10s
  16  -4.25991526e+04  5.79172986e+05  9.64e-02 4.32e-03  1.51e+00    10s
  17  -2.69657456e+04  3.16892551e+05  6.96e-02 2.02e-03  8.34e-01    10s
  18  -9.53705250e+03  2.13569224e+05  4.42e-02 1.51e-03  5.41e-01    10s
  19   2.56904326e+03  1.57632181e+05  3.21e-02 1.96e-03  3.76e-01    11s
  20   9.14765208e+03  1.35470716e+05  2.71e-02 1.57e-03  3.06e-01    11s
  21   1.10397599e+04  1.26914095e+05  2.57e-02 1.42e-03  2.81e-01    11s
  22   1.63924092e+04  1.09033989e+05  2.19e-02 1.10e-03  2.25e-01    11s
  23   2.01557734e+04  9.44737836e+04  1.91e-02 8.27e-04  1.80e-01    11s
  24   2.55348740e+04  9.06883659e+04  1.51e-02 7.59e-04  1.58e-01    11s
  25   2.73556025e+04  8.37781715e+04  1.36e-02 6.07e-04  1.37e-01    11s
  26   3.04834722e+04  7.80420465e+04  1.13e-02 5.10e-04  1.15e-01    11s
  27   3.30474325e+04  7.16975993e+04  9.35e-03 4.21e-04  9.37e-02    11s
  28   3.44531471e+04  6.57129350e+04  8.30e-03 5.85e-04  7.58e-02    11s
  29   3.57512802e+04  6.33917352e+04  7.47e-03 5.02e-04  6.70e-02    12s
  30   3.78313808e+04  6.09966580e+04  6.11e-03 4.24e-04  5.61e-02    12s
  31   3.85533313e+04  5.84155026e+04  5.65e-03 3.82e-04  4.81e-02    12s
  32   4.10260634e+04  5.68880812e+04  4.16e-03 3.19e-04  3.84e-02    12s
  33   4.19541446e+04  5.56375778e+04  3.61e-03 2.55e-04  3.32e-02    12s
  34   4.22443073e+04  5.50116639e+04  3.44e-03 2.54e-04  3.09e-02    12s
  35   4.31663480e+04  5.34034305e+04  2.91e-03 1.89e-04  2.48e-02    12s
  36   4.42305875e+04  5.24523187e+04  2.31e-03 1.49e-04  1.99e-02    12s
  37   4.53487817e+04  5.20156880e+04  1.70e-03 1.32e-04  1.62e-02    12s
  38   4.54201345e+04  5.16336935e+04  1.66e-03 1.17e-04  1.51e-02    13s
  39   4.61590253e+04  5.10076954e+04  1.26e-03 7.76e-05  1.18e-02    13s
  40   4.64905731e+04  5.02673724e+04  1.09e-03 4.73e-05  9.15e-03    13s
  41   4.68231503e+04  5.00311765e+04  9.20e-04 4.00e-05  7.78e-03    13s
  42   4.70241131e+04  4.98488999e+04  8.19e-04 3.43e-05  6.85e-03    13s
  43   4.74214491e+04  4.97228566e+04  6.22e-04 3.03e-05  5.58e-03    13s
  44   4.76034377e+04  4.95851641e+04  5.32e-04 2.57e-05  4.80e-03    13s
  45   4.76889028e+04  4.94922226e+04  4.88e-04 2.28e-05  4.37e-03    13s
  46   4.78661283e+04  4.91728642e+04  3.98e-04 1.33e-05  3.17e-03    13s
  47   4.80007498e+04  4.90992030e+04  3.34e-04 1.13e-05  2.66e-03    14s
  48   4.81482780e+04  4.89443273e+04  2.62e-04 7.03e-06  1.93e-03    14s
  49   4.82736895e+04  4.89055291e+04  1.99e-04 6.10e-06  1.53e-03    14s
  50   4.83696409e+04  4.88339550e+04  1.51e-04 4.10e-06  1.13e-03    14s
  51   4.84279483e+04  4.88093157e+04  1.23e-04 3.43e-06  9.24e-04    14s
  52   4.85096796e+04  4.87885068e+04  8.33e-05 3.11e-06  6.76e-04    14s
  53   4.85522924e+04  4.87576508e+04  6.32e-05 1.41e-05  4.98e-04    14s
  54   4.86158417e+04  4.87291490e+04  3.22e-05 8.62e-06  2.75e-04    14s
  55   4.86639867e+04  4.87097373e+04  1.20e-05 3.88e-06  1.11e-04    15s
  56   4.86675032e+04  4.87054354e+04  1.05e-05 2.77e-06  9.19e-05    15s
  57   4.86796592e+04  4.87003425e+04  5.52e-06 1.44e-06  5.01e-05    15s
  58   4.86867217e+04  4.86968670e+04  2.68e-06 6.67e-07  2.46e-05    15s
  59   4.86916707e+04  4.86950296e+04  7.20e-07 2.62e-07  8.15e-06    15s
  60   4.86935968e+04  4.86942554e+04  4.93e-08 1.59e-07  1.60e-06    15s
  61   4.86937453e+04  4.86938613e+04  5.88e-08 1.67e-08  2.82e-07    15s
  62   4.86937847e+04  4.86938066e+04  6.50e-08 2.18e-08  5.32e-08    15s
  63   4.86937890e+04  4.86938039e+04  4.44e-07 1.19e-06  3.65e-08    15s
  64   4.86937890e+04  4.86938039e+04  6.77e-06 1.14e-06  3.55e-08    15s
  65   4.86937934e+04  4.86938039e+04  5.48e-06 6.59e-07  2.46e-08    16s
  66   4.86937934e+04  4.86938039e+04  7.25e-06 6.52e-07  2.43e-08    16s
  67   4.86937938e+04  4.86938039e+04  7.68e-06 4.04e-07  2.33e-08    16s
  68   4.86937979e+04  4.86938039e+04  5.97e-06 8.73e-07  1.48e-08    16s
  69   4.86938024e+04  4.86938039e+04  1.65e-06 3.45e-07  3.91e-09    16s
  70   4.86938024e+04  4.86938039e+04  1.64e-06 3.22e-07  3.88e-09    16s
  71   4.86938025e+04  4.86938039e+04  6.62e-06 2.32e-07  3.72e-09    16s
  72   4.86938034e+04  4.86938039e+04  2.24e-06 1.99e-07  1.26e-09    16s

Barrier solved model in 72 iterations and 16.22 seconds (28.33 work units)
Optimal objective 4.86938034e+04


Root crossover log...

  194632 DPushes remaining with DInf 0.0000000e+00                16s
   72711 DPushes remaining with DInf 0.0000000e+00                20s
   35461 DPushes remaining with DInf 0.0000000e+00                25s
   12015 DPushes remaining with DInf 0.0000000e+00                30s
     222 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                36s

   48980 PPushes remaining with PInf 3.4709810e-04                36s
   14193 PPushes remaining with PInf 3.7865258e-04                40s
       0 PPushes remaining with PInf 0.0000000e+00                42s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2675289e+05     42s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  157393    4.8693804e+04   0.000000e+00   2.267529e+05     43s
  158683    4.8693804e+04   0.000000e+00   2.618549e+01     45s
  159199    4.8693804e+04   0.000000e+00   0.000000e+00     46s
  159199    4.8693804e+04   0.000000e+00   0.000000e+00     46s
Concurrent spin time: 15.78s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.869380e+04, 159199 iterations, 56.19 seconds (93.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48693.8039    0  277 -233202.98 48693.8039   121%     -   63s
H    0     0                    -135238.3354 48693.8039   136%     -   64s
H    0     0                    -135052.8027 48693.8039   136%     -   65s
H    0     0                    -134924.4042 48693.8039   136%     -   67s
H    0     0                    -134636.6937 48693.8039   136%     -   67s
H    0     0                    -82453.99075 48693.8039   159%     -   67s
H    0     0                    -81597.86112 48693.8039   160%     -   67s
H    0     0                    -69014.99085 48693.8039   171%     -   67s
H    0     0                    -68969.35321 48693.8039   171%     -   67s
     0     0 41471.6928    0  307 -68969.353 41471.6928   160%     -  251s
H    0     0                    -51135.14739 41471.6889   181%     -  251s
H    0     0                    -5514.432081 41471.6889   852%     -  253s
H    0     0                    -5159.758910 41471.6889   904%     -  253s
H    0     0                    1054.1725119 41471.6889  3834%     -  254s
H    0     0                    1443.8955530 41471.6889  2772%     -  254s
     0     0 41156.8814    0  308 1443.89555 41156.8814  2750%     -  301s
     0     0 41037.6304    0  309 1443.89555 41037.6304  2742%     -  334s
     0     0 40870.3041    0  319 1443.89555 40870.3041  2731%     -  378s
     0     0 40814.2575    0  322 1443.89555 40814.2575  2727%     -  391s
     0     0 40770.8053    0  328 1443.89555 40770.8053  2724%     -  404s
     0     0 40752.0577    0  326 1443.89555 40752.0577  2722%     -  411s
     0     0 40748.5470    0  322 1443.89555 40748.5470  2722%     -  421s
     0     0 40713.6131    0  323 1443.89555 40713.6131  2720%     -  429s
     0     0 40703.0698    0  312 1443.89555 40703.0698  2719%     -  436s
     0     0 40691.1566    0  323 1443.89555 40691.1566  2718%     -  444s
     0     0 40685.0044    0  310 1443.89555 40685.0044  2718%     -  449s
     0     0 40684.6105    0  315 1443.89555 40684.6105  2718%     -  451s
     0     0 37658.1493    0  326 1443.89555 37658.1493  2508%     -  592s
H    0     0                    12690.686429 37657.7771   197%     -  594s
H    0     0                    13108.140073 37657.7771   187%     -  596s
H    0     0                    13735.457605 37657.7771   174%     -  597s
     0     0 37028.3109    0  371 13735.4576 37028.3109   170%     -  686s
     0     0 36750.6917    0  386 13735.4576 36750.6917   168%     -  764s
     0     0 36607.9876    0  418 13735.4576 36607.9876   167%     -  817s
     0     0 36578.3769    0  444 13735.4576 36578.3769   166%     -  844s
     0     0 36545.3990    0  438 13735.4576 36545.3990   166%     -  872s
     0     0 36518.6792    0  404 13735.4576 36518.6792   166%     -  896s
     0     0 36503.7165    0  410 13735.4576 36503.7165   166%     -  914s
     0     0 36471.1657    0  386 13735.4576 36471.1657   166%     -  942s
     0     0 36435.2084    0  401 13735.4576 36435.2084   165%     -  970s
     0     0 36419.3059    0  397 13735.4576 36419.3059   165%     -  988s
     0     0 36397.8364    0  404 13735.4576 36397.8364   165%     - 1003s
     0     0 36366.1002    0  406 13735.4576 36366.1002   165%     - 1027s
     0     0 36270.4199    0  443 13735.4576 36270.4199   164%     - 1072s
     0     0 36264.4124    0  443 13735.4576 36264.4124   164%     - 1089s
     0     0 36246.4652    0  446 13735.4576 36246.4652   164%     - 1109s
     0     0 36221.5437    0  454 13735.4576 36221.5437   164%     - 1135s
     0     0 36217.1124    0  443 13735.4576 36217.1124   164%     - 1146s
     0     0 36212.2084    0  441 13735.4576 36212.2084   164%     - 1154s
     0     0 36211.9767    0  441 13735.4576 36211.9767   164%     - 1157s
     0     0 33634.6829    0  367 13735.4576 33634.6829   145%     - 1341s
H    0     0                    14821.977268 33634.0445   127%     - 1343s
H    0     0                    14945.138743 33634.0445   125%     - 1343s
H    0     0                    14996.415125 33634.0445   124%     - 1343s
     0     0 32983.3557    0  388 14996.4151 32983.3557   120%     - 1425s
     0     0 32769.8877    0  418 14996.4151 32769.8877   119%     - 1488s
     0     0 32701.0211    0  409 14996.4151 32701.0211   118%     - 1525s
     0     0 32615.8028    0  409 14996.4151 32615.8028   117%     - 1552s
     0     0 32559.7950    0  415 14996.4151 32559.7950   117%     - 1581s
     0     0 32501.2712    0  419 14996.4151 32501.2712   117%     - 1614s
     0     0 32423.6833    0  410 14996.4151 32423.6833   116%     - 1645s
     0     0 32392.9904    0  412 14996.4151 32392.9904   116%     - 1667s
     0     0 32386.7130    0  425 14996.4151 32386.7130   116%     - 1679s
     0     0 32359.3207    0  430 14996.4151 32359.3207   116%     - 1702s
     0     0 32347.5669    0  435 14996.4151 32347.5669   116%     - 1722s
     0     0 32292.7152    0  427 14996.4151 32292.7152   115%     - 1748s
     0     0 32284.0325    0  423 14996.4151 32284.0325   115%     - 1766s
     0     0 32264.2876    0  432 14996.4151 32264.2876   115%     - 1782s
     0     0 32252.5087    0  431 14996.4151 32252.5087   115%     - 1796s
     0     0 32202.4662    0  433 14996.4151 32202.4662   115%     - 1826s
     0     0 32197.7150    0  434 14996.4151 32197.7150   115%     - 1837s
     0     0 32187.6905    0  439 14996.4151 32187.6905   115%     - 1850s
     0     0 32185.0944    0  440 14996.4151 32185.0944   115%     - 1858s
     0     0 32184.3492    0  442 14996.4151 32184.3492   115%     - 1863s
     0     0 31465.5478    0  430 14996.4151 31465.5478   110%     - 1983s
H    0     0                    15054.836956 31464.9843   109%     - 1989s
H    0     0                    15083.406614 31464.9843   109%     - 1989s
H    0     0                    15179.452636 31464.9843   107%     - 1989s
H    0     0                    15183.032909 31464.9843   107%     - 1990s
     0     0 31386.3118    0  444 15183.0329 31386.3118   107%     - 2027s
     0     0 31364.4953    0  451 15183.0329 31364.4953   107%     - 2048s
     0     0 31354.2616    0  449 15183.0329 31354.2616   107%     - 2066s
     0     0 31345.4977    0  430 15183.0329 31345.4977   106%     - 2080s
     0     0 31339.6868    0  446 15183.0329 31339.6868   106%     - 2093s
     0     0 31334.2656    0  438 15183.0329 31334.2656   106%     - 2110s
     0     0 31280.7760    0  419 15183.0329 31280.7760   106%     - 2135s
     0     0 31262.7407    0  435 15183.0329 31262.7407   106%     - 2155s
     0     0 31257.9332    0  446 15183.0329 31257.9332   106%     - 2174s
     0     0 31254.1566    0  444 15183.0329 31254.1566   106%     - 2183s
     0     0 31251.2404    0  444 15183.0329 31251.2404   106%     - 2191s
     0     0 31249.4601    0  441 15183.0329 31249.4601   106%     - 2198s
     0     0 31133.7283    0  439 15183.0329 31133.7283   105%     - 2242s
H    0     0                    15222.624330 31133.4692   105%     - 2243s
H    0     0                    15223.180334 31133.4692   105%     - 2243s
     0     0 31105.4309    0  484 15223.1803 31105.4309   104%     - 2266s
     0     0 31089.5704    0  445 15223.1803 31089.5704   104%     - 2284s
     0     0 31072.0250    0  449 15223.1803 31072.0250   104%     - 2306s
     0     0 31059.6602    0  490 15223.1803 31059.6602   104%     - 2324s
     0     0 31053.9044    0  489 15223.1803 31053.9044   104%     - 2342s
     0     0 31051.9076    0  531 15223.1803 31051.9076   104%     - 2350s
     0     0 31006.4246    0  513 15223.1803 31006.4246   104%     - 2386s
H    0     0                    16092.238393 31006.0469  92.7%     - 2399s
     0     0 30986.6209    0  510 16092.2384 30986.6209  92.6%     - 2424s
     0     0 30981.9677    0  473 16092.2384 30981.9677  92.5%     - 2431s
     0     0 30978.7945    0  468 16092.2384 30978.7945  92.5%     - 2439s
     0     0 30975.2675    0  486 16092.2384 30975.2675  92.5%     - 2446s
     0     0 30974.7226    0  481 16092.2384 30974.7226  92.5%     - 2449s
     0     0 30937.0987    0  483 16092.2384 30937.0987  92.2%     - 2477s
     0     0 30914.0139    0  495 16092.2384 30914.0139  92.1%     - 2497s
     0     0 30902.7951    0  443 16092.2384 30902.7951  92.0%     - 2508s
     0     0 30899.1264    0  454 16092.2384 30899.1264  92.0%     - 2516s
     0     0 30897.2346    0  447 16092.2384 30897.2346  92.0%     - 2521s
     0     0 30888.1220    0  464 16092.2384 30888.1220  91.9%     - 2539s
     0     0 30886.2746    0  457 16092.2384 30886.2746  91.9%     - 2553s
     0     0 30882.9944    0  447 16092.2384 30882.9944  91.9%     - 2564s
     0     0 30880.0710    0  444 16092.2384 30880.0710  91.9%     - 2573s
     0     0 30877.1159    0  451 16092.2384 30877.1159  91.9%     - 2581s
     0     0 30875.7817    0  454 16092.2384 30875.7817  91.9%     - 2584s
     0     0 30874.2744    0  450 16092.2384 30874.2744  91.9%     - 2595s
H    0     0                    16216.179067 30873.8772  90.4%     - 2601s
H    0     0                    16452.839057 30873.8772  87.7%     - 2603s
H    0     0                    16488.949876 30873.8772  87.2%     - 2606s
H    0     0                    16561.311295 30873.8772  86.4%     - 2606s
     0     0 30873.8772    0  452 16561.3113 30873.8772  86.4%     - 2609s
     0     0 30869.1621    0  497 16561.3113 30869.1621  86.4%     - 2622s
     0     0 30868.9243    0  497 16561.3113 30868.9243  86.4%     - 2639s
H    0     0                    16575.579327 30868.3827  86.2%     - 2717s
H    0     0                    16578.745458 30868.3827  86.2%     - 2902s
H    0     2                    16618.186163 30868.3827  85.8%     - 2909s
     0     2 30868.3827    0  497 16618.1862 30868.3827  85.8%     - 2909s
     1     3 30564.6490    1  437 16618.1862 30868.3827  85.8% 17908 2943s
     2     4 30724.0435    1  443 16618.1862 30724.0435  84.9% 15540 2965s
     3     5 29530.5230    2  455 16618.1862 30723.9478  84.9% 18503 3006s
     4     9 30395.5834    2  448 16618.1862 30723.6960  84.9% 16799 3039s
     8    15 28700.3157    4  405 16618.1862 30534.1075  83.7% 16589 3122s
    14    29 29188.3316    4  335 16618.1862 30534.1075  83.7% 22405 3187s
    28    43 29063.0920    4  415 16618.1862 30391.7813  82.9% 31233 3368s
    42    69 27402.3215    6  388 16618.1862 30391.7813  82.9% 37530 3600s
H   48    69                    16642.307934 30391.7813  82.6% 35439 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 345
  MIR: 4359
  Flow cover: 4841
  RLT: 96
  Relax-and-lift: 1112
  PSD: 1

Explored 68 nodes (3332332 simplex iterations) in 3600.15 seconds (7636.19 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16642.3 16618.2 16578.7 ... 15223.2

Time limit reached
Best objective 1.664230793448e+04, best bound 3.039178134033e+04, gap 82.6176%
  WARNING: Time limit reached. Using best solution found (gap: 82.62%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 16642.31, θ = 169459.83
  Upper Bound (UB) = 16642.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169459.83
  [DEBUG]   ✓ Scenario 0: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 169459.83 ≤ Q = 169459.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 169459.83 ≤ Q = 169459.83 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x662922c3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99d6dd3d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6881125.3008
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.397218e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139721.84    0  122 6881125.30 -139721.84   102%     -    0s
H    0     0                    -103349.2434 -139721.84  35.2%     -    0s
H    0     0                    -104835.7277 -139721.84  33.3%     -    0s
     0     0 -111372.83    0  104 -104835.73 -111372.83  6.24%     -    0s
H    0     0                    -108337.0907 -111323.08  2.76%     -    0s
H    0     0                    -108672.5718 -111323.08  2.44%     -    0s
     0     0 -110586.58    0   87 -108672.57 -110586.58  1.76%     -    0s
H    0     0                    -108888.9828 -110581.19  1.55%     -    0s
     0     0 -110133.65    0   84 -108888.98 -110133.65  1.14%     -    0s
     0     0 -110069.87    0   87 -108888.98 -110069.87  1.08%     -    0s
     0     0 -110067.23    0   51 -108888.98 -110067.23  1.08%     -    0s
     0     0 -109989.47    0   51 -108888.98 -109989.47  1.01%     -    0s
H    0     0                    -109465.7538 -109986.97  0.48%     -    0s
H    0     0                    -109768.1496 -109986.97  0.20%     -    0s
     0     0 -109965.76    0   50 -109768.15 -109965.76  0.18%     -    0s
     0     0 -109906.42    0   40 -109768.15 -109906.42  0.13%     -    0s
     0     0 -109906.36    0   39 -109768.15 -109906.36  0.13%     -    0s
     0     0 -109889.99    0   40 -109768.15 -109889.99  0.11%     -    0s
     0     0 -109844.01    0   14 -109768.15 -109844.01  0.07%     -    0s
     0     0 -109840.28    0   11 -109768.15 -109840.28  0.07%     -    0s
     0     0 -109831.85    0    9 -109768.15 -109831.85  0.06%     -    0s
     0     0 -109827.40    0    7 -109768.15 -109827.40  0.05%     -    0s
     0     0 -109827.40    0   31 -109768.15 -109827.40  0.05%     -    0s
     0     0 -109827.40    0   31 -109768.15 -109827.40  0.05%     -    0s
H    0     0                    -109802.0967 -109827.40  0.02%     -    0s
     0     0 -109824.33    0    8 -109802.10 -109824.33  0.02%     -    0s
H    0     0                    -109812.2771 -109815.12  0.00%     -    0s
     0     0 -109815.12    0    4 -109812.28 -109815.12  0.00%     -    0s
     0     0 -109814.76    0    4 -109812.28 -109814.76  0.00%     -    0s
     0     0     cutoff    0      -109812.28 -109812.28  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 25
  Flow cover: 9
  RLT: 2

Explored 1 nodes (911 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109812 -109802 -109768 ... -103349
No other solutions better than -109812

Optimal solution found (tolerance 1.00e-06)
Best objective -1.098122771470e+05, best bound -1.098122771470e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 166984.06
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109812.28
  [DEBUG]   S×d_nominal = 276796.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276796.34 + -109812.28 = 166984.06
  [DEBUG]   Current θ from Master = 169459.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2475.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14166.54
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 851.6565, Absolute Gap = 851.6565, Relative Gap = 0.051174
  Not converged yet (gap = 851.66 > ε = 200)

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1130149 nonzeros
Model fingerprint: 0xcd059d2c
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162812 rows and 66092 columns
Presolve time: 4.98s
Presolved: 236111 rows, 98408 columns, 1451753 nonzeros
Variable types: 96149 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.00s

Barrier statistics:
 Dense cols : 1266
 AA' NZ     : 6.072e+06
 Factor NZ  : 1.767e+07 (roughly 300 MB of memory)
 Factor Ops : 7.107e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.50311876e+07  3.72574145e+08  1.73e+05 1.64e+01  1.10e+05     9s
   1  -2.03254340e+07  3.48554836e+08  1.28e+05 7.50e+01  8.09e+04     9s
   2  -8.11435842e+06  2.79062945e+08  5.07e+04 9.81e+00  3.39e+04     9s
   3  -2.14985348e+06  2.38236725e+08  8.77e+03 3.97e+00  6.27e+03     9s
   4  -8.09132208e+05  1.67785322e+08  1.00e+03 1.04e+00  1.02e+03     9s
   5  -5.53073171e+05  9.91786763e+07  4.94e+02 5.24e-01  5.13e+02    10s
   6  -4.99275464e+05  7.28674972e+07  3.14e+02 3.65e-01  3.39e+02    10s
   7  -4.38056477e+05  5.69486878e+07  1.09e+02 2.69e-01  1.89e+02    10s
   8  -3.70171235e+05  3.58312288e+07  3.77e+01 1.50e-01  1.00e+02    10s
   9  -2.62862957e+05  2.20074401e+07  9.89e+00 8.67e-02  5.50e+01    10s
  10  -1.94174680e+05  1.31678800e+07  4.54e+00 4.99e-02  3.21e+01    10s
  11  -1.57345911e+05  9.71279733e+06  3.15e+00 3.65e-02  2.35e+01    10s
  12  -1.26660484e+05  6.94344136e+06  2.02e+00 2.56e-02  1.67e+01    10s
  13  -1.19973568e+05  6.17227186e+06  1.71e+00 2.27e-02  1.48e+01    10s
  14  -1.00035997e+05  4.03850589e+06  9.97e-01 1.46e-02  9.72e+00    10s
  15  -7.01508929e+04  1.78587073e+06  3.19e-01 6.02e-03  4.34e+00    10s
  16  -4.09077366e+04  5.20097712e+05  1.11e-01 1.68e-03  1.31e+00    10s
  17  -3.28363373e+04  2.93473018e+05  9.23e-02 1.12e-03  7.61e-01    10s
  18  -2.16094509e+04  2.28605174e+05  7.04e-02 1.26e-03  5.84e-01    11s
  19  -3.97829562e+03  1.66993878e+05  4.94e-02 2.55e-03  3.99e-01    11s
  20   1.29976595e+03  1.42075514e+05  4.41e-02 3.44e-03  3.28e-01    11s
  21   1.10598548e+04  1.10651539e+05  3.46e-02 2.30e-03  2.32e-01    11s
  22   1.60359204e+04  9.72898204e+04  3.00e-02 1.81e-03  1.90e-01    11s
  23   1.92338072e+04  8.96058408e+04  2.70e-02 1.50e-03  1.64e-01    11s
  24   2.37540565e+04  8.51082440e+04  2.27e-02 1.33e-03  1.43e-01    11s
  25   2.44308851e+04  8.30984508e+04  2.19e-02 1.26e-03  1.37e-01    11s
  26   2.86854379e+04  7.46272378e+04  1.75e-02 9.47e-04  1.07e-01    11s
  27   2.99262372e+04  6.90610988e+04  1.62e-02 7.87e-04  9.13e-02    11s
  28   3.19557723e+04  6.60157165e+04  1.43e-02 6.71e-04  7.94e-02    12s
  29   3.38996781e+04  6.37145978e+04  1.24e-02 5.77e-04  6.95e-02    12s
  30   3.59212981e+04  6.19036678e+04  1.05e-02 5.08e-04  6.06e-02    12s
  31   3.69852346e+04  5.99149404e+04  9.57e-03 4.35e-04  5.35e-02    12s
  32   3.92426349e+04  5.83124052e+04  7.52e-03 3.40e-04  4.45e-02    12s
  33   3.96525029e+04  5.75978197e+04  7.17e-03 3.09e-04  4.19e-02    12s
  34   4.10883512e+04  5.57891414e+04  5.93e-03 2.50e-04  3.43e-02    12s
  35   4.16445627e+04  5.47343763e+04  5.48e-03 2.13e-04  3.05e-02    12s
  36   4.32528260e+04  5.38309239e+04  4.16e-03 1.80e-04  2.47e-02    12s
  37   4.37828295e+04  5.27000061e+04  3.73e-03 1.97e-04  2.08e-02    13s
  38   4.42225348e+04  5.19096177e+04  3.38e-03 1.60e-04  1.79e-02    13s
  39   4.48234956e+04  5.13735365e+04  2.91e-03 1.19e-04  1.53e-02    13s
  40   4.53641931e+04  5.09926312e+04  2.49e-03 8.12e-05  1.31e-02    13s
  41   4.57704684e+04  5.04736241e+04  2.18e-03 7.22e-05  1.10e-02    13s
  42   4.64621280e+04  5.01965474e+04  1.66e-03 5.99e-05  8.71e-03    13s
  43   4.69886738e+04  4.98328463e+04  1.27e-03 4.38e-05  6.63e-03    13s
  44   4.70788120e+04  4.96733475e+04  1.20e-03 3.71e-05  6.05e-03    13s
  45   4.74578933e+04  4.95097265e+04  9.31e-04 2.96e-05  4.79e-03    14s
  46   4.76646455e+04  4.92481194e+04  7.84e-04 1.84e-05  3.69e-03    14s
  47   4.79458428e+04  4.91580643e+04  5.86e-04 1.79e-05  2.83e-03    14s
  48   4.80574995e+04  4.90331197e+04  5.07e-04 1.19e-05  2.28e-03    14s
  49   4.82825074e+04  4.89725710e+04  3.56e-04 8.57e-06  1.61e-03    14s
  50   4.83630099e+04  4.89401316e+04  2.99e-04 6.85e-06  1.35e-03    14s
  51   4.84196439e+04  4.89253846e+04  2.62e-04 6.73e-06  1.18e-03    14s
  52   4.84695690e+04  4.89131222e+04  2.29e-04 5.90e-06  1.03e-03    14s
  53   4.85319378e+04  4.88734585e+04  1.85e-04 1.09e-05  7.97e-04    14s
  54   4.86601520e+04  4.88486731e+04  9.75e-05 5.97e-06  4.40e-04    15s
  55   4.87501069e+04  4.88433451e+04  3.67e-05 5.06e-06  2.17e-04    15s
  56   4.87652510e+04  4.88324483e+04  2.79e-05 3.43e-06  1.57e-04    15s
  57   4.87879728e+04  4.88208451e+04  1.49e-05 8.85e-07  7.67e-05    15s
  58   4.87990091e+04  4.88189970e+04  8.83e-06 6.23e-07  4.66e-05    15s
  59   4.88094158e+04  4.88174597e+04  3.14e-06 4.01e-07  1.88e-05    15s
  60   4.88149483e+04  4.88162522e+04  3.13e-07 2.87e-07  3.04e-06    15s
  61   4.88152638e+04  4.88159101e+04  1.91e-07 4.81e-07  1.51e-06    15s
  62   4.88157041e+04  4.88158226e+04  4.53e-08 2.36e-07  2.76e-07    15s
  63   4.88157367e+04  4.88157472e+04  7.94e-08 5.17e-08  2.47e-08    16s
  64   4.88157387e+04  4.88157471e+04  4.31e-07 5.22e-08  1.97e-08    16s
  65   4.88157466e+04  4.88157469e+04  9.12e-08 9.41e-08  7.10e-10    16s

Barrier solved model in 65 iterations and 15.76 seconds (27.78 work units)
Optimal objective 4.88157466e+04


Root crossover log...

  202271 DPushes remaining with DInf 5.2189183e-07                16s
   66975 DPushes remaining with DInf 0.0000000e+00                20s
   32572 DPushes remaining with DInf 0.0000000e+00                25s
    4772 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                33s

   31620 PPushes remaining with PInf 3.5354217e-04                33s
    7359 PPushes remaining with PInf 1.4318504e-04                36s
       0 PPushes remaining with PInf 0.0000000e+00                38s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.0484318e+05     38s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  136975    4.8815747e+04   0.000000e+00   7.048432e+05     38s
  138337    4.8815747e+04   0.000000e+00   0.000000e+00     40s
  138337    4.8815747e+04   0.000000e+00   0.000000e+00     40s
Concurrent spin time: 18.12s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.881575e+04, 138337 iterations, 52.34 seconds (87.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48815.7469    0  278 -233202.98 48815.7469   121%     -   59s
H    0     0                    -135851.7366 48815.7469   136%     -   60s
H    0     0                    -135815.1567 48815.7469   136%     -   61s
H    0     0                    -128790.5705 48815.7469   138%     -   62s
H    0     0                    -127655.1463 48815.7469   138%     -   62s
H    0     0                    -124940.7380 48815.7469   139%     -   62s
H    0     0                    -124938.8415 48815.7469   139%     -   62s
H    0     0                    -82453.99075 48815.7469   159%     -   62s
H    0     0                    -81597.86112 48815.7469   160%     -   63s
H    0     0                    -36465.93279 48815.7469   234%     -   63s
H    0     0                    -36201.60432 48815.7469   235%     -   63s
H    0     0                    -35706.34478 48815.7469   237%     -   63s
H    0     0                    -35691.28548 48815.7469   237%     -   64s
H    0     0                    -35683.25798 48815.7469   237%     -   64s
     0     0 42440.4433    0  284 -35683.258 42440.4433   219%     -  189s
H    0     0                    -35680.78611 42439.7059   219%     -  190s
H    0     0                    -16379.44322 42439.7059   359%     -  191s
H    0     0                    -11214.02965 42439.7059   478%     -  191s
H    0     0                    -11120.83664 42439.7059   482%     -  191s
     0     0 41841.7454    0  292 -11120.837 41841.7454   476%     -  277s
     0     0 41728.8144    0  298 -11120.837 41728.8144   475%     -  303s
     0     0 41645.7235    0  284 -11120.837 41645.7235   474%     -  330s
     0     0 41586.3777    0  287 -11120.837 41586.3777   474%     -  349s
     0     0 41547.0458    0  298 -11120.837 41547.0458   474%     -  380s
     0     0 41533.3501    0  300 -11120.837 41533.3501   473%     -  390s
     0     0 41532.0742    0  300 -11120.837 41532.0742   473%     -  397s
     0     0 41531.8694    0  299 -11120.837 41531.8694   473%     -  398s
     0     0 38495.7312    0  357 -11120.837 38495.7312   446%     -  561s
H    0     0                    -8708.555704 38495.6462   542%     -  562s
H    0     0                     313.0582564 38495.6462      -     -  562s
H    0     0                    12591.241936 38495.6462   206%     -  562s
H    0     0                    12707.891335 38495.6462   203%     -  562s
H    0     0                    13195.809183 38495.6462   192%     -  562s
     0     0 38128.3158    0  348 13195.8092 38128.3158   189%     -  624s
     0     0 37939.0657    0  391 13195.8092 37939.0657   188%     -  669s
     0     0 37650.0013    0  375 13195.8092 37650.0013   185%     -  747s
     0     0 37333.9153    0  381 13195.8092 37333.9153   183%     -  798s
     0     0 37265.7539    0  379 13195.8092 37265.7539   182%     -  831s
     0     0 37192.2337    0  388 13195.8092 37192.2337   182%     -  864s
     0     0 37167.0198    0  393 13195.8092 37167.0198   182%     -  895s
     0     0 37151.6959    0  391 13195.8092 37151.6959   182%     -  915s
     0     0 37125.0344    0  402 13195.8092 37125.0344   181%     -  937s
     0     0 37077.3484    0  402 13195.8092 37077.3484   181%     -  971s
     0     0 37050.5250    0  396 13195.8092 37050.5250   181%     -  988s
     0     0 36992.6353    0  403 13195.8092 36992.6353   180%     - 1023s
     0     0 36986.7691    0  409 13195.8092 36986.7691   180%     - 1031s
     0     0 36940.6120    0  412 13195.8092 36940.6120   180%     - 1049s
     0     0 36928.2757    0  406 13195.8092 36928.2757   180%     - 1070s
     0     0 36924.6235    0  414 13195.8092 36924.6235   180%     - 1077s
     0     0 36912.0188    0  408 13195.8092 36912.0188   180%     - 1102s
     0     0 36905.0306    0  405 13195.8092 36905.0306   180%     - 1110s
     0     0 36891.2190    0  405 13195.8092 36891.2190   180%     - 1123s
     0     0 36889.8370    0  413 13195.8092 36889.8370   180%     - 1128s
     0     0 36889.7326    0  410 13195.8092 36889.7326   180%     - 1129s
     0     0 34106.8791    0  479 13195.8092 34106.8791   158%     - 1360s
H    0     0                    13843.378836 34106.8780   146%     - 1363s
H    0     0                    13846.842501 34106.8780   146%     - 1363s
H    0     0                    14266.103309 34106.8780   139%     - 1363s
H    0     0                    14527.022679 34106.8780   135%     - 1363s
H    0     0                    14635.140887 34106.8780   133%     - 1363s
H    0     0                    14668.822674 34106.8780   133%     - 1363s
H    0     0                    14712.111453 34106.8780   132%     - 1363s
H    0     0                    14765.682245 34106.8780   131%     - 1363s
H    0     0                    14836.958340 34106.8780   130%     - 1363s
H    0     0                    14916.885153 34106.8780   129%     - 1363s
     0     0 33835.9273    0  469 14916.8852 33835.9273   127%     - 1438s
     0     0 33727.3041    0  454 14916.8852 33727.3041   126%     - 1492s
     0     0 33634.6295    0  454 14916.8852 33634.6295   125%     - 1525s
     0     0 33578.3410    0  498 14916.8852 33578.3410   125%     - 1556s
     0     0 33563.4977    0  504 14916.8852 33563.4977   125%     - 1571s
     0     0 33545.3780    0  499 14916.8852 33545.3780   125%     - 1586s
     0     0 33502.1546    0  496 14916.8852 33502.1546   125%     - 1611s
     0     0 33495.7652    0  500 14916.8852 33495.7652   125%     - 1624s
     0     0 33479.0441    0  503 14916.8852 33479.0441   124%     - 1638s
     0     0 33467.8087    0  499 14916.8852 33467.8087   124%     - 1649s
     0     0 33466.8820    0  501 14916.8852 33466.8820   124%     - 1652s
     0     0 32311.8601    0  389 14916.8852 32311.8601   117%     - 1828s
H    0     0                    15033.323307 32311.8410   115%     - 1829s
H    0     0                    15033.730380 32311.8410   115%     - 1829s
     0     0 31966.7039    0  408 15033.7304 31966.7039   113%     - 1892s
     0     0 31857.6924    0  413 15033.7304 31857.6924   112%     - 1941s
     0     0 31799.0635    0  422 15033.7304 31799.0635   112%     - 1976s
     0     0 31768.9783    0  422 15033.7304 31768.9783   111%     - 1998s
     0     0 31757.4477    0  424 15033.7304 31757.4477   111%     - 2010s
     0     0 31739.1032    0  427 15033.7304 31739.1032   111%     - 2023s
     0     0 31708.7628    0  435 15033.7304 31708.7628   111%     - 2041s
     0     0 31676.8303    0  446 15033.7304 31676.8303   111%     - 2056s
     0     0 31665.8259    0  443 15033.7304 31665.8259   111%     - 2067s
     0     0 31651.0017    0  436 15033.7304 31651.0017   111%     - 2083s
     0     0 31646.3858    0  441 15033.7304 31646.3858   111%     - 2092s
     0     0 31638.6267    0  439 15033.7304 31638.6267   110%     - 2101s
     0     0 31604.0418    0  427 15033.7304 31604.0418   110%     - 2117s
     0     0 31588.9753    0  438 15033.7304 31588.9753   110%     - 2133s
     0     0 31583.5310    0  437 15033.7304 31583.5310   110%     - 2140s
     0     0 31572.6331    0  434 15033.7304 31572.6331   110%     - 2152s
     0     0 31568.0536    0  441 15033.7304 31568.0536   110%     - 2157s
     0     0 31543.0296    0  431 15033.7304 31543.0296   110%     - 2165s
     0     0 31539.7773    0  437 15033.7304 31539.7773   110%     - 2169s
     0     0 31538.0852    0  436 15033.7304 31538.0852   110%     - 2172s
     0     0 31323.2891    0  440 15033.7304 31323.2891   108%     - 2236s
H    0     0                    15072.920970 31322.8403   108%     - 2238s
     0     0 31270.6047    0  436 15072.9210 31270.6047   107%     - 2262s
     0     0 31227.3538    0  444 15072.9210 31227.3538   107%     - 2286s
     0     0 31182.8388    0  446 15072.9210 31182.8388   107%     - 2308s
     0     0 31173.4837    0  453 15072.9210 31173.4837   107%     - 2316s
     0     0 31156.4420    0  440 15072.9210 31156.4420   107%     - 2337s
     0     0 31129.5730    0  439 15072.9210 31129.5730   107%     - 2358s
     0     0 31122.3372    0  439 15072.9210 31122.3372   106%     - 2377s
     0     0 31118.8483    0  449 15072.9210 31118.8483   106%     - 2384s
     0     0 31117.9269    0  443 15072.9210 31117.9269   106%     - 2387s
     0     0 31005.5813    0  422 15072.9210 31005.5813   106%     - 2427s
H    0     0                    15215.609789 31005.4697   104%     - 2429s
H    0     0                    15217.799591 31005.4697   104%     - 2429s
H    0     0                    15278.891564 31005.4697   103%     - 2429s
     0     0 30975.4149    0  443 15278.8916 30975.4149   103%     - 2451s
     0     0 30961.9203    0  453 15278.8916 30961.9203   103%     - 2464s
     0     0 30958.5914    0  452 15278.8916 30958.5914   103%     - 2470s
     0     0 30956.9945    0  457 15278.8916 30956.9945   103%     - 2473s
     0     0 30934.1204    0  454 15278.8916 30934.1204   102%     - 2501s
     0     0 30926.5231    0  461 15278.8916 30926.5231   102%     - 2517s
     0     0 30924.7761    0  461 15278.8916 30924.7761   102%     - 2525s
     0     0 30918.3147    0  452 15278.8916 30918.3147   102%     - 2543s
H    0     0                    15306.456357 30917.8043   102%     - 2545s
H    0     0                    15315.358144 30917.8043   102%     - 2545s
H    0     0                    15397.437062 30917.8043   101%     - 2545s
H    0     0                    15480.912487 30917.8043   100%     - 2545s
H    0     0                    15495.762409 30917.8043   100%     - 2545s
H    0     0                    15514.099780 30917.8043  99.3%     - 2545s
     0     0 30916.4461    0  458 15514.0998 30916.4461  99.3%     - 2557s
     0     0 30912.9937    0  457 15514.0998 30912.9937  99.3%     - 2569s
     0     0 30910.4611    0  449 15514.0998 30910.4611  99.2%     - 2579s
     0     0 30907.9803    0  454 15514.0998 30907.9803  99.2%     - 2592s
     0     0 30907.8963    0  454 15514.0998 30907.8963  99.2%     - 2610s
H    0     0                    15648.835092 30907.8753  97.5%     - 2950s
H    0     0                    16198.736080 30907.8753  90.8%     - 2950s
H    0     0                    16263.996402 30907.8753  90.0%     - 2957s
H    0     0                    16316.851406 30907.8753  89.4%     - 2957s
H    0     0                    16437.963749 30907.8753  88.0%     - 2957s
H    0     0                    16471.602273 30907.8753  87.6%     - 2957s
H    0     2                    16634.903662 30907.8753  85.8%     - 3002s
     0     2 30907.8753    0  454 16634.9037 30907.8753  85.8%     - 3002s
     1     3 30638.3366    1  417 16634.9037 30907.8511  85.8% 17191 3051s
     2     6 30011.5846    2  434 16634.9037 30907.8511  85.8% 24330 3111s
     5    12 29788.0097    3  420 16634.9037 30706.4463  84.6% 22929 3167s
    11    24 29401.5450    4  430 16634.9037 30594.2543  83.9% 24788 3258s
    23    36 29763.3961    4  489 16634.9037 30305.8135  82.2% 37408 3558s
H   35    38                    16867.710005 30305.8135  79.7% 32087 3600s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 318
  MIR: 4902
  Flow cover: 4317
  RLT: 89
  Relax-and-lift: 1035

Explored 37 nodes (2486151 simplex iterations) in 3600.17 seconds (7735.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16867.7 16634.9 16471.6 ... 15495.8

Time limit reached
Best objective 1.686771000523e+04, best bound 3.030581354520e+04, gap 79.6676%
  WARNING: Time limit reached. Using best solution found (gap: 79.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 16867.71, θ = 169667.61
  Upper Bound (UB) = 16867.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169667.61
  [DEBUG]   ✓ Scenario 0: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169667.61 ≤ Q = 169667.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 169667.61 ≤ Q = 169667.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x734fc929
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8cb036d7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6857325.3066
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.399523e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139952.32    0  123 6857325.31 -139952.32   102%     -    0s
H    0     0                    -103233.1180 -139952.32  35.6%     -    0s
H    0     0                    -104762.9757 -139952.32  33.6%     -    0s
     0     0 -113899.09    0   58 -104762.98 -113899.09  8.72%     -    0s
H    0     0                    -113226.9819 -113896.85  0.59%     -    0s
     0     0 -113405.14    0   12 -113226.98 -113405.14  0.16%     -    0s
     0     0 -113355.00    0    9 -113226.98 -113355.00  0.11%     -    0s
     0     0 -113343.70    0    9 -113226.98 -113343.70  0.10%     -    0s
     0     0 -113272.49    0    2 -113226.98 -113272.49  0.04%     -    0s
     0     0 -113272.49    0   24 -113226.98 -113272.49  0.04%     -    0s
     0     0 -113272.49    0   14 -113226.98 -113272.49  0.04%     -    0s
     0     0 -113272.49    0   12 -113226.98 -113272.49  0.04%     -    0s
H    0     0                    -113264.1237 -113272.49  0.01%     -    0s
     0     0     cutoff    0      -113264.12 -113264.12  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 7
  Flow cover: 2
  RLT: 6
  Relax-and-lift: 2

Explored 1 nodes (531 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -113264 -113227 -104763 ... 1.2561e+13
No other solutions better than -113264

Optimal solution found (tolerance 1.00e-06)
Best objective -1.132641236531e+05, best bound -1.132641236531e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 163848.51
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113264.12
  [DEBUG]   S×d_nominal = 277112.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 277112.64 + -113264.12 = 163848.51
  [DEBUG]   Current θ from Master = 169667.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5819.10 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11048.61
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 1077.0586, Absolute Gap = 1077.0586, Relative Gap = 0.063853
  Not converged yet (gap = 1077.06 > ε = 200)

  [DEBUG] Adding NEW scenario 26 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 26 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 26 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 26]
    [DEBUG]   - Total constraints in model: 414213
    [DEBUG]   - Total variables in model: 170740
  [DEBUG] Total scenarios in Master: 27
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 27
================================================================================
[Iteration 27] Solving Master Problem...
  Current scenarios in Master: 27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 414213 rows, 170740 columns and 1173404 nonzeros
Model fingerprint: 0xb192d44e
Variable types: 168481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169074 rows and 68634 columns (presolve time = 5s)...
Presolve removed 169074 rows and 68634 columns
Presolve time: 5.18s
Presolved: 245139 rows, 102106 columns, 1507184 nonzeros
Variable types: 99847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.50s

Barrier statistics:
 Dense cols : 1265
 AA' NZ     : 6.480e+06
 Factor NZ  : 1.891e+07 (roughly 300 MB of memory)
 Factor Ops : 7.857e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.56480903e+07  3.83573725e+08  1.78e+05 1.64e+01  1.13e+05    10s
   1  -2.08684588e+07  3.59858746e+08  1.31e+05 7.39e+01  8.26e+04    10s
   2  -8.47226467e+06  2.90646022e+08  5.29e+04 5.13e+00  3.52e+04    10s
   3  -1.96580978e+06  2.45016154e+08  7.65e+03 4.76e+00  5.53e+03    10s
   4  -7.98873970e+05  1.61666533e+08  9.38e+02 1.30e+00  9.42e+02    10s
   5  -5.80157673e+05  1.02320634e+08  4.90e+02 6.86e-01  5.09e+02    10s
   6  -4.86229798e+05  7.34242993e+07  2.40e+02 4.55e-01  2.93e+02    11s
   7  -4.36098778e+05  5.31406847e+07  9.99e+01 3.05e-01  1.69e+02    11s
   8  -3.65632938e+05  4.38629864e+07  2.38e+01 2.43e-01  1.10e+02    11s
   9  -2.73318691e+05  2.92940945e+07  7.72e+00 1.57e-01  6.90e+01    11s
  10  -2.04500309e+05  1.39041379e+07  3.50e+00 7.16e-02  3.23e+01    11s
  11  -1.61247776e+05  1.15178816e+07  2.25e+00 5.91e-02  2.66e+01    11s
  12  -1.30229619e+05  8.87741517e+06  1.51e+00 4.48e-02  2.04e+01    11s
  13  -1.14906748e+05  6.45749658e+06  1.09e+00 3.21e-02  1.49e+01    11s
  14  -9.56872910e+04  4.38327943e+06  6.32e-01 2.16e-02  1.01e+01    11s
  15  -7.11056654e+04  2.46221772e+06  2.48e-01 1.20e-02  5.70e+00    11s
  16  -4.29294539e+04  1.02236231e+06  8.76e-02 4.89e-03  2.39e+00    11s
  17  -3.62197247e+04  4.60236358e+05  6.98e-02 2.06e-03  1.12e+00    11s
  18  -2.11946102e+04  3.93097768e+05  4.73e-02 1.75e-03  9.30e-01    12s
  19  -4.29092723e+03  2.70076790e+05  3.01e-02 1.81e-03  6.16e-01    12s
  20   9.41575833e+02  2.24212195e+05  2.58e-02 1.46e-03  5.01e-01    12s
  21   6.79263282e+03  1.68345330e+05  2.19e-02 1.04e-03  3.63e-01    12s
  22   1.47887829e+04  1.50016445e+05  1.71e-02 9.18e-04  3.04e-01    12s
  23   2.09030761e+04  1.15485780e+05  1.35e-02 6.34e-04  2.12e-01    12s
  24   2.36276162e+04  1.01492977e+05  1.20e-02 5.05e-04  1.75e-01    12s
  25   2.53008962e+04  9.38113431e+04  1.10e-02 4.40e-04  1.54e-01    12s
  26   2.89555826e+04  8.53075235e+04  8.98e-03 3.60e-04  1.27e-01    12s
  27   3.13100589e+04  7.72894509e+04  7.74e-03 2.87e-04  1.03e-01    13s
  28   3.39911412e+04  7.08566470e+04  6.35e-03 2.29e-04  8.28e-02    13s
  29   3.63326162e+04  6.51551996e+04  5.20e-03 1.81e-04  6.47e-02    13s
  30   3.74578529e+04  6.20142264e+04  4.67e-03 1.56e-04  5.52e-02    13s
  31   3.93912480e+04  5.92782686e+04  3.81e-03 1.40e-04  4.47e-02    13s
  32   4.00762015e+04  5.75257437e+04  3.51e-03 1.71e-04  3.92e-02    13s
  33   4.19543065e+04  5.67508336e+04  2.70e-03 1.77e-04  3.32e-02    13s
  34   4.26510508e+04  5.40408619e+04  2.39e-03 1.20e-04  2.56e-02    14s
  35   4.39954492e+04  5.33896747e+04  1.85e-03 1.08e-04  2.11e-02    14s
  36   4.46479595e+04  5.24416970e+04  1.58e-03 1.14e-04  1.75e-02    14s
  37   4.54932467e+04  5.17847114e+04  1.24e-03 9.33e-05  1.41e-02    14s
  38   4.58158466e+04  5.10975876e+04  1.12e-03 8.20e-05  1.19e-02    14s
  39   4.67945582e+04  5.06232422e+04  7.42e-04 5.96e-05  8.60e-03    14s
  40   4.71142887e+04  5.02560701e+04  6.22e-04 5.79e-05  7.06e-03    14s
  41   4.76888260e+04  5.00753104e+04  4.02e-04 5.05e-05  5.36e-03    15s
  42   4.78491567e+04  4.97800149e+04  3.41e-04 3.91e-05  4.34e-03    15s
  43   4.80322536e+04  4.94265712e+04  2.71e-04 2.48e-05  3.13e-03    15s
  44   4.81467190e+04  4.92445660e+04  2.31e-04 1.74e-05  2.47e-03    15s
  45   4.83155451e+04  4.91126447e+04  1.73e-04 1.21e-05  1.79e-03    15s
  46   4.84263671e+04  4.90475471e+04  1.32e-04 8.99e-06  1.40e-03    15s
  47   4.85343401e+04  4.90243641e+04  9.48e-05 8.34e-06  1.10e-03    15s
  48   4.86067488e+04  4.89405646e+04  6.95e-05 9.96e-06  7.50e-04    16s
  49   4.86866976e+04  4.88908405e+04  4.20e-05 1.01e-05  4.58e-04    16s
  50   4.87221578e+04  4.88592169e+04  3.00e-05 5.54e-06  3.08e-04    16s
  51   4.87731706e+04  4.88435857e+04  1.32e-05 3.69e-06  1.58e-04    16s
  52   4.87869484e+04  4.88318299e+04  8.78e-06 1.95e-06  1.01e-04    16s
  53   4.87951974e+04  4.88203259e+04  6.17e-06 6.85e-07  5.64e-05    16s
  54   4.88037963e+04  4.88186394e+04  3.48e-06 4.27e-07  3.33e-05    16s
  55   4.88111582e+04  4.88167751e+04  1.29e-06 1.81e-07  1.26e-05    17s
  56   4.88144201e+04  4.88160034e+04  3.53e-07 4.17e-08  3.56e-06    17s
  57   4.88153617e+04  4.88158065e+04  1.47e-07 6.23e-07  9.99e-07    17s
  58   4.88153908e+04  4.88158028e+04  1.11e-06 5.81e-07  9.25e-07    17s
  59   4.88157280e+04  4.88157493e+04  5.63e-08 2.22e-08  4.77e-08    17s
  60   4.88157391e+04  4.88157471e+04  3.03e-07 5.56e-09  1.79e-08    17s
  61   4.88157417e+04  4.88157470e+04  1.33e-06 5.80e-08  1.19e-08    17s
  62   4.88157446e+04  4.88157469e+04  9.61e-07 1.16e-07  5.02e-09    17s
  63   4.88157463e+04  4.88157469e+04  2.54e-07 4.03e-08  1.28e-09    17s
  64   4.88157465e+04  4.88157469e+04  2.07e-07 2.65e-08  8.52e-10    18s

Barrier solved model in 64 iterations and 17.51 seconds (31.28 work units)
Optimal objective 4.88157465e+04


Root crossover log...

  209716 DPushes remaining with DInf 0.0000000e+00                18s
   99163 DPushes remaining with DInf 0.0000000e+00                20s
   53955 DPushes remaining with DInf 0.0000000e+00                25s
   25812 DPushes remaining with DInf 0.0000000e+00                30s
    2548 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                37s

   39790 PPushes remaining with PInf 3.1403891e-04                37s
    8400 PPushes remaining with PInf 1.2525858e-04                40s
       0 PPushes remaining with PInf 1.5280766e-08                42s

  Push phase complete: Pinf 1.5280766e-08, Dinf 3.3497443e+06     42s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  150910    4.8815747e+04   0.000000e+00   3.349744e+06     42s
  152506    4.8815747e+04   0.000000e+00   0.000000e+00     45s
  152506    4.8815747e+04   0.000000e+00   0.000000e+00     45s
Concurrent spin time: 9.14s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.881575e+04, 152506 iterations, 48.15 seconds (95.21 work units)
Total elapsed time = 55.20s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48815.7469    0  278 -233202.98 48815.7469   121%     -   55s
H    0     0                    -221685.5100 48815.7469   122%     -   57s
H    0     0                    -221676.6609 48815.7469   122%     -   57s
H    0     0                    -221145.3604 48815.7469   122%     -   57s
H    0     0                    -163084.8409 48815.7469   130%     -   57s
H    0     0                    -160640.7979 48815.7469   130%     -   60s
H    0     0                    -145662.3704 48815.7469   134%     -   61s
H    0     0                    -145041.0461 48815.7469   134%     -   61s
H    0     0                    -143049.8344 48815.7469   134%     -   61s
H    0     0                    -142499.5500 48815.7469   134%     -   61s
H    0     0                    -142298.4767 48815.7469   134%     -   61s
H    0     0                    -142244.1889 48815.7469   134%     -   61s
H    0     0                    -141977.0082 48815.7469   134%     -   61s
H    0     0                    -82453.99075 48815.7469   159%     -   61s
H    0     0                    -81597.86112 48815.7469   160%     -   62s
H    0     0                    -49506.06564 48815.7469   199%     -   62s
H    0     0                    -49299.04089 48815.7469   199%     -   62s
H    0     0                    -46553.17483 48815.7469   205%     -   62s
H    0     0                    -46523.51704 48815.7469   205%     -   62s
H    0     0                    -39443.82312 48815.7469   224%     -   62s
     0     0 42212.1620    0  283 -39443.823 42212.1620   207%     -  208s
H    0     0                    -16629.78519 42211.7165   354%     -  210s
H    0     0                    -15701.37099 42211.7165   369%     -  210s
H    0     0                    -15300.07811 42211.7165   376%     -  210s
H    0     0                    -14903.38778 42211.7165   383%     -  211s
H    0     0                    -14844.51122 42211.7165   384%     -  211s
     0     0 41792.8015    0  290 -14844.511 41792.8015   382%     -  252s
     0     0 41583.4352    0  297 -14844.511 41583.4352   380%     -  300s
     0     0 41534.5158    0  287 -14844.511 41534.5158   380%     -  318s
     0     0 41496.5205    0  290 -14844.511 41496.5205   380%     -  330s
     0     0 41488.7383    0  293 -14844.511 41488.7383   379%     -  336s
     0     0 41487.5503    0  293 -14844.511 41487.5503   379%     -  339s
     0     0 41460.2733    0  279 -14844.511 41460.2733   379%     -  346s
     0     0 41455.7234    0  279 -14844.511 41455.7234   379%     -  351s
     0     0 41449.8521    0  280 -14844.511 41449.8521   379%     -  355s
     0     0 41437.9391    0  277 -14844.511 41437.9391   379%     -  358s
     0     0 41428.0228    0  284 -14844.511 41428.0228   379%     -  366s
     0     0 41426.5565    0  277 -14844.511 41426.5565   379%     -  370s
     0     0 41415.6755    0  278 -14844.511 41415.6755   379%     -  374s
     0     0 41412.5043    0  280 -14844.511 41412.5043   379%     -  377s
     0     0 41410.3432    0  284 -14844.511 41410.3432   379%     -  379s
     0     0 41410.3245    0  284 -14844.511 41410.3245   379%     -  381s
     0     0 38066.8232    0  346 -14844.511 38066.8232   356%     -  564s
H    0     0                    -6089.426996 38066.7857   725%     -  565s
H    0     0                    3433.0898545 38066.7857  1009%     -  565s
H    0     0                    13336.898846 38066.7857   185%     -  565s
H    0     0                    13434.080952 38066.7857   183%     -  565s
     0     0 37466.1131    0  372 13434.0810 37466.1131   179%     -  669s
     0     0 37073.3502    0  381 13434.0810 37073.3502   176%     -  733s
     0     0 37019.4744    0  392 13434.0810 37019.4744   176%     -  771s
     0     0 36951.4046    0  380 13434.0810 36951.4046   175%     -  805s
     0     0 36903.8747    0  384 13434.0810 36903.8747   175%     -  832s
     0     0 36839.5506    0  396 13434.0810 36839.5506   174%     -  866s
     0     0 36818.3648    0  388 13434.0810 36818.3648   174%     -  888s
     0     0 36806.2277    0  382 13434.0810 36806.2277   174%     -  904s
     0     0 36771.7695    0  392 13434.0810 36771.7695   174%     -  926s
     0     0 36576.4125    0  394 13434.0810 36576.4125   172%     -  965s
     0     0 36558.9164    0  390 13434.0810 36558.9164   172%     -  984s
     0     0 36537.3377    0  390 13434.0810 36537.3377   172%     -  996s
     0     0 36516.5500    0  385 13434.0810 36516.5500   172%     - 1006s
     0     0 36514.6367    0  391 13434.0810 36514.6367   172%     - 1013s
     0     0 36513.8401    0  386 13434.0810 36513.8401   172%     - 1016s
     0     0 34122.0758    0  422 13434.0810 34122.0758   154%     - 1240s
H    0     0                    14165.947712 34122.0500   141%     - 1242s
H    0     0                    14370.948782 34122.0500   137%     - 1243s
H    0     0                    14468.911551 34122.0500   136%     - 1243s
H    0     0                    14646.528837 34122.0500   133%     - 1244s
     0     0 33478.4104    0  444 14646.5288 33478.4104   129%     - 1349s
     0     0 33307.3902    0  443 14646.5288 33307.3902   127%     - 1402s
     0     0 33215.8781    0  461 14646.5288 33215.8781   127%     - 1472s
     0     0 33127.3794    0  454 14646.5288 33127.3794   126%     - 1528s
     0     0 33086.0934    0  458 14646.5288 33086.0934   126%     - 1556s
     0     0 32982.0573    0  476 14646.5288 32982.0573   125%     - 1590s
     0     0 32964.2075    0  463 14646.5288 32964.2075   125%     - 1610s
     0     0 32930.6295    0  469 14646.5288 32930.6295   125%     - 1637s
     0     0 32853.2864    0  461 14646.5288 32853.2864   124%     - 1677s
     0     0 32826.5037    0  466 14646.5288 32826.5037   124%     - 1693s
     0     0 32821.0494    0  464 14646.5288 32821.0494   124%     - 1703s
     0     0 32778.0119    0  472 14646.5288 32778.0119   124%     - 1720s
     0     0 32748.6045    0  467 14646.5288 32748.6045   124%     - 1742s
     0     0 32737.5781    0  465 14646.5288 32737.5781   124%     - 1759s
     0     0 32720.2566    0  465 14646.5288 32720.2566   123%     - 1775s
     0     0 32714.9502    0  465 14646.5288 32714.9502   123%     - 1784s
     0     0 32711.1752    0  465 14646.5288 32711.1752   123%     - 1789s
     0     0 32706.2210    0  473 14646.5288 32706.2210   123%     - 1799s
     0     0 32705.8259    0  471 14646.5288 32705.8259   123%     - 1804s
     0     0 31666.1072    0  434 14646.5288 31666.1072   116%     - 1930s
H    0     0                    14867.599491 31665.8565   113%     - 1932s
     0     0 31432.1680    0  427 14867.5995 31432.1680   111%     - 1976s
     0     0 31343.7059    0  437 14867.5995 31343.7059   111%     - 2001s
     0     0 31295.3257    0  448 14867.5995 31295.3257   110%     - 2026s
     0     0 31276.8856    0  439 14867.5995 31276.8856   110%     - 2039s
     0     0 31259.8083    0  420 14867.5995 31259.8083   110%     - 2052s
     0     0 31245.8764    0  445 14867.5995 31245.8764   110%     - 2059s
     0     0 31241.3572    0  449 14867.5995 31241.3572   110%     - 2064s
     0     0 31238.0646    0  448 14867.5995 31238.0646   110%     - 2069s
     0     0 31233.7626    0  453 14867.5995 31233.7626   110%     - 2074s
     0     0 31226.2440    0  441 14867.5995 31226.2440   110%     - 2080s
     0     0 31216.8835    0  442 14867.5995 31216.8835   110%     - 2089s
     0     0 31211.8364    0  443 14867.5995 31211.8364   110%     - 2096s
     0     0 31209.9169    0  446 14867.5995 31209.9169   110%     - 2099s
     0     0 31039.8821    0  440 14867.5995 31039.8821   109%     - 2142s
     0     0 31021.7012    0  446 14867.5995 31021.7012   109%     - 2155s
     0     0 31012.3932    0  441 14867.5995 31012.3932   109%     - 2163s
     0     0 31008.0838    0  442 14867.5995 31008.0838   109%     - 2170s
     0     0 31003.5672    0  446 14867.5995 31003.5672   109%     - 2175s
     0     0 30992.2409    0  447 14867.5995 30992.2409   108%     - 2189s
     0     0 30985.7434    0  454 14867.5995 30985.7434   108%     - 2198s
     0     0 30979.5832    0  450 14867.5995 30979.5832   108%     - 2208s
     0     0 30977.9755    0  446 14867.5995 30977.9755   108%     - 2213s
     0     0 30921.7146    0  470 14867.5995 30921.7146   108%     - 2237s
     0     0 30902.5566    0  476 14867.5995 30902.5566   108%     - 2250s
     0     0 30893.3475    0  462 14867.5995 30893.3475   108%     - 2259s
     0     0 30887.2205    0  476 14867.5995 30887.2205   108%     - 2268s
     0     0 30882.4985    0  469 14867.5995 30882.4985   108%     - 2275s
     0     0 30879.7788    0  471 14867.5995 30879.7788   108%     - 2281s
     0     0 30876.7371    0  467 14867.5995 30876.7371   108%     - 2291s
     0     0 30875.8176    0  474 14867.5995 30875.8176   108%     - 2293s
     0     0 30851.7515    0  462 14867.5995 30851.7515   108%     - 2320s
     0     0 30844.0239    0  520 14867.5995 30844.0239   107%     - 2339s
     0     0 30840.1467    0  521 14867.5995 30840.1467   107%     - 2348s
     0     0 30838.5698    0  522 14867.5995 30838.5698   107%     - 2354s
     0     0 30824.6644    0  446 14867.5995 30824.6644   107%     - 2373s
     0     0 30817.6549    0  448 14867.5995 30817.6549   107%     - 2387s
     0     0 30816.3806    0  446 14867.5995 30816.3806   107%     - 2393s
     0     0 30805.8472    0  450 14867.5995 30805.8472   107%     - 2407s
H    0     0                    14897.041376 30805.5612   107%     - 2409s
     0     0 30804.2151    0  450 14897.0414 30804.2151   107%     - 2413s
     0     0 30797.3968    0  443 14897.0414 30797.3968   107%     - 2425s
     0     0 30796.8257    0  447 14897.0414 30796.8257   107%     - 2427s
     0     0 30792.8225    0  450 14897.0414 30792.8225   107%     - 2435s
     0     0 30792.4885    0  450 14897.0414 30792.4885   107%     - 2452s
H    0     0                    15064.029197 30792.4885   104%     - 2759s
     0     2 30792.4885    0  450 15064.0292 30792.4885   104%     - 2765s
     1     3 30506.6995    1  413 15064.0292 30792.4885   104% 21406 2801s
     2     4 30586.3360    1  427 15064.0292 30586.3360   103% 15878 2821s
     3     6 30481.8453    2  427 15064.0292 30585.7043   103% 14318 2876s
     5     9 29349.2730    3  422 15064.0292 30585.7043   103% 18350 2917s
     8    17 29440.0836    3  413 15064.0292 30481.2431   102% 17153 2968s
    16    33 29053.6037    4  411 15064.0292 30353.9769   101% 16554 3026s
    32    48 28147.0542    5  388 15064.0292 30062.7612   100% 27632 3170s
H   47    77                    15130.297852 30062.7612  98.7% 32613 3268s
H   48    77                    15174.248874 30062.7612  98.1% 32487 3268s
H   49    77                    15196.773476 30062.7612  97.8% 32254 3268s
H   53    77                    15397.760709 30062.7612  95.2% 31738 3268s
H   62    77                    15587.962705 29916.2990  91.9% 30267 3268s
H   62    77                    15821.439620 29916.2990  89.1% 30267 3268s
H   68    77                    16134.925641 29916.2990  85.4% 29166 3268s
    76   168 28638.4394    8  322 16134.9256 29916.2990  85.4% 27844 3546s
   167   222 28521.7304   11  327 16134.9256 29916.2990  85.4% 19662 3600s
H  168   222                    16207.266342 29916.2990  84.6% 19545 3600s
H  170   222                    16308.321165 29916.2990  83.4% 19411 3600s
H  172   222                    16333.262758 29916.2990  83.2% 19258 3600s
H  177   222                    16515.537578 29916.2990  81.1% 18933 3600s
H  215   222                    16518.661901 29916.2990  81.1% 16571 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 287
  MIR: 5007
  Flow cover: 4924
  RLT: 99
  Relax-and-lift: 1131

Explored 221 nodes (4932547 simplex iterations) in 3600.08 seconds (7871.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16518.7 16515.5 16333.3 ... 15196.8

Time limit reached
Best objective 1.651866190123e+04, best bound 2.991629899603e+04, gap 81.1061%
  WARNING: Time limit reached. Using best solution found (gap: 81.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 16518.66, θ = 169450.66
  Upper Bound (UB) = 16518.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169450.66
  [DEBUG]   ✓ Scenario 0: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 169450.66 ≤ Q = 169450.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 26: θ = 169450.66 ≤ Q = 169450.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 27] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35524ad8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcaadb528
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.256103e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6854816.0082
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.394434e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139443.39    0  122 6854816.01 -139443.39   102%     -    0s
H    0     0                    -102744.4636 -139443.39  35.7%     -    0s
H    0     0                    -104304.2514 -139443.39  33.7%     -    0s
     0     0 -111247.13    0  100 -104304.25 -111247.13  6.66%     -    0s
H    0     0                    -108112.7816 -111147.13  2.81%     -    0s
H    0     0                    -108422.3757 -111147.13  2.51%     -    0s
H    0     0                    -109046.2873 -111147.13  1.93%     -    0s
H    0     0                    -109355.8814 -111147.13  1.64%     -    0s
     0     0 -110530.22    0  102 -109355.88 -110530.22  1.07%     -    0s
H    0     0                    -109405.4413 -110489.68  0.99%     -    0s
     0     0 -110489.68    0  102 -109405.44 -110489.68  0.99%     -    0s
     0     0 -110177.83    0  100 -109405.44 -110177.83  0.71%     -    0s
     0     0 -110144.58    0  102 -109405.44 -110144.58  0.68%     -    0s
     0     0 -110143.43    0  102 -109405.44 -110143.43  0.67%     -    0s
     0     0 -110010.26    0   98 -109405.44 -110010.26  0.55%     -    0s
     0     0 -110010.22    0   98 -109405.44 -110010.22  0.55%     -    0s
H    0     0                    -109731.0555 -110010.22  0.25%     -    0s
H    0     0                    -109765.0780 -110010.22  0.22%     -    0s
     0     2 -110004.79    0   81 -109765.08 -110004.79  0.22%     -    0s
*  133     0              21    -109767.1314 -109769.61  0.00%   7.6    0s

Cutting planes:
  Gomory: 36
  MIR: 190
  Flow cover: 3
  RLT: 5

Explored 147 nodes (1680 simplex iterations) in 0.08 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109767 -109765 -109731 ... 1.2561e+13
No other solutions better than -109767

Optimal solution found (tolerance 1.00e-06)
Best objective -1.097671314224e+05, best bound -1.097671314224e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 166671.18
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109767.13
  [DEBUG]   S×d_nominal = 276438.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276438.31 + -109767.13 = 166671.18
  [DEBUG]   Current θ from Master = 169450.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2779.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13739.18
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 728.0105, Absolute Gap = 728.0105, Relative Gap = 0.044072
  Not converged yet (gap = 728.01 > ε = 200)

  [DEBUG] Adding NEW scenario 27 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 27 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 27 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 27]
    [DEBUG]   - Total constraints in model: 429503
    [DEBUG]   - Total variables in model: 176980
  [DEBUG] Total scenarios in Master: 28
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 28
================================================================================
[Iteration 28] Solving Master Problem...
  Current scenarios in Master: 28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 429503 rows, 176980 columns and 1216659 nonzeros
Model fingerprint: 0xb0a771b2
Variable types: 174721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 175336 rows and 71176 columns (presolve time = 5s)...
Presolve removed 175336 rows and 71176 columns
Presolve time: 5.40s
Presolved: 254167 rows, 105804 columns, 1562478 nonzeros
Variable types: 103545 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.55s

Barrier statistics:
 Dense cols : 1263
 AA' NZ     : 6.901e+06
 Factor NZ  : 2.003e+07 (roughly 300 MB of memory)
 Factor Ops : 8.306e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.63759723e+07  3.95741698e+08  1.83e+05 1.60e+01  1.15e+05    10s
   1  -2.15633741e+07  3.72700808e+08  1.36e+05 7.67e+01  8.51e+04    11s
   2  -8.80680131e+06  3.05169826e+08  5.48e+04 8.87e+00  3.63e+04    11s
   3  -1.97583374e+06  2.74567613e+08  8.72e+03 1.21e+00  6.22e+03    11s
   4  -7.57091622e+05  1.83839328e+08  1.13e+03 2.44e-01  1.09e+03    11s
   5  -6.32605513e+05  1.08437994e+08  5.98e+02 1.19e-01  5.71e+02    11s
   6  -5.16499219e+05  8.23614385e+07  2.63e+02 8.36e-02  3.20e+02    11s
   7  -4.54833059e+05  6.48358498e+07  1.05e+02 6.28e-02  1.94e+02    11s
   8  -4.01514195e+05  4.60050668e+07  2.56e+01 4.26e-02  1.12e+02    11s
   9  -3.29059258e+05  2.51423917e+07  8.45e+00 2.26e-02  5.77e+01    11s
  10  -2.39956635e+05  1.57310534e+07  3.14e+00 1.37e-02  3.52e+01    11s
  11  -1.72852401e+05  8.07748760e+06  2.08e+00 6.81e-03  1.81e+01    11s
  12  -1.26414377e+05  6.91832136e+06  1.23e+00 5.79e-03  1.54e+01    12s
  13  -1.17714871e+05  5.85588210e+06  8.78e-01 4.90e-03  1.30e+01    12s
  14  -9.50214982e+04  4.40512529e+06  4.93e-01 3.77e-03  9.78e+00    12s
  15  -6.70826119e+04  2.40416724e+06  1.48e-01 2.01e-03  5.36e+00    12s
  16  -3.95110524e+04  1.45585529e+06  5.24e-02 1.23e-03  3.24e+00    12s
  17  -2.66409797e+04  3.74133486e+05  3.40e-02 6.78e-04  8.68e-01    12s
  18  -7.57506217e+03  2.64320893e+05  2.03e-02 1.67e-03  5.89e-01    12s
  19  -4.60507388e+03  2.36991546e+05  1.86e-02 1.45e-03  5.23e-01    12s
  20   4.69202574e+03  1.74686193e+05  1.37e-02 1.35e-03  3.68e-01    12s
  21   9.75865135e+03  1.51248231e+05  1.19e-02 1.09e-03  3.07e-01    12s
  22   1.78276352e+04  1.33526186e+05  9.11e-03 9.02e-04  2.51e-01    12s
  23   1.96443399e+04  1.26729966e+05  8.50e-03 8.37e-04  2.32e-01    13s
  24   2.16494532e+04  1.17859537e+05  7.79e-03 7.47e-04  2.08e-01    13s
  25   2.37805258e+04  1.02394523e+05  7.06e-03 5.84e-04  1.70e-01    13s
  26   2.76644583e+04  8.88975996e+04  5.74e-03 4.47e-04  1.33e-01    13s
  27   3.00643365e+04  8.08255849e+04  4.97e-03 3.66e-04  1.10e-01    13s
  28   3.23593400e+04  7.54146879e+04  4.26e-03 3.12e-04  9.33e-02    13s
  29   3.44052663e+04  7.10113887e+04  3.64e-03 2.67e-04  7.93e-02    13s
  30   3.62119681e+04  6.57297299e+04  3.10e-03 2.12e-04  6.39e-02    14s
  31   3.84867167e+04  6.20851901e+04  2.45e-03 1.70e-04  5.11e-02    14s
  32   3.98202465e+04  6.03614106e+04  2.09e-03 1.50e-04  4.45e-02    14s
  33   4.05240587e+04  5.93264949e+04  1.91e-03 1.38e-04  4.07e-02    14s
  34   4.18783379e+04  5.72726289e+04  1.55e-03 1.13e-04  3.33e-02    14s
  35   4.31212661e+04  5.52047575e+04  1.24e-03 8.76e-05  2.62e-02    14s
  36   4.39610688e+04  5.33718886e+04  1.04e-03 6.48e-05  2.04e-02    15s
  37   4.50576992e+04  5.26016897e+04  7.95e-04 5.26e-05  1.63e-02    15s
  38   4.52391051e+04  5.17896033e+04  7.52e-04 4.20e-05  1.42e-02    15s
  39   4.60587722e+04  5.16159741e+04  5.76e-04 3.98e-05  1.20e-02    15s
  40   4.66481253e+04  5.06493127e+04  4.50e-04 2.59e-05  8.67e-03    15s
  41   4.72318814e+04  5.02646424e+04  3.23e-04 2.05e-05  6.57e-03    15s
  42   4.74729185e+04  4.98987097e+04  2.72e-04 1.52e-05  5.26e-03    15s
  43   4.77067617e+04  4.97419879e+04  2.24e-04 1.30e-05  4.41e-03    16s
  44   4.80278921e+04  4.96872478e+04  1.59e-04 1.22e-05  3.59e-03    16s
  45   4.81644853e+04  4.93566627e+04  1.30e-04 8.27e-06  2.58e-03    16s
  46   4.83545738e+04  4.92168539e+04  9.03e-05 6.10e-06  1.87e-03    16s
  47   4.84087114e+04  4.91410519e+04  7.97e-05 5.11e-06  1.59e-03    16s
  48   4.85141517e+04  4.90421663e+04  5.81e-05 9.21e-06  1.14e-03    16s
  49   4.85390890e+04  4.90185867e+04  5.31e-05 8.42e-06  1.04e-03    17s
  50   4.86072376e+04  4.89624957e+04  3.91e-05 7.62e-06  7.70e-04    17s
  51   4.86189429e+04  4.89604836e+04  3.68e-05 7.52e-06  7.40e-04    17s
  52   4.86605043e+04  4.88954073e+04  2.84e-05 4.62e-06  5.09e-04    17s
  53   4.87264051e+04  4.88722006e+04  1.62e-05 3.29e-06  3.16e-04    17s
  54   4.87435979e+04  4.88621277e+04  1.31e-05 2.69e-06  2.57e-04    17s
  55   4.87769677e+04  4.88573848e+04  6.85e-06 2.43e-06  1.74e-04    18s
  56   4.87910976e+04  4.88430681e+04  4.27e-06 1.55e-06  1.13e-04    18s
  57   4.88041962e+04  4.88233884e+04  1.91e-06 4.37e-07  4.16e-05    18s
  58   4.88104029e+04  4.88199546e+04  8.07e-07 2.37e-07  2.07e-05    18s
  59   4.88149724e+04  4.88161850e+04  9.42e-08 9.10e-08  2.63e-06    18s
  60   4.88150108e+04  4.88161617e+04  3.13e-07 8.77e-08  2.49e-06    18s
  61   4.88155864e+04  4.88157836e+04  6.27e-08 9.30e-09  4.27e-07    19s
  62   4.88155945e+04  4.88157816e+04  7.00e-07 1.10e-08  4.06e-07    19s
  63   4.88157458e+04  4.88157475e+04  1.08e-08 3.04e-08  3.68e-09    19s
  64   4.88157464e+04  4.88157469e+04  1.38e-07 9.10e-08  9.77e-10    19s

Barrier solved model in 64 iterations and 18.92 seconds (34.54 work units)
Optimal objective 4.88157464e+04


Root crossover log...

  217154 DPushes remaining with DInf 0.0000000e+00                19s
  118442 DPushes remaining with DInf 0.0000000e+00                20s
   65339 DPushes remaining with DInf 0.0000000e+00                25s
   35517 DPushes remaining with DInf 0.0000000e+00                30s
    1881 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                37s

   48856 PPushes remaining with PInf 3.5458545e-04                37s
   12488 PPushes remaining with PInf 2.0268942e-04                40s
       0 PPushes remaining with PInf 0.0000000e+00                42s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3100570e+05     42s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  164582    4.8815747e+04   0.000000e+00   3.310057e+05     43s
  165937    4.8815747e+04   0.000000e+00   4.174395e-01     45s
  165996    4.8815747e+04   0.000000e+00   0.000000e+00     45s
  165996    4.8815747e+04   0.000000e+00   0.000000e+00     46s
Concurrent spin time: 11.25s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.881575e+04, 165996 iterations, 50.00 seconds (96.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48815.7469    0  278 -233202.98 48815.7469   121%     -   58s
H    0     0                    -147275.7949 48815.7469   133%     -   59s
H    0     0                    -139794.1445 48815.7469   135%     -   60s
H    0     0                    -138631.4561 48815.7469   135%     -   61s
H    0     0                    -137948.4121 48815.7469   135%     -   62s
H    0     0                    -137538.0543 48815.7469   135%     -   63s
H    0     0                    -137053.2651 48815.7469   136%     -   63s
H    0     0                    -82453.99075 48815.7469   159%     -   63s
H    0     0                    -81597.86112 48815.7469   160%     -   63s
H    0     0                    -69014.99085 48815.7469   171%     -   63s
H    0     0                    -68969.35321 48815.7469   171%     -   63s
     0     0 41901.8152    0  310 -68969.353 41901.8152   161%     -  232s
H    0     0                    -32378.64758 41901.1159   229%     -  235s
H    0     0                    -32036.28967 41901.1159   231%     -  235s
H    0     0                    5006.9744123 41901.1159   737%     -  235s
     0     0 41246.4620    0  317 5006.97441 41246.4620   724%     -  301s
     0     0 41076.1993    0  329 5006.97441 41076.1993   720%     -  360s
     0     0 41026.1700    0  327 5006.97441 41026.1700   719%     -  381s
     0     0 40954.5711    0  323 5006.97441 40954.5711   718%     -  407s
     0     0 40935.8235    0  320 5006.97441 40935.8235   718%     -  423s
     0     0 40917.7179    0  319 5006.97441 40917.7179   717%     -  454s
     0     0 40901.2071    0  307 5006.97441 40901.2071   717%     -  468s
     0     0 40882.5507    0  316 5006.97441 40882.5507   717%     -  484s
     0     0 40861.9466    0  307 5006.97441 40861.9466   716%     -  502s
     0     0 40859.4885    0  297 5006.97441 40859.4885   716%     -  506s
     0     0 40858.9328    0  302 5006.97441 40858.9328   716%     -  509s
     0     0 37800.8051    0  408 5006.97441 37800.8051   655%     -  700s
H    0     0                    6067.9617815 37800.6299   523%     -  702s
H    0     0                    12045.797766 37800.6299   214%     -  704s
H    0     0                    12359.035080 37800.6299   206%     -  704s
H    0     0                    12478.921256 37800.6299   203%     -  705s
H    0     0                    12625.753133 37800.6299   199%     -  705s
H    0     0                    12927.075302 37800.6299   192%     -  705s
H    0     0                    12978.935126 37800.6299   191%     -  705s
H    0     0                    13494.455133 37800.6299   180%     -  705s
H    0     0                    13597.315725 37800.6299   178%     -  705s
H    0     0                    13680.895393 37800.6299   176%     -  705s
     0     0 37508.0154    0  404 13680.8954 37508.0154   174%     -  785s
     0     0 37405.6427    0  400 13680.8954 37405.6427   173%     -  832s
     0     0 37182.9768    0  400 13680.8954 37182.9768   172%     -  900s
     0     0 36879.0429    0  451 13680.8954 36879.0429   170%     -  977s
     0     0 36814.7247    0  445 13680.8954 36814.7247   169%     - 1016s
     0     0 36765.2967    0  440 13680.8954 36765.2967   169%     - 1052s
     0     0 36747.5883    0  442 13680.8954 36747.5883   169%     - 1084s
     0     0 36744.0448    0  444 13680.8954 36744.0448   169%     - 1093s
     0     0 36689.4719    0  438 13680.8954 36689.4719   168%     - 1148s
     0     0 36611.9175    0  465 13680.8954 36611.9175   168%     - 1183s
     0     0 36568.9809    0  477 13680.8954 36568.9809   167%     - 1242s
     0     0 36557.2018    0  465 13680.8954 36557.2018   167%     - 1258s
     0     0 36552.3447    0  466 13680.8954 36552.3447   167%     - 1268s
     0     0 36544.0540    0  467 13680.8954 36544.0540   167%     - 1279s
     0     0 36542.7114    0  468 13680.8954 36542.7114   167%     - 1285s
     0     0 34184.0485    0  426 13680.8954 34184.0485   150%     - 1537s
H    0     0                    14094.221856 34183.8762   143%     - 1539s
H    0     0                    14206.462784 34183.8762   141%     - 1539s
H    0     0                    14251.065422 34183.8762   140%     - 1539s
H    0     0                    14262.512392 34183.8762   140%     - 1539s
     0     0 33701.5730    0  444 14262.5124 33701.5730   136%     - 1655s
     0     0 33571.7417    0  441 14262.5124 33571.7417   135%     - 1707s
     0     0 33469.9757    0  468 14262.5124 33469.9757   135%     - 1744s
     0     0 33292.7315    0  399 14262.5124 33292.7315   133%     - 1817s
     0     0 33175.5231    0  422 14262.5124 33175.5231   133%     - 1856s
     0     0 33149.3368    0  417 14262.5124 33149.3368   132%     - 1883s
     0     0 33118.9193    0  409 14262.5124 33118.9193   132%     - 1904s
     0     0 32952.1350    0  417 14262.5124 32952.1350   131%     - 1956s
     0     0 32900.0092    0  416 14262.5124 32900.0092   131%     - 1989s
     0     0 32798.6501    0  415 14262.5124 32798.6501   130%     - 2027s
     0     0 32779.8383    0  422 14262.5124 32779.8383   130%     - 2044s
     0     0 32769.2070    0  430 14262.5124 32769.2070   130%     - 2064s
     0     0 32746.5698    0  425 14262.5124 32746.5698   130%     - 2089s
     0     0 32741.9662    0  432 14262.5124 32741.9662   130%     - 2108s
     0     0 32717.2775    0  428 14262.5124 32717.2775   129%     - 2129s
     0     0 32709.3372    0  424 14262.5124 32709.3372   129%     - 2141s
     0     0 32706.9895    0  423 14262.5124 32706.9895   129%     - 2149s
     0     0 32683.2011    0  434 14262.5124 32683.2011   129%     - 2171s
     0     0 32680.0935    0  435 14262.5124 32680.0935   129%     - 2179s
     0     0 32655.7509    0  439 14262.5124 32655.7509   129%     - 2194s
     0     0 32654.3745    0  438 14262.5124 32654.3745   129%     - 2199s
     0     0 31812.4004    0  411 14262.5124 31812.4004   123%     - 2365s
     0     0 31597.0858    0  414 14262.5124 31597.0858   122%     - 2438s
     0     0 31530.1854    0  445 14262.5124 31530.1854   121%     - 2476s
     0     0 31493.5774    0  441 14262.5124 31493.5774   121%     - 2504s
     0     0 31473.4645    0  443 14262.5124 31473.4645   121%     - 2529s
     0     0 31450.8971    0  438 14262.5124 31450.8971   121%     - 2557s
     0     0 31425.4086    0  444 14262.5124 31425.4086   120%     - 2579s
     0     0 31411.3749    0  442 14262.5124 31411.3749   120%     - 2594s
     0     0 31401.8636    0  450 14262.5124 31401.8636   120%     - 2612s
     0     0 31400.4360    0  457 14262.5124 31400.4360   120%     - 2618s
     0     0 31229.0831    0  448 14262.5124 31229.0831   119%     - 2684s
     0     0 31173.7004    0  454 14262.5124 31173.7004   119%     - 2720s
     0     0 31151.1149    0  459 14262.5124 31151.1149   118%     - 2739s
     0     0 31139.0246    0  472 14262.5124 31139.0246   118%     - 2754s
     0     0 31117.7501    0  520 14262.5124 31117.7501   118%     - 2780s
     0     0 31104.8278    0  535 14262.5124 31104.8278   118%     - 2798s
     0     0 31094.0709    0  529 14262.5124 31094.0709   118%     - 2818s
     0     0 31087.3430    0  476 14262.5124 31087.3430   118%     - 2834s
     0     0 31078.8316    0  474 14262.5124 31078.8316   118%     - 2849s
     0     0 31077.8054    0  475 14262.5124 31077.8054   118%     - 2854s
     0     0 31025.5624    0  513 14262.5124 31025.5624   118%     - 2890s
H    0     0                    15327.868028 31025.2969   102%     - 2921s
     0     0 31006.9876    0  515 15327.8680 31006.9876   102%     - 2953s
     0     0 31003.1760    0  514 15327.8680 31003.1760   102%     - 2963s
     0     0 30980.9883    0  515 15327.8680 30980.9883   102%     - 2982s
     0     0 30976.1067    0  512 15327.8680 30976.1067   102%     - 2992s
     0     0 30973.1680    0  510 15327.8680 30973.1680   102%     - 3000s
     0     0 30971.3437    0  506 15327.8680 30971.3437   102%     - 3008s
     0     0 30937.5551    0  549 15327.8680 30937.5551   102%     - 3044s
     0     0 30926.6562    0  483 15327.8680 30926.6562   102%     - 3062s
     0     0 30923.9327    0  536 15327.8680 30923.9327   102%     - 3071s
     0     0 30922.1314    0  571 15327.8680 30922.1314   102%     - 3077s
     0     0 30912.8458    0  521 15327.8680 30912.8458   102%     - 3094s
H    0     0                    15356.303122 30912.7970   101%     - 3103s
H    0     0                    15372.758670 30912.7970   101%     - 3108s
H    0     0                    15664.296525 30912.7970  97.3%     - 3108s
     0     0 30903.3571    0  522 15664.2965 30903.3571  97.3%     - 3123s
     0     0 30900.9682    0  532 15664.2965 30900.9682  97.3%     - 3131s
     0     0 30883.1028    0  526 15664.2965 30883.1028  97.2%     - 3155s
H    0     0                    15739.575508 30883.0152  96.2%     - 3157s
     0     0 30877.6973    0  544 15739.5755 30877.6973  96.2%     - 3167s
     0     0 30875.3888    0  537 15739.5755 30875.3888  96.2%     - 3175s
     0     0 30867.3155    0  486 15739.5755 30867.3155  96.1%     - 3189s
H    0     0                    15762.087811 30867.1992  95.8%     - 3253s
H    0     0                    15782.506142 30867.1992  95.6%     - 3257s
H    0     0                    15987.965357 30867.1992  93.1%     - 3257s
H    0     0                    15997.356573 30867.1992  93.0%     - 3257s
H    0     0                    16225.436897 30867.1992  90.2%     - 3257s
H    0     0                    16421.737779 30867.1992  88.0%     - 3260s
H    0     0                    16616.594788 30867.1992  85.8%     - 3262s
     0     0 30866.0857    0  490 16616.5948 30866.0857  85.8%     - 3265s
     0     0 30862.0437    0  529 16616.5948 30862.0437  85.7%     - 3276s
     0     0 30861.3152    0  534 16616.5948 30861.3152  85.7%     - 3282s
     0     0 30854.5545    0  482 16616.5948 30854.5545  85.7%     - 3298s
     0     0 30854.5075    0  482 16616.5948 30854.5075  85.7%     - 3322s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 299
  MIR: 3263
  Flow cover: 2234
  RLT: 75
  Relax-and-lift: 732

Explored 1 nodes (1537455 simplex iterations) in 3600.04 seconds (7151.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16616.6 16421.7 16225.4 ... 15372.8

Time limit reached
Best objective 1.661659478781e+04, best bound 3.085450754320e+04, gap 85.6849%
  WARNING: Time limit reached. Using best solution found (gap: 85.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 16616.59, θ = 168798.05
  Upper Bound (UB) = 16616.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168798.05
  [DEBUG]   ✓ Scenario 0: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 168798.05 ≤ Q = 168798.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 27: θ = 168798.05 ≤ Q = 168798.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 28] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x851d5f1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0851d5f1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.255896e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.00s
Presolved: 541 rows, 545 columns, 1529 nonzeros
Found heuristic solution: objective 6880527.4586
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.403104e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140310.38    0  123 6880527.46 -140310.38   102%     -    0s
H    0     0                    -103744.1519 -140310.38  35.2%     -    0s
H    0     0                    -105242.2417 -140310.38  33.3%     -    0s
     0     0 -112697.07    0   68 -105242.24 -112697.07  7.08%     -    0s
H    0     0                    -109890.0602 -112554.94  2.43%     -    0s
     0     0 -112000.82    0   67 -109890.06 -112000.82  1.92%     -    0s
H    0     0                    -110917.4899 -111922.20  0.91%     -    0s
     0     0 -111498.55    0   69 -110917.49 -111498.55  0.52%     -    0s
     0     0 -111438.22    0   69 -110917.49 -111438.22  0.47%     -    0s
     0     0 -111437.34    0   69 -110917.49 -111437.34  0.47%     -    0s
     0     0 -111099.16    0    9 -110917.49 -111099.16  0.16%     -    0s
     0     0 -111077.58    0    8 -110917.49 -111077.58  0.14%     -    0s
H    0     0                    -110934.1860 -111077.58  0.13%     -    0s
     0     0 -110980.55    0    5 -110934.19 -110980.55  0.04%     -    0s
     0     0 -110968.50    0    5 -110934.19 -110968.50  0.03%     -    0s
     0     0 -110966.04    0   10 -110934.19 -110966.04  0.03%     -    0s
H    0     0                    -110944.5021 -110966.04  0.02%     -    0s
     0     0     cutoff    0      -110944.50 -110944.50  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 5
  Flow cover: 7
  RLT: 2
  PSD: 1

Explored 1 nodes (669 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -110945 -110945 -110934 ... 1.2559e+13
No other solutions better than -110945

Optimal solution found (tolerance 1.00e-06)
Best objective -1.109445021093e+05, best bound -1.109445021093e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 165756.81
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110944.50
  [DEBUG]   S×d_nominal = 276701.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276701.31 + -110944.50 = 165756.81
  [DEBUG]   Current θ from Master = 168798.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3041.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13575.36
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = 825.9434, Absolute Gap = 825.9434, Relative Gap = 0.049706
  Not converged yet (gap = 825.94 > ε = 200)

  [DEBUG] Adding NEW scenario 28 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 28 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 28 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 28]
    [DEBUG]   - Total constraints in model: 444793
    [DEBUG]   - Total variables in model: 183220
  [DEBUG] Total scenarios in Master: 29
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 29
================================================================================
[Iteration 29] Solving Master Problem...
  Current scenarios in Master: 29
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 444793 rows, 183220 columns and 1259914 nonzeros
Model fingerprint: 0xb641c6ea
Variable types: 180961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 181598 rows and 73718 columns (presolve time = 5s)...
Presolve removed 181598 rows and 73718 columns
Presolve time: 5.73s
Presolved: 263195 rows, 109502 columns, 1617971 nonzeros
Variable types: 107243 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353223.2581
Found heuristic solution: objective -233202.9823

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.63s

Barrier statistics:
 Dense cols : 1278
 AA' NZ     : 7.090e+06
 Factor NZ  : 2.065e+07 (roughly 300 MB of memory)
 Factor Ops : 8.946e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.70702635e+07  4.07805391e+08  1.87e+05 1.58e+01  1.18e+05    11s
   1  -2.21624187e+07  3.85450237e+08  1.40e+05 7.53e+01  8.71e+04    11s
   2  -9.26763129e+06  3.15381738e+08  5.77e+04 2.23e+00  3.83e+04    11s
   3  -7.47316229e+06  3.14977254e+08  4.63e+04 2.14e+00  3.09e+04    11s
   4  -2.61590555e+06  2.93059969e+08  1.13e+04 5.23e+00  8.09e+03    11s
   5  -1.02830280e+06  2.03076365e+08  1.86e+03 1.53e+00  1.59e+03    11s
   6  -8.02777994e+05  1.37625278e+08  5.98e+02 8.53e-01  6.43e+02    12s
   7  -5.45701243e+05  9.37297352e+07  3.77e+02 4.86e-01  4.06e+02    12s
   8  -4.97297594e+05  6.67272501e+07  2.51e+02 1.13e-01  2.70e+02    12s
   9  -4.30677339e+05  4.20288680e+07  9.72e+01 6.19e-02  1.33e+02    12s
  10  -3.14358809e+05  2.94036964e+07  1.33e+01 3.96e-02  6.74e+01    12s
  11  -2.54490054e+05  1.90294208e+07  7.72e+00 2.47e-02  4.25e+01    12s
  12  -1.72662374e+05  1.63840582e+07  3.65e+00 2.11e-02  3.55e+01    12s
  13  -1.46244026e+05  1.21661026e+07  2.61e+00 1.56e-02  2.62e+01    12s
  14  -1.31525890e+05  6.94817146e+06  1.97e+00 8.81e-03  1.50e+01    12s
  15  -1.16838784e+05  5.35352177e+06  1.35e+00 6.73e-03  1.16e+01    12s
  16  -8.55018083e+04  3.21600467e+06  5.23e-01 4.03e-03  6.94e+00    13s
  17  -5.27615978e+04  7.79056603e+05  1.61e-01 9.18e-04  1.74e+00    13s
  18  -3.35326958e+04  3.25336160e+05  9.74e-02 5.50e-04  7.52e-01    13s
  19  -2.21237993e+04  2.75217266e+05  7.51e-02 4.21e-04  6.23e-01    13s
  20  -6.44132773e+03  2.19434067e+05  5.21e-02 1.10e-03  4.73e-01    13s
  21   1.58241293e+03  1.65734157e+05  4.29e-02 1.05e-03  3.44e-01    13s
  22   6.28079464e+03  1.24509929e+05  3.82e-02 8.64e-04  2.48e-01    13s
  23   1.37415002e+04  1.07700642e+05  3.14e-02 6.49e-04  1.97e-01    13s
  24   2.02274226e+04  9.66000048e+04  2.55e-02 7.31e-04  1.60e-01    13s
  25   2.49824237e+04  8.83958043e+04  2.09e-02 6.06e-04  1.33e-01    14s
  26   2.81609446e+04  7.68262915e+04  1.77e-02 4.34e-04  1.02e-01    14s
  27   3.02244794e+04  7.25811037e+04  1.57e-02 4.03e-04  8.87e-02    14s
  28   3.26596468e+04  6.85328149e+04  1.33e-02 8.67e-04  7.51e-02    14s
  29   3.41873693e+04  6.35135697e+04  1.18e-02 6.65e-04  6.14e-02    14s
  30   3.68695432e+04  6.10812039e+04  9.33e-03 6.02e-04  5.07e-02    14s
  31   3.79521040e+04  5.87940072e+04  8.38e-03 4.97e-04  4.36e-02    14s
  32   3.89728883e+04  5.76046415e+04  7.52e-03 4.55e-04  3.90e-02    15s
  33   4.06127662e+04  5.59712920e+04  6.18e-03 3.47e-04  3.22e-02    15s
  34   4.17939272e+04  5.38550007e+04  5.23e-03 2.78e-04  2.53e-02    15s
  35   4.28782611e+04  5.29948210e+04  4.38e-03 2.95e-04  2.12e-02    15s
  36   4.42238176e+04  5.24269499e+04  3.32e-03 2.56e-04  1.72e-02    15s
  37   4.46104900e+04  5.19678635e+04  3.01e-03 2.25e-04  1.54e-02    15s
  38   4.50431349e+04  5.16949108e+04  2.69e-03 2.08e-04  1.39e-02    16s
  39   4.57225285e+04  5.11913259e+04  2.18e-03 1.74e-04  1.15e-02    16s
  40   4.62713494e+04  5.07522167e+04  1.76e-03 1.42e-04  9.38e-03    16s
  41   4.68294108e+04  5.03972283e+04  1.36e-03 1.09e-04  7.47e-03    16s
  42   4.73954759e+04  5.00813448e+04  9.54e-04 8.63e-05  5.62e-03    16s
  43   4.74834897e+04  4.96530485e+04  8.87e-04 5.98e-05  4.54e-03    16s
  44   4.78204656e+04  4.94358710e+04  6.55e-04 5.64e-05  3.38e-03    17s
  45   4.78668518e+04  4.94006962e+04  6.24e-04 5.32e-05  3.21e-03    17s
  46   4.80896500e+04  4.92397979e+04  4.77e-04 3.83e-05  2.41e-03    17s
  47   4.82474207e+04  4.91350705e+04  3.69e-04 2.66e-05  1.86e-03    17s
  48   4.83845094e+04  4.90370772e+04  2.71e-04 1.83e-05  1.37e-03    17s
  49   4.85362276e+04  4.89398602e+04  1.69e-04 1.13e-05  8.45e-04    17s
  50   4.85684978e+04  4.89053528e+04  1.50e-04 9.17e-06  7.05e-04    18s
  51   4.85857315e+04  4.88919200e+04  1.40e-04 7.47e-06  6.41e-04    18s
  52   4.86559474e+04  4.88798969e+04  9.51e-05 6.34e-06  4.69e-04    18s
  53   4.87080737e+04  4.88498358e+04  6.29e-05 5.62e-06  2.97e-04    18s
  54   4.87383671e+04  4.88380093e+04  4.46e-05 5.01e-06  2.09e-04    18s
  55   4.87737435e+04  4.88264598e+04  2.37e-05 7.71e-06  1.10e-04    18s
  56   4.87909180e+04  4.88209461e+04  1.38e-05 3.49e-06  6.29e-05    18s
  57   4.87917698e+04  4.88198548e+04  1.33e-05 2.67e-06  5.88e-05    19s
  58   4.87984944e+04  4.88173855e+04  9.64e-06 7.67e-07  3.96e-05    19s
  59   4.88138124e+04  4.88166502e+04  9.60e-07 8.99e-07  5.94e-06    19s
  60   4.88154653e+04  4.88161915e+04  2.39e-07 3.14e-07  1.52e-06    19s
  61   4.88160123e+04  4.88160383e+04  9.12e-09 1.19e-08  5.45e-08    19s
  62   4.88160279e+04  4.88160290e+04  2.96e-08 1.52e-09  2.37e-09    19s
  63   4.88160279e+04  4.88160290e+04  6.18e-06 9.56e-08  2.25e-09    19s
  64   4.88160288e+04  4.88160290e+04  9.89e-07 9.30e-08  3.60e-10    19s

Barrier solved model in 64 iterations and 19.46 seconds (33.58 work units)
Optimal objective 4.88160288e+04


Root crossover log...

  224538 DPushes remaining with DInf 0.0000000e+00                20s
  131245 DPushes remaining with DInf 0.0000000e+00                22s
  107823 DPushes remaining with DInf 0.0000000e+00                25s
   79102 DPushes remaining with DInf 0.0000000e+00                30s
   53360 DPushes remaining with DInf 0.0000000e+00                35s
   34762 DPushes remaining with DInf 0.0000000e+00                40s
   11100 DPushes remaining with DInf 0.0000000e+00                45s
    3628 DPushes remaining with DInf 0.0000000e+00                50s
       0 DPushes remaining with DInf 0.0000000e+00                55s

   19590 PPushes remaining with PInf 2.8045677e-04                55s
       0 PPushes remaining with PInf 0.0000000e+00                59s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6912433e+04     59s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  126415    4.8816027e+04   0.000000e+00   3.691243e+04     59s
  126965    4.8816027e+04   0.000000e+00   8.455147e-01     60s
  127127    4.8816029e+04   0.000000e+00   0.000000e+00     61s
  127127    4.8816029e+04   0.000000e+00   0.000000e+00     61s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.881603e+04, 127127 iterations, 53.89 seconds (91.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48816.0290    0  284 -233202.98 48816.0290   121%     -   62s
H    0     0                    -155888.3940 48816.0290   131%     -   64s
H    0     0                    -155730.8533 48816.0290   131%     -   65s
H    0     0                    -155473.6787 48816.0290   131%     -   65s
H    0     0                    -129722.3131 48816.0290   138%     -   66s
H    0     0                    -125652.8514 48816.0290   139%     -   67s
H    0     0                    -82453.99075 48816.0290   159%     -   68s
H    0     0                    -81597.86112 48816.0290   160%     -   68s
H    0     0                    -69014.99085 48816.0290   171%     -   68s
H    0     0                    -68969.35321 48816.0290   171%     -   68s
     0     0 41889.4012    0  316 -68969.353 41889.4012   161%     -  299s
H    0     0                    -54681.36782 41889.2753   177%     -  299s
H    0     0                    -33517.79457 41889.2753   225%     -  301s
H    0     0                    -17178.73400 41889.2753   344%     -  301s
H    0     0                    -4843.935297 41889.2753   965%     -  302s
H    0     0                    -2063.082529 41889.2753  2130%     -  304s
H    0     0                    -1945.075466 41889.2753  2254%     -  304s
H    0     0                    -1807.629631 41889.2753  2417%     -  304s
     0     0 41373.6373    0  322 -1807.6296 41373.6373  2389%     -  396s
     0     0 41282.7831    0  325 -1807.6296 41282.7831  2384%     -  425s
     0     0 41086.8829    0  326 -1807.6296 41086.8829  2373%     -  475s
     0     0 40988.9560    0  332 -1807.6296 40988.9560  2368%     -  514s
     0     0 40976.6384    0  333 -1807.6296 40976.6384  2367%     -  533s
     0     0 40974.5398    0  324 -1807.6296 40974.5398  2367%     -  545s
     0     0 40965.4295    0  325 -1807.6296 40965.4295  2366%     -  556s
     0     0 40870.4996    0  317 -1807.6296 40870.4996  2361%     -  595s
     0     0 40869.1194    0  321 -1807.6296 40869.1194  2361%     -  610s
     0     0 40832.2315    0  317 -1807.6296 40832.2315  2359%     -  638s
     0     0 40806.6799    0  369 -1807.6296 40806.6799  2357%     -  664s
     0     0 40795.8013    0  371 -1807.6296 40795.8013  2357%     -  679s
     0     0 40791.1216    0  376 -1807.6296 40791.1216  2357%     -  688s
     0     0 40790.6292    0  375 -1807.6296 40790.6292  2357%     -  692s
     0     0 37528.7468    0  364 -1807.6296 37528.7468  2176%     -  942s
H    0     0                    -1407.314479 37528.6663  2767%     -  946s
H    0     0                    11428.324516 37528.6663   228%     -  946s
H    0     0                    12172.582439 37528.6663   208%     -  946s
H    0     0                    12373.417410 37528.6663   203%     -  946s
     0     0 37112.9226    0  385 12373.4174 37112.9226   200%     - 1093s
     0     0 37018.7921    0  376 12373.4174 37018.7921   199%     - 1144s
     0     0 36503.6108    0  391 12373.4174 36503.6108   195%     - 1250s
     0     0 36428.9871    0  396 12373.4174 36428.9871   194%     - 1284s
     0     0 36336.0349    0  396 12373.4174 36336.0349   194%     - 1340s
     0     0 36257.4415    0  405 12373.4174 36257.4415   193%     - 1385s
     0     0 36068.3052    0  407 12373.4174 36068.3052   191%     - 1444s
     0     0 36036.0918    0  424 12373.4174 36036.0918   191%     - 1470s
     0     0 36008.1875    0  414 12373.4174 36008.1875   191%     - 1496s
     0     0 35975.6623    0  421 12373.4174 35975.6623   191%     - 1525s
     0     0 35960.7097    0  415 12373.4174 35960.7097   191%     - 1539s
     0     0 35942.6322    0  415 12373.4174 35942.6322   190%     - 1560s
     0     0 35934.1313    0  417 12373.4174 35934.1313   190%     - 1573s
     0     0 35867.9530    0  422 12373.4174 35867.9530   190%     - 1603s
     0     0 35856.0955    0  423 12373.4174 35856.0955   190%     - 1617s
     0     0 35840.4645    0  428 12373.4174 35840.4645   190%     - 1631s
     0     0 35838.8643    0  425 12373.4174 35838.8643   190%     - 1647s
     0     0 35838.5891    0  431 12373.4174 35838.5891   190%     - 1650s
     0     0 33636.3362    0  398 12373.4174 33636.3362   172%     - 1937s
H    0     0                    13203.572637 33635.8195   155%     - 1940s
H    0     0                    13241.940901 33635.8195   154%     - 1940s
H    0     0                    13292.949390 33635.8195   153%     - 1940s
H    0     0                    13571.072809 33635.8195   148%     - 1940s
H    0     0                    13673.051972 33635.8195   146%     - 1941s
H    0     0                    13771.050226 33635.8195   144%     - 1941s
     0     0 33351.4627    0  417 13771.0502 33351.4627   142%     - 2019s
     0     0 33099.0967    0  424 13771.0502 33099.0967   140%     - 2119s
     0     0 32985.3155    0  429 13771.0502 32985.3155   140%     - 2168s
     0     0 32940.9602    0  422 13771.0502 32940.9602   139%     - 2209s
     0     0 32901.4273    0  452 13771.0502 32901.4273   139%     - 2247s
     0     0 32880.5226    0  397 13771.0502 32880.5226   139%     - 2271s
     0     0 32851.8314    0  444 13771.0502 32851.8314   139%     - 2306s
     0     0 32834.3129    0  413 13771.0502 32834.3129   138%     - 2325s
     0     0 32789.0036    0  450 13771.0502 32789.0036   138%     - 2356s
     0     0 32764.5386    0  451 13771.0502 32764.5386   138%     - 2385s
     0     0 32756.6180    0  444 13771.0502 32756.6180   138%     - 2410s
     0     0 32749.1307    0  451 13771.0502 32749.1307   138%     - 2430s
     0     0 32742.2544    0  420 13771.0502 32742.2544   138%     - 2444s
     0     0 32734.0069    0  462 13771.0502 32734.0069   138%     - 2461s
     0     0 32726.4972    0  455 13771.0502 32726.4972   138%     - 2471s
     0     0 32720.9382    0  465 13771.0502 32720.9382   138%     - 2482s
     0     0 32672.7075    0  445 13771.0502 32672.7075   137%     - 2511s
     0     0 32646.0623    0  441 13771.0502 32646.0623   137%     - 2549s
     0     0 32641.0062    0  442 13771.0502 32641.0062   137%     - 2562s
     0     0 32618.2006    0  404 13771.0502 32618.2006   137%     - 2585s
     0     0 32615.2082    0  448 13771.0502 32615.2082   137%     - 2603s
     0     0 32608.2656    0  430 13771.0502 32608.2656   137%     - 2620s
     0     0 32604.9287    0  440 13771.0502 32604.9287   137%     - 2633s
     0     0 32600.3422    0  453 13771.0502 32600.3422   137%     - 2648s
     0     0 32589.6604    0  459 13771.0502 32589.6604   137%     - 2661s
     0     0 32581.2769    0  462 13771.0502 32581.2769   137%     - 2671s
     0     0 32580.2405    0  467 13771.0502 32580.2405   137%     - 2678s
     0     0 31811.7083    0  422 13771.0502 31811.7083   131%     - 2868s
H    0     0                    14766.342207 31811.4675   115%     - 2872s
     0     0 31613.5181    0  477 14766.3422 31613.5181   114%     - 2948s
     0     0 31563.9355    0  468 14766.3422 31563.9355   114%     - 2987s
     0     0 31557.6437    0  476 14766.3422 31557.6437   114%     - 3002s
     0     0 31549.1699    0  479 14766.3422 31549.1699   114%     - 3020s
     0     0 31516.1438    0  480 14766.3422 31516.1438   113%     - 3046s
     0     0 31495.3453    0  438 14766.3422 31495.3453   113%     - 3075s
     0     0 31483.7905    0  481 14766.3422 31483.7905   113%     - 3097s
     0     0 31471.2211    0  484 14766.3422 31471.2211   113%     - 3117s
     0     0 31459.5917    0  451 14766.3422 31459.5917   113%     - 3132s
     0     0 31430.5740    0  487 14766.3422 31430.5740   113%     - 3177s
     0     0 31426.7147    0  474 14766.3422 31426.7147   113%     - 3192s
     0     0 31424.1770    0  440 14766.3422 31424.1770   113%     - 3198s
     0     0 31259.9349    0  471 14766.3422 31259.9349   112%     - 3279s
H    0     0                    14781.102034 31259.5300   111%     - 3281s
     0     0 31228.6207    0  472 14781.1020 31228.6207   111%     - 3306s
     0     0 31223.4758    0  483 14781.1020 31223.4758   111%     - 3315s
     0     0 31213.8974    0  484 14781.1020 31213.8974   111%     - 3329s
     0     0 31210.2328    0  487 14781.1020 31210.2328   111%     - 3342s
     0     0 31201.1472    0  492 14781.1020 31201.1472   111%     - 3360s
     0     0 31195.1017    0  496 14781.1020 31195.1017   111%     - 3370s
     0     0 31189.1817    0  490 14781.1020 31189.1817   111%     - 3380s
     0     0 31180.5431    0  494 14781.1020 31180.5431   111%     - 3392s
     0     0 31174.5890    0  464 14781.1020 31174.5890   111%     - 3405s
     0     0 31169.3449    0  501 14781.1020 31169.3449   111%     - 3415s
     0     0 31168.4408    0  511 14781.1020 31168.4408   111%     - 3419s
     0     0 31079.5869    0  558 14781.1020 31079.5869   110%     - 3479s
H    0     0                    15030.180933 31079.0854   107%     - 3500s
     0     0 31065.1581    0  549 15030.1809 31065.1581   107%     - 3522s
     0     0 31057.9198    0  504 15030.1809 31057.9198   107%     - 3536s
     0     0 31054.8338    0  506 15030.1809 31054.8338   107%     - 3547s
     0     0 31053.3568    0  500 15030.1809 31053.3568   107%     - 3553s
     0     0 31024.1073    0  504 15030.1809 31024.1073   106%     - 3589s
H    0     0                    15592.769175 31024.0575  99.0%     - 3590s
     0     0          -    0      15592.7692 31024.0575  99.0%     - 3600s

Cutting planes:
  Learned: 3
  Implied bound: 289
  MIR: 3752
  Flow cover: 2564
  RLT: 75
  Relax-and-lift: 708

Explored 1 nodes (1547710 simplex iterations) in 3600.03 seconds (5858.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15592.8 15030.2 14781.1 ... 12172.6

Time limit reached
Best objective 1.559276917542e+04, best bound 3.102405753020e+04, gap 98.9644%
  WARNING: Time limit reached. Using best solution found (gap: 98.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 15592.77, θ = 169074.01
  Upper Bound (UB) = 15592.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169074.01
  [DEBUG]   ✓ Scenario 0: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 26: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 27: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 28: θ = 169074.01 ≤ Q = 169074.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 29] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xcc23ff8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf33dc008
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249915e+13
Presolve removed 2558 rows and 1849 columns
Presolve time: 0.01s
Presolved: 535 rows, 540 columns, 1510 nonzeros
Found heuristic solution: objective 6885542.6598
Variable types: 365 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6885287.0957

Root relaxation: objective -1.422648e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142264.80    0  122 6885287.10 -142264.80   102%     -    0s
H    0     0                    -89653.04990 -142264.80  58.7%     -    0s
H    0     0                    -95360.85538 -142264.80  49.2%     -    0s
H    0     0                    -103706.5556 -142264.80  37.2%     -    0s
     0     0 -114695.62    0   79 -103706.56 -114695.62  10.6%     -    0s
H    0     0                    -111029.6299 -114642.15  3.25%     -    0s
H    0     0                    -111285.1941 -114642.15  3.02%     -    0s
H    0     0                    -112450.1711 -114642.15  1.95%     -    0s
H    0     0                    -112705.7352 -114642.15  1.72%     -    0s
     0     0 -113764.08    0  116 -112705.74 -113764.08  0.94%     -    0s
     0     0 -113682.97    0  115 -112705.74 -113682.97  0.87%     -    0s
     0     0 -113682.49    0  115 -112705.74 -113682.49  0.87%     -    0s
     0     0 -113235.45    0   79 -112705.74 -113235.45  0.47%     -    0s
     0     0 -113068.41    0   81 -112705.74 -113068.41  0.32%     -    0s
     0     0 -113049.03    0   86 -112705.74 -113049.03  0.30%     -    0s
     0     0 -113045.38    0   85 -112705.74 -113045.38  0.30%     -    0s
     0     0 -112960.69    0   42 -112705.74 -112960.69  0.23%     -    0s
     0     0 -112959.28    0   40 -112705.74 -112959.28  0.22%     -    0s
H    0     0                    -112791.9555 -112958.42  0.15%     -    0s
     0     0 -112955.38    0   40 -112791.96 -112955.38  0.14%     -    0s
     0     0 -112940.91    0   40 -112791.96 -112940.91  0.13%     -    0s
     0     0 -112932.74    0   40 -112791.96 -112932.74  0.12%     -    0s
H    0     0                    -112826.0618 -112932.74  0.09%     -    0s
     0     0 -112932.74    0   76 -112826.06 -112932.74  0.09%     -    0s
     0     0 -112932.74    0   53 -112826.06 -112932.74  0.09%     -    0s
     0     0 -112932.74    0   37 -112826.06 -112932.74  0.09%     -    0s
     0     0 -112908.19    0   37 -112826.06 -112908.19  0.07%     -    0s
     0     0 -112907.80    0   36 -112826.06 -112907.80  0.07%     -    0s
     0     0 -112899.50    0   36 -112826.06 -112899.50  0.07%     -    0s
     0     0 -112899.50    0   36 -112826.06 -112899.50  0.07%     -    0s
     0     2 -112899.50    0   36 -112826.06 -112899.50  0.07%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 15
  MIR: 64
  Flow cover: 8

Explored 10 nodes (1090 simplex iterations) in 0.12 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -112826 -112826 -112792 ... 6.88554e+06
No other solutions better than -112826

Optimal solution found (tolerance 1.00e-06)
Best objective -1.128260618294e+05, best bound -1.128260618298e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 165755.86
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112826.06
  [DEBUG]   S×d_nominal = 278581.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 278581.93 + -112826.06 = 165755.86
  [DEBUG]   Current θ from Master = 169074.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3318.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12274.63
  Lower Bound (LB) = 15790.65
  Gap (UB-LB) = -197.8823, Absolute Gap = 197.8823, Relative Gap = -0.012691
  *** CONVERGED (small negative gap: -197.88 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 29
Total Time: 84262.53s
Converged: True
Final Lower Bound: 15790.6514
Final Upper Bound: 15592.7692
Final Gap: -197.882260
Number of Critical Scenarios: 29
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0, 1] (2/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 4
DCs Opened: [6, 7, 8, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 12 customers  Mode 1: 9 customers  Mode 2: 29 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 29
Start Time: 2026-01-03 10:49:11
End Time: 2026-01-04 10:13:33
Total Time: 84262.53s
Optimal Value: 15790.65
Lower Bound: 15790.65
Upper Bound: 15592.77
Gap: -197.882260
Plants Opened: {0: [0, 1], 1: [1], 2: [1]} (4 plants)
DCs Opened: [6, 7, 8, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed20_Mixed_gamma20_20260104_101333.csv

Total Execution Time: 84262.66 seconds
End Time: 2026-01-04 10:13:33

All tasks completed successfully!

