
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 24
DI Scenario: HD
Start Time: 2026-01-03 11:55:59
================================================================================
Loading data from data/DH_data_full_seed24.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
  Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
  Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=993, max=1652
  DC capacity (MC): min=447, max=853

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.89, count=87
  Deviation (μ̂): min=4.03, max=9.95

Costs:
  Plant fixed cost: min=5996, max=9615
  DC fixed cost: min=3150, max=5670
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
    Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
  MD:
    Product 0: ['1.000', '1.251', '1.565'] (k=0.553)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.267', '1.606'] (k=0.584)
  LD:
    Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
    Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
  Mixed:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0x7ec7cf60
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.08s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -282786.0125
Found heuristic solution: objective -195802.1610

Root relaxation: objective 1.849661e+05, 5502 iterations, 0.26 seconds (0.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 184966.079    0  439 -195802.16 184966.079   194%     -    0s
H    0     0                    -194269.3471 184966.079   195%     -    0s
H    0     0                    -191876.2252 184966.079   196%     -    0s
     0     0 161646.933    0  698 -191876.23 161646.933   184%     -    1s
H    0     0                    -174543.5612 161616.365   193%     -    1s
     0     0 160811.466    0  708 -174543.56 160811.466   192%     -    1s
     0     0 160793.647    0  718 -174543.56 160793.647   192%     -    1s
     0     0 160793.609    0  718 -174543.56 160793.609   192%     -    1s
     0     0 147607.109    0  692 -174543.56 147607.109   185%     -    2s
     0     0 145846.413    0  717 -174543.56 145846.413   184%     -    2s
     0     0 145730.541    0  733 -174543.56 145730.541   183%     -    2s
     0     0 145707.761    0  739 -174543.56 145707.761   183%     -    2s
     0     0 145707.352    0  740 -174543.56 145707.352   183%     -    2s
H    0     0                    -144163.9673 145707.352   201%     -    3s
H    0     0                    -143156.5856 145707.352   202%     -    3s
H    0     0                    47339.290808 126638.313   168%     -    4s
     0     0 126638.313    0  537 47339.2908 126638.313   168%     -    4s
     0     0 125054.741    0  591 47339.2908 125054.741   164%     -    4s
     0     0 124793.479    0  568 47339.2908 124793.479   164%     -    4s
     0     0 124740.970    0  582 47339.2908 124740.970   164%     -    4s
     0     0 124730.481    0  580 47339.2908 124730.481   163%     -    4s
H    0     0                    51078.957082 124730.481   144%     -    5s
H    0     0                    53426.420356 124730.481   133%     -    5s
H    0     0                    58337.476493 124730.481   114%     -    5s
H    0     0                    60189.680321 124730.481   107%     -    5s
H    0     0                    60226.855490 124730.481   107%     -    5s
H    0     0                    61512.725374 118835.298  93.2%     -    5s
     0     0 118835.298    0  571 61512.7254 118835.298  93.2%     -    5s
     0     0 118037.770    0  637 61512.7254 118037.770  91.9%     -    6s
     0     0 117827.075    0  638 61512.7254 117827.075  91.5%     -    6s
     0     0 117803.146    0  629 61512.7254 117803.146  91.5%     -    6s
H    0     0                    62335.260458 115422.399  85.2%     -    6s
H    0     0                    63132.006366 115422.399  82.8%     -    6s
H    0     0                    63319.948861 115422.399  82.3%     -    6s
H    0     0                    63931.409399 115422.399  80.5%     -    6s
H    0     0                    64044.411104 115422.399  80.2%     -    6s
H    0     0                    64114.049459 115422.399  80.0%     -    6s
H    0     0                    64252.631721 115422.399  79.6%     -    6s
H    0     0                    64431.450144 115422.399  79.1%     -    6s
H    0     0                    64516.385561 115422.399  78.9%     -    6s
H    0     0                    65042.992992 115422.399  77.5%     -    6s
H    0     0                    65198.078311 115422.399  77.0%     -    6s
     0     0 115422.399    0  660 65198.0783 115422.399  77.0%     -    6s
     0     0 114908.890    0  685 65198.0783 114908.890  76.2%     -    7s
     0     0 114736.641    0  692 65198.0783 114736.641  76.0%     -    7s
     0     0 114691.808    0  696 65198.0783 114691.808  75.9%     -    7s
     0     0 114677.505    0  714 65198.0783 114677.505  75.9%     -    7s
     0     0 113301.074    0  623 65198.0783 113301.074  73.8%     -    8s
     0     0 112969.969    0  637 65198.0783 112969.969  73.3%     -    8s
     0     0 112886.380    0  657 65198.0783 112886.380  73.1%     -    8s
     0     0 112863.904    0  669 65198.0783 112863.904  73.1%     -    8s
     0     0 112083.740    0  640 65198.0783 112083.740  71.9%     -    9s
     0     0 111838.105    0  629 65198.0783 111838.105  71.5%     -    9s
     0     0 111760.056    0  660 65198.0783 111760.056  71.4%     -    9s
     0     0 111741.430    0  666 65198.0783 111741.430  71.4%     -   10s
     0     0 111171.432    0  694 65198.0783 111171.432  70.5%     -   10s
     0     0 110993.622    0  730 65198.0783 110993.622  70.2%     -   10s
     0     0 110965.308    0  727 65198.0783 110965.308  70.2%     -   11s
H    0     0                    67422.242201 110631.318  64.1%     -   11s
H    0     0                    70400.250623 110631.318  57.1%     -   11s
     0     0 110631.318    0  666 70400.2506 110631.318  57.1%     -   11s
     0     0 110629.046    0  666 70400.2506 110629.046  57.1%     -   11s
     0     2 110629.046    0  666 70400.2506 110629.046  57.1%     -   12s
    15    32 110051.719    4  572 70400.2506 110312.952  56.7%  1710   15s
H   33    64                    70407.544494 110055.227  56.3%  1738   16s
H   34    64                    70615.158010 110055.227  55.9%  1712   16s
H   39    64                    70788.091900 110055.116  55.5%  1648   16s
H  228   337                    70795.385771 109956.117  55.3%  1223   19s
H  232   337                    71808.855907 109956.117  53.1%  1220   19s
   438   471 105071.713   13  477 71808.8559 109956.117  53.1%   858   20s
H  480   504                    72625.548383 109956.117  51.4%   823   20s
H  545   573                    72924.254638 109956.117  50.8%   779   21s
H  562   573                    73121.891025 109956.117  50.4%   768   21s
H  881   955                    73359.952190 109956.117  49.9%   650   23s
H 1079  1192                    73475.108365 109956.117  49.7%   576   23s
H 1176  1192                    73520.804541 109956.117  49.6%   557   23s
  1422  1552 101673.096   25  334 73520.8045 109956.117  49.6%   519   25s
H 1581  1633                    73741.686591 109956.117  49.1%   498   25s
H 1701  1698                    76956.272295 109943.337  42.9%   494   27s
H 1703  1698                    77256.081665 109943.337  42.3%   494   27s
H 1877  1865                    77652.562317 109838.386  41.4%   489   28s
H 1878  1861                    78054.213559 109838.386  40.7%   489   28s
H 1883  1859                    78541.312726 109838.386  39.8%   490   28s
  2106  2084 96265.4438   34  372 78541.3127 109640.844  39.6%   489   30s
H 2117  2083                    78765.126704 109640.844  39.2%   489   30s
H 2158  2083                    78855.247874 109640.844  39.0%   483   30s
H 2203  2082                    78990.553849 109640.844  38.8%   487   30s
H 3000  3106                    79011.959188 109640.844  38.8%   423   32s
H 3016  3099                    79248.214539 109640.844  38.4%   421   32s
H 3083  3096                    79309.246442 109640.844  38.2%   414   32s
H 3278  3064                    80818.130064 109640.844  35.7%   401   32s
  4187  4210 86267.7585  107  155 80818.1301 109640.844  35.7%   352   35s
  4870  4353 107495.400    7  666 80818.1301 109404.622  35.4%   360   44s
  4872  4354 93187.0410   43   84 80818.1301 109404.622  35.4%   359   45s
  4923  4390 87175.8250   40  396 80818.1301 103303.678  27.8%   359   50s
  5006  4464 83325.1787   30  396 80818.1301 98750.3978  22.2%   365   55s
H 5238  4338                    84017.063517 96063.0499  14.3%   365   56s
H 5442  4121                    84234.580166 95207.9933  13.0%   361   57s
H 6009  3880                    84475.607962 94435.1056  11.8%   353   58s
  6346  3823     cutoff   43      84475.6080 92340.8291  9.31%   348   60s
H 6361  3629                    84477.565107 92202.2374  9.14%   348   60s
  7958  2828     cutoff   36      84477.5651 89296.5636  5.70%   327   65s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 2
  MIR: 113
  Flow cover: 268
  Relax-and-lift: 41

Explored 9603 nodes (2778221 simplex iterations) in 66.29 seconds (144.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 84477.6 84475.6 84234.6 ... 78855.2

Optimal solution found (tolerance 1.00e-06)
Best objective 8.447756510730e+04, best bound 8.447756510730e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 66.30s
  Master Objective (UB) = 84477.57, θ = 252885.28
  Upper Bound (UB) = 84477.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 252885.28
  [DEBUG]   ✓ Scenario 0: θ = 252885.28 ≤ Q = 252885.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1a03ae73
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1a03ae73
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.469908e+13
Presolve removed 2562 rows and 1852 columns
Presolve time: 0.00s
Presolved: 531 rows, 537 columns, 1499 nonzeros
Found heuristic solution: objective 7291661.3742
Variable types: 364 continuous, 173 integer (173 binary)
Found heuristic solution: objective 7291350.6595

Root relaxation: objective -1.899895e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189989.55    0  125 7291350.66 -189989.55   103%     -    0s
H    0     0                    -129438.1525 -189989.55  46.8%     -    0s
H    0     0                    -131089.8795 -189989.55  44.9%     -    0s
H    0     0                    -147415.1474 -189989.55  28.9%     -    0s
     0     0 -157776.37    0    2 -147415.15 -157776.37  7.03%     -    0s
H    0     0                    -157775.6083 -157775.61  0.00%     -    0s
     0     0 -157775.61    0    2 -157775.61 -157775.61  0.00%     -    0s

Cutting planes:
  MIR: 151

Explored 1 nodes (370 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -157776 -147415 -131090 ... 1.46991e+13
No other solutions better than -157776

Optimal solution found (tolerance 1.00e-06)
Best objective -1.577756083229e+05, best bound -1.577756083229e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 221734.67
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157775.61
  [DEBUG]   S×d_nominal = 379510.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379510.28 + -157775.61 = 221734.67
  [DEBUG]   Current θ from Master = 252885.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31150.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 53326.95
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 31150.6179, Absolute Gap = 31150.6179, Relative Gap = 0.368744
  Not converged yet (gap = 31150.62 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0xc30fd073
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 53326.9 (0.01s)
MIP start from previous solve produced solution with objective 53326.9 (0.01s)
Loaded MIP start from previous solve with objective 53326.9

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.30s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.052165e+05, 11503 iterations, 1.32 seconds (2.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 105216.453    0  240 53326.9472 105216.453  97.3%     -    1s
H    0     0                    61040.217342 105216.453  72.4%     -    1s
     0     0 96055.4791    0  237 61040.2173 96055.4791  57.4%     -    2s
     0     0 95934.6765    0  237 61040.2173 95934.6765  57.2%     -    2s
     0     0 90932.2130    0  354 61040.2173 90932.2130  49.0%     -    4s
     0     0 90514.7900    0  392 61040.2173 90514.7900  48.3%     -    4s
     0     0 90268.5400    0  394 61040.2173 90268.5400  47.9%     -    4s
     0     0 90160.3414    0  400 61040.2173 90160.3414  47.7%     -    4s
     0     0 90140.7340    0  397 61040.2173 90140.7340  47.7%     -    4s
     0     0 90098.2157    0  398 61040.2173 90098.2157  47.6%     -    4s
     0     0 90097.1373    0  407 61040.2173 90097.1373  47.6%     -    4s
     0     0 86759.4948    0  408 61040.2173 86759.4948  42.1%     -    6s
H    0     0                    61083.507084 86758.3428  42.0%     -    6s
H    0     0                    61085.442827 86758.3428  42.0%     -    6s
     0     0 86280.1418    0  371 61085.4428 86280.1418  41.2%     -    7s
     0     0 86114.3547    0  384 61085.4428 86114.3547  41.0%     -    7s
     0     0 86064.4381    0  391 61085.4428 86064.4381  40.9%     -    7s
     0     0 86051.0344    0  392 61085.4428 86051.0344  40.9%     -    7s
     0     0 86042.3939    0  383 61085.4428 86042.3939  40.9%     -    7s
     0     0 86039.2983    0  386 61085.4428 86039.2983  40.9%     -    7s
     0     0 83526.9910    0  499 61085.4428 83526.9910  36.7%     -   10s
     0     0 83246.2229    0  510 61085.4428 83246.2229  36.3%     -   10s
     0     0 83142.3358    0  552 61085.4428 83142.3358  36.1%     -   10s
     0     0 83115.7489    0  548 61085.4428 83115.7489  36.1%     -   10s
     0     0 83105.0336    0  562 61085.4428 83105.0336  36.0%     -   10s
     0     0 83098.8908    0  563 61085.4428 83098.8908  36.0%     -   11s
     0     0 83098.4644    0  564 61085.4428 83098.4644  36.0%     -   11s
     0     0 82351.7333    0  350 61085.4428 82351.7333  34.8%     -   12s
H    0     0                    61522.464647 82351.1737  33.9%     -   12s
H    0     0                    61557.148218 82351.1737  33.8%     -   12s
     0     0 82149.4203    0  386 61557.1482 82149.4203  33.5%     -   12s
     0     0 82110.0380    0  396 61557.1482 82110.0380  33.4%     -   12s
     0     0 82074.4366    0  403 61557.1482 82074.4366  33.3%     -   13s
     0     0 82068.3839    0  407 61557.1482 82068.3839  33.3%     -   13s
     0     0 82059.2533    0  403 61557.1482 82059.2533  33.3%     -   13s
     0     0 82059.0727    0  404 61557.1482 82059.0727  33.3%     -   13s
     0     0 81757.3732    0  464 61557.1482 81757.3732  32.8%     -   14s
     0     0 81627.6000    0  538 61557.1482 81627.6000  32.6%     -   14s
     0     0 81571.2233    0  506 61557.1482 81571.2233  32.5%     -   14s
     0     0 81549.0684    0  467 61557.1482 81549.0684  32.5%     -   15s
     0     0 81545.4746    0  509 61557.1482 81545.4746  32.5%     -   15s
     0     0 81379.3134    0  395 61557.1482 81379.3134  32.2%     -   15s
     0     0 81269.8226    0  433 61557.1482 81269.8226  32.0%     -   16s
     0     0 81243.2903    0  431 61557.1482 81243.2903  32.0%     -   16s
     0     0 81238.8629    0  424 61557.1482 81238.8629  32.0%     -   16s
     0     0 81167.8214    0  430 61557.1482 81167.8214  31.9%     -   17s
     0     0 81089.1974    0  439 61557.1482 81089.1974  31.7%     -   17s
     0     0 81079.8505    0  442 61557.1482 81079.8505  31.7%     -   17s
     0     0 81077.2248    0  444 61557.1482 81077.2248  31.7%     -   17s
     0     0 81020.2605    0  351 61557.1482 81020.2605  31.6%     -   18s
     0     0 81013.3234    0  357 61557.1482 81013.3234  31.6%     -   18s
     0     0 80951.1473    0  411 61557.1482 80951.1473  31.5%     -   18s
     0     0 80942.5849    0  415 61557.1482 80942.5849  31.5%     -   19s
     0     0 80939.4812    0  364 61557.1482 80939.4812  31.5%     -   19s
     0     0 80875.2565    0  494 61557.1482 80875.2565  31.4%     -   19s
     0     0 80845.1905    0  480 61557.1482 80845.1905  31.3%     -   19s
     0     0 80834.7824    0  487 61557.1482 80834.7824  31.3%     -   20s
     0     0 80833.6801    0  488 61557.1482 80833.6801  31.3%     -   20s
     0     0 80796.8809    0  506 61557.1482 80796.8809  31.3%     -   20s
     0     0 80785.9455    0  508 61557.1482 80785.9455  31.2%     -   21s
     0     0 80783.3056    0  511 61557.1482 80783.3056  31.2%     -   21s
     0     0 80778.6340    0  457 61557.1482 80778.6340  31.2%     -   21s
     0     0 80773.7156    0  456 61557.1482 80773.7156  31.2%     -   22s
     0     0 80772.0792    0  442 61557.1482 80772.0792  31.2%     -   22s
     0     0 80769.5492    0  446 61557.1482 80769.5492  31.2%     -   22s
     0     0 80769.4651    0  443 61557.1482 80769.4651  31.2%     -   23s
     0     0 80768.0608    0  443 61557.1482 80768.0608  31.2%     -   23s
H    0     0                    62247.572931 80768.0608  29.8%     -   26s
     0     2 80768.0608    0  443 62247.5729 80768.0608  29.8%     -   26s
     7    16 80324.7786    3  355 62247.5729 80586.3562  29.5%  1431   30s
    95   184 78776.8020    7  359 62247.5729 80096.5079  28.7%  1189   35s
H  117   184                    62478.281572 80096.5079  28.2%  1072   35s
   387   459 78161.4597   12  314 62478.2816 80096.5079  28.2%   770   41s
   796   860 75809.0389   17  319 62478.2816 80096.5079  28.2%   593   45s
H 1076  1057                    62820.442177 79761.5218  27.0%   531   47s
  1178  1152 73461.2109   23  288 62820.4422 79761.5218  27.0%   535   50s
H 1254  1206                    63047.946917 79350.3017  25.9%   544   51s
H 1273  1206                    63201.484561 79350.3017  25.6%   549   51s
H 1295  1206                    63327.763298 79350.3017  25.3%   544   51s
  1397  1280 66127.2905   27  230 63327.7633 79347.9173  25.3%   553   55s
  1581  1415 65092.1408   33  166 63327.7633 78904.7271  24.6%   573   60s
H 1632  1415                    63502.242453 78771.9656  24.0%   574   60s
  1896  1693 75875.2594   11  424 63502.2425 78724.5488  24.0%   556   65s
  2322  1912 66560.6503   16  375 63502.2425 78240.9261  23.2%   535   71s
H 2441  1948                    63687.728127 78240.9261  22.9%   537   72s
H 2458  1938                    64033.004421 78240.9261  22.2%   540   72s
H 2461  1885                    64780.806311 78240.9261  20.8%   540   72s
  2627  2000     cutoff   22      64780.8063 78240.9261  20.8%   542   75s
H 2842  2026                    65163.727789 78002.3300  19.7%   554   79s
H 2864  2025                    65185.329144 78002.3300  19.7%   556   79s
H 2876  1985                    65483.785894 78002.3300  19.1%   558   79s
  2882  2027 73975.7565   11  316 65483.7859 77962.4325  19.1%   558   81s
  3170  2162 72383.1917   19  328 65483.7859 77822.1338  18.8%   563   86s
  3473  2361 67645.4461   27  219 65483.7859 77770.5616  18.8%   559   90s
  3794  2504 74519.5712   17  347 65483.7859 77662.9075  18.6%   551   95s
  4243  2689 68261.1781   52  129 65483.7859 77530.8340  18.4%   539  102s
  4464  2786 65790.5986   73   56 65483.7859 77525.1943  18.4%   542  105s
  4656  2787 76582.2809    7  443 65483.7859 77525.1943  18.4%   545  111s
  4660  2790 66480.2148   22  359 65483.7859 77525.1943  18.4%   545  115s
H 4666  2654                    65583.140524 77525.1943  18.2%   544  117s
H 4669  2523                    65599.196781 77525.1943  18.2%   544  119s
H 4669  2396                    65616.966035 77525.1943  18.1%   544  119s
  4672  2398 66023.8908   33  403 65616.9660 77525.1943  18.1%   543  120s
H 4677  2281                    65657.945472 77525.1943  18.1%   543  122s
  4684  2286 73559.1000   13  370 65657.9455 77525.1943  18.1%   542  126s
  4686  2290 77525.1943   10  407 65657.9455 77525.1943  18.1%   548  130s
  4716  2338 70826.1859   14  386 65657.9455 77525.1943  18.1%   552  136s
  4824  2360 67239.4811   17  379 65657.9455 75753.2075  15.4%   563  141s
  5074  2344 72284.1544   16  271 65657.9455 75348.1682  14.8%   566  145s
  5443  2285 67916.6716   18  241 65657.9455 72685.6095  10.7%   562  150s
  5804  2165     cutoff   19      65657.9455 71953.9851  9.59%   552  155s
  6477  1874 67082.6454   25  187 65657.9455 69780.2344  6.28%   530  160s
* 7303  1426              54    65749.535853 67820.1821  3.15%   489  162s

Cutting planes:
  MIR: 191
  Flow cover: 383
  RLT: 3
  Relax-and-lift: 43

Explored 8241 nodes (3660791 simplex iterations) in 164.41 seconds (412.21 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 65749.5 65657.9 65617 ... 63502.2

Optimal solution found (tolerance 1.00e-06)
Best objective 6.574953585309e+04, best bound 6.574953585309e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 164.42s
  Master Objective (UB) = 65749.54, θ = 232379.99
  Upper Bound (UB) = 65749.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232379.99
  [DEBUG]   ✓ Scenario 0: θ = 232379.99 ≤ Q = 232379.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232379.99 ≤ Q = 232379.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2383b219
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2383b219
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.390222e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 6933855.7524
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.922296e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -192229.55    0  137 6933855.75 -192229.55   103%     -    0s
H    0     0                    -152192.2941 -192229.55  26.3%     -    0s
H    0     0                    -152357.6823 -192229.55  26.2%     -    0s
H    0     0                    -175757.8444 -192229.55  9.37%     -    0s
     0     0 -182091.60    0  117 -175757.84 -182091.60  3.60%     -    0s
H    0     0                    -179543.8064 -181995.93  1.37%     -    0s
     0     0 -180912.77    0   98 -179543.81 -180912.77  0.76%     -    0s
     0     0 -180894.95    0   79 -179543.81 -180894.95  0.75%     -    0s
     0     0 -180357.81    0   64 -179543.81 -180357.81  0.45%     -    0s
     0     0 -180151.06    0   59 -179543.81 -180151.06  0.34%     -    0s
     0     0 -180151.06    0   65 -179543.81 -180151.06  0.34%     -    0s
     0     0 -179891.30    0   58 -179543.81 -179891.30  0.19%     -    0s
     0     0 -179890.52    0   38 -179543.81 -179890.52  0.19%     -    0s
     0     0 -179890.47    0   37 -179543.81 -179890.47  0.19%     -    0s
     0     0 -179804.65    0   30 -179543.81 -179804.65  0.15%     -    0s
     0     0 -179695.20    0   17 -179543.81 -179695.20  0.08%     -    0s
     0     0 -179695.20    0   25 -179543.81 -179695.20  0.08%     -    0s
     0     0 -179603.41    0   16 -179543.81 -179603.41  0.03%     -    0s
     0     0 -179600.67    0   13 -179543.81 -179600.67  0.03%     -    0s
H    0     0                    -179546.6860 -179598.50  0.03%     -    0s
H    0     0                    -179561.0039 -179598.50  0.02%     -    0s
     0     0 -179579.05    0    4 -179561.00 -179579.05  0.01%     -    0s
     0     0 -179576.84    0    3 -179561.00 -179576.84  0.01%     -    0s
     0     0 -179572.63    0    5 -179561.00 -179572.63  0.01%     -    0s
     0     0 -179572.43    0    6 -179561.00 -179572.43  0.01%     -    0s
H    0     0                    -179561.1928 -179572.43  0.01%     -    0s
     0     0 -179568.79    0    5 -179561.19 -179568.79  0.00%     -    0s
H    0     0                    -179565.1688 -179568.46  0.00%     -    0s
     0     0 -179567.45    0    3 -179565.17 -179567.45  0.00%     -    0s
     0     0 -179565.98    0    2 -179565.17 -179565.98  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 2
  Flow cover: 1

Explored 1 nodes (1126 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -179565 -179561 -179561 ... -152192
No other solutions better than -179565

Optimal solution found (tolerance 1.00e-06)
Best objective -1.795651688039e+05, best bound -1.795651688039e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 209515.41
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -179565.17
  [DEBUG]   S×d_nominal = 389080.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 389080.58 + -179565.17 = 209515.41
  [DEBUG]   Current θ from Master = 232379.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22864.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42884.95
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 12422.5886, Absolute Gap = 12422.5886, Relative Gap = 0.188938
  Not converged yet (gap = 12422.59 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x0c1f2db7
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 42885 (0.02s)
MIP start from previous solve produced solution with objective 42885 (0.02s)
Loaded MIP start from previous solve with objective 42885

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.43s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.15s

Solved with dual simplex

Root relaxation: objective 9.199356e+04, 19678 iterations, 4.03 seconds (7.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91993.5612    0   78 42884.9544 91993.5612   115%     -    4s
H    0     0                    46798.057014 91993.5612  96.6%     -    4s
H    0     0                    47428.509005 91993.5612  94.0%     -    4s
H    0     0                    48065.068101 91993.5612  91.4%     -    4s
H    0     0                    48553.426856 91993.5612  89.5%     -    4s
H    0     0                    52195.519956 91993.5612  76.2%     -    4s
H    0     0                    52615.084503 91993.5612  74.8%     -    4s
H    0     0                    53028.950113 91993.5612  73.5%     -    4s
H    0     0                    53123.204161 91993.5612  73.2%     -    4s
H    0     0                    53291.601882 91993.5612  72.6%     -    4s
H    0     0                    53295.195084 91993.5612  72.6%     -    4s
H    0     0                    54448.393940 86486.3522  58.8%     -    6s
H    0     0                    54492.213245 86486.3522  58.7%     -    6s
H    0     0                    54600.620910 86486.3522  58.4%     -    6s
     0     0 86486.3522    0  180 54600.6209 86486.3522  58.4%     -    6s
     0     0 85843.4399    0  219 54600.6209 85843.4399  57.2%     -    7s
     0     0 85843.4399    0  184 54600.6209 85843.4399  57.2%     -    7s
     0     0 85843.4399    0  186 54600.6209 85843.4399  57.2%     -    7s
     0     0 83616.7693    0  241 54600.6209 83616.7693  53.1%     -    9s
H    0     0                    54766.243430 83616.3619  52.7%     -    9s
     0     0 82871.2263    0  291 54766.2434 82871.2263  51.3%     -    9s
     0     0 82586.6362    0  269 54766.2434 82586.6362  50.8%     -   10s
     0     0 82508.0155    0  299 54766.2434 82508.0155  50.7%     -   10s
     0     0 82493.9724    0  297 54766.2434 82493.9724  50.6%     -   10s
     0     0 82414.0442    0  291 54766.2434 82414.0442  50.5%     -   11s
     0     0 82364.7146    0  299 54766.2434 82364.7146  50.4%     -   11s
     0     0 82359.6708    0  293 54766.2434 82359.6708  50.4%     -   11s
     0     0 82358.1589    0  309 54766.2434 82358.1589  50.4%     -   11s
     0     0 82357.1670    0  295 54766.2434 82357.1670  50.4%     -   11s
     0     0 82356.9878    0  296 54766.2434 82356.9878  50.4%     -   11s
     0     0 81042.8485    0  349 54766.2434 81042.8485  48.0%     -   14s
H    0     0                    56561.048608 80522.4585  42.4%     -   15s
H    0     0                    56939.562420 80522.4585  41.4%     -   15s
H    0     0                    56964.550974 80522.4585  41.4%     -   15s
H    0     0                    56976.880950 80522.4585  41.3%     -   15s
     0     0 80522.4585    0  330 56976.8809 80522.4585  41.3%     -   15s
     0     0 80429.5089    0  332 56976.8809 80429.5089  41.2%     -   15s
     0     0 80391.2032    0  338 56976.8809 80391.2032  41.1%     -   16s
     0     0 80370.1904    0  332 56976.8809 80370.1904  41.1%     -   16s
     0     0 80362.9128    0  341 56976.8809 80362.9128  41.0%     -   16s
     0     0 80362.2824    0  343 56976.8809 80362.2824  41.0%     -   16s
H    0     0                    57072.910645 79810.8156  39.8%     -   19s
H    0     0                    57101.417363 79810.8156  39.8%     -   19s
H    0     0                    57201.801660 79810.8156  39.5%     -   19s
H    0     0                    57225.924172 79810.8156  39.5%     -   19s
H    0     0                    57440.836199 79810.8156  38.9%     -   19s
H    0     0                    57509.339509 79810.8156  38.8%     -   19s
     0     0 79810.8156    0  419 57509.3395 79810.8156  38.8%     -   19s
     0     0 79527.9932    0  401 57509.3395 79527.9932  38.3%     -   20s
H    0     0                    57653.946481 79369.1843  37.7%     -   21s
H    0     0                    57740.471859 79369.1843  37.5%     -   21s
     0     0 79369.1843    0  419 57740.4719 79369.1843  37.5%     -   21s
     0     0 79323.1624    0  361 57740.4719 79323.1624  37.4%     -   22s
     0     0 79294.4201    0  375 57740.4719 79294.4201  37.3%     -   22s
     0     0 79279.9486    0  374 57740.4719 79279.9486  37.3%     -   22s
     0     0 79270.8604    0  423 57740.4719 79270.8604  37.3%     -   23s
     0     0 79269.4879    0  423 57740.4719 79269.4879  37.3%     -   23s
     0     0 79123.8123    0  407 57740.4719 79123.8123  37.0%     -   24s
     0     0 79095.2355    0  359 57740.4719 79095.2355  37.0%     -   24s
     0     0 79083.1649    0  405 57740.4719 79083.1649  37.0%     -   24s
     0     0 79077.7203    0  413 57740.4719 79077.7203  37.0%     -   25s
     0     0 79074.3610    0  410 57740.4719 79074.3610  36.9%     -   25s
     0     0 79073.4561    0  411 57740.4719 79073.4561  36.9%     -   25s
     0     0 79043.0424    0  349 57740.4719 79043.0424  36.9%     -   25s
     0     0 79026.3873    0  431 57740.4719 79026.3873  36.9%     -   26s
     0     0 79023.4455    0  432 57740.4719 79023.4455  36.9%     -   26s
H    0     0                    57762.873526 79020.4819  36.8%     -   26s
     0     0 79020.4819    0  438 57762.8735 79020.4819  36.8%     -   26s
     0     0 79016.3913    0  432 57762.8735 79016.3913  36.8%     -   26s
     0     0 79015.0540    0  432 57762.8735 79015.0540  36.8%     -   26s
     0     0 78987.0380    0  361 57762.8735 78987.0380  36.7%     -   27s
     0     0 78981.5271    0  413 57762.8735 78981.5271  36.7%     -   28s
     0     0 78977.6875    0  410 57762.8735 78977.6875  36.7%     -   28s
     0     0 78975.0346    0  410 57762.8735 78975.0346  36.7%     -   28s
     0     0 78973.8848    0  415 57762.8735 78973.8848  36.7%     -   28s
H    0     0                    57770.087696 78973.8848  36.7%     -   28s
     0     0 78973.5497    0  416 57770.0877 78973.5497  36.7%     -   28s
H    0     0                    57779.655148 78969.8019  36.7%     -   28s
     0     0 78969.8019    0  402 57779.6551 78969.8019  36.7%     -   28s
     0     0 78969.8019    0  402 57779.6551 78969.8019  36.7%     -   29s
H    0     0                    59115.603952 78969.8019  33.6%     -   29s
     0     0 78969.8019    0  405 59115.6040 78969.8019  33.6%     -   29s
     0     0 78969.8019    0  402 59115.6040 78969.8019  33.6%     -   30s
     0     0 78969.8019    0  402 59115.6040 78969.8019  33.6%     -   30s
H    0     0                    59876.294475 78969.8019  31.9%     -   35s
H    0     0                    59969.402315 78969.8019  31.7%     -   35s
H    0     0                    59974.394763 78969.8019  31.7%     -   35s
H    0     2                    59991.532828 78969.8019  31.6%     -   35s
     0     2 78969.8019    0  402 59991.5328 78969.8019  31.6%     -   35s
     3     8 78674.0711    2  413 59991.5328 78861.5563  31.5%  3420   40s
    15    32 78245.5825    4  336 59991.5328 78505.1655  30.9%  3607   45s
    31    64 77981.4818    5  335 59991.5328 78301.6684  30.5%  4432   50s
    95   231 77343.3319    7  351 59991.5328 77981.4027  30.0%  4393   57s
   291   366 76810.4290   11  352 59991.5328 77981.4027  30.0%  2418   60s
H  406   442                    60161.173452 77981.4027  29.6%  2143   63s
   441   513 76247.0809   14  314 60161.1735 77981.4027  29.6%  2041   65s
   583   636 72398.2303   16  302 60161.1735 77981.4027  29.6%  1899   70s
   684   703 72167.8046   17  307 60161.1735 77981.4027  29.6%  1876   77s
   732   731 73967.1754   18  338 60161.1735 77974.0289  29.6%  1972   80s
H  756   731                    60238.155832 77974.0289  29.4%  1991   80s
   825   831 72375.5896   19  357 60238.1558 77935.1033  29.4%  1991   85s
H  869   831                    60254.628398 77935.1033  29.3%  1974   85s
H  895   861                    60282.341413 77935.1033  29.3%  1979   88s
H  903   861                    60282.606656 77935.1033  29.3%  1987   88s
H  904   861                    60352.717865 77935.1033  29.1%  1985   88s
   918   921 72110.8395   20  314 60352.7179 77935.1033  29.1%  1986   91s
H  937   921                    60377.130274 77935.1033  29.1%  1978   91s
H 1103  1066                    60393.499481 77935.1033  29.0%  1851   94s
  1133  1144 70787.9231   22  341 60393.4995 77935.1033  29.0%  1825   99s
  1229  1222 71281.5289   23  278 60393.4995 77598.8094  28.5%  1776  101s
H 1250  1222                    60476.656482 77598.8094  28.3%  1775  101s
  1416  1401 66001.0183   25  281 60476.6565 77598.8094  28.3%  1724  107s
  1522  1492 63989.9450   25  344 60476.6565 77598.8094  28.3%  1682  110s
  1762  1761 64047.4725   27  298 60476.6565 77587.4492  28.3%  1611  116s
  2151  2043 61633.4758   37  209 60476.6565 77587.4492  28.3%  1440  122s
  2283  2126 60875.7002   38  287 60476.6565 77468.8099  28.1%  1394  126s
  2590  2393 68300.8975    8  377 60476.6565 77404.4003  28.0%  1333  133s
  2743  2506 68268.5427    9  364 60476.6565 77404.4003  28.0%  1315  136s
  3074  2766 62533.2337   15  215 60476.6565 77380.3255  28.0%  1288  144s
  3264  2889 61691.2667   18  228 60476.6565 77380.3255  28.0%  1272  147s
  3455  2960 75084.4081    9  308 60476.6565 77206.9908  27.7%  1259  151s
  3719  3098 66821.6663   15  202 60476.6565 77071.9921  27.4%  1276  159s
H 3789  3098                    60490.119413 77026.7412  27.3%  1273  159s
  3848  3099 62908.4624   62  402 60490.1194 77025.3995  27.3%  1269  166s
  3850  3100 66959.5699   34   78 60490.1194 77025.3995  27.3%  1268  171s
H 3850  2944                    60519.781550 77025.3995  27.3%  1268  175s
H 3851  2798                    60526.878283 77025.3995  27.3%  1268  177s
  3855  2801 74686.2903   14  346 60526.8783 77025.3995  27.3%  1267  180s
  3864  2807 62318.6162   48  413 60526.8783 77025.3995  27.3%  1264  185s
  3870  2811 62285.7545   31  410 60526.8783 77025.3995  27.3%  1262  190s
  3877  2815 75747.6670   12  411 60526.8783 77025.3995  27.3%  1260  195s
  3878  2816 71131.4076   17  411 60526.8783 77025.3995  27.3%  1259  200s
  3879  2817 65826.6731   38  411 60526.8783 77025.3995  27.3%  1259  206s
  3882  2824 77025.3995   15  364 60526.8783 77025.3995  27.3%  1275  212s
  3886  2830 77025.3995   16  348 60526.8783 77025.3995  27.3%  1277  215s
  3894  2844 76741.2931   17  317 60526.8783 77025.3995  27.3%  1283  220s
  3910  2869 76390.8792   18  326 60526.8783 77025.3995  27.3%  1301  226s
  3973  2930 74171.2454   20  286 60526.8783 76421.0355  26.3%  1378  233s
  4048  2941 72155.9324   22  277 60526.8783 76421.0355  26.3%  1407  236s
  4175  2954 61890.4542   25  182 60526.8783 76330.9499  26.1%  1447  242s
  4246  2959 68002.5905   26  172 60526.8783 76330.9499  26.1%  1452  245s
  4390  2981 64847.1118   29  140 60526.8783 75609.5898  24.9%  1464  250s
H 4476  2828                    61416.488504 75341.7315  22.7%  1471  252s
  4570  2826 61626.1138   33   71 61416.4885 74422.5269  21.2%  1475  258s
H 4574  2690                    61571.972138 74422.5269  20.9%  1475  258s
H 4575  2563                    61610.761151 74422.5269  20.8%  1475  258s
  4631  2559 67952.3068   23  250 61610.7612 74422.5269  20.8%  1480  261s
H 4694  2422                    61736.720926 74422.5269  20.5%  1487  263s
  4751  2433 62436.0658   26  186 61736.7209 74422.5269  20.5%  1492  265s
H 4837  2312                    61767.878511 74422.5269  20.5%  1492  269s
H 4875  2191                    61778.087452 74350.9890  20.4%  1494  269s
  4895  2191     cutoff   27      61778.0875 74350.9890  20.4%  1494  271s
H 4965  2077                    61824.743497 73704.8250  19.2%  1494  274s
  5002  2090 66139.9679   23  234 61824.7435 73704.8250  19.2%  1495  276s
  5183  2059 66712.8418   23  264 61824.7435 73704.8250  19.2%  1497  282s
  5344  2019 69379.8128   24  291 61824.7435 72659.7705  17.5%  1497  288s
  5402  2014 65464.3703   25  238 61824.7435 72531.1884  17.3%  1498  291s
  5484  2011 64857.1959   26  251 61824.7435 71350.3415  15.4%  1497  295s
  5690  1964     cutoff   28      61824.7435 71275.1648  15.3%  1498  301s
  5837  1917     cutoff   28      61824.7435 71240.0856  15.2%  1493  306s
  5992  1870 63262.6084   24  216 61824.7435 71240.0856  15.2%  1486  310s
  6184  1815 65211.1826   23  282 61824.7435 70662.8944  14.3%  1492  317s
  6345  1758 63237.3647   24  260 61824.7435 70351.5333  13.8%  1492  323s
  6411  1747     cutoff   25      61824.7435 70351.5333  13.8%  1492  327s
  6506  1694 65811.4113   25  156 61824.7435 70137.8543  13.4%  1490  331s
  6674  1658 65270.1858   26  136 61824.7435 69779.4508  12.9%  1482  335s
  7095  1503 64235.5024   25  250 61824.7435 68429.3202  10.7%  1463  343s
  7317  1421 62672.8201   29  197 61824.7435 68260.2708  10.4%  1456  348s
  7589  1310     cutoff   26      61824.7435 68068.3845  10.1%  1441  353s
  7754  1231     cutoff   27      61824.7435 67122.3593  8.57%  1435  358s
  7982  1108     cutoff   28      61824.7435 66765.1815  7.99%  1428  363s
  8255   890     cutoff   25      61824.7435 66221.7567  7.11%  1416  368s
  8583   576     cutoff   26      61824.7435 65543.1530  6.01%  1401  372s
  8969   280     cutoff   23      61824.7435 64812.8434  4.83%  1377  378s

Cutting planes:
  Learned: 1
  Lift-and-project: 1
  MIR: 207
  Mixing: 1
  Flow cover: 421
  RLT: 12
  Relax-and-lift: 42

Explored 9314 nodes (12531311 simplex iterations) in 378.99 seconds (1143.38 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 61824.7 61778.1 61767.9 ... 60490.1

Optimal solution found (tolerance 1.00e-06)
Best objective 6.182474349671e+04, best bound 6.182474349671e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 379.00s
  Master Objective (UB) = 61824.74, θ = 229464.35
  Upper Bound (UB) = 61824.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229464.35
  [DEBUG]   ✓ Scenario 0: θ = 229464.35 ≤ Q = 229464.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229464.35 ≤ Q = 229464.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229464.35 ≤ Q = 229464.35 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64c4737f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9b3b8c81
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.464722e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7247954.9432
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.968614e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196861.44    0  125 7247954.94 -196861.44   103%     -    0s
H    0     0                    -161094.8568 -196861.44  22.2%     -    0s
H    0     0                    -161284.1578 -196861.44  22.1%     -    0s
     0     0 -177149.64    0   97 -161284.16 -177149.64  9.84%     -    0s
H    0     0                    -166704.3074 -177028.46  6.19%     -    0s
H    0     0                    -172168.5010 -177028.46  2.82%     -    0s
H    0     0                    -173277.4688 -177028.46  2.16%     -    0s
H    0     0                    -174862.7086 -177028.46  1.24%     -    0s
     0     0 -175948.75    0   86 -174862.71 -175948.75  0.62%     -    0s
     0     0 -175927.06    0   86 -174862.71 -175927.06  0.61%     -    0s
     0     0 -175801.72    0   79 -174862.71 -175801.72  0.54%     -    0s
     0     0 -175800.24    0   79 -174862.71 -175800.24  0.54%     -    0s
     0     2 -175799.92    0   79 -174862.71 -175799.92  0.54%     -    0s
H  131   139                    -174890.2052 -175545.80  0.37%  15.6    0s

Cutting planes:
  Gomory: 42
  MIR: 166
  Flow cover: 12
  RLT: 8
  Relax-and-lift: 1

Explored 3038 nodes (20442 simplex iterations) in 0.17 seconds (0.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -174890 -174863 -173277 ... 1.46472e+13
No other solutions better than -174890

Optimal solution found (tolerance 1.00e-06)
Best objective -1.748902051684e+05, best bound -1.748902051684e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 218564.43
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174890.21
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -174890.21 = 218564.43
  [DEBUG]   Current θ from Master = 229464.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10899.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50924.82
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 8497.7963, Absolute Gap = 8497.7963, Relative Gap = 0.137450
  Not converged yet (gap = 8497.80 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x2410db4e
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 50924.8 (0.03s)
Loaded MIP start from previous solve with objective 50924.8

Presolve removed 25452 rows and 10332 columns
Presolve time: 0.58s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58509    7.2216800e+04   0.000000e+00   6.081398e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 9.198713e+04, 20920 iterations, 5.55 seconds (10.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91987.1268    0   78 50924.8237 91987.1268  80.6%     -    6s
H    0     0                    51420.169103 91987.1268  78.9%     -    6s
H    0     0                    55736.552497 91987.1268  65.0%     -    6s
H    0     0                    56828.958714 91987.1268  61.9%     -    6s
H    0     0                    57093.742195 91987.1268  61.1%     -    6s
H    0     0                    57637.173874 91987.1268  59.6%     -    6s
H    0     0                    57850.017424 91987.1268  59.0%     -    6s
     0     0 86691.9604    0  177 57850.0174 86691.9604  49.9%     -   10s
H    0     0                    58147.786433 86691.4808  49.1%     -   10s
     0     0 86388.5081    0  231 58147.7864 86388.5081  48.6%     -   12s
     0     0 86388.5081    0  185 58147.7864 86388.5081  48.6%     -   12s
     0     0 86388.5081    0  185 58147.7864 86388.5081  48.6%     -   12s
     0     0 86388.5081    0  184 58147.7864 86388.5081  48.6%     -   13s
H    0     0                    58175.307630 83923.8328  44.3%     -   15s
H    0     0                    58415.925948 83923.8328  43.7%     -   15s
H    0     0                    58678.174407 83923.8328  43.0%     -   15s
H    0     0                    60178.684707 83923.8328  39.5%     -   15s
     0     0 83923.8328    0  251 60178.6847 83923.8328  39.5%     -   15s
     0     0 83413.3065    0  239 60178.6847 83413.3065  38.6%     -   17s
     0     0 83371.8693    0  255 60178.6847 83371.8693  38.5%     -   17s
     0     0 83215.6574    0  276 60178.6847 83215.6574  38.3%     -   18s
     0     0 83204.2162    0  273 60178.6847 83204.2162  38.3%     -   18s
     0     0 83199.1889    0  273 60178.6847 83199.1889  38.3%     -   18s
     0     0 83198.0192    0  277 60178.6847 83198.0192  38.3%     -   19s
     0     0 83195.7994    0  278 60178.6847 83195.7994  38.2%     -   19s
     0     0 83195.4194    0  280 60178.6847 83195.4194  38.2%     -   19s
H    0     0                    60212.661558 83195.4194  38.2%     -   21s
H    0     0                    61143.290518 83195.4194  36.1%     -   21s
H    0     0                    61622.984939 83195.4194  35.0%     -   21s
     0     0 81033.9994    0  340 61622.9849 81033.9994  31.5%     -   24s
     0     0 80593.3307    0  364 61622.9849 80593.3307  30.8%     -   27s
     0     0 80445.1799    0  379 61622.9849 80445.1799  30.5%     -   28s
     0     0 80370.7794    0  381 61622.9849 80370.7794  30.4%     -   29s
     0     0 80333.5891    0  376 61622.9849 80333.5891  30.4%     -   29s
     0     0 80314.9892    0  380 61622.9849 80314.9892  30.3%     -   30s
     0     0 80294.5439    0  384 61622.9849 80294.5439  30.3%     -   30s
     0     0 80286.1696    0  383 61622.9849 80286.1696  30.3%     -   31s
     0     0 80282.8323    0  393 61622.9849 80282.8323  30.3%     -   31s
     0     0 80282.4258    0  391 61622.9849 80282.4258  30.3%     -   31s
     0     0 79652.1603    0  365 61622.9849 79652.1603  29.3%     -   37s
     0     0 79381.9069    0  395 61622.9849 79381.9069  28.8%     -   39s
     0     0 79316.5505    0  397 61622.9849 79316.5505  28.7%     -   39s
     0     0 79308.2570    0  352 61622.9849 79308.2570  28.7%     -   40s
     0     0 79285.0665    0  357 61622.9849 79285.0665  28.7%     -   40s
     0     0 79273.5784    0  402 61622.9849 79273.5784  28.6%     -   41s
     0     0 79265.8425    0  358 61622.9849 79265.8425  28.6%     -   41s
     0     0 79264.7862    0  364 61622.9849 79264.7862  28.6%     -   41s
     0     0 79231.8423    0  439 61622.9849 79231.8423  28.6%     -   42s
     0     0 79193.8481    0  397 61622.9849 79193.8481  28.5%     -   43s
     0     0 79170.6484    0  434 61622.9849 79170.6484  28.5%     -   43s
     0     0 79156.4448    0  434 61622.9849 79156.4448  28.5%     -   44s
     0     0 79150.1352    0  445 61622.9849 79150.1352  28.4%     -   44s
     0     0 79146.3288    0  385 61622.9849 79146.3288  28.4%     -   44s
     0     0 79143.6692    0  390 61622.9849 79143.6692  28.4%     -   45s
     0     0 79142.2561    0  393 61622.9849 79142.2561  28.4%     -   45s
     0     0 79089.8084    0  410 61622.9849 79089.8084  28.3%     -   46s
     0     0 79046.2535    0  436 61622.9849 79046.2535  28.3%     -   47s
     0     0 79034.5783    0  427 61622.9849 79034.5783  28.3%     -   48s
     0     0 79030.0244    0  458 61622.9849 79030.0244  28.2%     -   49s
     0     0 79026.7333    0  472 61622.9849 79026.7333  28.2%     -   49s
     0     0 79025.0533    0  468 61622.9849 79025.0533  28.2%     -   49s
     0     0 79023.3940    0  474 61622.9849 79023.3940  28.2%     -   49s
     0     0 79023.0974    0  469 61622.9849 79023.0974  28.2%     -   49s
     0     0 79008.9279    0  433 61622.9849 79008.9279  28.2%     -   50s
     0     0 78999.0685    0  425 61622.9849 78999.0685  28.2%     -   51s
     0     0 78997.3856    0  440 61622.9849 78997.3856  28.2%     -   51s
     0     0 78997.0216    0  422 61622.9849 78997.0216  28.2%     -   51s
     0     0 78993.3578    0  414 61622.9849 78993.3578  28.2%     -   52s
     0     0 78992.4473    0  412 61622.9849 78992.4473  28.2%     -   52s
     0     0 78985.6202    0  389 61622.9849 78985.6202  28.2%     -   53s
     0     0 78982.4684    0  440 61622.9849 78982.4684  28.2%     -   53s
     0     0 78982.2788    0  438 61622.9849 78982.2788  28.2%     -   53s
     0     0 78968.4850    0  354 61622.9849 78968.4850  28.1%     -   54s
     0     0 78958.4157    0  384 61622.9849 78958.4157  28.1%     -   54s
     0     0 78957.0426    0  382 61622.9849 78957.0426  28.1%     -   54s
     0     0 78955.5429    0  383 61622.9849 78955.5429  28.1%     -   55s
     0     0 78953.7312    0  380 61622.9849 78953.7312  28.1%     -   55s
     0     0 78953.7312    0  360 61622.9849 78953.7312  28.1%     -   55s
     0     0 78953.7312    0  359 61622.9849 78953.7312  28.1%     -   56s
     0     0 78951.9055    0  354 61622.9849 78951.9055  28.1%     -   56s
     0     0 78951.5240    0  354 61622.9849 78951.5240  28.1%     -   56s
     0     2 78951.5240    0  354 61622.9849 78951.5240  28.1%     -   64s
     1     4 78917.4766    1  351 61622.9849 78950.7195  28.1%  1143   65s
     3     8 78826.0956    2  344 61622.9849 78916.5131  28.1%  1880   70s
     7    16 78734.3326    3  338 61622.9849 78825.3640  27.9%  4478   75s
    31    53 75771.2753    5  438 61622.9849 78278.1789  27.0%  6387   87s
    52    85 74943.0078    6  396 61622.9849 78278.1789  27.0%  8426   91s
    84   197 74903.9767    7  375 61622.9849 78278.1789  27.0%  6225   99s
   196   296 74644.5642    9  349 61622.9849 78278.1789  27.0%  3759  105s
   382   415 74328.3267   10  332 61622.9849 78278.1789  27.0%  2914  111s
   446   479 74539.8375   10  346 61622.9849 78278.1789  27.0%  2753  117s
   478   511 74446.7931   10  361 61622.9849 78278.1789  27.0%  2700  121s
   542   575 74482.5261   10  297 61622.9849 78278.1789  27.0%  2617  126s
   607   641 73643.6334   10  272 61622.9849 78278.1789  27.0%  2606  131s
   673   716 74171.9096   11  305 61622.9849 78278.1789  27.0%  2539  137s
   715   772 74401.2168   11  331 61622.9849 78278.1789  27.0%  2513  140s
   833   903 73410.0378   11  320 61622.9849 78278.1789  27.0%  2396  145s
   991  1053 73513.7932   11  312 61622.9849 78278.1789  27.0%  2299  152s
  1084  1112 74217.5996   12  332 61622.9849 78278.1789  27.0%  2258  156s
  1172  1175 74310.6109   12  330 61622.9849 78278.1789  27.0%  2272  162s
  1265  1219 73368.4214   11  308 61622.9849 78278.1789  27.0%  2305  169s
  1334  1275 73959.3780   12  355 61622.9849 78278.1789  27.0%  2379  174s
  1410  1335 74265.3518   12  343 61622.9849 77843.8468  26.3%  2471  179s
  1470  1397 74141.1089   13  333 61622.9849 77843.8468  26.3%  2557  184s
  1551  1446 73242.1540   12  310 61622.9849 77843.8468  26.3%  2585  189s
  1630  1504 73055.9000   13  301 61622.9849 77393.4133  25.6%  2646  194s
  1704  1583 73513.1863   14  328 61622.9849 77070.1702  25.1%  2720  198s
  1797  1686 73338.7908   15  307 61622.9849 77070.1702  25.1%  2768  204s
  1927  1797 71837.5708   16  271 61622.9849 77070.1702  25.1%  2768  209s
  2082  1915 70437.0189   18  240 61622.9849 77070.1702  25.1%  2750  214s
  2239  2023 70077.9654   19  243 61622.9849 77070.1702  25.1%  2725  221s
  2405  2132 69556.0533   21  244 61622.9849 77070.1702  25.1%  2711  228s
  2578  2284 67130.3315   21  273 61622.9849 76880.1279  24.8%  2704  234s
  2783  2418 67741.9495   24  230 61622.9849 76803.3284  24.6%  2674  240s
  2983  2539 66959.0450   30  184 61622.9849 76432.7038  24.0%  2653  248s
  3142  2686 66515.8321   35  195 61622.9849 76432.7038  24.0%  2663  255s
  3343  2867 66073.5243   46  150 61622.9849 76432.7038  24.0%  2631  261s
  3603  2868 65388.7525   15  354 61622.9849 76100.8591  23.5%  2567  276s
  3605  2869 63058.5432   70   78 61622.9849 76100.8591  23.5%  2565  284s
  3606  2870 66934.0425   13  333 61622.9849 76100.8591  23.5%  2564  292s
  3607  2871 65403.4593   50  361 61622.9849 76100.8591  23.5%  2564  295s
  3609  2872 71955.3239   35  438 61622.9849 76100.8591  23.5%  2562  302s
  3612  2874 62849.8045   31  437 61622.9849 76100.8591  23.5%  2560  305s
  3616  2877 66532.5974   33  389 61622.9849 76100.8591  23.5%  2557  311s
  3620  2879 71665.0475   29  462 61622.9849 76100.8591  23.5%  2554  316s
  3624  2882 62875.3959   55  463 61622.9849 76100.8591  23.5%  2552  321s
  3627  2884 66715.6030   25  419 61622.9849 76100.8591  23.5%  2550  326s
  3630  2886 70171.8403   32  412 61622.9849 76100.8591  23.5%  2547  330s
  3632  2887 66606.4579   43  400 61622.9849 76100.8591  23.5%  2546  340s
  3633  2888 66852.5412   30  400 61622.9849 76100.8591  23.5%  2545  350s
  3634  2892 76100.8591   15  390 61622.9849 76100.8591  23.5%  2570  357s
  3636  2895 76100.8591   16  466 61622.9849 76100.8591  23.5%  2573  364s
  3640  2902 76100.8591   17  464 61622.9849 76100.8591  23.5%  2574  370s
  3648  2915 76100.8591   18  464 61622.9849 76100.8591  23.5%  2582  378s
  3664  2931 73488.7539   19  302 61622.9849 76100.8591  23.5%  2601  388s
  3685  2956 75559.2756   20  390 61622.9849 76100.8591  23.5%  2653  395s
  3717  3058 74807.1256   21  380 61622.9849 76100.8591  23.5%  2664  403s
  3830  3091 73965.2673   23  377 61622.9849 76100.8591  23.5%  2691  408s
  3905  3120 72719.6808   23  365 61622.9849 76100.8591  23.5%  2697  415s
  3976  3149 73154.0887   23  330 61622.9849 76100.8591  23.5%  2699  422s
  4046  3168 72556.8701   25  359 61622.9849 76100.8591  23.5%  2703  429s
  4121  3174 72101.9299   24  354 61622.9849 76100.8591  23.5%  2693  434s
  4200  3168 70520.5278   24  309 61622.9849 76100.8591  23.5%  2685  440s
  4240  3181 70179.2787   25  335 61622.9849 76100.8591  23.5%  2695  445s
  4296  3179 72022.0018   26  311 61622.9849 76100.8591  23.5%  2694  454s
  4339  3185 69077.7692   26  376 61622.9849 76100.8591  23.5%  2697  459s
  4395  3187 68471.2286   27  295 61622.9849 76100.8591  23.5%  2700  466s
  4440  3193 70130.5434   27  310 61622.9849 76100.8591  23.5%  2703  474s
  4491  3189 62103.2639   28  356 61622.9849 76100.8591  23.5%  2706  483s
  4555  3192 67436.5489   27  317 61622.9849 76100.8591  23.5%  2705  489s
  4614  3203 62356.4868   27  312 61622.9849 76000.5967  23.3%  2708  495s
  4661  3220 68139.6793   28  298 61622.9849 75623.7153  22.7%  2714  501s
  4727  3238 63428.6284   28  341 61622.9849 75623.7153  22.7%  2713  506s
  4801  3253 67245.1981   30  315 61622.9849 75623.7153  22.7%  2712  513s
  4886  3261 65387.7265   31  317 61622.9849 75623.7153  22.7%  2709  520s
  4992  3246 64130.1018   32  274 61622.9849 75623.7153  22.7%  2699  528s
  5059  3269 62581.5045   33  242 61622.9849 74962.9177  21.6%  2697  534s
  5142  3272     cutoff   35      61622.9849 74887.3806  21.5%  2694  541s
  5202  3313 72600.9376   24  381 61622.9849 74259.4954  20.5%  2694  547s
  5282  3334 64213.4455   26  275 61622.9849 74233.9856  20.5%  2698  554s
  5384  3344 63679.7751   28  314 61622.9849 74233.9856  20.5%  2695  562s
  5517  3326 infeasible   30      61622.9849 74233.9856  20.5%  2682  571s
  5649  3321 69367.5258   26  308 61622.9849 74081.2960  20.2%  2674  578s
  5776  3328 66715.3723   28  276 61622.9849 73937.6657  20.0%  2674  588s
  5912  3284 64162.2955   30  255 61622.9849 73666.7613  19.5%  2665  596s
  6058  3263 62219.1952   32  180 61622.9849 73092.5724  18.6%  2662  605s
  6162  3250 68868.3889   25  343 61622.9849 73092.5724  18.6%  2657  614s
  6281  3243 64349.6566   28  325 61622.9849 73084.3903  18.6%  2654  624s
  6416  3243 64776.5824   30  276 61622.9849 73084.3903  18.6%  2652  633s
  6579  3205 62456.1418   37  142 61622.9849 73084.3903  18.6%  2641  646s
  6767  3183 62295.2642   27  257 61622.9849 72606.0055  17.8%  2634  658s
  6937  3133     cutoff   28      61622.9849 72606.0055  17.8%  2633  665s
  6992  3123 66743.1191   28  280 61622.9849 72606.0055  17.8%  2634  672s
  7044  3115 65255.7939   29  256 61622.9849 72606.0055  17.8%  2633  682s
  7140  3111     cutoff   30      61622.9849 72606.0055  17.8%  2627  692s
  7273  3104     cutoff   34      61622.9849 72376.8922  17.5%  2621  703s
  7411  3115 67776.3421   23  296 61622.9849 72105.8088  17.0%  2613  714s
  7637  3108 65490.0300   24  256 61622.9849 71933.4877  16.7%  2601  726s
  7849  3072 64143.9378   25  275 61622.9849 71774.1359  16.5%  2600  738s
  8085  3043     cutoff   27      61622.9849 71774.1359  16.5%  2597  752s
  8342  3009 62850.3710   29  167 61622.9849 71421.3619  15.9%  2595  764s
  8655  2932 infeasible   24      61622.9849 71279.9798  15.7%  2578  779s
  8921  2869     cutoff   25      61622.9849 71279.9798  15.7%  2579  795s
  9189  2855 62639.5748   26  233 61622.9849 71279.9798  15.7%  2569  809s
  9577  2817 63453.9021   24  294 61622.9849 71196.7762  15.5%  2547  823s
  9947  2736 63240.7283   25  226 61622.9849 70899.7819  15.1%  2533  840s
 10405  2630 63820.6329   25  318 61622.9849 70684.4087  14.7%  2502  857s
 10820  2537 61752.5921   29  282 61622.9849 70439.1461  14.3%  2487  873s
 11157  2452 63021.4908   25  318 61622.9849 70393.4928  14.2%  2478  889s
 11569  2364 62138.1745   27  263 61622.9849 70047.0630  13.7%  2471  906s
 11989  2294 63344.7310   30  189 61622.9849 69359.2819  12.6%  2462  925s
 12488  2242     cutoff   24      61622.9849 69249.1808  12.4%  2445  943s
 12942  2259     cutoff   31      61622.9849 68901.4076  11.8%  2440  961s
 13144  2329 64591.9156   29  314 61622.9849 68854.1876  11.7%  2441  980s
 13715  2409 64376.3760   24  244 61622.9849 68595.6469  11.3%  2416 1000s
 14350  2444     cutoff   31      61622.9849 68259.7045  10.8%  2392 1019s
 14927  2480     cutoff   28      61622.9849 67972.0405  10.3%  2382 1042s
 15563  2491     cutoff   35      61622.9849 67615.9066  9.73%  2368 1063s
 16253  2485     cutoff   28      61622.9849 67289.6470  9.20%  2347 1085s
 16955  2456     cutoff   30      61622.9849 67044.9646  8.80%  2331 1108s
 17704  2411     cutoff   27      61622.9849 66725.6769  8.28%  2313 1132s
 18497  2326 62924.5143   28  194 61622.9849 66260.2398  7.53%  2295 1156s
 19404  2210 infeasible   29      61622.9849 65911.0925  6.96%  2269 1182s
 20326  2047 62214.1988   37  232 61622.9849 65527.0755  6.34%  2246 1207s
 21259  1807 62313.7619   31  218 61622.9849 65155.0669  5.73%  2224 1232s
 22356  1398 62875.0464   29  224 61622.9849 64695.7945  4.99%  2192 1258s
 23628   712 62671.4071   33  163 61622.9849 64211.8452  4.20%  2148 1283s
 25157    13 62179.6327   33  214 61622.9849 63545.2109  3.12%  2088 1304s

Cutting planes:
  Learned: 2
  MIR: 537
  Mixing: 4
  Flow cover: 993
  RLT: 12
  Relax-and-lift: 109

Explored 26206 nodes (53429521 simplex iterations) in 1304.98 seconds (4325.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 61623 61143.3 60212.7 ... 57637.2

Optimal solution found (tolerance 1.00e-06)
Best objective 6.162298493903e+04, best bound 6.162298493903e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1304.99s
  Master Objective (UB) = 61622.98, θ = 230405.02
  Upper Bound (UB) = 61622.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 230405.02
  [DEBUG]   ✓ Scenario 0: θ = 230405.02 ≤ Q = 230405.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 230405.02 ≤ Q = 230405.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 230405.02 ≤ Q = 230405.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 230405.02 ≤ Q = 230405.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35a62f21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca59d0df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462804e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7245936.7728
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.969533e+05, 278 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196953.33    0  134 7245936.77 -196953.33   103%     -    0s
H    0     0                    -157081.1080 -196953.33  25.4%     -    0s
H    0     0                    -157748.4684 -196953.33  24.9%     -    0s
H    0     0                    -164717.9318 -196953.33  19.6%     -    0s
H    0     0                    -179604.8454 -196953.33  9.66%     -    0s
     0     0 -182600.25    0   92 -179604.85 -182600.25  1.67%     -    0s
H    0     0                    -179709.5507 -182598.75  1.61%     -    0s
H    0     0                    -180301.2875 -182598.75  1.27%     -    0s
     0     0 -181895.01    0   70 -180301.29 -181895.01  0.88%     -    0s
     0     0 -181894.55    0   69 -180301.29 -181894.55  0.88%     -    0s
     0     0 -181434.35    0   81 -180301.29 -181434.35  0.63%     -    0s
H    0     0                    -180501.7704 -181383.84  0.49%     -    0s
H    0     0                    -180581.2935 -181383.84  0.44%     -    0s
     0     0 -181366.18    0   83 -180581.29 -181366.18  0.43%     -    0s
     0     0 -181366.18    0   82 -180581.29 -181366.18  0.43%     -    0s
     0     0 -181280.45    0   76 -180581.29 -181280.45  0.39%     -    0s
     0     0 -181278.48    0   75 -180581.29 -181278.48  0.39%     -    0s
     0     0 -181258.88    0   77 -180581.29 -181258.88  0.38%     -    0s
     0     0 -181258.76    0   77 -180581.29 -181258.76  0.38%     -    0s
     0     0 -181118.16    0   79 -180581.29 -181118.16  0.30%     -    0s
     0     0 -181114.84    0   80 -180581.29 -181114.84  0.30%     -    0s
     0     0 -181053.44    0   76 -180581.29 -181053.44  0.26%     -    0s
     0     0 -181050.62    0   76 -180581.29 -181050.62  0.26%     -    0s
     0     2 -181047.03    0   76 -180581.29 -181047.03  0.26%     -    0s
H   35    12                    -180644.7346 -180756.79  0.06%  14.5    0s

Cutting planes:
  Gomory: 51
  Implied bound: 4
  MIR: 110
  Flow cover: 21
  RLT: 55
  Relax-and-lift: 1

Explored 127 nodes (1749 simplex iterations) in 0.09 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -180645 -180581 -180502 ... 7.24594e+06
No other solutions better than -180645

Optimal solution found (tolerance 1.00e-06)
Best objective -1.806447346331e+05, best bound -1.806447346331e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 212809.90
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -180644.73
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -180644.73 = 212809.90
  [DEBUG]   Current θ from Master = 230405.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17595.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44027.86
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 8296.0377, Absolute Gap = 8296.0377, Relative Gap = 0.134626
  Not converged yet (gap = 8296.04 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0x0537d779
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 0.73s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219165.9246

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32520    1.8780647e+04   0.000000e+00   6.306666e+06      5s
Concurrent spin time: 0.27s

Solved with dual simplex

Root relaxation: objective 9.198713e+04, 25561 iterations, 7.52 seconds (14.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91987.1268    0   78 -219165.92 91987.1268   142%     -    8s
H    0     0                    -208295.6306 91987.1268   144%     -    8s
H    0     0                    -190527.2623 91987.1268   148%     -    8s
H    0     0                    -190433.4393 91987.1268   148%     -    8s
H    0     0                    -98550.44029 91987.1268   193%     -    8s
H    0     0                    -49244.65091 91987.1268   287%     -    8s
H    0     0                    14108.992218 91987.1268   552%     -    8s
H    0     0                    37631.657931 91987.1268   144%     -    8s
H    0     0                    39331.770379 91987.1268   134%     -    8s
H    0     0                    44389.380698 91987.1268   107%     -    9s
H    0     0                    44404.011640 91986.8737   107%     -    9s
H    0     0                    44449.841095 91986.8737   107%     -    9s
H    0     0                    44502.945843 91986.8737   107%     -    9s
H    0     0                    44802.071215 91986.8737   105%     -    9s
H    0     0                    48158.627896 86811.6092  80.3%     -   13s
     0     0 86811.6092    0  196 48158.6279 86811.6092  80.3%     -   13s
H    0     0                    48236.910313 86811.3902  80.0%     -   14s
H    0     0                    48291.548348 86473.9103  79.1%     -   15s
H    0     0                    48413.758389 86473.9103  78.6%     -   15s
     0     0 86473.9103    0  217 48413.7584 86473.9103  78.6%     -   15s
     0     0 86457.1890    0  215 48413.7584 86457.1890  78.6%     -   16s
     0     0 86456.5662    0  215 48413.7584 86456.5662  78.6%     -   16s
     0     0 86456.3455    0  215 48413.7584 86456.3455  78.6%     -   16s
H    0     0                    49166.029391 83644.0843  70.1%     -   22s
H    0     0                    49229.785469 83644.0843  69.9%     -   22s
H    0     0                    49768.507850 83644.0843  68.1%     -   22s
H    0     0                    49975.602982 83644.0843  67.4%     -   22s
     0     0 83589.1742    0  270 49975.6030 83589.1742  67.3%     -   22s
H    0     0                    50243.508023 83589.1742  66.4%     -   22s
H    0     0                    50318.190688 83589.1742  66.1%     -   22s
H    0     0                    50595.096853 83589.1742  65.2%     -   22s
     0     0 83007.2353    0  272 50595.0969 83007.2353  64.1%     -   25s
     0     0 82883.5531    0  240 50595.0969 82883.5531  63.8%     -   27s
     0     0 82870.2199    0  286 50595.0969 82870.2199  63.8%     -   27s
     0     0 82864.9507    0  284 50595.0969 82864.9507  63.8%     -   28s
     0     0 82864.0124    0  285 50595.0969 82864.0124  63.8%     -   28s
     0     0 82863.0627    0  284 50595.0969 82863.0627  63.8%     -   28s
     0     0 82862.8587    0  284 50595.0969 82862.8587  63.8%     -   28s
     0     0 81132.5996    0  343 50595.0969 81132.5996  60.4%     -   38s
H    0     0                    50993.761499 81131.0743  59.1%     -   38s
H    0     0                    51010.619902 81131.0743  59.0%     -   38s
H    0     0                    51031.859678 81131.0743  59.0%     -   38s
H    0     0                    51092.166978 81131.0743  58.8%     -   38s
     0     0 80693.4721    0  344 51092.1670 80693.4721  57.9%     -   43s
     0     0 80483.5486    0  351 51092.1670 80483.5486  57.5%     -   45s
     0     0 80427.2964    0  360 51092.1670 80427.2964  57.4%     -   46s
     0     0 80359.5681    0  363 51092.1670 80359.5681  57.3%     -   48s
     0     0 80341.8787    0  367 51092.1670 80341.8787  57.2%     -   49s
     0     0 80330.3187    0  371 51092.1670 80330.3187  57.2%     -   49s
     0     0 80308.6211    0  323 51092.1670 80308.6211  57.2%     -   50s
     0     0 80303.1716    0  358 51092.1670 80303.1716  57.2%     -   51s
     0     0 80300.4567    0  318 51092.1670 80300.4567  57.2%     -   51s
     0     0 80300.4371    0  318 51092.1670 80300.4371  57.2%     -   52s
H    0     0                    51607.173291 79711.8115  54.5%     -   59s
H    0     0                    52426.608746 79711.8115  52.0%     -   59s
H    0     0                    52427.989058 79711.8115  52.0%     -   59s
H    0     0                    52683.992967 79711.8115  51.3%     -   59s
     0     0 79711.8115    0  378 52683.9930 79711.8115  51.3%     -   59s
     0     0 79611.4491    0  385 52683.9930 79611.4491  51.1%     -   60s
     0     0 79566.7805    0  385 52683.9930 79566.7805  51.0%     -   61s
     0     0 79538.9169    0  426 52683.9930 79538.9169  51.0%     -   62s
     0     0 79535.3744    0  399 52683.9930 79535.3744  51.0%     -   62s
     0     0 79527.1158    0  399 52683.9930 79527.1158  51.0%     -   63s
     0     0 79517.4451    0  436 52683.9930 79517.4451  50.9%     -   63s
     0     0 79510.6028    0  402 52683.9930 79510.6028  50.9%     -   63s
     0     0 79490.9790    0  402 52683.9930 79490.9790  50.9%     -   64s
     0     0 79486.0189    0  406 52683.9930 79486.0189  50.9%     -   64s
     0     0 79481.6611    0  411 52683.9930 79481.6611  50.9%     -   65s
     0     0 79481.1224    0  413 52683.9930 79481.1224  50.9%     -   65s
     0     0 79269.9201    0  345 52683.9930 79269.9201  50.5%     -   67s
H    0     0                    52726.106024 79269.3369  50.3%     -   67s
H    0     0                    52774.339303 79269.3369  50.2%     -   67s
     0     0 79184.8691    0  445 52774.3393 79184.8691  50.0%     -   69s
     0     0 79129.3665    0  441 52774.3393 79129.3665  49.9%     -   70s
     0     0 79123.5921    0  407 52774.3393 79123.5921  49.9%     -   71s
     0     0 79110.8283    0  448 52774.3393 79110.8283  49.9%     -   72s
     0     0 79108.5211    0  445 52774.3393 79108.5211  49.9%     -   72s
     0     0 79107.5526    0  346 52774.3393 79107.5526  49.9%     -   72s
     0     0 79070.6355    0  397 52774.3393 79070.6355  49.8%     -   73s
     0     0 79063.6958    0  416 52774.3393 79063.6958  49.8%     -   74s
     0     0 79050.9724    0  442 52774.3393 79050.9724  49.8%     -   75s
     0     0 79047.5383    0  394 52774.3393 79047.5383  49.8%     -   75s
     0     0 79046.4495    0  399 52774.3393 79046.4495  49.8%     -   76s
     0     0 79035.5442    0  383 52774.3393 79035.5442  49.8%     -   77s
     0     0 79030.5788    0  433 52774.3393 79030.5788  49.8%     -   77s
     0     0 79028.6777    0  440 52774.3393 79028.6777  49.7%     -   77s
     0     0 79027.7377    0  436 52774.3393 79027.7377  49.7%     -   78s
     0     0 79023.6005    0  358 52774.3393 79023.6005  49.7%     -   78s
H    0     0                    53056.147101 79022.6352  48.9%     -   79s
H    0     0                    53177.213437 79022.6352  48.6%     -   79s
H    0     0                    53205.717862 79022.6352  48.5%     -   79s
H    0     0                    53216.205633 79022.6352  48.5%     -   80s
     0     0 79019.7825    0  406 53216.2056 79019.7825  48.5%     -   80s
     0     0 79018.7017    0  354 53216.2056 79018.7017  48.5%     -   80s
     0     0 79003.2746    0  430 53216.2056 79003.2746  48.5%     -   81s
H    0     0                    53409.793795 79002.9780  47.9%     -   81s
H    0     0                    53412.700074 79002.9780  47.9%     -   82s
     0     0 78992.6965    0  348 53412.7001 78992.6965  47.9%     -   82s
     0     0 78990.6624    0  437 53412.7001 78990.6624  47.9%     -   82s
     0     0 78989.9647    0  418 53412.7001 78989.9647  47.9%     -   82s
     0     0 78986.7127    0  432 53412.7001 78986.7127  47.9%     -   83s
H    0     0                    53433.518473 78986.4226  47.8%     -   84s
H    0     0                    53517.813119 78986.4226  47.6%     -   84s
     0     0 78983.0158    0  348 53517.8131 78983.0158  47.6%     -   85s
     0     0 78982.4448    0  352 53517.8131 78982.4448  47.6%     -   86s
     0     0 78973.4739    0  353 53517.8131 78973.4739  47.6%     -   86s
     0     0 78971.5050    0  348 53517.8131 78971.5050  47.6%     -   87s
     0     0 78970.9850    0  346 53517.8131 78970.9850  47.6%     -   87s
     0     0 78969.8656    0  345 53517.8131 78969.8656  47.6%     -   87s
     0     0 78967.8065    0  344 53517.8131 78967.8065  47.6%     -   88s
     0     0 78967.6160    0  348 53517.8131 78967.6160  47.6%     -   88s
     0     0 78967.5925    0  348 53517.8131 78967.5925  47.6%     -   88s
     0     0 78967.3699    0  348 53517.8131 78967.3699  47.6%     -   89s
H    0     0                    53689.020419 78967.3699  47.1%     -  100s
H    0     0                    55152.269306 78967.3699  43.2%     -  101s
H    0     0                    57143.069381 78967.3699  38.2%     -  101s
     0     2 78967.3699    0  348 57143.0694 78967.3699  38.2%     -  101s
     3     8 78815.5959    2  394 57143.0694 78838.6743  38.0%  3133  108s
     7    16 78599.2500    3  386 57143.0694 78802.3356  37.9%  4285  114s
    15    32 78386.2256    4  388 57143.0694 78635.4736  37.6%  4964  118s
    31    48 76087.9379    5  337 57143.0694 78445.1950  37.3%  7104  130s
    47    80 76896.7847    6  370 57143.0694 78445.1950  37.3%  7440  138s
H   48    80                    57262.307106 78445.1950  37.0%  7285  138s
H   50    80                    57395.331504 78445.1950  36.7%  7435  138s
H   63    80                    57406.507539 78445.1950  36.6%  7240  138s
H   67    80                    57459.547446 78445.1950  36.5%  6966  138s
H   68    80                    57482.756205 78445.1950  36.5%  6879  138s
H   70    80                    57549.827313 78445.1950  36.3%  6751  138s
H   73    80                    57622.681020 78445.1950  36.1%  6585  138s
    79   144 76720.1930    7  371 57622.6810 78445.1950  36.1%  6373  156s
   143   296 76645.0701    9  402 57622.6810 78445.1950  36.1%  5037  164s
   295   393 76393.4518   13  359 57622.6810 78445.1950  36.1%  3301  168s
   392   425 76279.7059   14  349 57622.6810 78445.1950  36.1%  2850  171s
   424   462 76217.3157   14  362 57622.6810 78445.1950  36.1%  2758  177s
   461   494 74362.9024   14  338 57622.6810 78445.1950  36.1%  2774  183s
   493   528 75942.3472   15  352 57622.6810 78445.1950  36.1%  2708  189s
H  498   528                    57780.984609 78445.1950  35.8%  2691  189s
   527   623 75899.3484   15  345 57780.9846 78445.1950  35.8%  2688  194s
   622   724 75196.5143   15  308 57780.9846 78445.1950  35.8%  2512  199s
   723   828 75584.5624   16  348 57780.9846 78445.1950  35.8%  2320  203s
   827   928 74645.9248   16  337 57780.9846 78445.1950  35.8%  2183  209s
   927  1029 75427.4253   17  342 57780.9846 78445.1950  35.8%  2070  212s
  1028  1061 74869.4341   16  306 57780.9846 78445.1950  35.8%  1985  215s
H 1029  1061                    58036.269320 78445.1950  35.2%  1983  215s
  1165  1195 75069.7941   18  344 58036.2693 78445.1950  35.2%  1895  225s
  1237  1285 74627.2320   18  343 58036.2693 78445.1950  35.2%  1872  233s
  1288  1348 74592.5020   18  336 58036.2693 78445.1950  35.2%  1843  236s
  1359  1437 74480.8281   17  358 58036.2693 78445.1950  35.2%  1787  243s
  1464  1468 74211.2857   17  321 58036.2693 78445.1950  35.2%  1722  247s
  1497  1516 74853.3951   19  342 58036.2693 78445.1950  35.2%  1718  250s
  1599  1630 68641.2136   19  330 58036.2693 78445.1950  35.2%  1689  260s
  1669  1673 73738.7067   20  338 58036.2693 78385.8252  35.1%  1660  266s
  1724  1729 74457.5963   19  337 58036.2693 78385.8252  35.1%  1648  270s
  1801  1794 74466.0200   20  337 58036.2693 78385.8252  35.1%  1625  277s
  1882  1849 73571.0393   21  346 58036.2693 78385.8252  35.1%  1616  283s
  1954  1882 71137.5373   21  272 58036.2693 78385.8252  35.1%  1619  290s
  2017  1944 71333.6485   22  249 58036.2693 78204.9403  34.8%  1637  296s
  2107  1958 71088.7841   23  280 58036.2693 78204.7465  34.8%  1636  302s
  2157  2007 70970.0754   23  233 58036.2693 78204.7465  34.8%  1664  311s
  2214  2120 70125.8133   24  245 58036.2693 78204.7465  34.8%  1693  318s
  2329  2171 71683.1523   22  330 58036.2693 78204.7465  34.8%  1681  328s
  2443  2293 64205.9456   24  236 58036.2693 78204.7465  34.8%  1668  336s
  2571  2413 68928.0194   23  228 58036.2693 78204.7465  34.8%  1661  344s
  2745  2557 69368.2295   25  246 58036.2693 78204.7465  34.8%  1627  354s
  2931  2719 68534.1070   24  232 58036.2693 77754.3243  34.0%  1603  361s
  3135  2898 61286.2546   27  159 58036.2693 77754.3243  34.0%  1586  369s
  3359  2899 71650.7406   12  348 58036.2693 77617.5038  33.7%  1565  391s
  3361  2900 70184.9586   28   78 58036.2693 77617.5038  33.7%  1565  407s
  3362  2901 70641.4915   25  299 58036.2693 77617.5038  33.7%  1564  418s
  3363  2902 66720.9509   61  343 58036.2693 77617.5038  33.7%  1564  426s
  3364  2902 75191.5077    7  378 58036.2693 77617.5038  33.7%  1563  431s
  3365  2903 60173.4630   54  399 58036.2693 77617.5038  33.7%  1563  435s
  3367  2904 70572.7273   45  398 58036.2693 77617.5038  33.7%  1562  441s
  3370  2906 74211.2335   18  353 58036.2693 77617.5038  33.7%  1560  445s
  3374  2909 63993.0978   30  408 58036.2693 77617.5038  33.7%  1559  450s
  3378  2912 72453.8110   14  409 58036.2693 77617.5038  33.7%  1557  455s
  3382  2914 63046.2104   74  369 58036.2693 77617.5038  33.7%  1555  460s
  3386  2917 62594.3643   89  368 58036.2693 77617.5038  33.7%  1553  465s
  3389  2919 66921.6191   62  378 58036.2693 77617.5038  33.7%  1552  471s
  3392  2921 66005.1836   48  382 58036.2693 77617.5038  33.7%  1550  475s
  3394  2922 71788.1726   32  490 58036.2693 77617.5038  33.7%  1549  481s
  3399  2926 68253.0937   27  436 58036.2693 77617.5038  33.7%  1547  486s
  3402  2928 74242.5719   23  412 58036.2693 77617.5038  33.7%  1546  506s
  3403  2928 68922.6989   22  412 58036.2693 77617.5038  33.7%  1545  520s
  3404  2932 77617.5038   13  364 58036.2693 77617.5038  33.7%  1594  534s
  3406  2935 77617.5038   14  453 58036.2693 77617.5038  33.7%  1598  546s
  3410  2942 77617.5038   15  459 58036.2693 77617.5038  33.7%  1605  557s
  3418  2955 77612.7530   16  409 58036.2693 77617.5038  33.7%  1621  572s
  3434  2969 74538.9892   17  328 58036.2693 77612.6371  33.7%  1676  601s
  3453  2994 73378.4816   18  376 58036.2693 77612.6371  33.7%  1726  619s
  3484  3108 73902.2942   19  344 58036.2693 77612.6371  33.7%  1781  636s
  3609  3142 71241.1800   23  320 58036.2693 77612.6371  33.7%  1885  647s
  3684  3157 70086.3559   26  304 58036.2693 77612.6371  33.7%  1940  656s
  3728  3208 70028.0080   27  296 58036.2693 77612.6371  33.7%  1961  666s
  3809  3246 69024.3742   29  263 58036.2693 77612.6371  33.7%  1993  676s
  3885  3284 68256.6622   33  222 58036.2693 77612.6371  33.7%  2015  685s
  3983  3271     cutoff   36      58036.2693 77612.6371  33.7%  2030  696s
  4020  3293 59855.1158   37  156 58036.2693 77612.6371  33.7%  2045  704s
  4069  3305 59676.4074   38  165 58036.2693 77612.6371  33.7%  2046  716s
  4160  3290     cutoff   42      58036.2693 77004.8181  32.7%  2048  725s
  4241  3285 69648.5180   18  379 58036.2693 77004.8181  32.7%  2056  734s
  4306  3290 68769.9100   19  338 58036.2693 77004.8181  32.7%  2078  745s
  4365  3309 67919.7424   21  410 58036.2693 77004.8181  32.7%  2102  754s
  4435  3327 66899.5604   24  242 58036.2693 77004.8181  32.7%  2124  764s
  4506  3365 64052.8217   26  275 58036.2693 76790.6324  32.3%  2142  774s
  4579  3416 63227.9008   30  193 58036.2693 75626.9140  30.3%  2159  783s
  4692  3467 62369.3268   33  202 58036.2693 75626.9140  30.3%  2160  795s
  4799  3495 59845.5480   36  117 58036.2693 74829.0236  28.9%  2163  804s
  4943  3478 58208.0914   43   78 58036.2693 74759.3704  28.8%  2151  816s
H 4959  3325                    58690.000943 74557.6585  27.0%  2156  816s
  5021  3347 64110.6509   23  278 58690.0009 74557.6585  27.0%  2165  827s
  5129  3356 63513.2230   26  248 58690.0009 74557.6585  27.0%  2180  838s
  5222  3387 61358.8734   29  213 58690.0009 74557.6585  27.0%  2204  850s
  5324  3410 59693.9986   32  165 58690.0009 74557.6585  27.0%  2227  862s
  5448  3431 66407.1679   24  339 58690.0009 74194.4809  26.4%  2243  875s
  5570  3445 64282.4642   24  310 58690.0009 74194.4809  26.4%  2255  888s
  5704  3425     cutoff   26      58690.0009 74194.4809  26.4%  2270  895s
H 5705  3286                    59010.218254 74194.4809  25.7%  2270  895s
H 5711  3151                    59122.884149 74194.4809  25.5%  2272  895s
H 5712  3025                    59255.495192 74194.4809  25.2%  2271  895s
H 5716  2903                    60501.733579 74194.4809  22.6%  2272  895s
  5741  2936 62933.8132   26  266 60501.7336 74194.4809  22.6%  2280  909s
  5872  2952 65849.7200   26  325 60501.7336 73250.6198  21.1%  2298  922s
  6017  2968 61076.8719   28  237 60501.7336 72964.1781  20.6%  2320  936s
  6179  2941     cutoff   29      60501.7336 72704.0283  20.2%  2333  949s
  6373  2900     cutoff   30      60501.7336 72674.3342  20.1%  2339  964s
  6471  2942 62707.1228   29  269 60501.7336 72493.9689  19.8%  2353  978s
  6617  2946 61292.2882   35  159 60501.7336 72493.9689  19.8%  2372  993s
  6797  2913 65569.4217   23  280 60501.7336 72134.4151  19.2%  2390 1009s
  6969  2848 61024.1861   25  290 60501.7336 72018.1122  19.0%  2413 1025s
  7165  2782 61903.3574   27  239 60501.7336 71912.1883  18.9%  2431 1043s
  7360  2742 62819.9613   24  283 60501.7336 71791.6481  18.7%  2451 1060s
  7580  2703 60971.5803   27  245 60501.7336 71791.6481  18.7%  2465 1078s
  7764  2727 66913.7225   25  314 60501.7336 71722.8650  18.5%  2472 1095s
  7980  2737 61628.6405   30  241 60501.7336 71722.8650  18.5%  2496 1114s
  8249  2769 66101.4973   22  414 60501.7336 71400.3892  18.0%  2499 1133s
  8524  2695 61807.9123   27  330 60501.7336 71349.2016  17.9%  2510 1146s
  8583  2733 61591.1615   28  247 60501.7336 71349.2016  17.9%  2512 1167s
  8777  2729 65712.3067   22  313 60501.7336 71349.2016  17.9%  2512 1194s
  8984  2732 64385.0549   24  297 60501.7336 70797.8068  17.0%  2511 1217s
  9242  2750     cutoff   29      60501.7336 70587.8336  16.7%  2516 1239s
  9549  2733 63661.3976   21  251 60501.7336 70587.8336  16.7%  2521 1262s
  9907  2663 65219.5979   21  333 60501.7336 70359.1280  16.3%  2526 1285s
 10237  2641     cutoff   31      60501.7336 69999.4973  15.7%  2548 1308s
 10592  2744     cutoff   31      60501.7336 69960.5084  15.6%  2563 1332s
 11030  2829     cutoff   24      60501.7336 69592.3626  15.0%  2563 1358s
 11483  2903 60998.0614   25  343 60501.7336 69512.3906  14.9%  2567 1385s
 11956  2990 62063.4365   23  274 60501.7336 68981.4902  14.0%  2569 1413s
 12410  3046 63545.4289   27  175 60501.7336 68768.9471  13.7%  2571 1441s
 12815  3126     cutoff   25      60501.7336 68655.3983  13.5%  2589 1470s
 13361  3240 infeasible   27      60501.7336 68650.1447  13.5%  2584 1501s
 13894  3317     cutoff   25      60501.7336 68337.2609  13.0%  2586 1533s
 14486  3419     cutoff   29      60501.7336 67946.1548  12.3%  2581 1568s
 15093  3530 62964.1506   25  320 60501.7336 67703.4061  11.9%  2581 1601s
 15749  3605     cutoff   27      60501.7336 67412.3295  11.4%  2572 1637s
 16447  3660 62234.3634   29  256 60501.7336 67368.2104  11.3%  2566 1671s
 17093  3681 62183.0838   31  218 60501.7336 66899.5214  10.6%  2568 1706s
 17894  3778 64616.4655   35  241 60501.7336 66694.1950  10.2%  2552 1744s
 18640  3839     cutoff   29      60501.7336 66542.6670  10.0%  2548 1787s
 19412  3916     cutoff   31      60501.7336 66234.2536  9.47%  2542 1825s
 20261  3917 61230.5089   29  186 60501.7336 65967.3505  9.03%  2532 1858s
H20264  3762                    60997.880110 65967.3505  8.15%  2532 1858s
 20425  3813     cutoff   24      60997.8801 65966.1909  8.15%  2532 1901s
H20429  3782                    61052.395718 65966.1909  8.05%  2532 1901s
 21262  3777     cutoff   31      61052.3957 65737.4653  7.67%  2520 1949s
 22230  3757 62093.9047   29  221 61052.3957 65463.3318  7.22%  2510 1995s
 23288  3673 62736.7188   32  178 61052.3957 65108.2934  6.64%  2494 2041s
 24445  3514 61468.9960   27  309 61052.3957 64791.3949  6.12%  2473 2087s
 25517  3317     cutoff   31      61052.3957 64540.1342  5.71%  2460 2133s
 26698  3007 61453.1369   34  161 61052.3957 64277.5204  5.28%  2443 2179s
 27764  2402 61739.1120   38  178 61052.3957 63942.3505  4.73%  2429 2229s
 29333  1276     cutoff   35      61052.3957 63386.2815  3.82%  2388 2276s
 31174     0     cutoff   33      61052.3957 62810.0554  2.88%  2329 2303s

Cutting planes:
  Learned: 3
  MIR: 577
  Mixing: 2
  Flow cover: 1165
  RLT: 15
  Relax-and-lift: 105

Explored 32922 nodes (73801946 simplex iterations) in 2303.62 seconds (7544.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 61052.4 61052.4 60997.9 ... 57781

Optimal solution found (tolerance 1.00e-06)
Best objective 6.105239571839e+04, best bound 6.105239571839e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2303.64s
  Master Objective (UB) = 61052.40, θ = 229819.34
  Upper Bound (UB) = 61052.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229819.34
  [DEBUG]   ✓ Scenario 0: θ = 229819.34 ≤ Q = 235770.64 (slack: 5951.30)
  [DEBUG]   ✓ Scenario 1: θ = 229819.34 ≤ Q = 229819.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229819.34 ≤ Q = 229819.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229819.34 ≤ Q = 229874.64 (slack: 55.30)
  [DEBUG]   ✓ Scenario 4: θ = 229819.34 ≤ Q = 229819.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x55185a76
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x55185a76
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.466928e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7277989.5019
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.968904e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196890.39    0  129 7277989.50 -196890.39   103%     -    0s
H    0     0                    -160977.9470 -196890.39  22.3%     -    0s
H    0     0                    -161167.2480 -196890.39  22.2%     -    0s
     0     0 -176606.11    0   90 -161167.25 -176606.11  9.58%     -    0s
H    0     0                    -172679.4373 -176546.49  2.24%     -    0s
H    0     0                    -173956.3396 -176546.49  1.49%     -    0s
     0     0 -176272.79    0   85 -173956.34 -176272.79  1.33%     -    0s
     0     0 -175646.21    0   72 -173956.34 -175646.21  0.97%     -    0s
H    0     0                    -174413.6706 -175623.12  0.69%     -    0s
     0     0 -175528.57    0   58 -174413.67 -175528.57  0.64%     -    0s
H    0     0                    -174458.5082 -175460.28  0.57%     -    0s
     0     0 -175460.28    0   70 -174458.51 -175460.28  0.57%     -    0s
     0     0 -175406.15    0   64 -174458.51 -175406.15  0.54%     -    0s
     0     0 -175403.99    0   64 -174458.51 -175403.99  0.54%     -    0s
     0     2 -175401.97    0   64 -174458.51 -175401.97  0.54%     -    0s
H  113    70                    -174486.0097 -175109.26  0.36%   9.2    0s
H 1289   307                    -174491.0240 -174826.57  0.19%   5.3    0s

Cutting planes:
  Gomory: 25
  Implied bound: 7
  MIR: 164
  Flow cover: 11
  RLT: 34
  Relax-and-lift: 2

Explored 4256 nodes (21138 simplex iterations) in 0.24 seconds (0.19 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -174491 -174486 -174459 ... 1.46693e+13
No other solutions better than -174491

Optimal solution found (tolerance 1.00e-06)
Best objective -1.744910240446e+05, best bound -1.744910240446e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 218963.61
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174491.02
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -174491.02 = 218963.61
  [DEBUG]   Current θ from Master = 229819.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10855.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50196.67
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 7725.4485, Absolute Gap = 7725.4485, Relative Gap = 0.126538
  Not converged yet (gap = 7725.45 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0xc2d01440
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 0.86s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219165.9246

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32566    2.0578260e+04   0.000000e+00   2.879330e+08      5s
   48186    6.3971619e+04   0.000000e+00   7.116183e+07     10s
   64062    8.1178103e+04   0.000000e+00   2.808022e+07     15s
Concurrent spin time: 0.76s

Solved with dual simplex

Root relaxation: objective 9.164254e+04, 40033 iterations, 15.47 seconds (32.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91642.5369    0   75 -219165.92 91642.5369   142%     -   16s
H    0     0                    -212910.3709 91642.5369   143%     -   16s
H    0     0                    -201779.8817 91642.5369   145%     -   16s
H    0     0                    -201470.7106 91642.5369   145%     -   16s
H    0     0                    -149812.2092 91642.5369   161%     -   16s
H    0     0                    -149278.7145 91642.5369   161%     -   16s
H    0     0                    -133215.8145 91642.5369   169%     -   16s
H    0     0                    -125326.3115 91642.5369   173%     -   17s
H    0     0                    -125017.0643 91642.5369   173%     -   17s
H    0     0                    -42420.37808 91642.5369   316%     -   17s
H    0     0                    16635.235430 91642.5369   451%     -   17s
H    0     0                    18859.953599 91642.5369   386%     -   17s
H    0     0                    39273.047966 91642.5369   133%     -   17s
H    0     0                    42100.562935 91642.5369   118%     -   17s
H    0     0                    43457.551648 91642.5369   111%     -   17s
H    0     0                    44217.619619 91642.5369   107%     -   17s
H    0     0                    44263.444313 91642.5369   107%     -   17s
     0     0 86244.4887    0  214 44263.4443 86244.4887  94.8%     -   26s
H    0     0                    46261.929406 86244.4887  86.4%     -   27s
H    0     0                    46343.188878 86244.4887  86.1%     -   27s
     0     0 85909.1164    0  219 46343.1889 85909.1164  85.4%     -   29s
     0     0 85840.6917    0  224 46343.1889 85840.6917  85.2%     -   31s
     0     0 85840.6917    0  225 46343.1889 85840.6917  85.2%     -   31s
     0     0 85840.6917    0  220 46343.1889 85840.6917  85.2%     -   32s
     0     0 85840.6917    0  216 46343.1889 85840.6917  85.2%     -   32s
     0     0 85840.6917    0  216 46343.1889 85840.6917  85.2%     -   32s
H    0     0                    50200.214510 83082.4496  65.5%     -   39s
H    0     0                    50217.570035 83082.4496  65.4%     -   39s
H    0     0                    50245.626478 83082.4496  65.4%     -   39s
H    0     0                    50248.346904 83082.4496  65.3%     -   39s
H    0     0                    50380.278397 83082.4496  64.9%     -   39s
H    0     0                    50414.870021 83082.4496  64.8%     -   39s
H    0     0                    50586.069140 83082.4496  64.2%     -   39s
H    0     0                    50630.708177 83082.4496  64.1%     -   39s
     0     0 83006.6393    0  289 50630.7082 83006.6393  63.9%     -   39s
     0     0 82328.2019    0  304 50630.7082 82328.2019  62.6%     -   44s
     0     0 82231.7399    0  309 50630.7082 82231.7399  62.4%     -   46s
     0     0 82208.9829    0  305 50630.7082 82208.9829  62.4%     -   46s
     0     0 82200.7161    0  308 50630.7082 82200.7161  62.4%     -   46s
     0     0 82198.9461    0  313 50630.7082 82198.9461  62.3%     -   47s
     0     0 82198.4129    0  313 50630.7082 82198.4129  62.3%     -   47s
     0     0 80454.4352    0  330 50630.7082 80454.4352  58.9%     -   59s
H    0     0                    50922.316396 80453.9522  58.0%     -   59s
H    0     0                    51304.616722 80453.9522  56.8%     -   59s
H    0     0                    51683.644573 80453.9522  55.7%     -   59s
H    0     0                    53106.762165 80453.9522  51.5%     -   59s
H    0     0                    53193.538625 80453.9522  51.2%     -   59s
H    0     0                    53232.173784 80453.9522  51.1%     -   59s
H    0     0                    53246.899091 80453.9522  51.1%     -   59s
     0     0 80071.3384    0  345 53246.8991 80071.3384  50.4%     -   65s
     0     0 79942.3982    0  342 53246.8991 79942.3982  50.1%     -   68s
     0     0 79857.5028    0  372 53246.8991 79857.5028  50.0%     -   70s
     0     0 79815.3398    0  358 53246.8991 79815.3398  49.9%     -   71s
     0     0 79798.3520    0  362 53246.8991 79798.3520  49.9%     -   72s
H    0     0                    53274.197019 79795.1921  49.8%     -   73s
H    0     0                    53526.705368 79795.1921  49.1%     -   73s
     0     0 79795.1921    0  361 53526.7054 79795.1921  49.1%     -   73s
     0     0 79791.5166    0  358 53526.7054 79791.5166  49.1%     -   73s
     0     0 79790.4956    0  360 53526.7054 79790.4956  49.1%     -   73s
H    0     0                    53910.704136 79790.4956  48.0%     -   76s
H    0     0                    54470.736106 79790.4956  46.5%     -   76s
H    0     0                    54487.382883 79790.4956  46.4%     -   76s
H    0     0                    54606.160969 79790.4956  46.1%     -   76s
     0     0 79194.5563    0  375 54606.1610 79194.5563  45.0%     -   85s
H    0     0                    54723.136501 79194.5094  44.7%     -   85s
H    0     0                    54826.756175 79194.5094  44.4%     -   85s
H    0     0                    54868.255892 79194.5094  44.3%     -   85s
     0     0 79059.3129    0  385 54868.2559 79059.3129  44.1%     -   87s
     0     0 78956.2542    0  422 54868.2559 78956.2542  43.9%     -   90s
     0     0 78917.9877    0  426 54868.2559 78917.9877  43.8%     -   91s
     0     0 78905.5377    0  421 54868.2559 78905.5377  43.8%     -   92s
     0     0 78901.4263    0  426 54868.2559 78901.4263  43.8%     -   93s
H    0     0                    54960.190822 78899.0590  43.6%     -   93s
     0     0 78899.0590    0  428 54960.1908 78899.0590  43.6%     -   93s
     0     0 78897.7098    0  428 54960.1908 78897.7098  43.6%     -   94s
     0     0 78697.4185    0  378 54960.1908 78697.4185  43.2%     -   96s
H    0     0                    55095.878318 78697.3019  42.8%     -   97s
H    0     0                    55163.816155 78697.3019  42.7%     -   97s
H    0     0                    55388.255362 78697.3019  42.1%     -   97s
H    0     0                    55409.576927 78697.3019  42.0%     -   97s
H    0     0                    55622.318021 78697.3019  41.5%     -   97s
     0     0 78633.7847    0  394 55622.3180 78633.7847  41.4%     -   98s
     0     0 78622.3090    0  395 55622.3180 78622.3090  41.4%     -   99s
     0     0 78599.2963    0  385 55622.3180 78599.2963  41.3%     -  100s
     0     0 78590.4309    0  395 55622.3180 78590.4309  41.3%     -  101s
     0     0 78587.2637    0  392 55622.3180 78587.2637  41.3%     -  101s
     0     0 78585.2202    0  395 55622.3180 78585.2202  41.3%     -  101s
     0     0 78584.2757    0  394 55622.3180 78584.2757  41.3%     -  101s
     0     0 78541.6275    0  389 55622.3180 78541.6275  41.2%     -  103s
H    0     0                    55700.275947 78541.5860  41.0%     -  104s
     0     0 78531.7259    0  424 55700.2759 78531.7259  41.0%     -  105s
     0     0 78524.6902    0  429 55700.2759 78524.6902  41.0%     -  105s
     0     0 78521.8982    0  437 55700.2759 78521.8982  41.0%     -  106s
     0     0 78521.2396    0  434 55700.2759 78521.2396  41.0%     -  106s
     0     0 78503.2103    0  394 55700.2759 78503.2103  40.9%     -  108s
H    0     0                    56059.178176 78501.6947  40.0%     -  108s
     0     0 78499.8568    0  401 56059.1782 78499.8568  40.0%     -  109s
     0     0 78498.0150    0  403 56059.1782 78498.0150  40.0%     -  110s
     0     0 78497.7022    0  403 56059.1782 78497.7022  40.0%     -  110s
     0     0 78490.7858    0  414 56059.1782 78490.7858  40.0%     -  112s
H    0     0                    56091.520714 78489.8605  39.9%     -  112s
H    0     0                    56237.091353 78489.8605  39.6%     -  112s
H    0     0                    56274.238197 78489.8605  39.5%     -  113s
H    0     0                    56405.082221 78489.8605  39.2%     -  113s
H    0     0                    56539.691599 78489.8605  38.8%     -  113s
     0     0 78489.7303    0  420 56539.6916 78489.7303  38.8%     -  113s
     0     0 78488.4270    0  437 56539.6916 78488.4270  38.8%     -  114s
     0     0 78488.0527    0  448 56539.6916 78488.0527  38.8%     -  115s
     0     0 78487.1598    0  435 56539.6916 78487.1598  38.8%     -  116s
     0     0 78487.0282    0  435 56539.6916 78487.0282  38.8%     -  116s
     0     2 78487.0282    0  435 56539.6916 78487.0282  38.8%     -  134s
     1     4 78322.9070    1  389 56539.6916 78487.0282  38.8%  4318  137s
     3     8 78283.9749    2  363 56539.6916 78317.7956  38.5%  3635  142s
     7    16 77976.5946    3  465 56539.6916 78283.1956  38.5%  4444  147s
    15    32 77835.3153    4  436 56539.6916 77974.7856  37.9%  5410  152s
    31    48 77318.5739    5  371 56539.6916 77850.6210  37.7%  7031  164s
H   47    80                    56651.271800 77850.6210  37.4%  7756  173s
H   60    80                    56687.753999 77850.6210  37.3%  7623  173s
H   78    80                    56760.872654 77850.6210  37.2%  6501  173s
    79   144 76542.2104    7  404 56760.8727 77850.6210  37.2%  6519  195s
H  143   282                    56814.268199 77850.6210  37.0%  5027  205s
H  228   282                    56859.805870 77850.6210  36.9%  3968  205s
   281   373 76465.7633   11  397 56859.8059 77850.6210  36.9%  3642  213s
   372   436 76236.6748   10  429 56859.8059 77850.6210  36.9%  3372  221s
H  382   436                    56906.695522 77850.6210  36.8%  3370  221s
   435   501 76162.7818   12  396 56906.6955 77850.6210  36.8%  3246  226s
   500   568 76277.0556   12  384 56906.6955 77850.6210  36.8%  3152  233s
H  502   568                    57054.002147 77850.6210  36.5%  3157  233s
   567   633 76244.8265   13  389 57054.0021 77850.6210  36.5%  3170  240s
   632   681 63970.7348   21  314 57054.0021 77850.6210  36.5%  3108  248s
   680   737 75633.7753   13  394 57054.0021 77850.6210  36.5%  3115  254s
   736   810 75828.0864   13  388 57054.0021 77850.6210  36.5%  3223  261s
   809   887 63058.7337   33  203 57054.0021 77850.6210  36.5%  3132  268s
   886   919 75752.4909   13  415 57054.0021 77850.6210  36.5%  3025  274s
H  917   919                    57249.831208 77850.6210  36.0%  2981  274s
   918  1024 62457.6347   38  204 57249.8312 77850.6210  36.0%  2982  282s
  1031  1057 75797.2235   14  381 57249.8312 77850.6210  36.0%  2801  290s
H 1032  1057                    57561.069407 77850.6210  35.2%  2798  290s
  1066  1188 75570.0120   14  333 57561.0694 77850.6210  35.2%  2776  298s
  1199  1316 61879.4361   45  189 57561.0694 77850.6210  35.2%  2595  306s
H 1249  1316                    57603.890655 77850.6210  35.1%  2534  306s
  1349  1373 59266.6635   47  166 57603.8907 77850.6210  35.1%  2417  316s
  1483  1402 75396.6487   14  367 57603.8907 77850.6210  35.1%  2349  324s
  1518  1432 75669.4236   15  385 57603.8907 77850.6210  35.1%  2373  332s
  1554  1459 72698.7050   15  355 57603.8907 77850.6210  35.1%  2389  339s
H 1568  1459                    57604.406606 77850.6210  35.1%  2387  339s
H 1574  1459                    57663.363253 77850.6210  35.0%  2388  339s
  1587  1549 71161.5384   15  304 57663.3633 77850.6210  35.0%  2398  348s
  1733  1575 71184.2212   16  307 57663.3633 77850.6210  35.0%  2310  356s
  1771  1611 71295.6653   16  348 57663.3633 77850.6210  35.0%  2333  365s
H 1782  1611                    57726.531013 77835.1175  34.8%  2330  365s
  1823  1632 71571.4796   16  292 57726.5310 77835.1175  34.8%  2339  373s
  1864  1665 70577.0395   17  265 57726.5310 77835.1175  34.8%  2334  379s
  1905  1707 72400.7981   16  349 57726.5310 77835.1175  34.8%  2342  386s
  1961  1765 71767.5336   17  353 57726.5310 77835.1175  34.8%  2325  394s
  2025  1827 69827.7772   18  267 57726.5310 77835.1175  34.8%  2300  404s
  2131  1906 69455.4634   19  275 57726.5310 77835.1175  34.8%  2246  415s
  2238  1945 68940.8075   20  288 57726.5310 77835.1175  34.8%  2227  425s
  2309  2019 68757.2758   19  225 57726.5310 77835.1175  34.8%  2211  436s
  2423  2102 67982.5528   21  201 57726.5310 77835.1175  34.8%  2217  447s
  2548  2151 65821.8745   21  241 57726.5310 77657.9795  34.5%  2224  459s
  2671  2223 67697.1631   22  199 57726.5310 77657.9795  34.5%  2241  474s
  2763  2329 61153.3923   20  277 57726.5310 77657.9795  34.5%  2286  487s
  2891  2358 65147.0917   22  162 57726.5310 77657.9795  34.5%  2306  495s
  2938  2415 66070.5291   23  148 57726.5310 77657.9795  34.5%  2322  508s
  3055  2443 62519.0383   23  202 57726.5310 77657.9795  34.5%  2308  516s
  3095  2531 64463.3341   24  152 57726.5310 77657.9795  34.5%  2315  528s
  3242  2669 59128.5614   23  136 57726.5310 77559.8590  34.4%  2286  541s
  3468  2769 62214.5181   25  150 57726.5310 77413.0922  34.1%  2228  555s
  3640  2885 59294.6546   27  184 57726.5310 77413.0922  34.1%  2249  572s
  3817  2886 76248.7576   13  435 57726.5310 77413.0922  34.1%  2268  611s
  3819  2887 64337.4912   66   75 57726.5310 77413.0922  34.1%  2266  637s
  3820  2888 76407.9989   10  332 57726.5310 77413.0922  34.1%  2266  650s
  3821  2889 64335.3503   18  352 57726.5310 77413.0922  34.1%  2265  662s
  3822  2889 76544.5746   14  412 57726.5310 77413.0922  34.1%  2265  668s
  3823  2890 72467.7212   10  437 57726.5310 77413.0922  34.1%  2264  673s
  3824  2891 58551.7335   46  387 57726.5310 77413.0922  34.1%  2263  678s
  3825  2891 59567.4266   35  407 57726.5310 77413.0922  34.1%  2263  682s
  3827  2893 66069.4739   27  415 57726.5310 77413.0922  34.1%  2262  687s
  3830  2895 60376.3426   51  451 57726.5310 77413.0922  34.1%  2260  692s
  3831  2895 74972.7316   16  410 57726.5310 77413.0922  34.1%  2259  696s
  3834  2897 73631.5508   13  413 57726.5310 77413.0922  34.1%  2257  700s
  3837  2899 66655.6136   31  481 57726.5310 77413.0922  34.1%  2256  705s
  3839  2901 74466.4723    7  485 57726.5310 77413.0922  34.1%  2255  711s
  3841  2902 59062.1058   38  491 57726.5310 77413.0922  34.1%  2253  715s
  3844  2904 61976.9626   54  450 57726.5310 77413.0922  34.1%  2252  721s
  3847  2906 63176.8597   22  367 57726.5310 77413.0922  34.1%  2250  725s
  3849  2907 75573.2946    5  473 57726.5310 77413.0922  34.1%  2249  730s
  3852  2909 65441.4571   32  446 57726.5310 77413.0922  34.1%  2247  735s
  3854  2911 69106.1462   30  471 57726.5310 77413.0922  34.1%  2246  761s
  3855  2911 65822.3598   37  471 57726.5310 77413.0922  34.1%  2245  772s
  3856  2915 77413.0922   16  416 57726.5310 77413.0922  34.1%  2291  802s
  3858  2918 77413.0922   17  422 57726.5310 77413.0922  34.1%  2293  821s
  3862  2925 77413.0922   18  464 57726.5310 77413.0922  34.1%  2302  835s
  3870  2938 77413.0922   19  337 57726.5310 77413.0922  34.1%  2314  850s
  3886  2951 73170.5483   20  329 57726.5310 77413.0922  34.1%  2368  879s
  3904  2977 73576.9240   21  313 57726.5310 77413.0922  34.1%  2418  901s
  3936  2999 73269.1790   22  334 57726.5310 77413.0922  34.1%  2500  918s
  3969  3020 73122.8796   23  321 57726.5310 77413.0922  34.1%  2532  941s
  4001  3038 73068.9084   24  325 57726.5310 77413.0922  34.1%  2603  957s
H 4037  2879                    58157.428506 77413.0922  33.1%  2634  957s
  4038  2963 72716.2347   25  324 58157.4285 77413.0922  33.1%  2635  979s
H 4069  2814                    58166.085424 77413.0922  33.1%  2668  979s
H 4127  2663                    58188.282374 77413.0922  33.0%  2711  979s
  4161  2704 71218.1579   25  325 58188.2824 77413.0922  33.0%  2730  994s
  4261  2705 67456.4450   25  306 58188.2824 77413.0922  33.0%  2820 1012s
  4363  2699 72070.2052   27  342 58188.2824 77413.0922  33.0%  2864 1027s
  4456  2684 67953.1941   26  343 58188.2824 76501.2632  31.5%  2920 1037s
  4507  2704 71162.4637   27  320 58188.2824 76501.2632  31.5%  2972 1048s
  4569  2710 69106.3763   28  280 58188.2824 75839.3680  30.3%  3008 1064s
  4639  2714 66256.7014   26  316 58188.2824 75839.3680  30.3%  3033 1078s
  4695  2714 68472.5769   29  252 58188.2824 75480.2807  29.7%  3092 1089s
  4744  2728 67610.1566   30  276 58188.2824 75480.2807  29.7%  3142 1101s
  4809  2731 63262.3199   29  300 58188.2824 75480.2807  29.7%  3180 1115s
  4882  2728 59695.6128   30  288 58188.2824 75480.2807  29.7%  3216 1129s
H 4921  2590                    58903.477104 75480.2807  28.1%  3248 1129s
  4933  2599 65288.7053   31  319 58903.4771 75480.2807  28.1%  3262 1142s
H 4974  2466                    59130.595050 74913.4216  26.7%  3292 1142s
  4990  2486 62943.3447   31  298 59130.5951 74913.4216  26.7%  3309 1156s
  5065  2503 64957.8452   32  298 59130.5951 74913.4216  26.7%  3365 1169s
  5140  2519 63379.3545   34  270 59130.5951 74913.4216  26.7%  3400 1182s
  5235  2542 61995.4214   37  190 59130.5951 74029.4136  25.2%  3428 1196s
  5328  2541 59573.6225   42   96 59130.5951 74029.4136  25.2%  3453 1205s
H 5335  2426                    59308.669470 74029.4136  24.8%  3457 1205s
  5362  2468 59858.4425   41  140 59308.6695 74029.4136  24.8%  3471 1220s
  5505  2468 59630.2495   47  107 59308.6695 74029.4136  24.8%  3489 1235s
  5648  2451     cutoff   48      59308.6695 73880.5053  24.6%  3518 1251s
  5763  2461 62176.1565   28  323 59308.6695 73880.5053  24.6%  3555 1268s
  5893  2464 59490.6372   31  148 59308.6695 73880.5053  24.6%  3601 1284s
  6026  2433 62637.5939   27  344 59308.6695 73880.5053  24.6%  3637 1296s
H 6069  2310                    59392.913874 72781.8737  22.5%  3653 1296s
  6076  2350 62495.1591   28  348 59392.9139 72781.8737  22.5%  3653 1314s
  6216  2360     cutoff   31      59392.9139 72781.8737  22.5%  3706 1334s
  6371  2373 65998.3334   23  269 59392.9139 72781.8737  22.5%  3739 1352s
  6554  2368 64073.1206   26  226 59392.9139 72781.8737  22.5%  3755 1372s
  6731  2366     cutoff   29      59392.9139 71967.9302  21.2%  3767 1391s
  6905  2385     cutoff   29      59392.9139 71967.9302  21.2%  3798 1411s
  7081  2344 65958.7301   25  289 59392.9139 71967.9302  21.2%  3822 1430s
H 7088  2240                    59431.309131 71967.9302  21.1%  3823 1430s
  7132  2267 65779.6416   26  294 59431.3091 71967.9302  21.1%  3831 1452s
  7396  2265 61075.5444   30  226 59431.3091 71967.9302  21.1%  3824 1475s
  7592  2250 60402.9366   25  384 59431.3091 71967.9302  21.1%  3860 1497s
  7837  2243 65127.6313   28  267 59431.3091 69381.9421  16.7%  3883 1519s
  8038  2246 62446.1997   30  219 59431.3091 69215.0683  16.5%  3943 1542s
  8244  2187     cutoff   34      59431.3091 68770.3254  15.7%  4007 1564s
H 8255  2087                    59829.375457 68770.3254  14.9%  4011 1564s
  8299  2132 64680.6377   29  195 59829.3755 68770.3254  14.9%  4023 1588s
  8539  1994 60876.7500   37  105 59829.3755 68770.3254  14.9%  4074 1614s
  8857  1941 63299.4578   28  291 59829.3755 68770.3254  14.9%  4091 1642s
  9162  1869     cutoff   32      59829.3755 68770.3254  14.9%  4112 1673s
  9486  1854 61451.8199   28  269 59829.3755 67872.4473  13.4%  4136 1699s
  9583  1904     cutoff   30      59829.3755 67488.8444  12.8%  4139 1728s
  9926  1945 63341.4431   33  248 59829.3755 67488.8444  12.8%  4153 1759s
 10234  2010 62232.1087   35  185 59829.3755 67478.7472  12.8%  4196 1789s
 10582  2056 63671.8969   30  300 59829.3755 67364.0139  12.6%  4225 1824s
 10994  2100 60498.1673   35  177 59829.3755 67051.0342  12.1%  4236 1858s
 11379  2112 60392.2016   36  153 59829.3755 66502.2043  11.2%  4259 1893s
 11808  2142     cutoff   27      59829.3755 66358.1789  10.9%  4275 1930s
 12264  2194 62022.8624   32  293 59829.3755 65605.6990  9.65%  4286 1968s
 12800  2209 60495.9432   28  212 59829.3755 65556.9590  9.57%  4276 2010s
 13315  2237     cutoff   39      59829.3755 65021.3170  8.68%  4277 2049s
 13841  2231 infeasible   37      59829.3755 64883.4229  8.45%  4280 2090s
H13932  2211                    59911.684113 64883.4229  8.30%  4275 2090s
 14440  2232 62250.2094   26  259 59911.6841 64675.2524  7.95%  4254 2140s
 15079  2192     cutoff   29      59911.6841 64433.2049  7.55%  4238 2183s
 15723  2145 60705.0647   30  194 59911.6841 63841.5580  6.56%  4226 2229s
 16327  2117 60241.1067   33  201 59911.6841 63515.0055  6.01%  4199 2274s
 17155  1981 62024.0480   34  157 59911.6841 63222.5095  5.53%  4143 2328s
 18088  1703     cutoff   29      59911.6841 62822.0511  4.86%  4087 2374s
 19200  1187     cutoff   25      59911.6841 62372.0046  4.11%  4003 2422s
 20627   658 60114.4804   49   73 59911.6841 61952.4264  3.41%  3867 2460s
 23663  1042     cutoff   61      59911.6841 60775.2089  1.44%  3449 2471s
*23767  1042              64    60134.957951 60775.2089  1.06%  3434 2471s
*24012  1042              84    60209.539144 60744.1126  0.89%  3400 2471s
H25157  1042                    60274.770841 60717.2651  0.73%  3251 2471s
H25251  1042                    60316.503310 60717.2651  0.66%  3239 2471s
 27326   249     cutoff   59      60316.5033 60556.1144  0.40%  3004 2485s
*28037   249              52    60331.910612 60481.1733  0.25%  2928 2486s
*28141     0              56    60352.266025 60475.6922  0.20%  2917 2486s

Cutting planes:
  MIR: 789
  Mixing: 2
  Flow cover: 1411
  RLT: 25
  Relax-and-lift: 131

Explored 28372 nodes (82267213 simplex iterations) in 2486.76 seconds (7920.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 60352.3 60331.9 60316.5 ... 59392.9

Optimal solution found (tolerance 1.00e-06)
Best objective 6.035226602516e+04, best bound 6.035226602516e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2486.79s
  Master Objective (UB) = 60352.27, θ = 228815.24
  Upper Bound (UB) = 60352.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228815.24
  [DEBUG]   ✓ Scenario 0: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x40a1ca30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbf5e35d0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.465662e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7257573.1062
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.964036e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196403.62    0  125 7257573.11 -196403.62   103%     -    0s
H    0     0                    -160648.1482 -196403.62  22.3%     -    0s
H    0     0                    -160837.4492 -196403.62  22.1%     -    0s
     0     0 -174484.89    0  112 -160837.45 -174484.89  8.49%     -    0s
H    0     0                    -164079.0010 -174340.18  6.25%     -    0s
H    0     0                    -169435.2531 -174340.18  2.89%     -    0s
H    0     0                    -171442.8723 -174340.18  1.69%     -    0s
     0     0 -173818.70    0   96 -171442.87 -173818.70  1.39%     -    0s
H    0     0                    -171572.1872 -173770.97  1.28%     -    0s
     0     0 -173770.97    0   96 -171572.19 -173770.97  1.28%     -    0s
     0     0 -173294.00    0   99 -171572.19 -173294.00  1.00%     -    0s
H    0     0                    -171648.0501 -173284.38  0.95%     -    0s
H    0     0                    -171674.6047 -173284.38  0.94%     -    0s
     0     0 -173284.38    0   99 -171674.60 -173284.38  0.94%     -    0s
H    0     0                    -172058.0005 -173284.38  0.71%     -    0s
H    0     0                    -172093.0981 -173284.38  0.69%     -    0s
     0     0 -173166.68    0  103 -172093.10 -173166.68  0.62%     -    0s
     0     0 -173162.81    0  103 -172093.10 -173162.81  0.62%     -    0s
     0     2 -173162.81    0  103 -172093.10 -173162.81  0.62%     -    0s
H 1281   595                    -172096.2219 -172533.61  0.25%   6.6    0s

Cutting planes:
  Gomory: 58
  Implied bound: 2
  MIR: 198
  Flow cover: 4
  RLT: 8
  BQP: 1

Explored 7996 nodes (45190 simplex iterations) in 0.45 seconds (0.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -172096 -172093 -171675 ... 1.46566e+13
No other solutions better than -172096

Optimal solution found (tolerance 1.00e-06)
Best objective -1.720962219265e+05, best bound -1.720962219265e+05, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 220338.91
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -172096.22
  [DEBUG]   S×d_nominal = 392435.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 392435.13 + -172096.22 = 220338.91
  [DEBUG]   Current θ from Master = 228815.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8476.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51875.93
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 7025.3188, Absolute Gap = 7025.3188, Relative Gap = 0.116405
  Not converged yet (gap = 7025.32 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0xd5ca30e8
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.03s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219165.9246

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34542   -3.4688959e+04   0.000000e+00   5.332080e+06      5s
   48695    1.3410939e+04   0.000000e+00   5.475870e+06     10s
   62464    3.5405020e+04   0.000000e+00   8.512535e+06     15s
   72523    4.8173635e+04   0.000000e+00   1.916273e+06     20s
Concurrent spin time: 1.88s

Solved with dual simplex

Root relaxation: objective 9.114461e+04, 47291 iterations, 21.77 seconds (42.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91144.6110    0   88 -219165.92 91144.6110   142%     -   23s
H    0     0                    -211661.4304 91144.6110   143%     -   23s
H    0     0                    -170968.8966 91144.6110   153%     -   23s
H    0     0                    -170235.3065 91144.6110   154%     -   23s
H    0     0                    -130904.4971 91144.6110   170%     -   23s
H    0     0                    -129974.9436 91144.6110   170%     -   23s
H    0     0                    -129907.5039 91144.6110   170%     -   23s
H    0     0                    -129777.9467 91144.6110   170%     -   23s
H    0     0                    -129432.1947 91144.6110   170%     -   23s
H    0     0                    -129191.3608 91144.6110   171%     -   23s
H    0     0                    -128985.4900 91144.6110   171%     -   23s
H    0     0                    -59538.37060 91144.6110   253%     -   23s
H    0     0                    39238.304045 91144.6110   132%     -   23s
H    0     0                    42299.281571 91144.6110   115%     -   23s
H    0     0                    43994.709102 91144.6110   107%     -   24s
H    0     0                    44236.885700 91144.6110   106%     -   24s
H    0     0                    44359.275043 85479.8602  92.7%     -   39s
H    0     0                    44391.299026 85479.8602  92.6%     -   39s
     0     0 85200.3232    0  218 44391.2990 85200.3232  91.9%     -   39s
     0     0 85161.3750    0  228 44391.2990 85161.3750  91.8%     -   44s
     0     0 85161.3750    0  238 44391.2990 85161.3750  91.8%     -   45s
     0     0 85161.3750    0  233 44391.2990 85161.3750  91.8%     -   46s
     0     0 85161.3750    0  242 44391.2990 85161.3750  91.8%     -   46s
     0     0 85161.3750    0  236 44391.2990 85161.3750  91.8%     -   46s
H    0     0                    44429.477194 82401.9539  85.5%     -   57s
H    0     0                    44443.787333 82401.9539  85.4%     -   57s
H    0     0                    44541.697770 82401.9539  85.0%     -   57s
H    0     0                    44552.903292 82401.9539  85.0%     -   57s
H    0     0                    45196.657312 82401.9539  82.3%     -   57s
     0     0 82337.2159    0  267 45196.6573 82337.2159  82.2%     -   57s
H    0     0                    45341.734768 82337.2159  81.6%     -   57s
H    0     0                    45410.729417 82337.2159  81.3%     -   57s
     0     0 82042.4035    0  276 45410.7294 82042.4035  80.7%     -   63s
     0     0 81940.5133    0  248 45410.7294 81940.5133  80.4%     -   65s
     0     0 81906.1747    0  281 45410.7294 81906.1747  80.4%     -   67s
H    0     0                    49827.536900 81890.3502  64.3%     -   67s
H    0     0                    50691.674605 81890.3502  61.5%     -   67s
H    0     0                    51837.878520 81890.3502  58.0%     -   67s
H    0     0                    51877.783777 81890.3502  57.9%     -   67s
H    0     0                    52011.597185 81890.3502  57.4%     -   67s
H    0     0                    52071.552869 81890.3502  57.3%     -   67s
     0     0 81890.3502    0  277 52071.5529 81890.3502  57.3%     -   67s
     0     0 81879.3116    0  290 52071.5529 81879.3116  57.2%     -   69s
     0     0 81867.5685    0  284 52071.5529 81867.5685  57.2%     -   71s
     0     0 81867.1083    0  281 52071.5529 81867.1083  57.2%     -   71s
     0     0 80365.5459    0  339 52071.5529 80365.5459  54.3%     -   90s
     0     0 79988.2900    0  377 52071.5529 79988.2900  53.6%     -   98s
H    0     0                    52619.460770 79804.2988  51.7%     -  102s
H    0     0                    52688.508727 79804.2988  51.5%     -  102s
H    0     0                    52706.521530 79804.2988  51.4%     -  102s
H    0     0                    52867.526459 79804.2988  51.0%     -  102s
H    0     0                    54488.022803 79804.2988  46.5%     -  102s
H    0     0                    54611.381059 79804.2988  46.1%     -  102s
H    0     0                    54742.698407 79804.2988  45.8%     -  102s
     0     0 79804.2988    0  349 54742.6984 79804.2988  45.8%     -  102s
     0     0 79757.0420    0  349 54742.6984 79757.0420  45.7%     -  105s
     0     0 79691.6758    0  361 54742.6984 79691.6758  45.6%     -  108s
     0     0 79657.0707    0  369 54742.6984 79657.0707  45.5%     -  110s
     0     0 79646.0574    0  366 54742.6984 79646.0574  45.5%     -  111s
     0     0 79637.5844    0  365 54742.6984 79637.5844  45.5%     -  112s
     0     0 79626.9722    0  371 54742.6984 79626.9722  45.5%     -  114s
     0     0 79623.1953    0  371 54742.6984 79623.1953  45.4%     -  115s
     0     0 79619.8520    0  370 54742.6984 79619.8520  45.4%     -  116s
     0     0 79618.5422    0  372 54742.6984 79618.5422  45.4%     -  116s
     0     0 79617.8971    0  372 54742.6984 79617.8971  45.4%     -  116s
H    0     0                    55029.508949 79617.8971  44.7%     -  120s
H    0     0                    55370.694994 79617.8971  43.8%     -  120s
H    0     0                    55413.833485 79091.4154  42.7%     -  126s
     0     0 79091.4154    0  371 55413.8335 79091.4154  42.7%     -  127s
H    0     0                    55462.546287 78888.5319  42.2%     -  130s
     0     0 78888.5319    0  384 55462.5463 78888.5319  42.2%     -  130s
     0     0 78742.3030    0  394 55462.5463 78742.3030  42.0%     -  133s
     0     0 78678.0799    0  397 55462.5463 78678.0799  41.9%     -  135s
     0     0 78661.2105    0  400 55462.5463 78661.2105  41.8%     -  136s
     0     0 78649.3128    0  404 55462.5463 78649.3128  41.8%     -  137s
     0     0 78645.7433    0  403 55462.5463 78645.7433  41.8%     -  137s
     0     0 78645.1875    0  405 55462.5463 78645.1875  41.8%     -  138s
     0     0 78433.4752    0  408 55462.5463 78433.4752  41.4%     -  142s
H    0     0                    55879.312945 78431.5011  40.4%     -  143s
H    0     0                    55972.644954 78431.5011  40.1%     -  143s
     0     0 78340.7467    0  447 55972.6450 78340.7467  40.0%     -  146s
     0     0 78307.8542    0  407 55972.6450 78307.8542  39.9%     -  148s
     0     0 78297.9106    0  415 55972.6450 78297.9106  39.9%     -  149s
     0     0 78294.8806    0  417 55972.6450 78294.8806  39.9%     -  149s
     0     0 78292.2164    0  398 55972.6450 78292.2164  39.9%     -  150s
     0     0 78289.8888    0  415 55972.6450 78289.8888  39.9%     -  150s
     0     0 78288.6284    0  399 55972.6450 78288.6284  39.9%     -  151s
     0     0 78263.4901    0  409 55972.6450 78263.4901  39.8%     -  153s
H    0     0                    56265.991148 78263.2727  39.1%     -  155s
     0     0 78244.5085    0  443 56265.9911 78244.5085  39.1%     -  157s
     0     0 78236.3784    0  436 56265.9911 78236.3784  39.0%     -  158s
     0     0 78232.5616    0  450 56265.9911 78232.5616  39.0%     -  158s
     0     0 78229.4305    0  437 56265.9911 78229.4305  39.0%     -  158s
     0     0 78228.9795    0  441 56265.9911 78228.9795  39.0%     -  159s
     0     0 78204.7251    0  402 56265.9911 78204.7251  39.0%     -  160s
H    0     0                    56347.886863 78200.7943  38.8%     -  161s
     0     0 78196.5957    0  409 56347.8869 78196.5957  38.8%     -  161s
     0     0 78193.9025    0  415 56347.8869 78193.9025  38.8%     -  162s
     0     0 78191.5456    0  418 56347.8869 78191.5456  38.8%     -  162s
     0     0 78190.7223    0  424 56347.8869 78190.7223  38.8%     -  162s
     0     0 78188.1678    0  418 56347.8869 78188.1678  38.8%     -  164s
H    0     0                    56698.884895 78187.4310  37.9%     -  165s
H    0     0                    56726.459385 78187.4310  37.8%     -  165s
     0     0 78186.1827    0  402 56726.4594 78186.1827  37.8%     -  165s
     0     0 78185.5089    0  403 56726.4594 78185.5089  37.8%     -  166s
     0     0 78184.0565    0  412 56726.4594 78184.0565  37.8%     -  167s
     0     0 78183.7994    0  411 56726.4594 78183.7994  37.8%     -  167s
     0     0 78180.5836    0  421 56726.4594 78180.5836  37.8%     -  169s
     0     0 78178.4481    0  426 56726.4594 78178.4481  37.8%     -  171s
     0     0 78177.9281    0  415 56726.4594 78177.9281  37.8%     -  171s
     0     0 78175.2364    0  426 56726.4594 78175.2364  37.8%     -  172s
     0     0 78175.1759    0  426 56726.4594 78175.1759  37.8%     -  173s
     0     2 78175.0935    0  426 56726.4594 78175.0935  37.8%     -  200s
     3     8 77971.5500    2  409 56726.4594 78086.0537  37.7%  3251  211s
     7    16 77721.0166    3  402 56726.4594 77971.1175  37.5%  5112  223s
    15    32 77283.5291    4  414 56726.4594 77720.6944  37.0%  6538  240s
    31    49 76184.6306    5  369 56726.4594 77283.4435  36.2% 11473  262s
H   48    81                    57025.206212 77282.8337  35.5%  9938  274s
    80   113 76871.4640    7  380 57025.2062 77282.8337  35.5%  7328  302s
   112   268 76828.9874    8  347 57025.2062 77282.8337  35.5%  5657  318s
H  117   268                    57031.454131 77282.8337  35.5%  5482  318s
H  204   268                    57057.411859 77282.8337  35.4%  3999  318s
   267   352 76709.0739   12  362 57057.4119 77282.8337  35.4%  3564  328s
   351   425 76678.4919   12  359 57057.4119 77282.8337  35.4%  3275  339s
   424   493 76455.0433   12  353 57057.4119 77282.8337  35.4%  3207  348s
   492   525 76523.9529   13  360 57057.4119 77282.8337  35.4%  3132  354s
   524   557 76313.2991   13  340 57057.4119 77282.8337  35.4%  3080  363s
   556   588 73965.1244   22  306 57057.4119 77282.8337  35.4%  3060  371s
   587   622 76419.0868   13  356 57057.4119 77282.8337  35.4%  3047  378s
   621   655 76264.6950   13  347 57057.4119 77282.8337  35.4%  3024  383s
   654   686 75924.3881   13  338 57057.4119 77282.8337  35.4%  2979  391s
   685   717 73389.4419   26  293 57057.4119 77282.8337  35.4%  2982  401s
   716   754 76568.3499   14  357 57057.4119 77282.8337  35.4%  2939  408s
   753   800 76400.3173   14  357 57057.4119 77282.8337  35.4%  2905  414s
   799   842 75974.2076   14  358 57057.4119 77282.8337  35.4%  2872  421s
   841   903 76191.3839   14  334 57057.4119 77282.8337  35.4%  2827  427s
   902   975 75726.8978   14  349 57057.4119 77282.8337  35.4%  2757  439s
   974  1071 76474.6282   15  349 57057.4119 77282.8337  35.4%  2675  455s
  1070  1186 76176.1882   15  356 57057.4119 77282.8337  35.4%  2567  462s
  1185  1319 74631.0576   15  341 57057.4119 77282.8337  35.4%  2449  470s
  1318  1492 75144.2777   15  289 57057.4119 77282.8337  35.4%  2330  478s
  1495  1649 75721.1752   15  347 57057.4119 77282.8337  35.4%  2157  488s
  1676  1832 65383.3383   58  162 57057.4119 77282.8337  35.4%  2034  498s
  1883  1964 76209.1233   16  348 57057.4119 77282.8337  35.4%  1903  509s
  2088  2052 74895.8137   16  337 57057.4119 77282.8337  35.4%  1805  520s
  2262  2087 74781.0520   16  328 57057.4119 77282.8337  35.4%  1763  530s
  2357  2109 73684.8461   16  260 57057.4119 77282.8337  35.4%  1803  541s
  2393  2145 75906.0964   17  356 57057.4119 77282.8337  35.4%  1856  553s
  2437  2180 74928.4105   17  341 57057.4119 77282.8337  35.4%  1906  566s
  2500  2228 73793.8518   17  260 57057.4119 77282.8337  35.4%  1927  578s
  2556  2275 73496.9021   17  302 57057.4119 77282.8337  35.4%  1971  589s
  2621  2347 70688.6637   17  337 57057.4119 77282.8337  35.4%  2007  603s
  2699  2429 66718.3715   25  234 57057.4119 77192.4697  35.3%  2050  615s
  2787  2541 75143.0036   18  339 57057.4119 77192.4697  35.3%  2087  629s
  2918  2635 73099.1388   18  258 57057.4119 77192.4697  35.3%  2091  641s
  3041  2752 74383.7179   18  327 57057.4119 77192.4697  35.3%  2107  655s
  3216  2873 69666.7632   18  237 57057.4119 77049.2291  35.0%  2096  668s
  3404  2977 73942.2892   19  317 57057.4119 77049.2291  35.0%  2080  683s
  3559  3112 73175.4589   19  274 57057.4119 77049.2291  35.0%  2099  698s
  3717  3113 66978.9214   57  426 57057.4119 77049.2291  35.0%  2113  738s
  3719  3114 64194.1318   47   88 57057.4119 77049.2291  35.0%  2112  781s
  3720  3115 70712.0443   17  329 57057.4119 77049.2291  35.0%  2111  810s
  3721  3116 68431.6545   54  339 57057.4119 77049.2291  35.0%  2111  825s
  3722  3116 69945.9671   44  371 57057.4119 77049.2291  35.0%  2110  834s
  3723  3117 65867.5503   54  412 57057.4119 77049.2291  35.0%  2110  841s
  3724  3118 65351.3997   74  426 57057.4119 77049.2291  35.0%  2109  846s
  3726  3119 73311.2931   25  408 57057.4119 77049.2291  35.0%  2108  853s
  3727  3120 60725.0173   51  411 57057.4119 77049.2291  35.0%  2107  855s
  3729  3121 70632.8917   24  451 57057.4119 77049.2291  35.0%  2106  860s
  3731  3122 75495.9992   11  412 57057.4119 77049.2291  35.0%  2105  865s
  3734  3124 67920.9651   20  357 57057.4119 77049.2291  35.0%  2104  871s
  3737  3126 59943.6362   22  407 57057.4119 77049.2291  35.0%  2102  876s
  3738  3127 58891.7106   17  362 57057.4119 77049.2291  35.0%  2101  880s
  3741  3129 75046.0704   11  411 57057.4119 77049.2291  35.0%  2100  886s
  3744  3131 60098.0838   66  422 57057.4119 77049.2291  35.0%  2098  895s
  3747  3133 75093.5487   15  363 57057.4119 77049.2291  35.0%  2096  900s
  3749  3134 60843.2989   42  373 57057.4119 77049.2291  35.0%  2095  907s
  3751  3136 62124.7636   35  434 57057.4119 77049.2291  35.0%  2094  912s
  3753  3137 66424.7558   71  423 57057.4119 77049.2291  35.0%  2093  915s
  3756  3139 73587.7257   28  365 57057.4119 77049.2291  35.0%  2091  954s
  3757  3140 73620.2101   22  365 57057.4119 77049.2291  35.0%  2091  986s
  3758  3143 77049.2291   10  355 57057.4119 77049.2291  35.0%  2151 1002s
  3760  3146 77049.2291   11  353 57057.4119 77049.2291  35.0%  2152 1023s
  3763  3151 77049.2291   12  437 57057.4119 77049.2291  35.0%  2156 1050s
  3769  3162 76990.8865   13  431 57057.4119 77049.2291  35.0%  2170 1082s
  3782  3170 75158.5009   14  376 57057.4119 76988.8768  34.9%  2216 1130s
  3795  3198 73615.6580   15  381 57057.4119 76988.8768  34.9%  2268 1166s
H 3805  3037                    57344.455266 76988.8768  34.3%  2282 1166s
  3827  3163 72647.1781   16  378 57344.4553 76292.4980  33.0%  2324 1201s
  3961  3198 70024.5945   19  278 57344.4553 76292.4980  33.0%  2505 1218s
  4040  3233 66745.0267   23  196 57344.4553 76292.4980  33.0%  2538 1235s
  4104  3243 65333.9017   25  180 57344.4553 76292.4980  33.0%  2577 1248s
  4135  3270 64476.5841   26  170 57344.4553 76292.4980  33.0%  2613 1264s
  4182  3293 63883.6936   27  142 57344.4553 76292.4980  33.0%  2640 1279s
  4222  3314 63299.2609   28  191 57344.4553 76292.4980  33.0%  2671 1293s
  4268  3340 61802.7979   29  127 57344.4553 76292.4980  33.0%  2690 1314s
  4319  3366 61288.3707   30  133 57344.4553 76292.4980  33.0%  2708 1328s
  4377  3382 61219.8549   31  148 57344.4553 76292.4980  33.0%  2726 1343s
  4439  3391 60793.0936   32  134 57344.4553 76035.5112  32.6%  2732 1357s
  4499  3396 58080.0213   33  127 57344.4553 76035.5112  32.6%  2746 1370s
  4557  3398     cutoff   34      57344.4553 75811.9473  32.2%  2761 1387s
  4614  3409 infeasible   34      57344.4553 75811.9473  32.2%  2773 1404s
  4684  3423 58233.3297   35  152 57344.4553 75811.9473  32.2%  2779 1421s
  4750  3452 58105.9881   36  116 57344.4553 75174.9432  31.1%  2797 1440s
  4832  3436 57353.7702   37  170 57344.4553 75048.6625  30.9%  2794 1455s
  4878  3440     cutoff   38      57344.4553 75048.6625  30.9%  2806 1474s
  4916  3453 72091.4266   19  376 57344.4553 75048.6625  30.9%  2828 1488s
  4960  3477 71996.7393   20  370 57344.4553 75048.6625  30.9%  2849 1502s
  5008  3504 70244.0169   21  374 57344.4553 75048.6625  30.9%  2864 1520s
  5074  3523 69608.8118   22  317 57344.4553 75048.6625  30.9%  2868 1543s
  5164  3544 68986.6410   23  291 57344.4553 75048.6625  30.9%  2880 1562s
  5263  3555 68783.5992   24  312 57344.4553 75048.6625  30.9%  2889 1581s
  5353  3575 65952.1970   26  213 57344.4553 75048.6625  30.9%  2901 1605s
  5453  3595 63469.2826   29  220 57344.4553 74165.6486  29.3%  2921 1631s
  5578  3615 59062.3745   32  171 57344.4553 74165.6486  29.3%  2938 1655s
  5705  3641 66805.8727   23  427 57344.4553 74165.6486  29.3%  2957 1679s
  5832  3663 64919.4551   24  408 57344.4553 74165.6486  29.3%  2982 1706s
  5989  3651 62387.6329   26  361 57344.4553 74165.6486  29.3%  2987 1735s
  6131  3665 60450.5634   28  380 57344.4553 74165.6486  29.3%  3010 1768s
  6270  3700 58491.4269   31  299 57344.4553 73862.1961  28.8%  3029 1797s
  6439  3779 70428.8858   19  394 57344.4553 73862.1961  28.8%  3039 1824s
  6603  3851 68772.0168   21  303 57344.4553 73862.1961  28.8%  3053 1851s
H 6664  3681                    57493.107805 73862.1961  28.5%  3044 1851s
  6848  3833 66855.0218   25  315 57493.1078 73862.1961  28.5%  3023 1882s
  7144  3945 64037.3026   30  181 57493.1078 73862.1961  28.5%  2971 1911s
  7437  4014 60881.5281   42  163 57493.1078 72923.4046  26.8%  2925 1940s
* 7537  3743             151    58254.754152 72923.4046  25.2%  2904 1940s
  7709  3755 58382.0898   65   75 58254.7542 72703.9913  24.8%  2893 1971s
  7977  3720 67402.2707   18  270 58254.7542 72703.9913  24.8%  2876 2005s
H 8128  3424                    58620.152257 72535.7888  23.7%  2870 2005s
  8223  3430 64336.8627   21  293 58620.1523 72489.3946  23.7%  2874 2030s
H 8232  3277                    58703.707893 72489.3946  23.5%  2876 2030s
H 8274  3121                    58760.500726 72430.0701  23.3%  2883 2030s
H 8301  2875                    58955.570994 72407.3027  22.8%  2889 2030s
H 8330  2768                    58968.542281 72407.3027  22.8%  2894 2053s
H 8332  2476                    59300.333362 72407.3027  22.1%  2895 2053s
  8375  2525 61693.8295   25  235 59300.3334 72344.7503  22.0%  2913 2091s
  8583  2535     cutoff   32      59300.3334 72344.7503  22.0%  2940 2129s
  8797  2540     cutoff   23      59300.3334 72113.1934  21.6%  2970 2169s
  9050  2524 62523.8697   25  274 59300.3334 72025.3010  21.5%  2993 2207s
  9272  2545     cutoff   28      59300.3334 71996.5138  21.4%  3030 2251s
  9465  2523 62932.9321   21  309 59300.3334 71657.0571  20.8%  3073 2286s
  9626  2551 60459.0047   23  273 59300.3334 71624.7301  20.8%  3093 2326s
  9898  2664 60307.6922   25  325 59300.3334 71293.9439  20.2%  3114 2370s
 10237  2727     cutoff   21      59300.3334 71293.9439  20.2%  3123 2421s
 10535  2820     cutoff   24      59300.3334 71069.8054  19.8%  3150 2469s
 10850  2877     cutoff   24      59300.3334 71069.8054  19.8%  3180 2520s
 11147  2974 61213.6870   24  225 59300.3334 70803.1683  19.4%  3206 2572s
 11491  3004 61162.3740   20  273 59300.3334 70748.4008  19.3%  3229 2643s
 11834  3091 60282.4564   22  249 59300.3334 70748.4008  19.3%  3253 2720s
 12159  3163     cutoff   24      59300.3334 70356.7557  18.6%  3286 2800s
 12503  3247 64823.5200   24  321 59300.3334 70133.4940  18.3%  3320 2859s
 12866  3357 60947.6276   30  205 59300.3334 70133.4940  18.3%  3350 2922s
 13257  3440 61672.3861   28  189 59300.3334 70022.3383  18.1%  3374 2986s
 13708  3510 62261.1234   21  255 59300.3334 69475.5307  17.2%  3391 3051s
 14080  3629 65482.2747   21  308 59300.3334 69390.4516  17.0%  3428 3123s
 14557  3798     cutoff   23      59300.3334 69283.8854  16.8%  3449 3197s
 15061  3885     cutoff   24      59300.3334 69081.2943  16.5%  3465 3254s
H15246  3750                    59607.407741 69038.1215  15.8%  3469 3254s
H15422  3772                    59767.491410 69038.1215  15.5%  3465 3325s
 15843  3806 61023.8879   21  255 59767.4914 68957.6980  15.4%  3473 3410s
 16325  3869     cutoff   37      59767.4914 68657.8315  14.9%  3512 3498s
 16895  3904     cutoff   22      59767.4914 68533.0984  14.7%  3532 3567s
 17174  3932 62435.4607   19  320 59767.4914 68411.5468  14.5%  3544 3600s

Cutting planes:
  Learned: 1
  MIR: 851
  Flow cover: 1828
  RLT: 20
  Relax-and-lift: 157

Explored 17422 nodes (62008324 simplex iterations) in 3600.04 seconds (9761.65 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 59767.5 59607.4 59300.3 ... 57493.1

Time limit reached
Best objective 5.976749141024e+04, best bound 6.839417240443e+04, gap 14.4337%
  WARNING: Time limit reached. Using best solution found (gap: 14.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 59767.49, θ = 226271.76
  Upper Bound (UB) = 59767.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226271.76
  [DEBUG]   ✓ Scenario 0: θ = 226271.76 ≤ Q = 226271.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226271.76 ≤ Q = 226271.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226271.76 ≤ Q = 226271.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226271.76 ≤ Q = 226271.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226271.76 ≤ Q = 226271.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226271.76 ≤ Q = 226271.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226271.76 ≤ Q = 226271.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3fe39667
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc01c6999
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.383488e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 6944670.2772
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.883363e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -188336.31    0  132 6944670.28 -188336.31   103%     -    0s
H    0     0                    -152224.2888 -188336.31  23.7%     -    0s
H    0     0                    -153028.3054 -188336.31  23.1%     -    0s
H    0     0                    -155615.1569 -188336.31  21.0%     -    0s
H    0     0                    -155633.8727 -172826.60  11.0%     -    0s
     0     0 -172826.60    0   65 -155633.87 -172826.60  11.0%     -    0s
H    0     0                    -170490.2859 -172728.56  1.31%     -    0s
H    0     0                    -170824.0281 -172728.56  1.11%     -    0s
H    0     0                    -171122.7981 -172728.56  0.94%     -    0s
H    0     0                    -171456.5403 -172728.56  0.74%     -    0s
     0     0 -172076.11    0   44 -171456.54 -172076.11  0.36%     -    0s
     0     0 -171813.89    0   32 -171456.54 -171813.89  0.21%     -    0s
     0     0 -171812.23    0   31 -171456.54 -171812.23  0.21%     -    0s
     0     0 -171802.96    0   29 -171456.54 -171802.96  0.20%     -    0s
H    0     0                    -171472.7843 -171802.96  0.19%     -    0s
     0     0 -171667.09    0   24 -171472.78 -171667.09  0.11%     -    0s
     0     0 -171653.37    0   19 -171472.78 -171653.37  0.11%     -    0s
     0     0 -171588.92    0    5 -171472.78 -171588.92  0.07%     -    0s
H    0     0                    -171513.9589 -171576.00  0.04%     -    0s
     0     0 -171576.00    0    5 -171513.96 -171576.00  0.04%     -    0s
     0     0 -171568.44    0    3 -171513.96 -171568.44  0.03%     -    0s
     0     0 -171568.44    0   13 -171513.96 -171568.44  0.03%     -    0s
H    0     0                    -171543.1188 -171568.44  0.01%     -    0s
*    0     0               0    -171549.8087 -171549.81  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 4
  Flow cover: 7
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (637 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -171550 -171543 -171514 ... -152224
No other solutions better than -171550

Optimal solution found (tolerance 1.00e-06)
Best objective -1.715498086601e+05, best bound -1.715498086601e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 207893.15
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -171549.81
  [DEBUG]   S×d_nominal = 379442.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379442.96 + -171549.81 = 207893.15
  [DEBUG]   Current θ from Master = 226271.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18378.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41388.89
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 6440.5442, Absolute Gap = 6440.5442, Relative Gap = 0.107760
  Not converged yet (gap = 6440.54 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0xe2ad654f
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 1.19s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219165.9246

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37697   -4.5889330e+04   0.000000e+00   1.933160e+08      5s
   53110    2.1838813e+04   0.000000e+00   2.082372e+08     10s
   63629    4.6935436e+04   0.000000e+00   6.348081e+06     15s
   73087    5.3845137e+04   0.000000e+00   5.088772e+06     20s
   83444    5.7818443e+04   0.000000e+00   7.818986e+06     25s
Concurrent spin time: 3.37s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 9.110929e+04, 71637 iterations, 26.51 seconds (54.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91109.2902    0   88 -219165.92 91109.2902   142%     -   28s
H    0     0                    -211661.4304 91109.2902   143%     -   28s
H    0     0                    -162963.3433 91109.2902   156%     -   28s
H    0     0                    -67864.44248 91109.2902   234%     -   28s
H    0     0                    -67035.87675 91109.2902   236%     -   28s
H    0     0                    -55110.34136 91109.2902   265%     -   28s
H    0     0                    -55049.00386 91109.2902   266%     -   28s
H    0     0                    -10498.56049 91109.2902   968%     -   28s
H    0     0                    -8368.801535 91109.2902  1189%     -   28s
H    0     0                    39216.481248 91109.2902   132%     -   28s
H    0     0                    39593.824815 91109.2902   130%     -   29s
H    0     0                    40367.854368 91109.2902   126%     -   29s
H    0     0                    44136.099627 91109.2902   106%     -   29s
     0     0 85408.4178    0  246 44136.0996 85408.4178  93.5%     -   40s
H    0     0                    44190.042209 85408.4178  93.3%     -   41s
H    0     0                    44275.301107 85408.4178  92.9%     -   41s
H    0     0                    44368.983947 85408.4178  92.5%     -   41s
     0     0 84978.6082    0  210 44368.9839 84978.6082  91.5%     -   46s
     0     0 84972.2216    0  215 44368.9839 84972.2216  91.5%     -   47s
     0     0 84972.2045    0  240 44368.9839 84972.2045  91.5%     -   48s
     0     0 84972.2045    0  239 44368.9839 84972.2045  91.5%     -   48s
     0     0 84972.2045    0  239 44368.9839 84972.2045  91.5%     -   48s
H    0     0                    45296.982004 81814.8624  80.6%     -   63s
H    0     0                    46025.327365 81814.8624  77.8%     -   63s
H    0     0                    46066.847841 81814.8624  77.6%     -   63s
     0     0 81814.8624    0  284 46066.8478 81814.8624  77.6%     -   63s
     0     0 81413.9434    0  293 46066.8478 81413.9434  76.7%     -   71s
     0     0 81308.1977    0  318 46066.8478 81308.1977  76.5%     -   74s
     0     0 81219.7291    0  305 46066.8478 81219.7291  76.3%     -   78s
     0     0 81164.6408    0  332 46066.8478 81164.6408  76.2%     -   80s
     0     0 81143.8762    0  315 46066.8478 81143.8762  76.1%     -   81s
     0     0 81141.4518    0  316 46066.8478 81141.4518  76.1%     -   82s
     0     0 81140.7597    0  317 46066.8478 81140.7597  76.1%     -   83s
H    0     0                    47833.283591 81140.7597  69.6%     -   89s
H    0     0                    48594.903120 81140.7597  67.0%     -   89s
H    0     0                    48831.598952 81140.7597  66.2%     -   89s
H    0     0                    49033.655702 81140.7597  65.5%     -   89s
H    0     0                    49114.114809 81140.7597  65.2%     -   89s
H    0     0                    50918.731893 81140.7597  59.4%     -   89s
H    0     0                    50921.731030 81140.7597  59.3%     -   89s
H    0     0                    51045.016110 81140.7597  59.0%     -   89s
H    0     0                    51108.553978 81140.7597  58.8%     -   89s
     0     0 79786.7021    0  351 51108.5540 79786.7021  56.1%     -   99s
H    0     0                    54122.615806 79783.4549  47.4%     -  100s
     0     0 79539.9735    0  356 54122.6158 79539.9735  47.0%     -  107s
     0     0 79444.7330    0  364 54122.6158 79444.7330  46.8%     -  110s
     0     0 79402.9386    0  360 54122.6158 79402.9386  46.7%     -  112s
     0     0 79384.0834    0  366 54122.6158 79384.0834  46.7%     -  114s
     0     0 79361.1439    0  373 54122.6158 79361.1439  46.6%     -  116s
     0     0 79333.8645    0  370 54122.6158 79333.8645  46.6%     -  118s
     0     0 79314.3423    0  369 54122.6158 79314.3423  46.5%     -  120s
     0     0 79308.9120    0  369 54122.6158 79308.9120  46.5%     -  122s
     0     0 79305.2466    0  376 54122.6158 79305.2466  46.5%     -  123s
     0     0 79298.5040    0  373 54122.6158 79298.5040  46.5%     -  123s
     0     0 79294.3316    0  374 54122.6158 79294.3316  46.5%     -  125s
     0     0 79292.9182    0  376 54122.6158 79292.9182  46.5%     -  125s
     0     0 79291.0305    0  377 54122.6158 79291.0305  46.5%     -  126s
     0     0 79278.8649    0  374 54122.6158 79278.8649  46.5%     -  127s
     0     0 79277.7539    0  370 54122.6158 79277.7539  46.5%     -  127s
     0     0 78862.8240    0  384 54122.6158 78862.8240  45.7%     -  137s
H    0     0                    54128.781575 78862.5627  45.7%     -  138s
H    0     0                    54206.671437 78862.5627  45.5%     -  138s
     0     0 78739.0466    0  391 54206.6714 78739.0466  45.3%     -  141s
     0     0 78666.8416    0  388 54206.6714 78666.8416  45.1%     -  144s
     0     0 78606.6161    0  396 54206.6714 78606.6161  45.0%     -  146s
     0     0 78596.6189    0  400 54206.6714 78596.6189  45.0%     -  147s
     0     0 78578.5877    0  395 54206.6714 78578.5877  45.0%     -  148s
     0     0 78568.0723    0  401 54206.6714 78568.0723  44.9%     -  149s
     0     0 78564.8327    0  400 54206.6714 78564.8327  44.9%     -  150s
     0     0 78563.3388    0  400 54206.6714 78563.3388  44.9%     -  150s
     0     0 78560.1811    0  401 54206.6714 78560.1811  44.9%     -  151s
     0     0 78559.1469    0  397 54206.6714 78559.1469  44.9%     -  152s
     0     0 78406.9298    0  369 54206.6714 78406.9298  44.6%     -  156s
H    0     0                    55117.879917 78406.4412  42.3%     -  157s
H    0     0                    55406.543066 78406.4412  41.5%     -  157s
     0     0 78349.9873    0  414 55406.5431 78349.9873  41.4%     -  159s
     0     0 78340.9979    0  413 55406.5431 78340.9979  41.4%     -  161s
     0     0 78329.8240    0  417 55406.5431 78329.8240  41.4%     -  161s
     0     0 78327.6465    0  418 55406.5431 78327.6465  41.4%     -  162s
     0     0 78322.0164    0  412 55406.5431 78322.0164  41.4%     -  162s
     0     0 78320.1853    0  419 55406.5431 78320.1853  41.4%     -  163s
     0     0 78318.7486    0  422 55406.5431 78318.7486  41.4%     -  163s
     0     0 78284.7738    0  395 55406.5431 78284.7738  41.3%     -  166s
     0     0 78275.8362    0  415 55406.5431 78275.8362  41.3%     -  167s
     0     0 78271.9097    0  416 55406.5431 78271.9097  41.3%     -  168s
     0     0 78267.7414    0  402 55406.5431 78267.7414  41.3%     -  168s
     0     0 78264.8709    0  418 55406.5431 78264.8709  41.3%     -  169s
     0     0 78263.8174    0  415 55406.5431 78263.8174  41.3%     -  169s
     0     0 78252.7541    0  472 55406.5431 78252.7541  41.2%     -  171s
     0     0 78241.7775    0  424 55406.5431 78241.7775  41.2%     -  172s
     0     0 78235.2253    0  409 55406.5431 78235.2253  41.2%     -  173s
     0     0 78232.0760    0  402 55406.5431 78232.0760  41.2%     -  174s
     0     0 78231.4373    0  401 55406.5431 78231.4373  41.2%     -  174s
     0     0 78223.9141    0  417 55406.5431 78223.9141  41.2%     -  175s
H    0     0                    55903.737201 78222.9366  39.9%     -  176s
H    0     0                    55943.895891 78222.9366  39.8%     -  176s
H    0     0                    56056.534493 78222.9366  39.5%     -  176s
     0     0 78219.8521    0  439 56056.5345 78219.8521  39.5%     -  176s
     0     0 78218.9040    0  442 56056.5345 78218.9040  39.5%     -  177s
     0     0 78216.1010    0  455 56056.5345 78216.1010  39.5%     -  178s
     0     0 78215.6033    0  454 56056.5345 78215.6033  39.5%     -  178s
     0     0 78215.6033    0  452 56056.5345 78215.6033  39.5%     -  179s
     0     0 78214.5458    0  457 56056.5345 78214.5458  39.5%     -  180s
     0     0 78214.5458    0  456 56056.5345 78214.5458  39.5%     -  181s
     0     0 78214.5458    0  456 56056.5345 78214.5458  39.5%     -  181s
H    0     0                    56210.844407 78214.5458  39.1%     -  197s
H    0     0                    56279.487407 78214.5458  39.0%     -  214s
     0     2 78214.5458    0  456 56279.4874 78214.5458  39.0%     -  215s
     1     4 78118.9956    1  425 56279.4874 78214.5458  39.0%  3481  220s
     3     8 77915.8096    2  420 56279.4874 78118.4526  38.8%  5003  228s
     7    16 77779.8255    3  346 56279.4874 77915.7144  38.4%  5970  237s
    15    31 77600.6452    4  443 56279.4874 77778.2112  38.2%  7120  252s
    30    46 75670.0896    5  315 56279.4874 77600.5278  37.9% 13222  275s
    45    78 74520.3990    5  364 56279.4874 77600.5278  37.9% 12614  296s
H   77   214                    56953.359216 77421.1815  35.9% 10319  314s
   213   297 74037.0006   11  327 56953.3592 77421.1815  35.9%  5628  324s
   296   329 73311.8799   14  317 56953.3592 77421.1815  35.9%  4975  329s
   328   368 73020.2917   15  310 56953.3592 77421.1815  35.9%  4699  336s
   367   413 72731.1986   16  300 56953.3592 77421.1815  35.9%  4502  345s
   412   475 72524.0342   17  300 56953.3592 77421.1815  35.9%  4349  353s
H  426   475                    56971.504649 77421.1815  35.9%  4285  353s
   474   507 72401.5334   18  294 56971.5046 77421.1815  35.9%  4119  361s
   506   552 72370.2682   19  291 56971.5046 77421.1815  35.9%  4076  369s
   551   584 72361.4537   20  295 56971.5046 77421.1815  35.9%  3964  376s
   583   642 72339.4233   21  283 56971.5046 77421.1815  35.9%  3870  382s
H  599   642                    57001.430673 77421.1815  35.8%  3820  382s
   641   747 72297.6759   22  285 57001.4307 77421.1815  35.8%  3670  390s
   746   849 71777.0979   27  233 57001.4307 77421.1815  35.8%  3397  398s
   850   959 71628.4808   29  231 57001.4307 77421.1815  35.8%  3149  405s
   960  1058 71241.6156   32  249 57001.4307 77421.1815  35.8%  2952  413s
  1061  1090 70823.4377   36  238 57001.4307 77421.1815  35.8%  2829  420s
  1093  1132 70616.9984   37  225 57001.4307 77421.1815  35.8%  2808  426s
  1135  1186 69320.5218   38  251 57001.4307 77421.1815  35.8%  2795  433s
  1189  1251 69035.9132   39  211 57001.4307 77421.1815  35.8%  2744  439s
  1256  1321 68928.5130   40  221 57001.4307 77421.1815  35.8%  2697  448s
  1336  1428 67988.4311   41  185 57001.4307 77421.1815  35.8%  2658  457s
  1443  1558 66199.2601   43  167 57001.4307 77421.1815  35.8%  2587  468s
  1593  1673 65310.6985   50  139 57001.4307 77421.1815  35.8%  2463  478s
  1734  1827 62285.7125   53  157 57001.4307 77421.1815  35.8%  2372  490s
  1899  1999 60866.2320   61  122 57001.4307 77421.1815  35.8%  2271  500s
  2083  2149 58633.1401   72  107 57001.4307 77421.1815  35.8%  2162  512s
  2287  2260 57993.8140   85  131 57001.4307 77421.1815  35.8%  2075  527s
  2479  2332     cutoff   46      57001.4307 77254.2732  35.5%  2005  540s
  2623  2371     cutoff   52      57001.4307 77197.9827  35.4%  1990  551s
H 2627  2371                    57016.757073 77197.9827  35.4%  1990  551s
H 2634  2370                    57057.411859 77055.0694  35.0%  1995  551s
  2693  2432 71070.7361   22  225 57057.4119 77055.0694  35.0%  2002  566s
  2807  2498 76312.0699    6  416 57057.4119 77055.0694  35.0%  2024  582s
  2916  2557 76258.9013    7  406 57057.4119 77048.0223  35.0%  2050  599s
  3020  2635 73732.1502    9  257 57057.4119 77048.0223  35.0%  2092  615s
  3118  2712 72587.1053   10  335 57057.4119 77048.0223  35.0%  2140  630s
  3227  2842 72401.2816   11  320 57057.4119 77048.0223  35.0%  2172  649s
  3375  2993 71996.9626   13  274 57057.4119 77048.0223  35.0%  2176  667s
  3564  2994 70823.6632   34  456 57057.4119 77048.0223  35.0%  2167  781s
  3566  2995 74646.4455   12   88 57057.4119 77048.0223  35.0%  2165  830s
  3567  2996 61840.9588   65  322 57057.4119 77048.0223  35.0%  2165  858s
  3568  2997 70964.6634   31  350 57057.4119 77048.0223  35.0%  2164  876s
  3569  2997 63514.2323   30  406 57057.4119 77048.0223  35.0%  2164  887s
  3570  2998 60138.4464  103  355 57057.4119 77048.0223  35.0%  2163  897s
  3571  2999 76210.9197    5  338 57057.4119 77048.0223  35.0%  2162  905s
  3572  2999 73038.0146   14  417 57057.4119 77048.0223  35.0%  2162  911s
  3573  3000 70464.6654   18  404 57057.4119 77048.0223  35.0%  2161  915s
  3575  3001 60298.3842   57  416 57057.4119 77048.0223  35.0%  2160  921s
  3578  3003 72841.4831   27  435 57057.4119 77048.0223  35.0%  2158  926s
  3579  3004 67694.9287   11  446 57057.4119 77048.0223  35.0%  2158  932s
  3582  3006 68577.3681   38  364 57057.4119 77048.0223  35.0%  2156  935s
  3584  3007 66963.1092   27  442 57057.4119 77048.0223  35.0%  2155  940s
  3586  3009 60027.6595  101  367 57057.4119 77048.0223  35.0%  2153  946s
  3588  3010 67347.3145   30  423 57057.4119 77048.0223  35.0%  2152  952s
  3589  3011 65287.9385   58  427 57057.4119 77048.0223  35.0%  2152  955s
  3591  3012 66025.7153   63  418 57057.4119 77048.0223  35.0%  2150  960s
  3593  3013 65291.2149   61  363 57057.4119 77048.0223  35.0%  2149  965s
  3596  3015 63506.6729   51  416 57057.4119 77048.0223  35.0%  2147  974s
  3597  3016 71606.9078   29  416 57057.4119 77048.0223  35.0%  2147  976s
  3598  3017 69259.7499   41  407 57057.4119 77048.0223  35.0%  2146  980s
  3602  3019 73691.7377   14  414 57057.4119 77048.0223  35.0%  2144  992s
  3604  3021 73310.6924    9  376 57057.4119 77048.0223  35.0%  2143  995s
  3606  3022 73340.4450   22  442 57057.4119 77048.0223  35.0%  2141 1001s
  3608  3023 66345.5887   15  441 57057.4119 77048.0223  35.0%  2140 1015s
  3610  3025 65712.1144   20  406 57057.4119 77048.0223  35.0%  2139 1022s
  3612  3026 57485.2386  107  421 57057.4119 77048.0223  35.0%  2138 1027s
  3614  3027 69644.4625   44  365 57057.4119 77048.0223  35.0%  2137 1034s
  3615  3028 68911.9717   41  364 57057.4119 77048.0223  35.0%  2136 1036s
  3616  3029 73419.9770    8  413 57057.4119 77048.0223  35.0%  2136 1040s
  3617  3029 66342.8242   23  413 57057.4119 77048.0223  35.0%  2135 1084s
  3618  3030 70241.5916   22  413 57057.4119 77048.0223  35.0%  2134 1124s
  3619  3034 77048.0223   11  405 57057.4119 77048.0223  35.0%  2198 1139s
  3621  3037 77048.0223   12  399 57057.4119 77048.0223  35.0%  2199 1164s
  3625  3044 77048.0223   13  349 57057.4119 77048.0223  35.0%  2207 1186s
  3633  3057 77048.0223   14  387 57057.4119 77048.0223  35.0%  2226 1209s
  3649  3069 74614.1674   15  402 57057.4119 77048.0223  35.0%  2305 1253s
  3666  3094 73459.1801   16  386 57057.4119 77048.0223  35.0%  2355 1285s
  3697  3210 72998.4441   17  418 57057.4119 77048.0223  35.0%  2454 1318s
  3823  3242 72422.9655   20  337 57057.4119 77048.0223  35.0%  2558 1336s
  3897  3275 72529.3130   19  352 57057.4119 77048.0223  35.0%  2591 1355s
  3955  3302 71634.9464   21  385 57057.4119 77048.0223  35.0%  2629 1370s
  4001  3339 71121.7799   21  392 57057.4119 77048.0223  35.0%  2677 1388s
  4057  3349 71797.4624   22  375 57057.4119 77048.0223  35.0%  2715 1401s
  4089  3366 71464.0733   22  423 57057.4119 77048.0223  35.0%  2738 1416s
  4122  3378 70613.0071   22  355 57057.4119 77048.0223  35.0%  2770 1428s
  4157  3392 70382.4988   23  347 57057.4119 77048.0223  35.0%  2797 1441s
  4190  3422 70116.1360   24  377 57057.4119 77048.0223  35.0%  2821 1459s
  4232  3439 68564.7083   25  365 57057.4119 77048.0223  35.0%  2849 1475s
  4288  3454 64360.6514   25  341 57057.4119 77048.0223  35.0%  2903 1490s
  4351  3462 67107.8506   26  378 57057.4119 77048.0223  35.0%  2933 1509s
  4397  3449 66218.3329   24  311 57057.4119 77048.0223  35.0%  2962 1533s
  4459  3448 66830.2473   26  352 57057.4119 77048.0223  35.0%  3018 1550s
  4513  3459 65708.5857   27  348 57057.4119 77048.0223  35.0%  3084 1572s
  4556  3447 65943.9951   27  283 57057.4119 77048.0223  35.0%  3144 1603s
  4622  3452 64996.1745   28  348 57057.4119 77048.0223  35.0%  3227 1627s
  4670  3456 60051.5757   27  294 57057.4119 77048.0223  35.0%  3330 1651s
  4711  3475 65110.1468   28  355 57057.4119 77048.0223  35.0%  3408 1669s
  4752  3491 58984.1947   28  231 57057.4119 77048.0223  35.0%  3495 1689s
  4792  3517 64195.8072   29  279 57057.4119 76507.6877  34.1%  3551 1709s
  4837  3526 63487.3679   29  337 57057.4119 76507.6877  34.1%  3626 1730s
  4899  3553     cutoff   29      57057.4119 76507.6877  34.1%  3690 1752s
  4971  3571 62103.2460   32  281 57057.4119 76507.6877  34.1%  3767 1781s
  5068  3570 59863.4599   34  214 57057.4119 76507.6877  34.1%  3823 1806s
  5177  3599 59096.2014   38  243 57057.4119 76507.6877  34.1%  3882 1830s
  5306  3607 58459.3346   44  180 57057.4119 76507.6877  34.1%  3930 1855s
  5416  3632     cutoff   45      57057.4119 76507.6877  34.1%  3995 1888s
  5534  3655 69364.1489   19  398 57057.4119 76507.6877  34.1%  4064 1913s
  5677  3652 67997.5021   20  339 57057.4119 76507.6877  34.1%  4106 1941s
  5817  3666 67180.0485   21  319 57057.4119 76507.6877  34.1%  4134 1974s
  5971  3682 65067.9832   24  241 57057.4119 76507.6877  34.1%  4186 2009s
  6116  3694 64422.6567   26  249 57057.4119 76507.6877  34.1%  4244 2046s
  6229  3731 62682.5523   26  176 57057.4119 75631.6403  32.6%  4329 2076s
  6334  3747 62086.2451   29  178 57057.4119 73766.7949  29.3%  4429 2102s
H 6376  3580                    57225.431695 73766.7949  28.9%  4440 2102s
  6425  3630 61298.4518   31  203 57225.4317 73133.3977  27.8%  4444 2146s
  6561  3666     cutoff   36      57225.4317 73017.2470  27.6%  4504 2185s
  6738  3707 58338.9185   39  152 57225.4317 73017.2470  27.6%  4561 2224s
  6943  3722 67945.5548   23  314 57225.4317 73017.2470  27.6%  4590 2262s
  7141  3665 65699.1498   25  277 57225.4317 72637.0644  26.9%  4610 2291s
H 7145  3510                    57344.455266 72637.0644  26.7%  4609 2291s
  7193  3570 65608.8038   26  275 57344.4553 72616.5124  26.6%  4637 2332s
  7391  3599 60730.5188   31  262 57344.4553 72409.8328  26.3%  4670 2379s
  7579  3540     cutoff   36      57344.4553 72409.5253  26.3%  4727 2410s
  7637  3543 69716.2357   20  285 57344.4553 72409.5253  26.3%  4770 2441s
  7677  3556 68592.9774   21  266 57344.4553 72409.5253  26.3%  4789 2477s
  7730  3572 68451.5535   22  262 57344.4553 72252.6965  26.0%  4806 2520s
  7822  3609 67457.1031   23  257 57344.4553 72252.6965  26.0%  4821 2565s
  7952  3652 63913.1763   27  259 57344.4553 72219.4219  25.9%  4877 2605s
H 8026  3453                    57627.485848 72219.4219  25.3%  4924 2605s
  8094  3493 60508.8633   32  321 57627.4858 72219.4219  25.3%  4915 2654s
  8336  3509 67745.8581   19  294 57627.4858 71851.0332  24.7%  5022 2702s
  8573  3556 60711.5113   21  254 57627.4858 71766.3773  24.5%  5143 2747s
  8775  3588     cutoff   23      57627.4858 71661.7533  24.4%  5293 2797s
  9013  3611 60181.9229   25  326 57627.4858 71611.5179  24.3%  5415 2852s
  9321  3545     cutoff   29      57627.4858 71513.8340  24.1%  5487 2904s
H 9324  3405                    57666.775988 71513.8340  24.0%  5488 2904s
H 9324  3252                    57760.772735 71513.8340  23.8%  5488 2904s
H 9346  3075                    58046.120327 71513.8340  23.2%  5484 2904s
H 9365  2942                    58082.594765 71513.8340  23.1%  5486 2904s
H 9465  2803                    58083.659956 71513.8340  23.1%  5494 2904s
  9474  2912 67342.0585   27  272 58083.6600 71513.8340  23.1%  5500 2962s
  9730  2974     cutoff   32      58083.6600 71506.4385  23.1%  5622 3022s
 10037  3109 60801.0151   28  333 58083.6600 71367.5003  22.9%  5723 3080s
 10341  3235 66188.6987   19  357 58083.6600 71365.8701  22.9%  5830 3142s
 10704  3321 60945.5082   25  303 58083.6600 71347.9879  22.8%  5905 3202s
H10829  3294                    58172.010438 71119.3113  22.3%  5950 3202s
 10960  3401     cutoff   30      58172.0104 71119.3113  22.3%  5983 3280s
 11287  3613 66255.6151   22  389 58172.0104 70938.8439  21.9%  6060 3355s
 11655  3776 59397.4445   26  194 58172.0104 70937.4331  21.9%  6169 3427s
 12126  3930 62963.1981   23  297 58172.0104 70573.1492  21.3%  6239 3504s
 12560  4098 58452.6939   23  175 58172.0104 70397.7223  21.0%  6310 3590s
 12972  4091 59509.2492   32  283 58172.0104 70397.7223  21.0%  6417 3600s

Cutting planes:
  MIR: 927
  Mixing: 2
  Flow cover: 2185
  RLT: 39
  Relax-and-lift: 148

Explored 13035 nodes (83785998 simplex iterations) in 3600.04 seconds (10557.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 58172 58083.7 58082.6 ... 57057.4

Time limit reached
Best objective 5.817201043829e+04, best bound 7.039772230947e+04, gap 21.0165%
  WARNING: Time limit reached. Using best solution found (gap: 21.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 58172.01, θ = 224018.57
  Upper Bound (UB) = 58172.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 224018.57
  [DEBUG]   ✓ Scenario 0: θ = 224018.57 ≤ Q = 224018.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 224018.57 ≤ Q = 224018.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 224018.57 ≤ Q = 224018.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 224018.57 ≤ Q = 224018.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 224018.57 ≤ Q = 224018.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 224018.57 ≤ Q = 224018.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 224018.57 ≤ Q = 224018.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 224018.57 ≤ Q = 224018.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x76f449b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x890bb64b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.383508e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1517 nonzeros
Found heuristic solution: objective 6875298.8316
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.838206e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -183820.58    0  130 6875298.83 -183820.58   103%     -    0s
H    0     0                    -145988.4609 -183820.58  25.9%     -    0s
H    0     0                    -147077.0593 -183820.58  25.0%     -    0s
H    0     0                    -151000.6541 -183820.58  21.7%     -    0s
H    0     0                    -151017.8417 -168334.31  11.5%     -    0s
     0     0 -168334.31    0   93 -151017.84 -168334.31  11.5%     -    0s
H    0     0                    -165557.4519 -168230.39  1.61%     -    0s
     0     0 -167695.15    0   91 -165557.45 -167695.15  1.29%     -    0s
     0     0 -167087.33    0   50 -165557.45 -167087.33  0.92%     -    0s
H    0     0                    -166629.7619 -167081.53  0.27%     -    0s
     0     0 -167080.56    0   47 -166629.76 -167080.56  0.27%     -    0s
     0     0 -166807.60    0   23 -166629.76 -166807.60  0.11%     -    0s
     0     0 -166799.75    0   16 -166629.76 -166799.75  0.10%     -    0s
     0     0 -166714.55    0   11 -166629.76 -166714.55  0.05%     -    0s
     0     0 -166687.18    0    6 -166629.76 -166687.18  0.03%     -    0s
     0     0 -166687.17    0    7 -166629.76 -166687.17  0.03%     -    0s
     0     0 -166666.37    0    5 -166629.76 -166666.37  0.02%     -    0s
     0     0 -166661.36    0    7 -166629.76 -166661.36  0.02%     -    0s
H    0     0                    -166649.2400 -166661.36  0.01%     -    0s
     0     0 -166650.01    0    2 -166649.24 -166650.01  0.00%     -    0s
*    0     0               0    -166649.7250 -166649.72  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 1
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (731 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -166650 -166649 -166630 ... -145988
No other solutions better than -166650

Optimal solution found (tolerance 1.00e-06)
Best objective -1.666497249699e+05, best bound -1.666497249699e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 207355.70
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166649.72
  [DEBUG]   S×d_nominal = 374005.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374005.42 + -166649.72 = 207355.70
  [DEBUG]   Current θ from Master = 224018.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16662.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41509.14
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 4845.0632, Absolute Gap = 4845.0632, Relative Gap = 0.083289
  Not converged yet (gap = 4845.06 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xcd58a4e6
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 1.20s
Presolved: 81726 rows, 35173 columns, 500096 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -286903.3548
Found heuristic solution: objective -219165.9246

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.397e+06
 Factor NZ  : 7.331e+06 (roughly 100 MB of memory)
 Factor Ops : 1.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.56832100e+07  1.69473794e+08  1.31e+05 1.94e+01  8.29e+04     2s
   1  -1.17069756e+07  1.54226419e+08  9.15e+04 1.01e+02  5.71e+04     2s
   2  -5.89404465e+06  1.22572312e+08  4.48e+04 1.97e+01  2.89e+04     2s
   3  -1.01082337e+06  8.96829785e+07  2.65e+03 2.74e-01  2.23e+03     2s
   4  -6.98486903e+05  3.22452689e+07  5.75e+02 7.44e-02  5.19e+02     2s
   5  -3.46552106e+05  2.23383690e+07  2.53e+02 4.50e-02  2.74e+02     2s
   6  -2.67658900e+05  1.59585329e+07  6.75e+01 3.08e-02  1.38e+02     2s
   7  -1.85929763e+05  1.19777004e+07  3.08e+01 2.24e-02  9.26e+01     2s
   8  -1.06649169e+05  9.43911509e+06  1.24e+01 1.72e-02  6.75e+01     3s
   9  -8.79808356e+04  5.66414396e+06  7.72e+00 9.96e-03  3.99e+01     3s
  10  -5.20400508e+04  2.56811117e+06  2.14e+00 4.24e-03  1.77e+01     3s
  11  -9.82094977e+03  5.02209599e+05  6.67e-01 7.87e-04  3.43e+00     3s
  12   9.11706982e+03  3.41554174e+05  4.63e-01 5.50e-04  2.22e+00     3s
  13   1.66792240e+04  2.96379663e+05  4.08e-01 2.60e-04  1.87e+00     3s
  14   3.39309126e+04  2.24638727e+05  2.97e-01 1.04e-03  1.28e+00     3s
  15   4.32213336e+04  1.95319117e+05  2.46e-01 1.08e-03  1.02e+00     3s
  16   5.27736410e+04  1.63310652e+05  1.93e-01 1.25e-03  7.39e-01     3s
  17   6.04707095e+04  1.47575051e+05  1.52e-01 1.14e-03  5.82e-01     3s
  18   6.62580073e+04  1.35210057e+05  1.24e-01 1.17e-03  4.61e-01     3s
  19   7.18571341e+04  1.22183046e+05  9.91e-02 1.64e-03  3.37e-01     3s
  20   7.48243936e+04  1.17381784e+05  8.71e-02 1.38e-03  2.85e-01     3s
  21   8.08325310e+04  1.12148737e+05  6.25e-02 1.40e-03  2.09e-01     3s
  22   8.50724896e+04  1.08157327e+05  4.61e-02 1.46e-03  1.54e-01     3s
  23   8.73410159e+04  1.05067010e+05  3.71e-02 1.19e-03  1.19e-01     3s
  24   8.96017530e+04  1.02949026e+05  2.88e-02 8.46e-04  8.93e-02     3s
  25   9.18584703e+04  1.01815212e+05  2.06e-02 6.56e-04  6.66e-02     3s
  26   9.28531224e+04  1.00274510e+05  1.69e-02 8.61e-04  4.97e-02     3s
  27   9.37008398e+04  9.97633875e+04  1.37e-02 7.05e-04  4.06e-02     3s
  28   9.39044245e+04  9.96918365e+04  1.30e-02 6.82e-04  3.87e-02     3s
  29   9.45456032e+04  9.92148923e+04  1.06e-02 3.93e-04  3.13e-02     4s
  30   9.55934292e+04  9.89028029e+04  6.85e-03 2.50e-04  2.21e-02     4s
  31   9.59449906e+04  9.84609167e+04  5.59e-03 1.28e-04  1.68e-02     4s
  32   9.63721109e+04  9.83122342e+04  4.14e-03 1.04e-04  1.30e-02     4s
  33   9.64433685e+04  9.81180519e+04  3.90e-03 7.29e-05  1.12e-02     4s
  34   9.66360930e+04  9.79951460e+04  3.25e-03 5.27e-05  9.10e-03     4s
  35   9.67891522e+04  9.79715117e+04  2.74e-03 4.90e-05  7.91e-03     4s
  36   9.69031382e+04  9.78564148e+04  2.38e-03 4.15e-05  6.38e-03     4s
  37   9.71586754e+04  9.78161458e+04  1.53e-03 4.25e-05  4.40e-03     4s
  38   9.72219594e+04  9.78056454e+04  1.33e-03 3.95e-05  3.91e-03     4s
  39   9.73339478e+04  9.77802554e+04  9.68e-04 3.29e-05  2.99e-03     4s
  40   9.74338457e+04  9.77367033e+04  6.61e-04 2.43e-05  2.03e-03     4s
  41   9.75914119e+04  9.76982687e+04  1.79e-04 2.59e-05  7.14e-04     4s
  42   9.76495557e+04  9.76647982e+04  2.20e-05 5.71e-06  1.02e-04     4s
  43   9.76585486e+04  9.76603120e+04  7.58e-07 7.85e-07  1.18e-05     4s
  44   9.76590592e+04  9.76591998e+04  1.16e-08 9.52e-08  9.36e-07     4s
  45   9.76590688e+04  9.76590778e+04  3.00e-09 8.82e-09  6.00e-08     4s
  46   9.76590690e+04  9.76590690e+04  1.42e-10 1.18e-10  1.41e-11     4s

Barrier solved model in 46 iterations and 4.39 seconds (6.62 work units)
Optimal objective 9.76590690e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

     461 PPushes remaining with PInf 3.4693036e-08                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4447772e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36980    9.7659069e+04   0.000000e+00   0.000000e+00      6s
   36980    9.7659069e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 9.765907e+04, 36980 iterations, 4.92 seconds (8.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 97659.0690    0  172 -219165.92 97659.0690   145%     -    6s
H    0     0                    -214534.6080 97659.0690   146%     -    6s
H    0     0                    -94208.86920 97659.0690   204%     -    7s
H    0     0                    -93500.08298 97659.0690   204%     -    7s
H    0     0                    -91963.12001 97659.0690   206%     -    7s
H    0     0                    -90601.79637 97659.0690   208%     -    7s
H    0     0                    -68136.71473 97659.0690   243%     -    7s
H    0     0                    -62208.74960 97659.0690   257%     -    7s
H    0     0                    -62016.36759 97659.0690   257%     -    7s
H    0     0                    42062.605867 97659.0690   132%     -    7s
H    0     0                    42549.488219 97659.0690   130%     -    7s
H    0     0                    44188.145625 97659.0690   121%     -    8s
H    0     0                    44273.643576 97659.0690   121%     -    8s
H    0     0                    44417.341803 97659.0690   120%     -    8s
H    0     0                    44495.098788 97659.0690   119%     -    8s
H    0     0                    44613.818786 97659.0690   119%     -    8s
H    0     0                    44664.888428 97659.0690   119%     -    8s
H    0     0                    44669.759778 97659.0690   119%     -    9s
H    0     0                    44828.473320 88988.0402  98.5%     -   34s
H    0     0                    45282.951193 88988.0402  96.5%     -   34s
H    0     0                    46206.413294 88988.0402  92.6%     -   34s
H    0     0                    46424.450874 88988.0402  91.7%     -   34s
H    0     0                    46791.327425 88988.0402  90.2%     -   34s
     0     0 88988.0402    0  255 46791.3274 88988.0402  90.2%     -   34s
H    0     0                    49126.602468 88987.8338  81.1%     -   34s
H    0     0                    49820.958117 88987.8338  78.6%     -   35s
H    0     0                    50160.727347 88987.8338  77.4%     -   35s
     0     0 88300.2140    0  280 50160.7273 88300.2140  76.0%     -   52s
     0     0 88183.9345    0  281 50160.7273 88183.9345  75.8%     -   61s
     0     0 88164.6739    0  294 50160.7273 88164.6739  75.8%     -   65s
     0     0 88150.6949    0  302 50160.7273 88150.6949  75.7%     -   67s
     0     0 88148.9095    0  302 50160.7273 88148.9095  75.7%     -   67s
     0     0 88148.9066    0  302 50160.7273 88148.9066  75.7%     -   68s
H    0     0                    51919.950158 83950.4497  61.7%     -   96s
H    0     0                    51952.148540 83950.4497  61.6%     -   96s
H    0     0                    52430.456152 83950.4497  60.1%     -   96s
     0     0 83950.4497    0  316 52430.4562 83950.4497  60.1%     -   96s
H    0     0                    52625.656768 83950.3387  59.5%     -   97s
H    0     0                    52882.250119 83950.3387  58.7%     -   97s
H    0     0                    53173.818683 83950.3387  57.9%     -   97s
     0     0 83504.6970    0  313 53173.8187 83504.6970  57.0%     -  112s
     0     0 83283.6953    0  324 53173.8187 83283.6953  56.6%     -  122s
     0     0 83151.5837    0  342 53173.8187 83151.5837  56.4%     -  129s
     0     0 83102.6574    0  360 53173.8187 83102.6574  56.3%     -  135s
     0     0 83091.5071    0  351 53173.8187 83091.5071  56.3%     -  136s
     0     0 83089.4492    0  349 53173.8187 83089.4492  56.3%     -  137s
     0     0 83087.9831    0  350 53173.8187 83087.9831  56.3%     -  138s
H    0     0                    53752.725324 81283.2493  51.2%     -  171s
H    0     0                    53961.413493 81283.2493  50.6%     -  171s
H    0     0                    54236.637347 81283.2493  49.9%     -  171s
H    0     0                    54376.524623 81283.2493  49.5%     -  171s
H    0     0                    54563.616404 81283.2493  49.0%     -  171s
     0     0 81283.2493    0  330 54563.6164 81283.2493  49.0%     -  171s
H    0     0                    54908.618333 80879.9594  47.3%     -  185s
     0     0 80879.9594    0  357 54908.6183 80879.9594  47.3%     -  185s
     0     0 80734.8228    0  381 54908.6183 80734.8228  47.0%     -  195s
H    0     0                    55271.123794 80627.1307  45.9%     -  204s
H    0     0                    55649.883872 80627.1307  44.9%     -  204s
H    0     0                    55702.947658 80627.1307  44.7%     -  204s
     0     0 80627.1307    0  418 55702.9477 80627.1307  44.7%     -  204s
     0     0 80590.0657    0  386 55702.9477 80590.0657  44.7%     -  209s
     0     0 80575.3453    0  396 55702.9477 80575.3453  44.7%     -  212s
     0     0 80559.7630    0  434 55702.9477 80559.7630  44.6%     -  214s
     0     0 80558.1582    0  431 55702.9477 80558.1582  44.6%     -  215s
     0     0 79436.6359    0  389 55702.9477 79436.6359  42.6%     -  248s
H    0     0                    55744.223365 79089.1569  41.9%     -  267s
     0     0 79089.1569    0  378 55744.2234 79089.1569  41.9%     -  267s
     0     0 78936.6884    0  390 55744.2234 78936.6884  41.6%     -  277s
     0     0 78886.9305    0  386 55744.2234 78886.9305  41.5%     -  282s
     0     0 78872.1383    0  394 55744.2234 78872.1383  41.5%     -  285s
     0     0 78821.7681    0  413 55744.2234 78821.7681  41.4%     -  290s
     0     0 78810.6556    0  418 55744.2234 78810.6556  41.4%     -  292s
     0     0 78804.6688    0  422 55744.2234 78804.6688  41.4%     -  294s
     0     0 78802.5599    0  412 55744.2234 78802.5599  41.4%     -  295s
     0     0 78538.0543    0  408 55744.2234 78538.0543  40.9%     -  306s
H    0     0                    56195.793510 78537.9318  39.8%     -  307s
H    0     0                    56205.754595 78537.9318  39.7%     -  307s
     0     0 78490.0585    0  413 56205.7546 78490.0585  39.6%     -  313s
     0     0 78473.3010    0  422 56205.7546 78473.3010  39.6%     -  315s
     0     0 78463.2425    0  425 56205.7546 78463.2425  39.6%     -  320s
     0     0 78458.7839    0  426 56205.7546 78458.7839  39.6%     -  321s
     0     0 78455.1568    0  424 56205.7546 78455.1568  39.6%     -  323s
     0     0 78453.3496    0  424 56205.7546 78453.3496  39.6%     -  324s
     0     0 78359.2695    0  452 56205.7546 78359.2695  39.4%     -  334s
H    0     0                    56448.109039 78359.0262  38.8%     -  336s
     0     0 78335.0501    0  423 56448.1090 78335.0501  38.8%     -  339s
     0     0 78332.8395    0  363 56448.1090 78332.8395  38.8%     -  340s
     0     0 78292.6938    0  403 56448.1090 78292.6938  38.7%     -  344s
     0     0 78275.7536    0  414 56448.1090 78275.7536  38.7%     -  346s
     0     0 78267.7320    0  402 56448.1090 78267.7320  38.7%     -  348s
     0     0 78265.1539    0  403 56448.1090 78265.1539  38.6%     -  349s
     0     0 78190.8771    0  404 56448.1090 78190.8771  38.5%     -  357s
H    0     0                    56534.319043 78190.8106  38.3%     -  358s
H    0     0                    56630.032885 78190.8106  38.1%     -  359s
     0     0 78161.2788    0  350 56630.0329 78161.2788  38.0%     -  361s
     0     0 78155.8380    0  354 56630.0329 78155.8380  38.0%     -  363s
     0     0 78154.6507    0  426 56630.0329 78154.6507  38.0%     -  364s
     0     0 78149.9837    0  418 56630.0329 78149.9837  38.0%     -  367s
     0     0 78145.2198    0  352 56630.0329 78145.2198  38.0%     -  368s
     0     0 78118.8106    0  340 56630.0329 78118.8106  37.9%     -  372s
     0     0 78116.4293    0  397 56630.0329 78116.4293  37.9%     -  376s
     0     0 78111.8378    0  400 56630.0329 78111.8378  37.9%     -  379s
     0     0 78110.0556    0  412 56630.0329 78110.0556  37.9%     -  386s
     0     0 78101.6224    0  413 56630.0329 78101.6224  37.9%     -  389s
     0     0 78097.6950    0  423 56630.0329 78097.6950  37.9%     -  390s
     0     0 78096.1987    0  418 56630.0329 78096.1987  37.9%     -  391s
     0     0 78095.1670    0  405 56630.0329 78095.1670  37.9%     -  393s
     0     0 78094.8886    0  405 56630.0329 78094.8886  37.9%     -  394s
     0     2 78094.5645    0  405 56630.0329 78094.5645  37.9%     -  489s
     1     4 77968.8349    1  353 56630.0329 78094.5645  37.9%  3345  500s
     3     8 77812.8699    2  397 56630.0329 77968.0950  37.7%  6945  518s
     7    16 77756.3421    3  416 56630.0329 77812.7344  37.4%  8670  530s
    15    32 77571.2366    4  455 56630.0329 77755.7225  37.3%  8420  557s
    31    48 77157.9619    5  467 56630.0329 77570.8783  37.0% 13474  611s
    47    78 75629.4971    6  407 56630.0329 77570.8783  37.0% 12278  649s
    77   131 76206.6589    7  342 56630.0329 77570.8783  37.0% 11060  708s
   130   163 76039.3684   10  432 56630.0329 77570.8783  37.0%  7916  727s
   162   198 76023.5919   11  465 56630.0329 77570.8783  37.0%  7327  748s
   197   230 75859.1069   12  464 56630.0329 77570.8783  37.0%  6791  771s
   229   264 75707.2797   13  467 56630.0329 77570.8783  37.0%  6458  791s
   263   298 75416.0574   16  439 56630.0329 77570.8783  37.0%  6062  814s
   297   332 75193.1276   19  441 56630.0329 77570.8783  37.0%  5821  840s
   331   365 71883.9016   24  336 56630.0329 77570.8783  37.0%  5594  865s
   364   401 71834.2395   27  344 56630.0329 77570.8783  37.0%  5568  888s
   400   437 71284.3557   32  301 56630.0329 77570.8783  37.0%  5538  918s
   436   474 69914.7268   37  276 56630.0329 77570.8783  37.0%  5772  949s
H  450   474                    56648.535416 77570.8783  36.9%  5795  949s
H  466   474                    56662.871733 77570.8783  36.9%  5796  949s
   473   508 69277.1575   42  268 56662.8717 77570.8783  36.9%  5813  995s
   511   621 69038.2642   46  228 56662.8717 77570.8783  36.9%  5867 1026s
   630   703 68627.1398   51  246 56662.8717 77570.8783  36.9%  5848 1049s
   716   789 67824.0652   55  184 56662.8717 77570.8783  36.9%  5929 1070s
   802   895 67415.1806   60  179 56662.8717 77570.8783  36.9%  5983 1091s
   910   986 65766.2571   66  156 56662.8717 77570.8783  36.9%  5842 1111s
  1013  1099 61348.8631   70  126 56662.8717 77570.8783  36.9%  5864 1136s
  1136  1161 59356.4252   77  125 56662.8717 77570.8783  36.9%  5809 1154s
H 1154  1161                    56700.806596 77570.8783  36.8%  5789 1154s
  1206  1269 58467.2011   85  155 56700.8066 77570.8783  36.8%  5716 1175s
  1340  1348     cutoff   92      56700.8066 77570.8783  36.8%  5584 1198s
  1451  1483     cutoff   89      56700.8066 77570.8783  36.8%  5581 1223s
  1610  1612 58968.1896   28  252 56700.8066 77570.8783  36.8%  5455 1245s
  1779  1752 58751.3109   29  231 56700.8066 77570.8783  36.8%  5303 1270s
  1975  1850 58064.9388   32  222 56700.8066 77379.6995  36.5%  5151 1296s
  2147  1971     cutoff   41      56700.8066 77379.6995  36.5%  5052 1323s
  2310  1998 73320.0395   10  287 56700.8066 77379.6995  36.5%  4970 1343s
H 2319  1998                    56822.188659 77379.6995  36.2%  4966 1343s
H 2347  1998                    56964.539887 77379.6995  35.8%  4995 1343s
  2353  2084 64097.9580   11  300 56964.5399 77379.6995  35.8%  5004 1371s
  2495  2158 62650.8475   12  264 56964.5399 77335.3374  35.8%  5043 1401s
  2619  2264 62597.8201   13  261 56964.5399 77335.3374  35.8%  5102 1435s
  2733  2370 58806.3126   17  257 56964.5399 77335.3374  35.8%  5194 1466s
  2871  2452     cutoff   18      56964.5399 77335.3374  35.8%  5273 1498s
  3017  2552     cutoff   19      56964.5399 77077.6235  35.3%  5342 1531s
  3159  2644 74567.9807    6  287 56964.5399 77077.4965  35.3%  5387 1568s
  3305  2779 70535.6853    8  282 56964.5399 77077.4965  35.3%  5479 1607s
  3469  2802 70052.1422   10  281 56964.5399 77077.4965  35.3%  5524 1643s
H 3476  2802                    57007.407684 77077.4965  35.2%  5517 1643s
  3506  2944 69867.2081   11  290 57007.4077 77077.4965  35.2%  5555 1680s
  3701  2945 64790.5709   26  405 57007.4077 77077.4965  35.2%  5563 1813s
H 3702  2798                    57118.710041 77077.4965  34.9%  5562 1822s
H 3702  2658                    57172.570027 77077.4965  34.8%  5562 1822s
  3704  2659 57513.3901   67  310 57172.5700 77077.4965  34.8%  5559 1862s
  3705  2660 69943.8052   32  355 57172.5700 77077.4965  34.8%  5557 1889s
  3706  2660 59363.1732   34  391 57172.5700 77077.4965  34.8%  5556 1917s
  3707  2661 70400.3999   23  393 57172.5700 77077.4965  34.8%  5554 1937s
  3708  2662 71286.2348   32  400 57172.5700 77077.4965  34.8%  5553 1953s
  3709  2662 66717.4741   23  447 57172.5700 77077.4965  34.8%  5551 1971s
  3710  2663 68277.0389   21  417 57172.5700 77077.4965  34.8%  5550 1976s
  3712  2664 60667.4858   31  456 57172.5700 77077.4965  34.8%  5547 1982s
  3714  2666 60764.4283   36  395 57172.5700 77077.4965  34.8%  5544 1986s
  3716  2667 66462.3097   26  453 57172.5700 77077.4965  34.8%  5541 1996s
  3718  2668 71872.5867   19  417 57172.5700 77077.4965  34.8%  5538 2002s
  3719  2669 58538.8740   64  353 57172.5700 77077.4965  34.8%  5536 2009s
  3720  2670 76065.8847   13  419 57172.5700 77077.4965  34.8%  5535 2013s
  3721  2670 74847.2766   13  360 57172.5700 77077.4965  34.8%  5533 2017s
  3722  2671 61000.8679   29  416 57172.5700 77077.4965  34.8%  5532 2020s
  3723  2672 62402.4334   16  449 57172.5700 77077.4965  34.8%  5530 2026s
  3725  2673 65740.5172   29  444 57172.5700 77077.4965  34.8%  5528 2034s
  3726  2674 73261.5205   14  403 57172.5700 77077.4965  34.8%  5526 2036s
  3728  2675 63477.5022   50  407 57172.5700 77077.4965  34.8%  5523 2044s
  3729  2676 69104.4709   38  409 57172.5700 77077.4965  34.8%  5522 2048s
  3730  2676 76129.6004   11  445 57172.5700 77077.4965  34.8%  5520 2056s
  3732  2678 58681.1564   64  413 57172.5700 77077.4965  34.8%  5517 2064s
  3733  2678 58964.7080   33  401 57172.5700 77077.4965  34.8%  5516 2066s
  3734  2679 74878.2817   14  407 57172.5700 77077.4965  34.8%  5514 2074s
  3735  2680 58801.6360   51  407 57172.5700 77077.4965  34.8%  5513 2084s
  3736  2680 75094.7177   15  407 57172.5700 77077.4965  34.8%  5511 2135s
  3737  2684 77077.4965   13  385 57172.5700 77077.4965  34.8%  5575 2187s
  3739  2687 77077.4965   14  396 57172.5700 77077.4965  34.8%  5578 2223s
  3743  2694 77077.4965   15  401 57172.5700 77077.4965  34.8%  5585 2278s
  3751  2707 77016.5004   16  395 57172.5700 77077.4965  34.8%  5606 2326s
  3767  2720 72387.7797   17  286 57172.5700 77016.4940  34.7%  5689 2418s
  3785  2746 73671.1931   18  396 57172.5700 77016.0327  34.7%  5742 2483s
H 3800  2607                    57344.455266 77016.0327  34.3%  5780 2483s
  3817  2756 73526.3823   19  413 57344.4553 77016.0327  34.3%  5804 2543s
  3972  2736 72720.5561   22  358 57344.4553 77016.0327  34.3%  5812 2561s
  4003  2764 72639.0605   24  405 57344.4553 77016.0327  34.3%  5805 2584s
  4042  2806 72587.5351   23  380 57344.4553 77016.0327  34.3%  5809 2608s
  4097  2835 72284.6080   25  387 57344.4553 77016.0327  34.3%  5809 2632s
  4145  2873 69259.9580   25  290 57344.4553 77016.0327  34.3%  5835 2654s
  4208  2912 68118.2288   26  260 57344.4553 77016.0327  34.3%  5848 2677s
  4281  2909 68084.2012   27  255 57344.4553 77016.0327  34.3%  5845 2696s
  4310  2918 67973.2317   28  252 57344.4553 77016.0327  34.3%  5853 2718s
  4349  2923 67854.2603   29  260 57344.4553 77016.0327  34.3%  5886 2740s
  4380  2937 66933.2200   30  261 57344.4553 77016.0327  34.3%  5919 2761s
  4415  2945 65494.0682   30  252 57344.4553 77016.0327  34.3%  5944 2782s
  4452  2952 67894.0367   29  269 57344.4553 77016.0327  34.3%  5965 2806s
  4483  2953 58190.6025   37  223 57344.4553 77016.0327  34.3%  6010 2834s
  4519  2952 66852.3964   31  260 57344.4553 77016.0327  34.3%  6033 2858s
  4568  2959 infeasible   39      57344.4553 77016.0327  34.3%  6069 2888s
  4615  2949 infeasible   39      57344.4553 77016.0327  34.3%  6093 2916s
  4671  2938 63465.7378   31  228 57344.4553 77016.0327  34.3%  6143 2951s
  4734  2919 61114.5463   32  250 57344.4553 77016.0327  34.3%  6166 2983s
  4799  2903 61361.1953   32  353 57344.4553 77016.0327  34.3%  6204 3018s
  4847  2891 59310.9219   32  299 57344.4553 77016.0327  34.3%  6255 3048s
  4880  2897 60835.0971   33  337 57344.4553 77016.0327  34.3%  6316 3082s
  4920  2909 60426.7992   34  336 57344.4553 77016.0327  34.3%  6381 3115s
  4959  2936 60366.6450   35  290 57344.4553 77016.0327  34.3%  6448 3150s
  5009  2965 58532.2604   37  270 57344.4553 77016.0327  34.3%  6533 3188s
  5058  3003 58199.3686   39  281 57344.4553 77016.0327  34.3%  6611 3224s
  5127  3019     cutoff   44      57344.4553 77016.0327  34.3%  6651 3265s
  5207  3036 70609.3785   19  416 57344.4553 76266.2232  33.0%  6701 3307s
  5282  3067 70203.1585   21  388 57344.4553 76266.2232  33.0%  6780 3349s
  5353  3093 63746.2344   23  329 57344.4553 76266.2232  33.0%  6838 3389s
  5440  3106 62467.6823   25  305 57344.4553 76266.2232  33.0%  6912 3430s
  5529  3112 60463.7983   27  248 57344.4553 76266.2232  33.0%  6979 3471s
  5624  3116 58132.5665   29  257 57344.4553 76266.2232  33.0%  7062 3518s
  5725  3132 60593.1636   34  236 57344.4553 76266.2232  33.0%  7129 3569s
  5854  3118 59999.1444   42  191 57344.4553 76266.2232  33.0%  7176 3600s

Cutting planes:
  Learned: 1
  Gomory: 32
  Implied bound: 15
  Projected implied bound: 35
  MIR: 1369
  Mixing: 5
  Flow cover: 1874
  RLT: 20
  Relax-and-lift: 257

Explored 5947 nodes (43090769 simplex iterations) in 3600.08 seconds (9412.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 57344.5 57172.6 57118.7 ... 56630

Time limit reached
Best objective 5.734445526558e+04, best bound 7.626622316133e+04, gap 32.9967%
  WARNING: Time limit reached. Using best solution found (gap: 33.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 57344.46, θ = 229734.67
  Upper Bound (UB) = 57344.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229734.67
  [DEBUG]   ✓ Scenario 0: θ = 229734.67 ≤ Q = 229734.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x29edabc1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x29edabc1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.406935e+13
Presolve removed 2560 rows and 1850 columns
Presolve time: 0.00s
Presolved: 533 rows, 539 columns, 1505 nonzeros
Found heuristic solution: objective 7001042.9203
Variable types: 366 continuous, 173 integer (173 binary)

Root relaxation: objective -1.892645e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189264.46    0  126 7001042.92 -189264.46   103%     -    0s
H    0     0                    -156288.0820 -189264.46  21.1%     -    0s
H    0     0                    -156746.7766 -189013.35  20.6%     -    0s
     0     0 -170821.11    0  107 -156746.78 -170821.11  8.98%     -    0s
H    0     0                    -165767.7269 -170686.96  2.97%     -    0s
     0     0 -170372.53    0  110 -165767.73 -170372.53  2.78%     -    0s
H    0     0                    -167467.1179 -170372.53  1.73%     -    0s
     0     0 -168865.63    0   97 -167467.12 -168865.63  0.84%     -    0s
H    0     0                    -167921.4479 -168843.90  0.55%     -    0s
     0     0 -168843.90    0   97 -167921.45 -168843.90  0.55%     -    0s
     0     0 -168529.09    0   58 -167921.45 -168529.09  0.36%     -    0s
     0     0 -168504.22    0   49 -167921.45 -168504.22  0.35%     -    0s
     0     0 -168503.69    0   48 -167921.45 -168503.69  0.35%     -    0s
     0     0 -168400.08    0   46 -167921.45 -168400.08  0.29%     -    0s
     0     0 -168373.39    0   46 -167921.45 -168373.39  0.27%     -    0s
     0     0 -168364.34    0   44 -167921.45 -168364.34  0.26%     -    0s
     0     0 -168352.87    0   44 -167921.45 -168352.87  0.26%     -    0s
     0     2 -168352.87    0   44 -167921.45 -168352.87  0.26%     -    0s
H   39    24                    -167953.5277 -168153.45  0.12%   8.9    0s
H   98    57                    -167971.7709 -168110.72  0.08%   6.1    0s
H  114    57                    -167981.5137 -168107.23  0.07%   5.9    0s
H  153    57                    -167997.3703 -168062.32  0.04%   5.5    0s

Cutting planes:
  Gomory: 49
  Implied bound: 4
  MIR: 150
  Flow cover: 6
  RLT: 57
  Relax-and-lift: 5
  BQP: 5

Explored 235 nodes (1879 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -167997 -167982 -167972 ... 1.40693e+13
No other solutions better than -167997

Optimal solution found (tolerance 1.00e-06)
Best objective -1.679973703326e+05, best bound -1.679973703326e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 216497.67
  Scenario: 50 demand increases, 10 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -167997.37
  [DEBUG]   S×d_nominal = 384495.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384495.04 + -167997.37 = 216497.67
  [DEBUG]   Current θ from Master = 229734.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13237.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44107.45
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 4017.5080, Absolute Gap = 4017.5080, Relative Gap = 0.070059
  Not converged yet (gap = 4017.51 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 50 increases, 10 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0x9b288115
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.34s
Presolved: 90653 rows, 38830 columns, 550719 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -297282.7295
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.926e+06
 Factor NZ  : 8.519e+06 (roughly 120 MB of memory)
 Factor Ops : 1.467e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62874874e+07  1.86658740e+08  1.39e+05 1.85e+01  8.56e+04     2s
   1  -1.22733451e+07  1.71654210e+08  9.78e+04 1.08e+02  5.94e+04     2s
   2  -6.58077737e+06  1.41099452e+08  5.10e+04 3.99e+01  3.20e+04     3s
   3  -1.23952560e+06  1.04527660e+08  4.67e+03 1.70e+00  3.44e+03     3s
   4  -6.88957038e+05  4.93454225e+07  6.31e+02 2.44e-01  6.41e+02     3s
   5  -5.23045259e+05  3.19368944e+07  2.50e+02 1.36e-01  3.18e+02     3s
   6  -3.14613182e+05  2.18824477e+07  7.98e+01 8.66e-02  1.68e+02     3s
   7  -2.57154179e+05  1.73507677e+07  4.72e+01 6.70e-02  1.24e+02     3s
   8  -1.53228891e+05  1.10811573e+07  1.19e+01 4.06e-02  7.11e+01     3s
   9  -8.91682485e+04  6.92686316e+06  6.83e+00 2.46e-02  4.36e+01     3s
  10  -5.32465352e+04  4.19265980e+06  3.48e+00 1.42e-02  2.60e+01     3s
  11   5.23335600e+03  7.52969420e+05  7.70e-01 2.22e-03  4.52e+00     3s
  12   2.72895517e+04  5.07930860e+05  4.95e-01 1.43e-03  2.90e+00     3s
  13   3.55680886e+04  3.43520303e+05  3.77e-01 1.03e-03  1.86e+00     3s
  14   4.19470252e+04  2.59188828e+05  3.09e-01 7.16e-04  1.31e+00     3s
  15   5.07888821e+04  2.12664597e+05  2.34e-01 9.60e-04  9.75e-01     3s
  16   6.10096258e+04  1.63624851e+05  1.67e-01 1.69e-03  6.18e-01     3s
  17   7.14172592e+04  1.49423666e+05  1.11e-01 1.42e-03  4.70e-01     3s
  18   7.75848280e+04  1.35063881e+05  8.22e-02 1.29e-03  3.46e-01     3s
  19   8.41246793e+04  1.26118506e+05  5.20e-02 1.22e-03  2.53e-01     3s
  20   8.67484596e+04  1.20102410e+05  4.06e-02 1.29e-03  2.01e-01     3s
  21   8.92690835e+04  1.12086435e+05  3.00e-02 1.11e-03  1.37e-01     4s
  22   9.17347809e+04  1.08740067e+05  2.14e-02 7.91e-04  1.02e-01     4s
  23   9.37268667e+04  1.06409299e+05  1.47e-02 6.25e-04  7.63e-02     4s
  24   9.47506640e+04  1.04912608e+05  1.15e-02 4.97e-04  6.11e-02     4s
  25   9.52553671e+04  1.03541858e+05  9.97e-03 3.68e-04  4.99e-02     4s
  26   9.57530049e+04  1.02492311e+05  8.49e-03 2.97e-04  4.06e-02     4s
  27   9.61542417e+04  1.01624867e+05  7.30e-03 2.44e-04  3.29e-02     4s
  28   9.63751483e+04  1.01339058e+05  6.69e-03 2.17e-04  2.99e-02     4s
  29   9.72797947e+04  1.00820334e+05  4.10e-03 1.70e-04  2.13e-02     4s
  30   9.75668783e+04  1.00317931e+05  3.29e-03 1.23e-04  1.66e-02     4s
  31   9.78852496e+04  1.00083361e+05  2.44e-03 1.00e-04  1.32e-02     4s
  32   9.81035785e+04  9.97788349e+04  1.85e-03 8.56e-05  1.01e-02     4s
  33   9.83326026e+04  9.95772455e+04  1.25e-03 6.64e-05  7.49e-03     4s
  34   9.85329526e+04  9.93429659e+04  7.32e-04 4.57e-05  4.87e-03     4s
  35   9.86467596e+04  9.92889051e+04  4.63e-04 4.08e-05  3.86e-03     4s
  36   9.87188968e+04  9.91034231e+04  2.92e-04 2.29e-05  2.31e-03     4s
  37   9.87632459e+04  9.89774249e+04  2.00e-04 1.05e-05  1.29e-03     5s
  38   9.87924499e+04  9.89529884e+04  1.39e-04 8.15e-06  9.66e-04     5s
  39   9.88101218e+04  9.89425263e+04  1.06e-04 7.10e-06  7.96e-04     5s
  40   9.88280042e+04  9.89195011e+04  7.09e-05 4.95e-06  5.50e-04     5s
  41   9.88313914e+04  9.88939741e+04  6.45e-05 2.53e-06  3.76e-04     5s
  42   9.88455573e+04  9.88817300e+04  3.79e-05 1.37e-06  2.18e-04     5s
  43   9.88536685e+04  9.88797477e+04  2.30e-05 1.17e-06  1.57e-04     5s
  44   9.88562002e+04  9.88730728e+04  1.84e-05 5.34e-07  1.02e-04     5s
  45   9.88619553e+04  9.88713490e+04  8.36e-06 3.70e-07  5.65e-05     5s
  46   9.88668535e+04  9.88677851e+04  4.24e-07 3.62e-08  5.60e-06     5s
  47   9.88672625e+04  9.88672698e+04  1.41e-08 1.67e-10  4.41e-08     5s
  48   9.88672667e+04  9.88672667e+04  2.87e-09 4.85e-11  8.08e-11     5s

Barrier solved model in 48 iterations and 5.23 seconds (7.89 work units)
Optimal objective 9.88672667e+04


Root crossover log...

   78590 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1731 PPushes remaining with PInf 8.8575864e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2684622e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30532    9.8867267e+04   0.000000e+00   0.000000e+00      6s
   30532    9.8867267e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.886727e+04, 30532 iterations, 4.71 seconds (7.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 98867.2667    0  266 -223925.25 98867.2667   144%     -    6s
H    0     0                    -222676.3086 98867.2667   144%     -    6s
H    0     0                    -120897.0602 98867.2667   182%     -    7s
H    0     0                    -120881.4585 98867.2667   182%     -    7s
H    0     0                    -59419.24201 98867.2667   266%     -    7s
H    0     0                    -57612.80211 98867.2667   272%     -    7s
H    0     0                    -57517.52196 98867.2667   272%     -    7s
H    0     0                    17433.351478 98867.2667   467%     -    7s
H    0     0                    25525.069816 98867.2667   287%     -    7s
H    0     0                    36147.463326 98867.2667   174%     -    7s
H    0     0                    37181.902663 98867.2667   166%     -    8s
H    0     0                    37965.584648 98867.2667   160%     -    8s
H    0     0                    37974.410612 98867.2667   160%     -    8s
H    0     0                    38806.812555 90589.3029   133%     -   41s
H    0     0                    39138.778757 90589.3029   131%     -   41s
     0     0 90589.3029    0  351 39138.7788 90589.3029   131%     -   41s
H    0     0                    40379.612845 90589.2879   124%     -   42s
H    0     0                    40502.706818 90589.2879   124%     -   42s
H    0     0                    41959.339557 90589.2879   116%     -   42s
H    0     0                    46474.451636 90589.2879  94.9%     -   42s
H    0     0                    49739.659116 90589.2879  82.1%     -   42s
     0     0 90222.6781    0  329 49739.6591 90222.6781  81.4%     -   57s
     0     0 90118.7695    0  327 49739.6591 90118.7695  81.2%     -   63s
     0     0 90118.7695    0  333 49739.6591 90118.7695  81.2%     -   66s
     0     0 90063.4657    0  332 49739.6591 90063.4657  81.1%     -   71s
     0     0 90060.5803    0  339 49739.6591 90060.5803  81.1%     -   72s
     0     0 90059.4530    0  339 49739.6591 90059.4530  81.1%     -   72s
     0     0 90059.4530    0  339 49739.6591 90059.4530  81.1%     -   72s
     0     0 85432.6684    0  375 49739.6591 85432.6684  71.8%     -  121s
H    0     0                    50016.633445 85432.6641  70.8%     -  122s
     0     0 84713.2565    0  406 50016.6334 84713.2565  69.4%     -  144s
     0     0 84472.6727    0  409 50016.6334 84472.6727  68.9%     -  155s
     0     0 84347.7768    0  397 50016.6334 84347.7768  68.6%     -  166s
     0     0 84145.7727    0  404 50016.6334 84145.7727  68.2%     -  179s
     0     0 84096.6624    0  430 50016.6334 84096.6624  68.1%     -  186s
     0     0 84021.4636    0  432 50016.6334 84021.4636  68.0%     -  192s
     0     0 83984.1018    0  426 50016.6334 83984.1018  67.9%     -  197s
     0     0 83950.5744    0  422 50016.6334 83950.5744  67.8%     -  200s
     0     0 83942.1712    0  425 50016.6334 83942.1712  67.8%     -  202s
     0     0 83923.6846    0  429 50016.6334 83923.6846  67.8%     -  206s
     0     0 83920.8292    0  427 50016.6334 83920.8292  67.8%     -  208s
     0     0 83919.8121    0  427 50016.6334 83919.8121  67.8%     -  208s
     0     0 81278.9499    0  376 50016.6334 81278.9499  62.5%     -  262s
H    0     0                    50302.768556 81278.8979  61.6%     -  263s
H    0     0                    50505.873976 81278.8979  60.9%     -  263s
H    0     0                    50532.282097 81278.8979  60.8%     -  263s
H    0     0                    50653.018932 81278.8979  60.5%     -  263s
H    0     0                    50708.758492 81278.8979  60.3%     -  263s
     0     0 80528.9781    0  383 50708.7585 80528.9781  58.8%     -  286s
     0     0 80339.4104    0  393 50708.7585 80339.4104  58.4%     -  299s
H    0     0                    50752.161399 80205.3631  58.0%     -  309s
     0     0 80205.3631    0  411 50752.1614 80205.3631  58.0%     -  309s
H    0     0                    51156.063655 80131.5498  56.6%     -  319s
H    0     0                    51233.758428 80131.5498  56.4%     -  319s
     0     0 80131.5498    0  418 51233.7584 80131.5498  56.4%     -  319s
H    0     0                    51300.571485 80065.6504  56.1%     -  324s
H    0     0                    51423.209433 80065.6504  55.7%     -  324s
H    0     0                    51589.342266 80065.6504  55.2%     -  324s
     0     0 80065.6504    0  412 51589.3423 80065.6504  55.2%     -  324s
     0     0 80050.6155    0  399 51589.3423 80050.6155  55.2%     -  327s
     0     0 80043.5590    0  418 51589.3423 80043.5590  55.2%     -  329s
H    0     0                    51685.994447 80037.8369  54.9%     -  332s
     0     0 80037.8369    0  419 51685.9944 80037.8369  54.9%     -  332s
     0     0 80029.2711    0  407 51685.9944 80029.2711  54.8%     -  334s
     0     0 80028.5191    0  416 51685.9944 80028.5191  54.8%     -  335s
     0     0 78771.7980    0  377 51685.9944 78771.7980  52.4%     -  377s
     0     0 78576.1627    0  386 51685.9944 78576.1627  52.0%     -  391s
     0     0 78500.4619    0  381 51685.9944 78500.4619  51.9%     -  398s
     0     0 78434.3240    0  399 51685.9944 78434.3240  51.8%     -  407s
     0     0 78376.2585    0  389 51685.9944 78376.2585  51.6%     -  416s
     0     0 78354.2611    0  392 51685.9944 78354.2611  51.6%     -  420s
     0     0 78345.2265    0  390 51685.9944 78345.2265  51.6%     -  424s
     0     0 78333.2742    0  386 51685.9944 78333.2742  51.6%     -  427s
     0     0 78328.2703    0  387 51685.9944 78328.2703  51.5%     -  428s
H    0     0                    51823.084018 78313.3507  51.1%     -  430s
H    0     0                    51856.099286 78313.3507  51.0%     -  430s
     0     0 78313.3507    0  385 51856.0993 78313.3507  51.0%     -  430s
     0     0 78310.2577    0  387 51856.0993 78310.2577  51.0%     -  431s
     0     0 77999.7256    0  402 51856.0993 77999.7256  50.4%     -  444s
H    0     0                    51864.874056 77999.7203  50.4%     -  445s
H    0     0                    51945.095748 77999.7203  50.2%     -  445s
H    0     0                    52073.341557 77999.7203  49.8%     -  445s
     0     0 77856.2901    0  418 52073.3416 77856.2901  49.5%     -  456s
     0     0 77830.1772    0  423 52073.3416 77830.1772  49.5%     -  460s
     0     0 77822.3763    0  430 52073.3416 77822.3763  49.4%     -  462s
     0     0 77818.3315    0  431 52073.3416 77818.3315  49.4%     -  464s
     0     0 77810.1594    0  429 52073.3416 77810.1594  49.4%     -  467s
     0     0 77808.3077    0  431 52073.3416 77808.3077  49.4%     -  468s
     0     0 77641.6120    0  417 52073.3416 77641.6120  49.1%     -  481s
     0     0 77598.2708    0  408 52073.3416 77598.2708  49.0%     -  489s
     0     0 77584.8239    0  447 52073.3416 77584.8239  49.0%     -  494s
     0     0 77575.5150    0  446 52073.3416 77575.5150  49.0%     -  497s
     0     0 77563.6198    0  456 52073.3416 77563.6198  49.0%     -  501s
     0     0 77557.7893    0  420 52073.3416 77557.7893  48.9%     -  502s
     0     0 77555.1388    0  409 52073.3416 77555.1388  48.9%     -  504s
     0     0 77486.2643    0  409 52073.3416 77486.2643  48.8%     -  513s
H    0     0                    52075.141829 77485.9914  48.8%     -  514s
     0     0 77462.6790    0  453 52075.1418 77462.6790  48.8%     -  518s
     0     0 77450.9524    0  413 52075.1418 77450.9524  48.7%     -  522s
     0     0 77446.1731    0  419 52075.1418 77446.1731  48.7%     -  524s
     0     0 77442.1531    0  418 52075.1418 77442.1531  48.7%     -  525s
     0     0 77441.8892    0  420 52075.1418 77441.8892  48.7%     -  526s
     0     0 77431.7834    0  368 52075.1418 77431.7834  48.7%     -  529s
     0     0 77427.9901    0  364 52075.1418 77427.9901  48.7%     -  531s
     0     0 77393.4580    0  413 52075.1418 77393.4580  48.6%     -  535s
     0     0 77388.3869    0  362 52075.1418 77388.3869  48.6%     -  536s
     0     0 77387.5404    0  412 52075.1418 77387.5404  48.6%     -  537s
     0     0 77380.5941    0  371 52075.1418 77380.5941  48.6%     -  540s
     0     0 77380.5802    0  371 52075.1418 77380.5802  48.6%     -  542s
H    0     0                    52402.153963 77380.5802  47.7%     -  627s
H    0     2                    52874.848346 77380.5802  46.3%     -  647s
     0     2 77380.5802    0  371 52874.8483 77380.5802  46.3%     -  647s
     1     4 77257.8085    1  408 52874.8483 77380.5631  46.3%  6437  662s
     3     8 77158.7717    2  408 52874.8483 77248.9556  46.1%  8312  676s
     7    16 77059.1555    3  413 52874.8483 77158.7186  45.9% 10726  703s
    15    32 76793.0930    4  452 52874.8483 77057.9933  45.7% 14597  739s
    31    48 76125.6588    5  457 52874.8483 76792.9863  45.2% 20605  830s
H   47    80                    52946.096219 76792.9863  45.0% 17954  860s
H   50    80                    53207.593569 76792.9863  44.3% 17635  860s
    79   144 75788.4905    7  435 53207.5936 76792.9863  44.3% 14057  966s
   143   293 75737.4357    9  417 53207.5936 76792.9863  44.3%  9053 1002s
H  158   293                    53274.326804 76792.9863  44.1%  8510 1002s
H  181   293                    53366.353919 76792.9863  43.9%  7863 1002s
   292   374 75485.3754   12  403 53366.3539 76792.9863  43.9%  6493 1024s
   373   439 75398.3884   13  336 53366.3539 76792.9863  43.9%  5974 1044s
H  387   439                    54008.755396 76792.9863  42.2%  5873 1044s
H  425   439                    54867.824538 76792.9863  40.0%  5730 1044s
   438   506 74419.7923   17  335 54867.8245 76792.9863  40.0%  5664 1065s
   505   580 75455.1011   13  397 54867.8245 76792.9863  40.0%  5418 1084s
H  507   580                    55075.915974 76792.9863  39.4%  5410 1084s
H  526   580                    55115.935255 76792.9863  39.3%  5312 1084s
   579   650 75351.9909   12  362 55115.9353 76792.9863  39.3%  5129 1103s
   649   704 74910.3769   14  338 55115.9353 76792.9863  39.3%  4991 1120s
H  665   704                    55166.680790 76792.9863  39.2%  4963 1120s
H  674   704                    55193.576832 76792.9863  39.1%  4932 1120s
H  681   704                    55247.482695 76792.9863  39.0%  4962 1120s
H  700   704                    55321.171907 76792.9863  38.8%  4959 1120s
   703   775 75120.9019   14  332 55321.1719 76792.9863  38.8%  4972 1137s
   774   845 75073.9234   14  403 55321.1719 76792.9863  38.8%  4844 1155s
H  777   845                    55416.727737 76792.9863  38.6%  4838 1155s
   844   908 72772.0408   24  318 55416.7277 76792.9863  38.6%  4722 1173s
   907   940 74902.3185   15  393 55416.7277 76792.9863  38.6%  4648 1186s
H  910   940                    55928.568622 76792.9863  37.3%  4644 1186s
   939  1004 74876.6040   15  365 55928.5686 76792.9863  37.3%  4659 1205s
  1003  1034 74627.9232   15  323 55928.5686 76792.9863  37.3%  4625 1222s
  1033  1081 74114.2057   15  311 55928.5686 76792.9863  37.3%  4607 1240s
  1080  1114 74358.8041   15  325 55928.5686 76792.9863  37.3%  4541 1253s
H 1108  1114                    55998.616915 76792.9863  37.1%  4523 1253s
  1113  1238 74595.1392   16  357 55998.6169 76792.9863  37.1%  4527 1275s
  1237  1352 74594.3463   16  353 55998.6169 76792.9863  37.1%  4330 1298s
  1351  1495 73148.3591   16  350 55998.6169 76792.9863  37.1%  4191 1322s
  1496  1655 74475.4778   17  304 55998.6169 76792.9863  37.1%  4015 1344s
  1661  1774 74032.3662   18  301 55998.6169 76792.9863  37.1%  3842 1367s
  1819  1793 73944.4494   19  346 55998.6169 76792.9863  37.1%  3739 1400s
  1854  1807 73289.3283   18  290 55998.6169 76792.9863  37.1%  3739 1450s
H 1855  1807                    56049.395256 76792.9863  37.0%  3737 1450s
  1893  1888 73152.4037   19  292 56049.3953 76792.9863  37.0%  3772 1477s
  2054  1923 73313.2599   19  338 56049.3953 76792.9863  37.0%  3700 1502s
H 2057  1923                    56058.080457 76792.9863  37.0%  3699 1502s
H 2068  1923                    56069.943277 76792.9863  37.0%  3685 1502s
  2111  1983 73858.8108   19  337 56069.9433 76792.9863  37.0%  3719 1531s
  2283  2032 68665.0643   19  352 56069.9433 76792.9863  37.0%  3649 1561s
  2418  2094 73364.5619   20  295 56069.9433 76792.9863  37.0%  3659 1595s
  2523  2157 70475.7124   20  339 56069.9433 76730.0315  36.8%  3710 1629s
  2614  2236 72780.2283   20  343 56069.9433 76730.0315  36.8%  3786 1664s
  2747  2267 69553.7188    9  285 56069.9433 76730.0315  36.8%  3787 1691s
  2792  2296 71903.5620   20  279 56069.9433 76730.0315  36.8%  3820 1725s
  2861  2328 71878.8097   21  346 56069.9433 76730.0315  36.8%  3852 1753s
H 2872  2328                    56104.005372 76730.0315  36.8%  3866 1753s
H 2885  2328                    56168.057609 76730.0315  36.6%  3893 1753s
  2893  2381 71193.0740   22  368 56168.0576 76730.0315  36.6%  3914 1814s
  2978  2512 67533.3093   23  333 56168.0576 76730.0315  36.6%  3965 1857s
  3119  2652 66585.0503   24  277 56168.0576 76730.0315  36.6%  3978 1906s
  3281  2732 64968.2344   25  252 56168.0576 76730.0315  36.6%  3968 1971s
  3413  2840 64753.4182   26  260 56168.0576 76730.0315  36.6%  4004 2026s
  3564  2841 57716.0092   85  371 56168.0576 76013.8655  35.3%  4024 2232s
  3566  2842 73424.8797   15  154 56168.0576 76013.8655  35.3%  4021 2244s
  3567  2843 72999.4102   24  355 56168.0576 76013.8655  35.3%  4020 2304s
  3568  2844 57222.7739   92  369 56168.0576 76013.8655  35.3%  4019 2377s
  3569  2844 71449.1324   34  375 56168.0576 76013.8655  35.3%  4018 2447s
  3570  2845 65500.6142   33  420 56168.0576 76013.8655  35.3%  4017 2482s
  3571  2846 67189.6324   16  455 56168.0576 76013.8655  35.3%  4016 2501s
  3572  2846 69167.6717   22  392 56168.0576 76013.8655  35.3%  4015 2517s
  3573  2847 71076.3217   24  443 56168.0576 76013.8655  35.3%  4014 2537s
  3574  2848 72808.1818   15  408 56168.0576 76013.8655  35.3%  4012 2550s
  3575  2848 72968.4658   17  419 56168.0576 76013.8655  35.3%  4011 2563s
  3576  2849 68235.8178   60  410 56168.0576 76013.8655  35.3%  4010 2572s
  3577  2850 72947.5133   21  419 56168.0576 76013.8655  35.3%  4009 2575s
  3579  2851 73057.0505   11  360 56168.0576 76013.8655  35.3%  4007 2580s
H 3579  2708                    56174.565446 76013.8655  35.3%  4007 2589s
  3581  2709 70297.1150   37  410 56174.5654 76013.8655  35.3%  4005 2597s
  3582  2710 66407.2124   52  429 56174.5654 76013.8655  35.3%  4003 2601s
  3584  2711 67907.1510   20  453 56174.5654 76013.8655  35.3%  4001 2614s
  3585  2712 65963.0786   57  371 56174.5654 76013.8655  35.3%  4000 2618s
  3586  2713 63452.8604   28  372 56174.5654 76013.8655  35.3%  3999 2623s
  3587  2713 75803.8658    5  358 56174.5654 76013.8655  35.3%  3998 2625s
  3589  2715 67276.9167   45  386 56174.5654 76013.8655  35.3%  3996 2637s
  3590  2715 59526.3277   59  398 56174.5654 76013.8655  35.3%  3994 2643s
  3591  2716 69809.2157   37  402 56174.5654 76013.8655  35.3%  3993 2649s
  3592  2717 65635.0043   31  367 56174.5654 76013.8655  35.3%  3992 2651s
  3593  2717 69122.0561   14  397 56174.5654 76013.8655  35.3%  3991 2656s
  3595  2719 69969.5499   43  365 56174.5654 76013.8655  35.3%  3989 2663s
  3597  2720 57496.0908   92  489 56174.5654 76013.8655  35.3%  3987 2674s
  3598  2721 74440.1915   17  463 56174.5654 76013.8655  35.3%  3986 2678s
  3599  2721 67531.9979   24  458 56174.5654 76013.8655  35.3%  3985 2687s
  3600  2722 67909.7484   25  458 56174.5654 76013.8655  35.3%  3983 2733s
  3601  2723 72143.6043   25  458 56174.5654 76013.8655  35.3%  3982 2810s
  3602  2725 76013.8655   15  442 56174.5654 76013.8655  35.3%  4090 2846s
  3603  2728 75651.9062   16  384 56174.5654 76013.8655  35.3%  4094 2891s
  3606  2733 74591.9310   17  383 56174.5654 76013.8655  35.3%  4103 2955s
  3612  2743 74417.1025   18  373 56174.5654 76013.8655  35.3%  4127 3023s
  3624  2750 74293.7618   18  378 56174.5654 76013.8655  35.3%  4200 3600s

Cutting planes:
  Learned: 2
  Gomory: 34
  Implied bound: 94
  Projected implied bound: 185
  MIR: 1204
  Mixing: 8
  Flow cover: 1285
  RLT: 61
  Relax-and-lift: 446

Explored 3635 nodes (16096242 simplex iterations) in 3600.06 seconds (7846.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 56174.6 56168.1 56104 ... 55321.2

Time limit reached
Best objective 5.617456544554e+04, best bound 7.601386547381e+04, gap 35.3172%
  WARNING: Time limit reached. Using best solution found (gap: 35.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 56174.57, θ = 224421.32
  Upper Bound (UB) = 56174.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 224421.32
  [DEBUG]   ✓ Scenario 0: θ = 224421.32 ≤ Q = 224421.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 224421.32 ≤ Q = 224421.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 224421.32 ≤ Q = 224421.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 224421.32 ≤ Q = 224421.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 224421.32 ≤ Q = 224421.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 224421.32 ≤ Q = 224421.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 224421.32 ≤ Q = 224421.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 224421.32 ≤ Q = 224421.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 224421.32 ≤ Q = 224421.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 224421.32 ≤ Q = 224421.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xcb1e356
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf34e1caa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.388679e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.00s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 6934115.4472
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.882744e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -188274.36    0  125 6934115.45 -188274.36   103%     -    0s
H    0     0                    -152528.0514 -188274.36  23.4%     -    0s
H    0     0                    -152849.5607 -188274.36  23.2%     -    0s
H    0     0                    -153395.8871 -169674.36  10.6%     -    0s
     0     0 -169674.36    0  102 -153395.89 -169674.36  10.6%     -    0s
H    0     0                    -163782.5781 -169527.56  3.51%     -    0s
H    0     0                    -166133.9797 -169527.56  2.04%     -    0s
     0     0 -168004.05    0  111 -166133.98 -168004.05  1.13%     -    0s
H    0     0                    -166317.0473 -167994.53  1.01%     -    0s
     0     0 -167994.53    0  111 -166317.05 -167994.53  1.01%     -    0s
     0     0 -167750.71    0   72 -166317.05 -167750.71  0.86%     -    0s
     0     0 -167680.88    0   83 -166317.05 -167680.88  0.82%     -    0s
     0     0 -167679.15    0   83 -166317.05 -167679.15  0.82%     -    0s
     0     0 -167523.78    0   54 -166317.05 -167523.78  0.73%     -    0s
     0     0 -167520.06    0   81 -166317.05 -167520.06  0.72%     -    0s
     0     0 -167332.04    0   72 -166317.05 -167332.04  0.61%     -    0s
     0     0 -167330.60    0   72 -166317.05 -167330.60  0.61%     -    0s
     0     2 -167330.35    0   72 -166317.05 -167330.35  0.61%     -    0s
H   31    39                    -166474.3713 -167189.70  0.43%  13.6    0s
H   47    31                    -166937.4778 -167189.70  0.15%  11.7    0s
*  154    66              15    -167096.9300 -167141.11  0.03%   7.4    0s
*  163    66              15    -167107.3656 -167112.17  0.00%   7.1    0s

Cutting planes:
  Gomory: 48
  Implied bound: 1
  MIR: 176
  Flow cover: 14
  RLT: 29
  Relax-and-lift: 5

Explored 261 nodes (2191 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -167107 -167097 -166937 ... -152528
No other solutions better than -167107

Optimal solution found (tolerance 1.00e-06)
Best objective -1.671073656364e+05, best bound -1.671073656364e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 213116.27
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -167107.37
  [DEBUG]   S×d_nominal = 380223.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380223.64 + -167107.37 = 213116.27
  [DEBUG]   Current θ from Master = 224421.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11305.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44869.52
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 2847.6182, Absolute Gap = 2847.6182, Relative Gap = 0.050692
  Not converged yet (gap = 2847.62 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0xeb4cb010
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 1.48s
Presolved: 99580 rows, 42487 columns, 602006 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -298918.8765
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.526e+06
 Factor NZ  : 9.980e+06 (roughly 140 MB of memory)
 Factor Ops : 1.829e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68340673e+07  2.02785972e+08  1.44e+05 1.77e+01  8.80e+04     3s
   1  -1.27361398e+07  1.87821257e+08  1.01e+05 1.07e+02  6.10e+04     3s
   2  -7.10656422e+06  1.54149644e+08  5.50e+04 4.09e+01  3.43e+04     3s
   3  -1.31836823e+06  1.16204057e+08  5.17e+03 2.57e+00  3.74e+03     3s
   4  -7.12329666e+05  5.67780834e+07  6.82e+02 2.80e-01  6.84e+02     3s
   5  -5.88193841e+05  3.68817443e+07  2.99e+02 1.59e-01  3.53e+02     3s
   6  -2.91739676e+05  2.61329548e+07  9.94e+01 1.06e-01  1.89e+02     3s
   7  -2.38427719e+05  1.75692736e+07  5.11e+01 6.71e-02  1.17e+02     3s
   8  -1.18426214e+05  1.29120153e+07  6.88e+00 4.68e-02  7.35e+01     3s
   9  -7.71358531e+04  6.16941145e+06  3.94e+00 2.16e-02  3.49e+01     3s
  10  -4.59094804e+04  2.03896799e+06  2.35e+00 6.80e-03  1.16e+01     3s
  11   1.58669344e+04  5.39280944e+05  6.72e-01 1.62e-03  2.88e+00     3s
  12   3.09065757e+04  4.21231315e+05  4.70e-01 1.06e-03  2.15e+00     3s
  13   3.74453708e+04  2.82760197e+05  3.73e-01 7.99e-04  1.35e+00     3s
  14   4.70749744e+04  2.06163767e+05  2.80e-01 7.72e-04  8.74e-01     4s
  15   5.55286512e+04  1.73432450e+05  2.24e-01 1.79e-03  6.48e-01     4s
  16   6.49174286e+04  1.54459279e+05  1.68e-01 2.15e-03  4.92e-01     4s
  17   7.52826361e+04  1.35670944e+05  1.12e-01 1.38e-03  3.32e-01     4s
  18   7.90852495e+04  1.26957742e+05  9.21e-02 1.28e-03  2.63e-01     4s
  19   8.36392260e+04  1.19211280e+05  6.95e-02 1.24e-03  1.95e-01     4s
  20   8.70636170e+04  1.14504686e+05  5.25e-02 9.65e-04  1.51e-01     4s
  21   8.86650797e+04  1.10679998e+05  4.46e-02 1.61e-03  1.21e-01     4s
  22   9.10435596e+04  1.08507746e+05  3.36e-02 8.79e-04  9.59e-02     4s
  23   9.35650742e+04  1.05557302e+05  2.29e-02 1.07e-03  6.58e-02     4s
  24   9.51125458e+04  1.03483774e+05  1.63e-02 7.77e-04  4.60e-02     4s
  25   9.61364147e+04  1.02510392e+05  1.21e-02 5.66e-04  3.50e-02     4s
  26   9.63074594e+04  1.02250213e+05  1.14e-02 5.21e-04  3.26e-02     4s
  27   9.72025369e+04  1.01832556e+05  7.71e-03 4.41e-04  2.54e-02     4s
  28   9.74928114e+04  1.01391960e+05  6.57e-03 3.64e-04  2.14e-02     4s
  29   9.77759291e+04  1.00815570e+05  5.47e-03 2.68e-04  1.67e-02     4s
  30   9.83205434e+04  1.00412243e+05  3.41e-03 1.95e-04  1.15e-02     4s
  31   9.84750374e+04  1.00109580e+05  2.85e-03 1.40e-04  8.97e-03     5s
  32   9.87891767e+04  9.98721978e+04  1.78e-03 9.65e-05  5.94e-03     5s
  33   9.88843591e+04  9.98305469e+04  1.45e-03 8.92e-05  5.19e-03     5s
  34   9.90008148e+04  9.96124606e+04  1.04e-03 5.07e-05  3.36e-03     5s
  35   9.90405058e+04  9.95528311e+04  9.16e-04 4.00e-05  2.81e-03     5s
  36   9.90482383e+04  9.95033921e+04  8.91e-04 3.11e-05  2.50e-03     5s
  37   9.91356845e+04  9.94612330e+04  6.06e-04 2.34e-05  1.79e-03     5s
  38   9.91950612e+04  9.94370566e+04  4.15e-04 1.88e-05  1.33e-03     5s
  39   9.92425436e+04  9.93956973e+04  2.64e-04 1.12e-05  8.41e-04     5s
  40   9.92702457e+04  9.93786601e+04  1.78e-04 8.09e-06  5.95e-04     5s
  41   9.92923835e+04  9.93671687e+04  1.14e-04 5.92e-06  4.10e-04     5s
  42   9.93018748e+04  9.93619611e+04  8.60e-05 5.01e-06  3.30e-04     5s
  43   9.93066405e+04  9.93544349e+04  7.17e-05 3.74e-06  2.62e-04     5s
  44   9.93078259e+04  9.93473338e+04  6.84e-05 2.55e-06  2.17e-04     6s
  45   9.93138206e+04  9.93463857e+04  5.08e-05 2.39e-06  1.79e-04     6s
  46   9.93177438e+04  9.93418087e+04  4.01e-05 1.58e-06  1.32e-04     6s
  47   9.93184515e+04  9.93405671e+04  3.82e-05 1.38e-06  1.21e-04     6s
  48   9.93196273e+04  9.93355730e+04  3.47e-05 5.11e-07  8.76e-05     6s
  49   9.93228017e+04  9.93343986e+04  2.55e-05 3.07e-07  6.37e-05     6s
  50   9.93279748e+04  9.93332029e+04  1.11e-05 1.34e-07  2.87e-05     6s
  51   9.93316956e+04  9.93327406e+04  1.22e-06 6.61e-08  5.73e-06     6s
  52   9.93322016e+04  9.93324246e+04  7.00e-08 4.06e-08  1.22e-06     6s
  53   9.93322377e+04  9.93322513e+04  1.60e-08 6.49e-11  7.46e-08     6s
  54   9.93322386e+04  9.93322513e+04  1.43e-05 8.87e-10  7.37e-08     6s
  55   9.93322395e+04  9.93322517e+04  1.18e-05 6.70e-09  6.93e-08     6s
  56   9.93322492e+04  9.93322502e+04  7.09e-07 8.69e-08  5.49e-09     6s

Barrier solved model in 56 iterations and 6.36 seconds (9.89 work units)
Optimal objective 9.93322492e+04


Root crossover log...

   83903 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   26909 PPushes remaining with PInf 7.8445556e-05                 9s
     678 PPushes remaining with PInf 1.7675124e-04                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.8721870e+04     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66559    9.9332250e+04   0.000000e+00   9.872187e+04     10s
   66790    9.9332250e+04   0.000000e+00   0.000000e+00     10s
   66790    9.9332250e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.53s

Solved with barrier

Root relaxation: objective 9.933225e+04, 66790 iterations, 8.99 seconds (17.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99332.2502    0  298 -223925.25 99332.2502   144%     -   11s
H    0     0                    -222301.0119 99332.2502   145%     -   11s
H    0     0                    -153475.4211 99332.2502   165%     -   12s
H    0     0                    -153158.7854 99332.2502   165%     -   12s
H    0     0                    -41779.60895 99332.2502   338%     -   12s
H    0     0                    14639.165220 99332.2502   579%     -   13s
H    0     0                    15911.761075 99332.2502   524%     -   13s
H    0     0                    15947.635243 99332.2502   523%     -   13s
H    0     0                    18553.048553 99332.2502   435%     -   13s
H    0     0                    18978.811962 99332.2502   423%     -   13s
H    0     0                    19311.861277 99332.2502   414%     -   13s
H    0     0                    19559.527975 99332.2502   408%     -   13s
H    0     0                    19595.826945 99332.2502   407%     -   13s
H    0     0                    19608.514547 99332.2502   407%     -   13s
H    0     0                    19663.655620 99330.5083   405%     -   15s
H    0     0                    19675.698980 99330.5083   405%     -   15s
H    0     0                    19752.256468 99330.5083   403%     -   15s
H    0     0                    20005.020667 91080.2176   355%     -   56s
H    0     0                    22554.228648 91080.2176   304%     -   56s
H    0     0                    23329.237129 91080.2176   290%     -   56s
H    0     0                    23818.485940 91080.2176   282%     -   56s
H    0     0                    23955.817327 91080.2176   280%     -   56s
H    0     0                    24138.995828 91080.2176   277%     -   56s
H    0     0                    25662.174986 91080.2176   255%     -   56s
     0     0 90827.6247    0  338 25662.1750 90827.6247   254%     -   57s
H    0     0                    25792.072957 90827.6247   252%     -   58s
H    0     0                    25825.144153 90827.6247   252%     -   58s
H    0     0                    25876.914925 90827.6247   251%     -   58s
H    0     0                    25993.170379 90827.6247   249%     -   58s
H    0     0                    26463.083225 90827.6247   243%     -   58s
H    0     0                    26465.141280 90827.6247   243%     -   58s
     0     0 90052.3076    0  364 26465.1413 90052.3076   240%     -   79s
     0     0 89919.8008    0  383 26465.1413 89919.8008   240%     -   89s
     0     0 89917.2890    0  366 26465.1413 89917.2890   240%     -   95s
     0     0 89917.2890    0  385 26465.1413 89917.2890   240%     -   97s
     0     0 89917.2890    0  389 26465.1413 89917.2890   240%     -  100s
     0     0 89916.5063    0  387 26465.1413 89916.5063   240%     -  101s
H    0     0                    26874.234432 85489.7067   218%     -  146s
     0     0 85489.7067    0  403 26874.2344 85489.7067   218%     -  146s
H    0     0                    35445.911866 85489.6820   141%     -  146s
H    0     0                    35743.349439 85489.6820   139%     -  147s
H    0     0                    37110.146166 85489.6820   130%     -  147s
     0     0 84925.6482    0  419 37110.1462 84925.6482   129%     -  171s
H    0     0                    43278.749827 84828.4736  96.0%     -  183s
H    0     0                    43920.210605 84828.4736  93.1%     -  183s
H    0     0                    44011.303534 84828.4736  92.7%     -  183s
H    0     0                    44065.670410 84828.4736  92.5%     -  183s
     0     0 84828.4736    0  408 44065.6704 84828.4736  92.5%     -  183s
     0     0 84713.0118    0  433 44065.6704 84713.0118  92.2%     -  196s
     0     0 84656.0386    0  422 44065.6704 84656.0386  92.1%     -  206s
     0     0 84628.9022    0  406 44065.6704 84628.9022  92.1%     -  212s
     0     0 84495.5609    0  425 44065.6704 84495.5609  91.7%     -  222s
     0     0 84473.8831    0  409 44065.6704 84473.8831  91.7%     -  226s
     0     0 84471.8385    0  434 44065.6704 84471.8385  91.7%     -  229s
H    0     0                    45712.706917 84471.8385  84.8%     -  245s
H    0     0                    45714.044548 84471.8385  84.8%     -  245s
H    0     0                    45760.031688 84471.8385  84.6%     -  245s
H    0     0                    45854.773060 84471.8385  84.2%     -  245s
H    0     0                    45919.038761 84471.8385  84.0%     -  245s
H    0     0                    45943.889470 84471.8385  83.9%     -  245s
H    0     0                    47888.328463 84471.8385  76.4%     -  245s
     0     0 81223.7622    0  370 47888.3285 81223.7622  69.6%     -  297s
H    0     0                    47947.140307 81223.6978  69.4%     -  297s
H    0     0                    48051.755734 81223.6978  69.0%     -  297s
H    0     0                    48091.936421 81223.6978  68.9%     -  298s
H    0     0                    48194.658095 80407.7728  66.8%     -  331s
H    0     0                    48223.799613 80407.7728  66.7%     -  331s
H    0     0                    48228.320452 80407.7728  66.7%     -  331s
H    0     0                    48235.941951 80407.7728  66.7%     -  331s
H    0     0                    48249.521810 80407.7728  66.6%     -  331s
     0     0 80407.7728    0  419 48249.5218 80407.7728  66.6%     -  331s
H    0     0                    48416.728512 80017.7768  65.3%     -  356s
H    0     0                    48476.895507 80017.7768  65.1%     -  356s
     0     0 80017.7768    0  478 48476.8955 80017.7768  65.1%     -  356s
H    0     0                    48495.743672 79908.2872  64.8%     -  370s
H    0     0                    48604.620345 79908.2872  64.4%     -  370s
     0     0 79908.2872    0  406 48604.6203 79908.2872  64.4%     -  370s
     0     0 79851.5534    0  438 48604.6203 79851.5534  64.3%     -  380s
     0     0 79789.9733    0  442 48604.6203 79789.9733  64.2%     -  392s
     0     0 79767.3457    0  452 48604.6203 79767.3457  64.1%     -  396s
     0     0 79757.9495    0  461 48604.6203 79757.9495  64.1%     -  399s
     0     0 79755.0427    0  448 48604.6203 79755.0427  64.1%     -  402s
H    0     0                    48736.077038 78667.8450  61.4%     -  444s
H    0     0                    48922.236782 78667.8450  60.8%     -  444s
     0     0 78667.8450    0  410 48922.2368 78667.8450  60.8%     -  444s
H    0     0                    49020.185629 78666.7498  60.5%     -  446s
H    0     0                    49057.003842 78666.7498  60.4%     -  446s
H    0     0                    49083.820785 78666.7498  60.3%     -  446s
H    0     0                    49112.010230 78464.1132  59.8%     -  461s
     0     0 78464.1132    0  430 49112.0102 78464.1132  59.8%     -  461s
     0     0 78376.5638    0  481 49112.0102 78376.5638  59.6%     -  472s
     0     0 78334.1128    0  447 49112.0102 78334.1128  59.5%     -  480s
     0     0 78303.1142    0  438 49112.0102 78303.1142  59.4%     -  488s
     0     0 78288.7342    0  479 49112.0102 78288.7342  59.4%     -  491s
     0     0 78284.0572    0  479 49112.0102 78284.0572  59.4%     -  493s
     0     0 78280.6045    0  428 49112.0102 78280.6045  59.4%     -  495s
H    0     0                    49128.931469 78048.1844  58.9%     -  513s
     0     0 78048.1844    0  436 49128.9315 78048.1844  58.9%     -  513s
H    0     0                    49253.546955 78048.1602  58.5%     -  514s
     0     0 77928.0327    0  448 49253.5470 77928.0327  58.2%     -  525s
     0     0 77893.5101    0  449 49253.5470 77893.5101  58.1%     -  531s
     0     0 77881.0116    0  444 49253.5470 77881.0116  58.1%     -  535s
     0     0 77864.6462    0  455 49253.5470 77864.6462  58.1%     -  540s
     0     0 77852.6933    0  465 49253.5470 77852.6933  58.1%     -  543s
     0     0 77850.3860    0  461 49253.5470 77850.3860  58.1%     -  544s
     0     0 77709.7166    0  459 49253.5470 77709.7166  57.8%     -  558s
     0     0 77672.7706    0  477 49253.5470 77672.7706  57.7%     -  567s
     0     0 77664.7465    0  451 49253.5470 77664.7465  57.7%     -  571s
     0     0 77658.7222    0  472 49253.5470 77658.7222  57.7%     -  574s
     0     0 77652.1425    0  481 49253.5470 77652.1425  57.7%     -  578s
     0     0 77649.3535    0  485 49253.5470 77649.3535  57.7%     -  580s
     0     0 77565.6344    0  413 49253.5470 77565.6344  57.5%     -  592s
H    0     0                    49617.300485 77565.1849  56.3%     -  593s
     0     0 77529.6054    0  422 49617.3005 77529.6054  56.3%     -  605s
     0     0 77512.2338    0  417 49617.3005 77512.2338  56.2%     -  612s
     0     0 77507.9263    0  412 49617.3005 77507.9263  56.2%     -  616s
     0     0 77506.8050    0  416 49617.3005 77506.8050  56.2%     -  618s
     0     0 77486.5329    0  459 49617.3005 77486.5329  56.2%     -  627s
H    0     0                    49661.415105 77486.4314  56.0%     -  630s
H    0     0                    49822.647039 77486.4314  55.5%     -  630s
     0     0 77441.7970    0  443 49822.6470 77441.7970  55.4%     -  635s
     0     0 77432.6930    0  484 49822.6470 77432.6930  55.4%     -  637s
     0     0 77429.6621    0  378 49822.6470 77429.6621  55.4%     -  640s
     0     0 77420.4915    0  461 49822.6470 77420.4915  55.4%     -  644s
H    0     0                    49870.060985 77420.4455  55.2%     -  645s
     0     0 77418.3752    0  460 49870.0610 77418.3752  55.2%     -  646s
     0     0 77390.5517    0  409 49870.0610 77390.5517  55.2%     -  652s
H    0     0                    49913.983583 77390.4717  55.0%     -  654s
H    0     0                    50197.543964 77390.4717  54.2%     -  654s
H    0     0                    50224.380149 77390.4717  54.1%     -  655s
     0     0 77382.6413    0  418 50224.3801 77382.6413  54.1%     -  658s
     0     0 77381.2167    0  448 50224.3801 77381.2167  54.1%     -  659s
     0     0 77371.1808    0  402 50224.3801 77371.1808  54.1%     -  662s
     0     0 77367.0052    0  405 50224.3801 77367.0052  54.0%     -  664s
     0     0 77366.4383    0  403 50224.3801 77366.4383  54.0%     -  664s
     0     0 77365.6658    0  402 50224.3801 77365.6658  54.0%     -  667s
     0     0 77365.5075    0  402 50224.3801 77365.5075  54.0%     -  669s
H    0     0                    50622.937773 77365.3100  52.8%     -  792s
H    0     0                    51196.648412 77365.3100  51.1%     -  792s
H    0     0                    52050.858760 77365.3100  48.6%     -  793s
H    0     0                    52061.965761 77365.3100  48.6%     -  798s
H    0     0                    52316.259464 77365.3100  47.9%     -  798s
H    0     0                    52360.881623 77365.3100  47.8%     -  798s
     0     2 77365.3100    0  402 52360.8816 77365.3100  47.8%     -  809s
     1     4 77268.1558    1  407 52360.8816 77365.3100  47.8%  7617  815s
     3     7 77186.7007    2  383 52360.8816 77299.5642  47.6%  7680  841s
     6    14 77050.4734    3  461 52360.8816 77299.4445  47.6% 11366  864s
    13    28 76612.7645    4  398 52360.8816 77050.3694  47.2% 13924  897s
    27    42 75564.9562    5  386 52360.8816 76612.5022  46.3% 21655  967s
H   41    74                    53355.714543 76612.5022  43.6% 20012 1042s
H   44    74                    53619.192042 76612.5022  42.9% 20001 1042s
H   45    74                    54293.418725 76612.5022  41.1% 19717 1042s
H   60    74                    54535.974747 76612.5022  40.5% 16522 1042s
    73   168 74605.3018    7  325 54535.9747 76386.4915  40.1% 17605 1104s
H  167   266                    54585.308883 76386.4915  39.9% 11872 1140s
   265   332 73894.6226   13  316 54585.3089 76386.4915  39.9%  9380 1167s
   331   387 73676.3374   15  303 54585.3089 76386.4915  39.9%  8746 1191s
   386   455 73562.2109   16  311 54585.3089 76386.4915  39.9%  8513 1217s
   454   519 73350.1712   20  303 54585.3089 76386.4915  39.9%  8056 1241s
   518   579 73091.6112   23  273 54585.3089 76386.4915  39.9%  7750 1261s
   578   611 72738.5227   26  278 54585.3089 76386.4915  39.9%  7652 1277s
   610   644 72737.7151   27  274 54585.3089 76386.4915  39.9%  7641 1294s
H  643   674                    54672.107713 76386.4915  39.7%  7644 1311s
   673   723 72385.1395   29  264 54672.1077 76386.4915  39.7%  7692 1335s
   722   746 72661.8533   26  363 54672.1077 76386.4915  39.7%  7568 1372s
   745   783 72134.3506   31  268 54672.1077 76386.4915  39.7%  7639 1420s
   782   822 71611.1431   33  245 54672.1077 76386.4915  39.7%  7588 1441s
   821   868 71413.6267   35  257 54672.1077 76386.4915  39.7%  7691 1467s
   867   912 70542.7307   40  274 54672.1077 76386.4915  39.7%  7512 1493s
   911   960 70448.5229   42  262 54672.1077 76386.4915  39.7%  7387 1519s
   959  1008 69505.5381   47  194 54672.1077 76386.4915  39.7%  7211 1550s
  1007  1056 69061.0563   53  182 54672.1077 76386.4915  39.7%  7049 1581s
H 1055  1086                    54921.325830 76386.4915  39.1%  6956 1605s
  1085  1194 65936.1567   58  122 54921.3258 76386.4915  39.1%  6913 1641s
  1193  1284 64052.5917   65  103 54921.3258 76386.4915  39.1%  6627 1676s
  1285  1407 61478.7152   73   74 54921.3258 76386.4915  39.1%  6473 1719s
  1420  1535     cutoff   82      54921.3258 76386.4915  39.1%  6167 1756s
  1566  1565 75369.4025    8  418 54921.3258 76386.4915  39.1%  5852 1788s
H 1567  1565                    55036.196572 76386.4915  38.8%  5848 1788s
H 1581  1565                    55255.628496 76386.4915  38.2%  5840 1788s
H 1590  1565                    55255.628541 76386.4915  38.2%  5839 1788s
  1598  1710 68642.2367   40  249 55255.6285 76386.4915  38.2%  5835 1822s
  1766  1831 64719.9327   49  143 55255.6285 76386.4915  38.2%  5492 1859s
  1951  1894 75345.0615    9  321 55255.6285 76386.4915  38.2%  5230 1898s
  2066  1969 75191.8657   10  321 55255.6285 76386.4915  38.2%  5208 1945s
  2171  2025 74143.7477   11  392 55255.6285 76386.4915  38.2%  5160 1994s
  2271  2083 73810.6343   12  370 55255.6285 76386.4915  38.2%  5157 2043s
  2353  2168 67658.2024   17  255 55255.6285 76386.4915  38.2%  5164 2089s
  2462  2272 59575.0672   48  201 55255.6285 76386.4915  38.2%  5145 2133s
  2585  2323     cutoff   51      55255.6285 76386.4915  38.2%  5148 2185s
  2720  2352 73421.9160   10  391 55255.6285 76386.4915  38.2%  5122 2224s
  2753  2399 71626.8475   11  354 55255.6285 76386.4915  38.2%  5195 2267s
  2820  2512 69129.6649   12  334 55255.6285 76386.4915  38.2%  5222 2313s
  2965  2534 73177.4633   11  406 55255.6285 76386.4915  38.2%  5184 2362s
H 2970  2534                    55281.258301 76386.4915  38.2%  5189 2362s
  3005  2628 67199.6447   13  272 55281.2583 76386.4915  38.2%  5201 2421s
  3127  2836 66899.4228   14  311 55281.2583 76386.4915  38.2%  5175 2477s
  3364  2837 57430.0762   71  402 55281.2583 76386.4915  38.2%  5082 2688s
  3366  2838 56571.8719   67  154 55281.2583 76386.4915  38.2%  5079 2700s
  3367  2839 58596.1048   75  363 55281.2583 76386.4915  38.2%  5078 2760s
  3368  2840 73279.0543   20  417 55281.2583 76386.4915  38.2%  5076 2823s
  3369  2840 70038.6589   34  408 55281.2583 76386.4915  38.2%  5075 2878s
  3370  2841 62846.5754   28  446 55281.2583 76386.4915  38.2%  5073 2912s
  3371  2842 57379.6739   55  405 55281.2583 76386.4915  38.2%  5072 2940s
  3372  2842 73803.3814   17  456 55281.2583 76386.4915  38.2%  5070 2961s
  3373  2843 73980.1897   18  425 55281.2583 76386.4915  38.2%  5069 2972s
  3374  2844 66313.2093   59  417 55281.2583 76386.4915  38.2%  5067 2980s
  3375  2844 73415.8524    8  403 55281.2583 76386.4915  38.2%  5066 2987s
  3376  2845 57682.9953   47  398 55281.2583 76386.4915  38.2%  5064 2991s
  3377  2846 69257.5775   47  403 55281.2583 76386.4915  38.2%  5063 2995s
  3378  2846 69632.9696   41  399 55281.2583 76386.4915  38.2%  5061 3000s
  3380  2848 62944.4441   48  349 55281.2583 76386.4915  38.2%  5058 3011s
  3381  2848 64628.2875   46  361 55281.2583 76386.4915  38.2%  5057 3016s
  3383  2850 62892.2801   72  405 55281.2583 76386.4915  38.2%  5054 3021s
  3385  2851 70298.8500   31  397 55281.2583 76386.4915  38.2%  5051 3033s
  3386  2852 60415.9948   52  367 55281.2583 76386.4915  38.2%  5049 3039s
  3387  2852 69072.3941   37  356 55281.2583 76386.4915  38.2%  5048 3041s
  3388  2853 73078.7649   23  356 55281.2583 76386.4915  38.2%  5046 3046s
  3389  2854 74856.1890   10  442 55281.2583 76386.4915  38.2%  5045 3056s
  3391  2855 62609.1068   70  412 55281.2583 76386.4915  38.2%  5042 3062s
  3392  2856 57372.6471   68  475 55281.2583 76386.4915  38.2%  5040 3073s
  3393  2856 63289.9637   26  416 55281.2583 76386.4915  38.2%  5039 3076s
H 3394  2713                    55303.660775 76386.4915  38.1%  5038 3087s
  3396  2714 75267.3508    6  362 55303.6608 76386.4915  38.1%  5035 3090s
  3398  2716 73612.2885   15  364 55303.6608 76386.4915  38.1%  5032 3097s
  3400  2717 65267.0994   79  364 55303.6608 76386.4915  38.1%  5029 3104s
  3401  2718 62350.8042   58  364 55303.6608 76386.4915  38.1%  5027 3106s
  3402  2718 75240.4884    9  364 55303.6608 76386.4915  38.1%  5026 3111s
  3403  2719 58278.6403   78  364 55303.6608 76386.4915  38.1%  5024 3118s
  3404  2720 61093.8338   58  364 55303.6608 76386.4915  38.1%  5023 3133s
  3405  2720 73661.8469   12  364 55303.6608 76386.4915  38.1%  5021 3204s
H 3405  2585                    55420.158719 76386.4915  37.8%  5134 3254s
  3406  2587 76386.4915   14  397 55420.1587 76386.4915  37.8%  5136 3286s
  3408  2590 76386.4915   15  427 55420.1587 76386.4915  37.8%  5142 3335s
  3412  2597 76270.7990   16  392 55420.1587 76386.4915  37.8%  5159 3397s
  3420  2610 75761.3937   17  421 55420.1587 76270.6268  37.6%  5197 3453s
  3436  2619 74968.3619   18  474 55420.1587 75760.9418  36.7%  5327 3600s

Cutting planes:
  Learned: 1
  Gomory: 29
  Implied bound: 73
  Projected implied bound: 221
  MIR: 1418
  Mixing: 5
  Flow cover: 1779
  RLT: 66
  Relax-and-lift: 367

Explored 3450 nodes (19301208 simplex iterations) in 3600.11 seconds (8452.86 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 55420.2 55303.7 55281.3 ... 54536

Time limit reached
Best objective 5.542015871944e+04, best bound 7.576094180190e+04, gap 36.7029%
  WARNING: Time limit reached. Using best solution found (gap: 36.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 55420.16, θ = 227807.61
  Upper Bound (UB) = 55420.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227807.61
  [DEBUG]   ✓ Scenario 0: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227807.61 ≤ Q = 227807.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227807.61 ≤ Q = 227807.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227807.61 ≤ Q = 227820.93 (slack: 13.33)
  [DEBUG]   ✓ Scenario 9: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227807.61 ≤ Q = 227807.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4d8f0428
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb270fbd8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-15, 2e+02]
Found heuristic solution: objective 1.394922e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.00s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6985512.9871
Variable types: 365 continuous, 173 integer (173 binary)

Root relaxation: objective -1.865472e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -186547.17    0  126 6985512.99 -186547.17   103%     -    0s
H    0     0                    -149443.0010 -186547.17  24.8%     -    0s
H    0     0                    -149524.5466 -186547.17  24.8%     -    0s
H    0     0                    -149819.1274 -186286.42  24.3%     -    0s
H    0     0                    -149877.0039 -166657.72  11.2%     -    0s
     0     0 -166657.72    0   67 -149877.00 -166657.72  11.2%     -    0s
H    0     0                    -163710.3368 -166547.32  1.73%     -    0s
H    0     0                    -164037.4729 -166547.32  1.53%     -    0s
H    0     0                    -164658.9637 -166547.32  1.15%     -    0s
H    0     0                    -164986.0999 -166547.32  0.95%     -    0s
     0     0 -166538.08    0   58 -164986.10 -166538.08  0.94%     -    0s
     0     0 -166537.96    0   57 -164986.10 -166537.96  0.94%     -    0s
     0     0 -165515.66    0   57 -164986.10 -165515.66  0.32%     -    0s
     0     0 -165467.07    0   55 -164986.10 -165467.07  0.29%     -    0s
     0     0 -165456.63    0   53 -164986.10 -165456.63  0.29%     -    0s
H    0     0                    -165093.3827 -165456.63  0.22%     -    0s
H    0     0                    -165099.0178 -165456.63  0.22%     -    0s
     0     0 -165293.75    0   11 -165099.02 -165293.75  0.12%     -    0s
     0     0 -165292.84    0   10 -165099.02 -165292.84  0.12%     -    0s
H    0     0                    -165115.6526 -165281.73  0.10%     -    0s
     0     0 -165281.73    0   10 -165115.65 -165281.73  0.10%     -    0s
     0     0 -165237.65    0    8 -165115.65 -165237.65  0.07%     -    0s
     0     0 -165237.65    0   17 -165115.65 -165237.65  0.07%     -    0s
     0     0 -165169.07    0    4 -165115.65 -165169.07  0.03%     -    0s
H    0     0                    -165160.7378 -165163.16  0.00%     -    0s
     0     0     cutoff    0      -165160.74 -165160.74  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 2
  MIR: 12
  Flow cover: 5
  Relax-and-lift: 1

Explored 1 nodes (740 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -165161 -165116 -165099 ... -149443
No other solutions better than -165161

Optimal solution found (tolerance 1.00e-06)
Best objective -1.651607377923e+05, best bound -1.651607377923e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 214878.34
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -165160.74
  [DEBUG]   S×d_nominal = 380039.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380039.08 + -165160.74 = 214878.34
  [DEBUG]   Current θ from Master = 227807.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12929.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42490.90
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 2093.2115, Absolute Gap = 2093.2115, Relative Gap = 0.037770
  Not converged yet (gap = 2093.21 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0x069552dc
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 1.66s
Presolved: 108507 rows, 46144 columns, 653411 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -295311.5879
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 659
 AA' NZ     : 3.756e+06
 Factor NZ  : 9.083e+06 (roughly 140 MB of memory)
 Factor Ops : 1.738e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73720030e+07  2.18661443e+08  1.48e+05 1.70e+01  9.03e+04     3s
   1  -1.32426848e+07  2.03846907e+08  1.04e+05 1.06e+02  6.27e+04     3s
   2  -7.52445043e+06  1.66759721e+08  5.83e+04 4.14e+01  3.61e+04     3s
   3  -1.32548007e+06  1.26810274e+08  5.23e+03 1.67e+00  3.77e+03     3s
   4  -7.14135824e+05  6.19234040e+07  6.92e+02 2.38e-01  6.90e+02     3s
   5  -6.06500827e+05  4.08024279e+07  3.11e+02 1.40e-01  3.63e+02     3s
   6  -3.44830516e+05  2.97343509e+07  9.80e+01 9.84e-02  1.96e+02     3s
   7  -2.57081696e+05  2.05700889e+07  4.71e+01 6.43e-02  1.23e+02     3s
   8  -1.65524907e+05  1.45247497e+07  1.40e+01 4.36e-02  7.82e+01     3s
   9  -9.29112118e+04  7.16795266e+06  5.78e+00 2.02e-02  3.75e+01     3s
  10  -5.62821185e+04  2.33613173e+06  3.53e+00 6.13e-03  1.23e+01     4s
  11   1.00185172e+04  6.35178679e+05  1.39e+00 1.79e-03  3.18e+00     4s
  12   2.92935177e+04  3.86843234e+05  8.53e-01 1.07e-03  1.81e+00     4s
  13   3.71112455e+04  2.81412823e+05  6.63e-01 7.28e-04  1.24e+00     4s
  14   4.61804501e+04  2.07991344e+05  5.06e-01 1.27e-03  8.19e-01     4s
  15   5.41550866e+04  1.77547539e+05  4.09e-01 1.97e-03  6.24e-01     4s
  16   6.27808209e+04  1.48017133e+05  3.19e-01 2.28e-03  4.31e-01     4s
  17   7.23756672e+04  1.35644792e+05  2.27e-01 2.39e-03  3.20e-01     4s
  18   7.81832709e+04  1.24066692e+05  1.75e-01 1.67e-03  2.32e-01     4s
  19   8.25587048e+04  1.17814267e+05  1.36e-01 1.45e-03  1.78e-01     4s
  20   8.56078344e+04  1.10807908e+05  1.09e-01 1.23e-03  1.27e-01     4s
  21   8.74331204e+04  1.08689886e+05  9.32e-02 1.44e-03  1.08e-01     4s
  22   8.99488334e+04  1.06047102e+05  7.17e-02 1.70e-03  8.14e-02     4s
  23   9.16507955e+04  1.03792769e+05  5.78e-02 1.35e-03  6.14e-02     4s
  24   9.31984574e+04  1.02719942e+05  4.51e-02 1.61e-03  4.82e-02     4s
  25   9.44787463e+04  1.02205237e+05  3.48e-02 1.31e-03  3.91e-02     4s
  26   9.51908179e+04  1.01664345e+05  2.92e-02 9.88e-04  3.27e-02     4s
  27   9.58223237e+04  1.00803647e+05  2.41e-02 1.58e-03  2.52e-02     4s
  28   9.62833413e+04  1.00640209e+05  2.04e-02 1.44e-03  2.20e-02     4s
  29   9.69802200e+04  1.00329923e+05  1.49e-02 1.27e-03  1.69e-02     5s
  30   9.73049215e+04  9.99377370e+04  1.23e-02 9.34e-04  1.33e-02     5s
  31   9.76560411e+04  9.96195855e+04  9.63e-03 6.35e-04  9.94e-03     5s
  32   9.79339067e+04  9.93784836e+04  7.53e-03 3.98e-04  7.31e-03     5s
  33   9.81970927e+04  9.92519387e+04  5.60e-03 2.96e-04  5.34e-03     5s
  34   9.83977973e+04  9.91886719e+04  4.07e-03 2.34e-04  4.00e-03     5s
  35   9.84413761e+04  9.91062485e+04  3.76e-03 1.50e-04  3.37e-03     5s
  36   9.86048289e+04  9.90649415e+04  2.58e-03 1.03e-04  2.33e-03     5s
  37   9.87109708e+04  9.90359320e+04  1.79e-03 9.05e-05  1.65e-03     5s
  38   9.88042383e+04  9.90110581e+04  1.14e-03 6.62e-05  1.05e-03     5s
  39   9.88275756e+04  9.90017548e+04  9.70e-04 5.14e-05  8.82e-04     5s
  40   9.88539184e+04  9.89937997e+04  7.78e-04 3.91e-05  7.08e-04     5s
  41   9.88684695e+04  9.89883885e+04  6.72e-04 3.17e-05  6.07e-04     5s
  42   9.89158660e+04  9.89830441e+04  3.42e-04 2.39e-05  3.40e-04     5s
  43   9.89359971e+04  9.89748969e+04  1.93e-04 1.23e-05  1.97e-04     5s
  44   9.89421567e+04  9.89727495e+04  1.51e-04 9.46e-06  1.55e-04     6s
  45   9.89430556e+04  9.89711145e+04  1.44e-04 7.31e-06  1.42e-04     6s
  46   9.89468543e+04  9.89700428e+04  1.19e-04 5.65e-06  1.17e-04     6s
  47   9.89538074e+04  9.89684560e+04  7.19e-05 3.64e-06  7.41e-05     6s
  48   9.89577207e+04  9.89665394e+04  4.77e-05 1.26e-06  4.46e-05     6s
  49   9.89583415e+04  9.89661809e+04  4.38e-05 8.37e-07  3.97e-05     6s
  50   9.89600479e+04  9.89660229e+04  3.29e-05 6.53e-07  3.03e-05     6s
  51   9.89602243e+04  9.89659018e+04  3.18e-05 5.15e-07  2.87e-05     6s
  52   9.89611696e+04  9.89657938e+04  2.60e-05 3.94e-07  2.34e-05     6s
  53   9.89640104e+04  9.89656122e+04  8.43e-06 9.27e-07  8.11e-06     6s
  54   9.89652986e+04  9.89654910e+04  6.43e-07 1.86e-07  9.72e-07     6s
  55   9.89654171e+04  9.89654440e+04  1.11e-07 7.41e-09  1.36e-07     6s
  56   9.89654415e+04  9.89654419e+04  6.25e-08 2.44e-08  2.30e-09     6s

Barrier solved model in 56 iterations and 6.39 seconds (9.94 work units)
Optimal objective 9.89654415e+04


Root crossover log...

   89017 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                10s

   15265 PPushes remaining with PInf 3.2579735e-05                10s
    7313 PPushes remaining with PInf 2.0712845e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.8165519e+03     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54198    9.8965442e+04   0.000000e+00   6.816552e+03     11s
   54315    9.8965442e+04   0.000000e+00   0.000000e+00     11s
   54315    9.8965442e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 1.55s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 9.896544e+04, 54315 iterations, 10.28 seconds (18.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 98965.4418    0  340 -223925.25 98965.4418   144%     -   13s
H    0     0                    -222649.3930 98965.4418   144%     -   13s
H    0     0                    -213135.3684 98965.4418   146%     -   13s
H    0     0                    -185000.3823 98965.4418   153%     -   13s
H    0     0                    -178042.8903 98965.4418   156%     -   13s
H    0     0                    -173511.5195 98965.4418   157%     -   13s
H    0     0                    -172729.9062 98965.4418   157%     -   14s
H    0     0                    -172700.9091 98965.4418   157%     -   14s
H    0     0                    -59954.26560 98965.4418   265%     -   14s
H    0     0                    15723.085681 98965.4418   529%     -   14s
H    0     0                    20526.894459 98965.4418   382%     -   15s
H    0     0                    21379.970172 98965.4418   363%     -   15s
H    0     0                    21616.150088 98965.4418   358%     -   15s
H    0     0                    21798.273836 98965.4418   354%     -   15s
H    0     0                    21823.083586 98965.4418   353%     -   15s
H    0     0                    21835.558633 98965.4418   353%     -   15s
H    0     0                    21864.973843 98965.4418   353%     -   15s
H    0     0                    21879.166496 98965.4418   352%     -   15s
H    0     0                    21906.989666 98962.9500   352%     -   17s
H    0     0                    21962.676579 98962.9500   351%     -   17s
H    0     0                    22034.201475 98962.9500   349%     -   17s
H    0     0                    22351.963251 91029.8567   307%     -   62s
H    0     0                    25220.774514 91029.8567   261%     -   62s
H    0     0                    25661.876059 91029.8567   255%     -   62s
H    0     0                    25859.145740 91029.8567   252%     -   62s
H    0     0                    25938.727395 91029.8567   251%     -   62s
H    0     0                    26177.642219 91029.8567   248%     -   62s
     0     0 91020.0081    0  364 26177.6422 91020.0081   248%     -   62s
H    0     0                    26607.229272 91020.0081   242%     -   64s
H    0     0                    26858.823443 91020.0081   239%     -   64s
H    0     0                    26995.858919 91020.0081   237%     -   64s
     0     0 90418.1396    0  385 26995.8589 90418.1396   235%     -   80s
     0     0 90382.3967    0  384 26995.8589 90382.3967   235%     -   84s
     0     0 90290.5497    0  400 26995.8589 90290.5497   234%     -   89s
     0     0 90290.5497    0  375 26995.8589 90290.5497   234%     -   94s
     0     0 90290.5497    0  370 26995.8589 90290.5497   234%     -   97s
     0     0 90290.5497    0  376 26995.8589 90290.5497   234%     -   98s
     0     0 90290.5497    0  377 26995.8589 90290.5497   234%     -   98s
     0     0 85933.2875    0  355 26995.8589 85933.2875   218%     -  138s
H    0     0                    31330.187216 85933.2875   174%     -  141s
H    0     0                    34412.296444 85933.2875   150%     -  141s
H    0     0                    34583.801784 85933.2875   148%     -  141s
H    0     0                    35001.368433 85933.2875   146%     -  141s
H    0     0                    35206.940920 85933.2875   144%     -  141s
H    0     0                    35429.616674 85933.2875   143%     -  141s
H    0     0                    35617.867567 85933.2875   141%     -  141s
     0     0 85109.5006    0  391 35617.8676 85109.5006   139%     -  171s
     0     0 84834.0188    0  420 35617.8676 84834.0188   138%     -  199s
     0     0 84765.7944    0  417 35617.8676 84765.7944   138%     -  215s
     0     0 84694.5372    0  402 35617.8676 84694.5372   138%     -  226s
     0     0 84511.9668    0  397 35617.8676 84511.9668   137%     -  241s
H    0     0                    35779.604628 84491.0771   136%     -  248s
H    0     0                    36066.812939 84491.0771   134%     -  248s
H    0     0                    36469.726082 84491.0771   132%     -  248s
H    0     0                    37356.546720 84491.0771   126%     -  248s
H    0     0                    37485.252556 84491.0771   125%     -  248s
H    0     0                    37492.165324 84491.0771   125%     -  248s
H    0     0                    37495.974584 84491.0771   125%     -  248s
H    0     0                    37497.342717 84491.0771   125%     -  248s
     0     0 84491.0771    0  412 37497.3427 84491.0771   125%     -  248s
     0     0 84483.8527    0  411 37497.3427 84483.8527   125%     -  252s
     0     0 84473.7456    0  407 37497.3427 84473.7456   125%     -  260s
     0     0 84441.7868    0  419 37497.3427 84441.7868   125%     -  267s
     0     0 84436.7765    0  400 37497.3427 84436.7765   125%     -  270s
     0     0 84434.1324    0  401 37497.3427 84434.1324   125%     -  273s
     0     0 84429.4547    0  403 37497.3427 84429.4547   125%     -  275s
     0     0 84396.2374    0  415 37497.3427 84396.2374   125%     -  281s
     0     0 84393.3135    0  432 37497.3427 84393.3135   125%     -  284s
     0     0 84391.2584    0  411 37497.3427 84391.2584   125%     -  285s
     0     0 84387.2073    0  410 37497.3427 84387.2073   125%     -  288s
     0     0 84387.1321    0  410 37497.3427 84387.1321   125%     -  288s
H    0     0                    41477.488704 81245.7508  95.9%     -  383s
H    0     0                    41500.266514 81245.7508  95.8%     -  383s
H    0     0                    43431.056689 81245.7508  87.1%     -  383s
H    0     0                    43443.170355 81245.7508  87.0%     -  383s
H    0     0                    43503.305069 81245.7508  86.8%     -  383s
H    0     0                    43586.390949 81245.7508  86.4%     -  383s
     0     0 81245.7508    0  449 43586.3909 81245.7508  86.4%     -  383s
H    0     0                    43665.356211 81245.7499  86.1%     -  384s
H    0     0                    44016.070483 81245.7499  84.6%     -  384s
H    0     0                    44982.899369 80713.3114  79.4%     -  414s
H    0     0                    46402.885394 80713.3114  73.9%     -  414s
H    0     0                    46700.227376 80713.3114  72.8%     -  414s
H    0     0                    46834.313609 80713.3114  72.3%     -  414s
     0     0 80713.3114    0  446 46834.3136 80713.3114  72.3%     -  414s
H    0     0                    46880.941376 80565.2814  71.9%     -  429s
H    0     0                    46893.483266 80565.2814  71.8%     -  429s
H    0     0                    46944.629317 80565.2814  71.6%     -  429s
H    0     0                    47136.725865 80565.2814  70.9%     -  429s
H    0     0                    47280.992040 80565.2814  70.4%     -  429s
H    0     0                    47380.158761 80565.2814  70.0%     -  429s
H    0     0                    47383.422631 80565.2814  70.0%     -  429s
     0     0 80565.2814    0  458 47383.4226 80565.2814  70.0%     -  429s
     0     0 80532.8689    0  458 47383.4226 80532.8689  70.0%     -  435s
     0     0 80483.4896    0  444 47383.4226 80483.4896  69.9%     -  443s
     0     0 80470.5472    0  444 47383.4226 80470.5472  69.8%     -  450s
     0     0 80455.3940    0  478 47383.4226 80455.3940  69.8%     -  455s
     0     0 80446.3113    0  447 47383.4226 80446.3113  69.8%     -  460s
     0     0 80440.0002    0  446 47383.4226 80440.0002  69.8%     -  463s
     0     0 80425.4291    0  433 47383.4226 80425.4291  69.7%     -  467s
     0     0 80420.9657    0  443 47383.4226 80420.9657  69.7%     -  469s
     0     0 80418.9284    0  451 47383.4226 80418.9284  69.7%     -  471s
     0     0 78950.0702    0  421 47383.4226 78950.0702  66.6%     -  534s
H    0     0                    47489.563074 78949.7696  66.2%     -  535s
     0     0 78685.6580    0  435 47489.5631 78685.6580  65.7%     -  557s
H    0     0                    48141.717310 78590.2209  63.2%     -  570s
     0     0 78590.2209    0  421 48141.7173 78590.2209  63.2%     -  570s
     0     0 78529.9027    0  425 48141.7173 78529.9027  63.1%     -  581s
     0     0 78502.1419    0  419 48141.7173 78502.1419  63.1%     -  588s
     0     0 78494.1460    0  424 48141.7173 78494.1460  63.0%     -  592s
     0     0 78492.4964    0  429 48141.7173 78492.4964  63.0%     -  594s
     0     0 78239.2458    0  448 48141.7173 78239.2458  62.5%     -  618s
H    0     0                    48197.386826 78161.4960  62.2%     -  635s
H    0     0                    48880.206834 78161.4960  59.9%     -  635s
H    0     0                    49006.697785 78161.4960  59.5%     -  635s
H    0     0                    49665.377471 78161.4960  57.4%     -  635s
     0     0 78161.4960    0  427 49665.3775 78161.4960  57.4%     -  635s
     0     0 78090.6733    0  463 49665.3775 78090.6733  57.2%     -  648s
H    0     0                    49904.878213 78047.0315  56.4%     -  657s
H    0     0                    49937.355721 78047.0315  56.3%     -  657s
H    0     0                    50013.269154 78047.0315  56.1%     -  657s
H    0     0                    50613.571123 78047.0315  54.2%     -  657s
H    0     0                    50741.822407 78047.0315  53.8%     -  657s
     0     0 78047.0315    0  432 50741.8224 78047.0315  53.8%     -  657s
     0     0 78021.0786    0  460 50741.8224 78021.0786  53.8%     -  666s
     0     0 78016.7358    0  433 50741.8224 78016.7358  53.8%     -  668s
     0     0 78001.7245    0  433 50741.8224 78001.7245  53.7%     -  674s
     0     0 77993.6380    0  434 50741.8224 77993.6380  53.7%     -  676s
     0     0 77989.1236    0  446 50741.8224 77989.1236  53.7%     -  678s
     0     0 77983.5217    0  448 50741.8224 77983.5217  53.7%     -  681s
     0     0 77977.9233    0  440 50741.8224 77977.9233  53.7%     -  684s
     0     0 77976.0082    0  441 50741.8224 77976.0082  53.7%     -  685s
     0     0 77856.9502    0  416 50741.8224 77856.9502  53.4%     -  704s
     0     0 77807.6437    0  463 50741.8224 77807.6437  53.3%     -  722s
     0     0 77780.8048    0  429 50741.8224 77780.8048  53.3%     -  727s
     0     0 77767.1393    0  433 50741.8224 77767.1393  53.3%     -  732s
     0     0 77763.3126    0  428 50741.8224 77763.3126  53.3%     -  736s
     0     0 77691.0681    0  433 50741.8224 77691.0681  53.1%     -  750s
H    0     0                    51278.490507 77690.9842  51.5%     -  751s
     0     0 77663.7151    0  427 51278.4905 77663.7151  51.5%     -  759s
     0     0 77638.7121    0  434 51278.4905 77638.7121  51.4%     -  766s
     0     0 77621.4916    0  477 51278.4905 77621.4916  51.4%     -  773s
H    0     0                    51296.016466 77611.0427  51.3%     -  779s
     0     0 77611.0427    0  468 51296.0165 77611.0427  51.3%     -  779s
H    0     0                    51298.878121 77607.1045  51.3%     -  782s
     0     0 77607.1045    0  468 51298.8781 77607.1045  51.3%     -  782s
     0     0 77603.4846    0  440 51298.8781 77603.4846  51.3%     -  784s
H    0     0                    51312.562579 77540.4134  51.1%     -  798s
     0     0 77540.4134    0  433 51312.5626 77540.4134  51.1%     -  798s
H    0     0                    51334.477409 77540.2780  51.0%     -  800s
     0     0 77513.9653    0  408 51334.4774 77513.9653  51.0%     -  806s
     0     0 77496.4798    0  450 51334.4774 77496.4798  51.0%     -  810s
     0     0 77484.9474    0  455 51334.4774 77484.9474  50.9%     -  814s
     0     0 77481.0425    0  449 51334.4774 77481.0425  50.9%     -  816s
     0     0 77480.7572    0  462 51334.4774 77480.7572  50.9%     -  817s
     0     0 77423.5192    0  413 51334.4774 77423.5192  50.8%     -  829s
     0     0 77409.4148    0  425 51334.4774 77409.4148  50.8%     -  833s
     0     0 77403.0816    0  424 51334.4774 77403.0816  50.8%     -  836s
     0     0 77400.1980    0  419 51334.4774 77400.1980  50.8%     -  838s
     0     0 77368.6316    0  415 51334.4774 77368.6316  50.7%     -  845s
H    0     0                    51371.751007 77366.8918  50.6%     -  847s
H    0     0                    51571.334403 77366.8918  50.0%     -  848s
H    0     0                    51659.293074 77366.8918  49.8%     -  848s
H    0     0                    51740.186009 77366.8918  49.5%     -  848s
     0     0 77331.3246    0  411 51740.1860 77331.3246  49.5%     -  857s
     0     0 77329.5185    0  406 51740.1860 77329.5185  49.5%     -  860s
     0     0 77301.3711    0  456 51740.1860 77301.3711  49.4%     -  867s
H    0     0                    51927.435915 77301.1888  48.9%     -  867s
     0     0 77287.6274    0  464 51927.4359 77287.6274  48.8%     -  872s
     0     0 77282.8016    0  454 51927.4359 77282.8016  48.8%     -  874s
     0     0 77280.2552    0  458 51927.4359 77280.2552  48.8%     -  877s
     0     0 77276.0416    0  360 51927.4359 77276.0416  48.8%     -  882s
H    0     0                    52130.870758 77276.0383  48.2%     -  883s
H    0     0                    52178.428988 77276.0383  48.1%     -  884s
H    0     0                    52188.346041 77276.0383  48.1%     -  884s
     0     0 77275.0888    0  361 52188.3460 77275.0888  48.1%     -  886s
     0     0 77274.0648    0  478 52188.3460 77274.0648  48.1%     -  889s
     0     0 77272.9049    0  475 52188.3460 77272.9049  48.1%     -  891s
     0     0 77267.6085    0  455 52188.3460 77267.6085  48.1%     -  897s
     0     0 77267.5908    0  455 52188.3460 77267.5908  48.1%     -  900s
H    0     0                    52449.454654 77267.5529  47.3%     -  981s
H    0     0                    52540.809486 77267.5488  47.1%     - 1070s
H    0     0                    52720.199388 77267.5488  46.6%     - 1073s
H    0     0                    53176.981126 77267.5488  45.3%     - 1105s
H    0     0                    53273.492281 77267.5488  45.0%     - 1113s
H    0     2                    53335.307599 77267.5488  44.9%     - 1120s
     0     2 77267.5488    0  455 53335.3076 77267.5488  44.9%     - 1120s
     1     4 77200.6788    1  365 53335.3076 77267.5488  44.9%  5971 1127s
     3     7 77170.8538    2  462 53335.3076 77236.8114  44.8%  5670 1165s
     6    12 76420.0324    3  408 53335.3076 77236.8114  44.8% 11404 1207s
    11    23 76187.5669    4  440 53335.3076 77168.7054  44.7% 16926 1245s
    22    34 74756.3755    4  371 53335.3076 76755.5600  43.9% 22471 1349s
    33    65 74279.2983    6  331 53335.3076 76755.5600  43.9% 21856 1715s
    64    97 74029.4841    7  331 53335.3076 76755.5600  43.9% 28483 1918s
    96   253 74013.9838    8  336 53335.3076 76755.5600  43.9% 24066 2070s
   252   315 73659.2169   13  319 53335.3076 76755.5600  43.9% 13689 2111s
   314   380 73359.0337   15  292 53335.3076 76755.5600  43.9% 12438 2156s
   379   434 72929.5351   17  282 53335.3076 76755.5600  43.9% 11775 2195s
   433   459 72139.1196   20  269 53335.3076 76755.5600  43.9% 11173 2222s
   458   485 72106.8662   21  261 53335.3076 76755.5600  43.9% 11220 2251s
   484   511 69093.4591   22  260 53335.3076 76755.5600  43.9% 11257 2282s
   510   540 69053.7603   23  259 53335.3076 76755.5600  43.9% 11611 2311s
   539   568 68854.2554   24  268 53335.3076 76755.5600  43.9% 12034 2340s
   567   588 68252.7925   25  264 53335.3076 76755.5600  43.9% 12024 2373s
   587   612 67191.8006   26  266 53335.3076 76755.5600  43.9% 12201 2403s
   611   635 66790.4915   27  260 53335.3076 76755.5600  43.9% 12489 2431s
H  629   635                    53397.215746 76755.5600  43.7% 12489 2431s
   634   677 66753.9028   28  252 53397.2157 76755.5600  43.7% 12549 2460s
   676   700 56864.1804   31  239 53397.2157 76755.5600  43.7% 12569 2487s
   699   723 56863.3410   32  234 53397.2157 76755.5600  43.7% 12706 2514s
H  704   723                    54063.224507 76755.5600  42.0% 12703 2514s
   722   770 56117.2086   33  235 54063.2245 76755.5600  42.0% 12770 2549s
H  773   793                    54191.531177 76755.5600  41.6% 12861 2575s
H  774   793                    54199.737841 76755.5600  41.6% 12856 2575s
H  785   793                    54314.609114 76755.5600  41.3% 12823 2575s
H  788   793                    54387.967794 76755.5600  41.1% 12836 2575s
   800   813 infeasible   38      54387.9678 76755.5600  41.1% 12936 2608s
   830   829 68183.4445   21  295 54387.9678 76755.5600  41.1% 13065 2646s
   856   867 67611.0777   22  280 54387.9678 76755.5600  41.1% 13132 2695s
H  878   867                    54714.684774 76755.5600  40.3% 13268 2695s
   894   946 67181.5566   24  243 54714.6848 76755.5600  40.3% 13306 2734s
   977  1000 64829.2301   27  218 54714.6848 76755.5600  40.3% 13218 2772s
  1045  1053 59836.3625   28  189 54714.6848 76755.5600  40.3% 13076 2807s
  1113  1081 59066.5444   29  213 54714.6848 76755.5600  40.3% 12981 2845s
H 1116  1081                    54834.389138 76755.5600  40.0% 12993 2845s
H 1145  1081                    54917.449566 76755.5600  39.8% 13153 2845s
  1147  1143 infeasible   30      54917.4496 76755.5600  39.8% 13168 2886s
  1241  1203 55966.2263   33  157 54917.4496 76755.5600  39.8% 13116 2934s
  1341  1231 infeasible   36      54917.4496 76755.5600  39.8% 12952 2978s
H 1345  1231                    55077.409195 76755.5600  39.4% 12940 2978s
  1389  1289 74802.9853   12  423 55077.4092 76755.5600  39.4% 13037 3025s
  1507  1356 74370.8433   13  416 55077.4092 76755.5600  39.4% 12801 3074s
  1608  1407 73208.0162   15  405 55077.4092 76755.5600  39.4% 12850 3124s
  1707  1459 73046.4103   16  413 55077.4092 76755.5600  39.4% 12871 3173s
  1783  1529 72388.4782   18  390 55077.4092 76755.5600  39.4% 13002 3225s
  1871  1597 71277.1147   20  362 55077.4092 76755.5600  39.4% 13128 3284s
  1971  1686 70964.3092   21  351 55077.4092 76157.4439  38.3% 13171 3350s
  2072  1779 69719.6946   23  329 55077.4092 76157.2972  38.3% 13270 3409s
  2200  1915 67537.8944   28  295 55077.4092 76157.2972  38.3% 13218 3471s
  2379  1970 64073.7547   34  231 55077.4092 76157.2972  38.3% 12932 3521s
  2450  2083 63818.5788   35  220 55077.4092 76157.2972  38.3% 12867 3579s
  2615  2125 62909.8739   42  228 55077.4092 75823.7878  37.7% 12656 3600s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 280
  MIR: 3572
  Flow cover: 3200
  RLT: 159
  Relax-and-lift: 1173

Explored 2687 nodes (34414627 simplex iterations) in 3600.05 seconds (8323.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 55077.4 54917.4 54834.4 ... 53397.2

Time limit reached
Best objective 5.507740919527e+04, best bound 7.582378780227e+04, gap 37.6677%
  WARNING: Time limit reached. Using best solution found (gap: 37.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 55077.41, θ = 228358.78
  Upper Bound (UB) = 55077.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228358.78
  [DEBUG]   ✓ Scenario 0: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228358.78 ≤ Q = 228358.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228358.78 ≤ Q = 228358.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228358.78 ≤ Q = 228358.78 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x55cba4e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x55cba4e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.405017e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.00s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 7019531.9322
Variable types: 365 continuous, 173 integer (173 binary)

Root relaxation: objective -1.883126e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -188312.63    0  131 7019531.93 -188312.63   103%     -    0s
H    0     0                    -152920.5356 -188312.63  23.1%     -    0s
H    0     0                    -152949.2629 -188312.63  23.1%     -    0s
H    0     0                    -162723.0019 -188312.63  15.7%     -    0s
     0     0 -169670.90    0   61 -162723.00 -169670.90  4.27%     -    0s
H    0     0                    -167033.1079 -169561.45  1.51%     -    0s
H    0     0                    -167366.8501 -169561.45  1.31%     -    0s
H    0     0                    -167634.0571 -169561.45  1.15%     -    0s
H    0     0                    -167967.7993 -169561.45  0.95%     -    0s
     0     0 -169083.51    0   72 -167967.80 -169083.51  0.66%     -    0s
     0     0 -169083.48    0   72 -167967.80 -169083.48  0.66%     -    0s
     0     0 -168561.09    0   44 -167967.80 -168561.09  0.35%     -    0s
     0     0 -168528.17    0   41 -167967.80 -168528.17  0.33%     -    0s
H    0     0                    -167987.5850 -168528.17  0.32%     -    0s
     0     0 -168512.97    0   26 -167987.58 -168512.97  0.31%     -    0s
     0     0 -168505.11    0   25 -167987.58 -168505.11  0.31%     -    0s
     0     0 -168382.24    0   23 -167987.58 -168382.24  0.23%     -    0s
     0     0 -168324.65    0   24 -167987.58 -168324.65  0.20%     -    0s
     0     0 -168310.40    0   23 -167987.58 -168310.40  0.19%     -    0s
     0     0 -168234.72    0   26 -167987.58 -168234.72  0.15%     -    0s
     0     0 -168234.72    0   25 -167987.58 -168234.72  0.15%     -    0s
     0     0 -168234.72    0   34 -167987.58 -168234.72  0.15%     -    0s
     0     0 -168101.19    0    6 -167987.58 -168101.19  0.07%     -    0s
H    0     0                    -168048.3696 -168094.81  0.03%     -    0s
     0     0 -168077.25    0   12 -168048.37 -168077.25  0.02%     -    0s
     0     0 -168071.20    0    5 -168048.37 -168071.20  0.01%     -    0s
H    0     0                    -168069.8810 -168071.20  0.00%     -    0s
     0     0 -168069.92    0    2 -168069.88 -168069.92  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 15
  Flow cover: 14

Explored 1 nodes (844 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -168070 -168048 -167988 ... 7.01953e+06

Optimal solution found (tolerance 1.00e-06)
Best objective -1.680698810130e+05, best bound -1.680699169531e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 213170.48
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168069.88
  [DEBUG]   S×d_nominal = 381240.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 381240.36 + -168069.88 = 213170.48
  [DEBUG]   Current θ from Master = 228358.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15188.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 39889.11
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1750.4619, Absolute Gap = 1750.4619, Relative Gap = 0.031782
  Not converged yet (gap = 1750.46 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0x040ed646
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 1.81s
Presolved: 117434 rows, 49801 columns, 705036 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -297481.7992
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 662
 AA' NZ     : 4.196e+06
 Factor NZ  : 1.144e+07 (roughly 160 MB of memory)
 Factor Ops : 4.121e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78540453e+07  2.35704076e+08  1.50e+05 1.63e+01  9.22e+04     3s
   1  -1.36652462e+07  2.20259439e+08  1.06e+05 1.04e+02  6.40e+04     3s
   2  -7.58997992e+06  1.78440677e+08  5.77e+04 3.71e+01  3.61e+04     3s
   3  -1.38961443e+06  1.39032068e+08  5.05e+03 4.77e-01  3.71e+03     3s
   4  -7.72696832e+05  6.77533516e+07  7.76e+02 1.25e-01  7.42e+02     3s
   5  -6.58137690e+05  4.49369966e+07  3.79e+02 7.37e-02  4.02e+02     3s
   6  -3.96091142e+05  3.38549702e+07  1.38e+02 4.97e-02  2.23e+02     4s
   7  -3.12475594e+05  2.52089214e+07  6.60e+01 3.66e-02  1.46e+02     4s
   8  -2.47410796e+05  1.67688509e+07  2.36e+01 2.36e-02  8.70e+01     4s
   9  -1.01473112e+05  8.21291381e+06  4.10e+00 1.08e-02  3.95e+01     4s
  10  -5.78574825e+04  2.68010516e+06  2.40e+00 3.30e-03  1.29e+01     4s
  11   4.59173270e+03  1.56903737e+06  6.11e-01 1.97e-03  7.31e+00     4s
  12   1.93131622e+04  9.47057287e+05  4.48e-01 1.14e-03  4.33e+00     4s
  13   3.03827764e+04  5.43358702e+05  3.03e-01 5.58e-04  2.39e+00     4s
  14   4.08674835e+04  3.39993794e+05  2.02e-01 3.95e-04  1.39e+00     4s
  15   4.84073392e+04  2.60821417e+05  1.39e-01 6.68e-04  9.90e-01     4s
  16   6.06068749e+04  2.09321332e+05  8.18e-02 8.41e-04  6.93e-01     4s
  17   6.56681543e+04  1.81747102e+05  6.58e-02 1.35e-03  5.41e-01     4s
  18   7.44524429e+04  1.53398121e+05  4.43e-02 1.62e-03  3.68e-01     4s
  19   7.95218087e+04  1.35363593e+05  3.36e-02 1.70e-03  2.60e-01     4s
  20   8.34526993e+04  1.27707036e+05  2.60e-02 1.34e-03  2.06e-01     4s
  21   8.68493697e+04  1.22869715e+05  1.97e-02 1.11e-03  1.68e-01     5s
  22   8.90293994e+04  1.18886001e+05  1.56e-02 9.42e-04  1.39e-01     5s
  23   9.02296249e+04  1.14837781e+05  1.33e-02 7.58e-04  1.15e-01     5s
  24   9.25113233e+04  1.09676942e+05  9.30e-03 5.21e-04  8.00e-02     5s
  25   9.35639811e+04  1.06532628e+05  7.62e-03 3.74e-04  6.04e-02     5s
  26   9.49655914e+04  1.05173388e+05  5.51e-03 3.05e-04  4.76e-02     5s
  27   9.51335989e+04  1.03745955e+05  5.25e-03 2.44e-04  4.01e-02     5s
  28   9.58714574e+04  1.03321847e+05  4.22e-03 2.24e-04  3.47e-02     5s
  29   9.65526705e+04  1.02321013e+05  3.22e-03 1.71e-04  2.69e-02     5s
  30   9.68621992e+04  1.01915726e+05  2.78e-03 1.51e-04  2.35e-02     5s
  31   9.72925000e+04  1.00909036e+05  2.19e-03 9.91e-05  1.68e-02     5s
  32   9.75087042e+04  1.00582348e+05  1.88e-03 8.26e-05  1.43e-02     6s
  33   9.78695627e+04  1.00045143e+05  1.40e-03 5.40e-05  1.01e-02     6s
  34   9.82374278e+04  9.97989482e+04  9.36e-04 4.10e-05  7.27e-03     6s
  35   9.84384542e+04  9.96233131e+04  6.77e-04 3.16e-05  5.52e-03     6s
  36   9.86063639e+04  9.94712413e+04  4.75e-04 2.36e-05  4.03e-03     6s
  37   9.86928628e+04  9.93369963e+04  3.65e-04 1.69e-05  3.00e-03     6s
  38   9.88144170e+04  9.92171881e+04  2.23e-04 1.06e-05  1.88e-03     6s
  39   9.88604880e+04  9.91780983e+04  1.70e-04 8.58e-06  1.48e-03     6s
  40   9.88963624e+04  9.91139993e+04  1.26e-04 5.31e-06  1.01e-03     6s
  41   9.89009910e+04  9.90896065e+04  1.21e-04 4.08e-06  8.79e-04     6s
  42   9.89243589e+04  9.90667647e+04  9.47e-05 2.89e-06  6.63e-04     7s
  43   9.89424742e+04  9.90592347e+04  7.29e-05 2.52e-06  5.44e-04     7s
  44   9.89450857e+04  9.90581318e+04  6.99e-05 2.47e-06  5.27e-04     7s
  45   9.89550824e+04  9.90543228e+04  5.89e-05 2.26e-06  4.62e-04     7s
  46   9.89712969e+04  9.90339390e+04  4.06e-05 1.21e-06  2.92e-04     7s
  47   9.89775595e+04  9.90246334e+04  3.36e-05 7.60e-07  2.19e-04     7s
  48   9.89872971e+04  9.90186530e+04  2.32e-05 4.59e-07  1.46e-04     7s
  49   9.89963952e+04  9.90155206e+04  1.30e-05 3.08e-07  8.91e-05     7s
  50   9.89973176e+04  9.90150353e+04  1.20e-05 2.84e-07  8.25e-05     7s
  51   9.90018744e+04  9.90131374e+04  6.96e-06 1.97e-07  5.25e-05     7s
  52   9.90057216e+04  9.90113652e+04  3.08e-06 1.09e-07  2.63e-05     8s
  53   9.90067612e+04  9.90096066e+04  2.05e-06 2.88e-08  1.33e-05     8s
  54   9.90073311e+04  9.90094750e+04  1.50e-06 2.30e-08  9.99e-06     8s
  55   9.90079122e+04  9.90094329e+04  9.45e-07 2.12e-08  7.08e-06     8s
  56   9.90083083e+04  9.90090202e+04  5.74e-07 2.33e-09  3.32e-06     8s
  57   9.90088933e+04  9.90089662e+04  5.03e-08 7.97e-11  3.39e-07     8s
  58   9.90089546e+04  9.90089592e+04  6.28e-09 2.58e-11  2.14e-08     8s
  59   9.90089583e+04  9.90089583e+04  3.02e-09 1.20e-11  6.25e-11     8s

Barrier solved model in 59 iterations and 8.14 seconds (12.45 work units)
Optimal objective 9.90089583e+04


Root crossover log...

   98194 DPushes remaining with DInf 0.0000000e+00                 8s
    5515 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    3104 PPushes remaining with PInf 1.4399107e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0784130e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37413    9.9008958e+04   0.000000e+00   0.000000e+00     11s
   37413    9.9008958e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.15s

Solved with barrier

Root relaxation: objective 9.900896e+04, 37413 iterations, 8.73 seconds (16.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99008.9583    0  315 -223925.25 99008.9583   144%     -   11s
H    0     0                    -131551.1490 99008.9583   175%     -   11s
H    0     0                    -87838.89871 99008.9583   213%     -   12s
H    0     0                    -85123.64119 99008.9583   216%     -   12s
H    0     0                    -78276.38554 99008.9583   226%     -   12s
H    0     0                    -76235.54261 99008.9583   230%     -   12s
H    0     0                    -76194.39088 99008.9583   230%     -   12s
H    0     0                    -76187.07375 99008.9583   230%     -   12s
H    0     0                    -76099.18681 99008.9583   230%     -   12s
H    0     0                    -54116.49451 99008.9583   283%     -   12s
H    0     0                    8596.7470926 99008.9583  1052%     -   13s
H    0     0                    30104.100206 99008.9583   229%     -   13s
H    0     0                    31089.731939 99008.9583   218%     -   13s
H    0     0                    31290.913189 99008.9583   216%     -   13s
H    0     0                    31315.763898 99008.9583   216%     -   13s
H    0     0                    33937.923548 99008.9583   192%     -   14s
H    0     0                    34826.257926 91588.6216   163%     -   62s
H    0     0                    35047.554590 91588.6216   161%     -   62s
H    0     0                    36726.236305 91588.6216   149%     -   62s
H    0     0                    36805.280320 91588.6216   149%     -   62s
     0     0 91588.6216    0  393 36805.2803 91588.6216   149%     -   63s
H    0     0                    37070.842018 91587.9256   147%     -   64s
H    0     0                    39248.930682 91587.9256   133%     -   64s
     0     0 90678.7517    0  401 39248.9307 90678.7517   131%     -   87s
     0     0 90599.1715    0  417 39248.9307 90599.1715   131%     -   95s
     0     0 90538.0608    0  405 39248.9307 90538.0608   131%     -  101s
     0     0 90419.1586    0  403 39248.9307 90419.1586   130%     -  107s
     0     0 90398.9331    0  412 39248.9307 90398.9331   130%     -  115s
     0     0 90395.5771    0  404 39248.9307 90395.5771   130%     -  119s
     0     0 90395.2966    0  404 39248.9307 90395.2966   130%     -  119s
H    0     0                    39277.801878 86818.8792   121%     -  167s
     0     0 86521.9125    0  343 39277.8019 86521.9125   120%     -  170s
H    0     0                    41541.063928 86521.9125   108%     -  170s
H    0     0                    42305.759814 86521.9125   105%     -  170s
H    0     0                    42569.707493 86521.9125   103%     -  170s
H    0     0                    42627.975544 86521.9125   103%     -  171s
H    0     0                    42669.702128 86521.9125   103%     -  171s
H    0     0                    42699.777244 86521.9125   103%     -  171s
H    0     0                    42721.860857 86521.9125   103%     -  171s
     0     0 85305.0270    0  450 42721.8609 85305.0270   100%     -  221s
     0     0 85057.1372    0  467 42721.8609 85057.1372  99.1%     -  241s
     0     0 84993.0858    0  473 42721.8609 84993.0858  98.9%     -  254s
H    0     0                    42742.734493 84869.7942  98.6%     -  272s
H    0     0                    42745.392005 84869.7942  98.5%     -  272s
H    0     0                    42789.266362 84869.7942  98.3%     -  272s
     0     0 84869.7942    0  457 42789.2664 84869.7942  98.3%     -  272s
H    0     0                    43382.593334 84754.2291  95.4%     -  289s
H    0     0                    43525.310421 84754.2291  94.7%     -  289s
H    0     0                    43848.213882 84754.2291  93.3%     -  289s
H    0     0                    44124.568758 84754.2291  92.1%     -  289s
     0     0 84754.2291    0  474 44124.5688 84754.2291  92.1%     -  289s
     0     0 84704.7511    0  482 44124.5688 84704.7511  92.0%     -  300s
     0     0 84646.4352    0  465 44124.5688 84646.4352  91.8%     -  311s
     0     0 84628.9745    0  475 44124.5688 84628.9745  91.8%     -  317s
     0     0 84593.5498    0  474 44124.5688 84593.5498  91.7%     -  322s
     0     0 84563.1467    0  481 44124.5688 84563.1467  91.6%     -  331s
     0     0 84553.3035    0  491 44124.5688 84553.3035  91.6%     -  336s
     0     0 84549.4678    0  494 44124.5688 84549.4678  91.6%     -  339s
     0     0 84548.1880    0  491 44124.5688 84548.1880  91.6%     -  342s
H    0     0                    44886.621081 81597.0232  81.8%     -  430s
H    0     0                    47129.255833 81597.0232  73.1%     -  430s
H    0     0                    47565.335584 81597.0232  71.5%     -  430s
H    0     0                    47733.678055 81597.0232  70.9%     -  430s
H    0     0                    48033.326621 81597.0232  69.9%     -  430s
H    0     0                    48101.526389 81597.0232  69.6%     -  430s
H    0     0                    48343.594919 81597.0232  68.8%     -  430s
H    0     0                    48422.852917 81597.0232  68.5%     -  430s
H    0     0                    48486.001552 81597.0232  68.3%     -  430s
H    0     0                    48704.785763 81597.0232  67.5%     -  430s
H    0     0                    48814.393702 81597.0232  67.2%     -  430s
     0     0 81597.0232    0  444 48814.3937 81597.0232  67.2%     -  430s
H    0     0                    48951.303383 81596.9859  66.7%     -  431s
H    0     0                    49195.898813 81596.9859  65.9%     -  431s
H    0     0                    49668.838555 81596.9859  64.3%     -  431s
H    0     0                    49949.875175 80859.7710  61.9%     -  474s
H    0     0                    49963.656729 80859.7710  61.8%     -  474s
H    0     0                    50025.773707 80859.7710  61.6%     -  474s
     0     0 80859.7710    0  428 50025.7737 80859.7710  61.6%     -  474s
     0     0 80638.8180    0  440 50025.7737 80638.8180  61.2%     -  504s
     0     0 80488.4742    0  474 50025.7737 80488.4742  60.9%     -  529s
     0     0 80420.7913    0  470 50025.7737 80420.7913  60.8%     -  545s
     0     0 80365.8641    0  438 50025.7737 80365.8641  60.6%     -  560s
     0     0 80346.9605    0  442 50025.7737 80346.9605  60.6%     -  568s
     0     0 80288.8027    0  488 50025.7737 80288.8027  60.5%     -  591s
     0     0 80278.2148    0  496 50025.7737 80278.2148  60.5%     -  600s
     0     0 80269.5497    0  473 50025.7737 80269.5497  60.5%     -  607s
     0     0 80261.2781    0  446 50025.7737 80261.2781  60.4%     -  614s
     0     0 80259.2634    0  445 50025.7737 80259.2634  60.4%     -  617s
     0     0 79179.8620    0  417 50025.7737 79179.8620  58.3%     -  680s
     0     0 78830.7509    0  425 50025.7737 78830.7509  57.6%     -  708s
     0     0 78676.0347    0  493 50025.7737 78676.0347  57.3%     -  729s
     0     0 78644.9710    0  432 50025.7737 78644.9710  57.2%     -  738s
     0     0 78601.5315    0  440 50025.7737 78601.5315  57.1%     -  746s
     0     0 78581.0040    0  439 50025.7737 78581.0040  57.1%     -  754s
     0     0 78566.3165    0  436 50025.7737 78566.3165  57.1%     -  758s
     0     0 78541.3864    0  431 50025.7737 78541.3864  57.0%     -  764s
     0     0 78536.5625    0  437 50025.7737 78536.5625  57.0%     -  767s
     0     0 78533.4407    0  440 50025.7737 78533.4407  57.0%     -  769s
     0     0 78210.5362    0  510 50025.7737 78210.5362  56.3%     -  797s
H    0     0                    50936.154611 78106.8504  53.3%     -  812s
     0     0 78106.8504    0  523 50936.1546 78106.8504  53.3%     -  812s
H    0     0                    51011.501195 78078.6731  53.1%     -  823s
     0     0 78078.6731    0  495 51011.5012 78078.6731  53.1%     -  823s
     0     0 78060.4944    0  519 51011.5012 78060.4944  53.0%     -  830s
H    0     0                    51019.199752 78045.6409  53.0%     -  834s
     0     0 78045.6409    0  517 51019.1998 78045.6409  53.0%     -  834s
     0     0 78041.9005    0  490 51019.1998 78041.9005  53.0%     -  837s
     0     0 77889.6794    0  516 51019.1998 77889.6794  52.7%     -  861s
     0     0 77822.4354    0  528 51019.1998 77822.4354  52.5%     -  878s
     0     0 77810.4490    0  537 51019.1998 77810.4490  52.5%     -  888s
     0     0 77793.1614    0  535 51019.1998 77793.1614  52.5%     -  898s
     0     0 77781.7770    0  527 51019.1998 77781.7770  52.5%     -  906s
     0     0 77777.4023    0  488 51019.1998 77777.4023  52.4%     -  909s
     0     0 77769.1629    0  484 51019.1998 77769.1629  52.4%     -  915s
     0     0 77763.1576    0  495 51019.1998 77763.1576  52.4%     -  921s
     0     0 77762.6187    0  484 51019.1998 77762.6187  52.4%     -  923s
     0     0 77689.1712    0  484 51019.1998 77689.1712  52.3%     -  939s
     0     0 77634.5958    0  485 51019.1998 77634.5958  52.2%     -  953s
     0     0 77613.9927    0  486 51019.1998 77613.9927  52.1%     -  960s
     0     0 77601.1396    0  486 51019.1998 77601.1396  52.1%     -  965s
     0     0 77595.6212    0  498 51019.1998 77595.6212  52.1%     -  967s
     0     0 77594.1828    0  492 51019.1998 77594.1828  52.1%     -  969s
     0     0 77487.6154    0  443 51019.1998 77487.6154  51.9%     -  983s
     0     0 77464.9825    0  456 51019.1998 77464.9825  51.8%     -  992s
     0     0 77442.7892    0  441 51019.1998 77442.7892  51.8%     -  999s
     0     0 77433.9031    0  468 51019.1998 77433.9031  51.8%     - 1004s
     0     0 77430.4811    0  444 51019.1998 77430.4811  51.8%     - 1007s
     0     0 77397.9234    0  433 51019.1998 77397.9234  51.7%     - 1016s
     0     0 77382.6330    0  440 51019.1998 77382.6330  51.7%     - 1022s
     0     0 77376.1834    0  426 51019.1998 77376.1834  51.7%     - 1025s
     0     0 77374.7633    0  453 51019.1998 77374.7633  51.7%     - 1029s
     0     0 77363.4580    0  362 51019.1998 77363.4580  51.6%     - 1038s
     0     0 77352.6105    0  435 51019.1998 77352.6105  51.6%     - 1045s
     0     0 77351.6647    0  429 51019.1998 77351.6647  51.6%     - 1047s
H    0     0                    51367.167567 77337.5579  50.6%     - 1056s
     0     0 77337.5579    0  482 51367.1676 77337.5579  50.6%     - 1056s
H    0     0                    51839.058359 77337.3651  49.2%     - 1057s
     0     0 77331.6986    0  470 51839.0584 77331.6986  49.2%     - 1063s
     0     0 77323.6290    0  467 51839.0584 77323.6290  49.2%     - 1068s
     0     0 77319.8701    0  467 51839.0584 77319.8701  49.2%     - 1071s
     0     0 77318.3012    0  435 51839.0584 77318.3012  49.2%     - 1075s
     0     0 77318.2816    0  435 51839.0584 77318.2816  49.2%     - 1078s
H    0     0                    52210.652736 77318.2678  48.1%     - 1189s
H    0     0                    52384.641820 77318.2678  47.6%     - 1260s
     0     2 77318.2678    0  435 52384.6418 77318.2678  47.6%     - 1262s
     1     3 77167.2473    1  444 52384.6418 77318.2678  47.6% 15860 1282s
     2     4 77218.8586    1  420 52384.6418 77218.8586  47.4% 11655 1291s
     3     6 77148.0992    2  428 52384.6418 77218.7542  47.4% 10160 1306s
     5     9 77144.1730    3  415 52384.6418 77218.7542  47.4%  8792 1326s
     8    16 76778.0700    4  424 52384.6418 77147.9469  47.3% 10787 1395s
    15    32 76588.2287    5  412 52384.6418 76843.6399  46.7% 15420 1452s
    31    48 75010.0569    6  428 52384.6418 76733.9002  46.5% 25775 1682s
H   47    80                    52668.060857 76733.9002  45.7% 30993 1741s
H   49    80                    52816.269548 76733.9002  45.3% 30444 1741s
    79   161 73150.7933    7  401 52816.2695 76733.9002  45.3% 24034 1809s
H  160   193                    53224.029750 76733.9002  44.2% 15286 1836s
H  163   193                    53959.777582 76733.9002  42.2% 15135 1836s
H  167   193                    54088.376783 76733.9002  41.9% 14899 1836s
H  170   193                    54812.744320 76733.9002  40.0% 14715 1836s
   192   253 72824.6452   11  302 54812.7443 76733.9002  40.0% 13755 1885s
   252   283 72573.4641   12  293 54812.7443 76733.9002  40.0% 12530 1921s
   282   311 72517.5323   13  388 54812.7443 76733.9002  40.0% 11953 1962s
H  285   311                    55215.619054 76733.9002  39.0% 11907 1962s
   310   345 73904.7109   12  362 55215.6191 76733.9002  39.0% 11627 2011s
   346   373 69293.0277   15  313 55215.6191 76733.9002  39.0% 11417 2053s
   376   407 72759.5624   14  363 55215.6191 76733.9002  39.0% 11611 2103s
   412   439 68764.4672   19  331 55215.6191 76733.9002  39.0% 11404 2143s
   446   489 67993.6366   20  284 55215.6191 76733.9002  39.0% 11967 2197s
   500   546 67790.4440   22  357 55215.6191 76733.9002  39.0% 11653 2247s
   565   595 67618.4481   25  308 55215.6191 76733.9002  39.0% 11148 2307s
   624   656 71086.8111   16  395 55215.6191 76733.9002  39.0% 10778 2370s
   698   678 67000.2756   26  339 55215.6191 76733.9002  39.0% 10328 2401s
H  699   678                    55401.894811 76733.9002  38.5% 10314 2401s
H  702   678                    55438.641316 76733.9002  38.4% 10295 2401s
   732   743 infeasible   31      55438.6413 76733.9002  38.4% 10141 2440s
H  776   743                    55531.854603 76733.9002  38.2%  9793 2440s
H  781   743                    55607.560597 76733.9002  38.0%  9766 2440s
H  809   743                    55844.967949 76733.9002  37.4%  9579 2440s
   813   836 62045.4331   27  311 55844.9679 76733.9002  37.4%  9582 2483s
   906   922 61702.9019   30  269 55844.9679 76733.9002  37.4%  9072 2524s
H  923   922                    55893.589558 76733.9002  37.3%  8991 2524s
H  932   922                    55900.879527 76733.9002  37.3%  8983 2524s
   994   966 61117.2814   33  268 55900.8795 76733.9002  37.3%  8700 2553s
H 1002   966                    55990.153614 76733.9002  37.0%  8659 2553s
H 1018   966                    56048.024483 76733.9002  36.9%  8575 2553s
  1048  1102 60951.7577   34  251 56048.0245 76733.9002  36.9%  8440 2585s
  1184  1225 59985.0649   36  212 56048.0245 76733.9002  36.9%  7784 2624s
  1333  1340 58038.6221   40  182 56048.0245 76733.9002  36.9%  7271 2656s
H 1355  1340                    56075.985823 76733.9002  36.8%  7206 2656s
H 1374  1340                    56114.612375 76733.9002  36.7%  7157 2656s
H 1381  1340                    56114.919135 76733.9002  36.7%  7150 2656s
H 1404  1340                    56128.359966 76733.9002  36.7%  7096 2656s
H 1450  1340                    56250.997983 76733.9002  36.4%  6939 2656s
  1496  1431     cutoff   41      56250.9980 76733.9002  36.4%  6824 2695s
  1655  1496     cutoff   41      56250.9980 76733.9002  36.4%  6483 2731s
H 1660  1496                    56323.803736 76733.9002  36.2%  6480 2731s
  1802  1559 58229.3354   21  365 56323.8037 76733.9002  36.2%  6192 2772s
  1959  1576 infeasible   46      56323.8037 76733.9002  36.2%  5935 2814s
  2036  1587 56538.6704   32  103 56323.8037 76733.9002  36.2%  5888 2865s
  2116  1597     cutoff   34      56323.8037 76733.9002  36.2%  5857 2910s
  2158  1610 72916.2974    9  367 56323.8037 76733.9002  36.2%  5880 2961s
  2212  1623 67488.6143   10  388 56323.8037 76733.9002  36.2%  5942 3016s
  2290  1639 66715.0479   11  384 56323.8037 76626.8880  36.0%  5954 3080s
  2320  1663 infeasible   27      56323.8037 76626.5158  36.0%  6028 3154s
  2346  1748 66560.9707   11  399 56323.8037 76626.5158  36.0%  6103 3216s
  2439  1863 72914.6358   10  361 56323.8037 76626.5158  36.0%  6082 3278s
  2620  1926     cutoff   29      56323.8037 76626.5158  36.0%  5929 3341s
  2753  1948 infeasible   73      56323.8037 76587.8233  36.0%  5899 3400s
  2785  1976 57364.9159   58  200 56323.8037 76437.7676  35.7%  5964 3458s
  2873  2017 74353.5387    7  331 56323.8037 76437.2611  35.7%  5957 3531s
  2939  2078 72484.1092    8  276 56323.8037 76370.4186  35.6%  5995 3600s

Cutting planes:
  Learned: 2
  Gomory: 43
  Implied bound: 566
  MIR: 4369
  Flow cover: 3675
  RLT: 157
  Relax-and-lift: 1386

Explored 3032 nodes (19155632 simplex iterations) in 3600.07 seconds (8144.38 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 56323.8 56251 56128.4 ... 55893.6

Time limit reached
Best objective 5.632380373573e+04, best bound 7.637041863892e+04, gap 35.5917%
  WARNING: Time limit reached. Using best solution found (gap: 35.59%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 56323.80, θ = 225529.13
  Upper Bound (UB) = 56323.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225529.13
  [DEBUG]   ✓ Scenario 0: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225529.13 ≤ Q = 225529.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 225529.13 ≤ Q = 225529.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 225529.13 ≤ Q = 225529.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 225529.13 ≤ Q = 225529.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ec4a911
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ec4a911
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.395769e+13
Presolve removed 2563 rows and 1853 columns
Presolve time: 0.00s
Presolved: 530 rows, 536 columns, 1502 nonzeros
Found heuristic solution: objective 6925662.5537
Variable types: 363 continuous, 173 integer (173 binary)

Root relaxation: objective -1.887967e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -188796.70    0  128 6925662.55 -188796.70   103%     -    0s
H    0     0                    -153897.7856 -188796.70  22.7%     -    0s
H    0     0                    -154342.6234 -188796.70  22.3%     -    0s
H    0     0                    -161351.2198 -188796.70  17.0%     -    0s
     0     0 -168942.33    0   67 -161351.22 -168942.33  4.70%     -    0s
H    0     0                    -165908.5110 -168915.80  1.81%     -    0s
H    0     0                    -166235.6471 -168915.80  1.61%     -    0s
H    0     0                    -166357.3931 -168915.80  1.54%     -    0s
H    0     0                    -166684.5293 -168915.80  1.34%     -    0s
     0     0 -168424.21    0   48 -166684.53 -168424.21  1.04%     -    0s
     0     0 -167912.29    0   71 -166684.53 -167912.29  0.74%     -    0s
H    0     0                    -166863.6905 -167851.04  0.59%     -    0s
     0     0 -167851.04    0   70 -166863.69 -167851.04  0.59%     -    0s
     0     0 -167512.57    0   46 -166863.69 -167512.57  0.39%     -    0s
     0     0 -167504.92    0   45 -166863.69 -167504.92  0.38%     -    0s
H    0     0                    -166867.9846 -167504.92  0.38%     -    0s
     0     0 -167473.51    0   51 -166867.98 -167473.51  0.36%     -    0s
     0     0 -167473.50    0   49 -166867.98 -167473.50  0.36%     -    0s
     0     0 -167301.67    0   29 -166867.98 -167301.67  0.26%     -    0s
     0     0 -167289.81    0   29 -166867.98 -167289.81  0.25%     -    0s
     0     0 -167223.29    0   30 -166867.98 -167223.29  0.21%     -    0s
     0     0 -167222.04    0   30 -166867.98 -167222.04  0.21%     -    0s
     0     0 -167222.04    0   29 -166867.98 -167222.04  0.21%     -    0s
     0     0 -167216.35    0   68 -166867.98 -167216.35  0.21%     -    0s
     0     0 -167216.35    0   32 -166867.98 -167216.35  0.21%     -    0s
H    0     0                    -166956.9532 -167211.81  0.15%     -    0s
     0     0 -167132.63    0   22 -166956.95 -167132.63  0.11%     -    0s
     0     0 -167117.36    0   20 -166956.95 -167117.36  0.10%     -    0s
     0     0 -167104.93    0   24 -166956.95 -167104.93  0.09%     -    0s
     0     0 -167087.18    0   21 -166956.95 -167087.18  0.08%     -    0s
     0     0 -167005.96    0    5 -166956.95 -167005.96  0.03%     -    0s
     0     0 -167001.45    0    7 -166956.95 -167001.45  0.03%     -    0s
H    0     0                    -166982.5785 -166982.58  0.00%     -    0s
     0     0          -    0      -166982.58 -166982.58  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 4
  Flow cover: 1
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (1013 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -166983 -166957 -166868 ... 6.92566e+06
No other solutions better than -166983

Optimal solution found (tolerance 1.00e-06)
Best objective -1.669825785247e+05, best bound -1.669825785247e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 213911.12
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166982.58
  [DEBUG]   S×d_nominal = 380893.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380893.70 + -166982.58 = 213911.12
  [DEBUG]   Current θ from Master = 225529.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11618.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44705.79
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 2996.8565, Absolute Gap = 2996.8565, Relative Gap = 0.053208
  Not converged yet (gap = 2996.86 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611047 nonzeros
Model fingerprint: 0xbfc3dc37
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89082 rows and 36162 columns
Presolve time: 2.38s
Presolved: 126361 rows, 53458 columns, 776185 nonzeros
Variable types: 51199 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.20s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.305e+06
 Factor NZ  : 1.197e+07 (roughly 170 MB of memory)
 Factor Ops : 2.502e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85315721e+07  2.52325051e+08  1.57e+05 1.57e+01  9.52e+04     5s
   1  -1.42821485e+07  2.36102788e+08  1.12e+05 1.00e+02  6.74e+04     5s
   2  -6.72718240e+06  1.89415227e+08  5.28e+04 3.52e+01  3.29e+04     5s
   3  -1.66109993e+06  1.44331957e+08  7.28e+03 3.12e+00  4.98e+03     5s
   4  -7.84688519e+05  7.76557853e+07  8.84e+02 4.06e-01  8.26e+02     5s
   5  -6.80594950e+05  4.29506240e+07  3.90e+02 1.77e-01  3.81e+02     5s
   6  -3.80394383e+05  2.82348867e+07  1.29e+02 1.04e-01  1.82e+02     5s
   7  -2.92025483e+05  2.15303250e+07  5.98e+01 7.60e-02  1.18e+02     5s
   8  -2.25689685e+05  1.45077222e+07  3.13e+01 4.79e-02  7.37e+01     5s
   9  -1.63258301e+05  1.11435623e+07  1.74e+01 3.59e-02  5.35e+01     5s
  10  -1.16540082e+05  6.04139291e+06  9.98e+00 1.79e-02  2.83e+01     5s
  11  -7.53414196e+04  1.52935011e+06  3.05e+00 3.92e-03  7.12e+00     6s
  12  -3.25612088e+04  6.28563808e+05  1.39e+00 1.64e-03  2.90e+00     6s
  13   3.40123678e+03  3.76257917e+05  7.54e-01 1.54e-03  1.63e+00     6s
  14   1.65991845e+04  2.88617765e+05  5.83e-01 2.41e-03  1.19e+00     6s
  15   1.75955314e+04  2.72994465e+05  5.72e-01 2.33e-03  1.12e+00     6s
  16   4.25691269e+04  1.97012404e+05  3.42e-01 2.09e-03  6.74e-01     6s
  17   5.06762473e+04  1.63239996e+05  2.78e-01 1.59e-03  4.91e-01     6s
  18   6.07959772e+04  1.40935493e+05  1.97e-01 1.91e-03  3.50e-01     6s
  19   6.66996509e+04  1.23708406e+05  1.56e-01 1.56e-03  2.49e-01     6s
  20   7.03058433e+04  1.21422447e+05  1.32e-01 1.38e-03  2.23e-01     6s
  21   7.50678728e+04  1.12804648e+05  1.03e-01 1.45e-03  1.65e-01     6s
  22   8.02905065e+04  1.06824271e+05  7.30e-02 2.41e-03  1.16e-01     6s
  23   8.32318254e+04  1.03921675e+05  5.83e-02 2.72e-03  9.03e-02     6s
  24   8.57918127e+04  1.01805321e+05  4.54e-02 2.14e-03  6.99e-02     6s
  25   8.82579798e+04  1.00374435e+05  3.35e-02 2.22e-03  5.29e-02     7s
  26   8.90067798e+04  9.94859987e+04  2.99e-02 1.79e-03  4.57e-02     7s
  27   9.00910156e+04  9.81440831e+04  2.44e-02 9.11e-04  3.52e-02     7s
  28   9.14354468e+04  9.75964905e+04  1.80e-02 7.44e-04  2.69e-02     7s
  29   9.16686647e+04  9.74966420e+04  1.69e-02 7.08e-04  2.54e-02     7s
  30   9.24967201e+04  9.71620602e+04  1.30e-02 5.87e-04  2.04e-02     7s
  31   9.31774979e+04  9.69736223e+04  9.93e-03 5.26e-04  1.66e-02     7s
  32   9.39998395e+04  9.65667492e+04  6.26e-03 3.74e-04  1.12e-02     7s
  33   9.45898573e+04  9.63617616e+04  3.81e-03 2.92e-04  7.72e-03     7s
  34   9.48229573e+04  9.61651334e+04  2.82e-03 2.23e-04  5.85e-03     7s
  35   9.50209595e+04  9.60730086e+04  1.99e-03 1.90e-04  4.58e-03     7s
  36   9.51885769e+04  9.59187397e+04  1.29e-03 1.35e-04  3.18e-03     8s
  37   9.53691227e+04  9.57736802e+04  5.85e-04 8.17e-05  1.76e-03     8s
  38   9.54782413e+04  9.56642408e+04  1.93e-04 4.35e-05  8.08e-04     8s
  39   9.54829265e+04  9.56302969e+04  1.78e-04 3.13e-05  6.40e-04     8s
  40   9.54924436e+04  9.56192079e+04  1.48e-04 2.74e-05  5.51e-04     8s
  41   9.55080374e+04  9.56052908e+04  9.92e-05 2.26e-05  4.22e-04     8s
  42   9.55090871e+04  9.55915447e+04  9.59e-05 1.78e-05  3.58e-04     8s
  43   9.55252978e+04  9.55689906e+04  4.20e-05 1.01e-05  1.90e-04     8s
  44   9.55334431e+04  9.55486614e+04  1.87e-05 2.84e-06  6.61e-05     8s
  45   9.55388593e+04  9.55424414e+04  2.67e-06 7.39e-07  1.55e-05     8s
  46   9.55396764e+04  9.55406319e+04  7.99e-07 1.71e-07  4.15e-06     8s
  47   9.55399500e+04  9.55402958e+04  1.71e-07 7.35e-08  1.50e-06     9s
  48   9.55399839e+04  9.55402245e+04  6.08e-07 1.25e-05  1.04e-06     9s
  49   9.55400340e+04  9.55400564e+04  6.50e-08 9.15e-07  9.72e-08     9s
  50   9.55400408e+04  9.55400409e+04  3.66e-09 1.30e-08  2.77e-10     9s

Barrier solved model in 50 iterations and 8.78 seconds (12.03 work units)
Optimal objective 9.55400408e+04


Root crossover log...

  113651 DPushes remaining with DInf 0.0000000e+00                 9s
   22865 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2207 PPushes remaining with PInf 1.7514025e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.6101702e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55753    9.5540041e+04   0.000000e+00   7.610170e+00     12s
   55762    9.5540041e+04   0.000000e+00   0.000000e+00     12s
   55762    9.5540041e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.554004e+04, 55762 iterations, 8.91 seconds (15.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95540.0409    0  173 -223925.25 95540.0409   143%     -   12s
H    0     0                    -103021.2344 95540.0409   193%     -   12s
H    0     0                    -59626.20871 95540.0409   260%     -   13s
H    0     0                    9843.4352158 95540.0409   871%     -   13s
H    0     0                    36650.307631 95540.0409   161%     -   13s
H    0     0                    42664.555397 95540.0409   124%     -   13s
H    0     0                    43654.885898 95540.0409   119%     -   14s
H    0     0                    43665.086152 95540.0409   119%     -   14s
H    0     0                    43720.457330 95540.0409   119%     -   14s
H    0     0                    44559.391267 87585.2513  96.6%     -   65s
H    0     0                    44584.680934 87585.2513  96.4%     -   65s
H    0     0                    44718.873500 87585.2513  95.9%     -   65s
H    0     0                    44856.297408 87585.2513  95.3%     -   65s
H    0     0                    44911.594988 87585.2513  95.0%     -   65s
H    0     0                    45054.441069 87585.2513  94.4%     -   65s
     0     0 87585.2513    0  242 45054.4411 87585.2513  94.4%     -   66s
     0     0 87202.8985    0  275 45054.4411 87202.8985  93.6%     -   92s
     0     0 87092.2186    0  262 45054.4411 87092.2186  93.3%     -   96s
     0     0 87051.7751    0  267 45054.4411 87051.7751  93.2%     -  101s
     0     0 87038.5738    0  265 45054.4411 87038.5738  93.2%     -  108s
     0     0 87038.5738    0  272 45054.4411 87038.5738  93.2%     -  110s
     0     0 87038.5738    0  280 45054.4411 87038.5738  93.2%     -  111s
H    0     0                    47932.249619 83413.4100  74.0%     -  186s
     0     0 83413.4100    0  319 47932.2496 83413.4100  74.0%     -  186s
H    0     0                    48276.988797 83413.3682  72.8%     -  187s
H    0     0                    48333.361934 83413.3682  72.6%     -  187s
     0     0 82797.6806    0  333 48333.3619 82797.6806  71.3%     -  222s
     0     0 82588.8898    0  329 48333.3619 82588.8898  70.9%     -  242s
     0     0 82361.5598    0  291 48333.3619 82361.5598  70.4%     -  261s
     0     0 82252.6904    0  380 48333.3619 82252.6904  70.2%     -  280s
     0     0 82229.4304    0  382 48333.3619 82229.4304  70.1%     -  289s
     0     0 82227.7752    0  342 48333.3619 82227.7752  70.1%     -  290s
     0     0 82223.4903    0  381 48333.3619 82223.4903  70.1%     -  295s
     0     0 82219.6553    0  315 48333.3619 82219.6553  70.1%     -  298s
     0     0 82217.3503    0  379 48333.3619 82217.3503  70.1%     -  300s
     0     0 82213.2977    0  322 48333.3619 82213.2977  70.1%     -  303s
     0     0 82201.6947    0  323 48333.3619 82201.6947  70.1%     -  306s
     0     0 82201.2402    0  347 48333.3619 82201.2402  70.1%     -  307s
H    0     0                    48639.634011 80702.5436  65.9%     -  400s
H    0     0                    48665.382972 80702.5436  65.8%     -  400s
H    0     0                    48684.928238 80702.5436  65.8%     -  400s
     0     0 80702.5436    0  340 48684.9282 80702.5436  65.8%     -  401s
H    0     0                    49573.785993 80235.0863  61.8%     -  432s
H    0     0                    50273.077739 80235.0863  59.6%     -  432s
H    0     0                    50326.822158 80235.0863  59.4%     -  432s
H    0     0                    50341.453513 80235.0863  59.4%     -  432s
H    0     0                    50404.915976 80235.0863  59.2%     -  432s
H    0     0                    50452.571866 80235.0863  59.0%     -  432s
H    0     0                    50691.043698 80235.0863  58.3%     -  432s
H    0     0                    51068.850487 80235.0863  57.1%     -  432s
H    0     0                    51430.470600 80235.0863  56.0%     -  432s
     0     0 80235.0863    0  400 51430.4706 80235.0863  56.0%     -  432s
     0     0 80076.4810    0  385 51430.4706 80076.4810  55.7%     -  455s
     0     0 79947.3313    0  418 51430.4706 79947.3313  55.4%     -  470s
     0     0 79868.5327    0  390 51430.4706 79868.5327  55.3%     -  483s
     0     0 79811.3569    0  379 51430.4706 79811.3569  55.2%     -  494s
     0     0 79780.1484    0  395 51430.4706 79780.1484  55.1%     -  499s
     0     0 79757.7547    0  388 51430.4706 79757.7547  55.1%     -  503s
     0     0 79750.3363    0  384 51430.4706 79750.3363  55.1%     -  506s
H    0     0                    51545.646340 79744.9542  54.7%     -  509s
     0     0 79744.9542    0  387 51545.6463 79744.9542  54.7%     -  509s
     0     0 79726.8278    0  400 51545.6463 79726.8278  54.7%     -  513s
     0     0 79717.5293    0  397 51545.6463 79717.5293  54.7%     -  516s
     0     0 79716.0829    0  397 51545.6463 79716.0829  54.7%     -  517s
H    0     0                    51557.221414 79716.0829  54.6%     -  533s
H    0     0                    51612.178760 79716.0829  54.5%     -  533s
H    0     0                    51742.485879 79716.0829  54.1%     -  533s
H    0     0                    51888.776508 79716.0829  53.6%     -  533s
H    0     0                    52023.425069 79716.0829  53.2%     -  533s
     0     0 78671.0872    0  378 52023.4251 78671.0872  51.2%     -  571s
     0     0 78256.2155    0  415 52023.4251 78256.2155  50.4%     -  600s
     0     0 78134.2852    0  420 52023.4251 78134.2852  50.2%     -  614s
     0     0 78062.2703    0  419 52023.4251 78062.2703  50.1%     -  627s
     0     0 78028.4800    0  415 52023.4251 78028.4800  50.0%     -  634s
     0     0 78018.2367    0  425 52023.4251 78018.2367  50.0%     -  640s
     0     0 78011.5305    0  423 52023.4251 78011.5305  50.0%     -  642s
     0     0 78004.3502    0  428 52023.4251 78004.3502  49.9%     -  645s
     0     0 78002.1097    0  425 52023.4251 78002.1097  49.9%     -  647s
     0     0 77816.6173    0  446 52023.4251 77816.6173  49.6%     -  663s
     0     0 77736.0131    0  400 52023.4251 77736.0131  49.4%     -  679s
     0     0 77716.1591    0  418 52023.4251 77716.1591  49.4%     -  684s
H    0     0                    52248.840595 77691.1899  48.7%     -  690s
H    0     0                    52338.096868 77691.1899  48.4%     -  690s
     0     0 77691.1899    0  413 52338.0969 77691.1899  48.4%     -  690s
     0     0 77682.8112    0  370 52338.0969 77682.8112  48.4%     -  695s
     0     0 77680.4657    0  414 52338.0969 77680.4657  48.4%     -  697s
     0     0 77618.2405    0  463 52338.0969 77618.2405  48.3%     -  711s
     0     0 77518.6193    0  473 52338.0969 77518.6193  48.1%     -  725s
     0     0 77493.5093    0  476 52338.0969 77493.5093  48.1%     -  733s
     0     0 77478.0404    0  481 52338.0969 77478.0404  48.0%     -  739s
     0     0 77476.5073    0  474 52338.0969 77476.5073  48.0%     -  741s
     0     0 77418.4681    0  458 52338.0969 77418.4681  47.9%     -  754s
     0     0 77399.3565    0  421 52338.0969 77399.3565  47.9%     -  759s
     0     0 77389.4041    0  369 52338.0969 77389.4041  47.9%     -  763s
     0     0 77384.5944    0  376 52338.0969 77384.5944  47.9%     -  764s
     0     0 77382.8488    0  377 52338.0969 77382.8488  47.9%     -  765s
H    0     0                    52719.492642 77350.4763  46.7%     -  772s
     0     0 77350.4763    0  452 52719.4926 77350.4763  46.7%     -  772s
     0     0 77342.9721    0  456 52719.4926 77342.9721  46.7%     -  776s
     0     0 77341.1159    0  464 52719.4926 77341.1159  46.7%     -  778s
     0     0 77321.7530    0  350 52719.4926 77321.7530  46.7%     -  785s
H    0     0                    52729.760694 77321.3367  46.6%     -  785s
     0     0 77316.7140    0  365 52729.7607 77316.7140  46.6%     -  790s
     0     0 77314.9502    0  350 52729.7607 77314.9502  46.6%     -  791s
     0     0 77295.2803    0  410 52729.7607 77295.2803  46.6%     -  798s
     0     0 77290.9985    0  420 52729.7607 77290.9985  46.6%     -  801s
     0     0 77289.1482    0  420 52729.7607 77289.1482  46.6%     -  802s
     0     0 77287.0242    0  431 52729.7607 77287.0242  46.6%     -  805s
     0     0 77285.8831    0  431 52729.7607 77285.8831  46.6%     -  807s
H    0     0                    52945.500867 77285.8831  46.0%     -  962s
     0     2 77285.8831    0  431 52945.5009 77285.8831  46.0%     -  964s
     1     3 77083.4465    1  410 52945.5009 77285.3732  46.0% 13601  980s
     2     4 77207.3417    1  419 52945.5009 77207.3417  45.8%  9911  990s
     3     8 77032.0593    2  405 52945.5009 77207.3144  45.8% 10369 1003s
     7    13 76370.4541    3  393 52945.5009 77125.5592  45.7%  9802 1043s
    12    22 75822.8228    4  403 52945.5009 77125.5592  45.7% 14634 1081s
    21    31 74359.4701    5  381 52945.5009 76724.2747  44.9% 19251 1145s
    30    58 73203.9512    5  422 52945.5009 76724.2747  44.9% 18287 1339s
H   35    58                    53179.889331 76724.2747  44.3% 17703 1339s
H   36    58                    54093.293682 76724.2747  41.8% 17526 1339s
H   40    58                    55759.290841 76724.2747  37.6% 17622 1339s
    57    90 73148.2018    6  392 55759.2908 76724.2747  37.6% 26896 1358s
    89   149 73008.8166    7  381 55759.2908 76724.2747  37.6% 21505 1405s
   148   233 72720.6487    9  402 55759.2908 76724.2747  37.6% 16862 1450s
   232   286 71318.8614   14  314 55759.2908 76724.2747  37.6% 12984 1486s
H  236   286                    55931.820484 76724.2747  37.2% 12826 1486s
   285   322 70599.4107   15  312 55931.8205 76724.2747  37.2% 11761 1514s
H  286   322                    56054.649814 76724.2747  36.9% 11719 1514s
H  288   322                    56399.949100 76724.2747  36.0% 11679 1514s
   321   372 70423.2063   16  342 56399.9491 76724.2747  36.0% 11551 1551s
   371   428 70395.0276   17  343 56399.9491 76724.2747  36.0% 10732 1582s
   427   477 70297.0296   18  366 56399.9491 76724.2747  36.0% 10082 1611s
   476   505 70173.7355   19  331 56399.9491 76724.2747  36.0%  9777 1655s
   504   563 69965.1414   20  338 56399.9491 76724.2747  36.0%  9822 1684s
   562   630 69791.3427   21  336 56399.9491 76724.2747  36.0%  9956 1716s
   629   664 68844.8620   23  323 56399.9491 76724.2747  36.0%  9962 1741s
H  630   664                    56415.531184 76724.2747  36.0%  9946 1741s
   663   720 68727.1783   24  331 56415.5312 76724.2747  36.0%  9928 1765s
   719   749 68339.8264   25  331 56415.5312 76724.2747  36.0%  9913 1788s
   748   786 68283.5761   26  286 56415.5312 76724.2747  36.0%  9945 1811s
   785   815 71077.5256   37  273 56415.5312 76724.2747  36.0%  9898 1832s
   814   847 68181.8087   26  282 56415.5312 76724.2747  36.0%  9891 1851s
   846   875 70903.5131   39  271 56415.5312 76724.2747  36.0%  9869 1873s
   874   906 72826.6512   16  352 56415.5312 76724.2747  36.0%  9916 1897s
   905   948 72727.3232   17  331 56415.5312 76724.2747  36.0%  9921 1922s
   947   982 72566.5154   19  317 56415.5312 76724.2747  36.0%  9880 1941s
   981  1025 72343.1422   20  324 56415.5312 76724.2747  36.0%  9848 1962s
  1024  1056 72072.4158   22  279 56415.5312 76724.2747  36.0%  9797 1986s
  1055  1093 71086.0554   23  292 56415.5312 76724.2747  36.0%  9817 2012s
  1092  1140 70956.3467   24  293 56415.5312 76724.2747  36.0%  9840 2040s
  1147  1187 69683.7832   25  245 56415.5312 76724.2747  36.0%  9913 2073s
  1206  1259 69239.3196   26  245 56415.5312 76724.2747  36.0% 10070 2107s
  1284  1330 68783.8852   27  246 56415.5312 76724.2747  36.0% 10045 2143s
  1381  1400 58010.3608   29  219 56415.5312 76724.2747  36.0% 10006 2190s
  1479  1509 57464.0347   33  224 56415.5312 76724.2747  36.0%  9982 2235s
  1622  1629 infeasible   38      56415.5312 76724.2747  36.0%  9764 2283s
  1768  1747 57537.9871   58  200 56415.5312 76724.2747  36.0%  9563 2331s
  1928  1807 60098.6272   28  227 56415.5312 76724.2747  36.0%  9277 2377s
  2087  1893 58148.4426   35  208 56415.5312 76724.2747  36.0%  9151 2428s
  2209  1962 infeasible   48      56415.5312 76724.2747  36.0%  9188 2476s
  2322  2024 74781.2911    8  403 56415.5312 76724.2747  36.0%  9296 2526s
  2404  2055 73351.8512    9  416 56415.5312 76587.9951  35.8%  9498 2579s
  2437  2085 73201.6308   10  392 56415.5312 76535.7147  35.7%  9713 2629s
  2473  2115 67743.4925   10  364 56415.5312 76535.7147  35.7%  9876 2676s
  2505  2146 73713.1469    9  374 56415.5312 76535.7147  35.7% 10064 2722s
  2544  2176 72006.0173   10  343 56415.5312 76535.7147  35.7% 10210 2768s
  2586  2223 72285.2266   11  384 56415.5312 76535.7147  35.7% 10317 2820s
  2637  2271 61990.7225   23  194 56415.5312 76535.7147  35.7% 10401 2866s
  2705  2336 70011.0571   11  329 56415.5312 76535.7147  35.7% 10448 2922s
  2784  2398 71389.6456   11  353 56415.5312 76535.7147  35.7% 10483 2978s
  2884  2431 68507.7107   12  334 56415.5312 76535.7147  35.7% 10463 3035s
  2951  2479 68044.0113   13  326 56415.5312 76535.7147  35.7% 10537 3100s
  3033  2543 65786.9635   12  273 56415.5312 76535.7147  35.7% 10641 3171s
  3135  2615     cutoff   13      56415.5312 76535.7147  35.7% 10783 3246s
  3237  2697 71881.0598   12  402 56415.5312 76535.7147  35.7% 11007 3320s
  3377  2809 65748.3289   13  289 56415.5312 76535.7147  35.7% 11160 3398s
  3553  2894 69362.7495   12  344 56415.5312 76535.7147  35.7% 11235 3487s
  3734  2961 63493.2536   14  309 56415.5312 76535.7147  35.7% 11337 3580s
  3877  2980 59864.1629   19  133 56415.5312 76535.7147  35.7% 11525 3600s

Cutting planes:
  Learned: 3
  Gomory: 19
  Implied bound: 202
  MIR: 3371
  Flow cover: 3148
  RLT: 61
  Relax-and-lift: 619

Explored 3916 nodes (45536519 simplex iterations) in 3600.06 seconds (9392.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 56415.5 56399.9 56054.6 ... 52719.5

Time limit reached
Best objective 5.641553118420e+04, best bound 7.653571467610e+04, gap 35.6643%
  WARNING: Time limit reached. Using best solution found (gap: 35.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 56415.53, θ = 227875.40
  Upper Bound (UB) = 56415.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227875.40
  [DEBUG]   ✓ Scenario 0: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227875.40 ≤ Q = 227875.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227875.40 ≤ Q = 227875.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227875.40 ≤ Q = 227875.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3285c058
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3285c058
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402804e+13
Presolve removed 2562 rows and 1852 columns
Presolve time: 0.00s
Presolved: 531 rows, 537 columns, 1502 nonzeros
Found heuristic solution: objective 7065375.4982
Variable types: 364 continuous, 173 integer (173 binary)

Root relaxation: objective -1.848030e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -184802.98    0  122 7065375.50 -184802.98   103%     -    0s
H    0     0                    -148701.5439 -184802.98  24.3%     -    0s
     0     0 -163055.31    0   95 -148701.54 -163055.31  9.65%     -    0s
H    0     0                    -159773.6804 -162956.01  1.99%     -    0s
H    0     0                    -160101.1711 -162956.01  1.78%     -    0s
H    0     0                    -160856.2394 -162956.01  1.31%     -    0s
H    0     0                    -161153.8057 -162956.01  1.12%     -    0s
     0     0 -161890.29    0   70 -161153.81 -161890.29  0.46%     -    0s
     0     0 -161875.40    0   60 -161153.81 -161875.40  0.45%     -    0s
H    0     0                    -161491.9919 -161875.40  0.24%     -    0s
     0     0 -161813.82    0   54 -161491.99 -161813.82  0.20%     -    0s
     0     0 -161783.90    0   52 -161491.99 -161783.90  0.18%     -    0s
     0     0 -161782.23    0   52 -161491.99 -161782.23  0.18%     -    0s
     0     0 -161720.99    0   26 -161491.99 -161720.99  0.14%     -    0s
     0     0 -161718.63    0   50 -161491.99 -161718.63  0.14%     -    0s
     0     0 -161713.63    0   26 -161491.99 -161713.63  0.14%     -    0s
     0     0 -161712.03    0   26 -161491.99 -161712.03  0.14%     -    0s
H    0     0                    -161685.2303 -161712.03  0.02%     -    0s
H    0     0                    -161685.3080 -161712.03  0.02%     -    0s
     0     0 -161708.49    0   44 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   44 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   26 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   19 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   19 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   19 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161708.49    0   18 -161685.31 -161708.49  0.01%     -    0s
     0     0 -161685.31    0   15 -161685.31 -161685.31  0.00%     -    0s

Cutting planes:
  Gomory: 16
  Implied bound: 5
  MIR: 43
  Flow cover: 1

Explored 1 nodes (839 simplex iterations) in 0.10 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -161685 -161492 -161154 ... 1.4028e+13
No other solutions better than -161685

Optimal solution found (tolerance 1.00e-06)
Best objective -1.616853080214e+05, best bound -1.616853080214e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 218075.80
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -161685.31
  [DEBUG]   S×d_nominal = 379761.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379761.10 + -161685.31 = 218075.80
  [DEBUG]   Current θ from Master = 227875.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9799.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46615.93
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 3088.5839, Absolute Gap = 3088.5839, Relative Gap = 0.054747
  Not converged yet (gap = 3088.58 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654299 nonzeros
Model fingerprint: 0x5ece6c24
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 95445 rows and 38745 columns
Presolve time: 2.59s
Presolved: 135288 rows, 57115 columns, 831380 nonzeros
Variable types: 54856 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.995e+06
 Factor NZ  : 1.379e+07 (roughly 200 MB of memory)
 Factor Ops : 3.139e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89143764e+07  2.67743532e+08  1.60e+05 1.52e+01  9.67e+04     4s
   1  -1.46369784e+07  2.51228146e+08  1.15e+05 1.00e+02  6.86e+04     4s
   2  -5.56194068e+06  2.01124617e+08  4.35e+04 3.64e+01  2.72e+04     4s
   3  -1.75537695e+06  1.51963058e+08  8.30e+03 1.80e+00  5.55e+03     5s
   4  -7.79401871e+05  8.78858694e+07  1.08e+03 4.40e-01  9.56e+02     5s
   5  -6.55244770e+05  4.03024565e+07  4.61e+02 1.40e-01  3.88e+02     5s
   6  -4.00355113e+05  2.93255348e+07  1.61e+02 9.42e-02  1.93e+02     5s
   7  -2.83551366e+05  2.15564219e+07  6.62e+01 6.47e-02  1.15e+02     5s
   8  -1.92459322e+05  1.57200259e+07  3.10e+01 4.44e-02  7.48e+01     5s
   9  -1.63649800e+05  1.13175047e+07  2.24e+01 3.08e-02  5.23e+01     5s
  10  -1.19492562e+05  6.25048222e+06  1.30e+01 1.54e-02  2.80e+01     5s
  11  -8.08165433e+04  2.53581465e+06  4.40e+00 5.51e-03  1.09e+01     5s
  12  -4.37745156e+04  6.30740188e+05  1.75e+00 1.27e-03  2.78e+00     5s
  13  -2.12313614e+03  3.40482177e+05  8.69e-01 8.79e-04  1.40e+00     5s
  14   1.69352930e+04  2.64338460e+05  6.22e-01 1.52e-03  1.01e+00     5s
  15   3.02431117e+04  2.17681971e+05  4.91e-01 1.83e-03  7.65e-01     5s
  16   4.09968391e+04  1.81083849e+05  3.96e-01 1.42e-03  5.72e-01     5s
  17   4.70358637e+04  1.65478478e+05  3.47e-01 1.05e-03  4.84e-01     5s
  18   5.41932748e+04  1.36443210e+05  2.88e-01 1.89e-03  3.36e-01     6s
  19   6.25580128e+04  1.30272908e+05  2.24e-01 1.89e-03  2.77e-01     6s
  20   6.49547713e+04  1.26152177e+05  2.05e-01 1.68e-03  2.50e-01     6s
  21   6.70143507e+04  1.20845717e+05  1.89e-01 1.68e-03  2.20e-01     6s
  22   6.87628009e+04  1.18470108e+05  1.75e-01 1.49e-03  2.03e-01     6s
  23   7.22684832e+04  1.13440102e+05  1.49e-01 2.24e-03  1.68e-01     6s
  24   7.68144337e+04  1.08597748e+05  1.16e-01 1.73e-03  1.30e-01     6s
  25   8.15565282e+04  1.05505479e+05  8.32e-02 1.49e-03  9.79e-02     6s
  26   8.38613847e+04  1.03483178e+05  6.82e-02 1.52e-03  8.02e-02     6s
  27   8.63164101e+04  1.01637953e+05  5.30e-02 1.07e-03  6.26e-02     6s
  28   8.72990363e+04  1.00955159e+05  4.69e-02 9.21e-04  5.58e-02     6s
  29   8.87664116e+04  9.94251087e+04  3.82e-02 7.21e-04  4.36e-02     6s
  30   8.97445835e+04  9.86682028e+04  3.24e-02 9.74e-04  3.65e-02     6s
  31   9.01252619e+04  9.80843436e+04  3.01e-02 1.18e-03  3.26e-02     6s
  32   9.06314435e+04  9.80034525e+04  2.71e-02 1.13e-03  3.01e-02     7s
  33   9.09489128e+04  9.78050180e+04  2.53e-02 1.09e-03  2.80e-02     7s
  34   9.22504413e+04  9.72254864e+04  1.76e-02 9.29e-04  2.03e-02     7s
  35   9.29019450e+04  9.66798799e+04  1.38e-02 7.04e-04  1.54e-02     7s
  36   9.37502318e+04  9.65709717e+04  9.29e-03 6.34e-04  1.15e-02     7s
  37   9.40473274e+04  9.62466925e+04  7.65e-03 4.38e-04  8.99e-03     7s
  38   9.42656306e+04  9.60044945e+04  6.47e-03 3.42e-04  7.11e-03     7s
  39   9.47048825e+04  9.58538218e+04  4.13e-03 2.45e-04  4.70e-03     7s
  40   9.50541341e+04  9.57987268e+04  2.38e-03 2.02e-04  3.04e-03     7s
  41   9.51996641e+04  9.56941308e+04  1.59e-03 1.09e-04  2.02e-03     7s
  42   9.53002036e+04  9.56438756e+04  1.07e-03 6.01e-05  1.40e-03     7s
  43   9.53124861e+04  9.56114366e+04  1.01e-03 4.39e-05  1.22e-03     7s
  44   9.53597071e+04  9.56006139e+04  7.86e-04 3.82e-05  9.84e-04     8s
  45   9.54102740e+04  9.55823177e+04  5.34e-04 2.87e-05  7.02e-04     8s
  46   9.54506485e+04  9.55565525e+04  3.45e-04 2.09e-05  4.33e-04     8s
  47   9.54783570e+04  9.55502199e+04  2.11e-04 1.66e-05  2.93e-04     8s
  48   9.54894282e+04  9.55452201e+04  1.56e-04 1.33e-05  2.28e-04     8s
  49   9.54927757e+04  9.55417367e+04  1.42e-04 1.09e-05  2.00e-04     8s
  50   9.55002474e+04  9.55383807e+04  1.07e-04 8.64e-06  1.56e-04     8s
  51   9.55139933e+04  9.55332904e+04  4.46e-05 4.89e-06  7.86e-05     8s
  52   9.55189216e+04  9.55298445e+04  2.40e-05 2.89e-06  4.45e-05     8s
  53   9.55206424e+04  9.55282253e+04  1.69e-05 1.95e-06  3.09e-05     8s
  54   9.55221740e+04  9.55250999e+04  1.06e-05 1.35e-07  1.20e-05     8s
  55   9.55245642e+04  9.55247910e+04  8.15e-07 2.94e-09  9.27e-07     9s
  56   9.55246414e+04  9.55247784e+04  5.11e-07 8.67e-10  5.61e-07     9s
  57   9.55246427e+04  9.55247779e+04  5.16e-07 1.05e-09  5.53e-07     9s
  58   9.55246444e+04  9.55247773e+04  1.15e-05 8.79e-08  5.41e-07     9s
  59   9.55246550e+04  9.55247772e+04  2.10e-05 8.18e-08  5.03e-07     9s
  60   9.55246661e+04  9.55247771e+04  2.14e-05 1.20e-07  4.57e-07     9s
  61   9.55246695e+04  9.55247770e+04  2.63e-05 1.23e-07  4.36e-07     9s
  62   9.55246723e+04  9.55247770e+04  3.94e-05 1.15e-07  4.18e-07     9s
  63   9.55246725e+04  9.55247770e+04  3.94e-05 1.14e-07  4.17e-07     9s
  64   9.55247149e+04  9.55247826e+04  5.87e-05 2.45e-07  3.01e-07     9s
  65   9.55247744e+04  9.55247755e+04  1.03e-06 1.08e-08  5.03e-09    10s
  66   9.55247747e+04  9.55247755e+04  1.80e-06 1.40e-08  4.34e-09    10s

Barrier solved model in 66 iterations and 9.59 seconds (14.91 work units)
Optimal objective 9.55247747e+04


Root crossover log...

  121813 DPushes remaining with DInf 0.0000000e+00                10s
   59887 DPushes remaining with DInf 0.0000000e+00                10s
    1708 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   31379 PPushes remaining with PInf 1.0325659e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8274714e+03     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   99526    9.5524774e+04   0.000000e+00   7.827471e+03     19s
   99958    9.5524775e+04   0.000000e+00   0.000000e+00     19s
   99958    9.5524775e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 2.69s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 9.552478e+04, 99958 iterations, 18.78 seconds (35.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95524.7755    0  173 -223925.25 95524.7755   143%     -   22s
H    0     0                    -174959.4291 95524.7755   155%     -   23s
H    0     0                    -174460.4584 95524.7755   155%     -   23s
H    0     0                    -59626.20871 95524.7755   260%     -   23s
H    0     0                    -59471.21428 95524.7755   261%     -   23s
H    0     0                    32016.014367 95524.7755   198%     -   23s
H    0     0                    42434.708093 95524.7755   125%     -   25s
     0     0 87689.8042    0  239 42434.7081 87689.8042   107%     -   91s
     0     0 87301.0048    0  230 42434.7081 87301.0048   106%     -  121s
     0     0 87276.1253    0  259 42434.7081 87276.1253   106%     -  130s
     0     0 87166.9038    0  256 42434.7081 87166.9038   105%     -  150s
     0     0 87023.5250    0  258 42434.7081 87023.5250   105%     -  163s
     0     0 86974.9871    0  270 42434.7081 86974.9871   105%     -  170s
     0     0 86963.7637    0  264 42434.7081 86963.7637   105%     -  174s
     0     0 86962.3395    0  268 42434.7081 86962.3395   105%     -  175s
     0     0 86962.3236    0  268 42434.7081 86962.3236   105%     -  175s
     0     0 83608.5604    0  320 42434.7081 83608.5604  97.0%     -  243s
H    0     0                    48305.348213 83608.5602  73.1%     -  244s
H    0     0                    48639.634011 83608.5602  71.9%     -  244s
     0     0 83037.2891    0  316 48639.6340 83037.2891  70.7%     -  276s
     0     0 82933.5505    0  313 48639.6340 82933.5505  70.5%     -  293s
     0     0 82772.5495    0  319 48639.6340 82772.5495  70.2%     -  311s
     0     0 82696.9805    0  303 48639.6340 82696.9805  70.0%     -  321s
     0     0 82674.6295    0  304 48639.6340 82674.6295  70.0%     -  330s
     0     0 82672.5441    0  364 48639.6340 82672.5441  70.0%     -  333s
     0     0 82658.0334    0  372 48639.6340 82658.0334  69.9%     -  339s
     0     0 82646.2795    0  308 48639.6340 82646.2795  69.9%     -  344s
     0     0 82631.0395    0  346 48639.6340 82631.0395  69.9%     -  350s
     0     0 82614.7695    0  344 48639.6340 82614.7695  69.9%     -  355s
     0     0 82611.0854    0  343 48639.6340 82611.0854  69.8%     -  356s
     0     0 82610.9848    0  342 48639.6340 82610.9848  69.8%     -  357s
     0     0 80683.1603    0  329 48639.6340 80683.1603  65.9%     -  433s
     0     0 80212.8057    0  397 48639.6340 80212.8057  64.9%     -  469s
     0     0 80083.7506    0  411 48639.6340 80083.7506  64.6%     -  488s
     0     0 80045.9253    0  417 48639.6340 80045.9253  64.6%     -  497s
     0     0 80026.6973    0  420 48639.6340 80026.6973  64.5%     -  501s
     0     0 79982.5010    0  430 48639.6340 79982.5010  64.4%     -  510s
     0     0 79938.3561    0  421 48639.6340 79938.3561  64.3%     -  520s
     0     0 79925.1704    0  415 48639.6340 79925.1704  64.3%     -  525s
     0     0 79920.6236    0  412 48639.6340 79920.6236  64.3%     -  529s
     0     0 79918.0780    0  417 48639.6340 79918.0780  64.3%     -  531s
     0     0 79917.4501    0  423 48639.6340 79917.4501  64.3%     -  532s
     0     0 79106.1561    0  366 48639.6340 79106.1561  62.6%     -  581s
     0     0 78839.7673    0  386 48639.6340 78839.7673  62.1%     -  604s
     0     0 78690.4328    0  397 48639.6340 78690.4328  61.8%     -  622s
     0     0 78651.2931    0  399 48639.6340 78651.2931  61.7%     -  634s
     0     0 78632.5668    0  390 48639.6340 78632.5668  61.7%     -  640s
     0     0 78612.7282    0  396 48639.6340 78612.7282  61.6%     -  647s
     0     0 78590.4622    0  394 48639.6340 78590.4622  61.6%     -  655s
     0     0 78559.1349    0  400 48639.6340 78559.1349  61.5%     -  663s
     0     0 78541.9248    0  402 48639.6340 78541.9248  61.5%     -  672s
     0     0 78527.2706    0  404 48639.6340 78527.2706  61.4%     -  678s
     0     0 78524.2417    0  405 48639.6340 78524.2417  61.4%     -  682s
     0     0 78522.0949    0  398 48639.6340 78522.0949  61.4%     -  685s
     0     0 78324.0057    0  403 48639.6340 78324.0057  61.0%     -  706s
     0     0 78258.3494    0  420 48639.6340 78258.3494  60.9%     -  721s
     0     0 78210.3849    0  415 48639.6340 78210.3849  60.8%     -  734s
     0     0 78181.4063    0  430 48639.6340 78181.4063  60.7%     -  744s
     0     0 78175.8519    0  422 48639.6340 78175.8519  60.7%     -  749s
     0     0 78172.7895    0  418 48639.6340 78172.7895  60.7%     -  753s
     0     0 78170.6075    0  435 48639.6340 78170.6075  60.7%     -  757s
     0     0 77853.0867    0  404 48639.6340 77853.0867  60.1%     -  779s
     0     0 77797.0525    0  412 48639.6340 77797.0525  59.9%     -  792s
     0     0 77760.6484    0  449 48639.6340 77760.6484  59.9%     -  808s
     0     0 77740.2431    0  456 48639.6340 77740.2431  59.8%     -  814s
     0     0 77737.7462    0  417 48639.6340 77737.7462  59.8%     -  819s
     0     0 77634.9313    0  448 48639.6340 77634.9313  59.6%     -  832s
     0     0 77594.9773    0  450 48639.6340 77594.9773  59.5%     -  842s
     0     0 77584.2853    0  497 48639.6340 77584.2853  59.5%     -  848s
     0     0 77580.2662    0  460 48639.6340 77580.2662  59.5%     -  851s
     0     0 77579.1908    0  457 48639.6340 77579.1908  59.5%     -  853s
     0     0 77539.4050    0  405 48639.6340 77539.4050  59.4%     -  861s
     0     0 77522.4489    0  468 48639.6340 77522.4489  59.4%     -  868s
     0     0 77515.4461    0  475 48639.6340 77515.4461  59.4%     -  872s
     0     0 77508.0710    0  465 48639.6340 77508.0710  59.4%     -  876s
     0     0 77504.9839    0  470 48639.6340 77504.9839  59.3%     -  878s
     0     0 77503.8697    0  466 48639.6340 77503.8697  59.3%     -  879s
     0     0 77442.9827    0  424 48639.6340 77442.9827  59.2%     -  891s
     0     0 77427.3994    0  460 48639.6340 77427.3994  59.2%     -  897s
     0     0 77378.9105    0  435 48639.6340 77378.9105  59.1%     -  908s
     0     0 77364.9896    0  434 48639.6340 77364.9896  59.1%     -  915s
     0     0 77361.5429    0  419 48639.6340 77361.5429  59.1%     -  918s
     0     0 77357.7061    0  477 48639.6340 77357.7061  59.0%     -  921s
     0     0 77356.6788    0  479 48639.6340 77356.6788  59.0%     -  922s
     0     0 77340.3509    0  440 48639.6340 77340.3509  59.0%     -  930s
     0     0 77339.4179    0  436 48639.6340 77339.4179  59.0%     -  933s
     0     0 77329.8562    0  469 48639.6340 77329.8562  59.0%     -  940s
     0     0 77325.3907    0  462 48639.6340 77325.3907  59.0%     -  945s
     0     0 77324.5248    0  463 48639.6340 77324.5248  59.0%     -  947s
     0     0 77320.2007    0  475 48639.6340 77320.2007  59.0%     -  951s
     0     0 77320.1580    0  475 48639.6340 77320.1580  59.0%     -  954s
H    0     2                    48639.770473 77320.1580  59.0%     - 1161s
     0     2 77320.1580    0  475 48639.7705 77320.1580  59.0%     - 1161s
     1     4 77227.5730    1  426 48639.7705 77319.9624  59.0%  8465 1183s
     3     7 77137.6889    2  423 48639.7705 77227.5406  58.8%  9619 1207s
     6    12 76821.4105    3  397 48639.7705 77137.4933  58.6% 11486 1233s
    11    24 76459.5672    4  406 48639.7705 77137.4933  58.6% 13086 1265s
    23    36 76064.9444    4  432 48639.7705 76779.1180  57.9% 17433 1356s
H   35    66                    50768.018662 76779.1180  51.2% 17513 1560s
H   37    66                    51014.651634 76779.1180  50.5% 17524 1560s
    65   144 74890.7897    6  383 51014.6516 76597.3406  50.1% 25470 1688s
   143   176 74638.0301    9  366 51014.6516 76404.0952  49.8% 17502 1729s
H  146   176                    51200.811379 76404.0952  49.2% 17374 1729s
H  152   176                    51509.662101 76404.0952  48.3% 17167 1729s
H  173   176                    52020.935764 76404.0480  46.9% 16797 1729s
   175   263 74574.3652   10  372 52020.9358 76404.0480  46.9% 16760 1794s
H  262   354                    52458.975710 76404.0480  45.6% 13706 1842s
H  267   354                    52706.411025 76404.0480  45.0% 13546 1842s
   353   428 73755.7342   16  355 52706.4110 76404.0480  45.0% 11647 1883s
   427   459 72723.9409   19  313 52706.4110 76404.0480  45.0% 10723 1916s
   458   490 72154.4775   20  300 52706.4110 76404.0480  45.0% 10613 1963s
   489   515 72153.7638   21  293 52706.4110 76404.0480  45.0% 10532 1998s
   514   544 72131.2758   22  292 52706.4110 76404.0480  45.0% 10473 2031s
   543   573 72129.5231   23  290 52706.4110 76404.0480  45.0% 10478 2060s
   572   601 71910.9032   24  316 52706.4110 76404.0480  45.0% 10499 2092s
H  588   601                    53240.147032 76404.0480  43.5% 10546 2092s
   600   667 71895.2983   25  322 53240.1470 76404.0480  43.5% 10603 2130s
   666   722 71738.2794   28  282 53240.1470 76404.0480  43.5% 10496 2169s
   721   765 71531.9763   32  321 53240.1470 76404.0480  43.5% 10489 2210s
   764   817 70489.2659   33  283 53240.1470 76404.0480  43.5% 10575 2245s
   816   882 70409.0342   34  271 53240.1470 76404.0480  43.5% 10851 2283s
   881   959 70224.7902   36  267 53240.1470 76404.0480  43.5% 10826 2318s
   958  1053 70076.6095   38  250 53240.1470 76404.0480  43.5% 10663 2362s
  1052  1154 69905.5804   39  251 53240.1470 76404.0480  43.5% 10473 2398s
  1153  1271 69692.0510   42  249 53240.1470 76404.0480  43.5% 10369 2430s
  1270  1403 68572.4296   44  253 53240.1470 76404.0480  43.5% 10116 2462s
  1402  1556 68185.4974   47  251 53240.1470 76404.0480  43.5%  9780 2497s
  1561  1610 67313.0843   51  244 53240.1470 76404.0480  43.5%  9362 2527s
H 1563  1610                    53309.518614 76404.0480  43.3%  9358 2527s
H 1596  1610                    53604.562443 76404.0480  42.5%  9272 2527s
  1623  1741 66275.7046   52  194 53604.5624 76404.0480  42.5%  9237 2569s
  1768  1853 66069.0581   54  199 53604.5624 76404.0480  42.5%  9014 2609s
  1936  1959 61858.7267   58  191 53604.5624 76404.0480  42.5%  8743 2648s
H 2092  2033                    53773.969161 76404.0480  42.1%  8574 2699s
H 2099  2033                    53979.291924 76404.0480  41.5%  8577 2699s
H 2107  2033                    54024.018972 76404.0480  41.4%  8569 2699s
H 2136  2033                    54128.638255 76165.2164  40.7%  8537 2699s
H 2139  2032                    54339.801428 76165.2164  40.2%  8530 2699s
  2238  2068 59472.0607   42  263 54339.8014 76165.2164  40.2%  8400 2751s
  2389  2109 58323.4984   43  219 54339.8014 76165.2164  40.2%  8322 2808s
  2496  2170 55324.2285   45  234 54339.8014 76165.2164  40.2%  8318 2855s
  2645  2221 55119.2746   76  178 54339.8014 76165.2164  40.2%  8242 2911s
  2800  2255 60964.0119   54  195 54339.8014 76165.2164  40.2%  8217 2969s
  2928  2317 54660.1751   57   89 54339.8014 76165.2164  40.2%  8262 3033s
  3068  2389 infeasible   59      54339.8014 76165.2164  40.2%  8343 3097s
  3211  2442 72451.2974   14  349 54339.8014 76165.2164  40.2%  8415 3156s
  3306  2491 57567.0434   42  210 54339.8014 76165.2164  40.2%  8508 3228s
  3429  2562 67446.7908   15  364 54339.8014 75913.9918  39.7%  8592 3306s
  3544  2654 64836.6263   16  347 54339.8014 75913.9918  39.7%  8740 3384s
  3650  2748 63089.3012   17  268 54339.8014 75913.9918  39.7%  8913 3462s
  3786  2853 61635.6912   20  312 54339.8014 75913.9918  39.7%  9080 3539s

Cutting planes:
  Learned: 3
  Gomory: 25
  Implied bound: 171
  MIR: 3252
  Flow cover: 3325
  RLT: 53
  Relax-and-lift: 604

Explored 3921 nodes (37089792 simplex iterations) in 3600.10 seconds (8965.34 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54339.8 54128.6 54024 ... 52020.9

Time limit reached
Best objective 5.433980142835e+04, best bound 7.591399178187e+04, gap 39.7024%
  WARNING: Time limit reached. Using best solution found (gap: 39.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 54339.80, θ = 226833.60
  Upper Bound (UB) = 54339.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226833.60
  [DEBUG]   ✓ Scenario 0: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226833.60 ≤ Q = 226833.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 226833.60 ≤ Q = 226833.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 226833.60 ≤ Q = 226833.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 226833.60 ≤ Q = 226833.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1cd1eab1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1cd1eab1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.406935e+13
Presolve removed 2560 rows and 1850 columns
Presolve time: 0.00s
Presolved: 533 rows, 539 columns, 1505 nonzeros
Found heuristic solution: objective 6981495.2925
Variable types: 366 continuous, 173 integer (173 binary)

Root relaxation: objective -1.867514e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -186751.45    0  122 6981495.29 -186751.45   103%     -    0s
H    0     0                    -149740.7362 -186751.45  24.7%     -    0s
H    0     0                    -150572.3353 -186532.57  23.9%     -    0s
     0     0 -163548.21    0   93 -150572.34 -163548.21  8.62%     -    0s
H    0     0                    -158723.0249 -163430.76  2.97%     -    0s
H    0     0                    -160258.4269 -163430.76  1.98%     -    0s
H    0     0                    -160534.1202 -163430.76  1.80%     -    0s
     0     0 -162461.28    0   96 -160534.12 -162461.28  1.20%     -    0s
H    0     0                    -161014.6178 -162364.21  0.84%     -    0s
     0     0 -162121.38    0   94 -161014.62 -162121.38  0.69%     -    0s
     0     0 -162088.74    0   92 -161014.62 -162088.74  0.67%     -    0s
     0     0 -162085.17    0   92 -161014.62 -162085.17  0.66%     -    0s
     0     0 -161891.93    0  107 -161014.62 -161891.93  0.54%     -    0s
     0     0 -161865.06    0   90 -161014.62 -161865.06  0.53%     -    0s
     0     0 -161806.12    0   86 -161014.62 -161806.12  0.49%     -    0s
     0     0 -161719.51    0  106 -161014.62 -161719.51  0.44%     -    0s
     0     0 -161719.35    0  106 -161014.62 -161719.35  0.44%     -    0s
     0     0 -161664.07    0   83 -161014.62 -161664.07  0.40%     -    0s
     0     0 -161658.16    0   83 -161014.62 -161658.16  0.40%     -    0s
H    0     0                    -161057.7477 -161637.17  0.36%     -    0s
     0     2 -161637.17    0   82 -161057.75 -161637.17  0.36%     -    0s

Cutting planes:
  Gomory: 42
  Implied bound: 2
  MIR: 172
  Flow cover: 8
  RLT: 23
  Relax-and-lift: 2
  BQP: 1

Explored 891 nodes (6624 simplex iterations) in 0.22 seconds (0.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -161058 -161015 -160534 ... 1.40693e+13
No other solutions better than -161058

Optimal solution found (tolerance 1.00e-06)
Best objective -1.610577476533e+05, best bound -1.610577476533e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 219532.90
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -161057.75
  [DEBUG]   S×d_nominal = 380590.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380590.64 + -161057.75 = 219532.90
  [DEBUG]   Current θ from Master = 226833.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7300.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47039.10
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1012.8542, Absolute Gap = 1012.8542, Relative Gap = 0.018639
  Not converged yet (gap = 1012.85 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697551 nonzeros
Model fingerprint: 0xba16a18c
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101808 rows and 41328 columns
Presolve time: 2.59s
Presolved: 144215 rows, 60772 columns, 887042 nonzeros
Variable types: 58513 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.20s

Barrier statistics:
 Dense cols : 698
 AA' NZ     : 6.711e+06
 Factor NZ  : 1.504e+07 (roughly 200 MB of memory)
 Factor Ops : 3.393e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92704058e+07  2.83789562e+08  1.63e+05 1.47e+01  9.81e+04     5s
   1  -1.49477489e+07  2.67095637e+08  1.17e+05 9.84e+01  6.97e+04     5s
   2  -5.05185603e+06  2.12689158e+08  3.92e+04 3.78e+01  2.46e+04     5s
   3  -1.52489371e+06  1.55565102e+08  7.34e+03 1.32e+00  4.95e+03     5s
   4  -7.08175358e+05  9.41706473e+07  1.04e+03 3.34e-01  9.33e+02     5s
   5  -5.90180621e+05  4.51881517e+07  4.68e+02 1.10e-01  4.01e+02     5s
   6  -4.36972249e+05  3.24061935e+07  1.78e+02 7.13e-02  2.05e+02     6s
   7  -3.21958392e+05  2.39842743e+07  7.29e+01 4.85e-02  1.22e+02     6s
   8  -2.53251096e+05  1.78028429e+07  4.77e+01 3.42e-02  8.50e+01     6s
   9  -2.02592000e+05  1.22539025e+07  2.91e+01 2.20e-02  5.51e+01     6s
  10  -1.39116702e+05  7.02779994e+06  1.57e+01 1.15e-02  3.00e+01     6s
  11  -9.95758846e+04  2.41749829e+06  4.26e+00 3.19e-03  9.91e+00     6s
  12  -5.70886894e+04  7.21104464e+05  1.85e+00 7.81e-04  3.01e+00     6s
  13  -2.35195440e+04  4.16070212e+05  1.13e+00 4.47e-04  1.69e+00     6s
  14   2.15877935e+03  2.80621099e+05  7.26e-01 1.27e-03  1.07e+00     6s
  15   7.99024707e+03  2.49178776e+05  6.65e-01 1.15e-03  9.26e-01     6s
  16   2.90277994e+04  2.04650542e+05  4.74e-01 1.82e-03  6.74e-01     6s
  17   3.86610489e+04  1.73630850e+05  4.01e-01 2.15e-03  5.18e-01     6s
  18   5.06642258e+04  1.50032413e+05  3.08e-01 2.00e-03  3.81e-01     7s
  19   5.67028740e+04  1.33102965e+05  2.60e-01 2.37e-03  2.93e-01     7s
  20   5.99127480e+04  1.22586554e+05  2.35e-01 2.11e-03  2.41e-01     7s
  21   6.44304949e+04  1.15011671e+05  2.03e-01 2.19e-03  1.94e-01     7s
  22   7.06576712e+04  1.09669726e+05  1.60e-01 2.34e-03  1.50e-01     7s
  23   7.72054148e+04  1.06394575e+05  1.14e-01 2.11e-03  1.12e-01     7s
  24   7.96327947e+04  1.04167452e+05  9.74e-02 1.77e-03  9.43e-02     7s
  25   8.30228851e+04  1.01921592e+05  7.53e-02 1.36e-03  7.26e-02     7s
  26   8.59909010e+04  1.00232011e+05  5.65e-02 1.35e-03  5.47e-02     7s
  27   8.73626272e+04  9.95547911e+04  4.79e-02 1.17e-03  4.69e-02     7s
  28   8.93060565e+04  9.81264790e+04  3.59e-02 1.36e-03  3.39e-02     7s
  29   8.98159135e+04  9.76332605e+04  3.27e-02 1.23e-03  3.01e-02     7s
  30   9.07409837e+04  9.72085612e+04  2.67e-02 1.09e-03  2.49e-02     8s
  31   9.18776370e+04  9.68182514e+04  1.99e-02 1.03e-03  1.90e-02     8s
  32   9.26457984e+04  9.63879605e+04  1.55e-02 8.47e-04  1.44e-02     8s
  33   9.32100517e+04  9.60650661e+04  1.22e-02 5.17e-04  1.10e-02     8s
  34   9.40996205e+04  9.58324893e+04  7.07e-03 5.03e-04  6.66e-03     8s
  35   9.45991032e+04  9.56946028e+04  4.27e-03 2.83e-04  4.21e-03     8s
  36   9.47188789e+04  9.55836447e+04  3.62e-03 1.49e-04  3.32e-03     8s
  37   9.48336012e+04  9.55591329e+04  2.99e-03 1.29e-04  2.79e-03     8s
  38   9.50536275e+04  9.55196738e+04  1.81e-03 9.32e-05  1.79e-03     8s
  39   9.50855739e+04  9.54887382e+04  1.64e-03 6.69e-05  1.55e-03     8s
  40   9.52378913e+04  9.54479429e+04  8.49e-04 3.24e-05  8.07e-04     8s
  41   9.53175211e+04  9.54236476e+04  4.45e-04 1.76e-05  4.08e-04     9s
  42   9.53446691e+04  9.54190388e+04  3.15e-04 1.02e-05  2.86e-04     9s
  43   9.53457611e+04  9.54167969e+04  3.09e-04 7.50e-06  2.73e-04     9s
  44   9.53809252e+04  9.54115042e+04  1.36e-04 4.68e-06  1.18e-04     9s
  45   9.53957028e+04  9.54109492e+04  6.67e-05 1.41e-06  5.86e-05     9s
  46   9.53988626e+04  9.54108327e+04  5.20e-05 1.02e-06  4.60e-05     9s
  47   9.54067012e+04  9.54106894e+04  1.89e-05 8.63e-07  1.53e-05     9s
  48   9.54105193e+04  9.54105313e+04  2.11e-07 8.21e-08  4.61e-08     9s
  49   9.54105198e+04  9.54105313e+04  7.98e-06 8.19e-08  4.61e-08     9s
  50   9.54105203e+04  9.54105320e+04  1.30e-05 4.01e-08  4.50e-08     9s
  51   9.54105279e+04  9.54105307e+04  6.39e-06 2.81e-08  1.12e-08     9s
  52   9.54105297e+04  9.54105307e+04  2.92e-06 1.85e-08  3.59e-09    10s

Barrier solved model in 52 iterations and 9.54 seconds (14.07 work units)
Optimal objective 9.54105297e+04


Root crossover log...

  129932 DPushes remaining with DInf 0.0000000e+00                10s
   66260 DPushes remaining with DInf 0.0000000e+00                10s
    1141 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   30901 PPushes remaining with PInf 5.6892649e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3648330e+05     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  105330    9.5410531e+04   0.000000e+00   7.364833e+05     18s
  107428    9.5410531e+04   0.000000e+00   2.338800e+01     20s
  107532    9.5410531e+04   0.000000e+00   0.000000e+00     20s
  107532    9.5410531e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.44s

Solved with barrier

Root relaxation: objective 9.541053e+04, 107532 iterations, 17.51 seconds (33.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95410.5307    0  173 -223925.25 95410.5307   143%     -   21s
H    0     0                    -219310.5088 95410.5307   144%     -   21s
H    0     0                    -203322.8040 95410.5307   147%     -   22s
H    0     0                    -59626.20871 95410.5307   260%     -   22s
H    0     0                    9814.2996917 95410.5307   872%     -   23s
H    0     0                    35805.986148 95410.5307   166%     -   23s
H    0     0                    40060.975031 95410.5307   138%     -   24s
H    0     0                    43491.562188 95410.5307   119%     -   24s
H    0     0                    43653.729894 95410.5307   119%     -   24s
H    0     0                    43661.940433 95410.5307   119%     -   24s
H    0     0                    43770.217971 95410.5307   118%     -   24s
H    0     0                    43807.061078 95410.5307   118%     -   24s
H    0     0                    43808.328781 95410.5307   118%     -   24s
H    0     0                    43832.780822 95410.5307   118%     -   24s
H    0     0                    43855.426025 95410.5307   118%     -   24s
     0     0 87988.3888    0  274 43855.4260 87988.3888   101%     -  108s
     0     0 87837.7302    0  276 43855.4260 87837.7302   100%     -  130s
     0     0 87574.6466    0  286 43855.4260 87574.6466   100%     -  153s
     0     0 87542.8618    0  279 43855.4260 87542.8618   100%     -  162s
     0     0 87519.5108    0  279 43855.4260 87519.5108   100%     -  172s
     0     0 87519.2088    0  279 43855.4260 87519.2088   100%     -  173s
     0     0 84348.4230    0  304 43855.4260 84348.4230  92.3%     -  257s
H    0     0                    47613.847220 84348.3668  77.2%     -  258s
H    0     0                    48429.212922 84348.3668  74.2%     -  258s
     0     0 83770.4977    0  283 48429.2129 83770.4977  73.0%     -  299s
     0     0 83456.1425    0  322 48429.2129 83456.1425  72.3%     -  343s
     0     0 83341.4004    0  322 48429.2129 83341.4004  72.1%     -  369s
     0     0 83252.9803    0  302 48429.2129 83252.9803  71.9%     -  393s
     0     0 83243.1169    0  313 48429.2129 83243.1169  71.9%     -  399s
     0     0 83225.2077    0  298 48429.2129 83225.2077  71.8%     -  404s
     0     0 83221.7703    0  295 48429.2129 83221.7703  71.8%     -  407s
     0     0 83217.5134    0  296 48429.2129 83217.5134  71.8%     -  410s
     0     0 83217.2762    0  297 48429.2129 83217.2762  71.8%     -  411s
     0     0 81014.7692    0  314 48429.2129 81014.7692  67.3%     -  518s
     0     0 80544.5863    0  375 48429.2129 80544.5863  66.3%     -  559s
     0     0 80540.6427    0  381 48429.2129 80540.6427  66.3%     -  563s
     0     0 80346.7206    0  394 48429.2129 80346.7206  65.9%     -  590s
     0     0 80259.2255    0  409 48429.2129 80259.2255  65.7%     -  606s
     0     0 80222.2965    0  405 48429.2129 80222.2965  65.6%     -  616s
     0     0 80179.7517    0  391 48429.2129 80179.7517  65.6%     -  628s
     0     0 80135.9430    0  407 48429.2129 80135.9430  65.5%     -  639s
     0     0 80111.7946    0  418 48429.2129 80111.7946  65.4%     -  647s
     0     0 80110.3071    0  412 48429.2129 80110.3071  65.4%     -  651s
     0     0 78942.3237    0  389 48429.2129 78942.3237  63.0%     -  736s
H    0     0                    48483.942624 78942.0037  62.8%     -  737s
H    0     0                    48541.283785 78942.0037  62.6%     -  737s
     0     0 78625.8680    0  395 48541.2838 78625.8680  62.0%     -  763s
     0     0 78507.8291    0  397 48541.2838 78507.8291  61.7%     -  780s
     0     0 78445.3365    0  402 48541.2838 78445.3365  61.6%     -  792s
     0     0 78424.1980    0  409 48541.2838 78424.1980  61.6%     -  799s
     0     0 78411.5660    0  412 48541.2838 78411.5660  61.5%     -  806s
     0     0 78398.5774    0  404 48541.2838 78398.5774  61.5%     -  811s
     0     0 78388.8812    0  406 48541.2838 78388.8812  61.5%     -  817s
     0     0 78383.3131    0  413 48541.2838 78383.3131  61.5%     -  820s
     0     0 78378.0549    0  402 48541.2838 78378.0549  61.5%     -  822s
     0     0 78366.0387    0  409 48541.2838 78366.0387  61.4%     -  826s
     0     0 78363.1436    0  407 48541.2838 78363.1436  61.4%     -  828s
     0     0 78360.6559    0  411 48541.2838 78360.6559  61.4%     -  829s
     0     0 78359.2196    0  406 48541.2838 78359.2196  61.4%     -  830s
     0     0 78041.4348    0  412 48541.2838 78041.4348  60.8%     -  857s
     0     0 78000.6853    0  407 48541.2838 78000.6853  60.7%     -  871s
     0     0 77987.2789    0  406 48541.2838 77987.2789  60.7%     -  877s
     0     0 77985.3561    0  365 48541.2838 77985.3561  60.7%     -  881s
     0     0 77891.8802    0  386 48541.2838 77891.8802  60.5%     -  901s
     0     0 77834.3987    0  450 48541.2838 77834.3987  60.3%     -  927s
     0     0 77810.8919    0  445 48541.2838 77810.8919  60.3%     -  935s
     0     0 77804.0953    0  451 48541.2838 77804.0953  60.3%     -  939s
     0     0 77791.7608    0  451 48541.2838 77791.7608  60.3%     -  947s
     0     0 77785.4737    0  450 48541.2838 77785.4737  60.2%     -  951s
     0     0 77782.7133    0  481 48541.2838 77782.7133  60.2%     -  954s
     0     0 77780.0312    0  485 48541.2838 77780.0312  60.2%     -  956s
     0     0 77779.5910    0  488 48541.2838 77779.5910  60.2%     -  957s
     0     0 77701.7895    0  446 48541.2838 77701.7895  60.1%     -  979s
     0     0 77644.6448    0  459 48541.2838 77644.6448  60.0%     -  990s
     0     0 77619.1697    0  468 48541.2838 77619.1697  59.9%     -  997s
     0     0 77613.9183    0  475 48541.2838 77613.9183  59.9%     - 1001s
     0     0 77607.3899    0  470 48541.2838 77607.3899  59.9%     - 1004s
     0     0 77601.7649    0  480 48541.2838 77601.7649  59.9%     - 1007s
     0     0 77596.9584    0  471 48541.2838 77596.9584  59.9%     - 1009s
     0     0 77595.9522    0  470 48541.2838 77595.9522  59.9%     - 1010s
     0     0 77493.3057    0  482 48541.2838 77493.3057  59.6%     - 1028s
H    0     0                    48849.440691 77492.8994  58.6%     - 1032s
H    0     0                    50146.624898 77492.8994  54.5%     - 1032s
H    0     0                    50400.996059 77492.8994  53.8%     - 1033s
     0     0 77449.2537    0  494 50400.9961 77449.2537  53.7%     - 1048s
     0     0 77428.8610    0  506 50400.9961 77428.8610  53.6%     - 1056s
     0     0 77419.9663    0  500 50400.9961 77419.9663  53.6%     - 1062s
     0     0 77412.9270    0  504 50400.9961 77412.9270  53.6%     - 1066s
     0     0 77410.8655    0  494 50400.9961 77410.8655  53.6%     - 1069s
     0     0 77397.1698    0  440 50400.9961 77397.1698  53.6%     - 1078s
     0     0 77393.3231    0  437 50400.9961 77393.3231  53.6%     - 1083s
     0     0 77391.3942    0  441 50400.9961 77391.3942  53.6%     - 1085s
     0     0 77368.1506    0  415 50400.9961 77368.1506  53.5%     - 1096s
H    0     0                    50531.447903 77367.2627  53.1%     - 1102s
     0     0 77360.9494    0  490 50531.4479 77360.9494  53.1%     - 1111s
     0     0 77356.1666    0  488 50531.4479 77356.1666  53.1%     - 1115s
     0     0 77353.5494    0  447 50531.4479 77353.5494  53.1%     - 1117s
     0     0 77345.4317    0  488 50531.4479 77345.4317  53.1%     - 1121s
H    0     0                    50646.690406 77345.3211  52.7%     - 1122s
     0     0 77342.9587    0  482 50646.6904 77342.9587  52.7%     - 1124s
     0     0 77340.5060    0  479 50646.6904 77340.5060  52.7%     - 1128s
     0     0 77339.9714    0  479 50646.6904 77339.9714  52.7%     - 1132s
H    0     0                    50668.598233 77339.9714  52.6%     - 1212s
H    0     0                    51605.719890 77339.9714  49.9%     - 1212s
H    0     0                    51800.454735 77339.9714  49.3%     - 1365s
H    0     2                    51929.369609 77339.9714  48.9%     - 1402s
     0     2 77339.9714    0  479 51929.3696 77339.9714  48.9%     - 1402s
     1     4 77286.2890    1  425 51929.3696 77339.5171  48.9%  6995 1422s
     3     7 76987.9481    2  419 51929.3696 77283.0216  48.8% 12950 1464s
     6    13 76806.3819    3  386 51929.3696 76987.8233  48.3% 16926 1509s
    12    26 76766.8825    4  418 51929.3696 76987.8233  48.3% 17756 1566s
    25    39 76233.2325    5  401 51929.3696 76766.8816  47.8% 28259 1720s
    38    71 73676.9852    6  374 51929.3696 76766.8816  47.8% 26866 2048s
H   41    71                    52081.082747 76766.8816  47.4% 26324 2048s
    70   163 73503.3672    7  327 52081.0827 76662.0525  47.2% 30093 2192s
   162   195 73352.0547   10  370 52081.0827 76662.0525  47.2% 17685 2239s
   194   227 73326.8119   11  316 52081.0827 76662.0525  47.2% 16028 2288s
H  199   227                    52386.022276 76662.0525  46.3% 15947 2288s
   226   357 73303.1041   12  314 52386.0223 76662.0525  46.3% 14962 2350s
   356   443 72396.9249   17  331 52386.0223 76662.0525  46.3% 11568 2394s
   442   521 72342.4294   18  288 52386.0223 76662.0525  46.3% 10465 2437s
   520   596 72253.9787   21  277 52386.0223 76662.0525  46.3%  9776 2471s
   595   666 71976.1930   23  286 52386.0223 76662.0525  46.3%  9372 2505s
   665   724 71773.7304   25  310 52386.0223 76662.0525  46.3%  9131 2532s
   723   785 71109.9743   28  305 52386.0223 76662.0525  46.3%  9136 2559s
   784   835 65390.7616   31  187 52386.0223 76662.0525  46.3%  9139 2587s
   836   890 65376.6575   32  183 52386.0223 76662.0525  46.3%  9164 2614s
   891   936 65027.1073   36  176 52386.0223 76662.0525  46.3%  9106 2642s
   942   986 63626.3688   39  158 52386.0223 76662.0525  46.3%  9168 2668s
   992  1061 63263.8451   40  157 52386.0223 76662.0525  46.3%  9191 2695s
  1071  1155 62746.5764   47  125 52386.0223 76662.0525  46.3%  9112 2725s
  1165  1257 61887.0078   51  135 52386.0223 76662.0525  46.3%  8909 2759s
  1269  1304 58999.8882   56  118 52386.0223 76662.0525  46.3%  8684 2787s
H 1278  1304                    52572.182021 76662.0525  45.8%  8678 2787s
  1322  1398 58663.3359   57  122 52572.1820 76662.0525  45.8%  8643 2821s
  1438  1547 57419.5556   61  105 52572.1820 76662.0525  45.8%  8475 2855s
  1599  1607 infeasible   69      52572.1820 76662.0525  45.8%  8172 2893s
  1739  1625 53259.8859   50  196 52572.1820 76662.0525  45.8%  8084 2930s
  1773  1649     cutoff   51      52572.1820 76662.0525  45.8%  8136 2969s
  1813  1671 56844.7613   35  171 52572.1820 76662.0525  45.8%  8173 3009s
  1851  1724 54771.7674   29  201 52572.1820 76662.0525  45.8%  8226 3051s
  1955  1770 54212.0680   30  189 52572.1820 76662.0525  45.8%  8087 3093s
  2073  1811 53378.7806   34  193 52572.1820 76662.0525  45.8%  7950 3142s
  2192  1836 infeasible   39      52572.1820 76407.0582  45.3%  7932 3192s
H 2264  1812                    53203.665390 76407.0582  43.6%  7890 3192s
  2315  1828 54069.8102   61  131 53203.6654 75936.3396  42.7%  7891 3253s
  2389  1855 73222.3363    8  338 53203.6654 75936.3396  42.7%  7988 3312s
  2473  1873 72251.8155    9  352 53203.6654 75936.3396  42.7%  8066 3376s
  2533  1908 72131.3708   10  301 53203.6654 75936.3396  42.7%  8274 3444s
  2616  1923 61886.7493   19  279 53203.6654 75936.3396  42.7%  8320 3516s
  2676  1966 71592.2989   11  325 53203.6654 75936.3396  42.7%  8469 3589s
  2749  1972 53921.2495   62   91 53203.6654 75936.3396  42.7%  8654 3600s

Cutting planes:
  Learned: 2
  Gomory: 11
  Implied bound: 175
  MIR: 3986
  Flow cover: 3628
  RLT: 67
  Relax-and-lift: 567
  BQP: 1
  PSD: 1

Explored 2773 nodes (24710993 simplex iterations) in 3600.05 seconds (8776.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 53203.7 52572.2 52386 ... 50531.4

Time limit reached
Best objective 5.320366539034e+04, best bound 7.593633962319e+04, gap 42.7276%
  WARNING: Time limit reached. Using best solution found (gap: 42.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 53203.67, θ = 227138.96
  Upper Bound (UB) = 53203.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227138.96
  [DEBUG]   ✓ Scenario 0: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227138.96 ≤ Q = 227138.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227138.96 ≤ Q = 227138.96 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x38b2069a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc74df966
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.398679e+13
Presolve removed 2562 rows and 1852 columns
Presolve time: 0.00s
Presolved: 531 rows, 537 columns, 1505 nonzeros
Found heuristic solution: objective 7051802.3524
Variable types: 364 continuous, 173 integer (173 binary)

Root relaxation: objective -1.844570e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -184456.98    0  122 7051802.35 -184456.98   103%     -    0s
H    0     0                    -144639.8901 -184456.98  27.5%     -    0s
H    0     0                    -144962.2381 -184456.98  27.2%     -    0s
H    0     0                    -145926.5808 -184243.77  26.3%     -    0s
     0     0 -161891.53    0   96 -145926.58 -161891.53  10.9%     -    0s
H    0     0                    -157809.3717 -161768.36  2.51%     -    0s
H    0     0                    -158117.8896 -161768.36  2.31%     -    0s
H    0     0                    -158591.8194 -161768.36  2.00%     -    0s
H    0     0                    -158888.1491 -161768.36  1.81%     -    0s
     0     0 -160841.62    0  104 -158888.15 -160841.62  1.23%     -    0s
H    0     0                    -159131.9238 -160744.55  1.01%     -    0s
     0     0 -160378.08    0  111 -159131.92 -160378.08  0.78%     -    0s
H    0     0                    -159155.3434 -160327.80  0.74%     -    0s
     0     0 -160327.80    0  110 -159155.34 -160327.80  0.74%     -    0s
H    0     0                    -159156.0119 -160327.47  0.74%     -    0s
     0     0 -160327.47    0  110 -159156.01 -160327.47  0.74%     -    0s
     0     0 -160162.72    0   78 -159156.01 -160162.72  0.63%     -    0s
     0     0 -160110.34    0   91 -159156.01 -160110.34  0.60%     -    0s
     0     0 -160077.61    0   92 -159156.01 -160077.61  0.58%     -    0s
     0     0 -160077.52    0   92 -159156.01 -160077.52  0.58%     -    0s
     0     0 -159981.70    0   93 -159156.01 -159981.70  0.52%     -    0s
     0     0 -159975.41    0   93 -159156.01 -159975.41  0.51%     -    0s
H    0     0                    -159212.7234 -159953.39  0.47%     -    0s
     0     2 -159953.39    0   93 -159212.72 -159953.39  0.47%     -    0s
H   31    33                    -159275.0547 -159742.99  0.29%  23.4    0s
H   33    33                    -159354.5812 -159742.99  0.24%  22.3    0s
H   36    32                    -159451.6925 -159742.99  0.18%  21.2    0s
H   38    31                    -159478.4099 -159742.99  0.17%  20.5    0s
*  215   104              14    -159536.6469 -159694.36  0.10%   8.7    0s
H  322   104                    -159551.9989 -159694.36  0.09%   7.2    0s
H  359    24                    -159580.6033 -159692.35  0.07%   7.0    0s
H  364    24                    -159629.3134 -159689.32  0.04%   6.9    0s
*  471     2              16    -159664.7592 -159664.76  0.00%   6.1    0s

Cutting planes:
  Gomory: 44
  Implied bound: 11
  MIR: 183
  Flow cover: 13
  RLT: 29
  Relax-and-lift: 2

Explored 483 nodes (3617 simplex iterations) in 0.11 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -159665 -159629 -159581 ... -159213
No other solutions better than -159665

Optimal solution found (tolerance 1.00e-06)
Best objective -1.596647591750e+05, best bound -1.596647591750e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 219028.70
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -159664.76
  [DEBUG]   S×d_nominal = 378693.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 378693.46 + -159664.76 = 219028.70
  [DEBUG]   Current θ from Master = 227138.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8110.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45093.41
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = -123.2819, Absolute Gap = 123.2819, Relative Gap = -0.002317
  *** CONVERGED (small negative gap: -123.28 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 16
Total Time: 42716.11s
Converged: True
Final Lower Bound: 53326.9472
Final Upper Bound: 53203.6654
Final Gap: -123.281856
Number of Critical Scenarios: 16
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 5, 6, 8, 9] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 5 customers  Mode 2: 45 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 16
Start Time: 2026-01-03 11:55:59
End Time: 2026-01-03 23:47:55
Total Time: 42716.11s
Optimal Value: 53326.95
Lower Bound: 53326.95
Upper Bound: 53203.67
Gap: -123.281856
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 5, 6, 8, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed24_HD_gamma20_20260103_234755.csv

Total Execution Time: 42717.92 seconds
End Time: 2026-01-03 23:47:57

All tasks completed successfully!

